<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</title>
  </head>
  <body>
    <div id="content">
      <div class="section class ActiveRecord_ConnectionAdapters_PostgreSQLAdapter">
  <h1 class="title">Class: ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</h1>
  <div class="section inheritance">
  <ul>
  <li><a href='../../Object.html' title='Object'>Object</a></li><ul><li><a href='AbstractAdapter.html' title='ActiveRecord::ConnectionAdapters::AbstractAdapter'>ActiveRecord::ConnectionAdapters::AbstractAdapter</a></li><ul><li>ActiveRecord::ConnectionAdapters::PostgreSQLAdapter</li>
  </ul></ul></ul>
</div><div class="section docstring">
  <p>
The PostgreSQL adapter works both with the native C
(http://ruby.scripting.ca/postgres/) and the pure Ruby (available both as
gem and from http://rubyforge.org/frs/?group_id=234&amp;release_id=1944)
drivers.
</p>
<p>
Options:
</p>
<ul>
<li><tt>:host</tt> - Defaults to &quot;localhost&quot;.

</li>
<li><tt>:port</tt> - Defaults to 5432.

</li>
<li><tt>:username</tt> - Defaults to nothing.

</li>
<li><tt>:password</tt> - Defaults to nothing.

</li>
<li><tt>:database</tt> - The name of the database. No default, must be
provided.

</li>
<li><tt>:schema_search_path</tt> - An optional schema search path for the
connection given as a string of comma-separated schema names. This is
backward-compatible with the <tt>:schema_order</tt> option.

</li>
<li><tt>:encoding</tt> - An optional client encoding that is used in a <tt>SET
client_encoding TO &lt;encoding&gt;</tt> call on the connection.

</li>
<li><tt>:min_messages</tt> - An optional client min messages that is used in a
<tt>SET client_min_messages TO &lt;min_messages&gt;</tt> call on the
connection.

</li>
<li><tt>:allow_concurrency</tt> - If true, use async query methods so Ruby
threads don&#8217;t deadlock; otherwise, use blocking query methods.

</li>
</ul>

</div><div class="section constants">
  <div class="thisclass">
  <h1>Constants</h1>
  <dl>
    
      <dt id="ADAPTER_NAME-constant">ADAPTER_NAME</dt>
      <dd>'PostgreSQL'.freeze</dd>
    
      <dt id="NATIVE_DATABASE_TYPES-constant">NATIVE_DATABASE_TYPES</dt>
      <dd>{        :primary_key =&gt; &quot;serial primary key&quot;.freeze,        :string      =&gt; { :name =&gt; &quot;character varying&quot;, :limit =&gt; 255 },        :text        =&gt; { :name =&gt; &quot;text&quot; },        :integer     =&gt; { :name =&gt; &quot;integer&quot; },        :float       =&gt; { :name =&gt; &quot;float&quot; },        :decimal     =&gt; { :name =&gt; &quot;decimal&quot; },        :datetime    =&gt; { :name =&gt; &quot;timestamp&quot; },        :timestamp   =&gt; { :name =&gt; &quot;timestamp&quot; },        :time        =&gt; { :name =&gt; &quot;time&quot; },        :date        =&gt; { :name =&gt; &quot;date&quot; },        :binary      =&gt; { :name =&gt; &quot;bytea&quot; },        :boolean     =&gt; { :name =&gt; &quot;boolean&quot; }      }</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h1>Constructor Summary</h1>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(connection, logger, connection_parameters, config)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Initializes and connects a PostgreSQL adapter.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


206
207
208
209
210
211</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 206</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='connection identifier id'>connection</span><span class='comma token'>,</span> <span class='logger identifier id'>logger</span><span class='comma token'>,</span> <span class='connection_parameters identifier id'>connection_parameters</span><span class='comma token'>,</span> <span class='config identifier id'>config</span><span class='rparen token'>)</span>
  <span class='super super kw'>super</span><span class='lparen token'>(</span><span class='connection identifier id'>connection</span><span class='comma token'>,</span> <span class='logger identifier id'>logger</span><span class='rparen token'>)</span>
  <span class='@connection_parameters ivar id'>@connection_parameters</span><span class='comma token'>,</span> <span class='@config ivar id'>@config</span> <span class='assign token'>=</span> <span class='connection_parameters identifier id'>connection_parameters</span><span class='comma token'>,</span> <span class='config identifier id'>config</span>

  <span class='connect identifier id'>connect</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#active%3F-instance_method' title='#active?'>#active?</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Is this connection alive and ready for queries?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#adapter_name-instance_method' title='#adapter_name'>#adapter_name</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns &#8216;PostgreSQL&#8217; as adapter name for identification
purposes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#add_column-instance_method' title='#add_column'>#add_column</a></span><span class='args'>(table_name, column_name, type, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Adds a new column to the named table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#add_order_by_for_association_limiting%21-instance_method' title='#add_order_by_for_association_limiting!'>#add_order_by_for_association_limiting!</a></span><span class='args'>(sql, options)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an ORDER BY clause for the passed order option.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#begin_db_transaction-instance_method' title='#begin_db_transaction'>#begin_db_transaction</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Begins a transaction.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#change_column-instance_method' title='#change_column'>#change_column</a></span><span class='args'>(table_name, column_name, type, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Changes the column of a table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#change_column_default-instance_method' title='#change_column_default'>#change_column_default</a></span><span class='args'>(table_name, column_name, default)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Changes the default value of a table column.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#change_column_null-instance_method' title='#change_column_null'>#change_column_null</a></span><span class='args'>(table_name, column_name, null, default = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#client_min_messages-instance_method' title='#client_min_messages'>#client_min_messages</a></span><span class='args'>=(level)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set the client message level.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#columns-instance_method' title='#columns'>#columns</a></span><span class='args'>(table_name, name = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the list of all column definitions for a table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#commit_db_transaction-instance_method' title='#commit_db_transaction'>#commit_db_transaction</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Commits a transaction.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#create_database-instance_method' title='#create_database'>#create_database</a></span><span class='args'>(name, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a new PostgreSQL database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#create_savepoint-instance_method' title='#create_savepoint'>#create_savepoint</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#current_database-instance_method' title='#current_database'>#current_database</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the current database name.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#default_sequence_name-instance_method' title='#default_sequence_name'>#default_sequence_name</a></span><span class='args'>(table_name, pk = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the sequence name for a table&#8217;s primary key or some other
specified key.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#disable_referential_integrity-instance_method' title='#disable_referential_integrity'>#disable_referential_integrity</a></span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#disconnect%21-instance_method' title='#disconnect!'>#disconnect!</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Close the connection.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#distinct-instance_method' title='#distinct'>#distinct</a></span><span class='args'>(columns, order_by)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a SELECT DISTINCT clause for a given set of columns and a given
ORDER BY clause.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#drop_database-instance_method' title='#drop_database'>#drop_database</a></span><span class='args'>(name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Drops a PostgreSQL database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#encoding-instance_method' title='#encoding'>#encoding</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the current database encoding format.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#escape_bytea-instance_method' title='#escape_bytea'>#escape_bytea</a></span><span class='args'>(value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
QUOTING ================================================== Escapes binary
strings for bytea input to the database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#execute-instance_method' title='#execute'>#execute</a></span><span class='args'>(sql, name = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Executes an SQL statement, returning a PGresult object on success or
raising a PGError exception otherwise.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#indexes-instance_method' title='#indexes'>#indexes</a></span><span class='args'>(table_name, name = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the list of all indexes for a table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#insert-instance_method' title='#insert'>#insert</a></span><span class='args'>(sql, name = nil, pk = nil, id_value = nil, sequence_name = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Executes an INSERT query and returns the new record&#8217;s ID.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#native_database_types-instance_method' title='#native_database_types'>#native_database_types</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#pk_and_sequence_for-instance_method' title='#pk_and_sequence_for'>#pk_and_sequence_for</a></span><span class='args'>(table)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a table&#8217;s primary key and belonging sequence.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#query-instance_method' title='#query'>#query</a></span><span class='args'>(sql, name = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Queries the database and returns the results in an Array-like object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#quote-instance_method' title='#quote'>#quote</a></span><span class='args'>(value, column = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Quotes PostgreSQL-specific data types for SQL input.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#quote_column_name-instance_method' title='#quote_column_name'>#quote_column_name</a></span><span class='args'>(name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Quotes column names for use in SQL queries.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#quote_string-instance_method' title='#quote_string'>#quote_string</a></span><span class='args'>(s)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Quotes strings for use in SQL input in the postgres driver for better
performance.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#quote_table_name-instance_method' title='#quote_table_name'>#quote_table_name</a></span><span class='args'>(name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Checks the following cases:.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#quoted_date-instance_method' title='#quoted_date'>#quoted_date</a></span><span class='args'>(value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Quote date/time values for use in SQL input.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#reconnect%21-instance_method' title='#reconnect!'>#reconnect!</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Close then reopen the connection.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#recreate_database-instance_method' title='#recreate_database'>#recreate_database</a></span><span class='args'>(name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
SCHEMA STATEMENTS ========================================.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#release_savepoint-instance_method' title='#release_savepoint'>#release_savepoint</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#remove_index-instance_method' title='#remove_index'>#remove_index</a></span><span class='args'>(table_name, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Drops an index from a table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rename_column-instance_method' title='#rename_column'>#rename_column</a></span><span class='args'>(table_name, column_name, new_column_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Renames a column in a table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rename_table-instance_method' title='#rename_table'>#rename_table</a></span><span class='args'>(name, new_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Renames a table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#reset_pk_sequence%21-instance_method' title='#reset_pk_sequence!'>#reset_pk_sequence!</a></span><span class='args'>(table, pk = nil, sequence = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Resets the sequence of a table&#8217;s primary key to the maximum value.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#result_as_array-instance_method' title='#result_as_array'>#result_as_array</a></span><span class='args'>(res)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
create a 2D array representing the result set.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rollback_db_transaction-instance_method' title='#rollback_db_transaction'>#rollback_db_transaction</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Aborts a transaction.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rollback_to_savepoint-instance_method' title='#rollback_to_savepoint'>#rollback_to_savepoint</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#schema_search_path-instance_method' title='#schema_search_path'>#schema_search_path</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the active schema search path.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#select_rows-instance_method' title='#select_rows'>#select_rows</a></span><span class='args'>(sql, name = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
DATABASE STATEMENTS ====================================== Executes a
SELECT query and returns an array of rows.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#supports_ddl_transactions%3F-instance_method' title='#supports_ddl_transactions?'>#supports_ddl_transactions?</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#supports_disable_referential_integrity%3F-instance_method' title='#supports_disable_referential_integrity?'>#supports_disable_referential_integrity?</a></span><span class='args'>() </span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
REFERENTIAL INTEGRITY ====================================.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#supports_insert_with_returning%3F-instance_method' title='#supports_insert_with_returning?'>#supports_insert_with_returning?</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#supports_migrations%3F-instance_method' title='#supports_migrations?'>#supports_migrations?</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Does PostgreSQL support migrations?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#supports_savepoints%3F-instance_method' title='#supports_savepoints?'>#supports_savepoints?</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#supports_standard_conforming_strings%3F-instance_method' title='#supports_standard_conforming_strings?'>#supports_standard_conforming_strings?</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Does PostgreSQL support standard conforming strings?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#table_alias_length-instance_method' title='#table_alias_length'>#table_alias_length</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the configured supported identifier length supported by PostgreSQL,
or report the default of 63 on PostgreSQL 7.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#tables-instance_method' title='#tables'>#tables</a></span><span class='args'>(name = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the list of all tables in the schema search path or a specified
schema.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#type_to_sql-instance_method' title='#type_to_sql'>#type_to_sql</a></span><span class='args'>(type, limit = nil, precision = nil, scale = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Maps logical Rails types to PostgreSQL-specific data types.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#unescape_bytea-instance_method' title='#unescape_bytea'>#unescape_bytea</a></span><span class='args'>(value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Unescapes bytea output from a database to the binary string it represents.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#update_sql-instance_method' title='#update_sql'>#update_sql</a></span><span class='args'>(sql, name = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Executes an UPDATE query and returns the number of affected tuples.
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h1>Public Instance Methods Inherited from <a href='AbstractAdapter.html' title='ActiveRecord::ConnectionAdapters::AbstractAdapter'>ActiveRecord::ConnectionAdapters::AbstractAdapter</a></h1>
    <p><span class='name'><a href='AbstractAdapter.html#current_savepoint_name-instance_method' title='current_savepoint_name'>current_savepoint_name</a></span>, <span class='name'><a href='AbstractAdapter.html#decrement_open_transactions-instance_method' title='decrement_open_transactions'>decrement_open_transactions</a></span>, <span class='name'><a href='AbstractAdapter.html#increment_open_transactions-instance_method' title='increment_open_transactions'>increment_open_transactions</a></span>, <span class='name'><a href='AbstractAdapter.html#log_info-instance_method' title='log_info'>log_info</a></span>, <span class='name'><a href='AbstractAdapter.html#open_transactions-instance_method' title='open_transactions'>open_transactions</a></span>, <span class='name'><a href='AbstractAdapter.html#prefetch_primary_key%3F-instance_method' title='prefetch_primary_key?'>prefetch_primary_key?</a></span>, <span class='name'><a href='AbstractAdapter.html#raw_connection-instance_method' title='raw_connection'>raw_connection</a></span>, <span class='name'><a href='AbstractAdapter.html#requires_reloading%3F-instance_method' title='requires_reloading?'>requires_reloading?</a></span>, <span class='name'><a href='AbstractAdapter.html#reset%21-instance_method' title='reset!'>reset!</a></span>, <span class='name'><a href='AbstractAdapter.html#reset_runtime-instance_method' title='reset_runtime'>reset_runtime</a></span>, <span class='name'><a href='AbstractAdapter.html#supports_count_distinct%3F-instance_method' title='supports_count_distinct?'>supports_count_distinct?</a></span>, <span class='name'><a href='AbstractAdapter.html#transaction_joinable-instance_method' title='transaction_joinable'>transaction_joinable</a></span>, <span class='name'><a href='AbstractAdapter.html#verify%21-instance_method' title='verify!'>verify!</a></span></p>
  </div>
  
  <div>
    <h1>Public Instance Methods Inherited from <a href='../../Object.html' title='Object'>Object</a></h1>
    <p><span class='name'><a href='../../Object.html#blank%3F-instance_method' title='blank?'>blank?</a></span>, <span class='name'><a href='../../Object.html#duplicable%3F-instance_method' title='duplicable?'>duplicable?</a></span>, <span class='name'><a href='../../Object.html#present%3F-instance_method' title='present?'>present?</a></span>, <span class='name'><a href='../../Object.html#to_param-instance_method' title='to_param'>to_param</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>active?</h3>
</div><div id="active%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>active?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Is this connection alive and ready for queries?
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


214
215
216
217
218
219
220
221
222
223
224
225</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 214</span>

<span class='def def kw'>def</span> <span class='active? fid id'>active?</span>
  <span class='if if kw'>if</span> <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='status identifier id'>status</span><span class='rparen token'>)</span>
    <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='status identifier id'>status</span> <span class='eq op'>==</span> <span class='PGconn constant id'>PGconn</span><span class='colon2 op'>::</span><span class='CONNECTION_OK constant id'>CONNECTION_OK</span>
  <span class='else else kw'>else</span>
    <span class='comment val'># We're asking the driver, not ActiveRecord, so use @connection.query instead of #query</span>
    <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='query identifier id'>query</span> <span class='string val'>'SELECT 1'</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='comment val'># postgres-pr raises a NoMethodError when querying if no connection is available.</span>
<span class='rescue rescue kw'>rescue</span> <span class='PGError constant id'>PGError</span><span class='comma token'>,</span> <span class='NoMethodError constant id'>NoMethodError</span>
  <span class='false false kw'>false</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>adapter_name</h3>
</div><div id="adapter_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>adapter_name</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns &#8216;PostgreSQL&#8217; as adapter name for identification
purposes.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


201
202
203</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 201</span>

<span class='def def kw'>def</span> <span class='adapter_name identifier id'>adapter_name</span>
  <span class='ADAPTER_NAME constant id'>ADAPTER_NAME</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>add_column</h3>
</div><div id="add_column-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_column</span><span class='args'>(table_name, column_name, type, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Adds a new column to the named table. See TableDefinition#column for
details of the options you can use.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


811
812
813
814
815
816
817
818
819
820</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 811</span>

<span class='def def kw'>def</span> <span class='add_column identifier id'>add_column</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='comma token'>,</span> <span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='default identifier id'>default</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:default</span><span class='rbrack token'>]</span>
  <span class='notnull identifier id'>notnull</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:null</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='false false kw'>false</span>

  <span class='comment val'># Add the column.</span>
  <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;ALTER TABLE #{quote_table_name(table_name)} ADD COLUMN #{quote_column_name(column_name)} #{type_to_sql(type, options[:limit], options[:precision], options[:scale])}&quot;</span><span class='rparen token'>)</span>

  <span class='change_column_default identifier id'>change_column_default</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='comma token'>,</span> <span class='default identifier id'>default</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='options_include_default? fid id'>options_include_default?</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='change_column_null identifier id'>change_column_null</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='comma token'>,</span> <span class='false false kw'>false</span><span class='comma token'>,</span> <span class='default identifier id'>default</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='notnull identifier id'>notnull</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>add_order_by_for_association_limiting!</h3>
</div><div id="add_order_by_for_association_limiting%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_order_by_for_association_limiting!</span><span class='args'>(sql, options)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an ORDER BY clause for the passed order option.
</p>
<p>
PostgreSQL does not allow arbitrary ordering when using DISTINCT ON, so we
work around this by wrapping the <tt>sql</tt> string as a sub-select and
ordering in that query.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


907
908
909
910
911
912
913
914
915</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 907</span>

<span class='def def kw'>def</span> <span class='add_order_by_for_association_limiting! fid id'>add_order_by_for_association_limiting!</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='return return kw'>return</span> <span class='sql identifier id'>sql</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:order</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
  
  <span class='order identifier id'>order</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:order</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='reject identifier id'>reject</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='symbol val'>:blank?</span><span class='rparen token'>)</span>
  <span class='order identifier id'>order</span><span class='dot token'>.</span><span class='map! fid id'>map!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='string val'>'DESC'</span> <span class='if if_mod kw'>if</span> <span class='s identifier id'>s</span> <span class='match op'>=~</span> <span class='regexp val'>/\bdesc$/i</span> <span class='rbrace token'>}</span>
  <span class='order identifier id'>order</span> <span class='assign token'>=</span> <span class='order identifier id'>order</span><span class='dot token'>.</span><span class='zip identifier id'>zip</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='order identifier id'>order</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='comma token'>,</span><span class='i identifier id'>i</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;id_list.alias_#{i} #{s}&quot;</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>', '</span><span class='rparen token'>)</span>
  
  <span class='sql identifier id'>sql</span><span class='dot token'>.</span><span class='replace identifier id'>replace</span> <span class='dstring node'>&quot;SELECT * FROM (#{sql}) AS id_list ORDER BY #{order}&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>begin_db_transaction</h3>
</div><div id="begin_db_transaction-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>begin_db_transaction</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Begins a transaction.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


541
542
543</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 541</span>

<span class='def def kw'>def</span> <span class='begin_db_transaction identifier id'>begin_db_transaction</span>
  <span class='execute identifier id'>execute</span> <span class='string val'>&quot;BEGIN&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>change_column</h3>
</div><div id="change_column-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>change_column</span><span class='args'>(table_name, column_name, type, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Changes the column of a table.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 823</span>

<span class='def def kw'>def</span> <span class='change_column identifier id'>change_column</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='comma token'>,</span> <span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='quoted_table_name identifier id'>quoted_table_name</span> <span class='assign token'>=</span> <span class='quote_table_name identifier id'>quote_table_name</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='rparen token'>)</span>

  <span class='begin begin kw'>begin</span>
    <span class='execute identifier id'>execute</span> <span class='dstring node'>&quot;ALTER TABLE #{quoted_table_name} ALTER COLUMN #{quote_column_name(column_name)} TYPE #{type_to_sql(type, options[:limit], options[:precision], options[:scale])}&quot;</span>
  <span class='rescue rescue kw'>rescue</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='StatementInvalid constant id'>StatementInvalid</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
    <span class='raise identifier id'>raise</span> <span class='e identifier id'>e</span> <span class='if if_mod kw'>if</span> <span class='postgresql_version identifier id'>postgresql_version</span> <span class='gt op'>&gt;</span> <span class='integer val'>80000</span>
    <span class='comment val'># This is PostgreSQL 7.x, so we have to use a more arcane way of doing it.</span>
    <span class='begin begin kw'>begin</span>
      <span class='begin_db_transaction identifier id'>begin_db_transaction</span>
      <span class='tmp_column_name identifier id'>tmp_column_name</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{column_name}_ar_tmp&quot;</span>
      <span class='add_column identifier id'>add_column</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='tmp_column_name identifier id'>tmp_column_name</span><span class='comma token'>,</span> <span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
      <span class='execute identifier id'>execute</span> <span class='dstring node'>&quot;UPDATE #{quoted_table_name} SET #{quote_column_name(tmp_column_name)} = CAST(#{quote_column_name(column_name)} AS #{type_to_sql(type, options[:limit], options[:precision], options[:scale])})&quot;</span>
      <span class='remove_column identifier id'>remove_column</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='rparen token'>)</span>
      <span class='rename_column identifier id'>rename_column</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='tmp_column_name identifier id'>tmp_column_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='rparen token'>)</span>
      <span class='commit_db_transaction identifier id'>commit_db_transaction</span>
    <span class='rescue rescue kw'>rescue</span>
      <span class='rollback_db_transaction identifier id'>rollback_db_transaction</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='change_column_default identifier id'>change_column_default</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:default</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='options_include_default? fid id'>options_include_default?</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='change_column_null identifier id'>change_column_null</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:null</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:default</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='key? fid id'>key?</span><span class='lparen token'>(</span><span class='symbol val'>:null</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>change_column_default</h3>
</div><div id="change_column_default-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>change_column_default</span><span class='args'>(table_name, column_name, default)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Changes the default value of a table column.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


849
850
851</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 849</span>

<span class='def def kw'>def</span> <span class='change_column_default identifier id'>change_column_default</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='comma token'>,</span> <span class='default identifier id'>default</span><span class='rparen token'>)</span>
  <span class='execute identifier id'>execute</span> <span class='dstring node'>&quot;ALTER TABLE #{quote_table_name(table_name)} ALTER COLUMN #{quote_column_name(column_name)} SET DEFAULT #{quote(default)}&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>change_column_null</h3>
</div><div id="change_column_null-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>change_column_null</span><span class='args'>(table_name, column_name, null, default = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


853
854
855
856
857
858</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 853</span>

<span class='def def kw'>def</span> <span class='change_column_null identifier id'>change_column_null</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='comma token'>,</span> <span class='null identifier id'>null</span><span class='comma token'>,</span> <span class='default identifier id'>default</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='null identifier id'>null</span> <span class='orop op'>||</span> <span class='default identifier id'>default</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;UPDATE #{quote_table_name(table_name)} SET #{quote_column_name(column_name)}=#{quote(default)} WHERE #{quote_column_name(column_name)} IS NULL&quot;</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;ALTER TABLE #{quote_table_name(table_name)} ALTER #{quote_column_name(column_name)} #{null ? 'DROP' : 'SET'} NOT NULL&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>client_min_messages</h3>
</div><div id="client_min_messages-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>client_min_messages</span><span class='args'>=(level)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set the client message level.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


722
723
724</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 722</span>

<span class='def def kw'>def</span> <span class='client_min_messages= identifier id'>client_min_messages=</span><span class='lparen token'>(</span><span class='level identifier id'>level</span><span class='rparen token'>)</span>
  <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;SET client_min_messages TO '#{level}'&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>columns</h3>
</div><div id="columns-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>columns</span><span class='args'>(table_name, name = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the list of all column definitions for a table.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


678
679
680
681
682
683</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 678</span>

<span class='def def kw'>def</span> <span class='columns identifier id'>columns</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='comment val'># Limit, precision, and scale are all handled by the superclass.</span>
  <span class='column_definitions identifier id'>column_definitions</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='default identifier id'>default</span><span class='comma token'>,</span> <span class='notnull identifier id'>notnull</span><span class='bitor op'>|</span>
    <span class='PostgreSQLColumn constant id'>PostgreSQLColumn</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='default identifier id'>default</span><span class='comma token'>,</span> <span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='notnull identifier id'>notnull</span> <span class='eq op'>==</span> <span class='string val'>'f'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>commit_db_transaction</h3>
</div><div id="commit_db_transaction-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>commit_db_transaction</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Commits a transaction.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


546
547
548</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 546</span>

<span class='def def kw'>def</span> <span class='commit_db_transaction identifier id'>commit_db_transaction</span>
  <span class='execute identifier id'>execute</span> <span class='string val'>&quot;COMMIT&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>create_database</h3>
</div><div id="create_database-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create_database</span><span class='args'>(name, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new PostgreSQL database. Options include <tt>:owner</tt>,
<tt>:template</tt>, <tt>:encoding</tt>, <tt>:tablespace</tt>, and
<tt>:connection_limit</tt> (note that MySQL uses <tt>:charset</tt> while
PostgreSQL uses <tt>:encoding</tt>).
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='create_database identifier id'>create_database</span> <span class='config identifier id'>config</span><span class='lbrack token'>[</span><span class='symbol val'>:database</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='config identifier id'>config</span>
  <span class='create_database identifier id'>create_database</span> <span class='string val'>'foo_development'</span><span class='comma token'>,</span> <span class='symbol val'>:encoding</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'unicode'</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 589</span>

<span class='def def kw'>def</span> <span class='create_database identifier id'>create_database</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='reverse_merge identifier id'>reverse_merge</span><span class='lparen token'>(</span><span class='symbol val'>:encoding</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;utf8&quot;</span><span class='rparen token'>)</span>

  <span class='option_string identifier id'>option_string</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='symbolize_keys identifier id'>symbolize_keys</span><span class='dot token'>.</span><span class='sum identifier id'>sum</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='case case kw'>case</span> <span class='key identifier id'>key</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:owner</span>
      <span class='dstring node'>&quot; OWNER = \&quot;#{value}\&quot;&quot;</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:template</span>
      <span class='dstring node'>&quot; TEMPLATE = \&quot;#{value}\&quot;&quot;</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:encoding</span>
      <span class='dstring node'>&quot; ENCODING = '#{value}'&quot;</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:tablespace</span>
      <span class='dstring node'>&quot; TABLESPACE = \&quot;#{value}\&quot;&quot;</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:connection_limit</span>
      <span class='dstring node'>&quot; CONNECTION LIMIT = #{value}&quot;</span>
    <span class='else else kw'>else</span>
      <span class='string val'>&quot;&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='execute identifier id'>execute</span> <span class='dstring node'>&quot;CREATE DATABASE #{quote_table_name(name)}#{option_string}&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>create_savepoint</h3>
</div><div id="create_savepoint-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create_savepoint</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


563
564
565</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 563</span>

<span class='def def kw'>def</span> <span class='create_savepoint identifier id'>create_savepoint</span>
  <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;SAVEPOINT #{current_savepoint_name}&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>current_database</h3>
</div><div id="current_database-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>current_database</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the current database name.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


686
687
688</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 686</span>

<span class='def def kw'>def</span> <span class='current_database identifier id'>current_database</span>
  <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>'select current_database()'</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>default_sequence_name</h3>
</div><div id="default_sequence_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>default_sequence_name</span><span class='args'>(table_name, pk = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the sequence name for a table&#8217;s primary key or some other
specified key.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


727
728
729
730</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 727</span>

<span class='def def kw'>def</span> <span class='default_sequence_name identifier id'>default_sequence_name</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='pk identifier id'>pk</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='default_pk identifier id'>default_pk</span><span class='comma token'>,</span> <span class='default_seq identifier id'>default_seq</span> <span class='assign token'>=</span> <span class='pk_and_sequence_for identifier id'>pk_and_sequence_for</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='rparen token'>)</span>
  <span class='default_seq identifier id'>default_seq</span> <span class='orop op'>||</span> <span class='dstring node'>&quot;#{table_name}_#{pk || default_pk || 'id'}_seq&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>disable_referential_integrity</h3>
</div><div id="disable_referential_integrity-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>disable_referential_integrity</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  
</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


438
439
440
441
442
443
444
445
446
447</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 438</span>

<span class='def def kw'>def</span> <span class='disable_referential_integrity identifier id'>disable_referential_integrity</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='if if kw'>if</span> <span class='supports_disable_referential_integrity? fid id'>supports_disable_referential_integrity?</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='then then kw'>then</span>
    <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='tables identifier id'>tables</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;ALTER TABLE #{quote_table_name(name)} DISABLE TRIGGER ALL&quot;</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;;&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='yield yield kw'>yield</span>
<span class='ensure ensure kw'>ensure</span>
  <span class='if if kw'>if</span> <span class='supports_disable_referential_integrity? fid id'>supports_disable_referential_integrity?</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='then then kw'>then</span>
    <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='tables identifier id'>tables</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;ALTER TABLE #{quote_table_name(name)} ENABLE TRIGGER ALL&quot;</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;;&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>disconnect!</h3>
</div><div id="disconnect%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>disconnect!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Close the connection.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


239
240
241</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 239</span>

<span class='def def kw'>def</span> <span class='disconnect! fid id'>disconnect!</span>
  <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='close identifier id'>close</span> <span class='rescue rescue kw'>rescue</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>distinct</h3>
</div><div id="distinct-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>distinct</span><span class='args'>(columns, order_by)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a SELECT DISTINCT clause for a given set of columns and a given
ORDER BY clause.
</p>
<p>
PostgreSQL requires the ORDER BY columns in the select list for distinct
queries, and requires that the ORDER BY include the distinct column.
</p>
<pre class="code">
  <span class='distinct identifier id'>distinct</span><span class='lparen token'>(</span><span class='string val'>&quot;posts.id&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;posts.created_at desc&quot;</span><span class='rparen token'>)</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


888
889
890
891
892
893
894
895
896
897
898
899
900
901</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 888</span>

<span class='def def kw'>def</span> <span class='distinct identifier id'>distinct</span><span class='lparen token'>(</span><span class='columns identifier id'>columns</span><span class='comma token'>,</span> <span class='order_by identifier id'>order_by</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='return return kw'>return</span> <span class='dstring node'>&quot;DISTINCT #{columns}&quot;</span> <span class='if if_mod kw'>if</span> <span class='order_by identifier id'>order_by</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>

  <span class='comment val'># Construct a clean list of column names from the ORDER BY clause, removing</span>
  <span class='comment val'># any ASC/DESC modifiers</span>
  <span class='order_columns identifier id'>order_columns</span> <span class='assign token'>=</span> <span class='order_by identifier id'>order_by</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='dot token'>.</span><span class='first identifier id'>first</span> <span class='rbrace token'>}</span>
  <span class='order_columns identifier id'>order_columns</span><span class='dot token'>.</span><span class='delete_if identifier id'>delete_if</span> <span class='bitand op'>&amp;</span><span class='symbol val'>:blank?</span>
  <span class='order_columns identifier id'>order_columns</span> <span class='assign token'>=</span> <span class='order_columns identifier id'>order_columns</span><span class='dot token'>.</span><span class='zip identifier id'>zip</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='order_columns identifier id'>order_columns</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='comma token'>,</span><span class='i identifier id'>i</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;#{s} AS alias_#{i}&quot;</span> <span class='rbrace token'>}</span>

  <span class='comment val'># Return a DISTINCT ON() clause that's distinct on the columns we want but includes</span>
  <span class='comment val'># all the required columns for the ORDER BY to work properly.</span>
  <span class='sql identifier id'>sql</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;DISTINCT ON (#{columns}) #{columns}, &quot;</span>
  <span class='sql identifier id'>sql</span> <span class='lshft op'>&lt;&lt;</span> <span class='order_columns identifier id'>order_columns</span> <span class='mult op'>*</span> <span class='string val'>', '</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>drop_database</h3>
</div><div id="drop_database-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>drop_database</span><span class='args'>(name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Drops a PostgreSQL database
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='drop_database identifier id'>drop_database</span> <span class='string val'>'matt_development'</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


616
617
618
619
620
621
622
623
624
625
626</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 616</span>

<span class='def def kw'>def</span> <span class='drop_database identifier id'>drop_database</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='if if kw'>if</span> <span class='postgresql_version identifier id'>postgresql_version</span> <span class='geq op'>&gt;=</span> <span class='integer val'>80200</span>
    <span class='execute identifier id'>execute</span> <span class='dstring node'>&quot;DROP DATABASE IF EXISTS #{quote_table_name(name)}&quot;</span>
  <span class='else else kw'>else</span>
    <span class='begin begin kw'>begin</span>
      <span class='execute identifier id'>execute</span> <span class='dstring node'>&quot;DROP DATABASE #{quote_table_name(name)}&quot;</span>
    <span class='rescue rescue kw'>rescue</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='StatementInvalid constant id'>StatementInvalid</span>
      <span class='@logger ivar id'>@logger</span><span class='dot token'>.</span><span class='warn identifier id'>warn</span> <span class='dstring node'>&quot;#{name} database doesn't exist.&quot;</span> <span class='if if_mod kw'>if</span> <span class='@logger ivar id'>@logger</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>encoding</h3>
</div><div id="encoding-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>encoding</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the current database encoding format.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


691
692
693</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 691</span>

<span class='def def kw'>def</span> <span class='encoding identifier id'>encoding</span>
  <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>&quot;SELECT pg_encoding_to_char(pg_database.encoding) FROM pg_database\nWHERE pg_database.datname LIKE '\#{current_database}'\n&quot;</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>escape_bytea</h3>
</div><div id="escape_bytea-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>escape_bytea</span><span class='args'>(value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
QUOTING ================================================== Escapes binary
strings for bytea input to the database.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 289</span>

<span class='def def kw'>def</span> <span class='escape_bytea identifier id'>escape_bytea</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='PGconn constant id'>PGconn</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='escape_bytea identifier id'>escape_bytea</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='instance_eval identifier id'>instance_eval</span> <span class='do do kw'>do</span>
      <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span><span class='symbol val'>:escape_bytea</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
        <span class='PGconn constant id'>PGconn</span><span class='dot token'>.</span><span class='escape_bytea identifier id'>escape_bytea</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='value identifier id'>value</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='instance_eval identifier id'>instance_eval</span> <span class='do do kw'>do</span>
      <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span><span class='symbol val'>:escape_bytea</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
        <span class='if if kw'>if</span> <span class='value identifier id'>value</span>
          <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='string val'>''</span>
          <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='each_byte identifier id'>each_byte</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='c identifier id'>c</span><span class='bitor op'>|</span> <span class='result identifier id'>result</span> <span class='lshft op'>&lt;&lt;</span> <span class='sprintf identifier id'>sprintf</span><span class='lparen token'>(</span><span class='string val'>'\\\\%03o'</span><span class='comma token'>,</span> <span class='c identifier id'>c</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
          <span class='result identifier id'>result</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='escape_bytea identifier id'>escape_bytea</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>execute</h3>
</div><div id="execute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>execute</span><span class='args'>(sql, name = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Executes an SQL statement, returning a PGresult object on success or
raising a PGError exception otherwise.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


525
526
527
528
529
530
531
532
533</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 525</span>

<span class='def def kw'>def</span> <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='comma token'>,</span> <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='if if kw'>if</span> <span class='@async ivar id'>@async</span>
      <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='async_exec identifier id'>async_exec</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='exec identifier id'>exec</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>indexes</h3>
</div><div id="indexes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>indexes</span><span class='args'>(table_name, name = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the list of all indexes for a table.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 641</span>

<span class='def def kw'>def</span> <span class='indexes identifier id'>indexes</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
   <span class='schemas identifier id'>schemas</span> <span class='assign token'>=</span> <span class='schema_search_path identifier id'>schema_search_path</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/,/</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='p identifier id'>p</span><span class='bitor op'>|</span> <span class='quote identifier id'>quote</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span>
   <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>&quot;SELECT distinct i.relname, d.indisunique, a.attname\nFROM pg_class t, pg_class i, pg_index d, pg_attribute a\nWHERE i.relkind = 'i'\nAND d.indexrelid = i.oid\nAND d.indisprimary = 'f'\nAND t.oid = d.indrelid\nAND t.relname = '\#{table_name}'\nAND i.relnamespace IN (SELECT oid FROM pg_namespace WHERE nspname IN (\#{schemas}) )\nAND a.attrelid = t.oid\nAND ( d.indkey[0]=a.attnum OR d.indkey[1]=a.attnum\nOR d.indkey[2]=a.attnum OR d.indkey[3]=a.attnum\nOR d.indkey[4]=a.attnum OR d.indkey[5]=a.attnum\nOR d.indkey[6]=a.attnum OR d.indkey[7]=a.attnum\nOR d.indkey[8]=a.attnum OR d.indkey[9]=a.attnum )\nORDER BY i.relname\n&quot;</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='rparen token'>)</span>

  <span class='current_index identifier id'>current_index</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='indexes identifier id'>indexes</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='row identifier id'>row</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='current_index identifier id'>current_index</span> <span class='neq op'>!=</span> <span class='row identifier id'>row</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
      <span class='indexes identifier id'>indexes</span> <span class='lshft op'>&lt;&lt;</span> <span class='IndexDefinition constant id'>IndexDefinition</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='row identifier id'>row</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='row identifier id'>row</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;t&quot;</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='current_index identifier id'>current_index</span> <span class='assign token'>=</span> <span class='row identifier id'>row</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='end end kw'>end</span>

    <span class='indexes identifier id'>indexes</span><span class='dot token'>.</span><span class='last identifier id'>last</span><span class='dot token'>.</span><span class='columns identifier id'>columns</span> <span class='lshft op'>&lt;&lt;</span> <span class='row identifier id'>row</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>

  <span class='indexes identifier id'>indexes</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>insert</h3>
</div><div id="insert-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>insert</span><span class='args'>(sql, name = nil, pk = nil, id_value = nil, sequence_name = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Executes an INSERT query and returns the new record&#8217;s ID
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 458</span>

<span class='def def kw'>def</span> <span class='insert identifier id'>insert</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='comma token'>,</span> <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='pk identifier id'>pk</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='id_value identifier id'>id_value</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='sequence_name identifier id'>sequence_name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='comment val'># Extract the table from the insert sql. Yuck.</span>
  <span class='table identifier id'>table</span> <span class='assign token'>=</span> <span class='sql identifier id'>sql</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>&quot; &quot;</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='string val'>'&quot;'</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>

  <span class='comment val'># Try an insert with 'returning id' if available (PG &gt;= 8.2)</span>
  <span class='if if kw'>if</span> <span class='supports_insert_with_returning? fid id'>supports_insert_with_returning?</span>
    <span class='pk identifier id'>pk</span><span class='comma token'>,</span> <span class='sequence_name identifier id'>sequence_name</span> <span class='assign token'>=</span> <span class='mult op'>*</span><span class='pk_and_sequence_for identifier id'>pk_and_sequence_for</span><span class='lparen token'>(</span><span class='table identifier id'>table</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='pk identifier id'>pk</span>
    <span class='if if kw'>if</span> <span class='pk identifier id'>pk</span>
      <span class='id identifier id'>id</span> <span class='assign token'>=</span> <span class='select_value identifier id'>select_value</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{sql} RETURNING #{quote_column_name(pk)}&quot;</span><span class='rparen token'>)</span>
      <span class='clear_query_cache identifier id'>clear_query_cache</span>
      <span class='return return kw'>return</span> <span class='id identifier id'>id</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Otherwise, insert then grab last_insert_id.</span>
  <span class='if if kw'>if</span> <span class='insert_id identifier id'>insert_id</span> <span class='assign token'>=</span> <span class='super super kw'>super</span>
    <span class='insert_id identifier id'>insert_id</span>
  <span class='else else kw'>else</span>
    <span class='comment val'># If neither pk nor sequence name is given, look them up.</span>
    <span class='unless unless kw'>unless</span> <span class='pk identifier id'>pk</span> <span class='orop op'>||</span> <span class='sequence_name identifier id'>sequence_name</span>
      <span class='pk identifier id'>pk</span><span class='comma token'>,</span> <span class='sequence_name identifier id'>sequence_name</span> <span class='assign token'>=</span> <span class='mult op'>*</span><span class='pk_and_sequence_for identifier id'>pk_and_sequence_for</span><span class='lparen token'>(</span><span class='table identifier id'>table</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># If a pk is given, fallback to default sequence name.</span>
    <span class='comment val'># Don't fetch last insert id for a table without a pk.</span>
    <span class='if if kw'>if</span> <span class='pk identifier id'>pk</span> <span class='andop op'>&amp;&amp;</span> <span class='sequence_name identifier id'>sequence_name</span> <span class='opasgn op'>||=</span> <span class='default_sequence_name identifier id'>default_sequence_name</span><span class='lparen token'>(</span><span class='table identifier id'>table</span><span class='comma token'>,</span> <span class='pk identifier id'>pk</span><span class='rparen token'>)</span>
      <span class='last_insert_id identifier id'>last_insert_id</span><span class='lparen token'>(</span><span class='table identifier id'>table</span><span class='comma token'>,</span> <span class='sequence_name identifier id'>sequence_name</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>native_database_types</h3>
</div><div id="native_database_types-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>native_database_types</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


243
244
245</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 243</span>

<span class='def def kw'>def</span> <span class='native_database_types identifier id'>native_database_types</span> 
  <span class='NATIVE_DATABASE_TYPES constant id'>NATIVE_DATABASE_TYPES</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pk_and_sequence_for</h3>
</div><div id="pk_and_sequence_for-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pk_and_sequence_for</span><span class='args'>(table)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a table&#8217;s primary key and belonging sequence.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 754</span>

<span class='def def kw'>def</span> <span class='pk_and_sequence_for identifier id'>pk_and_sequence_for</span><span class='lparen token'>(</span><span class='table identifier id'>table</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='comment val'># First try looking for a sequence with a dependency on the</span>
  <span class='comment val'># given table's primary key.</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>&quot;SELECT attr.attname, seq.relname\nFROM pg_class      seq,\npg_attribute  attr,\npg_depend     dep,\npg_namespace  name,\npg_constraint cons\nWHERE seq.oid           = dep.objid\nAND seq.relkind       = 'S'\nAND attr.attrelid     = dep.refobjid\nAND attr.attnum       = dep.refobjsubid\nAND attr.attrelid     = cons.conrelid\nAND attr.attnum       = cons.conkey[1]\nAND cons.contype      = 'p'\nAND dep.refobjid      = '\#{table}'::regclass\n&quot;</span><span class='comma token'>,</span> <span class='string val'>'PK and serial sequence'</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>

  <span class='if if kw'>if</span> <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span> <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='comment val'># If that fails, try parsing the primary key's default value.</span>
    <span class='comment val'># Support the 7.x and 8.0 nextval('foo'::text) as well as</span>
    <span class='comment val'># the 8.1+ nextval('foo'::regclass).</span>
    <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>&quot;SELECT attr.attname,\nCASE\nWHEN split_part(def.adsrc, '''', 2) ~ '.' THEN\nsubstr(split_part(def.adsrc, '''', 2),\nstrpos(split_part(def.adsrc, '''', 2), '.')+1)\nELSE split_part(def.adsrc, '''', 2)\nEND\nFROM pg_class       t\nJOIN pg_attribute   attr ON (t.oid = attrelid)\nJOIN pg_attrdef     def  ON (adrelid = attrelid AND adnum = attnum)\nJOIN pg_constraint  cons ON (conrelid = adrelid AND adnum = conkey[1])\nWHERE t.oid = '\#{table}'::regclass\nAND cons.contype = 'p'\nAND def.adsrc ~* 'nextval'\n&quot;</span><span class='comma token'>,</span> <span class='string val'>'PK and custom sequence'</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># [primary_key, sequence]</span>
  <span class='lbrack token'>[</span><span class='result identifier id'>result</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='comma token'>,</span> <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='last identifier id'>last</span><span class='rbrack token'>]</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>query</h3>
</div><div id="query-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>query</span><span class='args'>(sql, name = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Queries the database and returns the results in an Array-like object
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


512
513
514
515
516
517
518
519
520
521</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 512</span>

<span class='def def kw'>def</span> <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='comma token'>,</span> <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='if if kw'>if</span> <span class='@async ivar id'>@async</span>
      <span class='res identifier id'>res</span> <span class='assign token'>=</span> <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='async_exec identifier id'>async_exec</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='res identifier id'>res</span> <span class='assign token'>=</span> <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='exec identifier id'>exec</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='return return kw'>return</span> <span class='result_as_array identifier id'>result_as_array</span><span class='lparen token'>(</span><span class='res identifier id'>res</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>quote</h3>
</div><div id="quote-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>quote</span><span class='args'>(value, column = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Quotes PostgreSQL-specific data types for SQL input.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 357</span>

<span class='def def kw'>def</span> <span class='quote identifier id'>quote</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='column identifier id'>column</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='if if kw'>if</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='String constant id'>String</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='column identifier id'>column</span> <span class='andop op'>&amp;&amp;</span> <span class='column identifier id'>column</span><span class='dot token'>.</span><span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='colon op'>:</span><span class='binary identifier id'>binary</span>
    <span class='dstring node'>&quot;#{quoted_string_prefix}'#{escape_bytea(value)}'&quot;</span>
  <span class='elsif elsif kw'>elsif</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='String constant id'>String</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='column identifier id'>column</span> <span class='andop op'>&amp;&amp;</span> <span class='column identifier id'>column</span><span class='dot token'>.</span><span class='sql_type identifier id'>sql_type</span> <span class='match op'>=~</span> <span class='regexp val'>/^xml$/</span>
    <span class='dstring node'>&quot;xml '#{quote_string(value)}'&quot;</span>
  <span class='elsif elsif kw'>elsif</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Numeric constant id'>Numeric</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='column identifier id'>column</span> <span class='andop op'>&amp;&amp;</span> <span class='column identifier id'>column</span><span class='dot token'>.</span><span class='sql_type identifier id'>sql_type</span> <span class='match op'>=~</span> <span class='regexp val'>/^money$/</span>
    <span class='comment val'># Not truly string input, so doesn't require (or allow) escape string syntax.</span>
    <span class='dstring node'>&quot;'#{value.to_s}'&quot;</span>
  <span class='elsif elsif kw'>elsif</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='String constant id'>String</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='column identifier id'>column</span> <span class='andop op'>&amp;&amp;</span> <span class='column identifier id'>column</span><span class='dot token'>.</span><span class='sql_type identifier id'>sql_type</span> <span class='match op'>=~</span> <span class='regexp val'>/^bit/</span>
    <span class='case case kw'>case</span> <span class='value identifier id'>value</span>
      <span class='when when kw'>when</span> <span class='regexp val'>/^[01]*$/</span>
        <span class='dstring node'>&quot;B'#{value}'&quot;</span> <span class='comment val'># Bit-string notation</span>
      <span class='when when kw'>when</span> <span class='regexp val'>/^[0-9A-F]*$/i</span>
        <span class='dstring node'>&quot;X'#{value}'&quot;</span> <span class='comment val'># Hexadecimal notation</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='super super kw'>super</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>quote_column_name</h3>
</div><div id="quote_column_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>quote_column_name</span><span class='args'>(name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Quotes column names for use in SQL queries.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


415
416
417</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 415</span>

<span class='def def kw'>def</span> <span class='quote_column_name identifier id'>quote_column_name</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='PGconn constant id'>PGconn</span><span class='dot token'>.</span><span class='quote_ident identifier id'>quote_ident</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>quote_string</h3>
</div><div id="quote_string-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>quote_string</span><span class='args'>(s)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Quotes strings for use in SQL input in the postgres driver for better
performance.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 378</span>

<span class='def def kw'>def</span> <span class='quote_string identifier id'>quote_string</span><span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='if if kw'>if</span> <span class='PGconn constant id'>PGconn</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='escape identifier id'>escape</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='instance_eval identifier id'>instance_eval</span> <span class='do do kw'>do</span>
      <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span><span class='symbol val'>:quote_string</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
        <span class='PGconn constant id'>PGconn</span><span class='dot token'>.</span><span class='escape identifier id'>escape</span><span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='comment val'># There are some incorrectly compiled postgres drivers out there</span>
    <span class='comment val'># that don't define PGconn.escape.</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='instance_eval identifier id'>instance_eval</span> <span class='do do kw'>do</span>
      <span class='remove_method identifier id'>remove_method</span><span class='lparen token'>(</span><span class='symbol val'>:quote_string</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='quote_string identifier id'>quote_string</span><span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>quote_table_name</h3>
</div><div id="quote_table_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>quote_table_name</span><span class='args'>(name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Checks the following cases:
</p>
<ul>
<li>table_name

</li>
<li>&quot;table.name&quot;

</li>
<li>schema_name.table_name

</li>
<li>schema_name.&quot;table.name&quot;

</li>
<li>&quot;schema.name&quot;.table_name

</li>
<li>&quot;schema.name&quot;.&quot;table.name&quot;

</li>
</ul>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


403
404
405
406
407
408
409
410
411
412</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 403</span>

<span class='def def kw'>def</span> <span class='quote_table_name identifier id'>quote_table_name</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='schema identifier id'>schema</span><span class='comma token'>,</span> <span class='name_part identifier id'>name_part</span> <span class='assign token'>=</span> <span class='extract_pg_identifier_from_name identifier id'>extract_pg_identifier_from_name</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rparen token'>)</span>

  <span class='unless unless kw'>unless</span> <span class='name_part identifier id'>name_part</span>
    <span class='quote_column_name identifier id'>quote_column_name</span><span class='lparen token'>(</span><span class='schema identifier id'>schema</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='name_part identifier id'>name_part</span> <span class='assign token'>=</span> <span class='extract_pg_identifier_from_name identifier id'>extract_pg_identifier_from_name</span><span class='lparen token'>(</span><span class='name_part identifier id'>name_part</span><span class='rparen token'>)</span>
    <span class='dstring node'>&quot;#{quote_column_name(schema)}.#{quote_column_name(table_name)}&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>quoted_date</h3>
</div><div id="quoted_date-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>quoted_date</span><span class='args'>(value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Quote date/time values for use in SQL input. Includes microseconds if the
value is a Time responding to usec.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


421
422
423
424
425
426
427</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 421</span>

<span class='def def kw'>def</span> <span class='quoted_date identifier id'>quoted_date</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='if if kw'>if</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='acts_like? fid id'>acts_like?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='time identifier id'>time</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='usec identifier id'>usec</span><span class='rparen token'>)</span>
    <span class='dstring node'>&quot;#{super}.#{sprintf(&quot;%06d&quot;, value.usec)}&quot;</span>
  <span class='else else kw'>else</span>
    <span class='super super kw'>super</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reconnect!</h3>
</div><div id="reconnect%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reconnect!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Close then reopen the connection.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


228
229
230
231
232
233
234
235
236</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 228</span>

<span class='def def kw'>def</span> <span class='reconnect! fid id'>reconnect!</span>
  <span class='if if kw'>if</span> <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='reset identifier id'>reset</span><span class='rparen token'>)</span>
    <span class='@connection ivar id'>@connection</span><span class='dot token'>.</span><span class='reset identifier id'>reset</span>
    <span class='configure_connection identifier id'>configure_connection</span>
  <span class='else else kw'>else</span>
    <span class='disconnect! fid id'>disconnect!</span>
    <span class='connect identifier id'>connect</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>recreate_database</h3>
</div><div id="recreate_database-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>recreate_database</span><span class='args'>(name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
SCHEMA STATEMENTS ========================================
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


577
578
579
580</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 577</span>

<span class='def def kw'>def</span> <span class='recreate_database identifier id'>recreate_database</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='drop_database identifier id'>drop_database</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='create_database identifier id'>create_database</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>release_savepoint</h3>
</div><div id="release_savepoint-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>release_savepoint</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


571
572
573</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 571</span>

<span class='def def kw'>def</span> <span class='release_savepoint identifier id'>release_savepoint</span>
  <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;RELEASE SAVEPOINT #{current_savepoint_name}&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_index</h3>
</div><div id="remove_index-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_index</span><span class='args'>(table_name, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Drops an index from a table.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


866
867
868</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 866</span>

<span class='def def kw'>def</span> <span class='remove_index identifier id'>remove_index</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='execute identifier id'>execute</span> <span class='dstring node'>&quot;DROP INDEX #{index_name(table_name, options)}&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rename_column</h3>
</div><div id="rename_column-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rename_column</span><span class='args'>(table_name, column_name, new_column_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Renames a column in a table.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


861
862
863</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 861</span>

<span class='def def kw'>def</span> <span class='rename_column identifier id'>rename_column</span><span class='lparen token'>(</span><span class='table_name identifier id'>table_name</span><span class='comma token'>,</span> <span class='column_name identifier id'>column_name</span><span class='comma token'>,</span> <span class='new_column_name identifier id'>new_column_name</span><span class='rparen token'>)</span>
  <span class='execute identifier id'>execute</span> <span class='dstring node'>&quot;ALTER TABLE #{quote_table_name(table_name)} RENAME COLUMN #{quote_column_name(column_name)} TO #{quote_column_name(new_column_name)}&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rename_table</h3>
</div><div id="rename_table-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rename_table</span><span class='args'>(name, new_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Renames a table.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


805
806
807</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 805</span>

<span class='def def kw'>def</span> <span class='rename_table identifier id'>rename_table</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='new_name identifier id'>new_name</span><span class='rparen token'>)</span>
  <span class='execute identifier id'>execute</span> <span class='dstring node'>&quot;ALTER TABLE #{quote_table_name(name)} RENAME TO #{quote_table_name(new_name)}&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reset_pk_sequence!</h3>
</div><div id="reset_pk_sequence%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reset_pk_sequence!</span><span class='args'>(table, pk = nil, sequence = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Resets the sequence of a table&#8217;s primary key to the maximum value.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 733</span>

<span class='def def kw'>def</span> <span class='reset_pk_sequence! fid id'>reset_pk_sequence!</span><span class='lparen token'>(</span><span class='table identifier id'>table</span><span class='comma token'>,</span> <span class='pk identifier id'>pk</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='sequence identifier id'>sequence</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='unless unless kw'>unless</span> <span class='pk identifier id'>pk</span> <span class='and and kw'>and</span> <span class='sequence identifier id'>sequence</span>
    <span class='default_pk identifier id'>default_pk</span><span class='comma token'>,</span> <span class='default_sequence identifier id'>default_sequence</span> <span class='assign token'>=</span> <span class='pk_and_sequence_for identifier id'>pk_and_sequence_for</span><span class='lparen token'>(</span><span class='table identifier id'>table</span><span class='rparen token'>)</span>
    <span class='pk identifier id'>pk</span> <span class='opasgn op'>||=</span> <span class='default_pk identifier id'>default_pk</span>
    <span class='sequence identifier id'>sequence</span> <span class='opasgn op'>||=</span> <span class='default_sequence identifier id'>default_sequence</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='pk identifier id'>pk</span>
    <span class='if if kw'>if</span> <span class='sequence identifier id'>sequence</span>
      <span class='quoted_sequence identifier id'>quoted_sequence</span> <span class='assign token'>=</span> <span class='quote_column_name identifier id'>quote_column_name</span><span class='lparen token'>(</span><span class='sequence identifier id'>sequence</span><span class='rparen token'>)</span>

      <span class='select_value identifier id'>select_value</span> <span class='string val'>&quot;SELECT setval('\#{quoted_sequence}', (SELECT COALESCE(MAX(\#{quote_column_name pk})+(SELECT increment_by FROM \#{quoted_sequence}), (SELECT min_value FROM \#{quoted_sequence})) FROM \#{quote_table_name(table)}), false)\n&quot;</span><span class='comma token'>,</span> <span class='string val'>'Reset sequence'</span>
    <span class='else else kw'>else</span>
      <span class='@logger ivar id'>@logger</span><span class='dot token'>.</span><span class='warn identifier id'>warn</span> <span class='dstring node'>&quot;#{table} has primary key #{pk} with no default sequence&quot;</span> <span class='if if_mod kw'>if</span> <span class='@logger ivar id'>@logger</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>result_as_array</h3>
</div><div id="result_as_array-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>result_as_array</span><span class='args'>(res)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
create a 2D array representing the result set
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 490</span>

<span class='def def kw'>def</span> <span class='result_as_array identifier id'>result_as_array</span><span class='lparen token'>(</span><span class='res identifier id'>res</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='comment val'># check if we have any binary column and if they need escaping</span>
  <span class='unescape_col identifier id'>unescape_col</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='for for kw'>for</span> <span class='j identifier id'>j</span> <span class='in in kw'>in</span> <span class='integer val'>0</span><span class='dot3 op'>...</span><span class='res identifier id'>res</span><span class='dot token'>.</span><span class='nfields identifier id'>nfields</span> <span class='do do kw'>do</span>
    <span class='comment val'># unescape string passed BYTEA field (OID == 17)</span>
    <span class='unescape_col identifier id'>unescape_col</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span> <span class='res identifier id'>res</span><span class='dot token'>.</span><span class='ftype identifier id'>ftype</span><span class='lparen token'>(</span><span class='j identifier id'>j</span><span class='rparen token'>)</span><span class='eq op'>==</span><span class='integer val'>17</span> <span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='ary identifier id'>ary</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='for for kw'>for</span> <span class='i identifier id'>i</span> <span class='in in kw'>in</span> <span class='integer val'>0</span><span class='dot3 op'>...</span><span class='res identifier id'>res</span><span class='dot token'>.</span><span class='ntuples identifier id'>ntuples</span> <span class='do do kw'>do</span>
    <span class='ary identifier id'>ary</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='for for kw'>for</span> <span class='j identifier id'>j</span> <span class='in in kw'>in</span> <span class='integer val'>0</span><span class='dot3 op'>...</span><span class='res identifier id'>res</span><span class='dot token'>.</span><span class='nfields identifier id'>nfields</span> <span class='do do kw'>do</span>
      <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='res identifier id'>res</span><span class='dot token'>.</span><span class='getvalue identifier id'>getvalue</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='comma token'>,</span><span class='j identifier id'>j</span><span class='rparen token'>)</span>
      <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='unescape_bytea identifier id'>unescape_bytea</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='unescape_col identifier id'>unescape_col</span><span class='lbrack token'>[</span><span class='j identifier id'>j</span><span class='rbrack token'>]</span> <span class='and and kw'>and</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='String constant id'>String</span><span class='rparen token'>)</span>
      <span class='ary identifier id'>ary</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='data identifier id'>data</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='return return kw'>return</span> <span class='ary identifier id'>ary</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rollback_db_transaction</h3>
</div><div id="rollback_db_transaction-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rollback_db_transaction</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Aborts a transaction.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


551
552
553</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 551</span>

<span class='def def kw'>def</span> <span class='rollback_db_transaction identifier id'>rollback_db_transaction</span>
  <span class='execute identifier id'>execute</span> <span class='string val'>&quot;ROLLBACK&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rollback_to_savepoint</h3>
</div><div id="rollback_to_savepoint-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rollback_to_savepoint</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


567
568
569</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 567</span>

<span class='def def kw'>def</span> <span class='rollback_to_savepoint identifier id'>rollback_to_savepoint</span>
  <span class='execute identifier id'>execute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;ROLLBACK TO SAVEPOINT #{current_savepoint_name}&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>schema_search_path</h3>
</div><div id="schema_search_path-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>schema_search_path</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the active schema search path.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


712
713
714</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 712</span>

<span class='def def kw'>def</span> <span class='schema_search_path identifier id'>schema_search_path</span>
  <span class='@schema_search_path ivar id'>@schema_search_path</span> <span class='opasgn op'>||=</span> <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>'SHOW search_path'</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>select_rows</h3>
</div><div id="select_rows-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>select_rows</span><span class='args'>(sql, name = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
DATABASE STATEMENTS ====================================== Executes a
SELECT query and returns an array of rows. Each row is an array of field
values.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


453
454
455</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 453</span>

<span class='def def kw'>def</span> <span class='select_rows identifier id'>select_rows</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='comma token'>,</span> <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='select_raw identifier id'>select_raw</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='last identifier id'>last</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>supports_ddl_transactions?</h3>
</div><div id="supports_ddl_transactions%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>supports_ddl_transactions?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


272
273
274</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 272</span>

<span class='def def kw'>def</span> <span class='supports_ddl_transactions? fid id'>supports_ddl_transactions?</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>supports_disable_referential_integrity?</h3>
</div><div id="supports_disable_referential_integrity%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>supports_disable_referential_integrity?</span><span class='args'>() </span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
REFERENTIAL INTEGRITY ====================================
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


431
432
433
434
435
436</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 431</span>

<span class='def def kw'>def</span> <span class='supports_disable_referential_integrity? fid id'>supports_disable_referential_integrity?</span><span class='lparen token'>(</span><span class='rparen token'>)</span> 
  <span class='version identifier id'>version</span> <span class='assign token'>=</span> <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>&quot;SHOW server_version&quot;</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'.'</span><span class='rparen token'>)</span>
  <span class='lparen token'>(</span><span class='version identifier id'>version</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='geq op'>&gt;=</span> <span class='integer val'>8</span> <span class='andop op'>&amp;&amp;</span> <span class='version identifier id'>version</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='geq op'>&gt;=</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='true true kw'>true</span> <span class='colon op'>:</span> <span class='false false kw'>false</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='return return kw'>return</span> <span class='false false kw'>false</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>supports_insert_with_returning?</h3>
</div><div id="supports_insert_with_returning%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>supports_insert_with_returning?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


268
269
270</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 268</span>

<span class='def def kw'>def</span> <span class='supports_insert_with_returning? fid id'>supports_insert_with_returning?</span>
  <span class='postgresql_version identifier id'>postgresql_version</span> <span class='geq op'>&gt;=</span> <span class='integer val'>80200</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>supports_migrations?</h3>
</div><div id="supports_migrations%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>supports_migrations?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Does PostgreSQL support migrations?
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


248
249
250</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 248</span>

<span class='def def kw'>def</span> <span class='supports_migrations? fid id'>supports_migrations?</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>supports_savepoints?</h3>
</div><div id="supports_savepoints%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>supports_savepoints?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


276
277
278</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 276</span>

<span class='def def kw'>def</span> <span class='supports_savepoints? fid id'>supports_savepoints?</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>supports_standard_conforming_strings?</h3>
</div><div id="supports_standard_conforming_strings%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>supports_standard_conforming_strings?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Does PostgreSQL support standard conforming strings?
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


253
254
255
256
257
258
259
260
261
262
263
264
265
266</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 253</span>

<span class='def def kw'>def</span> <span class='supports_standard_conforming_strings? fid id'>supports_standard_conforming_strings?</span>
  <span class='comment val'># Temporarily set the client message level above error to prevent unintentional</span>
  <span class='comment val'># error messages in the logs when working on a PostgreSQL database server that</span>
  <span class='comment val'># does not support standard conforming strings.</span>
  <span class='client_min_messages_old identifier id'>client_min_messages_old</span> <span class='assign token'>=</span> <span class='client_min_messages identifier id'>client_min_messages</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='client_min_messages identifier id'>client_min_messages</span> <span class='assign token'>=</span> <span class='string val'>'panic'</span>

  <span class='comment val'># postgres-pr does not raise an exception when client_min_messages is set higher</span>
  <span class='comment val'># than error and &quot;SHOW standard_conforming_strings&quot; fails, but returns an empty</span>
  <span class='comment val'># PGresult instead.</span>
  <span class='has_support identifier id'>has_support</span> <span class='assign token'>=</span> <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>'SHOW standard_conforming_strings'</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='rescue rescue kw'>rescue</span> <span class='false false kw'>false</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='client_min_messages identifier id'>client_min_messages</span> <span class='assign token'>=</span> <span class='client_min_messages_old identifier id'>client_min_messages_old</span>
  <span class='has_support identifier id'>has_support</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>table_alias_length</h3>
</div><div id="table_alias_length-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>table_alias_length</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the configured supported identifier length supported by PostgreSQL,
or report the default of 63 on PostgreSQL 7.x.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


282
283
284</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 282</span>

<span class='def def kw'>def</span> <span class='table_alias_length identifier id'>table_alias_length</span>
  <span class='@table_alias_length ivar id'>@table_alias_length</span> <span class='opasgn op'>||=</span> <span class='lparen token'>(</span><span class='postgresql_version identifier id'>postgresql_version</span> <span class='geq op'>&gt;=</span> <span class='integer val'>80000</span> <span class='question op'>?</span> <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>'SHOW max_identifier_length'</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='colon op'>:</span> <span class='integer val'>63</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>tables</h3>
</div><div id="tables-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>tables</span><span class='args'>(name = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the list of all tables in the schema search path or a specified
schema.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


630
631
632
633</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 630</span>

<span class='def def kw'>def</span> <span class='tables identifier id'>tables</span><span class='lparen token'>(</span><span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='schemas identifier id'>schemas</span> <span class='assign token'>=</span> <span class='schema_search_path identifier id'>schema_search_path</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/,/</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='p identifier id'>p</span><span class='bitor op'>|</span> <span class='quote identifier id'>quote</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span>
  <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>&quot;SELECT tablename\nFROM pg_tables\nWHERE schemaname IN (\#{schemas})\n&quot;</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='row identifier id'>row</span><span class='bitor op'>|</span> <span class='row identifier id'>row</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>type_to_sql</h3>
</div><div id="type_to_sql-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>type_to_sql</span><span class='args'>(type, limit = nil, precision = nil, scale = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Maps logical Rails types to PostgreSQL-specific data types.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


871
872
873
874
875
876
877
878
879
880</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 871</span>

<span class='def def kw'>def</span> <span class='type_to_sql identifier id'>type_to_sql</span><span class='lparen token'>(</span><span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='precision identifier id'>precision</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='scale identifier id'>scale</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='super super kw'>super</span> <span class='unless unless_mod kw'>unless</span> <span class='type identifier id'>type</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='eq op'>==</span> <span class='string val'>'integer'</span>

  <span class='case case kw'>case</span> <span class='limit identifier id'>limit</span>
    <span class='when when kw'>when</span> <span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>2</span><span class='semicolon token'>;</span>      <span class='string val'>'smallint'</span>
    <span class='when when kw'>when</span> <span class='float val'>3</span><span class='dot2 op'>..</span><span class='integer val'>4</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='semicolon token'>;</span> <span class='string val'>'integer'</span>
    <span class='when when kw'>when</span> <span class='float val'>5</span><span class='dot2 op'>..</span><span class='integer val'>8</span><span class='semicolon token'>;</span>      <span class='string val'>'bigint'</span>
    <span class='else else kw'>else</span> <span class='raise identifier id'>raise</span><span class='lparen token'>(</span><span class='ActiveRecordError constant id'>ActiveRecordError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;No integer type has byte size #{limit}. Use a numeric with precision 0 instead.&quot;</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>unescape_bytea</h3>
</div><div id="unescape_bytea-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>unescape_bytea</span><span class='args'>(value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Unescapes bytea output from a database to the binary string it represents.
NOTE: This is NOT an inverse of escape_bytea! This is only to be used
</p>
<pre class="code">
      <span class='on identifier id'>on</span> <span class='escaped identifier id'>escaped</span> <span class='binary identifier id'>binary</span> <span class='output identifier id'>output</span> <span class='from identifier id'>from</span> <span class='database identifier id'>database</span> <span class='drive identifier id'>drive</span><span class='dot token'>.</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 313</span>

<span class='def def kw'>def</span> <span class='unescape_bytea identifier id'>unescape_bytea</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='comment val'># In each case, check if the value actually is escaped PostgreSQL bytea output</span>
  <span class='comment val'># or an unescaped Active Record attribute that was just written.</span>
  <span class='if if kw'>if</span> <span class='PGconn constant id'>PGconn</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='unescape_bytea identifier id'>unescape_bytea</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='instance_eval identifier id'>instance_eval</span> <span class='do do kw'>do</span>
      <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span><span class='symbol val'>:unescape_bytea</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
        <span class='if if kw'>if</span> <span class='value identifier id'>value</span> <span class='match op'>=~</span> <span class='regexp val'>/\\\d{3}/</span>
          <span class='PGconn constant id'>PGconn</span><span class='dot token'>.</span><span class='unescape_bytea identifier id'>unescape_bytea</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
          <span class='value identifier id'>value</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='instance_eval identifier id'>instance_eval</span> <span class='do do kw'>do</span>
      <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span><span class='symbol val'>:unescape_bytea</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
        <span class='if if kw'>if</span> <span class='value identifier id'>value</span> <span class='match op'>=~</span> <span class='regexp val'>/\\\d{3}/</span>
          <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='string val'>''</span>
          <span class='i identifier id'>i</span><span class='comma token'>,</span> <span class='max identifier id'>max</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
          <span class='while while kw'>while</span> <span class='i identifier id'>i</span> <span class='lt op'>&lt;</span> <span class='max identifier id'>max</span>
            <span class='char identifier id'>char</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span>
            <span class='if if kw'>if</span> <span class='char identifier id'>char</span> <span class='eq op'>==</span> <span class='integer val'>?\\</span>
              <span class='if if kw'>if</span> <span class='value identifier id'>value</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>?\\</span>
                <span class='char identifier id'>char</span> <span class='assign token'>=</span> <span class='integer val'>?\\</span>
                <span class='i identifier id'>i</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
              <span class='else else kw'>else</span>
                <span class='char identifier id'>char</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='plus op'>+</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='i identifier id'>i</span><span class='plus op'>+</span><span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='oct identifier id'>oct</span>
                <span class='i identifier id'>i</span> <span class='opasgn op'>+=</span> <span class='integer val'>3</span>
              <span class='end end kw'>end</span>
            <span class='end end kw'>end</span>
            <span class='result identifier id'>result</span> <span class='lshft op'>&lt;&lt;</span> <span class='char identifier id'>char</span>
            <span class='i identifier id'>i</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
          <span class='end end kw'>end</span>
          <span class='result identifier id'>result</span>
        <span class='else else kw'>else</span>
          <span class='value identifier id'>value</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='unescape_bytea identifier id'>unescape_bytea</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_sql</h3>
</div><div id="update_sql-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_sql</span><span class='args'>(sql, name = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Executes an UPDATE query and returns the number of affected tuples.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


536
537
538</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb', line 536</span>

<span class='def def kw'>def</span> <span class='update_sql identifier id'>update_sql</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='comma token'>,</span> <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='super super kw'>super</span><span class='dot token'>.</span><span class='cmd_tuples identifier id'>cmd_tuples</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>