<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Module: ActionView::Helpers::PrototypeHelper</title>
  </head>
  <body>
    <div id="content">
      <div class="section module ActionView_Helpers_PrototypeHelper">
  <h1 class="title">Module: ActionView::Helpers::PrototypeHelper</h1>
  <div class="section docstring">
  <p>
Prototype[http://www.prototypejs.org/] is a JavaScript library that
provides DOM[http://en.wikipedia.org/wiki/Document_Object_Model]
manipulation,
Ajax[http://www.adaptivepath.com/publications/essays/archives/000385.php]
functionality, and more traditional object-oriented facilities for
JavaScript. This module provides a set of helpers to make it more
convenient to call functions from Prototype using Rails, including
functionality to call remote Rails methods (that is, making a background
request to a Rails action) using Ajax. This means that you can call actions
in your controllers without reloading the page, but still update certain
parts of it using injections into the DOM. A common use case is having a
form that adds a new element to a list without reloading the page or
updating a shopping cart total when a new item is added.
</p>
<h2>Usage</h2>
<p>
To be able to use these helpers, you must first include the Prototype
JavaScript framework in your pages.
</p>
<pre class="code">
 <span class='javascript_include_tag identifier id'>javascript_include_tag</span> <span class='string val'>'prototype'</span>
</pre>
<p>
(See the documentation for ActionView::Helpers::JavaScriptHelper for more
information on including this and other JavaScript files in your Rails
templates.)
</p>
<p>
Now you&#8217;re ready to call a remote action either through a link&#8230;
</p>
<pre class="code">
 <span class='link_to_remote identifier id'>link_to_remote</span> <span class='string val'>&quot;Add to cart&quot;</span><span class='comma token'>,</span>
   <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;add&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='product identifier id'>product</span><span class='dot token'>.</span><span class='id identifier id'>id</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
   <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:success</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;cart&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:failure</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;error&quot;</span> <span class='rbrace token'>}</span>
</pre>
<p>
&#8230;through a form&#8230;
</p>
<pre class="code">
 <span class='lt op'>&lt;</span><span class='string val'>% form_remote_tag </span><span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'/shipping'</span> <span class='do do kw'>do</span> <span class='minus op'>-</span><span class='string val'>%&gt;
   &lt;div&gt;</span><span class='lt op'>&lt;</span><span class='string val'>%= submit_tag 'Recalculate Shipping' %&gt;&lt;/div&gt;
 &lt;% end -%&gt;
</span></pre>
<p>
&#8230;periodically&#8230;
</p>
<pre class="code">
 <span class='periodically_call_remote identifier id'>periodically_call_remote</span><span class='lparen token'>(</span><span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'update'</span><span class='comma token'>,</span> <span class='symbol val'>:frequency</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'5'</span><span class='comma token'>,</span> <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'ticker'</span><span class='rparen token'>)</span>
</pre>
<p>
&#8230;or through an observer (i.e., a form or field that is observed and
calls a remote action when changed).
</p>
<pre class="code">
 <span class='lt op'>&lt;</span><span class='string val'>%= observe_field(:searchbox,
      :url =</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:live_search</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span><span class='comma token'>,</span>
      <span class='symbol val'>:frequency</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='integer val'>.5</span><span class='comma token'>,</span>
      <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:hits</span><span class='comma token'>,</span>
      <span class='symbol val'>:with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'query'</span>
      <span class='string val'>%&gt;
</span></pre>
<p>
As you can see, there are numerous ways to use Prototype&#8217;s Ajax
functions (and actually more than are listed here); check out the
documentation for each method to find out more about its usage and options.
</p>
<h3>Common Options</h3>
<p>
See link_to_remote for documentation of options common to all Ajax helpers;
any of the options specified by link_to_remote can be used by the other
helpers.
</p>
<h2>Designing your Rails actions for Ajax</h2>
<p>
When building your action handlers (that is, the Rails actions that receive
your background requests), it&#8217;s important to remember a few things.
First, whatever your action would normally return to the browser, it will
return to the Ajax call. As such, you typically don&#8217;t want to render
with a layout. This call will cause the layout to be transmitted back to
your page, and, if you have a full HTML/CSS, will likely mess a lot of
things up. You can turn the layout off on particular actions by doing the
following:
</p>
<pre class="code">
 <span class='class class kw'>class</span> <span class='SiteController constant id'>SiteController</span> <span class='lt op'>&lt;</span> <span class='ActionController constant id'>ActionController</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
   <span class='layout identifier id'>layout</span> <span class='string val'>&quot;standard&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:except</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='symbol val'>:ajax_method</span><span class='comma token'>,</span> <span class='symbol val'>:more_ajax</span><span class='comma token'>,</span> <span class='symbol val'>:another_ajax</span><span class='rbrack token'>]</span>
 <span class='end end kw'>end</span>
</pre>
<p>
Optionally, you could do this in the method you wish to lack a layout:
</p>
<pre class="code">
 <span class='render identifier id'>render</span> <span class='symbol val'>:layout</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span>
</pre>
<p>
You can tell the type of request from within your action using the
<tt>request.xhr?</tt> (XmlHttpRequest, the method that Ajax uses to make
background requests) method.
</p>
<pre class="code">
 <span class='def def kw'>def</span> <span class='name identifier id'>name</span>
   <span class='comment val'># Is this an XmlHttpRequest request?</span>
   <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='xhr? fid id'>xhr?</span><span class='rparen token'>)</span>
     <span class='render identifier id'>render</span> <span class='symbol val'>:text</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@name ivar id'>@name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
   <span class='else else kw'>else</span>
     <span class='comment val'># No?  Then render an action.</span>
     <span class='render identifier id'>render</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'view_attribute'</span><span class='comma token'>,</span> <span class='symbol val'>:attr</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@name ivar id'>@name</span>
   <span class='end end kw'>end</span>
 <span class='end end kw'>end</span>
</pre>
<p>
The else clause can be left off and the current action will render with
full layout and template. An extension to this solution was posted to Ryan
Heneise&#8217;s blog at
ArtOfMission[&quot;http://www.artofmission.com/&quot;].
</p>
<pre class="code">
 <span class='layout identifier id'>layout</span> <span class='proc identifier id'>proc</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='c identifier id'>c</span><span class='bitor op'>|</span> <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='xhr? fid id'>xhr?</span> <span class='integer val'>? </span><span class='false false kw'>false</span> <span class='colon op'>:</span> <span class='string val'>&quot;application&quot;</span> <span class='rbrace token'>}</span>
</pre>
<p>
Dropping this in your ApplicationController turns the layout off for every
request that is an &quot;xhr&quot; request.
</p>
<p>
If you are just returning a little data or don&#8217;t want to build a
template for your output, you may opt to simply render text output, like
this:
</p>
<pre class="code">
 <span class='render identifier id'>render</span> <span class='symbol val'>:text</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Return this from my method!'</span>
</pre>
<p>
Since whatever the method returns is injected into the DOM, this will
simply inject some text (or HTML, if you tell it to). This is usually how
small updates, such updating a cart total or a file count, are handled.
</p>
<h2>Updating multiple elements</h2>
<p>
See JavaScriptGenerator for information on updating multiple elements on
the page in an Ajax response.
</p>

</div><div class="section constants">
  
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#button_to_remote-instance_method' title='#button_to_remote'>#button_to_remote</a></span><span class='args'>(name, options = {}, html_options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Creates a button with an onclick event which calls a remote action via
XMLHttpRequest The options for specifying the target with :url and defining
callbacks is the same as link_to_remote.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#evaluate_remote_response-instance_method' title='#evaluate_remote_response'>#evaluate_remote_response</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns &#8217;&lt;tt&gt;eval(request.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#form_remote_tag-instance_method' title='#form_remote_tag'>#form_remote_tag</a></span><span class='args'>(options = {}, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a form tag that will submit using XMLHttpRequest in the background
instead of the regular reloading POST arrangement.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#link_to_remote-instance_method' title='#link_to_remote'>#link_to_remote</a></span><span class='args'>(name, options = {}, html_options = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a link to a remote action defined by <tt>options[:url]</tt> (using
the url_for format) that&#8217;s called in the background using
XMLHttpRequest.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#observe_field-instance_method' title='#observe_field'>#observe_field</a></span><span class='args'>(field_id, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Observes the field with the DOM ID specified by <tt>field_id</tt> and calls
a callback when its contents have changed.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#observe_form-instance_method' title='#observe_form'>#observe_form</a></span><span class='args'>(form_id, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Observes the form with the DOM ID specified by <tt>form_id</tt> and calls a
callback when its contents have changed.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#periodically_call_remote-instance_method' title='#periodically_call_remote'>#periodically_call_remote</a></span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Periodically calls the specified url (<tt>options[:url]</tt>) every
<tt>options[:frequency]</tt> seconds (default is 10).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#remote_form_for-instance_method' title='#remote_form_for'>#remote_form_for</a></span><span class='args'>(record_or_name_or_array, *args, &amp;proc)</span>
        <span class='block'></span>
        
          <span class='alias'>#form_remote_for</span>
        
      </th>
      <td class="docstring">
        <p>
Creates a form that will submit using XMLHttpRequest in the background
instead of the regular reloading POST arrangement and a scope around a
specific resource that is used as a base for questioning about values for
the fields.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#remote_function-instance_method' title='#remote_function'>#remote_function</a></span><span class='args'>(options)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the JavaScript needed for a remote function.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#submit_to_remote-instance_method' title='#submit_to_remote'>#submit_to_remote</a></span><span class='args'>(name, value, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a button input tag with the element name of <tt>name</tt> and a
value (i.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#update_page-instance_method' title='#update_page'>#update_page</a></span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Yields a JavaScriptGenerator and returns the generated JavaScript code.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#update_page_tag-instance_method' title='#update_page_tag'>#update_page_tag</a></span><span class='args'>(html_options = {}, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Works like update_page but wraps the generated JavaScript in a
&lt;script&gt; tag.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>button_to_remote</h3>
</div><div id="button_to_remote-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>button_to_remote</span><span class='args'>(name, options = {}, html_options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Creates a button with an onclick event which calls a remote action via
XMLHttpRequest The options for specifying the target with :url and defining
callbacks is the same as link_to_remote.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


263
264
265</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 263</span>

<span class='def def kw'>def</span> <span class='button_to_remote identifier id'>button_to_remote</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='html_options identifier id'>html_options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='button_to_function identifier id'>button_to_function</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='remote_function identifier id'>remote_function</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='html_options identifier id'>html_options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>evaluate_remote_response</h3>
</div><div id="evaluate_remote_response-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>evaluate_remote_response</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns &#8216;<tt>eval(request.responseText)</tt>&#8217; which is the
JavaScript function that <tt>form_remote_tag</tt> can call in
<tt>:complete</tt> to evaluate a multiple update return document using
<tt>update_element_function</tt> calls.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


433
434
435</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 433</span>

<span class='def def kw'>def</span> <span class='evaluate_remote_response identifier id'>evaluate_remote_response</span>
  <span class='string val'>&quot;eval(request.responseText)&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>form_remote_tag</h3>
</div><div id="form_remote_tag-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>form_remote_tag</span><span class='args'>(options = {}, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a form tag that will submit using XMLHttpRequest in the background
instead of the regular reloading POST arrangement. Even though it&#8217;s
using JavaScript to serialize the form elements, the form submission will
work just like a regular submission as viewed by the receiving side (all
elements available in <tt>params</tt>). The options for specifying the
target with <tt>:url</tt> and defining callbacks is the same as
<tt>link_to_remote</tt>.
</p>
<p>
A &quot;fall-through&quot; target for browsers that doesn&#8217;t do
JavaScript can be specified with the <tt>:action</tt>/<tt>:method</tt>
options on <tt>:html</tt>.
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='comment val'># Generates:</span>
  <span class='comment val'>#      &lt;form action=&quot;/some/place&quot; method=&quot;post&quot; onsubmit=&quot;new Ajax.Request('',</span>
  <span class='comment val'>#      {asynchronous:true, evalScripts:true, parameters:Form.serialize(this)}); return false;&quot;&gt;</span>
  <span class='form_remote_tag identifier id'>form_remote_tag</span> <span class='symbol val'>:html</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span>
    <span class='url_for identifier id'>url_for</span><span class='lparen token'>(</span><span class='symbol val'>:controller</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;some&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;place&quot;</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
</pre>
<p>
The Hash passed to the <tt>:html</tt> key is equivalent to the options
(2nd) argument in the FormTagHelper.form_tag method.
</p>
<p>
By default the fall-through action is the same as the one specified in the
<tt>:url</tt> (and the default method is <tt>:post</tt>).
</p>
<p>
form_remote_tag also takes a block, like form_tag:
</p>
<pre class="code">
  <span class='comment val'># Generates:</span>
  <span class='comment val'>#     &lt;form action=&quot;/&quot; method=&quot;post&quot; onsubmit=&quot;new Ajax.Request('/',</span>
  <span class='comment val'>#     {asynchronous:true, evalScripts:true, parameters:Form.serialize(this)});</span>
  <span class='comment val'>#     return false;&quot;&gt; &lt;div&gt;&lt;input name=&quot;commit&quot; type=&quot;submit&quot; value=&quot;Save&quot; /&gt;&lt;/div&gt;</span>
  <span class='comment val'>#     &lt;/form&gt;</span>
  <span class='lt op'>&lt;</span><span class='string val'>% form_remote_tag </span><span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'/posts'</span> <span class='do do kw'>do</span> <span class='minus op'>-</span><span class='string val'>%&gt;
    &lt;div&gt;</span><span class='lt op'>&lt;</span><span class='string val'>%= submit_tag 'Save' %&gt;&lt;/div&gt;
  &lt;% end -%&gt;
</span></pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


331
332
333
334
335
336
337
338
339
340</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 331</span>

<span class='def def kw'>def</span> <span class='form_remote_tag identifier id'>form_remote_tag</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:form</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>

  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:html</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:html</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:onsubmit</span><span class='rbrack token'>]</span> <span class='assign token'>=</span>
    <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:html</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:onsubmit</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:html</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:onsubmit</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='string val'>&quot;; &quot;</span> <span class='colon op'>:</span> <span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span> <span class='plus op'>+</span>
    <span class='dstring node'>&quot;#{remote_function(options)}; return false;&quot;</span>

  <span class='form_tag identifier id'>form_tag</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:html</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:action</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='url_for identifier id'>url_for</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:url</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:html</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>link_to_remote</h3>
</div><div id="link_to_remote-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>link_to_remote</span><span class='args'>(name, options = {}, html_options = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a link to a remote action defined by <tt>options[:url]</tt> (using
the url_for format) that&#8217;s called in the background using
XMLHttpRequest. The result of that request can then be inserted into a DOM
object whose id can be specified with <tt>options[:update]</tt>. Usually,
the result would be a partial prepared by the controller with render
:partial.
</p>
<p>
Examples:
</p>
<pre class="code">
  <span class='comment val'># Generates: &lt;a href=&quot;#&quot; onclick=&quot;new Ajax.Updater('posts', '/blog/destroy/3', {asynchronous:true, evalScripts:true});</span>
  <span class='comment val'>#            return false;&quot;&gt;Delete this post&lt;/a&gt;</span>
  <span class='link_to_remote identifier id'>link_to_remote</span> <span class='string val'>&quot;Delete this post&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;posts&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;destroy&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='post identifier id'>post</span><span class='dot token'>.</span><span class='id identifier id'>id</span> <span class='rbrace token'>}</span>

  <span class='comment val'># Generates: &lt;a href=&quot;#&quot; onclick=&quot;new Ajax.Updater('emails', '/mail/list_emails', {asynchronous:true, evalScripts:true});</span>
  <span class='comment val'>#            return false;&quot;&gt;&lt;img alt=&quot;Refresh&quot; src=&quot;/images/refresh.png?&quot; /&gt;&lt;/a&gt;</span>
  <span class='link_to_remote identifier id'>link_to_remote</span><span class='lparen token'>(</span><span class='image_tag identifier id'>image_tag</span><span class='lparen token'>(</span><span class='string val'>&quot;refresh&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;emails&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;list_emails&quot;</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>
<p>
You can override the generated HTML options by specifying a hash in
<tt>options[:html]</tt>.
</p>
<pre class="code">
  <span class='link_to_remote identifier id'>link_to_remote</span> <span class='string val'>&quot;Delete this post&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;posts&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:url</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='post_url identifier id'>post_url</span><span class='lparen token'>(</span><span class='@post ivar id'>@post</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:delete</span><span class='comma token'>,</span>
    <span class='symbol val'>:html</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:class</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;destructive&quot;</span> <span class='rbrace token'>}</span>
</pre>
<p>
You can also specify a hash for <tt>options[:update]</tt> to allow for easy
redirection of output to an other DOM element if a server-side error
occurs:
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='comment val'># Generates: &lt;a href=&quot;#&quot; onclick=&quot;new Ajax.Updater({success:'posts',failure:'error'}, '/blog/destroy/5',</span>
  <span class='comment val'>#            {asynchronous:true, evalScripts:true}); return false;&quot;&gt;Delete this post&lt;/a&gt;</span>
  <span class='link_to_remote identifier id'>link_to_remote</span> <span class='string val'>&quot;Delete this post&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;destroy&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='post identifier id'>post</span><span class='dot token'>.</span><span class='id identifier id'>id</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:success</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;posts&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:failure</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;error&quot;</span> <span class='rbrace token'>}</span>
</pre>
<p>
Optionally, you can use the <tt>options[:position]</tt> parameter to
influence how the target DOM element is updated. It must be one of
<tt>:before</tt>, <tt>:top</tt>, <tt>:bottom</tt>, or <tt>:after</tt>.
</p>
<p>
The method used is by default POST. You can also specify GET or you can
simulate PUT or DELETE over POST. All specified with
<tt>options[:method]</tt>
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='comment val'># Generates: &lt;a href=&quot;#&quot; onclick=&quot;new Ajax.Request('/person/4', {asynchronous:true, evalScripts:true, method:'delete'});</span>
  <span class='comment val'>#            return false;&quot;&gt;Destroy&lt;/a&gt;</span>
  <span class='link_to_remote identifier id'>link_to_remote</span> <span class='string val'>&quot;Destroy&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='person_url identifier id'>person_url</span><span class='lparen token'>(</span><span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='person identifier id'>person</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:delete</span>
</pre>
<p>
By default, these remote requests are processed asynchronous during which
various JavaScript callbacks can be triggered (for progress indicators and
the likes). All callbacks get access to the <tt>request</tt> object, which
holds the underlying XMLHttpRequest.
</p>
<p>
To access the server response, use <tt>request.responseText</tt>, to find
out the HTTP status, use <tt>request.status</tt>.
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='comment val'># Generates: &lt;a href=&quot;#&quot; onclick=&quot;new Ajax.Request('/words/undo?n=33', {asynchronous:true, evalScripts:true,</span>
  <span class='comment val'>#            onComplete:function(request){undoRequestCompleted(request)}}); return false;&quot;&gt;hello&lt;/a&gt;</span>
  <span class='word identifier id'>word</span> <span class='assign token'>=</span> <span class='string val'>'hello'</span>
  <span class='link_to_remote identifier id'>link_to_remote</span> <span class='word identifier id'>word</span><span class='comma token'>,</span>
    <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;undo&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:n</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='word_counter identifier id'>word_counter</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='symbol val'>:complete</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;undoRequestCompleted(request)&quot;</span>
</pre>
<p>
The callbacks that may be specified are (in order):
</p>
<table>
<tr><td valign="top"><tt>:loading</tt>:</td><td>Called when the remote document is being loaded with data by the browser.

</td></tr>
<tr><td valign="top"><tt>:loaded</tt>:</td><td>Called when the browser has finished loading the remote document.

</td></tr>
<tr><td valign="top"><tt>:interactive</tt>:</td><td>Called when the user can interact with the remote document, even though it
has not finished loading.

</td></tr>
<tr><td valign="top"><tt>:success</tt>:</td><td>Called when the XMLHttpRequest is completed, and the HTTP status code is in
the 2XX range.

</td></tr>
<tr><td valign="top"><tt>:failure</tt>:</td><td>Called when the XMLHttpRequest is completed, and the HTTP status code is
not in the 2XX range.

</td></tr>
<tr><td valign="top"><tt>:complete</tt>:</td><td>Called when the XMLHttpRequest is complete (fires after success/failure if
they are present).

</td></tr>
</table>
<p>
You can further refine <tt>:success</tt> and <tt>:failure</tt> by adding
additional callbacks for specific status codes.
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='comment val'># Generates: &lt;a href=&quot;#&quot; onclick=&quot;new Ajax.Request('/testing/action', {asynchronous:true, evalScripts:true,</span>
  <span class='comment val'>#            on404:function(request){alert('Not found...? Wrong URL...?')},</span>
  <span class='comment val'>#            onFailure:function(request){alert('HTTP Error ' + request.status + '!')}}); return false;&quot;&gt;hello&lt;/a&gt;</span>
  <span class='link_to_remote identifier id'>link_to_remote</span> <span class='word identifier id'>word</span><span class='comma token'>,</span>
    <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;action&quot;</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='integer val'>404</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;alert('Not found...? Wrong URL...?')&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:failure</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;alert('HTTP Error ' + request.status + '!')&quot;</span>
</pre>
<p>
A status code callback overrides the success/failure handlers if present.
</p>
<p>
If you for some reason or another need synchronous processing
(that&#8217;ll block the browser while the request is happening), you can
specify <tt>options[:type] = :synchronous</tt>.
</p>
<p>
You can customize further browser side call logic by passing in JavaScript
code snippets via some optional parameters. In their order of use these
are:
</p>
<table>
<tr><td valign="top"><tt>:confirm</tt>:</td><td>Adds confirmation dialog.

</td></tr>
<tr><td valign="top"><tt>:condition</tt>:</td><td>Perform remote request conditionally by this expression. Use this to
describe browser-side conditions when request should not be initiated.

</td></tr>
<tr><td valign="top"><tt>:before</tt>:</td><td>Called before request is initiated.

</td></tr>
<tr><td valign="top"><tt>:after</tt>:</td><td>Called immediately after request was initiated and before
<tt>:loading</tt>.

</td></tr>
<tr><td valign="top"><tt>:submit</tt>:</td><td>Specifies the DOM element ID that&#8217;s used as the parent of the form
elements. By default this is the current form, but it could just as well be
the ID of a table row or any other DOM element.

</td></tr>
<tr><td valign="top"><tt>:with</tt>:</td><td>A JavaScript expression specifying the parameters for the XMLHttpRequest.
Any expressions should return a valid URL query string.

<p>
Example:
</p>
<pre class="code">
  <span class='symbol val'>:with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;'name=' + $('name').value&quot;</span>
</pre>
</td></tr>
</table>
<p>
You can generate a link that uses AJAX in the general case, while degrading
gracefully to plain link behavior in the absence of JavaScript by setting
<tt>html_options[:href]</tt> to an alternate URL. Note the extra curly
braces around the <tt>options</tt> hash separate it as the second parameter
from <tt>html_options</tt>, the third.
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='link_to_remote identifier id'>link_to_remote</span> <span class='string val'>&quot;Delete this post&quot;</span><span class='comma token'>,</span>
    <span class='lbrace token'>{</span> <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;posts&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;destroy&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='post identifier id'>post</span><span class='dot token'>.</span><span class='id identifier id'>id</span> <span class='rbrace token'>}</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='symbol val'>:href</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='url_for identifier id'>url_for</span><span class='lparen token'>(</span><span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;destroy&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='post identifier id'>post</span><span class='dot token'>.</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


255
256
257</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 255</span>

<span class='def def kw'>def</span> <span class='link_to_remote identifier id'>link_to_remote</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='html_options identifier id'>html_options</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='link_to_function identifier id'>link_to_function</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='remote_function identifier id'>remote_function</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='html_options identifier id'>html_options</span> <span class='orop op'>||</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:html</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>observe_field</h3>
</div><div id="observe_field-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>observe_field</span><span class='args'>(field_id, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Observes the field with the DOM ID specified by <tt>field_id</tt> and calls
a callback when its contents have changed. The default callback is an Ajax
call. By default the value of the observed field is sent as a parameter
with the Ajax call.
</p>
<p>
Example:
</p>
<pre class="code">
 <span class='comment val'># Generates: new Form.Element.Observer('suggest', 0.25, function(element, value) {new Ajax.Updater('suggest',</span>
 <span class='comment val'>#         '/testing/find_suggestion', {asynchronous:true, evalScripts:true, parameters:'q=' + value})})</span>
 <span class='lt op'>&lt;</span><span class='string val'>%= observe_field :suggest, :url =</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:find_suggestion</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
      <span class='symbol val'>:frequency</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='integer val'>.25</span><span class='comma token'>,</span>
      <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:suggest</span><span class='comma token'>,</span>
      <span class='symbol val'>:with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'q'</span>
      <span class='string val'>%&gt;
</span></pre>
<p>
Required <tt>options</tt> are either of:
</p>
<table>
<tr><td valign="top"><tt>:url</tt>:</td><td><tt>url_for</tt>-style options for the action to call when the field has
changed.

</td></tr>
<tr><td valign="top"><tt>:function</tt>:</td><td>Instead of making a remote call to a URL, you can specify javascript code
to be called instead. Note that the value of this option is used as the
<b>body</b> of the javascript function, a function definition with
parameters named element and value will be generated for you for example:

<pre class="code">
  <span class='observe_field identifier id'>observe_field</span><span class='lparen token'>(</span><span class='string val'>&quot;glass&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:frequency</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='symbol val'>:function</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;alert('Element changed')&quot;</span><span class='rparen token'>)</span>
</pre>
<p>
will generate:
</p>
<pre class="code">
  <span class='new identifier id'>new</span> <span class='Form constant id'>Form</span><span class='dot token'>.</span><span class='Element constant id'>Element</span><span class='dot token'>.</span><span class='Observer constant id'>Observer</span><span class='lparen token'>(</span><span class='string val'>'glass'</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='function identifier id'>function</span><span class='lparen token'>(</span><span class='element identifier id'>element</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span><span class='alert identifier id'>alert</span><span class='lparen token'>(</span><span class='string val'>'Element changed'</span><span class='rparen token'>)</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>
<p>
The element parameter is the DOM element being observed, and the value is
its value at the time the observer is triggered.
</p>
</td></tr>
</table>
<p>
Additional options are:
</p>
<table>
<tr><td valign="top"><tt>:frequency</tt>:</td><td>The frequency (in seconds) at which changes to this field will be detected.
Not setting this option at all or to a value equal to or less than zero
will use event based observation instead of time based observation.

</td></tr>
<tr><td valign="top"><tt>:update</tt>:</td><td>Specifies the DOM ID of the element whose innerHTML should be updated with
the XMLHttpRequest response text.

</td></tr>
<tr><td valign="top"><tt>:with</tt>:</td><td>A JavaScript expression specifying the parameters for the XMLHttpRequest.
The default is to send the key and value of the observed field. Any custom
expressions should return a valid URL query string. The value of the field
is stored in the JavaScript variable <tt>value</tt>.

<p>
Examples
</p>
<pre class="code">
  <span class='symbol val'>:with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;'my_custom_key=' + value&quot;</span>
  <span class='symbol val'>:with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;'person[name]=' + prompt('New name')&quot;</span>
  <span class='symbol val'>:with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Form.Element.serialize('other-field')&quot;</span>
</pre>
<p>
Finally
</p>
<pre class="code">
  <span class='symbol val'>:with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'name'</span>
</pre>
<p>
is shorthand for
</p>
<pre class="code">
  <span class='symbol val'>:with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;'name=' + value&quot;</span>
</pre>
<p>
This essentially just changes the key of the parameter.
</p>
</td></tr>
</table>
<p>
Additionally, you may specify any of the options documented in the
<em>Common options</em> section at the top of this document.
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='comment val'># Sends params: {:title =&gt; 'Title of the book'} when the book_title input</span>
  <span class='comment val'># field is changed.</span>
  <span class='observe_field identifier id'>observe_field</span> <span class='string val'>'book_title'</span><span class='comma token'>,</span>
    <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'http://example.com/books/edit/1'</span><span class='comma token'>,</span>
    <span class='symbol val'>:with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'title'</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


547
548
549
550
551
552
553</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 547</span>

<span class='def def kw'>def</span> <span class='observe_field identifier id'>observe_field</span><span class='lparen token'>(</span><span class='field_id identifier id'>field_id</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='frequency identifier id'>frequency</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='frequency identifier id'>frequency</span><span class='rbrack token'>]</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='build_observer identifier id'>build_observer</span><span class='lparen token'>(</span><span class='string val'>'Form.Element.Observer'</span><span class='comma token'>,</span> <span class='field_id identifier id'>field_id</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='build_observer identifier id'>build_observer</span><span class='lparen token'>(</span><span class='string val'>'Form.Element.EventObserver'</span><span class='comma token'>,</span> <span class='field_id identifier id'>field_id</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>observe_form</h3>
</div><div id="observe_form-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>observe_form</span><span class='args'>(form_id, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Observes the form with the DOM ID specified by <tt>form_id</tt> and calls a
callback when its contents have changed. The default callback is an Ajax
call. By default all fields of the observed field are sent as parameters
with the Ajax call.
</p>
<p>
The <tt>options</tt> for <tt>observe_form</tt> are the same as the options
for <tt>observe_field</tt>. The JavaScript variable <tt>value</tt>
available to the <tt>:with</tt> option is set to the serialized form by
default.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


563
564
565
566
567
568
569</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 563</span>

<span class='def def kw'>def</span> <span class='observe_form identifier id'>observe_form</span><span class='lparen token'>(</span><span class='form_id identifier id'>form_id</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='frequency identifier id'>frequency</span><span class='rbrack token'>]</span>
    <span class='build_observer identifier id'>build_observer</span><span class='lparen token'>(</span><span class='string val'>'Form.Observer'</span><span class='comma token'>,</span> <span class='form_id identifier id'>form_id</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='build_observer identifier id'>build_observer</span><span class='lparen token'>(</span><span class='string val'>'Form.EventObserver'</span><span class='comma token'>,</span> <span class='form_id identifier id'>form_id</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>periodically_call_remote</h3>
</div><div id="periodically_call_remote-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>periodically_call_remote</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Periodically calls the specified url (<tt>options[:url]</tt>) every
<tt>options[:frequency]</tt> seconds (default is 10). Usually used to
update a specified div (<tt>options[:update]</tt>) with the results of the
remote call. The options for specifying the target with <tt>:url</tt> and
defining callbacks is the same as link_to_remote. Examples:
</p>
<pre class="code">
 <span class='comment val'># Call get_averages and put its results in 'avg' every 10 seconds</span>
 <span class='comment val'># Generates:</span>
 <span class='comment val'>#      new PeriodicalExecuter(function() {new Ajax.Updater('avg', '/grades/get_averages',</span>
 <span class='comment val'>#      {asynchronous:true, evalScripts:true})}, 10)</span>
 <span class='periodically_call_remote identifier id'>periodically_call_remote</span><span class='lparen token'>(</span><span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'get_averages'</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'avg'</span><span class='rparen token'>)</span>

 <span class='comment val'># Call invoice every 10 seconds with the id of the customer</span>
 <span class='comment val'># If it succeeds, update the invoice DIV; if it fails, update the error DIV</span>
 <span class='comment val'># Generates:</span>
 <span class='comment val'>#      new PeriodicalExecuter(function() {new Ajax.Updater({success:'invoice',failure:'error'},</span>
 <span class='comment val'>#      '/testing/invoice/16', {asynchronous:true, evalScripts:true})}, 10)</span>
 <span class='periodically_call_remote identifier id'>periodically_call_remote</span><span class='lparen token'>(</span><span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'invoice'</span><span class='comma token'>,</span> <span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='id identifier id'>id</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:success</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;invoice&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:failure</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;error&quot;</span> <span class='rbrace token'>}</span>

 <span class='comment val'># Call update every 20 seconds and update the new_block DIV</span>
 <span class='comment val'># Generates:</span>
 <span class='comment val'># new PeriodicalExecuter(function() {new Ajax.Updater('news_block', 'update', {asynchronous:true, evalScripts:true})}, 20)</span>
 <span class='periodically_call_remote identifier id'>periodically_call_remote</span><span class='lparen token'>(</span><span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'update'</span><span class='comma token'>,</span> <span class='symbol val'>:frequency</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'20'</span><span class='comma token'>,</span> <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'news_block'</span><span class='rparen token'>)</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


292
293
294
295
296</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 292</span>

<span class='def def kw'>def</span> <span class='periodically_call_remote identifier id'>periodically_call_remote</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
   <span class='frequency identifier id'>frequency</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:frequency</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='integer val'>10</span> <span class='comment val'># every ten seconds by default</span>
   <span class='code identifier id'>code</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;new PeriodicalExecuter(function() {#{remote_function(options)}}, #{frequency})&quot;</span>
   <span class='javascript_tag identifier id'>javascript_tag</span><span class='lparen token'>(</span><span class='code identifier id'>code</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remote_form_for</h3>
</div><div id="remote_form_for-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remote_form_for</span><span class='args'>(record_or_name_or_array, *args, &amp;proc)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="form_remote_for-instance_method">form_remote_for</tt>
  
</p>
</div><div class="section docstring">
  <p>
Creates a form that will submit using XMLHttpRequest in the background
instead of the regular reloading POST arrangement and a scope around a
specific resource that is used as a base for questioning about values for
the fields.
</p>
<h3>Resource</h3>
<p>
Example:
</p>
<pre class="code">
  <span class='lt op'>&lt;</span><span class='string val'>% remote_form_for(@post) </span><span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span> <span class='string val'>%&gt;
    ...
  &lt;% end %&gt;</span>
</pre>
<p>
This will expand to be the same as:
</p>
<pre class="code">
  <span class='lt op'>&lt;</span><span class='string val'>% remote_form_for </span><span class='symbol val'>:post</span><span class='comma token'>,</span> <span class='@post ivar id'>@post</span><span class='comma token'>,</span> <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='post_path identifier id'>post_path</span><span class='lparen token'>(</span><span class='@post ivar id'>@post</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:html</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:put</span><span class='comma token'>,</span> <span class='symbol val'>:class</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;edit_post&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;edit_post_45&quot;</span> <span class='rbrace token'>}</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span> <span class='string val'>%&gt;
    ...
  &lt;% end %&gt;</span>
</pre>
<h3>Nested Resource</h3>
<p>
Example:
</p>
<pre class="code">
  <span class='lt op'>&lt;</span><span class='string val'>% remote_form_for([@post, </span><span class='@comment ivar id'>@comment</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span> <span class='string val'>%&gt;
    ...
  &lt;% end %&gt;</span>
</pre>
<p>
This will expand to be the same as:
</p>
<pre class="code">
  <span class='lt op'>&lt;</span><span class='string val'>% remote_form_for </span><span class='symbol val'>:comment</span><span class='comma token'>,</span> <span class='@comment ivar id'>@comment</span><span class='comma token'>,</span> <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='post_comment_path identifier id'>post_comment_path</span><span class='lparen token'>(</span><span class='@post ivar id'>@post</span><span class='comma token'>,</span> <span class='@comment ivar id'>@comment</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:html</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:put</span><span class='comma token'>,</span> <span class='symbol val'>:class</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;edit_comment&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;edit_comment_45&quot;</span> <span class='rbrace token'>}</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span> <span class='string val'>%&gt;
    ...
  &lt;% end %&gt;</span>
</pre>
<p>
If you don&#8217;t need to attach a form to a resource, then check out
form_remote_tag.
</p>
<p>
See FormHelper#form_for for additional semantics.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 376</span>

<span class='def def kw'>def</span> <span class='remote_form_for identifier id'>remote_form_for</span><span class='lparen token'>(</span><span class='record_or_name_or_array identifier id'>record_or_name_or_array</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='proc identifier id'>proc</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='extract_options! fid id'>extract_options!</span>

  <span class='case case kw'>case</span> <span class='record_or_name_or_array identifier id'>record_or_name_or_array</span>
  <span class='when when kw'>when</span> <span class='String constant id'>String</span><span class='comma token'>,</span> <span class='Symbol constant id'>Symbol</span>
    <span class='object_name identifier id'>object_name</span> <span class='assign token'>=</span> <span class='record_or_name_or_array identifier id'>record_or_name_or_array</span>
  <span class='when when kw'>when</span> <span class='Array constant id'>Array</span>
    <span class='object identifier id'>object</span> <span class='assign token'>=</span> <span class='record_or_name_or_array identifier id'>record_or_name_or_array</span><span class='dot token'>.</span><span class='last identifier id'>last</span>
    <span class='object_name identifier id'>object_name</span> <span class='assign token'>=</span> <span class='ActionController constant id'>ActionController</span><span class='colon2 op'>::</span><span class='RecordIdentifier constant id'>RecordIdentifier</span><span class='dot token'>.</span><span class='singular_class_name identifier id'>singular_class_name</span><span class='lparen token'>(</span><span class='object identifier id'>object</span><span class='rparen token'>)</span>
    <span class='apply_form_for_options! fid id'>apply_form_for_options!</span><span class='lparen token'>(</span><span class='record_or_name_or_array identifier id'>record_or_name_or_array</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='unshift identifier id'>unshift</span> <span class='object identifier id'>object</span>
  <span class='else else kw'>else</span>
    <span class='object identifier id'>object</span>      <span class='assign token'>=</span> <span class='record_or_name_or_array identifier id'>record_or_name_or_array</span>
    <span class='object_name identifier id'>object_name</span> <span class='assign token'>=</span> <span class='ActionController constant id'>ActionController</span><span class='colon2 op'>::</span><span class='RecordIdentifier constant id'>RecordIdentifier</span><span class='dot token'>.</span><span class='singular_class_name identifier id'>singular_class_name</span><span class='lparen token'>(</span><span class='record_or_name_or_array identifier id'>record_or_name_or_array</span><span class='rparen token'>)</span>
    <span class='apply_form_for_options! fid id'>apply_form_for_options!</span><span class='lparen token'>(</span><span class='object identifier id'>object</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='unshift identifier id'>unshift</span> <span class='object identifier id'>object</span>
  <span class='end end kw'>end</span>

  <span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='form_remote_tag identifier id'>form_remote_tag</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='fields_for identifier id'>fields_for</span><span class='lparen token'>(</span><span class='object_name identifier id'>object_name</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='lparen token'>(</span><span class='args identifier id'>args</span> <span class='lshft op'>&lt;&lt;</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='proc identifier id'>proc</span><span class='rparen token'>)</span>
  <span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='string val'>'&lt;/form&gt;'</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remote_function</h3>
</div><div id="remote_function-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remote_function</span><span class='args'>(options)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the JavaScript needed for a remote function. Takes the same
arguments as link_to_remote.
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='comment val'># Generates: &lt;select id=&quot;options&quot; onchange=&quot;new Ajax.Updater('options',</span>
  <span class='comment val'># '/testing/update_options', {asynchronous:true, evalScripts:true})&quot;&gt;</span>
  <span class='lt op'>&lt;</span><span class='select identifier id'>select</span> <span class='id identifier id'>id</span><span class='assign token'>=</span><span class='string val'>&quot;options&quot;</span> <span class='onchange identifier id'>onchange</span><span class='assign token'>=</span><span class='string val'>&quot;&lt;%= remote_function(:update =&gt; &quot;</span><span class='options identifier id'>options</span><span class='string val'>&quot;,
      :url =&gt; { :action =&gt; :update_options }) %&gt;&quot;</span><span class='gt op'>&gt;</span>
    <span class='lt op'>&lt;</span><span class='option identifier id'>option</span> <span class='value identifier id'>value</span><span class='assign token'>=</span><span class='string val'>&quot;0&quot;</span><span class='gt op'>&gt;</span><span class='Hello constant id'>Hello</span><span class='lt op'>&lt;</span><span class='regexp val'>/option&gt;
    &lt;option value=&quot;1&quot;&gt;World&lt;/o</span><span class='ption identifier id'>ption</span><span class='gt op'>&gt;</span>
  <span class='lt op'>&lt;</span><span class='regexp val'>/select&gt;
</span></pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 448</span>

<span class='def def kw'>def</span> <span class='remote_function identifier id'>remote_function</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='javascript_options identifier id'>javascript_options</span> <span class='assign token'>=</span> <span class='options_for_ajax identifier id'>options_for_ajax</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>

  <span class='update identifier id'>update</span> <span class='assign token'>=</span> <span class='string val'>''</span>
  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='update identifier id'>update</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='update identifier id'>update</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span>
    <span class='update identifier id'>update</span>  <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='update identifier id'>update</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;success:'#{options[:update][:success]}'&quot;</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:update</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:success</span><span class='rbrack token'>]</span>
    <span class='update identifier id'>update</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;failure:'#{options[:update][:failure]}'&quot;</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:update</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:failure</span><span class='rbrack token'>]</span>
    <span class='update identifier id'>update</span>  <span class='assign token'>=</span> <span class='string val'>'{'</span> <span class='plus op'>+</span> <span class='update identifier id'>update</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>'}'</span>
  <span class='elsif elsif kw'>elsif</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:update</span><span class='rbrack token'>]</span>
    <span class='update identifier id'>update</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;'#{options[:update]}'&quot;</span>
  <span class='end end kw'>end</span>

  <span class='function identifier id'>function</span> <span class='assign token'>=</span> <span class='update identifier id'>update</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='integer val'>?
</span>    <span class='string val'>&quot;new Ajax.Request(&quot;</span> <span class='colon op'>:</span>
    <span class='dstring node'>&quot;new Ajax.Updater(#{update}, &quot;</span>

  <span class='url_options identifier id'>url_options</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:url</span><span class='rbrack token'>]</span>
  <span class='url_options identifier id'>url_options</span> <span class='assign token'>=</span> <span class='url_options identifier id'>url_options</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:escape</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='url_options identifier id'>url_options</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span>
  <span class='function identifier id'>function</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;'#{escape_javascript(url_for(url_options))}'&quot;</span>
  <span class='function identifier id'>function</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;, #{javascript_options})&quot;</span>

  <span class='function identifier id'>function</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{options[:before]}; #{function}&quot;</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:before</span><span class='rbrack token'>]</span>
  <span class='function identifier id'>function</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{function}; #{options[:after]}&quot;</span>  <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:after</span><span class='rbrack token'>]</span>
  <span class='function identifier id'>function</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;if (#{options[:condition]}) { #{function}; }&quot;</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:condition</span><span class='rbrack token'>]</span>
  <span class='function identifier id'>function</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;if (confirm('#{escape_javascript(options[:confirm])}')) { #{function}; }&quot;</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:confirm</span><span class='rbrack token'>]</span>

  <span class='return return kw'>return</span> <span class='function identifier id'>function</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>submit_to_remote</h3>
</div><div id="submit_to_remote-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>submit_to_remote</span><span class='args'>(name, value, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a button input tag with the element name of <tt>name</tt> and a
value (i.e., display text) of <tt>value</tt> that will submit form using
XMLHttpRequest in the background instead of a regular POST request that
reloads the page.
</p>
<pre class="code">
 <span class='comment val'># Create a button that submits to the create action</span>
 <span class='comment val'>#</span>
 <span class='comment val'># Generates: &lt;input name=&quot;create_btn&quot; onclick=&quot;new Ajax.Request('/testing/create',</span>
 <span class='comment val'>#     {asynchronous:true, evalScripts:true, parameters:Form.serialize(this.form)});</span>
 <span class='comment val'>#     return false;&quot; type=&quot;button&quot; value=&quot;Create&quot; /&gt;</span>
 <span class='lt op'>&lt;</span><span class='string val'>%= submit_to_remote 'create_btn', 'Create', :url =</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'create'</span> <span class='rbrace token'>}</span> <span class='mod op'>%</span><span class='gt op'>&gt;</span>

 <span class='comment val'># Submit to the remote action update and update the DIV succeed or fail based</span>
 <span class='comment val'># on the success or failure of the request</span>
 <span class='comment val'>#</span>
 <span class='comment val'># Generates: &lt;input name=&quot;update_btn&quot; onclick=&quot;new Ajax.Updater({success:'succeed',failure:'fail'},</span>
 <span class='comment val'>#      '/testing/update', {asynchronous:true, evalScripts:true, parameters:Form.serialize(this.form)});</span>
 <span class='comment val'>#      return false;&quot; type=&quot;button&quot; value=&quot;Update&quot; /&gt;</span>
 <span class='lt op'>&lt;</span><span class='string val'>%= submit_to_remote 'update_btn', 'Update', :url =</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:action</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'update'</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='symbol val'>:update</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:success</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;succeed&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:failure</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;fail&quot;</span> <span class='rbrace token'>}</span>
</pre>
<p>
<tt>options</tt> argument is the same as in form_remote_tag.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


421
422
423
424
425
426
427
428</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 421</span>

<span class='def def kw'>def</span> <span class='submit_to_remote identifier id'>submit_to_remote</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:with</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>'Form.serialize(this.form)'</span>

  <span class='html_options identifier id'>html_options</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:html</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='html_options identifier id'>html_options</span><span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='name identifier id'>name</span>

  <span class='button_to_remote identifier id'>button_to_remote</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='html_options identifier id'>html_options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_page</h3>
</div><div id="update_page-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_page</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Yields a JavaScriptGenerator and returns the generated JavaScript code. Use
this to update multiple elements on a page in an Ajax response. See
JavaScriptGenerator for more information.
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='update_page identifier id'>update_page</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='page identifier id'>page</span><span class='bitor op'>|</span>
    <span class='page identifier id'>page</span><span class='dot token'>.</span><span class='hide identifier id'>hide</span> <span class='string val'>'spinner'</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


1028
1029
1030</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 1028</span>

<span class='def def kw'>def</span> <span class='update_page identifier id'>update_page</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='JavaScriptGenerator constant id'>JavaScriptGenerator</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='@template ivar id'>@template</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_page_tag</h3>
</div><div id="update_page_tag-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_page_tag</span><span class='args'>(html_options = {}, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Works like update_page but wraps the generated JavaScript in a
&lt;script&gt; tag. Use this to include generated JavaScript in an ERb
template. See JavaScriptGenerator for more information.
</p>
<p>
<tt>html_options</tt> may be a hash of &lt;script&gt; attributes to be
passed to ActionView::Helpers::JavaScriptHelper#javascript_tag.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


1038
1039
1040</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_view/helpers/prototype_helper.rb', line 1038</span>

<span class='def def kw'>def</span> <span class='update_page_tag identifier id'>update_page_tag</span><span class='lparen token'>(</span><span class='html_options identifier id'>html_options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='javascript_tag identifier id'>javascript_tag</span> <span class='update_page identifier id'>update_page</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='html_options identifier id'>html_options</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>