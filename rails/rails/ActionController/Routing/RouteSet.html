<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: ActionController::Routing::RouteSet</title>
  </head>
  <body>
    <div id="content">
      <div class="section class ActionController_Routing_RouteSet">
  <h1 class="title">Class: ActionController::Routing::RouteSet</h1>
  <div class="section inheritance">
  <ul>
  <li><a href='../../Object.html' title='Object'>Object</a></li><ul><li>ActionController::Routing::RouteSet</li>
  </ul></ul>
</div><div class="section docstring">
  <p>
BEFORE: 0.191446860631307 ms/url AFTER: 0.029847304022858 ms/url Speed up:
6.4 times
</p>
<p>
Route recognition is slow due to one-by-one iterating over a whole routeset
(each map.resources generates at least 14 routes) and matching weird
regexps on each step.
</p>
<p>
We optimize this by skipping all URI segments that 100% sure can&#8217;t be
matched, moving deeper in a tree of routes (where node == segment) until
first possible match is accured. In such case, we start walking a flat list
of routes, matching them with accurate matcher. So, first step: search a
segment tree for the first relevant index. Second step: iterate routes
starting with that index.
</p>
<p>
How tree is walked? We can do a recursive tests, but it&#8217;s smarter: We
just create a tree of if-s and elsif-s matching segments.
</p>
<p>
We have segments of 3 flavors: 1) nil (no segment, route finished) 2)
const-dot-dynamic (like &quot;/posts.:xml&quot;,
&quot;/preview.:size.jpg&quot;) 3) const (like &quot;/posts&quot;,
&quot;/comments&quot;) 4) dynamic (&quot;/:id&quot;,
&quot;file.:size.:extension&quot;)
</p>
<p>
We split incoming string into segments and iterate over them. When segment
is nil, we drop immediately, on a current node index. When segment is equal
to some const, we step into branch. If none constants matched, we step into
&#8216;dynamic&#8217; branch (it&#8217;s a last). If we can&#8217;t match
anything, we drop to last index on a level.
</p>
<p>
Note: we maintain the original routes order, so we finish building
</p>
<pre class="code">
      <span class='steps identifier id'>steps</span> <span class='on identifier id'>on</span> <span class='a identifier id'>a</span> <span class='first identifier id'>first</span> <span class='dynamic identifier id'>dynamic</span> <span class='segment identifier id'>segment</span><span class='dot token'>.</span>
</pre>
<p>
Example. Given the routes:
</p>
<pre class="code">
  <span class='integer val'>0</span> <span class='div op'>/</span><span class='posts identifier id'>posts</span><span class='div op'>/</span>
  <span class='integer val'>1</span> <span class='div op'>/</span><span class='posts identifier id'>posts</span><span class='div op'>/</span><span class='symbol val'>:id</span>
  <span class='integer val'>2</span> <span class='div op'>/</span><span class='posts identifier id'>posts</span><span class='div op'>/</span><span class='symbol val'>:id</span><span class='div op'>/</span><span class='comments identifier id'>comments</span>
  <span class='integer val'>3</span> <span class='div op'>/</span><span class='posts identifier id'>posts</span><span class='div op'>/</span><span class='blah identifier id'>blah</span>
  <span class='integer val'>4</span> <span class='div op'>/</span><span class='users identifier id'>users</span><span class='div op'>/</span>
  <span class='integer val'>5</span> <span class='div op'>/</span><span class='users identifier id'>users</span><span class='div op'>/</span><span class='symbol val'>:id</span>
  <span class='integer val'>6</span> <span class='div op'>/</span><span class='users identifier id'>users</span><span class='div op'>/</span><span class='symbol val'>:id</span><span class='div op'>/</span><span class='profile identifier id'>profile</span>
</pre>
<p>
request_uri = /users/123
</p>
<p>
There will be only 4 iterations:
</p>
<pre class="code">
 <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='segm identifier id'>segm</span> <span class='test identifier id'>test</span> <span class='for for kw'>for</span> <span class='regexp val'>/posts prefix, skip all /</span><span class='posts identifier id'>posts</span><span class='div op'>/</span><span class='mult op'>*</span> <span class='routes identifier id'>routes</span>
 <span class='integer val'>2</span><span class='rparen token'>)</span> <span class='segm identifier id'>segm</span> <span class='test identifier id'>test</span> <span class='for for kw'>for</span> <span class='regexp val'>/users/</span>
 <span class='integer val'>3</span><span class='rparen token'>)</span> <span class='segm identifier id'>segm</span> <span class='test identifier id'>test</span> <span class='for for kw'>for</span> <span class='regexp val'>/users/</span><span class='colon op'>:</span><span class='id identifier id'>id</span>
    <span class='lparen token'>(</span><span class='jump identifier id'>jump</span> <span class='to identifier id'>to</span> <span class='list identifier id'>list</span> <span class='index identifier id'>index</span> <span class='assign token'>=</span> <span class='integer val'>5</span><span class='rparen token'>)</span>
 <span class='integer val'>4</span><span class='rparen token'>)</span> <span class='full identifier id'>full</span> <span class='test identifier id'>test</span> <span class='for for kw'>for</span> <span class='regexp val'>/users/</span><span class='colon op'>:</span><span class='id identifier id'>id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='here identifier id'>here</span> <span class='we identifier id'>we</span> <span class='are! fid id'>are!</span>
</pre>

</div><div class="section attributes">
  <h1>Attributes</h1>

  
    <div class="instance">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">configuration_files</td>
          <td class="readwrite">
            [<span id='configuration_files-instance_method'>R</span><span id='configuration_files%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>configuration_files</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">named_routes</td>
          <td class="readwrite">
            [<span id='named_routes-instance_method'>R</span><span id='named_routes%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>named_routes</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">routes</td>
          <td class="readwrite">
            [<span id='routes-instance_method'>R</span><span id='routes%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>routes</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div><div class="section constructor">
<h1>Constructor Summary</h1>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


212
213
214
215
216
217
218
219</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 212</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='configuration_files identifier id'>configuration_files</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='routes identifier id'>routes</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='named_routes identifier id'>named_routes</span> <span class='assign token'>=</span> <span class='NamedRouteCollection constant id'>NamedRouteCollection</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

  <span class='clear_recognize_optimized! fid id'>clear_recognize_optimized!</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#add_configuration_file-instance_method' title='#add_configuration_file'>#add_configuration_file</a></span><span class='args'>(path)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#add_named_route-instance_method' title='#add_named_route'>#add_named_route</a></span><span class='args'>(name, path, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#add_route-instance_method' title='#add_route'>#add_route</a></span><span class='args'>(path, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#build_expiry-instance_method' title='#build_expiry'>#build_expiry</a></span><span class='args'>(options, recall)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#builder-instance_method' title='#builder'>#builder</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Subclasses and plugins may override this method to specify a different
RouteBuilder instance, so that other route DSL&#8217;s can be created.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#call-instance_method' title='#call'>#call</a></span><span class='args'>(env)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#clear%21-instance_method' title='#clear!'>#clear!</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#configuration_file-instance_method' title='#configuration_file'>#configuration_file</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Deprecated accessor.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#draw-instance_method' title='#draw'>#draw</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#empty%3F-instance_method' title='#empty?'>#empty?</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#extra_keys-instance_method' title='#extra_keys'>#extra_keys</a></span><span class='args'>(options, recall={})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generate the path indicated by the arguments, and return an array of the
keys that were not used to generate it.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#extract_request_environment-instance_method' title='#extract_request_environment'>#extract_request_environment</a></span><span class='args'>(request)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Subclasses and plugins may override this method to extract further
attributes from the request, for use by route conditions and such.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#generate-instance_method' title='#generate'>#generate</a></span><span class='args'>(options, recall = {}, method=:generate)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#generate_code-instance_method' title='#generate_code'>#generate_code</a></span><span class='args'>(list, padding='  ', level = 0)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#generate_extras-instance_method' title='#generate_extras'>#generate_extras</a></span><span class='args'>(options, recall={})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#install_helpers-instance_method' title='#install_helpers'>#install_helpers</a></span><span class='args'>(destinations = [ActionController::Base, ActionView::Base], regenerate_code = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#load%21-instance_method' title='#load!'>#load!</a></span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#reload!</span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#load_routes%21-instance_method' title='#load_routes!'>#load_routes!</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#options_as_params-instance_method' title='#options_as_params'>#options_as_params</a></span><span class='args'>(options)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#raise_named_route_error-instance_method' title='#raise_named_route_error'>#raise_named_route_error</a></span><span class='args'>(options, named_route, named_route_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
try to give a helpful error message when named route generation fails.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#recognize-instance_method' title='#recognize'>#recognize</a></span><span class='args'>(request)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#recognize_path-instance_method' title='#recognize_path'>#recognize_path</a></span><span class='args'>(path, environment={})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#reload-instance_method' title='#reload'>#reload</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#routes_by_controller-instance_method' title='#routes_by_controller'>#routes_by_controller</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#routes_changed_at-instance_method' title='#routes_changed_at'>#routes_changed_at</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#routes_for-instance_method' title='#routes_for'>#routes_for</a></span><span class='args'>(options, merged, expire_on)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#routes_for_controller_and_action-instance_method' title='#routes_for_controller_and_action'>#routes_for_controller_and_action</a></span><span class='args'>(controller, action)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#routes_for_controller_and_action_and_keys-instance_method' title='#routes_for_controller_and_action_and_keys'>#routes_for_controller_and_action_and_keys</a></span><span class='args'>(controller, action, keys)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#segment_tree-instance_method' title='#segment_tree'>#segment_tree</a></span><span class='args'>(routes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#to_plain_segments-instance_method' title='#to_plain_segments'>#to_plain_segments</a></span><span class='args'>(str)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
this must be really fast.
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h1>Public Instance Methods Inherited from <a href='../../Object.html' title='Object'>Object</a></h1>
    <p><span class='name'><a href='../../Object.html#blank%3F-instance_method' title='blank?'>blank?</a></span>, <span class='name'><a href='../../Object.html#duplicable%3F-instance_method' title='duplicable?'>duplicable?</a></span>, <span class='name'><a href='../../Object.html#present%3F-instance_method' title='present?'>present?</a></span>, <span class='name'><a href='../../Object.html#to_param-instance_method' title='to_param'>to_param</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>add_configuration_file</h3>
</div><div id="add_configuration_file-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_configuration_file</span><span class='args'>(path)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


251
252
253</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 251</span>

<span class='def def kw'>def</span> <span class='add_configuration_file identifier id'>add_configuration_file</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='configuration_files identifier id'>configuration_files</span> <span class='lshft op'>&lt;&lt;</span> <span class='path identifier id'>path</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>add_named_route</h3>
</div><div id="add_named_route-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_named_route</span><span class='args'>(name, path, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


315
316
317
318
319</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 315</span>

<span class='def def kw'>def</span> <span class='add_named_route identifier id'>add_named_route</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='comment val'># TODO - is options EVER used?</span>
  <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:name_prefix</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='name identifier id'>name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:name_prefix</span><span class='rbrack token'>]</span>
  <span class='named_routes identifier id'>named_routes</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='add_route identifier id'>add_route</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>add_route</h3>
</div><div id="add_route-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_route</span><span class='args'>(path, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


309
310
311
312
313</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 309</span>

<span class='def def kw'>def</span> <span class='add_route identifier id'>add_route</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='route identifier id'>route</span> <span class='assign token'>=</span> <span class='builder identifier id'>builder</span><span class='dot token'>.</span><span class='build identifier id'>build</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='routes identifier id'>routes</span> <span class='lshft op'>&lt;&lt;</span> <span class='route identifier id'>route</span>
  <span class='route identifier id'>route</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>build_expiry</h3>
</div><div id="build_expiry-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>build_expiry</span><span class='args'>(options, recall)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


339
340
341
342
343
344</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 339</span>

<span class='def def kw'>def</span> <span class='build_expiry identifier id'>build_expiry</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='recall identifier id'>recall</span><span class='rparen token'>)</span>
  <span class='recall identifier id'>recall</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='expiry identifier id'>expiry</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='recalled_value identifier id'>recalled_value</span><span class='rparen token'>)</span><span class='bitor op'>|</span>
    <span class='expiry identifier id'>expiry</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='key? fid id'>key?</span><span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_param identifier id'>to_param</span> <span class='neq op'>!=</span> <span class='recalled_value identifier id'>recalled_value</span><span class='dot token'>.</span><span class='to_param identifier id'>to_param</span><span class='rparen token'>)</span>
    <span class='expiry identifier id'>expiry</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>builder</h3>
</div><div id="builder-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>builder</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Subclasses and plugins may override this method to specify a different
RouteBuilder instance, so that other route DSL&#8217;s can be created.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


223
224
225</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 223</span>

<span class='def def kw'>def</span> <span class='builder identifier id'>builder</span>
  <span class='@builder ivar id'>@builder</span> <span class='opasgn op'>||=</span> <span class='RouteBuilder constant id'>RouteBuilder</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>call</h3>
</div><div id="call-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>call</span><span class='args'>(env)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


432
433
434
435
436</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 432</span>

<span class='def def kw'>def</span> <span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='env identifier id'>env</span><span class='rparen token'>)</span>
  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='ActionDispatch constant id'>ActionDispatch</span><span class='colon2 op'>::</span><span class='Request constant id'>Request</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='env identifier id'>env</span><span class='rparen token'>)</span>
  <span class='app identifier id'>app</span> <span class='assign token'>=</span> <span class='Routing constant id'>Routing</span><span class='colon2 op'>::</span><span class='Routes constant id'>Routes</span><span class='dot token'>.</span><span class='recognize identifier id'>recognize</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='rparen token'>)</span>
  <span class='app identifier id'>app</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='env identifier id'>env</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>clear!</h3>
</div><div id="clear%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>clear!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


232
233
234
235
236
237
238
239
240</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 232</span>

<span class='def def kw'>def</span> <span class='clear! fid id'>clear!</span>
  <span class='routes identifier id'>routes</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>
  <span class='named_routes identifier id'>named_routes</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>
  <span class='@combined_regexp ivar id'>@combined_regexp</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='@routes_by_controller ivar id'>@routes_by_controller</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='comment val'># This will force routing/recognition_optimization.rb</span>
  <span class='comment val'># to refresh optimisations.</span>
  <span class='clear_recognize_optimized! fid id'>clear_recognize_optimized!</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>configuration_file</h3>
</div><div id="configuration_file-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>configuration_file</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Deprecated accessor
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


261
262
263</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 261</span>

<span class='def def kw'>def</span> <span class='configuration_file identifier id'>configuration_file</span>
  <span class='configuration_files identifier id'>configuration_files</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>draw</h3>
</div><div id="draw-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>draw</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  
</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


227
228
229
230</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 227</span>

<span class='def def kw'>def</span> <span class='draw identifier id'>draw</span>
  <span class='yield yield kw'>yield</span> <span class='Mapper constant id'>Mapper</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='rparen token'>)</span>
  <span class='install_helpers identifier id'>install_helpers</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>empty?</h3>
</div><div id="empty%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>empty?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


247
248
249</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 247</span>

<span class='def def kw'>def</span> <span class='empty? fid id'>empty?</span>
  <span class='routes identifier id'>routes</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>extra_keys</h3>
</div><div id="extra_keys-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>extra_keys</span><span class='args'>(options, recall={})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generate the path indicated by the arguments, and return an array of the
keys that were not used to generate it.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


348
349
350</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 348</span>

<span class='def def kw'>def</span> <span class='extra_keys identifier id'>extra_keys</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='recall identifier id'>recall</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='generate_extras identifier id'>generate_extras</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='recall identifier id'>recall</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='last identifier id'>last</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>extract_request_environment</h3>
</div><div id="extract_request_environment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>extract_request_environment</span><span class='args'>(request)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Subclasses and plugins may override this method to extract further
attributes from the request, for use by route conditions and such.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


485
486
487</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 485</span>

<span class='def def kw'>def</span> <span class='extract_request_environment identifier id'>extract_request_environment</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='rparen token'>)</span>
  <span class='lbrace token'>{</span> <span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='method identifier id'>method</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>generate</h3>
</div><div id="generate-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>generate</span><span class='args'>(options, recall = {}, method=:generate)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href='../RoutingError.html' title='RoutingError'>RoutingError</a></tt>]</span>
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 356</span>

<span class='def def kw'>def</span> <span class='generate identifier id'>generate</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='recall identifier id'>recall</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='method identifier id'>method</span><span class='assign token'>=</span><span class='symbol val'>:generate</span><span class='rparen token'>)</span>
  <span class='named_route_name identifier id'>named_route_name</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:use_route</span><span class='rparen token'>)</span>
  <span class='generate_all identifier id'>generate_all</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:generate_all</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='named_route_name identifier id'>named_route_name</span>
    <span class='named_route identifier id'>named_route</span> <span class='assign token'>=</span> <span class='named_routes identifier id'>named_routes</span><span class='lbrack token'>[</span><span class='named_route_name identifier id'>named_route_name</span><span class='rbrack token'>]</span>
    <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='named_route identifier id'>named_route</span><span class='dot token'>.</span><span class='parameter_shell identifier id'>parameter_shell</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='options_as_params identifier id'>options_as_params</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='expire_on identifier id'>expire_on</span> <span class='assign token'>=</span> <span class='build_expiry identifier id'>build_expiry</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='recall identifier id'>recall</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='controller identifier id'>controller</span><span class='rbrack token'>]</span>
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='end end kw'>end</span>
  <span class='comment val'># if the controller has changed, make sure it changes relative to the</span>
  <span class='comment val'># current controller module, if any. In other words, if we're currently</span>
  <span class='comment val'># on admin/get, and the new controller is 'set', the new controller</span>
  <span class='comment val'># should really be admin/set.</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='named_route identifier id'>named_route</span> <span class='andop op'>&amp;&amp;</span> <span class='expire_on identifier id'>expire_on</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='controller identifier id'>controller</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='controller identifier id'>controller</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='controller identifier id'>controller</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='integer val'>?/</span>
    <span class='old_parts identifier id'>old_parts</span> <span class='assign token'>=</span> <span class='recall identifier id'>recall</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'/'</span><span class='rparen token'>)</span>
    <span class='new_parts identifier id'>new_parts</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'/'</span><span class='rparen token'>)</span>
    <span class='parts identifier id'>parts</span> <span class='assign token'>=</span> <span class='old_parts identifier id'>old_parts</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='minus op'>-</span><span class='lparen token'>(</span><span class='new_parts identifier id'>new_parts</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='new_parts identifier id'>new_parts</span>
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='parts identifier id'>parts</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'/'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># drop the leading '/' on the controller name</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>?/</span>
  <span class='merged identifier id'>merged</span> <span class='assign token'>=</span> <span class='recall identifier id'>recall</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='named_route identifier id'>named_route</span>
    <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='named_route identifier id'>named_route</span><span class='dot token'>.</span><span class='generate identifier id'>generate</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='merged identifier id'>merged</span><span class='comma token'>,</span> <span class='expire_on identifier id'>expire_on</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
      <span class='raise_named_route_error identifier id'>raise_named_route_error</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='named_route identifier id'>named_route</span><span class='comma token'>,</span> <span class='named_route_name identifier id'>named_route_name</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='return return kw'>return</span> <span class='path identifier id'>path</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='merged identifier id'>merged</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>'index'</span>
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>'index'</span>

    <span class='controller identifier id'>controller</span> <span class='assign token'>=</span> <span class='merged identifier id'>merged</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span>
    <span class='action identifier id'>action</span> <span class='assign token'>=</span> <span class='merged identifier id'>merged</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span>

    <span class='raise identifier id'>raise</span> <span class='RoutingError constant id'>RoutingError</span><span class='comma token'>,</span> <span class='string val'>&quot;Need controller and action!&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='controller identifier id'>controller</span> <span class='andop op'>&amp;&amp;</span> <span class='action identifier id'>action</span>

    <span class='if if kw'>if</span> <span class='generate_all identifier id'>generate_all</span>
      <span class='comment val'># Used by caching to expire all paths for a resource</span>
      <span class='return return kw'>return</span> <span class='routes identifier id'>routes</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='route identifier id'>route</span><span class='bitor op'>|</span>
        <span class='route identifier id'>route</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='method identifier id'>method</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='merged identifier id'>merged</span><span class='comma token'>,</span> <span class='expire_on identifier id'>expire_on</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># don't use the recalled keys when determining which routes to check</span>
    <span class='routes identifier id'>routes</span> <span class='assign token'>=</span> <span class='routes_by_controller identifier id'>routes_by_controller</span><span class='lbrack token'>[</span><span class='controller identifier id'>controller</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='action identifier id'>action</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='reject identifier id'>reject</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='notop op'>!</span><span class='v identifier id'>v</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span><span class='dot token'>.</span><span class='sort_by identifier id'>sort_by</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='object_id identifier id'>object_id</span> <span class='rbrace token'>}</span><span class='rbrack token'>]</span>

    <span class='routes identifier id'>routes</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='route identifier id'>route</span><span class='bitor op'>|</span>
      <span class='results identifier id'>results</span> <span class='assign token'>=</span> <span class='route identifier id'>route</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='method identifier id'>method</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='merged identifier id'>merged</span><span class='comma token'>,</span> <span class='expire_on identifier id'>expire_on</span><span class='rparen token'>)</span>
      <span class='return return kw'>return</span> <span class='results identifier id'>results</span> <span class='if if_mod kw'>if</span> <span class='results identifier id'>results</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='results identifier id'>results</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='results identifier id'>results</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='raise identifier id'>raise</span> <span class='RoutingError constant id'>RoutingError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;No route matches #{options.inspect}&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>generate_code</h3>
</div><div id="generate_code-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>generate_code</span><span class='args'>(list, padding='  ', level = 0)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/recognition_optimisation.rb', line 89</span>

<span class='def def kw'>def</span> <span class='generate_code identifier id'>generate_code</span><span class='lparen token'>(</span><span class='list identifier id'>list</span><span class='comma token'>,</span> <span class='padding identifier id'>padding</span><span class='assign token'>=</span><span class='string val'>'  '</span><span class='comma token'>,</span> <span class='level identifier id'>level</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='comment val'># a digit</span>
  <span class='return return kw'>return</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='dstring node'>&quot;#{list[0]}\n&quot;</span> <span class='if if_mod kw'>if</span> <span class='list identifier id'>list</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>1</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span> <span class='eqq op'>===</span> <span class='list identifier id'>list</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='body identifier id'>body</span> <span class='assign token'>=</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='dstring node'>&quot;(seg = segments[#{level}]; \n&quot;</span>

  <span class='i identifier id'>i</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='was_nil identifier id'>was_nil</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='list identifier id'>list</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='item identifier id'>item</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='Array constant id'>Array</span> <span class='eqq op'>===</span> <span class='item identifier id'>item</span>
      <span class='i identifier id'>i</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
      <span class='start identifier id'>start</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='i identifier id'>i</span> <span class='eq op'>==</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
      <span class='tag identifier id'>tag</span><span class='comma token'>,</span> <span class='sub identifier id'>sub</span> <span class='assign token'>=</span> <span class='item identifier id'>item</span>
      <span class='if if kw'>if</span> <span class='tag identifier id'>tag</span> <span class='eq op'>==</span> <span class='colon op'>:</span><span class='dynamic identifier id'>dynamic</span>
        <span class='body identifier id'>body</span> <span class='opasgn op'>+=</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='dstring node'>&quot;#{start ? 'if' : 'elsif'} true\n&quot;</span>
        <span class='body identifier id'>body</span> <span class='opasgn op'>+=</span> <span class='generate_code identifier id'>generate_code</span><span class='lparen token'>(</span><span class='sub identifier id'>sub</span><span class='comma token'>,</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='string val'>&quot;  &quot;</span><span class='comma token'>,</span> <span class='level identifier id'>level</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
        <span class='break break kw'>break</span>
      <span class='elsif elsif kw'>elsif</span> <span class='tag identifier id'>tag</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='was_nil identifier id'>was_nil</span>
        <span class='was_nil identifier id'>was_nil</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
        <span class='body identifier id'>body</span> <span class='opasgn op'>+=</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='dstring node'>&quot;#{start ? 'if' : 'elsif'} seg.nil?\n&quot;</span>
        <span class='body identifier id'>body</span> <span class='opasgn op'>+=</span> <span class='generate_code identifier id'>generate_code</span><span class='lparen token'>(</span><span class='sub identifier id'>sub</span><span class='comma token'>,</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='string val'>&quot;  &quot;</span><span class='comma token'>,</span> <span class='level identifier id'>level</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='body identifier id'>body</span> <span class='opasgn op'>+=</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='dstring node'>&quot;#{start ? 'if' : 'elsif'} seg == '#{tag}'\n&quot;</span>
        <span class='body identifier id'>body</span> <span class='opasgn op'>+=</span> <span class='generate_code identifier id'>generate_code</span><span class='lparen token'>(</span><span class='sub identifier id'>sub</span><span class='comma token'>,</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='string val'>&quot;  &quot;</span><span class='comma token'>,</span> <span class='level identifier id'>level</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='body identifier id'>body</span> <span class='opasgn op'>+=</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='string val'>&quot;else\n&quot;</span>
  <span class='body identifier id'>body</span> <span class='opasgn op'>+=</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='dstring node'>&quot;  #{list[0]}\n&quot;</span>
  <span class='body identifier id'>body</span> <span class='opasgn op'>+=</span> <span class='padding identifier id'>padding</span> <span class='plus op'>+</span> <span class='string val'>&quot;end)\n&quot;</span>
  <span class='body identifier id'>body</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>generate_extras</h3>
</div><div id="generate_extras-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>generate_extras</span><span class='args'>(options, recall={})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


352
353
354</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 352</span>

<span class='def def kw'>def</span> <span class='generate_extras identifier id'>generate_extras</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='recall identifier id'>recall</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='generate identifier id'>generate</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='recall identifier id'>recall</span><span class='comma token'>,</span> <span class='symbol val'>:generate_extras</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>install_helpers</h3>
</div><div id="install_helpers-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>install_helpers</span><span class='args'>(destinations = [ActionController::Base, ActionView::Base], regenerate_code = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


242
243
244
245</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 242</span>

<span class='def def kw'>def</span> <span class='install_helpers identifier id'>install_helpers</span><span class='lparen token'>(</span><span class='destinations identifier id'>destinations</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='ActionController constant id'>ActionController</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='comma token'>,</span> <span class='ActionView constant id'>ActionView</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='regenerate_code identifier id'>regenerate_code</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='Array constant id'>Array</span><span class='lparen token'>(</span><span class='destinations identifier id'>destinations</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='d identifier id'>d</span><span class='bitor op'>|</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='module_eval identifier id'>module_eval</span> <span class='lbrace token'>{</span> <span class='include identifier id'>include</span> <span class='Helpers constant id'>Helpers</span> <span class='rbrace token'>}</span> <span class='rbrace token'>}</span>
  <span class='named_routes identifier id'>named_routes</span><span class='dot token'>.</span><span class='install identifier id'>install</span><span class='lparen token'>(</span><span class='destinations identifier id'>destinations</span><span class='comma token'>,</span> <span class='regenerate_code identifier id'>regenerate_code</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>load!</h3>
</div><div id="load%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>load!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="reload%21-instance_method">reload!</tt>
  
</p>
</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


265
266
267
268
269</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 265</span>

<span class='def def kw'>def</span> <span class='load! fid id'>load!</span>
  <span class='Routing constant id'>Routing</span><span class='dot token'>.</span><span class='use_controllers! fid id'>use_controllers!</span><span class='lparen token'>(</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'># Clear the controller cache so we may discover new ones</span>
  <span class='clear! fid id'>clear!</span>
  <span class='load_routes! fid id'>load_routes!</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>load_routes!</h3>
</div><div id="load_routes%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>load_routes!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


286
287
288
289
290
291
292
293</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 286</span>

<span class='def def kw'>def</span> <span class='load_routes! fid id'>load_routes!</span>
  <span class='if if kw'>if</span> <span class='configuration_files identifier id'>configuration_files</span><span class='dot token'>.</span><span class='any? fid id'>any?</span>
    <span class='configuration_files identifier id'>configuration_files</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='config identifier id'>config</span><span class='bitor op'>|</span> <span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='config identifier id'>config</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='@routes_last_modified ivar id'>@routes_last_modified</span> <span class='assign token'>=</span> <span class='routes_changed_at identifier id'>routes_changed_at</span>
  <span class='else else kw'>else</span>
    <span class='add_route identifier id'>add_route</span> <span class='string val'>&quot;:controller/:action/:id&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>options_as_params</h3>
</div><div id="options_as_params-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>options_as_params</span><span class='args'>(options)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 321</span>

<span class='def def kw'>def</span> <span class='options_as_params identifier id'>options_as_params</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='comment val'># If an explicit :controller was given, always make :action explicit</span>
  <span class='comment val'># too, so that action expiry works as expected for things like</span>
  <span class='comment val'>#</span>
  <span class='comment val'>#   generate({:controller =&gt; 'content'}, {:controller =&gt; 'content', :action =&gt; 'show'})</span>
  <span class='comment val'>#</span>
  <span class='comment val'># (the above is from the unit tests). In the above case, because the</span>
  <span class='comment val'># controller was explicitly given, but no action, the action is implied to</span>
  <span class='comment val'># be &quot;index&quot;, not the recalled action of &quot;show&quot;.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># great fun, eh?</span>

  <span class='options_as_params identifier id'>options_as_params</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='clone identifier id'>clone</span>
  <span class='options_as_params identifier id'>options_as_params</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>'index'</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span>
  <span class='options_as_params identifier id'>options_as_params</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='options_as_params identifier id'>options_as_params</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='if if_mod kw'>if</span> <span class='options_as_params identifier id'>options_as_params</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span>
  <span class='options_as_params identifier id'>options_as_params</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>raise_named_route_error</h3>
</div><div id="raise_named_route_error-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>raise_named_route_error</span><span class='args'>(options, named_route, named_route_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
try to give a helpful error message when named route generation fails
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


421
422
423
424
425
426
427
428
429
430</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 421</span>

<span class='def def kw'>def</span> <span class='raise_named_route_error identifier id'>raise_named_route_error</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='named_route identifier id'>named_route</span><span class='comma token'>,</span> <span class='named_route_name identifier id'>named_route_name</span><span class='rparen token'>)</span>
  <span class='diff identifier id'>diff</span> <span class='assign token'>=</span> <span class='named_route identifier id'>named_route</span><span class='dot token'>.</span><span class='requirements identifier id'>requirements</span><span class='dot token'>.</span><span class='diff identifier id'>diff</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='raise identifier id'>raise</span> <span class='RoutingError constant id'>RoutingError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{named_route_name}_url failed to generate from #{options.inspect}, expected: #{named_route.requirements.inspect}, diff: #{named_route.requirements.diff(options).inspect}&quot;</span>
  <span class='else else kw'>else</span>
    <span class='required_segments identifier id'>required_segments</span> <span class='assign token'>=</span> <span class='named_route identifier id'>named_route</span><span class='dot token'>.</span><span class='segments identifier id'>segments</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='seg identifier id'>seg</span><span class='bitor op'>|</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='seg identifier id'>seg</span><span class='dot token'>.</span><span class='optional? fid id'>optional?</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='seg identifier id'>seg</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='DividerSegment constant id'>DividerSegment</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='required_keys_or_values identifier id'>required_keys_or_values</span> <span class='assign token'>=</span> <span class='required_segments identifier id'>required_segments</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='seg identifier id'>seg</span><span class='bitor op'>|</span> <span class='seg identifier id'>seg</span><span class='dot token'>.</span><span class='key identifier id'>key</span> <span class='rescue rescue kw'>rescue</span> <span class='seg identifier id'>seg</span><span class='dot token'>.</span><span class='value identifier id'>value</span> <span class='rbrace token'>}</span> <span class='comment val'># we want either the key or the value from the segment</span>
    <span class='raise identifier id'>raise</span> <span class='RoutingError constant id'>RoutingError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{named_route_name}_url failed to generate from #{options.inspect} - you may have ambiguous routes, or you may need to supply additional parameters for this route.  content_url has the following required parameters: #{required_keys_or_values.inspect} - are they all satisfied?&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>recognize</h3>
</div><div id="recognize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>recognize</span><span class='args'>(request)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


438
439
440
441
442</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 438</span>

<span class='def def kw'>def</span> <span class='recognize identifier id'>recognize</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='rparen token'>)</span>
  <span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='recognize_path identifier id'>recognize_path</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='extract_request_environment identifier id'>extract_request_environment</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='path_parameters identifier id'>path_parameters</span> <span class='assign token'>=</span> <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='with_indifferent_access identifier id'>with_indifferent_access</span>
  <span class='dstring node'>&quot;#{params[:controller].camelize}Controller&quot;</span><span class='dot token'>.</span><span class='constantize identifier id'>constantize</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>recognize_path</h3>
</div><div id="recognize_path-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>recognize_path</span><span class='args'>(path, environment={})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


444
445
446</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 444</span>

<span class='def def kw'>def</span> <span class='recognize_path identifier id'>recognize_path</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='environment identifier id'>environment</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='string val'>&quot;Not optimized! Check that routing/recognition_optimisation overrides RouteSet#recognize_path.&quot;</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reload</h3>
</div><div id="reload-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reload</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


274
275
276
277
278
279
280
281
282
283
284</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 274</span>

<span class='def def kw'>def</span> <span class='reload identifier id'>reload</span>
  <span class='if if kw'>if</span> <span class='configuration_files identifier id'>configuration_files</span><span class='dot token'>.</span><span class='any? fid id'>any?</span> <span class='andop op'>&amp;&amp;</span> <span class='@routes_last_modified ivar id'>@routes_last_modified</span>
    <span class='if if kw'>if</span> <span class='routes_changed_at identifier id'>routes_changed_at</span> <span class='eq op'>==</span> <span class='@routes_last_modified ivar id'>@routes_last_modified</span>
      <span class='return return kw'>return</span> <span class='comment val'># routes didn't change, don't reload</span>
    <span class='else else kw'>else</span>
      <span class='@routes_last_modified ivar id'>@routes_last_modified</span> <span class='assign token'>=</span> <span class='routes_changed_at identifier id'>routes_changed_at</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='load! fid id'>load!</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>routes_by_controller</h3>
</div><div id="routes_by_controller-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>routes_by_controller</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


448
449
450
451
452
453
454
455
456</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 448</span>

<span class='def def kw'>def</span> <span class='routes_by_controller identifier id'>routes_by_controller</span>
  <span class='@routes_by_controller ivar id'>@routes_by_controller</span> <span class='opasgn op'>||=</span> <span class='Hash constant id'>Hash</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='controller_hash identifier id'>controller_hash</span><span class='comma token'>,</span> <span class='controller identifier id'>controller</span><span class='bitor op'>|</span>
    <span class='controller_hash identifier id'>controller_hash</span><span class='lbrack token'>[</span><span class='controller identifier id'>controller</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Hash constant id'>Hash</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='action_hash identifier id'>action_hash</span><span class='comma token'>,</span> <span class='action identifier id'>action</span><span class='bitor op'>|</span>
      <span class='action_hash identifier id'>action_hash</span><span class='lbrack token'>[</span><span class='action identifier id'>action</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Hash constant id'>Hash</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key_hash identifier id'>key_hash</span><span class='comma token'>,</span> <span class='keys identifier id'>keys</span><span class='bitor op'>|</span>
        <span class='key_hash identifier id'>key_hash</span><span class='lbrack token'>[</span><span class='keys identifier id'>keys</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='routes_for_controller_and_action_and_keys identifier id'>routes_for_controller_and_action_and_keys</span><span class='lparen token'>(</span><span class='controller identifier id'>controller</span><span class='comma token'>,</span> <span class='action identifier id'>action</span><span class='comma token'>,</span> <span class='keys identifier id'>keys</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>routes_changed_at</h3>
</div><div id="routes_changed_at-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>routes_changed_at</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


295
296
297
298
299
300
301
302
303
304
305
306
307</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 295</span>

<span class='def def kw'>def</span> <span class='routes_changed_at identifier id'>routes_changed_at</span>
  <span class='routes_changed_at identifier id'>routes_changed_at</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  
  <span class='configuration_files identifier id'>configuration_files</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='config identifier id'>config</span><span class='bitor op'>|</span>
    <span class='config_changed_at identifier id'>config_changed_at</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='config identifier id'>config</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>

    <span class='if if kw'>if</span> <span class='routes_changed_at identifier id'>routes_changed_at</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='orop op'>||</span> <span class='config_changed_at identifier id'>config_changed_at</span> <span class='gt op'>&gt;</span> <span class='routes_changed_at identifier id'>routes_changed_at</span>
      <span class='routes_changed_at identifier id'>routes_changed_at</span> <span class='assign token'>=</span> <span class='config_changed_at identifier id'>config_changed_at</span> 
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='routes_changed_at identifier id'>routes_changed_at</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>routes_for</h3>
</div><div id="routes_for-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>routes_for</span><span class='args'>(options, merged, expire_on)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


458
459
460
461
462
463
464
465</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 458</span>

<span class='def def kw'>def</span> <span class='routes_for identifier id'>routes_for</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='merged identifier id'>merged</span><span class='comma token'>,</span> <span class='expire_on identifier id'>expire_on</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='string val'>&quot;Need controller and action!&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='controller identifier id'>controller</span> <span class='andop op'>&amp;&amp;</span> <span class='action identifier id'>action</span>
  <span class='controller identifier id'>controller</span> <span class='assign token'>=</span> <span class='merged identifier id'>merged</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span>
  <span class='merged identifier id'>merged</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span> <span class='if if_mod kw'>if</span> <span class='expire_on identifier id'>expire_on</span><span class='lbrack token'>[</span><span class='symbol val'>:controller</span><span class='rbrack token'>]</span>
  <span class='action identifier id'>action</span> <span class='assign token'>=</span> <span class='merged identifier id'>merged</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='string val'>'index'</span>

  <span class='routes_by_controller identifier id'>routes_by_controller</span><span class='lbrack token'>[</span><span class='controller identifier id'>controller</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='action identifier id'>action</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='merged identifier id'>merged</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>routes_for_controller_and_action</h3>
</div><div id="routes_for_controller_and_action-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>routes_for_controller_and_action</span><span class='args'>(controller, action)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


467
468
469
470
471
472</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 467</span>

<span class='def def kw'>def</span> <span class='routes_for_controller_and_action identifier id'>routes_for_controller_and_action</span><span class='lparen token'>(</span><span class='controller identifier id'>controller</span><span class='comma token'>,</span> <span class='action identifier id'>action</span><span class='rparen token'>)</span>
  <span class='selected identifier id'>selected</span> <span class='assign token'>=</span> <span class='routes identifier id'>routes</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='route identifier id'>route</span><span class='bitor op'>|</span>
    <span class='route identifier id'>route</span><span class='dot token'>.</span><span class='matches_controller_and_action? fid id'>matches_controller_and_action?</span> <span class='controller identifier id'>controller</span><span class='comma token'>,</span> <span class='action identifier id'>action</span>
  <span class='end end kw'>end</span>
  <span class='lparen token'>(</span><span class='selected identifier id'>selected</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='eq op'>==</span> <span class='routes identifier id'>routes</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='routes identifier id'>routes</span> <span class='colon op'>:</span> <span class='selected identifier id'>selected</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>routes_for_controller_and_action_and_keys</h3>
</div><div id="routes_for_controller_and_action_and_keys-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>routes_for_controller_and_action_and_keys</span><span class='args'>(controller, action, keys)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


474
475
476
477
478
479
480
481</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/route_set.rb', line 474</span>

<span class='def def kw'>def</span> <span class='routes_for_controller_and_action_and_keys identifier id'>routes_for_controller_and_action_and_keys</span><span class='lparen token'>(</span><span class='controller identifier id'>controller</span><span class='comma token'>,</span> <span class='action identifier id'>action</span><span class='comma token'>,</span> <span class='keys identifier id'>keys</span><span class='rparen token'>)</span>
  <span class='selected identifier id'>selected</span> <span class='assign token'>=</span> <span class='routes identifier id'>routes</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='route identifier id'>route</span><span class='bitor op'>|</span>
    <span class='route identifier id'>route</span><span class='dot token'>.</span><span class='matches_controller_and_action? fid id'>matches_controller_and_action?</span> <span class='controller identifier id'>controller</span><span class='comma token'>,</span> <span class='action identifier id'>action</span>
  <span class='end end kw'>end</span>
  <span class='selected identifier id'>selected</span><span class='dot token'>.</span><span class='sort_by identifier id'>sort_by</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='route identifier id'>route</span><span class='bitor op'>|</span>
    <span class='lparen token'>(</span><span class='keys identifier id'>keys</span> <span class='minus op'>-</span> <span class='route identifier id'>route</span><span class='dot token'>.</span><span class='significant_keys identifier id'>significant_keys</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>segment_tree</h3>
</div><div id="segment_tree-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>segment_tree</span><span class='args'>(routes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/recognition_optimisation.rb', line 70</span>

<span class='def def kw'>def</span> <span class='segment_tree identifier id'>segment_tree</span><span class='lparen token'>(</span><span class='routes identifier id'>routes</span><span class='rparen token'>)</span>
  <span class='tree identifier id'>tree</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>

  <span class='i identifier id'>i</span> <span class='assign token'>=</span> <span class='integer val'>-1</span>
  <span class='routes identifier id'>routes</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='route identifier id'>route</span><span class='bitor op'>|</span>
    <span class='i identifier id'>i</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
    <span class='comment val'># not fast, but runs only once</span>
    <span class='segments identifier id'>segments</span> <span class='assign token'>=</span> <span class='to_plain_segments identifier id'>to_plain_segments</span><span class='lparen token'>(</span><span class='route identifier id'>route</span><span class='dot token'>.</span><span class='segments identifier id'>segments</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='str identifier id'>str</span><span class='comma token'>,</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='str identifier id'>str</span> <span class='lshft op'>&lt;&lt;</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>

    <span class='node identifier id'>node</span>  <span class='assign token'>=</span> <span class='tree identifier id'>tree</span>
    <span class='segments identifier id'>segments</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='seg identifier id'>seg</span><span class='bitor op'>|</span>
      <span class='seg identifier id'>seg</span> <span class='assign token'>=</span> <span class='symbol val'>:dynamic</span> <span class='if if_mod kw'>if</span> <span class='seg identifier id'>seg</span> <span class='andop op'>&amp;&amp;</span> <span class='seg identifier id'>seg</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>?:</span>
      <span class='node identifier id'>node</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='seg identifier id'>seg</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='node identifier id'>node</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='orop op'>||</span> <span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='seg identifier id'>seg</span>
      <span class='node identifier id'>node</span> <span class='assign token'>=</span> <span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='tree identifier id'>tree</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_plain_segments</h3>
</div><div id="to_plain_segments-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_plain_segments</span><span class='args'>(str)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
this must be really fast
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


123
124
125
126
127
128
129
130</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/routing/recognition_optimisation.rb', line 123</span>

<span class='def def kw'>def</span> <span class='to_plain_segments identifier id'>to_plain_segments</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/^\/+/</span><span class='comma token'>,</span><span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\/+$/</span><span class='comma token'>,</span><span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='segments identifier id'>segments</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/\.[^\/]+\/+|\/+|\.[^\/]+\Z/</span><span class='rparen token'>)</span> <span class='comment val'># cut off &quot;.format&quot; also</span>
  <span class='segments identifier id'>segments</span> <span class='lshft op'>&lt;&lt;</span> <span class='nil nil kw'>nil</span>
  <span class='segments identifier id'>segments</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>