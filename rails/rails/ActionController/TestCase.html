<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: ActionController::TestCase</title>
  </head>
  <body>
    <div id="content">
      <div class="section class ActionController_TestCase">
  <h1 class="title">Class: ActionController::TestCase</h1>
  <div class="section inheritance">
  <ul>
  <li>ActiveSupport::TestCase</li><ul><li>ActionController::TestCase</li>
  </ul></ul>
</div><div class="section mixins">
  <h1>Included Modules</h1>
  <p><a href='TestCase/TestProcess.html' title='ActionController::TestProcess'>ActionController::TestProcess</a>, <a href='TestCase/Assertions.html' title='ActionController::TestCase::Assertions'>ActionController::TestCase::Assertions</a></p>
</div><div class="section docstring">
  <p>
Superclass for ActionController functional tests. Functional tests allow
you to test a single controller action per test method. This should not be
confused with integration tests (see ActionController::IntegrationTest),
which are more like &quot;stories&quot; that can involve multiple
controllers and mutliple actions (i.e. multiple different HTTP requests).
</p>
<h2>Basic example</h2>
<p>
Functional tests are written as follows:
</p>
<ol>
<li>First, one uses the <tt>get</tt>, <tt>post</tt>, <tt>put</tt>,
<tt>delete</tt> or <tt>head</tt> method to simulate an HTTP request.

</li>
<li>Then, one asserts whether the current state is as expected.
&quot;State&quot; can be anything: the controller&#8217;s HTTP response,
the database contents, etc.

</li>
</ol>
<p>
For example:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='BooksControllerTest constant id'>BooksControllerTest</span> <span class='lt op'>&lt;</span> <span class='ActionController constant id'>ActionController</span><span class='colon2 op'>::</span><span class='TestCase constant id'>TestCase</span>
    <span class='def def kw'>def</span> <span class='test_create identifier id'>test_create</span>
      <span class='comment val'># Simulate a POST response with the given HTTP parameters.</span>
      <span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:create</span><span class='comma token'>,</span> <span class='symbol val'>:book</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:title</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Love Hina&quot;</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>

      <span class='comment val'># Assert that the controller tried to redirect us to</span>
      <span class='comment val'># the created book's URI.</span>
      <span class='assert_response identifier id'>assert_response</span> <span class='symbol val'>:found</span>

      <span class='comment val'># Assert that the controller really put the book in the database.</span>
      <span class='assert_not_nil identifier id'>assert_not_nil</span> <span class='Book constant id'>Book</span><span class='dot token'>.</span><span class='find_by_title identifier id'>find_by_title</span><span class='lparen token'>(</span><span class='string val'>&quot;Love Hina&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<h2>Special instance variables</h2>
<p>
ActionController::TestCase will also automatically provide the following
instance variables for use in the tests:
</p>
<table>
<tr><td valign="top"><b>@controller</b>:</td><td>The controller instance that will be tested.

</td></tr>
<tr><td valign="top"><b>@request</b>:</td><td>An ActionController::TestRequest, representing the current HTTP request.
You can modify this object before sending the HTTP request. For example,
you might want to set some session properties before sending a GET request.

</td></tr>
<tr><td valign="top"><b>@response</b>:</td><td>An ActionController::TestResponse object, representing the response of the
last HTTP response. In the above example, <tt>@response</tt> becomes valid
after calling <tt>post</tt>. If the various assert methods are not
sufficient, then you may use this object to inspect the HTTP response in
detail.

</td></tr>
</table>
<p>
(Earlier versions of Rails required each functional test to subclass
Test::Unit::TestCase and define @controller, @request, @response in
<tt>setup</tt>.)
</p>
<h2>Controller is automatically inferred</h2>
<p>
ActionController::TestCase will automatically infer the controller under
test from the test class name. If the controller cannot be inferred from
the test class name, you can explicity set it with <tt>tests</tt>.
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='SpecialEdgeCaseWidgetsControllerTest constant id'>SpecialEdgeCaseWidgetsControllerTest</span> <span class='lt op'>&lt;</span> <span class='ActionController constant id'>ActionController</span><span class='colon2 op'>::</span><span class='TestCase constant id'>TestCase</span>
    <span class='tests identifier id'>tests</span> <span class='WidgetController constant id'>WidgetController</span>
  <span class='end end kw'>end</span>
</pre>
<h2>Testing controller internals</h2>
<p>
In addition to these specific assertions, you also have easy access to
various collections that the regular test/unit assertions can be used
against. These collections are:
</p>
<ul>
<li>assigns: Instance variables assigned in the action that are available for
the view.

</li>
<li>session: Objects being saved in the session.

</li>
<li>flash: The flash objects currently in the session.

</li>
<li>cookies: Cookies being sent to the user on this request.

</li>
</ul>
<p>
These collections can be used just like any other hash:
</p>
<pre class="code">
  <span class='assert_not_nil identifier id'>assert_not_nil</span> <span class='assigns identifier id'>assigns</span><span class='lparen token'>(</span><span class='symbol val'>:person</span><span class='rparen token'>)</span> <span class='comment val'># makes sure that a @person instance variable was set</span>
  <span class='assert_equal identifier id'>assert_equal</span> <span class='string val'>&quot;Dave&quot;</span><span class='comma token'>,</span> <span class='cookies identifier id'>cookies</span><span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='rbrack token'>]</span> <span class='comment val'># makes sure that a cookie called :name was set as &quot;Dave&quot;</span>
  <span class='assert identifier id'>assert</span> <span class='flash identifier id'>flash</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='comment val'># makes sure that there's nothing in the flash</span>
</pre>
<p>
For historic reasons, the assigns hash uses string-based keys. So
assigns[:person] won&#8217;t work, but assigns[&quot;person&quot;] will. To
appease our yearning for symbols, though, an alternative accessor has been
devised using a method call instead of index referencing. So
assigns(:person) will work just like assigns[&quot;person&quot;], but
again, assigns[:person] will not work.
</p>
<p>
On top of the collections, you have the complete url that a given action
redirected to available in redirect_to_url.
</p>
<p>
For redirects within the same controller, you can even call follow_redirect
and the redirect will be followed, triggering another action call which can
then be asserted against.
</p>
<h2>Manipulating the request collections</h2>
<p>
The collections described above link to the response, so you can test if
what the actions were expected to do happened. But sometimes you also want
to manipulate these collections in the incoming request. This is really
only relevant for sessions and cookies, though. For sessions, you just do:
</p>
<pre class="code">
  <span class='@request ivar id'>@request</span><span class='dot token'>.</span><span class='session identifier id'>session</span><span class='lbrack token'>[</span><span class='symbol val'>:key</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;value&quot;</span>
  <span class='@request ivar id'>@request</span><span class='dot token'>.</span><span class='cookies identifier id'>cookies</span><span class='lbrack token'>[</span><span class='string val'>&quot;key&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;value&quot;</span>
</pre>
<h2>Testing named routes</h2>
<p>
If you&#8217;re using named routes, they can be easily tested using the
original named routes&#8217; methods straight in the test case. Example:
</p>
<pre class="code">
 <span class='assert_redirected_to identifier id'>assert_redirected_to</span> <span class='page_url identifier id'>page_url</span><span class='lparen token'>(</span><span class='symbol val'>:title</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'foo'</span><span class='rparen token'>)</span>
</pre>

</div><div class="section constants">
  
</div><div class="section methodmissing">
  <h1>Dynamic Method Handling</h1>

  <p class="note">
    This class handles dynamic methods through the <tt>method_missing</tt> method
    
      in the class <a href='TestProcess.html' title='ActionController::TestProcess'>ActionController::TestProcess</a>
    
  </p>

  <div id="method_missing-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>method_missing</span><span class='args'>(selector, *args, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


507
508
509
510
511
512
513</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/testing/process.rb', line 507</span>

<span class='def def kw'>def</span> <span class='method_missing identifier id'>method_missing</span><span class='lparen token'>(</span><span class='selector identifier id'>selector</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='@controller ivar id'>@controller</span> <span class='andop op'>&amp;&amp;</span> <span class='ActionController constant id'>ActionController</span><span class='colon2 op'>::</span><span class='Routing constant id'>Routing</span><span class='colon2 op'>::</span><span class='Routes constant id'>Routes</span><span class='dot token'>.</span><span class='named_routes identifier id'>named_routes</span><span class='dot token'>.</span><span class='helpers identifier id'>helpers</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='selector identifier id'>selector</span><span class='rparen token'>)</span>
    <span class='@controller ivar id'>@controller</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='selector identifier id'>selector</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='super super kw'>super</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary class public">
    <h1>Public Class Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#controller_class-class_method' title='controller_class'>controller_class</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#determine_default_controller_class-class_method' title='determine_default_controller_class'>determine_default_controller_class</a></span><span class='args'>(name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#prepare_controller_class-class_method' title='prepare_controller_class'>prepare_controller_class</a></span><span class='args'>(new_class)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#tests-class_method' title='tests'>tests</a></span><span class='args'>(controller_class)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sets the controller class name.
</p>

        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h1>Public Class Methods Included from <a href='TestCase/TestProcess.html' title='ActionController::TestProcess'>ActionController::TestProcess</a></h1>
    <p><span class='name'><a href='TestProcess.html#included-class_method' title='included'>included</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rescue_action_in_public%21-instance_method' title='#rescue_action_in_public!'>#rescue_action_in_public!</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Cause the action to be rescued according to the regular rules for
rescue_action when the visitor is not local.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#setup_controller_request_and_response-instance_method' title='#setup_controller_request_and_response'>#setup_controller_request_and_response</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h1>Public Instance Methods Included from <a href='TestCase/TestProcess.html' title='ActionController::TestProcess'>ActionController::TestProcess</a></h1>
    <p><span class='name'><a href='TestProcess.html#assigns-instance_method' title='assigns'>assigns</a></span>, <span class='name'><a href='TestProcess.html#build_request_uri-instance_method' title='build_request_uri'>build_request_uri</a></span>, <span class='name'><a href='TestProcess.html#cookies-instance_method' title='cookies'>cookies</a></span>, <span class='name'><a href='TestProcess.html#delete-instance_method' title='delete'>delete</a></span>, <span class='name'><a href='TestProcess.html#find_all_tag-instance_method' title='find_all_tag'>find_all_tag</a></span>, <span class='name'><a href='TestProcess.html#find_tag-instance_method' title='find_tag'>find_tag</a></span>, <span class='name'><a href='TestProcess.html#fixture_file_upload-instance_method' title='fixture_file_upload'>fixture_file_upload</a></span>, <span class='name'><a href='TestProcess.html#flash-instance_method' title='flash'>flash</a></span>, <span class='name'><a href='TestProcess.html#get-instance_method' title='get'>get</a></span>, <span class='name'><a href='TestProcess.html#head-instance_method' title='head'>head</a></span>, <span class='name'><a href='TestProcess.html#html_document-instance_method' title='html_document'>html_document</a></span>, <span class='name'><a href='TestProcess.html#post-instance_method' title='post'>post</a></span>, <span class='name'><a href='TestProcess.html#process-instance_method' title='process'>process</a></span>, <span class='name'><a href='TestProcess.html#put-instance_method' title='put'>put</a></span>, <span class='name'><a href='TestProcess.html#redirect_to_url-instance_method' title='redirect_to_url'>redirect_to_url</a></span>, <span class='name'><a href='TestProcess.html#session-instance_method' title='session'>session</a></span>, <span class='name'><a href='TestProcess.html#with_routing-instance_method' title='with_routing'>with_routing</a></span>, <span class='name'><a href='TestProcess.html#xml_http_request-instance_method' title='xml_http_request'>xml_http_request</a></span></p>
  </div>
  
  <div>
    <h1>Public Instance Methods Included from <a href='TestCase/Assertions.html' title='ActionController::TestCase::Assertions'>ActionController::TestCase::Assertions</a></h1>
    <p><span class='name'><a href='TestCase/Assertions.html#clean_backtrace-instance_method' title='clean_backtrace'>clean_backtrace</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails class public">
  <h1>Public Class Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>controller_class</h3>
</div><div id="controller_class-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>controller_class</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


165
166
167
168
169
170
171</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/testing/test_case.rb', line 165</span>

<span class='def def kw'>def</span> <span class='controller_class identifier id'>controller_class</span>
  <span class='if if kw'>if</span> <span class='current_controller_class identifier id'>current_controller_class</span> <span class='assign token'>=</span> <span class='read_inheritable_attribute identifier id'>read_inheritable_attribute</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='controller_class identifier id'>controller_class</span><span class='rparen token'>)</span>
    <span class='current_controller_class identifier id'>current_controller_class</span>
  <span class='else else kw'>else</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='controller_class identifier id'>controller_class</span> <span class='assign token'>=</span> <span class='determine_default_controller_class identifier id'>determine_default_controller_class</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>determine_default_controller_class</h3>
</div><div id="determine_default_controller_class-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>determine_default_controller_class</span><span class='args'>(name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


173
174
175
176
177</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/testing/test_case.rb', line 173</span>

<span class='def def kw'>def</span> <span class='determine_default_controller_class identifier id'>determine_default_controller_class</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='name identifier id'>name</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/Test$/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='constantize identifier id'>constantize</span>
<span class='rescue rescue kw'>rescue</span> <span class='NameError constant id'>NameError</span>
  <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>prepare_controller_class</h3>
</div><div id="prepare_controller_class-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>prepare_controller_class</span><span class='args'>(new_class)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


179
180
181</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/testing/test_case.rb', line 179</span>

<span class='def def kw'>def</span> <span class='prepare_controller_class identifier id'>prepare_controller_class</span><span class='lparen token'>(</span><span class='new_class identifier id'>new_class</span><span class='rparen token'>)</span>
  <span class='new_class identifier id'>new_class</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='symbol val'>:include</span><span class='comma token'>,</span> <span class='RaiseActionExceptions constant id'>RaiseActionExceptions</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>tests</h3>
</div><div id="tests-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>tests</span><span class='args'>(controller_class)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sets the controller class name. Useful if the name can&#8217;t be inferred
from test class. Expects <tt>controller_class</tt> as a constant. Example:
<tt>tests WidgetController</tt>.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


156
157
158</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/testing/test_case.rb', line 156</span>

<span class='def def kw'>def</span> <span class='tests identifier id'>tests</span><span class='lparen token'>(</span><span class='controller_class identifier id'>controller_class</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='controller_class identifier id'>controller_class</span> <span class='assign token'>=</span> <span class='controller_class identifier id'>controller_class</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div><div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>rescue_action_in_public!</h3>
</div><div id="rescue_action_in_public%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rescue_action_in_public!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Cause the action to be rescued according to the regular rules for
rescue_action when the visitor is not local
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


200
201
202</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/testing/test_case.rb', line 200</span>

<span class='def def kw'>def</span> <span class='rescue_action_in_public! fid id'>rescue_action_in_public!</span>
  <span class='@request ivar id'>@request</span><span class='dot token'>.</span><span class='remote_addr identifier id'>remote_addr</span> <span class='assign token'>=</span> <span class='string val'>'208.77.188.166'</span> <span class='comment val'># example.com</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>setup_controller_request_and_response</h3>
</div><div id="setup_controller_request_and_response-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>setup_controller_request_and_response</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


184
185
186
187
188
189
190
191
192
193
194
195
196
197</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'actionpack/lib/action_controller/testing/test_case.rb', line 184</span>

<span class='def def kw'>def</span> <span class='setup_controller_request_and_response identifier id'>setup_controller_request_and_response</span>
  <span class='@request ivar id'>@request</span> <span class='assign token'>=</span> <span class='TestRequest constant id'>TestRequest</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@response ivar id'>@response</span> <span class='assign token'>=</span> <span class='TestResponse constant id'>TestResponse</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

  <span class='if if kw'>if</span> <span class='klass identifier id'>klass</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='controller_class identifier id'>controller_class</span>
    <span class='@controller ivar id'>@controller</span> <span class='opasgn op'>||=</span> <span class='klass identifier id'>klass</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='rescue rescue kw'>rescue</span> <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='@controller ivar id'>@controller</span>
    <span class='@controller ivar id'>@controller</span><span class='dot token'>.</span><span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='@request ivar id'>@request</span>
    <span class='@controller ivar id'>@controller</span><span class='dot token'>.</span><span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
    <span class='@controller ivar id'>@controller</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='symbol val'>:initialize_current_url</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>