<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>johnl's xapian-fu - Class: XapianFu::XapianDb - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/johnl/commits/xapian-fu/master" rel="alternate" title="Recent Commits to xapian-fu:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("johnl", "xapian-fu", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("johnl", "xapian-fu", "bb222129a00b8f94ae66356301dfbcf5d35c2fa9", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/johnl/xapian-fu/tree/">Source</a></li>
            <li class=""><a href="http://github.com/johnl/xapian-fu/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/johnl/xapian-fu/network">Network</a></li>            
            <li class=""><a href="http://github.com/johnl/xapian-fu/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/johnl/xapian-fu">Wiki</a></li>
            <li class=""><a href="http://github.com/johnl/xapian-fu/graphs">Graphs</a></li>                    
            <li class="active"><a href="/johnl/xapian-fu">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/johnl">johnl</a> / <b><a href="http://github.com/johnl/xapian-fu/tree">xapian-fu</a></b>        
                <a id="namespaces_button" rel="johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class XapianFu_XapianDb">
  <h1>Class: XapianFu::XapianDb</h1>
  <div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">db_flag</td>
          <td class="readwrite">
            [<span id='db_flag-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>db_flag</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">dir</td>
          <td class="readwrite">
            [<span id='dir-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>dir</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">index_positions</td>
          <td class="readwrite">
            [<span id='index_positions-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>index_positions</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">query_parser</td>
          <td class="readwrite">
            [RW] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
return the current Xapian::QueryParser object, or create a new one.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">store_fields</td>
          <td class="readwrite">
            [<span id='store_fields-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>store_fields</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">store_values</td>
          <td class="readwrite">
            [<span id='store_values-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>store_values</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(options = { })</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 67</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L67">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">67
68
69
70
71
72
73
74
75
76
77
78
79
80</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='rbrace token'>}</span> <span class='rparen token'>)</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='symbol val'>:index_positions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='@dir ivar id'>@dir</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:dir</span><span class='rbrack token'>]</span>
  <span class='@index_positions ivar id'>@index_positions</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:index_positions</span><span class='rbrack token'>]</span>
  <span class='@db_flag ivar id'>@db_flag</span> <span class='assign token'>=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='DB_OPEN constant id'>DB_OPEN</span>
  <span class='@db_flag ivar id'>@db_flag</span> <span class='assign token'>=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='DB_CREATE_OR_OPEN constant id'>DB_CREATE_OR_OPEN</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:create</span><span class='rbrack token'>]</span>
  <span class='@db_flag ivar id'>@db_flag</span> <span class='assign token'>=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='DB_CREATE_OR_OVERWRITE constant id'>DB_CREATE_OR_OVERWRITE</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:overwrite</span><span class='rbrack token'>]</span>
  <span class='@store_fields ivar id'>@store_fields</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:store</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span>
  <span class='@store_values ivar id'>@store_values</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:sortable</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span>
  <span class='@store_values ivar id'>@store_values</span> <span class='opasgn op'>+=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:collapsible</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span>
  <span class='rw identifier id'>rw</span><span class='dot token'>.</span><span class='flush identifier id'>flush</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:create</span><span class='rbrack token'>]</span>
  <span class='@tx_mutex ivar id'>@tx_mutex</span> <span class='assign token'>=</span> <span class='Mutex constant id'>Mutex</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@stemmer ivar id'>@stemmer</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:stemmer</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#add_doc-instance_method">#add_doc</span><span class='args'>(doc)</span>
        <span class='block'></span>
        
          <span class='alias'>#&lt;&lt;</span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#documents-instance_method">#documents</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return the XapianDocumentsAccessor for this database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#enquiry-instance_method">#enquiry</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
return the current Xapian::Enquire object, or create a new one.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#flush-instance_method">#flush</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Flush any changes to disk and reopen the read-only database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#query_parser-instance_method">#query_parser</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
return the current Xapian::QueryParser object, or create a new one..
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ro-instance_method">#ro</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return the read-only Xapian database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#rw-instance_method">#rw</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return the writable Xapian database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#search-instance_method">#search</span><span class='args'>(q, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Conduct a search on the Xapian database, returning an array of XapianDoc
objects for the matches.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#size-instance_method">#size</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return the number of docs in the Xapian database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#stemmer-instance_method">#stemmer</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return a new stemmer object for this database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#transaction-instance_method">#transaction</span><span class='args'>(flush_on_commit = true)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Run the given block in a XapianDB transaction.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>add_doc</h3>
</div><div id="add_doc-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_doc</span><span class='args'>(doc)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="<<-instance_method">&lt;&lt;</tt>
  
</p>
</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 107</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L107">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">107
108
109</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='add_doc identifier id'>add_doc</span><span class='lparen token'>(</span><span class='doc identifier id'>doc</span><span class='rparen token'>)</span>
  <span class='documents identifier id'>documents</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='doc identifier id'>doc</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>documents</h3>
</div><div id="documents-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>documents</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return the XapianDocumentsAccessor for this database
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 103</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L103">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">103
104
105</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='documents identifier id'>documents</span>
  <span class='@documents_accessor ivar id'>@documents_accessor</span> <span class='opasgn op'>||=</span> <span class='XapianDocumentsAccessor constant id'>XapianDocumentsAccessor</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>enquiry</h3>
</div><div id="enquiry-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>enquiry</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
return the current Xapian::Enquire object, or create a new one
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 196</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L196">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">196
197
198</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='enquiry identifier id'>enquiry</span>
  <span class='@enquiry ivar id'>@enquiry</span> <span class='opasgn op'>||=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='Enquire constant id'>Enquire</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='ro identifier id'>ro</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>flush</h3>
</div><div id="flush-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>flush</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Flush any changes to disk and reopen the read-only database. Raises
ConcurrencyError if a transaction is in process
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="ConcurrencyError.html" title="ConcurrencyError">ConcurrencyError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 180</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L180">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">180
181
182
183
184</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='flush identifier id'>flush</span>
  <span class='raise identifier id'>raise</span> <span class='ConcurrencyError constant id'>ConcurrencyError</span> <span class='if if_mod kw'>if</span> <span class='@tx_mutex ivar id'>@tx_mutex</span><span class='dot token'>.</span><span class='locked? fid id'>locked?</span>
  <span class='rw identifier id'>rw</span><span class='dot token'>.</span><span class='flush identifier id'>flush</span>
  <span class='ro identifier id'>ro</span><span class='dot token'>.</span><span class='reopen identifier id'>reopen</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>query_parser</h3>
</div><div id="query_parser-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>query_parser</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
return the current Xapian::QueryParser object, or create a new one
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 187</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L187">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">187
188
189
190
191
192
193</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='query_parser identifier id'>query_parser</span>
  <span class='unless unless kw'>unless</span> <span class='@query_parser ivar id'>@query_parser</span>
    <span class='@query_parser ivar id'>@query_parser</span> <span class='assign token'>=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='QueryParser constant id'>QueryParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='@query_parser ivar id'>@query_parser</span><span class='dot token'>.</span><span class='database identifier id'>database</span> <span class='assign token'>=</span> <span class='ro identifier id'>ro</span>
  <span class='end end kw'>end</span>
  <span class='@query_parser ivar id'>@query_parser</span>
<span class='end end kw'>end</span> 
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ro</h3>
</div><div id="ro-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ro</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return the read-only Xapian database
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 93</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L93">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">93
94
95</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='ro identifier id'>ro</span>
  <span class='@ro ivar id'>@ro</span> <span class='opasgn op'>||=</span> <span class='setup_ro_db identifier id'>setup_ro_db</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rw</h3>
</div><div id="rw-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rw</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return the writable Xapian database
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 88</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L88">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">88
89
90</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='rw identifier id'>rw</span>
  <span class='@rw ivar id'>@rw</span> <span class='opasgn op'>||=</span> <span class='setup_rw_db identifier id'>setup_rw_db</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>search</h3>
</div><div id="search-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>search</span><span class='args'>(q, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Conduct a search on the Xapian database, returning an array of XapianDoc
objects for the matches
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 114</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L114">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='search identifier id'>search</span><span class='lparen token'>(</span><span class='q identifier id'>q</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='defaults identifier id'>defaults</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='symbol val'>:page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='symbol val'>:reverse</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span><span class='comma token'>,</span> 
    <span class='symbol val'>:boolean</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='symbol val'>:boolean_anycase</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='symbol val'>:wildcards</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> 
    <span class='symbol val'>:lovehate</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='symbol val'>:spelling</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='symbol val'>:pure_not</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span> <span class='rbrace token'>}</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='defaults identifier id'>defaults</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='page identifier id'>page</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:page</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='rescue rescue kw'>rescue</span> <span class='integer val'>1</span>
  <span class='page identifier id'>page</span> <span class='assign token'>=</span> <span class='page identifier id'>page</span> <span class='gt op'>&gt;</span> <span class='integer val'>1</span> <span class='question op'>?</span> <span class='page identifier id'>page</span> <span class='minus op'>-</span> <span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span>
  <span class='per_page identifier id'>per_page</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:per_page</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:limit</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='integer val'>10</span>
  <span class='per_page identifier id'>per_page</span> <span class='assign token'>=</span> <span class='per_page identifier id'>per_page</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='rescue rescue kw'>rescue</span> <span class='integer val'>10</span>
  <span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='page identifier id'>page</span> <span class='mult op'>*</span> <span class='per_page identifier id'>per_page</span>
  <span class='qflags identifier id'>qflags</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='qflags identifier id'>qflags</span> <span class='opasgn op'>|=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='QueryParser constant id'>QueryParser</span><span class='colon2 op'>::</span><span class='FLAG_BOOLEAN constant id'>FLAG_BOOLEAN</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:boolean</span><span class='rbrack token'>]</span>
  <span class='qflags identifier id'>qflags</span> <span class='opasgn op'>|=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='QueryParser constant id'>QueryParser</span><span class='colon2 op'>::</span><span class='FLAG_BOOLEAN_ANY_CASE constant id'>FLAG_BOOLEAN_ANY_CASE</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:boolean_anycase</span><span class='rbrack token'>]</span>
  <span class='qflags identifier id'>qflags</span> <span class='opasgn op'>|=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='QueryParser constant id'>QueryParser</span><span class='colon2 op'>::</span><span class='FLAG_WILDCARD constant id'>FLAG_WILDCARD</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:wildcards</span><span class='rbrack token'>]</span>
  <span class='qflags identifier id'>qflags</span> <span class='opasgn op'>|=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='QueryParser constant id'>QueryParser</span><span class='colon2 op'>::</span><span class='FLAG_LOVEHATE constant id'>FLAG_LOVEHATE</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:lovehate</span><span class='rbrack token'>]</span>
  <span class='qflags identifier id'>qflags</span> <span class='opasgn op'>|=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='QueryParser constant id'>QueryParser</span><span class='colon2 op'>::</span><span class='FLAG_SPELLING_CORRECTION constant id'>FLAG_SPELLING_CORRECTION</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:spelling</span><span class='rbrack token'>]</span>
  <span class='qflags identifier id'>qflags</span> <span class='opasgn op'>|=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='QueryParser constant id'>QueryParser</span><span class='colon2 op'>::</span><span class='FLAG_PURE_NOT constant id'>FLAG_PURE_NOT</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:pure_not</span><span class='rbrack token'>]</span>
  <span class='default_op identifier id'>default_op</span> <span class='assign token'>=</span> <span class='case case kw'>case</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:default_op</span><span class='rbrack token'>]</span>
               <span class='when when kw'>when</span> <span class='symbol val'>:and_maybe</span>
                 <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='Query constant id'>Query</span><span class='colon2 op'>::</span><span class='OP_AND_MAYBE constant id'>OP_AND_MAYBE</span>
               <span class='when when kw'>when</span> <span class='symbol val'>:or</span>
                 <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='Query constant id'>Query</span><span class='colon2 op'>::</span><span class='OP_OR constant id'>OP_OR</span>
               <span class='when when kw'>when</span> <span class='symbol val'>:phrase</span>
                 <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='Query constant id'>Query</span><span class='colon2 op'>::</span><span class='OP_PHRASE constant id'>OP_PHRASE</span>
               <span class='else else kw'>else</span>
                 <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='Query constant id'>Query</span><span class='colon2 op'>::</span><span class='OP_AND constant id'>OP_AND</span>
               <span class='end end kw'>end</span>
  <span class='query_parser identifier id'>query_parser</span><span class='dot token'>.</span><span class='default_op identifier id'>default_op</span> <span class='assign token'>=</span> <span class='default_op identifier id'>default_op</span>
  <span class='query identifier id'>query</span> <span class='assign token'>=</span> <span class='query_parser identifier id'>query_parser</span><span class='dot token'>.</span><span class='parse_query identifier id'>parse_query</span><span class='lparen token'>(</span><span class='q identifier id'>q</span><span class='comma token'>,</span> <span class='qflags identifier id'>qflags</span><span class='rparen token'>)</span>
  <span class='setup_ordering identifier id'>setup_ordering</span><span class='lparen token'>(</span><span class='enquiry identifier id'>enquiry</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:order</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:reverse</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> 
  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:collapse</span><span class='rbrack token'>]</span>
    <span class='enquiry identifier id'>enquiry</span><span class='dot token'>.</span><span class='collapse_key identifier id'>collapse_key</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:collapse</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span>
  <span class='end end kw'>end</span>
  <span class='enquiry identifier id'>enquiry</span><span class='dot token'>.</span><span class='query identifier id'>query</span> <span class='assign token'>=</span> <span class='query identifier id'>query</span>
  <span class='ResultSet constant id'>ResultSet</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:mset</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='enquiry identifier id'>enquiry</span><span class='dot token'>.</span><span class='mset identifier id'>mset</span><span class='lparen token'>(</span><span class='offset identifier id'>offset</span><span class='comma token'>,</span> <span class='per_page identifier id'>per_page</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:current_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='page identifier id'>page</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='comma token'>,</span> 
                <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='per_page identifier id'>per_page</span><span class='comma token'>,</span> <span class='symbol val'>:corrected_query</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='query_parser identifier id'>query_parser</span><span class='dot token'>.</span><span class='get_corrected_query_string identifier id'>get_corrected_query_string</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>size</h3>
</div><div id="size-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>size</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return the number of docs in the Xapian database
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 98</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L98">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">98
99
100</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='size identifier id'>size</span>
  <span class='ro identifier id'>ro</span><span class='dot token'>.</span><span class='doccount identifier id'>doccount</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>stemmer</h3>
</div><div id="stemmer-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>stemmer</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return a new stemmer object for this database
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 83</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L83">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">83
84
85</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='stemmer identifier id'>stemmer</span>
  <span class='StemFactory constant id'>StemFactory</span><span class='dot token'>.</span><span class='stemmer_for identifier id'>stemmer_for</span><span class='lparen token'>(</span><span class='@stemmer ivar id'>@stemmer</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>transaction</h3>
</div><div id="transaction-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>transaction</span><span class='args'>(flush_on_commit = true)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Run the given block in a XapianDB transaction. Any changes to the Xapian
database made in the block will be atomically committed at the end.
</p>
<p>
If an exception is raised by the block, all changes are discarded and the
exception re-raised.
</p>
<p>
Xapian does not support multiple concurrent transactions on the same Xapian
database. Any attempts at this will be serialized by XapianFu, which is not
perfect but probably better than just kicking up an exception.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/xapian_fu/xapian_db.rb', line 163</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/johnl/xapian-fu/blob/bb222129a00b8f94ae66356301dfbcf5d35c2fa9/lib/xapian_fu/xapian_db.rb#L163">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">163
164
165
166
167
168
169
170
171
172
173
174
175
176</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='transaction identifier id'>transaction</span><span class='lparen token'>(</span><span class='flush_on_commit identifier id'>flush_on_commit</span> <span class='assign token'>=</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='@tx_mutex ivar id'>@tx_mutex</span><span class='dot token'>.</span><span class='synchronize identifier id'>synchronize</span> <span class='do do kw'>do</span>
    <span class='begin begin kw'>begin</span>
      <span class='rw identifier id'>rw</span><span class='dot token'>.</span><span class='begin_transaction identifier id'>begin_transaction</span><span class='lparen token'>(</span><span class='flush_on_commit identifier id'>flush_on_commit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span>
    <span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
      <span class='rw identifier id'>rw</span><span class='dot token'>.</span><span class='cancel_transaction identifier id'>cancel_transaction</span>
      <span class='ro identifier id'>ro</span><span class='dot token'>.</span><span class='reopen identifier id'>reopen</span>
      <span class='raise identifier id'>raise</span> <span class='e identifier id'>e</span>
    <span class='end end kw'>end</span>
    <span class='rw identifier id'>rw</span><span class='dot token'>.</span><span class='commit_transaction identifier id'>commit_transaction</span>
    <span class='ro identifier id'>ro</span><span class='dot token'>.</span><span class='reopen identifier id'>reopen</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>