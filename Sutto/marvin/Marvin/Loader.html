<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: Marvin::Loader</title>
  </head>
  <body>
    <div id="content">
      <div class="section class Marvin_Loader">
  <h1 class="title">Class: Marvin::Loader</h1>
  <div class="section mixins">
  <h1>Included Modules</h1>
  <p>Singleton</p>
</div><div class="section constants">
  <div class="thisclass">
  <h1>Constants</h1>
  <dl>
    
      <dt id="CONTROLLERS-constant">CONTROLLERS</dt>
      <dd>{      :client             =&gt; Marvin::Settings.default_client,      :server             =&gt; Marvin::IRC::Server,      :ring_server        =&gt; Marvin::Distributed::RingServer,      :distributed_client =&gt; Marvin::Distributed::DRbClient,      :console            =&gt; Marvin::Console    }</dd>
    
  </dl>
</div>

</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary class public">
    <h1>Public Class Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#after_stop-class_method' title='after_stop'>after_stop</a></span><span class='args'>(&amp;blk)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Register a hook to be run after the controller has stopped.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#append_hook-class_method' title='append_hook'>append_hook</a></span><span class='args'>(type, &amp;blk)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Append a hook for a given type of hook in order to be called later on via
invoke_hooks!.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#before_connecting-class_method' title='before_connecting'>before_connecting</a></span><span class='args'>(&amp;blk)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Old style of registering a block to be run on startup for doing setup etc.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#before_run-class_method' title='before_run'>before_run</a></span><span class='args'>(&amp;blk)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Append a call back to be run at a specific stage.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#hooks_for-class_method' title='hooks_for'>hooks_for</a></span><span class='args'>(type)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return all of the existing hooks or an empty for a given hook type.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#invoke_hooks%21-class_method' title='invoke_hooks!'>invoke_hooks!</a></span><span class='args'>(type)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Invoke (call) all of the hooks for a given type.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#run%21-class_method' title='run!'>run!</a></span><span class='args'>(type = :client)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#stop%21-class_method' title='stop!'>stop!</a></span><span class='args'>(force = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#run%21-instance_method' title='#run!'>#run!</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#stop%21-instance_method' title='#stop!'>#stop!</a></span><span class='args'>(force = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails class public">
  <h1>Public Class Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>after_stop</h3>
</div><div id="after_stop-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>after_stop</span><span class='args'>(&amp;blk)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Register a hook to be run after the controller has stopped. Note that this
will not guarantee all processing has completed.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


68
69
70</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 68</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='after_stop identifier id'>after_stop</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span><span class='rparen token'>)</span>
  <span class='append_hook identifier id'>append_hook</span><span class='lparen token'>(</span><span class='symbol val'>:after_stop</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>append_hook</h3>
</div><div id="append_hook-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>append_hook</span><span class='args'>(type, &amp;blk)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Append a hook for a given type of hook in order to be called later on via
invoke_hooks!
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


41
42
43</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 41</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='append_hook identifier id'>append_hook</span><span class='lparen token'>(</span><span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='hooks_for identifier id'>hooks_for</span><span class='lparen token'>(</span><span class='type identifier id'>type</span><span class='rparen token'>)</span> <span class='lshft op'>&lt;&lt;</span> <span class='blk identifier id'>blk</span> <span class='unless unless_mod kw'>unless</span> <span class='blk identifier id'>blk</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>before_connecting</h3>
</div><div id="before_connecting-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>before_connecting</span><span class='args'>(&amp;blk)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Old style of registering a block to be run on startup for doing setup etc.
now replaced by before_run
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


34
35
36
37</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 34</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='before_connecting identifier id'>before_connecting</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span><span class='rparen token'>)</span>
  <span class='Marvin constant id'>Marvin</span><span class='colon2 op'>::</span><span class='Logger constant id'>Logger</span><span class='dot token'>.</span><span class='warn identifier id'>warn</span> <span class='string val'>&quot;Marvin::Loader.before_connecting is deprecated, please use before_run instead.&quot;</span>
  <span class='before_run identifier id'>before_run</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>before_run</h3>
</div><div id="before_run-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>before_run</span><span class='args'>(&amp;blk)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Append a call back to be run at a specific stage. Register a hook to be run
before the controller has started running.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


61
62
63</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 61</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='before_run identifier id'>before_run</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span><span class='rparen token'>)</span>
  <span class='append_hook identifier id'>append_hook</span><span class='lparen token'>(</span><span class='symbol val'>:before_run</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>hooks_for</h3>
</div><div id="hooks_for-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>hooks_for</span><span class='args'>(type)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return all of the existing hooks or an empty for a given hook type.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


47
48
49</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 47</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='hooks_for identifier id'>hooks_for</span><span class='lparen token'>(</span><span class='type identifier id'>type</span><span class='rparen token'>)</span>
  <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='hooks identifier id'>hooks</span><span class='lbrack token'>[</span><span class='type identifier id'>type</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>invoke_hooks!</h3>
</div><div id="invoke_hooks%21-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>invoke_hooks!</span><span class='args'>(type)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Invoke (call) all of the hooks for a given type.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


53
54
55</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 53</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='invoke_hooks! fid id'>invoke_hooks!</span><span class='lparen token'>(</span><span class='type identifier id'>type</span><span class='rparen token'>)</span>
  <span class='hooks_for identifier id'>hooks_for</span><span class='lparen token'>(</span><span class='type identifier id'>type</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='hook identifier id'>hook</span><span class='bitor op'>|</span> <span class='hook identifier id'>hook</span><span class='dot token'>.</span><span class='call identifier id'>call</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>run!</h3>
</div><div id="run%21-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>run!</span><span class='args'>(type = :client)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


72
73
74
75</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 72</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='run! fid id'>run!</span><span class='lparen token'>(</span><span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='symbol val'>:client</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='type identifier id'>type</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='instance identifier id'>instance</span><span class='dot token'>.</span><span class='run! fid id'>run!</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>stop!</h3>
</div><div id="stop%21-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>stop!</span><span class='args'>(force = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


77
78
79</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 77</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='stop! fid id'>stop!</span><span class='lparen token'>(</span><span class='force identifier id'>force</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='instance identifier id'>instance</span><span class='dot token'>.</span><span class='stop! fid id'>stop!</span><span class='lparen token'>(</span><span class='force identifier id'>force</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div><div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>run!</h3>
</div><div id="run%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>run!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


81
82
83
84
85
86
87
88
89
90
91</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 81</span>

<span class='def def kw'>def</span> <span class='run! fid id'>run!</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='register_signals identifier id'>register_signals</span>
  <span class='Marvin constant id'>Marvin</span><span class='colon2 op'>::</span><span class='Options constant id'>Options</span><span class='dot token'>.</span><span class='parse! fid id'>parse!</span>
  <span class='Marvin constant id'>Marvin</span><span class='colon2 op'>::</span><span class='Daemon constant id'>Daemon</span><span class='dot token'>.</span><span class='daemonize! fid id'>daemonize!</span> <span class='if if_mod kw'>if</span> <span class='Marvin constant id'>Marvin</span><span class='colon2 op'>::</span><span class='Settings constant id'>Settings</span><span class='dot token'>.</span><span class='daemon? fid id'>daemon?</span>
  <span class='Marvin constant id'>Marvin</span><span class='colon2 op'>::</span><span class='Logger constant id'>Logger</span><span class='dot token'>.</span><span class='setup identifier id'>setup</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='load_settings identifier id'>load_settings</span>
  <span class='require identifier id'>require</span><span class='lparen token'>(</span><span class='Marvin constant id'>Marvin</span><span class='colon2 op'>::</span><span class='Settings constant id'>Settings</span><span class='dot token'>.</span><span class='root identifier id'>root</span> <span class='div op'>/</span> <span class='string val'>&quot;config&quot;</span> <span class='div op'>/</span> <span class='string val'>&quot;setup&quot;</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='load_handlers identifier id'>load_handlers</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='invoke_hooks! fid id'>invoke_hooks!</span>   <span class='symbol val'>:before_run</span>
  <span class='attempt_controller_action! fid id'>attempt_controller_action!</span> <span class='symbol val'>:run</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>stop!</h3>
</div><div id="stop%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>stop!</span><span class='args'>(force = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


93
94
95
96
97
98
99
100
101</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/marvin/loader.rb', line 93</span>

<span class='def def kw'>def</span> <span class='stop! fid id'>stop!</span><span class='lparen token'>(</span><span class='force identifier id'>force</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='force identifier id'>force</span> <span class='orop op'>||</span> <span class='notop op'>!</span><span class='@attempted_stop ivar id'>@attempted_stop</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='invoke_hooks! fid id'>invoke_hooks!</span>   <span class='symbol val'>:before_stop</span>
    <span class='attempt_controller_action! fid id'>attempt_controller_action!</span> <span class='symbol val'>:stop</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='invoke_hooks! fid id'>invoke_hooks!</span>   <span class='symbol val'>:after_stop</span>
    <span class='@attempted_stop ivar id'>@attempted_stop</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
  <span class='Marvin constant id'>Marvin</span><span class='colon2 op'>::</span><span class='Daemon constant id'>Daemon</span><span class='dot token'>.</span><span class='cleanup! fid id'>cleanup!</span> <span class='if if_mod kw'>if</span> <span class='Marvin constant id'>Marvin</span><span class='colon2 op'>::</span><span class='Settings constant id'>Settings</span><span class='dot token'>.</span><span class='daemon? fid id'>daemon?</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>