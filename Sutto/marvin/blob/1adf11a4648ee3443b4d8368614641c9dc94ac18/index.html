<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>Sutto's marvin - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/Sutto/commits/marvin/master" rel="alternate" title="Recent Commits to marvin:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    GitHubRepo.init("Sutto", "marvin", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='Sutto/marvin/blob/1adf11a4648ee3443b4d8368614641c9dc94ac18' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='Sutto/marvin/blob/1adf11a4648ee3443b4d8368614641c9dc94ac18' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("Sutto", "marvin", "1adf11a4648ee3443b4d8368614641c9dc94ac18", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/Sutto/marvin/tree/">Source</a></li>
            <li class=""><a href="http://github.com/Sutto/marvin/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/Sutto/marvin/network">Network</a></li>            
            <li class=""><a href="http://github.com/Sutto/marvin/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/Sutto/marvin">Wiki</a></li>
            <li class=""><a href="http://github.com/Sutto/marvin/graphs">Graphs</a></li>                    
            <li class="active"><a href="/Sutto/marvin">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/Sutto">Sutto</a> / <b><a href="http://github.com/Sutto/marvin/tree">marvin</a></b>        
                <a id="namespaces_button" rel="Sutto/marvin/blob/1adf11a4648ee3443b4d8368614641c9dc94ac18" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="Sutto/marvin/blob/1adf11a4648ee3443b4d8368614641c9dc94ac18" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>Marvin</h1>


	<p>Marvin is a ruby irc framework / library built on top of event machine.
It&#8217;s been build from scratch to be evented &#8211; you build &#8220;handlers&#8221; which
are called whenever an event occurs.</p>


	<p>A single client instance can handle multiple <span class="caps">IRC</span> connections (and will
automatically reconnect in the case that a connection is lost). Distributed
support (e.g. 1 client =&gt; multiple handler backends) is built in out of
the box on top of DRb.</p>


	<h2>Getting Started</h2>


	<p>Starting out with Marvin is simple. You can either go the &#8220;edge&#8221; route -
cloning from the GitHub repository (in this case, <a href="http://github.com/sutto/marvin">here</a>)
and then running the following:</p>


	<pre class="code">$ <span class='rake identifier id'>rake</span> <span class='gemspec identifier id'>gemspec</span>
$ <span class='gem identifier id'>gem</span> <span class='build identifier id'>build</span> <span class='marvin identifier id'>marvin</span><span class='dot token'>.</span><span class='gemspec identifier id'>gemspec</span>
$ <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='marvin identifier id'>marvin</span><span class='dot token'>.</span><span class='gem identifier id'>gem</span>
</pre>


	<p>Or, for a generally more stable release you can install it from the GitHub gem
server (requiring Rubygems &gt;= 1.2.0 with the GitHub sources added), by running
the following:</p>


	<pre class="code">$ <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='Sutto constant id'>Sutto</span><span class='minus op'>-</span><span class='marvin identifier id'>marvin</span>
</pre>


	<p>Installing the gem will make available a new executable &#8211; &#8220;<ins>marvin</ins>&#8221; &#8211; which is
used as an easy way to do a variety of tasks. To get started, you can create
a project located at given path using the following command:</p>


	<pre class="code">$ <span class='marvin identifier id'>marvin</span> <span class='create identifier id'>create</span> <span class='path identifier id'>path</span><span class='minus op'>-</span><span class='to identifier id'>to</span><span class='minus op'>-</span><span class='my identifier id'>my</span><span class='minus op'>-</span><span class='bot identifier id'>bot</span>
</pre>


	<p>Once that&#8217;s done, you&#8217;ll have a blank slate loaded with the default marvin handlers -
<ins>HelloWorld</ins> (which will respond to any addressed &#8220;hello&#8221;&#8217;s) and an empty debug handler
which you can use for generic debugging. To run the new app, you can use either of the
following:</p>


	<pre class="code">$ <span class='cd identifier id'>cd</span> <span class='path identifier id'>path</span><span class='minus op'>-</span><span class='to identifier id'>to</span><span class='minus op'>-</span><span class='my identifier id'>my</span><span class='minus op'>-</span><span class='bot identifier id'>bot</span> <span class='andop op'>&amp;&amp;</span> <span class='script identifier id'>script</span><span class='div op'>/</span><span class='client identifier id'>client</span>
</pre>


	<p>or, alternatively,</p>


	<pre class="code">$ <span class='marvin identifier id'>marvin</span> <span class='client identifier id'>client</span> <span class='path identifier id'>path</span><span class='minus op'>-</span><span class='to identifier id'>to</span><span class='minus op'>-</span><span class='my identifier id'>my</span><span class='minus op'>-</span><span class='bot identifier id'>bot</span>
</pre>


	<p>There are a couple of options available for the client (as well as the marvin library),
Each of which can be found by appending the &#8220;&#8212;help&#8221; option to the command.</p>


	<p>Once your client has been started (assuming the name wasn&#8217;t taken / it could connect),
simply join the chat room your bot was instructed to join and say the following (substiting
BotNick for the nick name your bot connected with):</p>


	<pre class="code"><span class='BotNick constant id'>BotNick</span><span class='colon op'>:</span> <span class='hello identifier id'>hello</span>
</pre>


	<p>Or even easier, by PM&#8217;ing the bot with:</p>


	<pre class="code"><span class='hello identifier id'>hello</span>
</pre>


	<p>Assuming all went well, your bot should reply back with something akin to (where YourNick)
if the nickname you connected with):</p>


	<pre class="code"><span class='YourNick constant id'>YourNick</span><span class='colon op'>:</span> <span class='Hola constant id'>Hola</span> <span class='from identifier id'>from</span> <span class='process identifier id'>process</span> <span class='with identifier id'>with</span> <span class='pid identifier id'>pid</span> <span class='integer val'>12342</span>
</pre>


	<h2>Distributed Bots</h2>


	<p>One of the relatively unique features of Marvin is the ability to write bots
which use DRb and Rinda which can grow with relative ease.</p>


	<p>It&#8217;s important to keep in mind that keeping state is discouraged in this case
as it can not be ensured that clients are still active or that you will always
get messages from the same client.</p>


	<p>For a start, take a look at the default <ins>config/setup.rb</ins> file which contains
an example of registering handlers on a distributed client as well as setting
up the distributed handler which needs to be setup on the main client.</p>


	<p>By default, the messages will be dispatched to the first discovered tuple
space (using Rinda::RingFinger) and will be of the format:</p>


	<pre class="code"><span class='lbrack token'>[</span><span class='symbol val'>:marvin_format</span><span class='comma token'>,</span> <span class='symbol val'>:your_namespace</span><span class='comma token'>,</span> <span class='symbol val'>:message_name</span><span class='comma token'>,</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='geq op'>&gt;=</span><span class='bitand op'>&amp;</span><span class='gt identifier id'>gt</span><span class='semicolon token'>;</span> <span class='string val'>&quot;options&quot;</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;, client_reference]
</span></pre>


	<p>You can change the namespace (which defaults to <ins cite="d">efault</ins>) by setting <ins>Marvin::Settings.distributed_namespace</ins></p>


	<p>Running a distributed client requires three things:</p>


	<ul>
	<li>1 Ring server instance (<ins>script/ring_server</ins> or <ins>marvin ring_server</ins> or <ins>marvin rs</ins>)</li>
		<li>1+ Client instances (<ins>script/client</ins> or <ins>marvin client</ins> or <ins>marvin cl</ins>)</li>
		<li>1+ Distributed Client instances (<ins>script/distributed_client</ins> or <ins>marvin distributed_client</ins> or <ins>marvin dc</ins>)</li>
	</ul>


Each of which takes the default options of:
	<ul>
	<li>-v &#8211; Be verbose and print to <span class="caps">STDOUT</span> if not daemonized</li>
		<li>-level=something &#8211; set level, defaults to info</li>
		<li>-d &#8211; daemonize the process</li>
		<li>-k &#8211; kill all daemonized instances of this specific kind</li>
	</ul>


	<h2>Example Bots</h2>


	<p>Coming soon.</p>


	<h2>Thanks</h2>


	<p>Thanks go to:</p>


	<ul>
	<li>Jeff Rafter &#8211; contributed code and doc changes, now one of the co-developers.</li>
		<li>epitron / halogrium &#8211; For the ragel state machine used in Marvin::Parsers::RagelParser</li>
		<li>The creator of Ruby-IRCD &#8211; the server component is heavily influenced by / part derivative of said work.</li>
	</ul>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>