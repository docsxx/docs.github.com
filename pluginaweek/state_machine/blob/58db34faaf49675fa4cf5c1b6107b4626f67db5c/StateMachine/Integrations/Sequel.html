<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>pluginaweek's state_machine - Module: StateMachine::Integrations::Sequel - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/pluginaweek/commits/state_machine/master" rel="alternate" title="Recent Commits to state_machine:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("pluginaweek", "state_machine", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='pluginaweek/state_machine/blob/58db34faaf49675fa4cf5c1b6107b4626f67db5c' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='pluginaweek/state_machine/blob/58db34faaf49675fa4cf5c1b6107b4626f67db5c' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("pluginaweek", "state_machine", "58db34faaf49675fa4cf5c1b6107b4626f67db5c", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/pluginaweek/state_machine/tree/">Source</a></li>
            <li class=""><a href="http://github.com/pluginaweek/state_machine/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/pluginaweek/state_machine/network">Network</a></li>            
            <li class=""><a href="http://github.com/pluginaweek/state_machine/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/pluginaweek/state_machine">Wiki</a></li>
            <li class=""><a href="http://github.com/pluginaweek/state_machine/graphs">Graphs</a></li>                    
            <li class="active"><a href="/pluginaweek/state_machine">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/pluginaweek">pluginaweek</a> / <b><a href="http://github.com/pluginaweek/state_machine/tree">state_machine</a></b>        
                <a id="namespaces_button" rel="pluginaweek/state_machine/blob/58db34faaf49675fa4cf5c1b6107b4626f67db5c" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="pluginaweek/state_machine/blob/58db34faaf49675fa4cf5c1b6107b4626f67db5c" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module StateMachine_Integrations_Sequel">
  <h1>Module: StateMachine::Integrations::Sequel</h1>
  <div class="section docstring">
  <p>
Adds support for integrating state machines with Sequel models.
</p>
<h2>Examples</h2>
<p>
Below is an example of a simple state machine defined within a Sequel
model:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Vehicle constant id'>Vehicle</span> <span class='lt op'>&lt;</span> <span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span>
    <span class='state_machine identifier id'>state_machine</span> <span class='symbol val'>:initial</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:parked</span> <span class='do do kw'>do</span>
      <span class='event identifier id'>event</span> <span class='symbol val'>:ignite</span> <span class='do do kw'>do</span>
        <span class='transition identifier id'>transition</span> <span class='symbol val'>:parked</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:idling</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
The examples in the sections below will use the above class as a reference.
</p>
<h2>Actions</h2>
<p>
By default, the action that will be invoked when a state is transitioned is
the <tt>save</tt> action. This will cause the resource to save the changes
made to the state machine&#8217;s attribute. <b>Note</b> that if any other
changes were made to the resource prior to transition, then those changes
will be made as well.
</p>
<p>
For example,
</p>
<pre class="code">
  <span class='vehicle identifier id'>vehicle</span> <span class='assign token'>=</span> <span class='Vehicle constant id'>Vehicle</span><span class='dot token'>.</span><span class='create identifier id'>create</span>          <span class='comment val'># =&gt; #&lt;Vehicle @values={:state=&gt;&quot;parked&quot;, :name=&gt;nil, :id=&gt;1}&gt;</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='string val'>'Ford Explorer'</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='ignite identifier id'>ignite</span>                    <span class='comment val'># =&gt; true</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='refresh identifier id'>refresh</span>                   <span class='comment val'># =&gt; #&lt;Vehicle @values={:state=&gt;&quot;idling&quot;, :name=&gt;&quot;Ford Explorer&quot;, :id=&gt;1}&gt;</span>
</pre>
<h2>Events</h2>
<p>
As described in StateMachine::InstanceMethods#state_machine, event
attributes are created for every machine that allow transitions to be
performed automatically when the object&#8217;s action (in this case,
:save) is called.
</p>
<p>
In Sequel, these automated events are run in the following order:
</p>
<ul>
<li>before validation - Run before callbacks and persist new states, then
validate

</li>
<li>before save - If validation was skipped, run before callbacks and persist
new states, then save

</li>
<li>after save - Run after callbacks

</li>
</ul>
<p>
For example,
</p>
<pre class="code">
  <span class='vehicle identifier id'>vehicle</span> <span class='assign token'>=</span> <span class='Vehicle constant id'>Vehicle</span><span class='dot token'>.</span><span class='create identifier id'>create</span>          <span class='comment val'># =&gt; #&lt;Vehicle @values={:state=&gt;&quot;parked&quot;, :name=&gt;nil, :id=&gt;1}&gt;</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='state_event identifier id'>state_event</span>               <span class='comment val'># =&gt; nil</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='state_event identifier id'>state_event</span> <span class='assign token'>=</span> <span class='string val'>'invalid'</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='valid? fid id'>valid?</span>                    <span class='comment val'># =&gt; false</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='errors identifier id'>errors</span><span class='dot token'>.</span><span class='full_messages identifier id'>full_messages</span>      <span class='comment val'># =&gt; [&quot;state_event is invalid&quot;]</span>

  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='state_event identifier id'>state_event</span> <span class='assign token'>=</span> <span class='string val'>'ignite'</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='valid? fid id'>valid?</span>                    <span class='comment val'># =&gt; true</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='save identifier id'>save</span>                      <span class='comment val'># =&gt; #&lt;Vehicle @values={:state=&gt;&quot;idling&quot;, :name=&gt;nil, :id=&gt;1}&gt;</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='state identifier id'>state</span>                     <span class='comment val'># =&gt; &quot;idling&quot;</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='state_event identifier id'>state_event</span>               <span class='comment val'># =&gt; nil</span>
</pre>
<p>
Note that this can also be done on a mass-assignment basis:
</p>
<pre class="code">
  <span class='vehicle identifier id'>vehicle</span> <span class='assign token'>=</span> <span class='Vehicle constant id'>Vehicle</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='symbol val'>:state_event</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'ignite'</span><span class='rparen token'>)</span>  <span class='comment val'># =&gt; #&lt;Vehicle @values={:state=&gt;&quot;idling&quot;, :name=&gt;nil, :id=&gt;1}&gt;</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='state identifier id'>state</span>                                       <span class='comment val'># =&gt; &quot;idling&quot;</span>
</pre>
<h3>Security implications</h3>
<p>
Beware that public event attributes mean that events can be fired whenever
mass-assignment is being used. If you want to prevent malicious users from
tampering with events through URLs / forms, the attribute should be
protected like so:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Vehicle constant id'>Vehicle</span> <span class='lt op'>&lt;</span> <span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span>
    <span class='set_restricted_columns identifier id'>set_restricted_columns</span> <span class='symbol val'>:state_event</span>
    <span class='comment val'># set_allowed_columns ... # Alternative technique</span>

    <span class='state_machine identifier id'>state_machine</span> <span class='do do kw'>do</span>
      <span class='dot3 op'>...</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
If you want to only have <b>some</b> events be able to fire via
mass-assignment, you can build two state machines (one public and one
protected) like so:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Vehicle constant id'>Vehicle</span> <span class='lt op'>&lt;</span> <span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span>
    <span class='comment val'># Allow both machines to share the same state</span>
    <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:public_state</span><span class='comma token'>,</span> <span class='symbol val'>:state</span>
    <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:public_state=</span><span class='comma token'>,</span> <span class='symbol val'>:state=</span>

    <span class='set_restricted_columns identifier id'>set_restricted_columns</span> <span class='symbol val'>:state_event</span> <span class='comment val'># Prevent access to events in the first machine</span>

    <span class='state_machine identifier id'>state_machine</span> <span class='do do kw'>do</span>
      <span class='comment val'># Define private events here</span>
    <span class='end end kw'>end</span>

    <span class='state_machine identifier id'>state_machine</span> <span class='symbol val'>:public_state</span> <span class='do do kw'>do</span>
      <span class='comment val'># Define public events here</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<h2>Transactions</h2>
<p>
In order to ensure that any changes made during transition callbacks are
rolled back during a failed attempt, every transition is wrapped within a
transaction.
</p>
<p>
For example,
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Message constant id'>Message</span> <span class='lt op'>&lt;</span> <span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span>
  <span class='end end kw'>end</span>

  <span class='Vehicle constant id'>Vehicle</span><span class='dot token'>.</span><span class='state_machine identifier id'>state_machine</span> <span class='do do kw'>do</span>
    <span class='before_transition identifier id'>before_transition</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='transition identifier id'>transition</span><span class='bitor op'>|</span>
      <span class='Message constant id'>Message</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='symbol val'>:content</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='transition identifier id'>transition</span><span class='dot token'>.</span><span class='inspect identifier id'>inspect</span><span class='rparen token'>)</span>
      <span class='false false kw'>false</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='vehicle identifier id'>vehicle</span> <span class='assign token'>=</span> <span class='Vehicle constant id'>Vehicle</span><span class='dot token'>.</span><span class='create identifier id'>create</span>      <span class='comment val'># =&gt; #&lt;Vehicle @values={:state=&gt;&quot;parked&quot;, :name=&gt;nil, :id=&gt;1}&gt;</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='ignite identifier id'>ignite</span>                <span class='comment val'># =&gt; false</span>
  <span class='Message constant id'>Message</span><span class='dot token'>.</span><span class='count identifier id'>count</span>                 <span class='comment val'># =&gt; 0</span>
</pre>
<p>
<b>Note</b> that only before callbacks that halt the callback chain and
failed attempts to save the record will result in the transaction being
rolled back. If an after callback halts the chain, the previous result
still applies and the transaction is <b>not</b> rolled back.
</p>
<p>
To turn off transactions:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Vehicle constant id'>Vehicle</span> <span class='lt op'>&lt;</span> <span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span>
    <span class='state_machine identifier id'>state_machine</span> <span class='symbol val'>:initial</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:parked</span><span class='comma token'>,</span> <span class='symbol val'>:use_transactions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span> <span class='do do kw'>do</span>
      <span class='dot3 op'>...</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<h2>Validation errors</h2>
<p>
If an event fails to successfully fire because there are no matching
transitions for the current record, a validation error is added to the
record&#8217;s state attribute to help in determining why it failed and for
reporting via the UI.
</p>
<p>
For example,
</p>
<pre class="code">
  <span class='vehicle identifier id'>vehicle</span> <span class='assign token'>=</span> <span class='Vehicle constant id'>Vehicle</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='symbol val'>:state</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'idling'</span><span class='rparen token'>)</span>  <span class='comment val'># =&gt; #&lt;Vehicle @values={:state=&gt;&quot;parked&quot;, :name=&gt;nil, :id=&gt;1}&gt;</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='ignite identifier id'>ignite</span>                                <span class='comment val'># =&gt; false</span>
  <span class='vehicle identifier id'>vehicle</span><span class='dot token'>.</span><span class='errors identifier id'>errors</span><span class='dot token'>.</span><span class='full_messages identifier id'>full_messages</span>                  <span class='comment val'># =&gt; [&quot;state cannot transition via \&quot;ignite\&quot;&quot;]</span>
</pre>
<p>
If an event fails to fire because of a validation error on the record and
<b>not</b> because a matching transition was not available, no error
messages will be added to the state attribute.
</p>
<h2>Scopes</h2>
<p>
To assist in filtering models with specific states, a series of class
methods are defined on the model for finding records with or without a
particular set of states.
</p>
<p>
These named scopes are the functional equivalent of the following
definitions:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Vehicle constant id'>Vehicle</span> <span class='lt op'>&lt;</span> <span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span>
    <span class='class class kw'>class</span> <span class='lshft op'>&lt;&lt;</span> <span class='self self kw'>self</span>
      <span class='def def kw'>def</span> <span class='with_states identifier id'>with_states</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='states identifier id'>states</span><span class='rparen token'>)</span>
        <span class='filter identifier id'>filter</span><span class='lparen token'>(</span><span class='symbol val'>:state</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='states identifier id'>states</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:with_state</span><span class='comma token'>,</span> <span class='symbol val'>:with_states</span>

      <span class='def def kw'>def</span> <span class='without_states identifier id'>without_states</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='states identifier id'>states</span><span class='rparen token'>)</span>
        <span class='filter identifier id'>filter</span><span class='lparen token'>(</span><span class='bitnot op'>~</span><span class='lbrace token'>{</span><span class='symbol val'>:state</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='states identifier id'>states</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:without_state</span><span class='comma token'>,</span> <span class='symbol val'>:without_states</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
<b>Note</b>, however, that the states are converted to their stored values
before being passed into the query.
</p>
<p>
Because of the way scopes work in Sequel, they can be chained like so:
</p>
<pre class="code">
  <span class='Vehicle constant id'>Vehicle</span><span class='dot token'>.</span><span class='with_state identifier id'>with_state</span><span class='lparen token'>(</span><span class='symbol val'>:parked</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='order identifier id'>order</span><span class='lparen token'>(</span><span class='symbol val'>:id</span><span class='dot token'>.</span><span class='desc identifier id'>desc</span><span class='rparen token'>)</span>
</pre>
<h2>Callbacks</h2>
<p>
All before/after transition callbacks defined for Sequel resources behave
in the same way that other Sequel hooks behave. Rather than passing in the
record as an argument to the callback, the callback is instead bound to the
object and evaluated within its context.
</p>
<p>
For example,
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Vehicle constant id'>Vehicle</span> <span class='lt op'>&lt;</span> <span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span>
    <span class='state_machine identifier id'>state_machine</span> <span class='symbol val'>:initial</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:parked</span> <span class='do do kw'>do</span>
      <span class='before_transition identifier id'>before_transition</span> <span class='any identifier id'>any</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:idling</span> <span class='do do kw'>do</span>
        <span class='put_on_seatbelt identifier id'>put_on_seatbelt</span>
      <span class='end end kw'>end</span>

      <span class='before_transition identifier id'>before_transition</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='transition identifier id'>transition</span><span class='bitor op'>|</span>
        <span class='comment val'># log message</span>
      <span class='end end kw'>end</span>

      <span class='event identifier id'>event</span> <span class='symbol val'>:ignite</span> <span class='do do kw'>do</span>
        <span class='transition identifier id'>transition</span> <span class='symbol val'>:parked</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:idling</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='def def kw'>def</span> <span class='put_on_seatbelt identifier id'>put_on_seatbelt</span>
      <span class='dot3 op'>...</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Note, also, that the transition can be accessed by simply defining
additional arguments in the callback block.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Class Attributes</h2>
      <table>
      
        <tr>
          <th class="name">defaults</td>
          <td class="readwrite">
            [<span id='defaults-class_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>defaults</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#extended-class_method">extended</span><span class='args'>(base)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Loads additional files specific to Sequel.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#matches-3F-class_method">matches?</span><span class='args'>(klass)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Should this integration be used for state machines in the given class?
Classes that include Sequel::Model will automatically use the Sequel
integration.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#invalidate-instance_method">#invalidate</span><span class='args'>(object, attribute, message, values = [])</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Adds a validation error to the given object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reset-instance_method">#reset</span><span class='args'>(object)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Resets any errors previously added when invalidating the given object.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>extended</h3>
</div><div id="extended-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>extended</span><span class='args'>(base)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Loads additional files specific to Sequel
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/state_machine/integrations/sequel.rb', line 228</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/pluginaweek/state_machine/blob/58db34faaf49675fa4cf5c1b6107b4626f67db5c/lib/state_machine/integrations/sequel.rb#L228">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">228
229
230</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='extended identifier id'>extended</span><span class='lparen token'>(</span><span class='base identifier id'>base</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='require identifier id'>require</span> <span class='string val'>'sequel/extensions/inflector'</span> <span class='if if_mod kw'>if</span> <span class='colon3 op'>::</span><span class='Sequel constant id'>Sequel</span><span class='dot token'>.</span><span class='const_defined? fid id'>const_defined?</span><span class='lparen token'>(</span><span class='string val'>'VERSION'</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='colon3 op'>::</span><span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='VERSION constant id'>VERSION</span> <span class='geq op'>&gt;=</span> <span class='string val'>'2.12.0'</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>matches?</h3>
</div><div id="matches-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>matches?</span><span class='args'>(klass)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Should this integration be used for state machines in the given class?
Classes that include Sequel::Model will automatically use the Sequel
integration.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/state_machine/integrations/sequel.rb', line 223</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/pluginaweek/state_machine/blob/58db34faaf49675fa4cf5c1b6107b4626f67db5c/lib/state_machine/integrations/sequel.rb#L223">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">223
224
225</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='matches? fid id'>matches?</span><span class='lparen token'>(</span><span class='klass identifier id'>klass</span><span class='rparen token'>)</span>
  <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='colon3 op'>::</span><span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='klass identifier id'>klass</span> <span class='leq op'>&lt;=</span> <span class='colon3 op'>::</span><span class='Sequel constant id'>Sequel</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>invalidate</h3>
</div><div id="invalidate-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>invalidate</span><span class='args'>(object, attribute, message, values = [])</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Adds a validation error to the given object
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/state_machine/integrations/sequel.rb', line 233</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/pluginaweek/state_machine/blob/58db34faaf49675fa4cf5c1b6107b4626f67db5c/lib/state_machine/integrations/sequel.rb#L233">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">233
234
235</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='invalidate identifier id'>invalidate</span><span class='lparen token'>(</span><span class='object identifier id'>object</span><span class='comma token'>,</span> <span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='message identifier id'>message</span><span class='comma token'>,</span> <span class='values identifier id'>values</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='object identifier id'>object</span><span class='dot token'>.</span><span class='errors identifier id'>errors</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='attribute identifier id'>attribute</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='generate_message identifier id'>generate_message</span><span class='lparen token'>(</span><span class='message identifier id'>message</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reset</h3>
</div><div id="reset-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reset</span><span class='args'>(object)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Resets any errors previously added when invalidating the given object
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/state_machine/integrations/sequel.rb', line 238</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/pluginaweek/state_machine/blob/58db34faaf49675fa4cf5c1b6107b4626f67db5c/lib/state_machine/integrations/sequel.rb#L238">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">238
239
240</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reset identifier id'>reset</span><span class='lparen token'>(</span><span class='object identifier id'>object</span><span class='rparen token'>)</span>
  <span class='object identifier id'>object</span><span class='dot token'>.</span><span class='errors identifier id'>errors</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> Â©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>