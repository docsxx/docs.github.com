<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>stffn's declarative_authorization - Class: Authorization::Reader::AuthorizationRulesReader - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/stffn/commits/declarative_authorization/master" rel="alternate" title="Recent Commits to declarative_authorization:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("stffn", "declarative_authorization", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("stffn", "declarative_authorization", "1154a6ee6c29c9e705340bf835e2ab8bce6a9de6", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/stffn/declarative_authorization/tree/">Source</a></li>
            <li class=""><a href="http://github.com/stffn/declarative_authorization/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/stffn/declarative_authorization/network">Network</a></li>            
            <li class=""><a href="http://github.com/stffn/declarative_authorization/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/stffn/declarative_authorization">Wiki</a></li>
            <li class=""><a href="http://github.com/stffn/declarative_authorization/graphs">Graphs</a></li>                    
            <li class="active"><a href="/stffn/declarative_authorization">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/stffn">stffn</a> / <b><a href="http://github.com/stffn/declarative_authorization/tree">declarative_authorization</a></b>        
                <a id="namespaces_button" rel="stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Authorization_Reader_AuthorizationRulesReader">
  <h1>Class: Authorization::Reader::AuthorizationRulesReader</h1>
  <div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">auth_rules</td>
          <td class="readwrite">
            [<span id='auth_rules-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
:nodoc:.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">role_descriptions</td>
          <td class="readwrite">
            [<span id='role_descriptions-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
:nodoc:.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">role_hierarchy</td>
          <td class="readwrite">
            [<span id='role_hierarchy-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
:nodoc:.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">role_titles</td>
          <td class="readwrite">
            [<span id='role_titles-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
:nodoc:.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">roles</td>
          <td class="readwrite">
            [<span id='roles-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
:nodoc:.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 150</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L150">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">150
151
152
153
154
155
156
157
158
159</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span> 
  <span class='@current_role ivar id'>@current_role</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='@current_rule ivar id'>@current_rule</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='@roles ivar id'>@roles</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='comment val'># higher_role =&gt; [lower_roles]</span>
  <span class='@role_hierarchy ivar id'>@role_hierarchy</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@role_titles ivar id'>@role_titles</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@role_descriptions ivar id'>@role_descriptions</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@auth_rules ivar id'>@auth_rules</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#append_role-instance_method">#append_role</span><span class='args'>(role, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#contains-instance_method">#contains</span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
In an if_attribute statement, contains says that the value has to be part
of the collection specified by the if_attribute attribute.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#description-instance_method">#description</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sets a description for the current role.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#does_not_contain-instance_method">#does_not_contain</span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The negation of contains.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_permission_on-instance_method">#has_permission_on</span><span class='args'>(context, options = {}, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Allows the definition of privileges to be allowed for the current role,
either in a has_permission_on block or directly in one call.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#if_attribute-instance_method">#if_attribute</span><span class='args'>(attr_conditions_hash)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
In a has_permission_on block, if_attribute specifies conditions of dynamic
parameters that have to be met for the user to meet the privileges in this
block.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#if_permitted_to-instance_method">#if_permitted_to</span><span class='args'>(privilege, attr_or_hash = nil, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
if_permitted_to allows the has_permission_on block to depend on permissions
on associated objects.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#includes-instance_method">#includes</span><span class='args'>(*roles)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Roles may inherit all the rights from subroles.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#intersects_with-instance_method">#intersects_with</span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
In an if_attribute statement, intersects_with requires that at least one of
the values has to be part of the collection specified by the if_attribute
attribute.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#is-instance_method">#is</span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
In an if_attribute statement, is says that the value has to be met exactly
by the if_attribute attribute.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#is_in-instance_method">#is_in</span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
In an if_attribute statement, is_in says that the value has to contain the
attribute value.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#is_not-instance_method">#is_not</span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The negation of is.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#is_not_in-instance_method">#is_not_in</span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The negation of is_in.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#role-instance_method">#role</span><span class='args'>(role, options = {}, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Defines the authorization rules for the given <tt>role</tt> in the
following block.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#title-instance_method">#title</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sets a human-readable title for the current role.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to-instance_method">#to</span><span class='args'>(*privs)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Used in a has_permission_on block, to may be used to specify privileges to
be assigned to the current role under the conditions specified in the
current block.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>append_role</h3>
</div><div id="append_role-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>append_role</span><span class='args'>(role, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 161</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L161">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">161
162
163
164
165</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='append_role identifier id'>append_role</span> <span class='lparen token'>(</span><span class='role identifier id'>role</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='@roles ivar id'>@roles</span> <span class='lshft op'>&lt;&lt;</span> <span class='role identifier id'>role</span> <span class='unless unless_mod kw'>unless</span> <span class='@roles ivar id'>@roles</span><span class='dot token'>.</span><span class='include? fid id'>include?</span> <span class='role identifier id'>role</span>
  <span class='@role_titles ivar id'>@role_titles</span><span class='lbrack token'>[</span><span class='role identifier id'>role</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:title</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:title</span><span class='rbrack token'>]</span>
  <span class='@role_descriptions ivar id'>@role_descriptions</span><span class='lbrack token'>[</span><span class='role identifier id'>role</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:description</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:description</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>contains</h3>
</div><div id="contains-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>contains</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
In an if_attribute statement, contains says that the value has to be part
of the collection specified by the if_attribute attribute. For information
on the block argument, see if_attribute.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 386</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L386">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">386
387
388</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='contains identifier id'>contains</span> <span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span><span class='symbol val'>:contains</span><span class='comma token'>,</span> <span class='block identifier id'>block</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>description</h3>
</div><div id="description-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>description</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sets a description for the current role. E.g.
</p>
<pre class="code">
  <span class='role identifier id'>role</span> <span class='symbol val'>:admin</span>
    <span class='description identifier id'>description</span> <span class='string val'>&quot;To be assigned to administrative personnel&quot;</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='dot3 op'>...</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="DSLError.html" title="DSLError">DSLError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 251</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L251">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">251
252
253
254</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='description identifier id'>description</span> <span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='DSLError constant id'>DSLError</span><span class='comma token'>,</span> <span class='string val'>&quot;description only allowed in role blocks&quot;</span> <span class='if if_mod kw'>if</span> <span class='@current_role ivar id'>@current_role</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='role_descriptions identifier id'>role_descriptions</span><span class='lbrack token'>[</span><span class='@current_role ivar id'>@current_role</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='text identifier id'>text</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>does_not_contain</h3>
</div><div id="does_not_contain-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>does_not_contain</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The negation of contains. Currently, query rewriting is disabled for
does_not_contain.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 392</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L392">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">392
393
394</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='does_not_contain identifier id'>does_not_contain</span> <span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span><span class='symbol val'>:does_not_contain</span><span class='comma token'>,</span> <span class='block identifier id'>block</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_permission_on</h3>
</div><div id="has_permission_on-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_permission_on</span><span class='args'>(context, options = {}, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Allows the definition of privileges to be allowed for the current role,
either in a has_permission_on block or directly in one call.
</p>
<pre class="code">
  <span class='role identifier id'>role</span> <span class='symbol val'>:admin</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:read</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='lbrack token'>[</span><span class='symbol val'>:employees</span><span class='comma token'>,</span> <span class='symbol val'>:orders</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:read</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span> <span class='do do kw'>do</span>
      <span class='to identifier id'>to</span> <span class='symbol val'>:create</span>
      <span class='if_attribute identifier id'>if_attribute</span> <span class='dot3 op'>...</span>
    <span class='end end kw'>end</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:delete</span> <span class='do do kw'>do</span>
      <span class='if_attribute identifier id'>if_attribute</span> <span class='dot3 op'>...</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
The block form allows to describe restrictions on the permissions using
if_attribute. Multiple has_permission_on statements are OR&#8217;ed when
evaluating the permissions. Also, multiple if_attribute statements in one
block are OR&#8217;ed if no :<tt>join_by</tt> option is given (see below).
To AND conditions, either set :<tt>join_by</tt> to :and or place them in
one if_attribute statement.
</p>
<p>
Available options
</p>
<dl>
<dt>:<tt>to</tt></dt><dd>A symbol or an array of symbols representing the privileges that should be
granted in this statement.

</dd>
<dt>:<tt>join_by</tt></dt><dd>Join operator to logically connect the constraint statements inside of the
has_permission_on block. May be :<tt>and</tt> or :<tt>or</tt>. Defaults to
:<tt>or</tt>.

</dd>
</dl>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="DSLError.html" title="DSLError">DSLError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 225</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L225">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='has_permission_on identifier id'>has_permission_on</span> <span class='lparen token'>(</span><span class='context identifier id'>context</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='DSLError constant id'>DSLError</span><span class='comma token'>,</span> <span class='string val'>&quot;has_permission_on only allowed in role blocks&quot;</span> <span class='if if_mod kw'>if</span> <span class='@current_role ivar id'>@current_role</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:join_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:or</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  
  <span class='privs identifier id'>privs</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:to</span><span class='rbrack token'>]</span> 
  <span class='privs identifier id'>privs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='privs identifier id'>privs</span><span class='rbrack token'>]</span> <span class='unless unless_mod kw'>unless</span> <span class='privs identifier id'>privs</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='DSLError constant id'>DSLError</span><span class='comma token'>,</span> <span class='string val'>&quot;has_permission_on either needs a block or :to option&quot;</span> <span class='if if_mod kw'>if</span> <span class='notop op'>!</span><span class='block_given? fid id'>block_given?</span> <span class='and and kw'>and</span> <span class='privs identifier id'>privs</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>

  <span class='file identifier id'>file</span><span class='comma token'>,</span> <span class='line identifier id'>line</span> <span class='assign token'>=</span> <span class='file_and_line_number_from_call_stack identifier id'>file_and_line_number_from_call_stack</span>
  <span class='rule identifier id'>rule</span> <span class='assign token'>=</span> <span class='AuthorizationRule constant id'>AuthorizationRule</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='@current_role ivar id'>@current_role</span><span class='comma token'>,</span> <span class='privs identifier id'>privs</span><span class='comma token'>,</span> <span class='context identifier id'>context</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:join_by</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
             <span class='symbol val'>:source_file</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='file identifier id'>file</span><span class='comma token'>,</span> <span class='symbol val'>:source_line</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='line identifier id'>line</span><span class='rparen token'>)</span>
  <span class='@auth_rules ivar id'>@auth_rules</span> <span class='lshft op'>&lt;&lt;</span> <span class='rule identifier id'>rule</span>
  <span class='if if kw'>if</span> <span class='block_given? fid id'>block_given?</span>
    <span class='@current_rule ivar id'>@current_rule</span> <span class='assign token'>=</span> <span class='rule identifier id'>rule</span>
    <span class='yield yield kw'>yield</span>
    <span class='raise identifier id'>raise</span> <span class='DSLError constant id'>DSLError</span><span class='comma token'>,</span> <span class='string val'>&quot;has_permission_on block content specifies no privileges&quot;</span> <span class='if if_mod kw'>if</span> <span class='rule identifier id'>rule</span><span class='dot token'>.</span><span class='privileges identifier id'>privileges</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='comment val'># TODO ensure?</span>
    <span class='@current_rule ivar id'>@current_rule</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>if_attribute</h3>
</div><div id="if_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>if_attribute</span><span class='args'>(attr_conditions_hash)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
In a has_permission_on block, if_attribute specifies conditions of dynamic
parameters that have to be met for the user to meet the privileges in this
block. Conditions are evaluated on the context object. Thus, the following
allows CRUD for branch admins only on employees that belong to the same
branch as the current user.
</p>
<pre class="code">
  <span class='role identifier id'>role</span> <span class='symbol val'>:branch_admin</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span> <span class='do do kw'>do</span>
      <span class='to identifier id'>to</span> <span class='symbol val'>:create</span><span class='comma token'>,</span> <span class='symbol val'>:read</span><span class='comma token'>,</span> <span class='symbol val'>:update</span><span class='comma token'>,</span> <span class='symbol val'>:delete</span>
      <span class='if_attribute identifier id'>if_attribute</span> <span class='symbol val'>:branch</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='is identifier id'>is</span> <span class='lbrace token'>{</span> <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='branch identifier id'>branch</span> <span class='rbrace token'>}</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
In this case, is is the operator for evaluating the condition. Another
operator is contains for collections. In the block supplied to the
operator, <tt>user</tt> specifies the current user for whom the condition
is evaluated.
</p>
<p>
Conditions may be nested:
</p>
<pre class="code">
  <span class='role identifier id'>role</span> <span class='symbol val'>:company_admin</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span> <span class='do do kw'>do</span>
      <span class='to identifier id'>to</span> <span class='symbol val'>:create</span><span class='comma token'>,</span> <span class='symbol val'>:read</span><span class='comma token'>,</span> <span class='symbol val'>:update</span><span class='comma token'>,</span> <span class='symbol val'>:delete</span>
      <span class='if_attribute identifier id'>if_attribute</span> <span class='symbol val'>:branch</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:company</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='is identifier id'>is</span> <span class='lbrace token'>{</span><span class='user identifier id'>user</span><span class='dot token'>.</span><span class='branch identifier id'>branch</span><span class='dot token'>.</span><span class='company identifier id'>company</span><span class='rbrace token'>}</span> <span class='rbrace token'>}</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Multiple attributes in one :if_attribute statement are AND&#8217;ed.
Multiple if_attribute statements are OR&#8217;ed if the join operator for
the has_permission_on block isn&#8217;t explicitly set. Thus, the following
would require the current user either to be of the same branch AND the
employee to be &quot;changeable_by_coworker&quot;. OR the current user has
to be the employee in question.
</p>
<pre class="code">
  <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:manage</span> <span class='do do kw'>do</span>
    <span class='if_attribute identifier id'>if_attribute</span> <span class='symbol val'>:branch</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='is identifier id'>is</span> <span class='lbrace token'>{</span><span class='user identifier id'>user</span><span class='dot token'>.</span><span class='branch identifier id'>branch</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:changeable_by_coworker</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span>
    <span class='if_attribute identifier id'>if_attribute</span> <span class='symbol val'>:id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='is identifier id'>is</span> <span class='lbrace token'>{</span><span class='user identifier id'>user</span><span class='dot token'>.</span><span class='id identifier id'>id</span><span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Arrays and fixed values may be used directly as hash values:
</p>
<pre class="code">
  <span class='if_attribute identifier id'>if_attribute</span> <span class='symbol val'>:id</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span>
  <span class='if_attribute identifier id'>if_attribute</span> <span class='symbol val'>:type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;special&quot;</span>
  <span class='if_attribute identifier id'>if_attribute</span> <span class='symbol val'>:id</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='integer val'>1</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
</pre>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="DSLError.html" title="DSLError">DSLError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 319</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L319">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">319
320
321
322
323</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='if_attribute identifier id'>if_attribute</span> <span class='lparen token'>(</span><span class='attr_conditions_hash identifier id'>attr_conditions_hash</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='DSLError constant id'>DSLError</span><span class='comma token'>,</span> <span class='string val'>&quot;if_attribute only in has_permission blocks&quot;</span> <span class='if if_mod kw'>if</span> <span class='@current_rule ivar id'>@current_rule</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='parse_attribute_conditions_hash! fid id'>parse_attribute_conditions_hash!</span><span class='lparen token'>(</span><span class='attr_conditions_hash identifier id'>attr_conditions_hash</span><span class='rparen token'>)</span>
  <span class='@current_rule ivar id'>@current_rule</span><span class='dot token'>.</span><span class='append_attribute identifier id'>append_attribute</span> <span class='Attribute constant id'>Attribute</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='attr_conditions_hash identifier id'>attr_conditions_hash</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>if_permitted_to</h3>
</div><div id="if_permitted_to-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>if_permitted_to</span><span class='args'>(privilege, attr_or_hash = nil, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
if_permitted_to allows the has_permission_on block to depend on permissions
on associated objects. By using it, the authorization rules may be a lot
DRYer. E.g.:
</p>
<pre class="code">
  <span class='role identifier id'>role</span> <span class='symbol val'>:branch_manager</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:branches</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:manage</span> <span class='do do kw'>do</span>
      <span class='if_attribute identifier id'>if_attribute</span> <span class='symbol val'>:employees</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='includes identifier id'>includes</span> <span class='lbrace token'>{</span> <span class='user identifier id'>user</span> <span class='rbrace token'>}</span>
    <span class='end end kw'>end</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:read</span> <span class='do do kw'>do</span>
      <span class='if_permitted_to identifier id'>if_permitted_to</span> <span class='symbol val'>:read</span><span class='comma token'>,</span> <span class='symbol val'>:branch</span>
      <span class='comment val'># instead of</span>
      <span class='comment val'># if_attribute :branch =&gt; { :employees =&gt; includes { user } }</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
if_permitted_to associations may be nested as well:
</p>
<pre class="code">
  <span class='if_permitted_to identifier id'>if_permitted_to</span> <span class='symbol val'>:read</span><span class='comma token'>,</span> <span class='symbol val'>:branch</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:company</span>
</pre>
<p>
To check permissions based on the current object, the attribute has to be
left out:
</p>
<pre class="code">
  <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:branches</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:manage</span> <span class='do do kw'>do</span>
    <span class='if_attribute identifier id'>if_attribute</span> <span class='symbol val'>:employees</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='includes identifier id'>includes</span> <span class='lbrace token'>{</span> <span class='user identifier id'>user</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:branches</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:paint_green</span> <span class='do do kw'>do</span>
    <span class='if_permitted_to identifier id'>if_permitted_to</span> <span class='symbol val'>:update</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Normally, one would merge those rules into one. Deviding makes sense if
additional if_attribute are used in the second rule or those rules are
applied to different roles.
</p>
<p>
Options:
</p>
<dl>
<dt>:<tt>context</tt></dt><dd>If the context of the refered object may not be infered from the
associations name, the context may be given explicitly:

<pre class="code">
  <span class='if_permitted_to identifier id'>if_permitted_to</span> <span class='symbol val'>:read</span><span class='comma token'>,</span> <span class='symbol val'>:home_branch</span><span class='comma token'>,</span> <span class='symbol val'>:context</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:branches</span>
  <span class='if_permitted_to identifier id'>if_permitted_to</span> <span class='symbol val'>:read</span><span class='comma token'>,</span> <span class='symbol val'>:branch</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:main_company</span><span class='comma token'>,</span> <span class='symbol val'>:context</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:companies</span>
</pre>
</dd>
</dl>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="DSLError.html" title="DSLError">DSLError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 362</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L362">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">362
363
364
365
366
367
368
369</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='if_permitted_to identifier id'>if_permitted_to</span> <span class='lparen token'>(</span><span class='privilege identifier id'>privilege</span><span class='comma token'>,</span> <span class='attr_or_hash identifier id'>attr_or_hash</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='DSLError constant id'>DSLError</span><span class='comma token'>,</span> <span class='string val'>&quot;if_permitted_to only in has_permission blocks&quot;</span> <span class='if if_mod kw'>if</span> <span class='@current_rule ivar id'>@current_rule</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:context</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='attr_or_hash identifier id'>attr_or_hash</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:context</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='attr_or_hash identifier id'>attr_or_hash</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span>
  <span class='comment val'># only :context option in attr_or_hash:</span>
  <span class='attr_or_hash identifier id'>attr_or_hash</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span> <span class='if if_mod kw'>if</span> <span class='attr_or_hash identifier id'>attr_or_hash</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='attr_or_hash identifier id'>attr_or_hash</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
  <span class='@current_rule ivar id'>@current_rule</span><span class='dot token'>.</span><span class='append_attribute identifier id'>append_attribute</span> <span class='AttributeWithPermission constant id'>AttributeWithPermission</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='privilege identifier id'>privilege</span><span class='comma token'>,</span>
      <span class='attr_or_hash identifier id'>attr_or_hash</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:context</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>includes</h3>
</div><div id="includes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>includes</span><span class='args'>(*roles)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Roles may inherit all the rights from subroles. The given <tt>roles</tt>
become subroles of the current block&#8217;s role.
</p>
<pre class="code">
  <span class='role identifier id'>role</span> <span class='symbol val'>:admin</span> <span class='do do kw'>do</span>
    <span class='includes identifier id'>includes</span> <span class='symbol val'>:user</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='symbol val'>:update</span><span class='comma token'>,</span> <span class='symbol val'>:create</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='role identifier id'>role</span> <span class='symbol val'>:user</span> <span class='do do kw'>do</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span><span class='comma token'>,</span> <span class='symbol val'>:to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:read</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="DSLError.html" title="DSLError">DSLError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 191</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L191">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">191
192
193
194
195</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='includes identifier id'>includes</span> <span class='lparen token'>(</span><span class='mult op'>*</span><span class='roles identifier id'>roles</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='DSLError constant id'>DSLError</span><span class='comma token'>,</span> <span class='string val'>&quot;includes only in role blocks&quot;</span> <span class='if if_mod kw'>if</span> <span class='@current_role ivar id'>@current_role</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='@role_hierarchy ivar id'>@role_hierarchy</span><span class='lbrack token'>[</span><span class='@current_role ivar id'>@current_role</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@role_hierarchy ivar id'>@role_hierarchy</span><span class='lbrack token'>[</span><span class='@current_role ivar id'>@current_role</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='roles identifier id'>roles</span><span class='dot token'>.</span><span class='flatten identifier id'>flatten</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>intersects_with</h3>
</div><div id="intersects_with-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>intersects_with</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
In an if_attribute statement, intersects_with requires that at least one of
the values has to be part of the collection specified by the if_attribute
attribute. The value block needs to evaluate to an Enumerable. For
information on the block argument, see if_attribute.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 400</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L400">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">400
401
402</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='intersects_with identifier id'>intersects_with</span> <span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span><span class='symbol val'>:intersects_with</span><span class='comma token'>,</span> <span class='block identifier id'>block</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>is</h3>
</div><div id="is-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>is</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
In an if_attribute statement, is says that the value has to be met exactly
by the if_attribute attribute. For information on the block argument, see
if_attribute.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 374</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L374">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">374
375
376</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='is identifier id'>is</span> <span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span><span class='symbol val'>:is</span><span class='comma token'>,</span> <span class='block identifier id'>block</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>is_in</h3>
</div><div id="is_in-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>is_in</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
In an if_attribute statement, is_in says that the value has to contain the
attribute value. For information on the block argument, see if_attribute.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 407</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L407">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">407
408
409</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='is_in identifier id'>is_in</span> <span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span><span class='symbol val'>:is_in</span><span class='comma token'>,</span> <span class='block identifier id'>block</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>is_not</h3>
</div><div id="is_not-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>is_not</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The negation of is.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 379</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L379">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">379
380
381</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='is_not identifier id'>is_not</span> <span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span><span class='symbol val'>:is_not</span><span class='comma token'>,</span> <span class='block identifier id'>block</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>is_not_in</h3>
</div><div id="is_not_in-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>is_not_in</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The negation of is_in.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 412</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L412">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">412
413
414</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='is_not_in identifier id'>is_not_in</span> <span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span><span class='symbol val'>:is_not_in</span><span class='comma token'>,</span> <span class='block identifier id'>block</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>role</h3>
</div><div id="role-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>role</span><span class='args'>(role, options = {}, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Defines the authorization rules for the given <tt>role</tt> in the
following block.
</p>
<pre class="code">
  <span class='role identifier id'>role</span> <span class='symbol val'>:admin</span> <span class='do do kw'>do</span>
    <span class='has_permissions_on identifier id'>has_permissions_on</span> <span class='dot3 op'>...</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  
</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 173</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L173">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">173
174
175
176
177
178
179</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='role identifier id'>role</span> <span class='lparen token'>(</span><span class='role identifier id'>role</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='append_role identifier id'>append_role</span> <span class='role identifier id'>role</span><span class='comma token'>,</span> <span class='options identifier id'>options</span>
  <span class='@current_role ivar id'>@current_role</span> <span class='assign token'>=</span> <span class='role identifier id'>role</span>
  <span class='yield yield kw'>yield</span>
<span class='ensure ensure kw'>ensure</span>
  <span class='@current_role ivar id'>@current_role</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>title</h3>
</div><div id="title-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>title</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sets a human-readable title for the current role. E.g.
</p>
<pre class="code">
  <span class='role identifier id'>role</span> <span class='symbol val'>:admin</span>
    <span class='title identifier id'>title</span> <span class='string val'>&quot;Administrator&quot;</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='dot3 op'>...</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="DSLError.html" title="DSLError">DSLError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 261</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L261">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">261
262
263
264</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='title identifier id'>title</span> <span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='DSLError constant id'>DSLError</span><span class='comma token'>,</span> <span class='string val'>&quot;title only allowed in role blocks&quot;</span> <span class='if if_mod kw'>if</span> <span class='@current_role ivar id'>@current_role</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='role_titles identifier id'>role_titles</span><span class='lbrack token'>[</span><span class='@current_role ivar id'>@current_role</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='text identifier id'>text</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to</h3>
</div><div id="to-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to</span><span class='args'>(*privs)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Used in a has_permission_on block, to may be used to specify privileges to
be assigned to the current role under the conditions specified in the
current block.
</p>
<pre class="code">
  <span class='role identifier id'>role</span> <span class='symbol val'>:admin</span>
    <span class='has_permission_on identifier id'>has_permission_on</span> <span class='symbol val'>:employees</span> <span class='do do kw'>do</span>
      <span class='to identifier id'>to</span> <span class='symbol val'>:create</span><span class='comma token'>,</span> <span class='symbol val'>:read</span><span class='comma token'>,</span> <span class='symbol val'>:update</span><span class='comma token'>,</span> <span class='symbol val'>:delete</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="DSLError.html" title="DSLError">DSLError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/declarative_authorization/reader.rb', line 274</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/stffn/declarative_authorization/blob/1154a6ee6c29c9e705340bf835e2ab8bce6a9de6/lib/declarative_authorization/reader.rb#L274">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">274
275
276
277</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to identifier id'>to</span> <span class='lparen token'>(</span><span class='mult op'>*</span><span class='privs identifier id'>privs</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='DSLError constant id'>DSLError</span><span class='comma token'>,</span> <span class='string val'>&quot;to only allowed in has_permission_on blocks&quot;</span> <span class='if if_mod kw'>if</span> <span class='@current_rule ivar id'>@current_rule</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='@current_rule ivar id'>@current_rule</span><span class='dot token'>.</span><span class='append_privileges identifier id'>append_privileges</span><span class='lparen token'>(</span><span class='privs identifier id'>privs</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>