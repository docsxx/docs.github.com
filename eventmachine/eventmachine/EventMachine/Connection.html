<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>eventmachine's eventmachine - Class: EventMachine::Connection - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/eventmachine/commits/eventmachine/master" rel="alternate" title="Recent Commits to eventmachine:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<style type="text/css">
  #repo_menu { border-bottom: 5px solid #ccc; margin-bottom: 1.5em; }
  #repo_sub_menu { display: none; }
</style>
    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main">
      <div id="header" class="">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/eventmachine/eventmachine/tree/">Source</a></li>
            <li class=""><a href="http://github.com/eventmachine/eventmachine/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/eventmachine/eventmachine/network">Network</a></li>            
            <li class=""><a href="http://github.com/eventmachine/eventmachine/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/eventmachine/eventmachine">Wiki</a></li>
            <li class=""><a href="http://github.com/eventmachine/eventmachine/graphs">Graphs</a></li>                    
            <li class="active"><a href="http://docs.github.com/eventmachine/eventmachine">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/eventmachine">eventmachine</a> / <b><a href="http://github.com/eventmachine/eventmachine/tree">eventmachine</a></b>        
                <a id="namespaces_button" rel="eventmachine/eventmachine" href="#">
                  <img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/>
                </a>
                <a id="methods_button" rel="eventmachine/eventmachine" href="#">
                  <img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/>
                </a>

                <script type="text/javascript">          
                $('#namespaces_button').click(function(){
                  var url="/"+$(this).attr('rel')+"/namespaces/";
                  $.gitbox(url);
                  return false;
                });

                $('#methods_button').click(function(){
                  var url="/"+$(this).attr('rel')+"/methods/";
                  $.gitbox(url);
                  return false;
                });
                </script>
                
              </div>
            </div>

            <div class="meta">
              <table>
                <tbody>
                  <tr>
                    <td class="label">Description:</td>
                    <td><span id="repository_description" rel="http://github.com/eventmachine/eventmachine/edit/update" class="">No description available</span></td>
                  </tr>              
                </tbody>
              </table>
            </div>
          </div>
                                        
          <div id="content">
            <div class="wikistyle">
  <div class="section class EventMachine_Connection">
  <h1>Class: EventMachine::Connection</h1>
  <div class="section docstring">
  <p>
EventMachine::Connection is a class that is instantiated by
EventMachine&#8217;s processing loop whenever a new connection is created.
(New connections can be either initiated locally to a remote server or
accepted locally from a remote client.) When a Connection object is
instantiated, it <em>mixes in</em> the functionality contained in the
user-defined module specified in calls to EventMachine#connect or
EventMachine#start_server. User-defined handler modules may redefine any or
all of the standard methods defined here, as well as add arbitrary
additional code that will also be mixed in.
</p>
<p>
EventMachine manages one object inherited from EventMachine::Connection
(and containing the mixed-in user code) for every network connection that
is active at any given time. The event loop will automatically call methods
on EventMachine::Connection objects whenever specific events occur on the
corresponding connections, as described below.
</p>
<p>
This class is never instantiated by user code, and does not publish an
initialize method. The instance methods of EventMachine::Connection which
may be called by the event loop are: post_init, receive_data, and unbind.
All of the other instance methods defined here are called only by user
code.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">signature</td>
          <td class="readwrite">
            [<span id='signature-instance_method'>R</span><span id='signature%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>signature</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(*args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Stubbed initialize so legacy superclasses can safely call super
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 51</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L51">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">51
52</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#associate_callback_target-instance_method">#associate_callback_target</span><span class='args'>(sig)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#close_connection-instance_method">#close_connection</span><span class='args'>(after_writing = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
EventMachine::Connection#close_connection is called only by user code, and
never by the event loop.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#close_connection_after_writing-instance_method">#close_connection_after_writing</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
EventMachine::Connection#close_connection_after_writing is a variant of
close_connection.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#comm_inactivity_timeout-instance_method">#comm_inactivity_timeout</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Alias for #set_comm_inactivity_timeout.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#connection_completed-instance_method">#connection_completed</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
#connection_completed is called by the event loop when a remote TCP
connection attempt completes successfully.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#detach-instance_method">#detach</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
EventMachine::Connection#detach will remove the given connection from the
event loop.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#error-3F-instance_method">#error?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if the connection is in an error state, false otherwise.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_outbound_data_size-instance_method">#get_outbound_data_size</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_peer_cert-instance_method">#get_peer_cert</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
If SSL/TLS is active on the connection, #get_peer_cert returns the remote
X509 certificate as a String, in the popular PEM format.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_peername-instance_method">#get_peername</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
#get_peername is used with stream-connections to obtain the identity of the
remotely-connected peer.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_pid-instance_method">#get_pid</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the PID (kernel process identifier) of a subprocess associated with
this Connection object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_sockname-instance_method">#get_sockname</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
#get_sockname is used with stream-connections to obtain the identity of the
local side of the connection.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_status-instance_method">#get_status</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a subprocess exit status.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#post_init-instance_method">#post_init</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
EventMachine::Connection#post_init is called by the event loop immediately
after the network connection has been established, and before resumption of
the network loop.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#receive_data-instance_method">#receive_data</span><span class='args'>(data)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
EventMachine::Connection#receive_data is called by the event loop whenever
data has been received by the network connection.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reconnect-instance_method">#reconnect</span><span class='args'>(server, port)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Reconnect to a given host/port with the current EventMachine::Connection
instance &#8212; EXPERIMENTAL.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#send_data-instance_method">#send_data</span><span class='args'>(data)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
EventMachine::Connection#send_data is only called by user code, never by
the event loop.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#send_datagram-instance_method">#send_datagram</span><span class='args'>(data, recipient_address, recipient_port)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
send_datagram is for sending UDP messages.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#send_file_data-instance_method">#send_file_data</span><span class='args'>(filename)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Like EventMachine::Connection#send_data, this sends data to the remote end
of the network connection.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#set_comm_inactivity_timeout-instance_method">#set_comm_inactivity_timeout</span><span class='args'>(value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
comm_inactivity_timeout= allows you to set the inactivity-timeout property
for a network connection or datagram socket.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ssl_handshake_completed-instance_method">#ssl_handshake_completed</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
#ssl_handshake_completed is called by EventMachine when the SSL/TLS
handshake has been completed, as a result of calling #start_tls to initiate
SSL/TLS on the connection.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ssl_verify_peer-instance_method">#ssl_verify_peer</span><span class='args'>(cert)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
#ssl_verify_peer is called by EventMachine when :verify_peer =&gt; true has
been passed to #start_tls.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#start_tls-instance_method">#start_tls</span><span class='args'>(args = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Call #start_tls at any point to initiate TLS encryption on connected
streams.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#stream_file_data-instance_method">#stream_file_data</span><span class='args'>(filename, args = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Open a file on the filesystem and send it to the remote peer.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#unbind-instance_method">#unbind</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
EventMachine::Connection#unbind is called by the framework whenever a
connection (either a server or client connection) is closed.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>associate_callback_target</h3>
</div><div id="associate_callback_target-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>associate_callback_target</span><span class='args'>(sig)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 54</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L54">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">54
55
56</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='associate_callback_target identifier id'>associate_callback_target</span> <span class='sig identifier id'>sig</span>
  <span class='comment val'># No-op for the time being</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>close_connection</h3>
</div><div id="close_connection-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>close_connection</span><span class='args'>(after_writing = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
EventMachine::Connection#close_connection is called only by user code, and
never by the event loop. You may call this method against a connection
object in any callback handler, whether or not the callback was made
against the connection you want to close. close_connection
<em>schedules</em> the connection to be closed at the next available
opportunity within the event loop. You may not assume that the connection
is closed when close_connection returns. In particular, the framework will
callback the unbind method for the particular connection at a point shortly
after you call close_connection. You may assume that the unbind callback
will take place sometime after your call to close_connection completes. In
other words, the unbind callback will not re-enter your code
&quot;inside&quot; of your call to close_connection. However, it&#8217;s
not guaranteed that a future version of EventMachine will not change this
behavior.
</p>
<p>
close_connection will <em>silently discard</em> any outbound data which you
have sent to the connection using EventMachine::Connection#send_data but
which has not yet been sent across the network. If you want to avoid this
behavior, use EventMachine::Connection#close_connection_after_writing.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 147</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L147">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">147
148
149</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='close_connection identifier id'>close_connection</span> <span class='after_writing identifier id'>after_writing</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='close_connection identifier id'>close_connection</span> <span class='@signature ivar id'>@signature</span><span class='comma token'>,</span> <span class='after_writing identifier id'>after_writing</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>close_connection_after_writing</h3>
</div><div id="close_connection_after_writing-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>close_connection_after_writing</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
EventMachine::Connection#close_connection_after_writing is a variant of
close_connection. All of the descriptive comments given for
close_connection also apply to close_connection_after_writing, <em>with one
exception:</em> If the connection has outbound data sent using send_dat but
which has not yet been sent across the network,
close_connection_after_writing will schedule the connection to be closed
<em>after</em> all of the outbound data has been safely written to the
remote peer.
</p>
<p>
Depending on the amount of outgoing data and the speed of the network,
considerable time may elapse between your call to
close_connection_after_writing and the actual closing of the socket (at
which time the unbind callback will be called by the event loop). During
this time, you <em>may not</em> call send_data to transmit additional data
(that is, the connection is closed for further writes). In very rare cases,
you may experience a receive_data callback after your call to
close_connection_after_writing, depending on whether incoming data was in
the process of being received on the connection at the moment when you
called close_connection_after_writing. Your protocol handler must be
prepared to properly deal with such data (probably by ignoring it).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 174</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L174">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">174
175
176</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='close_connection_after_writing identifier id'>close_connection_after_writing</span>
  <span class='close_connection identifier id'>close_connection</span> <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>comm_inactivity_timeout</h3>
</div><div id="comm_inactivity_timeout-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>comm_inactivity_timeout</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Alias for #set_comm_inactivity_timeout.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 429</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L429">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">429
430
431</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='comm_inactivity_timeout= identifier id'>comm_inactivity_timeout=</span> <span class='value identifier id'>value</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='symbol val'>:set_comm_inactivity_timeout</span><span class='comma token'>,</span> <span class='value identifier id'>value</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>connection_completed</h3>
</div><div id="connection_completed-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>connection_completed</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
#connection_completed is called by the event loop when a remote TCP
connection attempt completes successfully. You can expect to get this
notification after calls to EventMachine#connect. Remember that
EventMachine makes remote connections asynchronously, just as with any
other kind of network event. #connection_completed is intended primarily to
assist with network diagnostics. For normal protocol handling, use
#post_init to perform initial work on a new connection (such as send an
initial set of data). #post_init will always be called.
#connection_completed will only be called in case of a successful
completion. A connection-attempt which fails will receive a call to #unbind
after the failure.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 221</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L221">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">221
222</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='connection_completed identifier id'>connection_completed</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>detach</h3>
</div><div id="detach-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>detach</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
EventMachine::Connection#detach will remove the given connection from the
event loop. The connection&#8217;s socket remains open and its file
descriptor number is returned
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 153</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L153">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">153
154
155</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='detach identifier id'>detach</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='detach_fd identifier id'>detach_fd</span> <span class='@signature ivar id'>@signature</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>error?</h3>
</div><div id="error-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>error?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if the connection is in an error state, false otherwise. In
general, you can detect the occurrence of communication errors or
unexpected disconnection by the remote peer by handing the #unbind method.
In some cases, however, it&#8217;s useful to check the status of the
connection using #error? before attempting to send data. This function is
synchronous: it will return immediately without blocking.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 207</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L207">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">207
208
209</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='error? fid id'>error?</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='report_connection_error_status identifier id'>report_connection_error_status</span><span class='lparen token'>(</span><span class='@signature ivar id'>@signature</span><span class='rparen token'>)</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_outbound_data_size</h3>
</div><div id="get_outbound_data_size-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_outbound_data_size</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/pr_eventmachine.rb', line 224</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/pr_eventmachine.rb#L224">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">224
225
226</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_outbound_data_size identifier id'>get_outbound_data_size</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='get_outbound_data_size identifier id'>get_outbound_data_size</span> <span class='@signature ivar id'>@signature</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_peer_cert</h3>
</div><div id="get_peer_cert-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_peer_cert</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
If SSL/TLS is active on the connection, #get_peer_cert returns the remote
X509 certificate as a String, in the popular PEM format. This can then be
used for arbitrary validation of a peer&#8217;s certificate in your code.
</p>
<p>
This should be called in/after the #ssl_handshake_completed callback, which
indicates that SSL/TLS is active. Using this callback is important, because
the certificate may not be available until the time it is executed. Using
#post_init or #connection_completed is not adequate, because the SSL
handshake may still be taking place.
</p>
<p>
#get_peer_cert will return <b>nil</b> if:
</p>
<ul>
<li>EventMachine is not built with OpenSSL support

</li>
<li>SSL/TLS is not active on the connection

</li>
<li>SSL/TLS handshake is not yet complete

</li>
<li>Remote peer for any other reason has not presented a certificate

</li>
</ul>
<h3>Example:</h3>
<pre class="code">
 <span class='module module kw'>module</span> <span class='Handler constant id'>Handler</span>

  <span class='def def kw'>def</span> <span class='post_init identifier id'>post_init</span>
    <span class='puts identifier id'>puts</span> <span class='string val'>&quot;Starting TLS&quot;</span>
    <span class='start_tls identifier id'>start_tls</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='ssl_handshake_completed identifier id'>ssl_handshake_completed</span>
    <span class='puts identifier id'>puts</span> <span class='get_peer_cert identifier id'>get_peer_cert</span>
    <span class='close_connection identifier id'>close_connection</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='unbind identifier id'>unbind</span>
    <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='stop_event_loop identifier id'>stop_event_loop</span>
  <span class='end end kw'>end</span>

 <span class='end end kw'>end</span>

 <span class='EM constant id'>EM</span><span class='dot token'>.</span><span class='run identifier id'>run</span> <span class='lbrace token'>{</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='connect identifier id'>connect</span> <span class='string val'>&quot;mail.google.com&quot;</span><span class='comma token'>,</span> <span class='integer val'>443</span><span class='comma token'>,</span> <span class='Handler constant id'>Handler</span>
 <span class='rbrace token'>}</span>
</pre>
<p>
Output:
</p>
<pre class="code">
 <span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='BEGIN lbegin kw'>BEGIN</span> <span class='CERTIFICATE constant id'>CERTIFICATE</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span>
 <span class='MIIDIjCCAougAwIBAgIQbldpChBPqv constant id'>MIIDIjCCAougAwIBAgIQbldpChBPqv</span><span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='BdPg4iwgN8TANBgkqhkiG9w0BAQUFADBM constant id'>BdPg4iwgN8TANBgkqhkiG9w0BAQUFADBM</span>
 <span class='MQswCQYDVQQGEwJaQTElMCMGA1UEChMcVGhhd3RlIENvbnN1bHRpbmcgKFB0eSkg constant id'>MQswCQYDVQQGEwJaQTElMCMGA1UEChMcVGhhd3RlIENvbnN1bHRpbmcgKFB0eSkg</span>
 <span class='THRkLjEWMBQGA1UEAxMNVGhhd3RlIFNHQyBDQTAeFw0wODA1MDIxNjMyNTRaFw0w constant id'>THRkLjEWMBQGA1UEAxMNVGhhd3RlIFNHQyBDQTAeFw0wODA1MDIxNjMyNTRaFw0w</span>
 <span class='OTA1MDIxNjMyNTRaMGkxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlh constant id'>OTA1MDIxNjMyNTRaMGkxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlh</span>
 <span class='MRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRMwEQYDVQQKEwpHb29nbGUgSW5jMRgw constant id'>MRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRMwEQYDVQQKEwpHb29nbGUgSW5jMRgw</span>
 <span class='FgYDVQQDEw9tYWlsLmdvb2dsZS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJ constant id'>FgYDVQQDEw9tYWlsLmdvb2dsZS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJ</span>
 <span class='AoGBALlkxdh2QXegdElukCSOV2 constant id'>AoGBALlkxdh2QXegdElukCSOV2</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;8PKiONIS&lt;tt&gt;8Tu9K7MQsYpqtLNC860zwOPQ2NLI
 3Zp4jwuXVTrtzGuiqf5Jioh35Ig3CqDXtLyZoypjZUQcq4mlLzHlhIQ4EhSjDmA7
 Ffw9y3ckSOQgdBQWNLbquHh9AbEUjmhkrYxIqKXeCnRKhv6nAgMBAAGjgecwgeQw
 KAYDVR0lBCEwHwYIKwYBBQUHAwEGCCsGAQUFBwMCBglghkgBhvhCBAEwNgYDVR0f
 BC8wLTAroCmgJ4YlaHR0cDovL2NybC50aGF3dGUuY29tL1RoYXd0ZVNHQ0NBLmNy
 bDByBggrBgEFBQcBAQRmMGQwIgYIKwYBBQUHMAGGFmh0dHA6Ly9vY3NwLnRoYXd0
 ZS5jb20wPgYIKwYBBQUHMAKGMmh0dHA6Ly93d3cudGhhd3RlLmNvbS9yZXBvc2l0
 b3J5L1RoYXd0ZV9TR0NfQ0EuY3J0MAwGA1UdEwEB/</span><span class='wQCMAAwDQYJKoZIhvcNAQEF identifier id'>wQCMAAwDQYJKoZIhvcNAQEF</span>
 <span class='BQADgYEAsRwpLg1dgCR1gYDK185MFGukXMeQFUvhGqF8eT constant id'>BQADgYEAsRwpLg1dgCR1gYDK185MFGukXMeQFUvhGqF8eT</span><span class='div op'>/</span><span class='CjpdvezyKVuz84gSu constant id'>CjpdvezyKVuz84gSu</span>
 <span class='integer val'>6</span><span class='ccMXgcPQZGQN identifier id'>ccMXgcPQZGQN</span><span class='div op'>/</span><span class='F4Xug constant id'>F4Xug</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;Q01eccJjRSVfdvR5qwpqCj+6BFl5oiKDBsveSkrmL5dz
 s2bn7TdTSYKcLeBkjXxDLHGBqLJ6TNCJ3c4/</span><span class='cbbG5JhGvoema94 identifier id'>cbbG5JhGvoema94</span><span class='assign token'>=</span>
 <span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='END lend kw'>END</span> <span class='CERTIFICATE constant id'>CERTIFICATE</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span>
</pre>
<p>
You can do whatever you want with the certificate String, such as load it
as a certificate object using the OpenSSL library, and check it&#8217;s
fields.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 350</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L350">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">350
351
352</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_peer_cert identifier id'>get_peer_cert</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='get_peer_cert identifier id'>get_peer_cert</span> <span class='@signature ivar id'>@signature</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_peername</h3>
</div><div id="get_peername-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_peername</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
#get_peername is used with stream-connections to obtain the identity of the
remotely-connected peer. If a peername is available, this method returns a
sockaddr structure. The method returns nil if no peername is available. You
can use Socket.unpack_sockaddr_in and its variants to obtain the values
contained in the peername structure returned from #get_peername.
</p>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'socket'</span>
 <span class='module module kw'>module</span> <span class='Handler constant id'>Handler</span>
   <span class='def def kw'>def</span> <span class='receive_data identifier id'>receive_data</span> <span class='data identifier id'>data</span>
     <span class='port identifier id'>port</span><span class='comma token'>,</span> <span class='ip identifier id'>ip</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='dot token'>.</span><span class='unpack_sockaddr_in identifier id'>unpack_sockaddr_in</span><span class='lparen token'>(</span><span class='get_peername identifier id'>get_peername</span><span class='rparen token'>)</span>
     <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;got #{data.inspect} from #{ip}:#{port}&quot;</span>
   <span class='end end kw'>end</span>
 <span class='end end kw'>end</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 395</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L395">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">395
396
397</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_peername identifier id'>get_peername</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='get_peername identifier id'>get_peername</span> <span class='@signature ivar id'>@signature</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_pid</h3>
</div><div id="get_pid-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_pid</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the PID (kernel process identifier) of a subprocess associated with
this Connection object. For use with EventMachine#popen and similar
methods. Returns nil when there is no meaningful subprocess. &#8212;
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 413</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L413">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">413
414
415</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_pid identifier id'>get_pid</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='get_subprocess_pid identifier id'>get_subprocess_pid</span> <span class='@signature ivar id'>@signature</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_sockname</h3>
</div><div id="get_sockname-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_sockname</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
#get_sockname is used with stream-connections to obtain the identity of the
local side of the connection. If a local name is available, this method
returns a sockaddr structure. The method returns nil if no local name is
available. You can use Socket#unpack_sockaddr_in and its variants to obtain
the values contained in the local-name structure returned from
#get_sockname.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 404</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L404">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">404
405
406</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_sockname identifier id'>get_sockname</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='get_sockname identifier id'>get_sockname</span> <span class='@signature ivar id'>@signature</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_status</h3>
</div><div id="get_status-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_status</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a subprocess exit status. Only useful for #popen. Call it in your
#unbind handler.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 420</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L420">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">420
421
422</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_status identifier id'>get_status</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='get_subprocess_status identifier id'>get_subprocess_status</span> <span class='@signature ivar id'>@signature</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>post_init</h3>
</div><div id="post_init-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>post_init</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
EventMachine::Connection#post_init is called by the event loop immediately
after the network connection has been established, and before resumption of
the network loop. This method is generally not called by user code, but is
called automatically by the event loop. The base-class implementation is a
no-op. This is a very good place to initialize instance variables that will
be used throughout the lifetime of the network connection.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 66</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L66">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">66
67</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='post_init identifier id'>post_init</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>receive_data</h3>
</div><div id="receive_data-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>receive_data</span><span class='args'>(data)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
EventMachine::Connection#receive_data is called by the event loop whenever
data has been received by the network connection. It is never called by
user code. receive_data is called with a single parameter, a String
containing the network protocol data, which may of course be binary. You
will generally redefine this method to perform your own processing of the
incoming data.
</p>
<p>
Here&#8217;s a key point which is essential to understanding the
event-driven programming model: <em>EventMachine knows absolutely nothing
about the protocol which your code implements.</em> You must not make any
assumptions about the size of the incoming data packets, or about their
alignment on any particular intra-message or PDU boundaries (such as line
breaks). receive_data can and will send you arbitrary chunks of data, with
the only guarantee being that the data is presented to your code in the
order it was collected from the network. Don&#8217;t even assume that the
chunks of data will correspond to network packets, as EventMachine can and
will coalesce several incoming packets into one, to improve performance.
The implication for your code is that you generally will need to implement
some kind of a state machine in your redefined implementation of
receive_data. For a better understanding of this, read through the examples
of specific protocol handlers in EventMachine::Protocols
</p>
<p>
The base-class implementation of receive_data (which will be invoked if you
don&#8217;t redefine it) simply prints the size of each incoming data
packet to stdout.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 94</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L94">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">94
95
96</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='receive_data identifier id'>receive_data</span> <span class='data identifier id'>data</span>
  <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;............&gt;&gt;&gt;#{data.length}&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reconnect</h3>
</div><div id="reconnect-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reconnect</span><span class='args'>(server, port)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Reconnect to a given host/port with the current EventMachine::Connection
instance &#8212; EXPERIMENTAL. DO NOT RELY ON THIS METHOD TO REMAIN
SUPPORTED. (03Nov06)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 452</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L452">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">452
453
454</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reconnect identifier id'>reconnect</span> <span class='server identifier id'>server</span><span class='comma token'>,</span> <span class='port identifier id'>port</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='reconnect identifier id'>reconnect</span> <span class='server identifier id'>server</span><span class='comma token'>,</span> <span class='port identifier id'>port</span><span class='comma token'>,</span> <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>send_data</h3>
</div><div id="send_data-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>send_data</span><span class='args'>(data)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
EventMachine::Connection#send_data is only called by user code, never by
the event loop. You call this method to send data to the remote end of the
network connection. send_data is called with a single String argument,
which may of course contain binary data. You can call send_data any number
of times. send_data is an instance method of an object derived from
EventMachine::Connection and containing your mixed-in handler code), so if
you call it without qualification within a callback function, the data will
be sent to the same network connection that generated the callback. Calling
self.send_data is exactly equivalent.
</p>
<p>
You can also call send_data to write to a connection <em>other than the one
whose callback you are calling send_data from.</em> This is done by
recording the value of the connection in any callback function (the value
self), in any variable visible to other callback invocations on the same or
different connection objects. (Need an example to make that clear.)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 193</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L193">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">193
194
195
196
197
198</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='send_data identifier id'>send_data</span> <span class='data identifier id'>data</span>
  <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='size identifier id'>size</span> <span class='assign token'>=</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='bytesize identifier id'>bytesize</span> <span class='if if_mod kw'>if</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:bytesize</span><span class='rparen token'>)</span>
  <span class='size identifier id'>size</span> <span class='opasgn op'>||=</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='send_data identifier id'>send_data</span> <span class='@signature ivar id'>@signature</span><span class='comma token'>,</span> <span class='data identifier id'>data</span><span class='comma token'>,</span> <span class='size identifier id'>size</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>send_datagram</h3>
</div><div id="send_datagram-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>send_datagram</span><span class='args'>(data, recipient_address, recipient_port)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
send_datagram is for sending UDP messages. This method may be called from
any Connection object that refers to an open datagram socket (see
EventMachine#open_datagram_socket). The method sends a UDP (datagram)
packet containing the data you specify, to a remote peer specified by the
IP address and port that you give as parameters to the method. Observe that
you may send a zero-length packet (empty string). However, you may not send
an arbitrarily-large data packet because your operating system will enforce
a platform-specific limit on the size of the outbound packet. (Your kernel
will respond in a platform-specific way if you send an overlarge packet:
some will send a truncated packet, some will complain, and some will
silently drop your request). On LANs, it&#8217;s usually OK to send
datagrams up to about 4000 bytes in length, but to be really safe, send
messages smaller than the Ethernet-packet size (typically about 1400
bytes). Some very restrictive WANs will either drop or truncate packets
larger than about 500 bytes. &#8212; Added the Integer wrapper around the
port parameter per suggestion by Matthieu Riou, after he passed a String
and spent hours tearing his hair out.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 376</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L376">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">376
377
378
379</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='send_datagram identifier id'>send_datagram</span> <span class='data identifier id'>data</span><span class='comma token'>,</span> <span class='recipient_address identifier id'>recipient_address</span><span class='comma token'>,</span> <span class='recipient_port identifier id'>recipient_port</span>
  <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='send_datagram identifier id'>send_datagram</span> <span class='@signature ivar id'>@signature</span><span class='comma token'>,</span> <span class='data identifier id'>data</span><span class='comma token'>,</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='comma token'>,</span> <span class='recipient_address identifier id'>recipient_address</span><span class='comma token'>,</span> <span class='Integer constant id'>Integer</span><span class='lparen token'>(</span><span class='recipient_port identifier id'>recipient_port</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>send_file_data</h3>
</div><div id="send_file_data-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>send_file_data</span><span class='args'>(filename)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Like EventMachine::Connection#send_data, this sends data to the remote end
of the network connection. EventMachine::Connection@send_file_data takes a
filename as an argument, though, and sends the contents of the file, in one
chunk. Contributed by Kirk Haines.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 462</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L462">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">462
463
464</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='send_file_data identifier id'>send_file_data</span> <span class='filename identifier id'>filename</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='send_file_data identifier id'>send_file_data</span> <span class='@signature ivar id'>@signature</span><span class='comma token'>,</span> <span class='filename identifier id'>filename</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>set_comm_inactivity_timeout</h3>
</div><div id="set_comm_inactivity_timeout-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>set_comm_inactivity_timeout</span><span class='args'>(value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
comm_inactivity_timeout= allows you to set the inactivity-timeout property
for a network connection or datagram socket. Specify a non-negative numeric
value in seconds. If the value is greater than zero, the connection or
socket will automatically be closed if no read or write activity takes
place for at least that number of seconds. Specify a value of zero to
indicate that no automatic timeout should take place. Zero is the default
value.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 444</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L444">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">444
445
446</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='set_comm_inactivity_timeout identifier id'>set_comm_inactivity_timeout</span> <span class='value identifier id'>value</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='set_comm_inactivity_timeout identifier id'>set_comm_inactivity_timeout</span> <span class='@signature ivar id'>@signature</span><span class='comma token'>,</span> <span class='value identifier id'>value</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ssl_handshake_completed</h3>
</div><div id="ssl_handshake_completed-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ssl_handshake_completed</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
#ssl_handshake_completed is called by EventMachine when the SSL/TLS
handshake has been completed, as a result of calling #start_tls to initiate
SSL/TLS on the connection.
</p>
<p>
This callback exists because #post_init and #connection_completed are
<b>not</b> reliable for indicating when an SSL/TLS connection is ready to
have it&#8217;s certificate queried for.
</p>
<p>
See #get_peer_cert for application and example.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 105</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L105">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">105
106</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='ssl_handshake_completed identifier id'>ssl_handshake_completed</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ssl_verify_peer</h3>
</div><div id="ssl_verify_peer-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ssl_verify_peer</span><span class='args'>(cert)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
#ssl_verify_peer is called by EventMachine when :verify_peer =&gt; true has
been passed to #start_tls. It will be called with each certificate in the
certificate chain provided by the remote peer. The cert will be passed as a
String in PEM format, the same as in #get_peer_cert. It is up to user
defined code to perform a check on the certificates. The return value from
this callback is used to accept or deny the peer. A return value that is
not nil or false triggers acceptance. If the peer is not accepted, the
connection will be subsequently closed. See
&#8216;tests/test_ssl_verify.rb&#8217; for a simple example.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 114</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L114">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">114
115</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='ssl_verify_peer identifier id'>ssl_verify_peer</span><span class='lparen token'>(</span><span class='cert identifier id'>cert</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>start_tls</h3>
</div><div id="start_tls-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>start_tls</span><span class='args'>(args = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Call #start_tls at any point to initiate TLS encryption on connected
streams. The method is smart enough to know whether it should perform a
server-side or a client-side handshake. An appropriate place to call
#start_tls is in your redefined #post_init method, or in the
#connection_completed handler for an outbound connection.
</p>
<p>
#start_tls takes an optional parameter hash that allows you to specify
certificate and other options to be used with this Connection object. Here
are the currently-supported options:
</p>
<ul>
<li>:cert_chain_file :

</li>
</ul>
<p>
takes a String, which is interpreted as the name of a readable file in the
local filesystem. The file is expected to contain a chain of X509
certificates in PEM format, with the most-resolved certificate at the top
of the file, successive intermediate certs in the middle, and the root (or
CA) cert at the bottom.
</p>
<ul>
<li>:private_key_file :

</li>
</ul>
<p>
takes a String, which is interpreted as the name of a readable file in the
local filesystem. The file must contain a private key in PEM format.
</p>
<ul>
<li>:verify_peer :

</li>
</ul>
<p>
takes either true or false. Default is false. This indicates whether a
server should request a certificate from a peer, to be verified by user
code. If true, the #ssl_verify_peer callback on the Connection object is
called with each certificate in the certificate chain provided by the peer.
See documentation on #ssl_verify_peer for how to use this.
</p>
<h3>Usage example:</h3>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'rubygems'</span>
 <span class='require identifier id'>require</span> <span class='string val'>'eventmachine'</span>

 <span class='module module kw'>module</span> <span class='Handler constant id'>Handler</span>
   <span class='def def kw'>def</span> <span class='post_init identifier id'>post_init</span>
     <span class='start_tls identifier id'>start_tls</span><span class='lparen token'>(</span><span class='symbol val'>:private_key_file</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'/tmp/server.key'</span><span class='comma token'>,</span> <span class='symbol val'>:cert_chain_file</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'/tmp/server.crt'</span><span class='comma token'>,</span> <span class='symbol val'>:verify_peer</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
   <span class='end end kw'>end</span>
 <span class='end end kw'>end</span>

 <span class='EM constant id'>EM</span><span class='dot token'>.</span><span class='run identifier id'>run</span> <span class='lbrace token'>{</span>
   <span class='EM constant id'>EM</span><span class='dot token'>.</span><span class='start_server identifier id'>start_server</span><span class='lparen token'>(</span><span class='string val'>&quot;127.0.0.1&quot;</span><span class='comma token'>,</span> <span class='integer val'>9999</span><span class='comma token'>,</span> <span class='Handler constant id'>Handler</span><span class='rparen token'>)</span>
 <span class='rbrace token'>}</span>
</pre>
<p>
&#8212; TODO: support passing an encryption parameter, which can be string
or Proc, to get a passphrase for encrypted private keys. TODO: support
passing key material via raw strings or Procs that return strings instead
of just filenames. What will get nasty is whether we have to define a
location for storing this stuff as files. In general, the OpenSSL
interfaces for dealing with certs and keys in files are much better behaved
than the ones for raw chunks of memory.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 274</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L274">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">274
275
276
277
278
279
280
281
282
283
284
285</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='start_tls identifier id'>start_tls</span> <span class='args identifier id'>args</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='priv_key identifier id'>priv_key</span><span class='comma token'>,</span> <span class='cert_chain identifier id'>cert_chain</span><span class='comma token'>,</span> <span class='verify_peer identifier id'>verify_peer</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:private_key_file</span><span class='comma token'>,</span> <span class='symbol val'>:cert_chain_file</span><span class='comma token'>,</span> <span class='symbol val'>:verify_peer</span><span class='rparen token'>)</span>

  <span class='lbrack token'>[</span><span class='priv_key identifier id'>priv_key</span><span class='comma token'>,</span> <span class='cert_chain identifier id'>cert_chain</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='file identifier id'>file</span><span class='bitor op'>|</span>
    <span class='next next kw'>next</span> <span class='if if_mod kw'>if</span> <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span> <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='raise identifier id'>raise</span> <span class='FileNotFoundException constant id'>FileNotFoundException</span><span class='comma token'>,</span>
      <span class='dstring node'>&quot;Could not find #{file} for start_tls&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='exists? fid id'>exists?</span> <span class='file identifier id'>file</span>
  <span class='end end kw'>end</span>

  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='set_tls_parms identifier id'>set_tls_parms</span><span class='lparen token'>(</span><span class='@signature ivar id'>@signature</span><span class='comma token'>,</span> <span class='priv_key identifier id'>priv_key</span> <span class='orop op'>||</span> <span class='string val'>''</span><span class='comma token'>,</span> <span class='cert_chain identifier id'>cert_chain</span> <span class='orop op'>||</span> <span class='string val'>''</span><span class='comma token'>,</span> <span class='verify_peer identifier id'>verify_peer</span><span class='rparen token'>)</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='start_tls identifier id'>start_tls</span> <span class='@signature ivar id'>@signature</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>stream_file_data</h3>
</div><div id="stream_file_data-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>stream_file_data</span><span class='args'>(filename, args = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Open a file on the filesystem and send it to the remote peer. This returns
an object of type EventMachine::Deferrable. The object&#8217;s callbacks
will be executed on the reactor main thread when the file has been
completely scheduled for transmission to the remote peer. Its errbacks will
be called in case of an error (such as file-not-found). #stream_file_data
employs various strategems to achieve the fastest possible performance,
balanced against minimum consumption of memory.
</p>
<p>
You can control the behavior of #stream_file_data with the optional
arguments parameter. Currently-supported arguments are: :http_chunks, a
boolean flag which defaults false. If true, this flag streams the file data
in a format compatible with the HTTP chunked-transfer encoding.
</p>
<p>
Warning: this feature has an implicit dependency on an outboard extension,
evma_fastfilereader. You must install this extension in order to use
#stream_file_data with files larger than a certain size (currently 8192
bytes).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 482</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L482">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">482
483
484</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='stream_file_data identifier id'>stream_file_data</span> <span class='filename identifier id'>filename</span><span class='comma token'>,</span> <span class='args identifier id'>args</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='FileStreamer constant id'>FileStreamer</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='self self kw'>self</span><span class='comma token'>,</span> <span class='filename identifier id'>filename</span><span class='comma token'>,</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>unbind</h3>
</div><div id="unbind-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>unbind</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
EventMachine::Connection#unbind is called by the framework whenever a
connection (either a server or client connection) is closed. The close can
occur because your code intentionally closes it (see close_connection and
close_connection_after_writing), because the remote peer closed the
connection, or because of a network error. You may not assume that the
network connection is still open and able to send or receive data when the
callback to unbind is made. This is intended only to give you a chance to
clean up associations your code may have made to the connection object
while it was open.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/em/connection.rb', line 126</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/eventmachine/eventmachine/blob/master/lib/em/connection.rb#L126">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">126
127</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='unbind identifier id'>unbind</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>  
                  
      <div id="footer">
        <div class="site">
          <div class="info">
            <div class="links">
              <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
              <a href="http://github.com/blog">Blog</a> |
              <a href="http://support.github.com/">Support</a> |
              <a href="http://github.com/training">Training</a> |
              <a href="http://github.com/contact">Contact</a> |
              <a href="http://groups.google.com/group/github/">Google Group</a> |
              <a href="http://develop.github.com/">API</a> |
              <a href="http://twitter.com/github">Status</a>
            </div>
            <div class="company">
              <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
              is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
            </div>
          </div>
          <div class="sponsor">
            <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
            <div>
              Hosting provided by our<br> partners at Engine Yard
            </div>
          </div>
        </div>
      </div>
      
      <div id="coming_soon" style="display: none;">
        This feature is coming soon.  Sit tight!
      </div>

      <div id="facebox" style="display: none;">       
        <div class="popup">         
          <table>           
            <tbody>             
              <tr>               
                <td class="tl"></td>
                <td class="b"></td>
                <td class="tr"></td>             
              </tr>             
            <tr>               
              <td class="b"></td>               
              <td class="body">                 
                <div class="content"></div>                 
                <div class="footer">                   
                  <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
                </div>               
              </td>               
              <td class="b"></td>             
            </tr>             
            <tr>               
              <td class="bl"></td>
              <td class="b"></td>
              <td class="br"></td>             
            </tr>           
          </tbody>         
        </table>       
      </div>     
    </div>
    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8555229-2");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>