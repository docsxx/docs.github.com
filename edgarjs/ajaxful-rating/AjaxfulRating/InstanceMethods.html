<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Module: AjaxfulRating::InstanceMethods</title>
  </head>
  <body>
    <div id="content">
      <div class="section module AjaxfulRating_InstanceMethods">
  <h1 class="title">Module: AjaxfulRating::InstanceMethods</h1>
  <div class="section docstring">
  <p>
Instance methods for the rateable object.
</p>

</div><div class="section constants">
  
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#caching_column_name-instance_method' title='#caching_column_name'>#caching_column_name</a></span><span class='args'>(dimension = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the name of the cache column for the passed dimension.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rate-instance_method' title='#rate'>#rate</a></span><span class='args'>(stars, user, dimension = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Submits a new rate.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rate_average-instance_method' title='#rate_average'>#rate_average</a></span><span class='args'>(cached = true, dimension = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Rating average for the object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rate_by-instance_method' title='#rate_by'>#rate_by</a></span><span class='args'>(user, dimension = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Finds the rate made by the user if he/she has already voted.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rated_by%3F-instance_method' title='#rated_by?'>#rated_by?</a></span><span class='args'>(user, dimension = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return true if the user has rated the object, otherwise false.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#raters-instance_method' title='#raters'>#raters</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array with all users that have rated this object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rates-instance_method' title='#rates'>#rates</a></span><span class='args'>(dimension = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Overrides the default <tt>rates</tt> method and returns the propper array
for the dimension passed.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#rates_sum-instance_method' title='#rates_sum'>#rates_sum</a></span><span class='args'>(dimension = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Total sum of the rates.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#total_rates-instance_method' title='#total_rates'>#total_rates</a></span><span class='args'>(dimension = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Instance&#8217;s total rates.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#update_cached_average-instance_method' title='#update_cached_average'>#update_cached_average</a></span><span class='args'>(dimension = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Updates the cached average column in the rateable model.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>caching_column_name</h3>
</div><div id="caching_column_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>caching_column_name</span><span class='args'>(dimension = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the name of the cache column for the passed dimension.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


143
144
145</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 143</span>

<span class='def def kw'>def</span> <span class='caching_column_name identifier id'>caching_column_name</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='caching_column_name identifier id'>caching_column_name</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rate</h3>
</div><div id="rate-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rate</span><span class='args'>(stars, user, dimension = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Submits a new rate. Accepts a hash of tipical Ajax request.
</p>
<p>
Example:
</p>
<pre class="code">
  <span class='comment val'># Articles Controller</span>
  <span class='def def kw'>def</span> <span class='rate identifier id'>rate</span>
    <span class='@article ivar id'>@article</span> <span class='assign token'>=</span> <span class='Article constant id'>Article</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:id</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='@article ivar id'>@article</span><span class='dot token'>.</span><span class='rate identifier id'>rate</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:stars</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='current_user identifier id'>current_user</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:dimension</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='comment val'># some page update here ...</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href='AlreadyRatedError.html' title='AlreadyRatedError'>AlreadyRatedError</a></tt>]</span>
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 72</span>

<span class='def def kw'>def</span> <span class='rate identifier id'>rate</span><span class='lparen token'>(</span><span class='stars identifier id'>stars</span><span class='comma token'>,</span> <span class='user identifier id'>user</span><span class='comma token'>,</span> <span class='dimension identifier id'>dimension</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='stars identifier id'>stars</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='gt op'>&gt;</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='max_rate_value identifier id'>max_rate_value</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='AlreadyRatedError constant id'>AlreadyRatedError</span> <span class='if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='notop op'>!</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:allow_update</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='rated_by? fid id'>rated_by?</span><span class='lparen token'>(</span><span class='user identifier id'>user</span><span class='comma token'>,</span> <span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

  <span class='rate identifier id'>rate</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:allow_update</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='rated_by? fid id'>rated_by?</span><span class='lparen token'>(</span><span class='user identifier id'>user</span><span class='comma token'>,</span> <span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='question op'>?</span>
    <span class='rate_by identifier id'>rate_by</span><span class='lparen token'>(</span><span class='user identifier id'>user</span><span class='comma token'>,</span> <span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='rates identifier id'>rates</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='build identifier id'>build</span>
  <span class='rate identifier id'>rate</span><span class='dot token'>.</span><span class='stars identifier id'>stars</span> <span class='assign token'>=</span> <span class='stars identifier id'>stars</span>
  <span class='if if kw'>if</span> <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='rates identifier id'>rates</span><span class='rparen token'>)</span>
    <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='rates identifier id'>rates</span> <span class='lshft op'>&lt;&lt;</span> <span class='rate identifier id'>rate</span>
  <span class='else else kw'>else</span>
    <span class='rate identifier id'>rate</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='dstring node'>&quot;#{self.class.user_class_name}_id=&quot;</span><span class='comma token'>,</span> <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='id identifier id'>id</span>
  <span class='end end kw'>end</span> <span class='if if_mod kw'>if</span> <span class='rate identifier id'>rate</span><span class='dot token'>.</span><span class='new_record? fid id'>new_record?</span>
  <span class='rate identifier id'>rate</span><span class='dot token'>.</span><span class='save! fid id'>save!</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='update_cached_average identifier id'>update_cached_average</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rate_average</h3>
</div><div id="rate_average-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rate_average</span><span class='args'>(cached = true, dimension = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Rating average for the object.
</p>
<p>
Pass false as param to force the calculation if you are caching it.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


121
122
123
124
125
126
127
128</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 121</span>

<span class='def def kw'>def</span> <span class='rate_average identifier id'>rate_average</span><span class='lparen token'>(</span><span class='cached identifier id'>cached</span> <span class='assign token'>=</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='dimension identifier id'>dimension</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='avg identifier id'>avg</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='cached identifier id'>cached</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='caching_average? fid id'>caching_average?</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span>
    <span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='caching_column_name identifier id'>caching_column_name</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
  <span class='else else kw'>else</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='rates_sum identifier id'>rates_sum</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span> <span class='div op'>/</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='total_rates identifier id'>total_rates</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
  <span class='end end kw'>end</span>
  <span class='avg identifier id'>avg</span><span class='dot token'>.</span><span class='nan? fid id'>nan?</span> <span class='integer val'>? </span><span class='integer val'>0</span><span class='integer val'>.0</span> <span class='colon op'>:</span> <span class='avg identifier id'>avg</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rate_by</h3>
</div><div id="rate_by-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rate_by</span><span class='args'>(user, dimension = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Finds the rate made by the user if he/she has already voted.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


98
99
100
101</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 98</span>

<span class='def def kw'>def</span> <span class='rate_by identifier id'>rate_by</span><span class='lparen token'>(</span><span class='user identifier id'>user</span><span class='comma token'>,</span> <span class='dimension identifier id'>dimension</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='filter identifier id'>filter</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;find_by_#{self.class.user_class_name}_id&quot;</span>
  <span class='rates identifier id'>rates</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='filter identifier id'>filter</span><span class='comma token'>,</span> <span class='user identifier id'>user</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rated_by?</h3>
</div><div id="rated_by%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rated_by?</span><span class='args'>(user, dimension = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return true if the user has rated the object, otherwise false
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


104
105
106</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 104</span>

<span class='def def kw'>def</span> <span class='rated_by? fid id'>rated_by?</span><span class='lparen token'>(</span><span class='user identifier id'>user</span><span class='comma token'>,</span> <span class='dimension identifier id'>dimension</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='notop op'>!</span><span class='rate_by identifier id'>rate_by</span><span class='lparen token'>(</span><span class='user identifier id'>user</span><span class='comma token'>,</span> <span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>raters</h3>
</div><div id="raters-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>raters</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array with all users that have rated this object.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


89
90
91
92
93
94
95</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 89</span>

<span class='def def kw'>def</span> <span class='raters identifier id'>raters</span>
  <span class='eval identifier id'>eval</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='user_class_name identifier id'>user_class_name</span><span class='dot token'>.</span><span class='classify identifier id'>classify</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='find_by_sql identifier id'>find_by_sql</span><span class='lparen token'>(</span>
    <span class='lbrack token'>[</span><span class='dstring node'>&quot;SELECT DISTINCT u.* FROM #{self.class.user_class_name.pluralize} u INNER JOIN rates r ON &quot;</span> <span class='plus op'>+</span>
        <span class='dstring node'>&quot;u.[id] = r.[#{self.class.user_class_name}_id] WHERE r.[rateable_id] = ? AND r.[rateable_type] = ?&quot;</span><span class='comma token'>,</span>
      <span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span>
  <span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rates</h3>
</div><div id="rates-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rates</span><span class='args'>(dimension = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Overrides the default <tt>rates</tt> method and returns the propper array
for the dimension passed.
</p>
<p>
It may works as an alias for <tt>dimension_rates</tt> methods.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


134
135
136
137
138
139
140</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 134</span>

<span class='def def kw'>def</span> <span class='rates identifier id'>rates</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='dimension identifier id'>dimension</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
    <span class='send identifier id'>send</span> <span class='dstring node'>&quot;#{dimension}_rates&quot;</span>
  <span class='else else kw'>else</span>
    <span class='rates_without_dimension identifier id'>rates_without_dimension</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rates_sum</h3>
</div><div id="rates_sum-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rates_sum</span><span class='args'>(dimension = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Total sum of the rates.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


114
115
116</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 114</span>

<span class='def def kw'>def</span> <span class='rates_sum identifier id'>rates_sum</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rates identifier id'>rates</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sum identifier id'>sum</span><span class='lparen token'>(</span><span class='symbol val'>:stars</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>total_rates</h3>
</div><div id="total_rates-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>total_rates</span><span class='args'>(dimension = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Instance&#8217;s total rates.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


109
110
111</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 109</span>

<span class='def def kw'>def</span> <span class='total_rates identifier id'>total_rates</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='rates identifier id'>rates</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_cached_average</h3>
</div><div id="update_cached_average-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_cached_average</span><span class='args'>(dimension = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Updates the cached average column in the rateable model.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


148
149
150
151
152
153
154</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/ajaxful_rating.rb', line 148</span>

<span class='def def kw'>def</span> <span class='update_cached_average identifier id'>update_cached_average</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='caching_average? fid id'>caching_average?</span><span class='lparen token'>(</span><span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span>
    <span class='rates identifier id'>rates</span><span class='lparen token'>(</span><span class='symbol val'>:refresh</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='if if_mod kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:rates_count</span><span class='rparen token'>)</span>
    <span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{caching_column_name(dimension)}=&quot;</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='rate_average identifier id'>rate_average</span><span class='lparen token'>(</span><span class='false false kw'>false</span><span class='comma token'>,</span> <span class='dimension identifier id'>dimension</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='save! fid id'>save!</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>