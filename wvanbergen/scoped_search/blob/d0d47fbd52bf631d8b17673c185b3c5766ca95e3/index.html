<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>wvanbergen's scoped_search - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/wvanbergen/commits/scoped_search/master" rel="alternate" title="Recent Commits to scoped_search:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("wvanbergen", "scoped_search", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='wvanbergen/scoped_search/blob/d0d47fbd52bf631d8b17673c185b3c5766ca95e3' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='wvanbergen/scoped_search/blob/d0d47fbd52bf631d8b17673c185b3c5766ca95e3' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("wvanbergen", "scoped_search", "d0d47fbd52bf631d8b17673c185b3c5766ca95e3", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/wvanbergen/scoped_search/tree/">Source</a></li>
            <li class=""><a href="http://github.com/wvanbergen/scoped_search/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/wvanbergen/scoped_search/network">Network</a></li>            
            <li class=""><a href="http://github.com/wvanbergen/scoped_search/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/wvanbergen/scoped_search">Wiki</a></li>
            <li class=""><a href="http://github.com/wvanbergen/scoped_search/graphs">Graphs</a></li>                    
            <li class="active"><a href="/wvanbergen/scoped_search">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/wvanbergen">wvanbergen</a> / <b><a href="http://github.com/wvanbergen/scoped_search/tree">scoped_search</a></b>        
                <a id="namespaces_button" rel="wvanbergen/scoped_search/blob/d0d47fbd52bf631d8b17673c185b3c5766ca95e3" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="wvanbergen/scoped_search/blob/d0d47fbd52bf631d8b17673c185b3c5766ca95e3" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>scoped_search</h1>
<p>
The <b>scoped_search</b> Rails plugin makes it easy to search your
ActiveRecord models. Searching is performed using a query string, which
should be passed to the named_scope <b>search_for</b> that uses SQL
<tt>LIKE %keyword%</tt> conditions for searching (ILIKE for Postgres). You
can specify what fields should be used for searching.
</p>
<h2>Installing</h2>
<p>
The recommended method to enable scoped_search in your project is adding
the scoped_search gem to your environment. Add the following code to your
Rails configuration in <tt>config/environment.rb</tt>:
</p>
<pre class="code">
  <span class='Rails constant id'>Rails</span><span class='colon2 op'>::</span><span class='Initializer constant id'>Initializer</span><span class='dot token'>.</span><span class='run identifier id'>run</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='config identifier id'>config</span><span class='bitor op'>|</span>
    <span class='dot3 op'>...</span>
    <span class='config identifier id'>config</span><span class='dot token'>.</span><span class='gem identifier id'>gem</span> <span class='string val'>'wvanbergen-scoped_search'</span><span class='comma token'>,</span> <span class='symbol val'>:lib</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'scoped_search'</span><span class='comma token'>,</span>
                   <span class='source identifier id'>source</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'http://gems.github.com/'</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Run <tt>sudo rake gems:install</tt> to install the gem.
</p>
<p>
Another alternative is to install scoped_search as a Rails plugin:
</p>
<pre class="code">
  <span class='script identifier id'>script</span><span class='div op'>/</span><span class='plugin identifier id'>plugin</span> <span class='install identifier id'>install</span> <span class='git identifier id'>git</span><span class='symbol val'>:/</span><span class='regexp val'>/github.com/</span><span class='wvanbergen identifier id'>wvanbergen</span><span class='div op'>/</span><span class='scoped_search identifier id'>scoped_search</span><span class='dot token'>.</span><span class='git identifier id'>git</span>
</pre>
<h2>Usage</h2>
<p>
First, you have to specify in what columns should be searched:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='User constant id'>User</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='searchable_on identifier id'>searchable_on</span> <span class='symbol val'>:first_name</span><span class='comma token'>,</span> <span class='symbol val'>:last_name</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Now, the <b>search_for</b> scope is available for queries. You should pass
a query string to the scope. This can be empty or nil, in which case all no
search conditions are set (and all records will be returned).
</p>
<pre class="code">
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='search_for identifier id'>search_for</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:q</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='project identifier id'>project</span><span class='bitor op'>|</span> <span class='dot3 op'>...</span> <span class='rbrace token'>}</span>
</pre>
<p>
You can also search on associate models. This works with <b>belongs_to</b>,
<b>has_one</b>, <b>has_many</b>, <b>has_many :through</b>, and
<b>HABTM</b>. For example if a User <b>has_many</b> Notes (title, content,
created_at, updated_at)
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='User constant id'>User</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='has_many identifier id'>has_many</span><span class='colon op'>:</span> <span class='notes identifier id'>notes</span>
    <span class='searchable_on identifier id'>searchable_on</span> <span class='symbol val'>:first_name</span><span class='comma token'>,</span> <span class='symbol val'>:last_name</span><span class='comma token'>,</span> <span class='symbol val'>:notes_title</span><span class='comma token'>,</span> <span class='symbol val'>:notes_content</span>
  <span class='end end kw'>end</span>
</pre>
<p>
The search query language is simple. It supports these constructs:
</p>
<ul>
<li><b>words:</b> <tt>some search keywords</tt>

</li>
<li><b>phrases:</b> <tt>&quot;a single search phrase&quot;</tt>

</li>
<li><b>negation:</b> <tt>&quot;look for this&quot; -&quot;but do not look for
this phrase and this&quot; -word</tt>

</li>
<li><b>OR words/phrases:</b> word/phrase OR word/phrase. Example:
<tt>&quot;Hello World&quot; OR &quot;Hello Moon&quot;</tt>

</li>
<li><b>dates:</b> mm/dd/yyyy, dd/mm/yyyy, yyyy/mm/dd, yyyy-mm-dd

</li>
<li><b>date ranges:</b> &gt; date, &gt;= date, &lt; date, &lt;= date, date TO
date. Examples: <tt>&gt; 30/05/1983</tt>, <tt>&lt; 2009-01-30</tt>

</li>
</ul>
<p>
This functionality is build on <tt>named_scope</tt>. The searchable_on
statement creates a named_scope <b>search_for</b>. Because of this, you can
actually chain the call with other scopes. For example, this can be very
useful if you only want to search in projects that are accessible by a
given user.
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Project constant id'>Project</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='searchable_on identifier id'>searchable_on</span> <span class='symbol val'>:name</span><span class='comma token'>,</span> <span class='symbol val'>:description</span>
    <span class='named_scope identifier id'>named_scope</span> <span class='symbol val'>:accessible_by</span><span class='comma token'>,</span> <span class='lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='user identifier id'>user</span><span class='bitor op'>|</span> <span class='dot3 op'>...</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># using chained named_scopes and will_paginate</span>
  <span class='Project constant id'>Project</span><span class='dot token'>.</span><span class='accessible_by identifier id'>accessible_by</span><span class='lparen token'>(</span><span class='current_user identifier id'>current_user</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='search_for identifier id'>search_for</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:q</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='paginate identifier id'>paginate</span><span class='lparen token'>(</span><span class='symbol val'>:page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:page</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:include</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:tasks</span><span class='rparen token'>)</span>
</pre>
<h2>Additional resources</h2>
<ul>
<li>Source code: http://github.com/wvanbergen/scoped_search/tree/master

</li>
<li>Project wiki: http://wiki.github.com/wvanbergen/scoped_search

</li>
<li>RDoc documentation: http://wvanbergen.github.com/scoped_search

</li>
<li>wvanbergen&#8217;s blog posts:
http://techblog.floorplanner.com/tag/scoped_search

</li>
</ul>
<h2>License</h2>
<p>
This plugin is released under the MIT license. Please contact weshays
(http://github.com/weshays) or wvanbergen (http://github.com/wvanbergen)
for any questions.
</p>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>