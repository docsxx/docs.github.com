<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>auser's poolparty - Class: PoolParty::Remote::Ec2 - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/auser/commits/poolparty/master" rel="alternate" title="Recent Commits to poolparty:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("auser", "poolparty", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("auser", "poolparty", "0125149be7ba3e969e952ab528c27e689d9ce07e", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/auser/poolparty/tree/">Source</a></li>
            <li class=""><a href="http://github.com/auser/poolparty/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/auser/poolparty/network">Network</a></li>            
            <li class=""><a href="http://github.com/auser/poolparty/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/auser/poolparty">Wiki</a></li>
            <li class=""><a href="http://github.com/auser/poolparty/graphs">Graphs</a></li>                    
            <li class="active"><a href="/auser/poolparty">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/auser">auser</a> / <b><a href="http://github.com/auser/poolparty/tree">poolparty</a></b>        
                <a id="namespaces_button" rel="auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class PoolParty_Remote_Ec2">
  <h1>Class: PoolParty::Remote::Ec2</h1>
  <div class="section inheritance">
  <ul>
  <li><a href="RemoterBase.html" title="PoolParty::Remote::RemoterBase">PoolParty::Remote::RemoterBase</a></li><ul><li>PoolParty::Remote::Ec2</li>
  </ul></ul>
</div><div class="section constants">
  
</div><div class="section constructor">
<h2>Constructor</h2>
  <p class="inherited_msg">
    This class inherits a constructor from <a href="RemoterBase.html#initialize-instance_method" title="PoolParty::Remote::RemoterBase">PoolParty::Remote::RemoterBase</a>.
  </p>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ec2-class_method">ec2</span><span class='args'>(o)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#launch_new_instance-21-class_method">launch_new_instance!</span><span class='args'>(o)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
alias to image_id def ami(n=nil)
</p>
<pre class="code">
  <span class='if if kw'>if</span> <span class='n identifier id'>n</span><span class='dot token'>.</span>
</pre>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Class Methods Inherited from <a href="RemoterBase.html" title="PoolParty::Remote::RemoterBase">PoolParty::Remote::RemoterBase</a></h2>
    <p><span class='name'><a href="RemoterBase.html#available_bases-class_method" title="available_bases">available_bases</a></span>, <span class='name'><a href="RemoterBase.html#describe_instance-class_method" title="describe_instance">describe_instance</a></span>, <span class='name'><a href="RemoterBase.html#describe_instances-class_method" title="describe_instances">describe_instances</a></span>, <span class='name'><a href="RemoterBase.html#inherited-class_method" title="inherited">inherited</a></span>, <span class='name'><a href="RemoterBase.html#launch_instance%21-class_method" title="launch_instance!">launch_instance!</a></span>, <span class='name'><a href="RemoterBase.html#symbol-class_method" title="symbol">symbol</a></span>, <span class='name'><a href="RemoterBase.html#terminate_instance%21-class_method" title="terminate_instance!">terminate_instance!</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#after_install_tasks_for-instance_method">#after_install_tasks_for</span><span class='args'>(o)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#after_launch_instance-instance_method">#after_launch_instance</span><span class='args'>(inst)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#associate_address-instance_method">#associate_address</span><span class='args'>(instance = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Associate an address with the instance using ec2 Get the
next_unused_elastic_ip and if there is one, associate the instance to the
public ip.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#aws_keys-instance_method">#aws_keys</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Class method helpers.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#create_keypair-instance_method">#create_keypair</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Help create a keypair for the cloud This is a helper to create the keypair
and add them to the cloud for you.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#create_snapshot-instance_method">#create_snapshot</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
wrapper for remote base to perform a snapshot backup for the ebs volume.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#custom_install_tasks_for-instance_method">#custom_install_tasks_for</span><span class='args'>(o)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Hook TODO#: Change this so they match with the cap tasks.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#custom_minimum_runnable_options-instance_method">#custom_minimum_runnable_options</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#describe_instance-instance_method">#describe_instance</span><span class='args'>(o = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Describe an instance&#8217;s status.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#describe_instances-instance_method">#describe_instances</span><span class='args'>(o = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ec2-instance_method">#ec2</span><span class='args'>(o = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
TODO: Clean up this method and remove hostnames def
describe_instances(o={})
</p>
<pre class="code">
  <span class='id identifier id'>id</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='set_vars_from_options identifier id'>set_vars_from_options</span><span class='lparen token'>(</span><span class='dsl_options identifier id'>dsl_options</span><span class='dot token'>.</span>
</pre>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_access_key-instance_method">#get_access_key</span><span class='args'>(n = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_descriptions-instance_method">#get_descriptions</span><span class='args'>(o = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_instances_description-instance_method">#get_instances_description</span><span class='args'>(o = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the ec2 description for the response in a hash format.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_secret_access_key-instance_method">#get_secret_access_key</span><span class='args'>(n = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_cert_and_key-3F-instance_method">#has_cert_and_key?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#launch_new_instance-21-instance_method">#launch_new_instance!</span><span class='args'>(o = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
TODO: Fix the key_name issue Start a new instance with the given options.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#next_unused_elastic_ip-instance_method">#next_unused_elastic_ip</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the next usable elastic ip First, get the list of addresses from ec2
that the client has access to, then select only the ones that are not
associated with an instance.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#private_key-instance_method">#private_key</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Private key.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pub_key-instance_method">#pub_key</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The keys are used only for puppet certificates and are only used for EC2.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reset_base-21-instance_method">#reset_base!</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#terminate_instance-21-instance_method">#terminate_instance!</span><span class='args'>(o = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Terminate an instance by id.
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Instance Methods Inherited from <a href="RemoterBase.html" title="PoolParty::Remote::RemoterBase">PoolParty::Remote::RemoterBase</a></h2>
    <p><span class='name'><a href="RemoterBase.html#after_launched-instance_method" title="after_launched">after_launched</a></span>, <span class='name'><a href="RemoterBase.html#before_shutdown-instance_method" title="before_shutdown">before_shutdown</a></span>, <span class='name'><a href="RemoterBase.html#cloud-instance_method" title="cloud">cloud</a></span>, <span class='name'><a href="RemoterBase.html#key_name-instance_method" title="key_name">key_name</a></span>, <span class='name'><a href="RemoterBase.html#keypair-instance_method" title="keypair">keypair</a></span>, <span class='name'><a href="RemoterBase.html#launch_instance%21-instance_method" title="launch_instance!">launch_instance!</a></span>, <span class='name'><a href="RemoterBase.html#remoter_base_options-instance_method" title="remoter_base_options">remoter_base_options</a></span>, <span class='name'><a href="RemoterBase.html#terminate_youngest_instance%21-instance_method" title="terminate_youngest_instance!">terminate_youngest_instance!</a></span>, <span class='name'><a href="RemoterBase.html#to_hash-instance_method" title="to_hash">to_hash</a></span>, <span class='name'><a href="RemoterBase.html#to_s-instance_method" title="to_s">to_s</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>ec2</h3>
</div><div id="ec2-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ec2</span><span class='args'>(o)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 142</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L142">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">142
143
144
145
146</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='ec2 identifier id'>ec2</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>
  <span class='@ec2 ivar id'>@ec2</span> <span class='opasgn op'>||=</span> <span class='EC2 constant id'>EC2</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:access_key_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:access_key</span><span class='rbrack token'>]</span><span class='comma token'>,</span> 
                          <span class='symbol val'>:secret_access_key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:secret_access_key</span><span class='rbrack token'>]</span>
                        <span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>launch_new_instance!</h3>
</div><div id="launch_new_instance-21-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>launch_new_instance!</span><span class='args'>(o)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
alias to image_id def ami(n=nil)
</p>
<pre class="code">
  <span class='if if kw'>if</span> <span class='n identifier id'>n</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='image_id identifier id'>image_id</span>
  <span class='else else kw'>else</span>
    <span class='image_id identifier id'>image_id</span> <span class='n identifier id'>n</span>
  <span class='end end kw'>end</span>
</pre>
<p>
end Requires a hash of options
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 68</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L68">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">68
69
70</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='launch_new_instance! fid id'>launch_new_instance!</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>
  <span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='launch_new_instance! fid id'>launch_new_instance!</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>after_install_tasks_for</h3>
</div><div id="after_install_tasks_for-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>after_install_tasks_for</span><span class='args'>(o)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 272</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L272">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">272
273
274
275
276
277</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='after_install_tasks_for identifier id'>after_install_tasks_for</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span>
    <span class='comment val'># &quot;cd /var/poolparty &amp;&amp; wget http://rubyforge.org/frs/download.php/43666/amazon-ec2-0.3.1.gem -O amazon-ec2.gem 2&gt;&amp;1&quot;,</span>
    <span class='comment val'># &quot;/usr/bin/gem install --no-ri --no-rdoc amazon-ec2.gem 2&gt;&amp;1&quot;</span>
  <span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>after_launch_instance</h3>
</div><div id="after_launch_instance-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>after_launch_instance</span><span class='args'>(inst)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 171</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L171">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">171
172
173
174
175</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='after_launch_instance identifier id'>after_launch_instance</span><span class='lparen token'>(</span><span class='inst identifier id'>inst</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='inst identifier id'>inst</span>
    <span class='associate_address identifier id'>associate_address</span><span class='lparen token'>(</span><span class='inst identifier id'>inst</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>associate_address</h3>
</div><div id="associate_address-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>associate_address</span><span class='args'>(instance = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Associate an address with the instance using ec2 Get the
next_unused_elastic_ip and if there is one, associate the instance to the
public ip
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 181</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L181">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='associate_address identifier id'>associate_address</span><span class='lparen token'>(</span><span class='instance identifier id'>instance</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='ip identifier id'>ip</span> <span class='assign token'>=</span> <span class='next_unused_elastic_ip identifier id'>next_unused_elastic_ip</span>
    <span class='vputs identifier id'>vputs</span> <span class='dstring node'>&quot;Associating #{instance.instance_id} with #{ip}&quot;</span>
    <span class='ec2 identifier id'>ec2</span><span class='dot token'>.</span><span class='associate_address identifier id'>associate_address</span><span class='lparen token'>(</span><span class='symbol val'>:instance_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='instance identifier id'>instance</span><span class='dot token'>.</span><span class='instance_id identifier id'>instance_id</span><span class='comma token'>,</span> <span class='symbol val'>:public_ip</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ip identifier id'>ip</span><span class='rparen token'>)</span>
    
    <span class='comment val'># Try for 10 minutes to pint port 22 </span>
    <span class='float val'>500</span><span class='dot token'>.</span><span class='times identifier id'>times</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
      <span class='dprint identifier id'>dprint</span> <span class='string val'>&quot;.&quot;</span>
      <span class='if if kw'>if</span> <span class='ping_port identifier id'>ping_port</span><span class='lparen token'>(</span><span class='ip identifier id'>ip</span><span class='comma token'>,</span> <span class='integer val'>22</span><span class='rparen token'>)</span>
        <span class='instance identifier id'>instance</span><span class='lbrack token'>[</span><span class='symbol val'>:ip</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='ip identifier id'>ip</span>
        <span class='return return kw'>return</span> <span class='true true kw'>true</span>
      <span class='end end kw'>end</span>
      <span class='sleep identifier id'>sleep</span><span class='lparen token'>(</span><span class='integer val'>2</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span> 
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>aws_keys</h3>
</div><div id="aws_keys-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>aws_keys</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Class method helpers
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 161</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L161">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">161
162
163
164
165
166
167
168
169</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='aws_keys identifier id'>aws_keys</span>
  <span class='unless unless kw'>unless</span> <span class='@access_key ivar id'>@access_key</span> <span class='andop op'>&amp;&amp;</span> <span class='@secret_access_key ivar id'>@secret_access_key</span>
    <span class='aws_keys identifier id'>aws_keys</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
    <span class='aws_keys identifier id'>aws_keys</span> <span class='assign token'>=</span> <span class='YAML constant id'>YAML</span><span class='colon2 op'>::</span><span class='load identifier id'>load</span><span class='lparen token'>(</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>'/etc/poolparty/aws_keys.yml'</span><span class='rparen token'>)</span> <span class='rparen token'>)</span> <span class='rescue rescue kw'>rescue</span> <span class='string val'>'No aws_keys.yml file.   Will try to use enviornment variables'</span>
    <span class='@access_key ivar id'>@access_key</span> <span class='opasgn op'>||=</span> <span class='aws_keys identifier id'>aws_keys</span><span class='lbrack token'>[</span><span class='symbol val'>:access_key</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'AMAZON_ACCESS_KEY_ID'</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'AWS_ACCESS_KEY'</span><span class='rbrack token'>]</span>
    <span class='@secret_access_key ivar id'>@secret_access_key</span> <span class='opasgn op'>||=</span> <span class='aws_keys identifier id'>aws_keys</span><span class='lbrack token'>[</span><span class='symbol val'>:secret_access_key</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'AMAZON_SECRET_ACCESS_KEY'</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'AWS_SECRET_ACCESS_KEY'</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='lbrack token'>[</span><span class='@access_key ivar id'>@access_key</span><span class='comma token'>,</span> <span class='@secret_access_key ivar id'>@secret_access_key</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>create_keypair</h3>
</div><div id="create_keypair-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create_keypair</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Help create a keypair for the cloud This is a helper to create the keypair
and add them to the cloud for you
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 228</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L228">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">228
229
230
231
232
233
234
235</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='create_keypair identifier id'>create_keypair</span>
  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='unless unless_mod kw'>unless</span> <span class='keypair identifier id'>keypair</span>
  <span class='unless unless kw'>unless</span> <span class='colon3 op'>::</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='exists? fid id'>exists?</span><span class='lparen token'>(</span> <span class='new_keypair_path identifier id'>new_keypair_path</span> <span class='rparen token'>)</span>
    <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mkdir_p identifier id'>mkdir_p</span> <span class='colon3 op'>::</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span> <span class='new_keypair_path identifier id'>new_keypair_path</span> <span class='rparen token'>)</span>
    <span class='vputs identifier id'>vputs</span> <span class='dstring node'>&quot;Creating keypair: #{keypair} in #{new_keypair_path}&quot;</span>
    <span class='Kernel constant id'>Kernel</span><span class='dot token'>.</span><span class='system identifier id'>system</span> <span class='dstring node'>&quot;ec2-add-keypair #{keypair} &gt; #{new_keypair_path} &amp;&amp; chmod 600 #{new_keypair_path}&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>create_snapshot</h3>
</div><div id="create_snapshot-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create_snapshot</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
wrapper for remote base to perform a snapshot backup for the ebs volume
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 238</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L238">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">238
239
240
241</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='create_snapshot identifier id'>create_snapshot</span>
  <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span> <span class='if if_mod kw'>if</span> <span class='ebs_volume_id identifier id'>ebs_volume_id</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='ec2 identifier id'>ec2</span><span class='dot token'>.</span><span class='create_snapshot identifier id'>create_snapshot</span><span class='lparen token'>(</span><span class='symbol val'>:volume_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ebs_volume_id identifier id'>ebs_volume_id</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>custom_install_tasks_for</h3>
</div><div id="custom_install_tasks_for-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>custom_install_tasks_for</span><span class='args'>(o)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Hook TODO#: Change this so they match with the cap tasks
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 263</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L263">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">263
264
265
266
267
268
269
270</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='custom_install_tasks_for identifier id'>custom_install_tasks_for</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>        
  <span class='lbrack token'>[</span>
    <span class='comment val'># &quot;if [ -z $(grep -v '#' /etc/hosts | grep '#{o.name}') ]; then echo \&quot;$(curl http://169.254.169.254/latest/meta-data/public-ipv4) #{o.name}\&quot; &gt;&gt; /etc/hosts; fi&quot;,</span>
    <span class='dstring node'>&quot;if [ -z \&quot;$(grep -v '#' /etc/hosts | grep '#{o.name}')\&quot; ]; then echo '127.0.0.1 #{o.name}' &gt;&gt; /etc/hosts; fi&quot;</span><span class='comma token'>,</span>
    <span class='dstring node'>&quot;hostname #{o.name}&quot;</span><span class='comma token'>,</span>
    <span class='dstring node'>&quot;echo #{o.name} &gt; /etc/hostname&quot;</span>
  <span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>custom_minimum_runnable_options</h3>
</div><div id="custom_minimum_runnable_options-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>custom_minimum_runnable_options</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 257</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L257">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">257
258
259</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='custom_minimum_runnable_options identifier id'>custom_minimum_runnable_options</span>
  <span class='lbrack token'>[</span><span class='symbol val'>:ami</span><span class='comma token'>,</span> <span class='symbol val'>:availability_zone</span><span class='comma token'>,</span> <span class='symbol val'>:security_group</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>describe_instance</h3>
</div><div id="describe_instance-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>describe_instance</span><span class='args'>(o = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Describe an instance&#8217;s status
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 98</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L98">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">98
99
100
101</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='describe_instance identifier id'>describe_instance</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='describe_instances identifier id'>describe_instances</span><span class='dot token'>.</span><span class='first identifier id'>first</span> <span class='if if_mod kw'>if</span> <span class='o identifier id'>o</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='orop op'>||</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:instance_id</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='describe_instances identifier id'>describe_instances</span><span class='dot token'>.</span><span class='detect identifier id'>detect</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:instance_id</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:ip</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:instance_id</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:instance_id</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:instance_id</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>describe_instances</h3>
</div><div id="describe_instances-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>describe_instances</span><span class='args'>(o = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 103</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L103">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">103
104
105
106
107
108</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='describe_instances identifier id'>describe_instances</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='ec2_instants identifier id'>ec2_instants</span> <span class='assign token'>=</span> <span class='EC2ResponseObject constant id'>EC2ResponseObject</span><span class='dot token'>.</span><span class='describe_instances identifier id'>describe_instances</span><span class='lparen token'>(</span><span class='ec2 identifier id'>ec2</span><span class='dot token'>.</span><span class='describe_instances identifier id'>describe_instances</span><span class='rparen token'>)</span>
  <span class='insts identifier id'>insts</span> <span class='assign token'>=</span> <span class='ec2_instants identifier id'>ec2_instants</span><span class='dot token'>.</span><span class='select_with_hash identifier id'>select_with_hash</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='notop op'>!</span><span class='o identifier id'>o</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
  <span class='ec2_remote_instances identifier id'>ec2_remote_instances</span> <span class='assign token'>=</span> <span class='ec2_instants identifier id'>ec2_instants</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span> <span class='Ec2RemoteInstance constant id'>Ec2RemoteInstance</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='rparen token'>)</span><span class='rbrace token'>}</span>
  <span class='ec2_remote_instances identifier id'>ec2_remote_instances</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='comma token'>,</span><span class='b identifier id'>b</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:ami_launch_index</span><span class='rbrack token'>]</span> <span class='cmp op'>&lt;=&gt;</span> <span class='b identifier id'>b</span><span class='lbrack token'>[</span><span class='symbol val'>:ami_launch_index</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ec2</h3>
</div><div id="ec2-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ec2</span><span class='args'>(o = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
TODO: Clean up this method and remove hostnames def
describe_instances(o={})
</p>
<pre class="code">
  <span class='id identifier id'>id</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='set_vars_from_options identifier id'>set_vars_from_options</span><span class='lparen token'>(</span><span class='dsl_options identifier id'>dsl_options</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='get_instances_description identifier id'>get_instances_description</span><span class='lparen token'>(</span><span class='dsl_options identifier id'>dsl_options</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='h identifier id'>h</span><span class='comma token'>,</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='h identifier id'>h</span><span class='lbrack token'>[</span><span class='symbol val'>:status</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;running&quot;</span>
      <span class='inst_name identifier id'>inst_name</span> <span class='assign token'>=</span> <span class='id identifier id'>id</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='question op'>?</span> <span class='string val'>&quot;master&quot;</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;node#{id}&quot;</span>
      <span class='id identifier id'>id</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
    <span class='else else kw'>else</span>
      <span class='inst_name identifier id'>inst_name</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{h[:status]}_node#{i}&quot;</span>
    <span class='end end kw'>end</span>
    <span class='h identifier id'>h</span><span class='dot token'>.</span><span class='merge! fid id'>merge!</span><span class='lparen token'>(</span><span class='lbrace token'>{</span>
      <span class='symbol val'>:name</span>           <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='inst_name identifier id'>inst_name</span><span class='comma token'>,</span>
      <span class='symbol val'>:hostname</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='h identifier id'>h</span><span class='lbrack token'>[</span><span class='symbol val'>:ip</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
      <span class='symbol val'>:ip</span>             <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='h identifier id'>h</span><span class='lbrack token'>[</span><span class='symbol val'>:ip</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='convert_from_ec2_to_ip identifier id'>convert_from_ec2_to_ip</span><span class='comma token'>,</span>
      <span class='comment val'># :internal_ip    =&gt; h.ip</span>
      <span class='symbol val'>:index</span>          <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='i identifier id'>i</span><span class='comma token'>,</span>  <span class='comment val'>#TODO get the instance id from the aws result instead</span>
      <span class='symbol val'>:launching_time</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lparen token'>(</span><span class='h identifier id'>h</span><span class='lbrack token'>[</span><span class='symbol val'>:launching_time</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='comma token'>,</span><span class='b identifier id'>b</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='symbol val'>:index</span><span class='rbrack token'>]</span> <span class='cmp op'>&lt;=&gt;</span> <span class='b identifier id'>b</span><span class='lbrack token'>[</span><span class='symbol val'>:index</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
</pre>
<p>
end
</p>
<h6>=============================</h6>
<h1>Ec2 Specific methods below here =</h1>
<h6>=============================</h6>
<p>
return or create a new base EC2 connection object that will actually
connect to ec2
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 137</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L137">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">137
138
139
140
141</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='ec2 identifier id'>ec2</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@ec2 ivar id'>@ec2</span> <span class='opasgn op'>||=</span> <span class='EC2 constant id'>EC2</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:access_key_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:access_key</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='get_access_key identifier id'>get_access_key</span><span class='comma token'>,</span> 
                          <span class='symbol val'>:secret_access_key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:secret_access_key</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='get_secret_access_key identifier id'>get_secret_access_key</span>
                        <span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_access_key</h3>
</div><div id="get_access_key-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_access_key</span><span class='args'>(n = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 279</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L279">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">279
280
281
282
283
284
285</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_access_key identifier id'>get_access_key</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='n identifier id'>n</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='dsl_options identifier id'>dsl_options</span><span class='lbrack token'>[</span><span class='symbol val'>:access_key</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='Default constant id'>Default</span><span class='dot token'>.</span><span class='access_key identifier id'>access_key</span>
  <span class='else else kw'>else</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='access_key identifier id'>access_key</span> <span class='assign token'>=</span> <span class='n identifier id'>n</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_descriptions</h3>
</div><div id="get_descriptions-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_descriptions</span><span class='args'>(o = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 156</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L156">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">156
157
158</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_descriptions identifier id'>get_descriptions</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='get_descriptions identifier id'>get_descriptions</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_instances_description</h3>
</div><div id="get_instances_description-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_instances_description</span><span class='args'>(o = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the ec2 description for the response in a hash format
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 149</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L149">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">149
150
151
152
153
154
155</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_instances_description identifier id'>get_instances_description</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='comment val'>#TODO: only use keypair.full_filepath</span>
  <span class='set_vars_from_options identifier id'>set_vars_from_options</span> <span class='dsl_options identifier id'>dsl_options</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>
  <span class='key_hash identifier id'>key_hash</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:keypair</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='keypair_name identifier id'>keypair_name</span><span class='rbrace token'>}</span>
  <span class='out identifier id'>out</span> <span class='assign token'>=</span> <span class='EC2ResponseObject constant id'>EC2ResponseObject</span><span class='dot token'>.</span><span class='get_descriptions identifier id'>get_descriptions</span><span class='lparen token'>(</span><span class='ec2 identifier id'>ec2</span><span class='lparen token'>(</span><span class='dsl_options identifier id'>dsl_options</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='describe_instances identifier id'>describe_instances</span><span class='rparen token'>)</span>
  <span class='out identifier id'>out</span> <span class='assign token'>=</span> <span class='keypair_name identifier id'>keypair_name</span> <span class='integer val'>? </span><span class='out identifier id'>out</span><span class='dot token'>.</span><span class='select_with_hash identifier id'>select_with_hash</span><span class='lparen token'>(</span><span class='key_hash identifier id'>key_hash</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='out identifier id'>out</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_secret_access_key</h3>
</div><div id="get_secret_access_key-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_secret_access_key</span><span class='args'>(n = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 287</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L287">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">287
288
289
290
291
292
293</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_secret_access_key identifier id'>get_secret_access_key</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='n identifier id'>n</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='dsl_options identifier id'>dsl_options</span><span class='lbrack token'>[</span><span class='symbol val'>:secret_access_key</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='Default constant id'>Default</span><span class='dot token'>.</span><span class='secret_access_key identifier id'>secret_access_key</span>
  <span class='else else kw'>else</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='secret_access_key identifier id'>secret_access_key</span> <span class='assign token'>=</span> <span class='n identifier id'>n</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_cert_and_key?</h3>
</div><div id="has_cert_and_key-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_cert_and_key?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 243</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L243">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">243
244
245</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='has_cert_and_key? fid id'>has_cert_and_key?</span>
  <span class='pub_key identifier id'>pub_key</span> <span class='andop op'>&amp;&amp;</span> <span class='private_key identifier id'>private_key</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>launch_new_instance!</h3>
</div><div id="launch_new_instance-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>launch_new_instance!</span><span class='args'>(o = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
TODO: Fix the key_name issue Start a new instance with the given options
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 74</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L74">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='launch_new_instance! fid id'>launch_new_instance!</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='set_vars_from_options identifier id'>set_vars_from_options</span> <span class='o identifier id'>o</span>
  <span class='keypair_name identifier id'>keypair_name</span> <span class='opasgn op'>||=</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:keypair_name</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='keypair identifier id'>keypair</span> <span class='orop op'>||</span> <span class='lparen token'>(</span><span class='clouds identifier id'>clouds</span><span class='lbrack token'>[</span><span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:cloud_name</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='keypair identifier id'>keypair</span><span class='dot token'>.</span><span class='basename identifier id'>basename</span> <span class='if if_mod kw'>if</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:cloud_name</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='dstring node'>&quot;You must pass a keypair to launch an instance, or else you will not be able to login. options = #{o.inspect}&quot;</span> <span class='if if_mod kw'>if</span> <span class='notop op'>!</span><span class='keypair_name identifier id'>keypair_name</span> 
  <span class='o identifier id'>o</span><span class='dot token'>.</span><span class='merge! fid id'>merge!</span><span class='lparen token'>(</span> <span class='dsl_options identifier id'>dsl_options</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:key_name=</span><span class='gt op'>&gt;</span><span class='keypair_name identifier id'>keypair_name</span><span class='comma token'>,</span> <span class='symbol val'>:group_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='security_group identifier id'>security_group</span><span class='rparen token'>)</span> <span class='rparen token'>)</span>
  <span class='instance identifier id'>instance</span> <span class='assign token'>=</span> <span class='ec2 identifier id'>ec2</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='run_instances identifier id'>run_instances</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>
  
  <span class='begin begin kw'>begin</span>
    <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='EC2ResponseObject constant id'>EC2ResponseObject</span><span class='dot token'>.</span><span class='describe_instance identifier id'>describe_instance</span><span class='lparen token'>(</span><span class='instance identifier id'>instance</span><span class='rparen token'>)</span>
    <span class='comment val'>#h = instance.instancesSet.item.first</span>
  <span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
    <span class='vputs identifier id'>vputs</span> <span class='dstring node'>&quot;There was an error:\n\t#{e.inspect}&quot;</span>
    <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='EC2ResponseObject constant id'>EC2ResponseObject</span><span class='dot token'>.</span><span class='describe_instance identifier id'>describe_instance</span><span class='lparen token'>(</span><span class='instance identifier id'>instance</span><span class='rparen token'>)</span> <span class='rescue rescue kw'>rescue</span> <span class='instance identifier id'>instance</span>
    <span class='comment val'># h = instance</span>
  <span class='end end kw'>end</span>
  <span class='Ec2RemoteInstance constant id'>Ec2RemoteInstance</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='h identifier id'>h</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>next_unused_elastic_ip</h3>
</div><div id="next_unused_elastic_ip-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>next_unused_elastic_ip</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the next usable elastic ip First, get the list of addresses from ec2
that the client has access to, then select only the ones that are not
associated with an instance. If the cloud has set elastic_ips to use, then,
using the intersection of the unused ips and those, find the first one
available and return that, otherwise, return the first elastic ip available
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 205</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L205">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='next_unused_elastic_ip identifier id'>next_unused_elastic_ip</span>
  <span class='if if kw'>if</span> <span class='elastic_ips identifier id'>elastic_ips</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='nil nil kw'>nil</span>
  <span class='else else kw'>else</span>
    <span class='comment val'># [{&quot;instanceId&quot;=&gt;nil, &quot;publicIp&quot;=&gt;&quot;174.129.212.93&quot;}, {&quot;instanceId&quot;=&gt;nil, &quot;publicIp&quot;=&gt;&quot;174.129.212.94&quot;}]</span>
    <span class='if if kw'>if</span> <span class='addressesSet identifier id'>addressesSet</span> <span class='assign token'>=</span> <span class='ec2 identifier id'>ec2</span><span class='lparen token'>(</span><span class='dsl_options identifier id'>dsl_options</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='describe_addresses identifier id'>describe_addresses</span><span class='lparen token'>(</span><span class='symbol val'>:public_ip</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='elastic_ips identifier id'>elastic_ips</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='string val'>&quot;addressesSet&quot;</span><span class='rbrack token'>]</span>
      <span class='begin begin kw'>begin</span>
        <span class='empty_addresses identifier id'>empty_addresses</span> <span class='assign token'>=</span> <span class='addressesSet identifier id'>addressesSet</span><span class='lbrack token'>[</span><span class='string val'>&quot;item&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span> <span class='i identifier id'>i</span><span class='lbrack token'>[</span><span class='string val'>&quot;instanceId&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='rbrace token'>}</span>
        <span class='ips identifier id'>ips</span> <span class='assign token'>=</span> <span class='empty_addresses identifier id'>empty_addresses</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='addr identifier id'>addr</span><span class='bitor op'>|</span> <span class='addr identifier id'>addr</span><span class='lbrack token'>[</span><span class='string val'>&quot;publicIp&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span>
        <span class='if if kw'>if</span> <span class='elastic_ips identifier id'>elastic_ips</span>
          <span class='ips_to_use identifier id'>ips_to_use</span> <span class='assign token'>=</span> <span class='elastic_ips identifier id'>elastic_ips</span> <span class='bitand op'>&amp;</span> <span class='ips identifier id'>ips</span>
          <span class='ips_to_use identifier id'>ips_to_use</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
        <span class='end end kw'>end</span>
      <span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
        <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;Error: #{e}&quot;</span>
        <span class='nil nil kw'>nil</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>private_key</h3>
</div><div id="private_key-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>private_key</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Private key
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 253</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L253">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">253
254
255</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='private_key identifier id'>private_key</span>
  <span class='@private_key ivar id'>@private_key</span> <span class='opasgn op'>||=</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>&quot;EC2_PRIVATE_KEY&quot;</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>&quot;EC2_PRIVATE_KEY&quot;</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pub_key</h3>
</div><div id="pub_key-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pub_key</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The keys are used only for puppet certificates and are only used for EC2.
Public key
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 249</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L249">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">249
250
251</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pub_key identifier id'>pub_key</span>
  <span class='@pub_key ivar id'>@pub_key</span> <span class='opasgn op'>||=</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>&quot;EC2_CERT&quot;</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>&quot;EC2_CERT&quot;</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reset_base!</h3>
</div><div id="reset_base-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reset_base!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 295</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L295">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">295
296
297</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reset_base! fid id'>reset_base!</span>
  <span class='@describe_instances ivar id'>@describe_instances</span> <span class='assign token'>=</span> <span class='@cached_descriptions ivar id'>@cached_descriptions</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>      
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>terminate_instance!</h3>
</div><div id="terminate_instance-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>terminate_instance!</span><span class='args'>(o = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Terminate an instance by id
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/poolparty/net/remoter_bases/ec2/ec2.rb', line 93</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/auser/poolparty/blob/0125149be7ba3e969e952ab528c27e689d9ce07e/lib/poolparty/net/remoter_bases/ec2/ec2.rb#L93">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">93
94
95</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='terminate_instance! fid id'>terminate_instance!</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='ec2 identifier id'>ec2</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='terminate_instances identifier id'>terminate_instances</span><span class='lparen token'>(</span><span class='symbol val'>:instance_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:instance_id</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>