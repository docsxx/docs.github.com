<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>ezmobius's nanite - Class: Nanite::Agent - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/ezmobius/commits/nanite/master" rel="alternate" title="Recent Commits to nanite:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("ezmobius", "nanite", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='ezmobius/nanite/blob/2461cb2f43e3a4bdf1c77989e47de25c41432666' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='ezmobius/nanite/blob/2461cb2f43e3a4bdf1c77989e47de25c41432666' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("ezmobius", "nanite", "2461cb2f43e3a4bdf1c77989e47de25c41432666", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/ezmobius/nanite/tree/">Source</a></li>
            <li class=""><a href="http://github.com/ezmobius/nanite/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/ezmobius/nanite/network">Network</a></li>            
            <li class=""><a href="http://github.com/ezmobius/nanite/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/ezmobius/nanite">Wiki</a></li>
            <li class=""><a href="http://github.com/ezmobius/nanite/graphs">Graphs</a></li>                    
            <li class="active"><a href="/ezmobius/nanite">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/ezmobius">ezmobius</a> / <b><a href="http://github.com/ezmobius/nanite/tree">nanite</a></b>        
                <a id="namespaces_button" rel="ezmobius/nanite/blob/2461cb2f43e3a4bdf1c77989e47de25c41432666" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="ezmobius/nanite/blob/2461cb2f43e3a4bdf1c77989e47de25c41432666" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Nanite_Agent">
  <h1>Class: Nanite::Agent</h1>
  <div class="section mixins">
  <h2>Included Modules</h2>
  <p><a href="Agent/AMQPHelper.html" title="Nanite::AMQPHelper">Nanite::AMQPHelper</a>, <a href="Agent/FileStreaming.html" title="Nanite::FileStreaming">Nanite::FileStreaming</a>, <a href="Agent/ConsoleHelper.html" title="Nanite::ConsoleHelper">Nanite::ConsoleHelper</a>, <a href="Agent/DaemonizeHelper.html" title="Nanite::DaemonizeHelper">Nanite::DaemonizeHelper</a></p>
</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">amq</td>
          <td class="readwrite">
            [<span id='amq-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>amq</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">dispatcher</td>
          <td class="readwrite">
            [<span id='dispatcher-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>dispatcher</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">identity</td>
          <td class="readwrite">
            [<span id='identity-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>identity</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">options</td>
          <td class="readwrite">
            [<span id='options-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>options</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">registry</td>
          <td class="readwrite">
            [<span id='registry-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>registry</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">serializer</td>
          <td class="readwrite">
            [<span id='serializer-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>serializer</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">status_proc</td>
          <td class="readwrite">
            [<span id='status_proc-instance_method'>R</span><span id='status_proc=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>status_proc</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">tags</td>
          <td class="readwrite">
            [<span id='tags-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>tags</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="DEFAULT_OPTIONS-constant">DEFAULT_OPTIONS</dt>
      <dd>COMMON_DEFAULT_OPTIONS.merge({:user =&gt; 'nanite', :ping_time =&gt; 15,
:default_services =&gt; []}) unless defined?(DEFAULT_OPTIONS)</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(opts)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanite/agent.rb', line 81</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ezmobius/nanite/blob/2461cb2f43e3a4bdf1c77989e47de25c41432666/lib/nanite/agent.rb#L81">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">81
82
83
84
85
86
87</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
  <span class='set_configuration identifier id'>set_configuration</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
  <span class='@tags ivar id'>@tags</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@tags ivar id'>@tags</span> <span class='lshft op'>&lt;&lt;</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:tag</span><span class='rbrack token'>]</span>
  <span class='@tags ivar id'>@tags</span><span class='dot token'>.</span><span class='flatten! fid id'>flatten!</span>
  <span class='@options ivar id'>@options</span><span class='dot token'>.</span><span class='freeze identifier id'>freeze</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#start-class_method">start</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Initializes a new agent and establishes AMQP connection.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#register-instance_method">#register</span><span class='args'>(actor, prefix = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#register_security-instance_method">#register_security</span><span class='args'>(security, deny_token = &quot;Denied&quot;)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Can be used in agent&#8217;s initialization file to register a security
module This security module &#8216;authorize&#8217; method will be called
back whenever the agent receives a request and will be given the
corresponding deliverable.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#run-instance_method">#run</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h2>Public Instance Methods Included from <a href="Agent/AMQPHelper.html" title="Nanite::AMQPHelper">Nanite::AMQPHelper</a></h2>
    <p><span class='name'><a href="AMQPHelper.html#start_amqp-instance_method" title="start_amqp">start_amqp</a></span></p>
  </div>
  
  <div>
    <h2>Public Instance Methods Included from <a href="Agent/FileStreaming.html" title="Nanite::FileStreaming">Nanite::FileStreaming</a></h2>
    <p><span class='name'><a href="FileStreaming.html#broadcast_data-instance_method" title="broadcast_data">broadcast_data</a></span>, <span class='name'><a href="FileStreaming.html#broadcast_file-instance_method" title="broadcast_file">broadcast_file</a></span>, <span class='name'><a href="FileStreaming.html#subscribe_to_files-instance_method" title="subscribe_to_files">subscribe_to_files</a></span></p>
  </div>
  
  <div>
    <h2>Public Instance Methods Included from <a href="Agent/ConsoleHelper.html" title="Nanite::ConsoleHelper">Nanite::ConsoleHelper</a></h2>
    <p><span class='name'><a href="ConsoleHelper.html#start_console-instance_method" title="start_console">start_console</a></span></p>
  </div>
  
  <div>
    <h2>Public Instance Methods Included from <a href="Agent/DaemonizeHelper.html" title="Nanite::DaemonizeHelper">Nanite::DaemonizeHelper</a></h2>
    <p><span class='name'><a href="DaemonizeHelper.html#daemonize-instance_method" title="daemonize">daemonize</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>start</h3>
</div><div id="start-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>start</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Initializes a new agent and establishes AMQP connection. This must be used
inside EM.run block or if EventMachine reactor is already started, for
instance, by a Thin server that your Merb/Rails application runs on.
</p>
<p>
Agent options:
</p>
<p>
identity : identity of this agent, may be any string
</p>
<p>
status_proc : a callable object that returns agent load as a string,
</p>
<pre class="code">
              <span class='defaults identifier id'>defaults</span> <span class='to identifier id'>to</span> <span class='load identifier id'>load</span> <span class='averages identifier id'>averages</span> <span class='string identifier id'>string</span> <span class='extracted identifier id'>extracted</span> <span class='from identifier id'>from</span> <span class='xstring val'>`uptime`</span>
</pre>
<p>
format : format to use for packets serialization. One of the three:
</p>
<pre class="code">
              <span class='symbol val'>:marshall</span><span class='comma token'>,</span> <span class='symbol val'>:json</span><span class='comma token'>,</span> <span class='or or kw'>or</span> <span class='symbol val'>:yaml</span><span class='dot token'>.</span> <span class='Defaults constant id'>Defaults</span> <span class='to identifier id'>to</span>
              <span class='Ruby constant id'>Ruby</span><span class='string val'>'s Marshall format. For interoperability with
              AMQP clients implemented in other languages, use JSON.

              Note that Nanite uses JSON gem,
              and ActiveSupport'</span><span class='s identifier id'>s</span> <span class='JSON constant id'>JSON</span> <span class='encoder identifier id'>encoder</span> <span class='may identifier id'>may</span> <span class='cause identifier id'>cause</span> <span class='clashes identifier id'>clashes</span>
              <span class='if if kw'>if</span> <span class='ActiveSupport constant id'>ActiveSupport</span> <span class='is identifier id'>is</span> <span class='loaded identifier id'>loaded</span> <span class='after identifier id'>after</span> <span class='JSON constant id'>JSON</span> <span class='gem identifier id'>gem</span><span class='dot token'>.</span>
</pre>
<p>
root : application root for this agent, defaults to Dir.pwd
</p>
<p>
log_dir : path to directory where agent stores it&#8217;s log file
</p>
<pre class="code">
              <span class='if if kw'>if</span> <span class='not not kw'>not</span> <span class='given identifier id'>given</span><span class='comma token'>,</span> <span class='app_root identifier id'>app_root</span> <span class='is identifier id'>is</span> <span class='used identifier id'>used</span><span class='dot token'>.</span>
</pre>
<p>
file_root : path to directory to files this agent provides
</p>
<pre class="code">
              <span class='defaults identifier id'>defaults</span> <span class='to identifier id'>to</span> <span class='app_root identifier id'>app_root</span><span class='div op'>/</span><span class='files identifier id'>files</span>
</pre>
<p>
ping_time : time interval in seconds between two subsequent heartbeat
messages
</p>
<pre class="code">
              <span class='this identifier id'>this</span> <span class='agent identifier id'>agent</span> <span class='broadcasts identifier id'>broadcasts</span><span class='dot token'>.</span> <span class='Default constant id'>Default</span> <span class='value identifier id'>value</span> <span class='is identifier id'>is</span> <span class='float val'>15</span><span class='dot token'>.</span>
</pre>
<p>
console : true tells Nanite to start interactive console
</p>
<p>
daemonize : true tells Nanite to daemonize
</p>
<p>
pid_dir : path to the directory where the agent stores its pid file (only
if daemonized)
</p>
<pre class="code">
              <span class='defaults identifier id'>defaults</span> <span class='to identifier id'>to</span> <span class='the identifier id'>the</span> <span class='root identifier id'>root</span> <span class='or or kw'>or</span> <span class='the identifier id'>the</span> <span class='current identifier id'>current</span> <span class='working identifier id'>working</span> <span class='directory identifier id'>directory</span><span class='dot token'>.</span>
</pre>
<p>
services : list of services provided by this agent, by default
</p>
<pre class="code">
              <span class='all identifier id'>all</span> <span class='methods identifier id'>methods</span> <span class='exposed identifier id'>exposed</span> <span class='by identifier id'>by</span> <span class='actors identifier id'>actors</span> <span class='are identifier id'>are</span> <span class='listed identifier id'>listed</span>
</pre>
<p>
single_threaded: Run all operations in one thread
</p>
<p>
Connection options:
</p>
<p>
vhost : AMQP broker vhost that should be used
</p>
<p>
user : AMQP broker user
</p>
<p>
pass : AMQP broker password
</p>
<p>
host : host AMQP broker (or node of interest) runs on,
</p>
<pre class="code">
           <span class='defaults identifier id'>defaults</span> <span class='to identifier id'>to</span> <span class='integer val'>0</span><span class='float val'>.0.0</span><span class='integer val'>.0</span>
</pre>
<p>
port : port AMQP broker (or node of interest) runs on,
</p>
<pre class="code">
           <span class='this identifier id'>this</span> <span class='defaults identifier id'>defaults</span> <span class='to identifier id'>to</span> <span class='integer val'>5672</span><span class='comma token'>,</span> <span class='port identifier id'>port</span> <span class='used identifier id'>used</span> <span class='by identifier id'>by</span> <span class='some identifier id'>some</span> <span class='widely identifier id'>widely</span>
           <span class='used identifier id'>used</span> <span class='AMQP constant id'>AMQP</span> <span class='brokers identifier id'>brokers</span> <span class='lparen token'>(</span><span class='RabbitMQ constant id'>RabbitMQ</span> <span class='and and kw'>and</span> <span class='ZeroMQ constant id'>ZeroMQ</span><span class='rparen token'>)</span>
</pre>
<p>
On start Nanite reads config.yml, so it is common to specify options in the
YAML file. However, when both Ruby code options and YAML file specify
option, Ruby code options take precedence.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanite/agent.rb', line 75</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ezmobius/nanite/blob/2461cb2f43e3a4bdf1c77989e47de25c41432666/lib/nanite/agent.rb#L75">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">75
76
77
78
79</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='agent identifier id'>agent</span> <span class='assign token'>=</span> <span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='agent identifier id'>agent</span><span class='dot token'>.</span><span class='run identifier id'>run</span>
  <span class='agent identifier id'>agent</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>register</h3>
</div><div id="register-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>register</span><span class='args'>(actor, prefix = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanite/agent.rb', line 118</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ezmobius/nanite/blob/2461cb2f43e3a4bdf1c77989e47de25c41432666/lib/nanite/agent.rb#L118">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">118
119
120</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='register identifier id'>register</span><span class='lparen token'>(</span><span class='actor identifier id'>actor</span><span class='comma token'>,</span> <span class='prefix identifier id'>prefix</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='registry identifier id'>registry</span><span class='dot token'>.</span><span class='register identifier id'>register</span><span class='lparen token'>(</span><span class='actor identifier id'>actor</span><span class='comma token'>,</span> <span class='prefix identifier id'>prefix</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>register_security</h3>
</div><div id="register_security-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>register_security</span><span class='args'>(security, deny_token = &quot;Denied&quot;)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Can be used in agent&#8217;s initialization file to register a security
module This security module &#8216;authorize&#8217; method will be called
back whenever the agent receives a request and will be given the
corresponding deliverable. It should return &#8216;true&#8217; for the
request to proceed. Requests will return &#8216;deny_token&#8217; or the
string &quot;Denied&quot; by default when &#8216;authorize&#8217; does not
return &#8216;true&#8217;.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanite/agent.rb', line 128</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ezmobius/nanite/blob/2461cb2f43e3a4bdf1c77989e47de25c41432666/lib/nanite/agent.rb#L128">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">128
129
130
131</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='register_security identifier id'>register_security</span><span class='lparen token'>(</span><span class='security identifier id'>security</span><span class='comma token'>,</span> <span class='deny_token identifier id'>deny_token</span> <span class='assign token'>=</span> <span class='string val'>&quot;Denied&quot;</span><span class='rparen token'>)</span>
  <span class='@security ivar id'>@security</span> <span class='assign token'>=</span> <span class='security identifier id'>security</span>
  <span class='@deny_token ivar id'>@deny_token</span> <span class='assign token'>=</span> <span class='deny_token identifier id'>deny_token</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>run</h3>
</div><div id="run-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>run</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanite/agent.rb', line 89</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ezmobius/nanite/blob/2461cb2f43e3a4bdf1c77989e47de25c41432666/lib/nanite/agent.rb#L89">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='run identifier id'>run</span>
  <span class='log_path identifier id'>log_path</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='if if kw'>if</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:daemonize</span><span class='rbrack token'>]</span>
    <span class='log_path identifier id'>log_path</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:log_dir</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:root</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='Dir constant id'>Dir</span><span class='dot token'>.</span><span class='pwd identifier id'>pwd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='Log constant id'>Log</span><span class='dot token'>.</span><span class='init identifier id'>init</span><span class='lparen token'>(</span><span class='@identity ivar id'>@identity</span><span class='comma token'>,</span> <span class='log_path identifier id'>log_path</span><span class='rparen token'>)</span>
  <span class='Log constant id'>Log</span><span class='dot token'>.</span><span class='level identifier id'>level</span> <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:log_level</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:log_level</span><span class='rbrack token'>]</span>
  <span class='@serializer ivar id'>@serializer</span> <span class='assign token'>=</span> <span class='Serializer constant id'>Serializer</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:format</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='@status_proc ivar id'>@status_proc</span> <span class='assign token'>=</span> <span class='lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='parse_uptime identifier id'>parse_uptime</span><span class='lparen token'>(</span><span class='xstring val'>`uptime`</span><span class='rparen token'>)</span> <span class='rescue rescue kw'>rescue</span> <span class='string val'>'no status'</span> <span class='rbrace token'>}</span>
  <span class='pid_file identifier id'>pid_file</span> <span class='assign token'>=</span> <span class='PidFile constant id'>PidFile</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='@identity ivar id'>@identity</span><span class='comma token'>,</span> <span class='@options ivar id'>@options</span><span class='rparen token'>)</span>
  <span class='pid_file identifier id'>pid_file</span><span class='dot token'>.</span><span class='check identifier id'>check</span>
  <span class='if if kw'>if</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:daemonize</span><span class='rbrack token'>]</span>
    <span class='daemonize identifier id'>daemonize</span>
    <span class='pid_file identifier id'>pid_file</span><span class='dot token'>.</span><span class='write identifier id'>write</span>
    <span class='at_exit identifier id'>at_exit</span> <span class='lbrace token'>{</span> <span class='pid_file identifier id'>pid_file</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='@amq ivar id'>@amq</span> <span class='assign token'>=</span> <span class='start_amqp identifier id'>start_amqp</span><span class='lparen token'>(</span><span class='@options ivar id'>@options</span><span class='rparen token'>)</span>
  <span class='@registry ivar id'>@registry</span> <span class='assign token'>=</span> <span class='ActorRegistry constant id'>ActorRegistry</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@dispatcher ivar id'>@dispatcher</span> <span class='assign token'>=</span> <span class='Dispatcher constant id'>Dispatcher</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='@amq ivar id'>@amq</span><span class='comma token'>,</span> <span class='@registry ivar id'>@registry</span><span class='comma token'>,</span> <span class='@serializer ivar id'>@serializer</span><span class='comma token'>,</span> <span class='@identity ivar id'>@identity</span><span class='comma token'>,</span> <span class='@options ivar id'>@options</span><span class='rparen token'>)</span>
  <span class='setup_mapper_proxy identifier id'>setup_mapper_proxy</span>
  <span class='load_actors identifier id'>load_actors</span>
  <span class='setup_traps identifier id'>setup_traps</span>
  <span class='setup_queue identifier id'>setup_queue</span>
  <span class='advertise_services identifier id'>advertise_services</span>
  <span class='setup_heartbeat identifier id'>setup_heartbeat</span>
  <span class='at_exit identifier id'>at_exit</span> <span class='lbrace token'>{</span> <span class='un_register identifier id'>un_register</span> <span class='rbrace token'>}</span> <span class='unless unless_mod kw'>unless</span> <span class='$TESTING gvar id'>$TESTING</span>
  <span class='start_console identifier id'>start_console</span> <span class='if if_mod kw'>if</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:console</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:daemonize</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>