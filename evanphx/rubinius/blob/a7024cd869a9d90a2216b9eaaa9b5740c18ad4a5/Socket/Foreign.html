<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>evanphx's rubinius - Module: Socket::Foreign - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/evanphx/commits/rubinius/master" rel="alternate" title="Recent Commits to rubinius:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("evanphx", "rubinius", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("evanphx", "rubinius", "a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/evanphx/rubinius/tree/">Source</a></li>
            <li class=""><a href="http://github.com/evanphx/rubinius/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/evanphx/rubinius/network">Network</a></li>            
            <li class=""><a href="http://github.com/evanphx/rubinius/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/evanphx/rubinius">Wiki</a></li>
            <li class=""><a href="http://github.com/evanphx/rubinius/graphs">Graphs</a></li>                    
            <li class="active"><a href="/evanphx/rubinius">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/evanphx">evanphx</a> / <b><a href="http://github.com/evanphx/rubinius/tree">rubinius</a></b>        
                <a id="namespaces_button" rel="evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Socket_Foreign">
  <h1>Module: Socket::Foreign</h1>
  <div class="section mixins">
  <h2>Included Modules</h2>
  <p>FFI::Library</p>
</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bind-class_method">bind</span><span class='args'>(descriptor, sockaddr)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#connect-class_method">connect</span><span class='args'>(descriptor, sockaddr)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#getaddress-class_method">getaddress</span><span class='args'>(host)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#getaddrinfo-class_method">getaddrinfo</span><span class='args'>(host, service = nil, family = 0, socktype = 0, protocol = 0, flags = 0)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#getnameinfo-class_method">getnameinfo</span><span class='args'>(sockaddr, reverse_lookup = !BasicSocket.do_not_reverse_lookup)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#getpeername-class_method">getpeername</span><span class='args'>(descriptor)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#getsockname-class_method">getsockname</span><span class='args'>(descriptor)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#getsockopt-class_method">getsockopt</span><span class='args'>(descriptor, level, optname)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pack_sockaddr_in-class_method">pack_sockaddr_in</span><span class='args'>(name, port, type, flags)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#unpack_sockaddr_in-class_method">unpack_sockaddr_in</span><span class='args'>(sockaddr, reverse_lookup)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>bind</h3>
</div><div id="bind-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bind</span><span class='args'>(descriptor, sockaddr)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 222</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L222">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">222
223
224
225
226
227
228</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span><span class='lparen token'>(</span><span class='descriptor identifier id'>descriptor</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='rparen token'>)</span>
  <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:char</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='sockaddr_p identifier id'>sockaddr_p</span><span class='bitor op'>|</span>
    <span class='sockaddr_p identifier id'>sockaddr_p</span><span class='dot token'>.</span><span class='write_string identifier id'>write_string</span> <span class='sockaddr identifier id'>sockaddr</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span>

    <span class='_bind identifier id'>_bind</span> <span class='descriptor identifier id'>descriptor</span><span class='comma token'>,</span> <span class='sockaddr_p identifier id'>sockaddr_p</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>connect</h3>
</div><div id="connect-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>connect</span><span class='args'>(descriptor, sockaddr)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 230</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L230">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">230
231
232
233
234
235
236
237
238
239
240</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='connect identifier id'>connect</span><span class='lparen token'>(</span><span class='descriptor identifier id'>descriptor</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='rparen token'>)</span>
  <span class='err identifier id'>err</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:char</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='sockaddr_p identifier id'>sockaddr_p</span><span class='bitor op'>|</span>
    <span class='sockaddr_p identifier id'>sockaddr_p</span><span class='dot token'>.</span><span class='write_string identifier id'>write_string</span> <span class='sockaddr identifier id'>sockaddr</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span>

    <span class='err identifier id'>err</span> <span class='assign token'>=</span> <span class='_connect identifier id'>_connect</span> <span class='descriptor identifier id'>descriptor</span><span class='comma token'>,</span> <span class='sockaddr_p identifier id'>sockaddr_p</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='end end kw'>end</span>

  <span class='getsockopt identifier id'>getsockopt</span><span class='lparen token'>(</span><span class='descriptor identifier id'>descriptor</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='SOL_SOCKET constant id'>SOL_SOCKET</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='SO_ERROR constant id'>SO_ERROR</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='err identifier id'>err</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
  <span class='err identifier id'>err</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>getaddress</h3>
</div><div id="getaddress-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>getaddress</span><span class='args'>(host)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 317</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L317">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">317
318
319
320</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='getaddress identifier id'>getaddress</span><span class='lparen token'>(</span><span class='host identifier id'>host</span><span class='rparen token'>)</span>
  <span class='addrinfos identifier id'>addrinfos</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='dot token'>.</span><span class='getaddrinfo identifier id'>getaddrinfo</span><span class='lparen token'>(</span><span class='host identifier id'>host</span><span class='rparen token'>)</span>
  <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='dot token'>.</span><span class='unpack_sockaddr_in identifier id'>unpack_sockaddr_in</span><span class='lparen token'>(</span><span class='addrinfos identifier id'>addrinfos</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='lbrack token'>[</span><span class='integer val'>4</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='false false kw'>false</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>getaddrinfo</h3>
</div><div id="getaddrinfo-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>getaddrinfo</span><span class='args'>(host, service = nil, family = 0, socktype = 0, protocol = 0, flags = 0)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="../SocketError.html" title="SocketError">SocketError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 256</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L256">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='getaddrinfo identifier id'>getaddrinfo</span><span class='lparen token'>(</span><span class='host identifier id'>host</span><span class='comma token'>,</span> <span class='service identifier id'>service</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='family identifier id'>family</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='socktype identifier id'>socktype</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='comma token'>,</span>  <span class='protocol identifier id'>protocol</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='flags identifier id'>flags</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='hints identifier id'>hints</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='colon2 op'>::</span><span class='AddrInfo constant id'>AddrInfo</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='hints identifier id'>hints</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_family</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='family identifier id'>family</span>
  <span class='hints identifier id'>hints</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_socktype</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='socktype identifier id'>socktype</span>
  <span class='hints identifier id'>hints</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_protocol</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='protocol identifier id'>protocol</span>
  <span class='hints identifier id'>hints</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_flags</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='flags identifier id'>flags</span>
  <span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span> <span class='if if_mod kw'>if</span> <span class='host identifier id'>host</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>

  <span class='if if kw'>if</span> <span class='host identifier id'>host</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='flags identifier id'>flags</span> <span class='bitand op'>&amp;</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='AI_PASSIVE constant id'>AI_PASSIVE</span> <span class='eq op'>==</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># Passive socket</span>
      <span class='family identifier id'>family</span> <span class='eq op'>==</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='AF_INET6 constant id'>AF_INET6</span> <span class='integer val'>? </span><span class='lparen token'>(</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='string val'>&quot;::&quot;</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='lparen token'>(</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='string val'>&quot;0.0.0.0&quot;</span><span class='rparen token'>)</span> <span class='comment val'># IPv6 or IPv4</span>
    <span class='else else kw'>else</span>
      <span class='family identifier id'>family</span> <span class='eq op'>==</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='AF_INET6 constant id'>AF_INET6</span> <span class='integer val'>? </span><span class='lparen token'>(</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='string val'>&quot;::1&quot;</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='lparen token'>(</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='string val'>&quot;127.0.0.1&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='res_p identifier id'>res_p</span> <span class='assign token'>=</span> <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:pointer</span>

  <span class='err identifier id'>err</span> <span class='assign token'>=</span> <span class='_getaddrinfo identifier id'>_getaddrinfo</span> <span class='host identifier id'>host</span><span class='comma token'>,</span> <span class='service identifier id'>service</span><span class='comma token'>,</span> <span class='hints identifier id'>hints</span><span class='dot token'>.</span><span class='pointer identifier id'>pointer</span><span class='comma token'>,</span> <span class='res_p identifier id'>res_p</span>

  <span class='raise identifier id'>raise</span> <span class='SocketError constant id'>SocketError</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='dot token'>.</span><span class='gai_strerror identifier id'>gai_strerror</span><span class='lparen token'>(</span><span class='err identifier id'>err</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='err identifier id'>err</span> <span class='eq op'>==</span> <span class='integer val'>0</span>

  <span class='ptr identifier id'>ptr</span> <span class='assign token'>=</span> <span class='res_p identifier id'>res_p</span><span class='dot token'>.</span><span class='read_pointer identifier id'>read_pointer</span>

  <span class='return return kw'>return</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='unless unless_mod kw'>unless</span> <span class='ptr identifier id'>ptr</span>

  <span class='res identifier id'>res</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='colon2 op'>::</span><span class='AddrInfo constant id'>AddrInfo</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='ptr identifier id'>ptr</span>

  <span class='addrinfos identifier id'>addrinfos</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='loop identifier id'>loop</span> <span class='do do kw'>do</span>
    <span class='addrinfo identifier id'>addrinfo</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='addrinfo identifier id'>addrinfo</span> <span class='lshft op'>&lt;&lt;</span> <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_flags</span><span class='rbrack token'>]</span>
    <span class='addrinfo identifier id'>addrinfo</span> <span class='lshft op'>&lt;&lt;</span> <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_family</span><span class='rbrack token'>]</span>
    <span class='addrinfo identifier id'>addrinfo</span> <span class='lshft op'>&lt;&lt;</span> <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_socktype</span><span class='rbrack token'>]</span>
    <span class='addrinfo identifier id'>addrinfo</span> <span class='lshft op'>&lt;&lt;</span> <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_protocol</span><span class='rbrack token'>]</span>
    <span class='addrinfo identifier id'>addrinfo</span> <span class='lshft op'>&lt;&lt;</span> <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_addr</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='read_string identifier id'>read_string</span><span class='lparen token'>(</span><span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_addrlen</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='addrinfo identifier id'>addrinfo</span> <span class='lshft op'>&lt;&lt;</span> <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_canonname</span><span class='rbrack token'>]</span>

    <span class='addrinfos identifier id'>addrinfos</span> <span class='lshft op'>&lt;&lt;</span> <span class='addrinfo identifier id'>addrinfo</span>

    <span class='break break kw'>break</span> <span class='unless unless_mod kw'>unless</span> <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_next</span><span class='rbrack token'>]</span>

    <span class='res identifier id'>res</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='colon2 op'>::</span><span class='AddrInfo constant id'>AddrInfo</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_next</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>

  <span class='return return kw'>return</span> <span class='addrinfos identifier id'>addrinfos</span>
<span class='ensure ensure kw'>ensure</span>
  <span class='hints identifier id'>hints</span><span class='dot token'>.</span><span class='free identifier id'>free</span> <span class='if if_mod kw'>if</span> <span class='hints identifier id'>hints</span>

  <span class='if if kw'>if</span> <span class='res_p identifier id'>res_p</span> <span class='then then kw'>then</span>
    <span class='ptr identifier id'>ptr</span> <span class='assign token'>=</span> <span class='res_p identifier id'>res_p</span><span class='dot token'>.</span><span class='read_pointer identifier id'>read_pointer</span>

    <span class='comment val'># Be sure to feed a legit pointer to freeaddrinfo</span>
    <span class='if if kw'>if</span> <span class='ptr identifier id'>ptr</span> <span class='and and kw'>and</span> <span class='notop op'>!</span><span class='ptr identifier id'>ptr</span><span class='dot token'>.</span><span class='null? fid id'>null?</span>
      <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='dot token'>.</span><span class='freeaddrinfo identifier id'>freeaddrinfo</span> <span class='ptr identifier id'>ptr</span>
    <span class='end end kw'>end</span>
    <span class='res_p identifier id'>res_p</span><span class='dot token'>.</span><span class='free identifier id'>free</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>getnameinfo</h3>
</div><div id="getnameinfo-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>getnameinfo</span><span class='args'>(sockaddr, reverse_lookup = !BasicSocket.do_not_reverse_lookup)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 322</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L322">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='getnameinfo identifier id'>getnameinfo</span><span class='lparen token'>(</span><span class='sockaddr identifier id'>sockaddr</span><span class='comma token'>,</span>
                     <span class='reverse_lookup identifier id'>reverse_lookup</span> <span class='assign token'>=</span> <span class='notop op'>!</span><span class='BasicSocket constant id'>BasicSocket</span><span class='dot token'>.</span><span class='do_not_reverse_lookup identifier id'>do_not_reverse_lookup</span><span class='rparen token'>)</span>
  <span class='name_info identifier id'>name_info</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

  <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:char</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='sockaddr_p identifier id'>sockaddr_p</span><span class='bitor op'>|</span>
    <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:char</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Constants constant id'>Constants</span><span class='colon2 op'>::</span><span class='NI_MAXHOST constant id'>NI_MAXHOST</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='node identifier id'>node</span><span class='bitor op'>|</span>
      <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:char</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Constants constant id'>Constants</span><span class='colon2 op'>::</span><span class='NI_MAXSERV constant id'>NI_MAXSERV</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='service identifier id'>service</span><span class='bitor op'>|</span>
        <span class='sockaddr_p identifier id'>sockaddr_p</span><span class='dot token'>.</span><span class='write_string identifier id'>write_string</span> <span class='sockaddr identifier id'>sockaddr</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span>

        <span class='if if kw'>if</span> <span class='reverse_lookup identifier id'>reverse_lookup</span> <span class='then then kw'>then</span>
          <span class='err identifier id'>err</span> <span class='assign token'>=</span> <span class='_getnameinfo identifier id'>_getnameinfo</span><span class='lparen token'>(</span><span class='sockaddr_p identifier id'>sockaddr_p</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='comma token'>,</span>
                             <span class='node identifier id'>node</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Constants constant id'>Constants</span><span class='colon2 op'>::</span><span class='NI_MAXHOST constant id'>NI_MAXHOST</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span>

          <span class='unless unless kw'>unless</span> <span class='err identifier id'>err</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='then then kw'>then</span>
            <span class='raise identifier id'>raise</span> <span class='SocketError constant id'>SocketError</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='dot token'>.</span><span class='gai_strerror identifier id'>gai_strerror</span><span class='lparen token'>(</span><span class='err identifier id'>err</span><span class='rparen token'>)</span>
          <span class='end end kw'>end</span>

          <span class='name_info identifier id'>name_info</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='node identifier id'>node</span><span class='dot token'>.</span><span class='read_string identifier id'>read_string</span>
        <span class='end end kw'>end</span>

        <span class='err identifier id'>err</span> <span class='assign token'>=</span> <span class='_getnameinfo identifier id'>_getnameinfo</span><span class='lparen token'>(</span><span class='sockaddr_p identifier id'>sockaddr_p</span><span class='comma token'>,</span> <span class='sockaddr identifier id'>sockaddr</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='comma token'>,</span>
                           <span class='node identifier id'>node</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Constants constant id'>Constants</span><span class='colon2 op'>::</span><span class='NI_MAXHOST constant id'>NI_MAXHOST</span><span class='comma token'>,</span>
                           <span class='service identifier id'>service</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Constants constant id'>Constants</span><span class='colon2 op'>::</span><span class='NI_MAXSERV constant id'>NI_MAXSERV</span><span class='comma token'>,</span>
                           <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Constants constant id'>Constants</span><span class='colon2 op'>::</span><span class='NI_NUMERICHOST constant id'>NI_NUMERICHOST</span> <span class='bitor op'>|</span>
                             <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Constants constant id'>Constants</span><span class='colon2 op'>::</span><span class='NI_NUMERICSERV constant id'>NI_NUMERICSERV</span><span class='rparen token'>)</span>

        <span class='unless unless kw'>unless</span> <span class='err identifier id'>err</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='then then kw'>then</span>
          <span class='raise identifier id'>raise</span> <span class='SocketError constant id'>SocketError</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='dot token'>.</span><span class='gai_strerror identifier id'>gai_strerror</span><span class='lparen token'>(</span><span class='err identifier id'>err</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>

        <span class='sa_family identifier id'>sa_family</span> <span class='assign token'>=</span> <span class='SockAddr_In constant id'>SockAddr_In</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='sockaddr identifier id'>sockaddr</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='symbol val'>:sin_family</span><span class='rbrack token'>]</span>

        <span class='name_info identifier id'>name_info</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Constants constant id'>Constants</span><span class='colon2 op'>::</span><span class='AF_TO_FAMILY constant id'>AF_TO_FAMILY</span><span class='lbrack token'>[</span><span class='sa_family identifier id'>sa_family</span><span class='rbrack token'>]</span>
        <span class='name_info identifier id'>name_info</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Integer constant id'>Integer</span> <span class='service identifier id'>service</span><span class='dot token'>.</span><span class='read_string identifier id'>read_string</span>
        <span class='name_info identifier id'>name_info</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='node identifier id'>node</span><span class='dot token'>.</span><span class='read_string identifier id'>read_string</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='name_info identifier id'>name_info</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='name_info identifier id'>name_info</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='name_info identifier id'>name_info</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='name_info identifier id'>name_info</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>getpeername</h3>
</div><div id="getpeername-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>getpeername</span><span class='args'>(descriptor)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 366</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L366">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">366
367
368
369
370
371
372
373
374
375
376
377
378</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='getpeername identifier id'>getpeername</span><span class='lparen token'>(</span><span class='descriptor identifier id'>descriptor</span><span class='rparen token'>)</span>
  <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:char</span><span class='comma token'>,</span> <span class='integer val'>128</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='sockaddr_storage_p identifier id'>sockaddr_storage_p</span><span class='bitor op'>|</span>
    <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:socklen_t</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='len_p identifier id'>len_p</span><span class='bitor op'>|</span>
      <span class='len_p identifier id'>len_p</span><span class='dot token'>.</span><span class='write_int identifier id'>write_int</span> <span class='integer val'>128</span>

      <span class='err identifier id'>err</span> <span class='assign token'>=</span> <span class='_getpeername identifier id'>_getpeername</span> <span class='descriptor identifier id'>descriptor</span><span class='comma token'>,</span> <span class='sockaddr_storage_p identifier id'>sockaddr_storage_p</span><span class='comma token'>,</span> <span class='len_p identifier id'>len_p</span>

      <span class='Errno constant id'>Errno</span><span class='dot token'>.</span><span class='handle identifier id'>handle</span> <span class='string val'>'getpeername(2)'</span> <span class='unless unless_mod kw'>unless</span> <span class='err identifier id'>err</span> <span class='eq op'>==</span> <span class='integer val'>0</span>

      <span class='sockaddr_storage_p identifier id'>sockaddr_storage_p</span><span class='dot token'>.</span><span class='read_string identifier id'>read_string</span> <span class='len_p identifier id'>len_p</span><span class='dot token'>.</span><span class='read_int identifier id'>read_int</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>getsockname</h3>
</div><div id="getsockname-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>getsockname</span><span class='args'>(descriptor)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 380</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L380">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">380
381
382
383
384
385
386
387
388
389
390
391
392</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='getsockname identifier id'>getsockname</span><span class='lparen token'>(</span><span class='descriptor identifier id'>descriptor</span><span class='rparen token'>)</span>
  <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:char</span><span class='comma token'>,</span> <span class='integer val'>128</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='sockaddr_storage_p identifier id'>sockaddr_storage_p</span><span class='bitor op'>|</span>
    <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:socklen_t</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='len_p identifier id'>len_p</span><span class='bitor op'>|</span>
      <span class='len_p identifier id'>len_p</span><span class='dot token'>.</span><span class='write_int identifier id'>write_int</span> <span class='integer val'>128</span>

      <span class='err identifier id'>err</span> <span class='assign token'>=</span> <span class='_getsockname identifier id'>_getsockname</span> <span class='descriptor identifier id'>descriptor</span><span class='comma token'>,</span> <span class='sockaddr_storage_p identifier id'>sockaddr_storage_p</span><span class='comma token'>,</span> <span class='len_p identifier id'>len_p</span>

      <span class='Errno constant id'>Errno</span><span class='dot token'>.</span><span class='handle identifier id'>handle</span> <span class='string val'>'getsockname(2)'</span> <span class='unless unless_mod kw'>unless</span> <span class='err identifier id'>err</span> <span class='eq op'>==</span> <span class='integer val'>0</span>

      <span class='sockaddr_storage_p identifier id'>sockaddr_storage_p</span><span class='dot token'>.</span><span class='read_string identifier id'>read_string</span> <span class='len_p identifier id'>len_p</span><span class='dot token'>.</span><span class='read_int identifier id'>read_int</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>getsockopt</h3>
</div><div id="getsockopt-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>getsockopt</span><span class='args'>(descriptor, level, optname)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 242</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L242">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">242
243
244
245
246
247
248
249
250
251
252
253
254</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='getsockopt identifier id'>getsockopt</span><span class='lparen token'>(</span><span class='descriptor identifier id'>descriptor</span><span class='comma token'>,</span> <span class='level identifier id'>level</span><span class='comma token'>,</span> <span class='optname identifier id'>optname</span><span class='rparen token'>)</span>
  <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='integer val'>256</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='val identifier id'>val</span><span class='bitor op'>|</span> <span class='comment val'># HACK magic number</span>
    <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:socklen_t</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='length identifier id'>length</span><span class='bitor op'>|</span>
      <span class='length identifier id'>length</span><span class='dot token'>.</span><span class='write_int identifier id'>write_int</span> <span class='integer val'>256</span> <span class='comment val'># HACK magic number</span>

      <span class='err identifier id'>err</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='dot token'>.</span><span class='_getsockopt identifier id'>_getsockopt</span> <span class='descriptor identifier id'>descriptor</span><span class='comma token'>,</span> <span class='level identifier id'>level</span><span class='comma token'>,</span> <span class='optname identifier id'>optname</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='comma token'>,</span> <span class='length identifier id'>length</span>

      <span class='Errno constant id'>Errno</span><span class='dot token'>.</span><span class='handle identifier id'>handle</span> <span class='string val'>&quot;Unable to get socket option&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='err identifier id'>err</span> <span class='eq op'>==</span> <span class='integer val'>0</span>

      <span class='return return kw'>return</span> <span class='val identifier id'>val</span><span class='dot token'>.</span><span class='read_string identifier id'>read_string</span><span class='lparen token'>(</span><span class='length identifier id'>length</span><span class='dot token'>.</span><span class='read_int identifier id'>read_int</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pack_sockaddr_in</h3>
</div><div id="pack_sockaddr_in-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pack_sockaddr_in</span><span class='args'>(name, port, type, flags)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="../SocketError.html" title="SocketError">SocketError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 394</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L394">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='pack_sockaddr_in identifier id'>pack_sockaddr_in</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='port identifier id'>port</span><span class='comma token'>,</span> <span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='flags identifier id'>flags</span><span class='rparen token'>)</span>
  <span class='hints identifier id'>hints</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='colon2 op'>::</span><span class='AddrInfo constant id'>AddrInfo</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='hints identifier id'>hints</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_family</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='AF_INET constant id'>AF_INET</span>
  <span class='hints identifier id'>hints</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_socktype</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='type identifier id'>type</span>
  <span class='hints identifier id'>hints</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_flags</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='flags identifier id'>flags</span>

  <span class='res_p identifier id'>res_p</span> <span class='assign token'>=</span> <span class='FFI constant id'>FFI</span><span class='colon2 op'>::</span><span class='MemoryPointer constant id'>MemoryPointer</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:pointer</span>

  <span class='err identifier id'>err</span> <span class='assign token'>=</span> <span class='_getaddrinfo identifier id'>_getaddrinfo</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='port identifier id'>port</span><span class='comma token'>,</span> <span class='hints identifier id'>hints</span><span class='dot token'>.</span><span class='pointer identifier id'>pointer</span><span class='comma token'>,</span> <span class='res_p identifier id'>res_p</span>

  <span class='raise identifier id'>raise</span> <span class='SocketError constant id'>SocketError</span><span class='comma token'>,</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='dot token'>.</span><span class='gai_strerror identifier id'>gai_strerror</span><span class='lparen token'>(</span><span class='err identifier id'>err</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='err identifier id'>err</span> <span class='eq op'>==</span> <span class='integer val'>0</span>

  <span class='return return kw'>return</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='res_p identifier id'>res_p</span><span class='dot token'>.</span><span class='read_pointer identifier id'>read_pointer</span><span class='dot token'>.</span><span class='null? fid id'>null?</span>

  <span class='res identifier id'>res</span> <span class='assign token'>=</span> <span class='Socket constant id'>Socket</span><span class='colon2 op'>::</span><span class='Foreign constant id'>Foreign</span><span class='colon2 op'>::</span><span class='AddrInfo constant id'>AddrInfo</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='res_p identifier id'>res_p</span><span class='dot token'>.</span><span class='read_pointer identifier id'>read_pointer</span>

  <span class='return return kw'>return</span> <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_addr</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='read_string identifier id'>read_string</span><span class='lparen token'>(</span><span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:ai_addrlen</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

<span class='ensure ensure kw'>ensure</span>
  <span class='hints identifier id'>hints</span><span class='dot token'>.</span><span class='free identifier id'>free</span> <span class='if if_mod kw'>if</span> <span class='hints identifier id'>hints</span>

  <span class='if if kw'>if</span> <span class='res_p identifier id'>res_p</span> <span class='then then kw'>then</span>
    <span class='ptr identifier id'>ptr</span> <span class='assign token'>=</span> <span class='res_p identifier id'>res_p</span><span class='dot token'>.</span><span class='read_pointer identifier id'>read_pointer</span>

    <span class='freeaddrinfo identifier id'>freeaddrinfo</span> <span class='ptr identifier id'>ptr</span> <span class='if if_mod kw'>if</span> <span class='ptr identifier id'>ptr</span> <span class='and and kw'>and</span> <span class='not not kw'>not</span> <span class='ptr identifier id'>ptr</span><span class='dot token'>.</span><span class='null? fid id'>null?</span>

    <span class='res_p identifier id'>res_p</span><span class='dot token'>.</span><span class='free identifier id'>free</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>unpack_sockaddr_in</h3>
</div><div id="unpack_sockaddr_in-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>unpack_sockaddr_in</span><span class='args'>(sockaddr, reverse_lookup)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>ArgumentError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/socket.rb', line 424</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/socket.rb#L424">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">424
425
426
427
428
429
430</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='unpack_sockaddr_in identifier id'>unpack_sockaddr_in</span><span class='lparen token'>(</span><span class='sockaddr identifier id'>sockaddr</span><span class='comma token'>,</span> <span class='reverse_lookup identifier id'>reverse_lookup</span><span class='rparen token'>)</span>
  <span class='family identifier id'>family</span><span class='comma token'>,</span> <span class='port identifier id'>port</span><span class='comma token'>,</span> <span class='host identifier id'>host</span><span class='comma token'>,</span> <span class='ip identifier id'>ip</span> <span class='assign token'>=</span> <span class='getnameinfo identifier id'>getnameinfo</span> <span class='sockaddr identifier id'>sockaddr</span><span class='comma token'>,</span> <span class='reverse_lookup identifier id'>reverse_lookup</span>
  <span class='comment val'># On some systems this doesn't fail for families other than AF_INET(6)</span>
  <span class='comment val'># so we raise manually here.</span>
  <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>'not an AF_INET/AF_INET6 sockaddr'</span> <span class='unless unless_mod kw'>unless</span> <span class='family identifier id'>family</span> <span class='match op'>=~</span> <span class='regexp val'>/AF_INET/</span>
  <span class='return return kw'>return</span> <span class='host identifier id'>host</span><span class='comma token'>,</span> <span class='ip identifier id'>ip</span><span class='comma token'>,</span> <span class='port identifier id'>port</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>