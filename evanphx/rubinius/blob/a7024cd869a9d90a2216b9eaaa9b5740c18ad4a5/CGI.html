<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>evanphx's rubinius - Class: CGI - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/evanphx/commits/rubinius/master" rel="alternate" title="Recent Commits to rubinius:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("evanphx", "rubinius", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("evanphx", "rubinius", "a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/evanphx/rubinius/tree/">Source</a></li>
            <li class=""><a href="http://github.com/evanphx/rubinius/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/evanphx/rubinius/network">Network</a></li>            
            <li class=""><a href="http://github.com/evanphx/rubinius/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/evanphx/rubinius">Wiki</a></li>
            <li class=""><a href="http://github.com/evanphx/rubinius/graphs">Graphs</a></li>                    
            <li class="active"><a href="/evanphx/rubinius">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/evanphx">evanphx</a> / <b><a href="http://github.com/evanphx/rubinius/tree">rubinius</a></b>        
                <a id="namespaces_button" rel="evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class CGI">
  <h1>Class: CGI</h1>
  <div class="section mixins">
  <h2>Included Modules</h2>
  <p><a href="CGI/QueryExtension.html" title="CGI::QueryExtension">CGI::QueryExtension</a></p>
</div><div class="section docstring">
  <p>
CGI class. See documentation for the file cgi.rb for an overview of the CGI
protocol.
</p>
<h2>Introduction</h2>
<p>
CGI is a large class, providing several categories of methods, many of
which are mixed in from other modules. Some of the documentation is in this
class, some in the modules CGI::QueryExtension and CGI::HtmlExtension. See
CGI::Cookie for specific information on handling cookies, and
cgi/session.rb (CGI::Session) for information on sessions.
</p>
<p>
For queries, CGI provides methods to get at environmental variables,
parameters, cookies, and multipart request data. For responses, CGI
provides methods for writing output and generating HTML.
</p>
<p>
Read on for more details. Examples are provided at the bottom.
</p>
<h2>Queries</h2>
<p>
The CGI class dynamically mixes in parameter and cookie-parsing
functionality, environmental variable access, and support for parsing
multipart requests (including uploaded files) from the CGI::QueryExtension
module.
</p>
<h3>Environmental Variables</h3>
<p>
The standard CGI environmental variables are available as read-only
attributes of a CGI object. The following is a list of these variables:
</p>
<pre class="code">
  <span class='AUTH_TYPE constant id'>AUTH_TYPE</span>               <span class='HTTP_HOST constant id'>HTTP_HOST</span>          <span class='REMOTE_IDENT constant id'>REMOTE_IDENT</span>
  <span class='CONTENT_LENGTH constant id'>CONTENT_LENGTH</span>          <span class='HTTP_NEGOTIATE constant id'>HTTP_NEGOTIATE</span>     <span class='REMOTE_USER constant id'>REMOTE_USER</span>
  <span class='CONTENT_TYPE constant id'>CONTENT_TYPE</span>            <span class='HTTP_PRAGMA constant id'>HTTP_PRAGMA</span>        <span class='REQUEST_METHOD constant id'>REQUEST_METHOD</span>
  <span class='GATEWAY_INTERFACE constant id'>GATEWAY_INTERFACE</span>       <span class='HTTP_REFERER constant id'>HTTP_REFERER</span>       <span class='SCRIPT_NAME constant id'>SCRIPT_NAME</span>
  <span class='HTTP_ACCEPT constant id'>HTTP_ACCEPT</span>             <span class='HTTP_USER_AGENT constant id'>HTTP_USER_AGENT</span>    <span class='SERVER_NAME constant id'>SERVER_NAME</span>
  <span class='HTTP_ACCEPT_CHARSET constant id'>HTTP_ACCEPT_CHARSET</span>     <span class='PATH_INFO constant id'>PATH_INFO</span>          <span class='SERVER_PORT constant id'>SERVER_PORT</span>
  <span class='HTTP_ACCEPT_ENCODING constant id'>HTTP_ACCEPT_ENCODING</span>    <span class='PATH_TRANSLATED constant id'>PATH_TRANSLATED</span>    <span class='SERVER_PROTOCOL constant id'>SERVER_PROTOCOL</span>
  <span class='HTTP_ACCEPT_LANGUAGE constant id'>HTTP_ACCEPT_LANGUAGE</span>    <span class='QUERY_STRING constant id'>QUERY_STRING</span>       <span class='SERVER_SOFTWARE constant id'>SERVER_SOFTWARE</span>
  <span class='HTTP_CACHE_CONTROL constant id'>HTTP_CACHE_CONTROL</span>      <span class='REMOTE_ADDR constant id'>REMOTE_ADDR</span>
  <span class='HTTP_FROM constant id'>HTTP_FROM</span>               <span class='REMOTE_HOST constant id'>REMOTE_HOST</span>
</pre>
<p>
For each of these variables, there is a corresponding attribute with the
same name, except all lower case and without a preceding HTTP_.
<tt>content_length</tt> and <tt>server_port</tt> are integers; the rest are
strings.
</p>
<h3>Parameters</h3>
<p>
The method #params() returns a hash of all parameters in the request as
name/value-list pairs, where the value-list is an Array of one or more
values. The CGI object itself also behaves as a hash of parameter names to
values, but only returns a single value (as a String) for each parameter
name.
</p>
<p>
For instance, suppose the request contains the parameter
&quot;favourite_colours&quot; with the multiple values &quot;blue&quot; and
&quot;green&quot;. The following behaviour would occur:
</p>
<pre class="code">
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='string val'>&quot;favourite_colours&quot;</span><span class='rbrack token'>]</span>  <span class='comment val'># =&gt; [&quot;blue&quot;, &quot;green&quot;]</span>
  <span class='cgi identifier id'>cgi</span><span class='lbrack token'>[</span><span class='string val'>&quot;favourite_colours&quot;</span><span class='rbrack token'>]</span>         <span class='comment val'># =&gt; &quot;blue&quot;</span>
</pre>
<p>
If a parameter does not exist, the former method will return an empty
array, the latter an empty string. The simplest way to test for existence
of a parameter is by the #has_key? method.
</p>
<h3>Cookies</h3>
<p>
HTTP Cookies are automatically parsed from the request. They are available
from the #cookies() accessor, which returns a hash from cookie name to
CGI::Cookie object.
</p>
<h3>Multipart requests</h3>
<p>
If a request&#8217;s method is POST and its content type is
multipart/form-data, then it may contain uploaded files. These are stored
by the QueryExtension module in the parameters of the request. The
parameter name is the name attribute of the file input field, as usual.
However, the value is not a string, but an IO object, either an IOString
for small files, or a Tempfile for larger ones. This object also has the
additional singleton methods:
</p>
<table>
<tr><td valign="top">#local_path():</td><td>the path of the uploaded file on the local filesystem

</td></tr>
<tr><td valign="top">#original_filename():</td><td>the name of the file on the client computer

</td></tr>
<tr><td valign="top">#content_type():</td><td>the content type of the file

</td></tr>
</table>
<h2>Responses</h2>
<p>
The CGI class provides methods for sending header and content output to the
HTTP client, and mixes in methods for programmatic HTML generation from
CGI::HtmlExtension and CGI::TagMaker modules. The precise version of HTML
to use for HTML generation is specified at object creation time.
</p>
<h3>Writing output</h3>
<p>
The simplest way to send output to the HTTP client is using the #out()
method. This takes the HTTP headers as a hash parameter, and the body
content via a block. The headers can be generated as a string using the
#header() method. The output stream can be written directly to using the
#print() method.
</p>
<h3>Generating HTML</h3>
<p>
Each HTML element has a corresponding method for generating that element as
a String. The name of this method is the same as that of the element, all
lowercase. The attributes of the element are passed in as a hash, and the
body as a no-argument block that evaluates to a String. The HTML generation
module knows which elements are always empty, and silently drops any
passed-in body. It also knows which elements require matching closing tags
and which don&#8217;t. However, it does not know what attributes are legal
for which elements.
</p>
<p>
There are also some additional HTML generation methods mixed in from the
CGI::HtmlExtension module. These include individual methods for the
different types of form inputs, and methods for elements that commonly take
particular attributes where the attributes can be directly specified as
arguments, rather than via a hash.
</p>
<h2>Examples of use</h2>
<h3>Get form values</h3>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>&quot;cgi&quot;</span>
  <span class='cgi identifier id'>cgi</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='cgi identifier id'>cgi</span><span class='lbrack token'>[</span><span class='string val'>'field_name'</span><span class='rbrack token'>]</span>   <span class='comment val'># &lt;== value string for 'field_name'</span>
    <span class='comment val'># if not 'field_name' included, then return &quot;&quot;.</span>
  <span class='fields identifier id'>fields</span> <span class='assign token'>=</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span>            <span class='comment val'># &lt;== array of field names</span>

  <span class='comment val'># returns true if form has 'field_name'</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>'field_name'</span><span class='rparen token'>)</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>'field_name'</span><span class='rparen token'>)</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>'field_name'</span><span class='rparen token'>)</span>
</pre>
<p>
CAUTION! cgi[&#8216;field_name&#8217;] returned an Array with the old
cgi.rb(included in ruby 1.6)
</p>
<h3>Get form values as hash</h3>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>&quot;cgi&quot;</span>
  <span class='cgi identifier id'>cgi</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='params identifier id'>params</span>
</pre>
<p>
cgi.params is a hash.
</p>
<pre class="code">
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='string val'>'new_field_name'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>&quot;value&quot;</span><span class='rbrack token'>]</span>  <span class='comment val'># add new param</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='string val'>'field_name'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>&quot;new_value&quot;</span><span class='rbrack token'>]</span>  <span class='comment val'># change value</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='params identifier id'>params</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>'field_name'</span><span class='rparen token'>)</span>           <span class='comment val'># delete param</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='params identifier id'>params</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>                          <span class='comment val'># delete all params</span>
</pre>
<h3>Save form values to file</h3>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>&quot;pstore&quot;</span>
  <span class='db identifier id'>db</span> <span class='assign token'>=</span> <span class='PStore constant id'>PStore</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;query.db&quot;</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='transaction identifier id'>transaction</span> <span class='do do kw'>do</span>
    <span class='db identifier id'>db</span><span class='lbrack token'>[</span><span class='string val'>&quot;params&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='params identifier id'>params</span>
  <span class='end end kw'>end</span>
</pre>
<h3>Restore form values from file</h3>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>&quot;pstore&quot;</span>
  <span class='db identifier id'>db</span> <span class='assign token'>=</span> <span class='PStore constant id'>PStore</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;query.db&quot;</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='transaction identifier id'>transaction</span> <span class='do do kw'>do</span>
    <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='db identifier id'>db</span><span class='lbrack token'>[</span><span class='string val'>&quot;params&quot;</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
</pre>
<h3>Get multipart form values</h3>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>&quot;cgi&quot;</span>
  <span class='cgi identifier id'>cgi</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='cgi identifier id'>cgi</span><span class='lbrack token'>[</span><span class='string val'>'field_name'</span><span class='rbrack token'>]</span>   <span class='comment val'># &lt;== value string for 'field_name'</span>
  <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='read identifier id'>read</span>                  <span class='comment val'># &lt;== body of value</span>
  <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='local_path identifier id'>local_path</span>            <span class='comment val'># &lt;== path to local file of value</span>
  <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='original_filename identifier id'>original_filename</span>     <span class='comment val'># &lt;== original filename of value</span>
  <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='content_type identifier id'>content_type</span>          <span class='comment val'># &lt;== content_type of value</span>
</pre>
<p>
and value has StringIO or Tempfile class methods.
</p>
<h3>Get cookie values</h3>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>&quot;cgi&quot;</span>
  <span class='cgi identifier id'>cgi</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='values identifier id'>values</span> <span class='assign token'>=</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='cookies identifier id'>cookies</span><span class='lbrack token'>[</span><span class='string val'>'name'</span><span class='rbrack token'>]</span>  <span class='comment val'># &lt;== array of 'name'</span>
    <span class='comment val'># if not 'name' included, then return [].</span>
  <span class='names identifier id'>names</span> <span class='assign token'>=</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='cookies identifier id'>cookies</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span>      <span class='comment val'># &lt;== array of cookie names</span>
</pre>
<p>
and cgi.cookies is a hash.
</p>
<h3>Get cookie objects</h3>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>&quot;cgi&quot;</span>
  <span class='cgi identifier id'>cgi</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='for for kw'>for</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='cookie identifier id'>cookie</span> <span class='in in kw'>in</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='cookies identifier id'>cookies</span>
    <span class='cookie identifier id'>cookie</span><span class='dot token'>.</span><span class='expires identifier id'>expires</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span> <span class='plus op'>+</span> <span class='integer val'>30</span>
  <span class='end end kw'>end</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='out identifier id'>out</span><span class='lparen token'>(</span><span class='string val'>&quot;cookie&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='cookies identifier id'>cookies</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span><span class='string val'>&quot;string&quot;</span><span class='rbrace token'>}</span>

  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='cookies identifier id'>cookies</span> <span class='comment val'># { &quot;name1&quot; =&gt; cookie1, &quot;name2&quot; =&gt; cookie2, ... }</span>

  <span class='require identifier id'>require</span> <span class='string val'>&quot;cgi&quot;</span>
  <span class='cgi identifier id'>cgi</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='cookies identifier id'>cookies</span><span class='lbrack token'>[</span><span class='string val'>'name'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='expires identifier id'>expires</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span> <span class='plus op'>+</span> <span class='integer val'>30</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='out identifier id'>out</span><span class='lparen token'>(</span><span class='string val'>&quot;cookie&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='cookies identifier id'>cookies</span><span class='lbrack token'>[</span><span class='string val'>'name'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span><span class='string val'>&quot;string&quot;</span><span class='rbrace token'>}</span>
</pre>
<h3>Print http header and html string to $DEFAULT_OUTPUT ($&gt;)</h3>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>&quot;cgi&quot;</span>
  <span class='cgi identifier id'>cgi</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;html3&quot;</span><span class='rparen token'>)</span>  <span class='comment val'># add HTML generation methods</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='out identifier id'>out</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='html identifier id'>html</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
      <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='head identifier id'>head</span><span class='lbrace token'>{</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='title identifier id'>title</span><span class='lbrace token'>{</span><span class='string val'>&quot;TITLE&quot;</span><span class='rbrace token'>}</span> <span class='rbrace token'>}</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span>
      <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='body identifier id'>body</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
        <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='form identifier id'>form</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
          <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='textarea identifier id'>textarea</span><span class='lparen token'>(</span><span class='string val'>&quot;get_text&quot;</span><span class='rparen token'>)</span> <span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;
          cgi.br &lt;tt&gt;
          cgi.submit
        end &lt;/</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span>
        <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='pre identifier id'>pre</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
          <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeHTML identifier id'>escapeHTML</span><span class='lparen token'>(</span>
            <span class='string val'>&quot;params: &quot;</span> <span class='plus op'>+</span> <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='params identifier id'>params</span><span class='dot token'>.</span><span class='inspect identifier id'>inspect</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span>
            <span class='string val'>&quot;cookies: &quot;</span> <span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt; cgi.cookies.inspect + &quot;\n&quot; &lt;tt&gt;
            ENV.collect() do |key, value|
              key &lt;/</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span> <span class='string val'>&quot; --&gt; &quot;</span> <span class='plus op'>+</span> <span class='value identifier id'>value</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span>
            <span class='end end kw'>end</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span>
          <span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># add HTML generation methods</span>
  <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;html3&quot;</span><span class='rparen token'>)</span>    <span class='comment val'># html3.2</span>
  <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;html4&quot;</span><span class='rparen token'>)</span>    <span class='comment val'># html4.01 (Strict)</span>
  <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;html4Tr&quot;</span><span class='rparen token'>)</span>  <span class='comment val'># html4.01 Transitional</span>
  <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;html4Fr&quot;</span><span class='rparen token'>)</span>  <span class='comment val'># html4.01 Frameset</span>
</pre>

</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="CR-constant">CR</dt>
      <dd>&quot;\015&quot;</dd>
    
      <dt id="EOL-constant">EOL</dt>
      <dd>CR + LF</dd>
    
      <dt id="HTTP_STATUS-constant">HTTP_STATUS</dt>
      <dd>{
  &quot;OK&quot;                  =&gt; &quot;200 OK&quot;,
  &quot;PARTIAL_CONTENT&quot;     =&gt; &quot;206 Partial Content&quot;,
  &quot;MULTIPLE_CHOICES&quot;    =&gt; &quot;300 Multiple Choices&quot;,
  &quot;MOVED&quot;               =&gt; &quot;301 Moved Permanently&quot;,
  &quot;REDIRECT&quot;            =&gt; &quot;302 Found&quot;,
  &quot;NOT_MODIFIED&quot;        =&gt; &quot;304 Not Modified&quot;,
  &quot;BAD_REQUEST&quot;         =&gt; &quot;400 Bad Request&quot;,
  &quot;AUTH_REQUIRED&quot;       =&gt; &quot;401 Authorization Required&quot;,
  &quot;FORBIDDEN&quot;           =&gt; &quot;403 Forbidden&quot;,
  &quot;NOT_FOUND&quot;           =&gt; &quot;404 Not Found&quot;,
  &quot;METHOD_NOT_ALLOWED&quot;  =&gt; &quot;405 Method Not Allowed&quot;,
  &quot;NOT_ACCEPTABLE&quot;      =&gt; &quot;406 Not Acceptable&quot;,
  &quot;LENGTH_REQUIRED&quot;     =&gt; &quot;411 Length Required&quot;,
  &quot;PRECONDITION_FAILED&quot; =&gt; &quot;412 Rrecondition Failed&quot;,
  &quot;SERVER_ERROR&quot;        =&gt; &quot;500 Internal Server Error&quot;,
  &quot;NOT_IMPLEMENTED&quot;     =&gt; &quot;501 Method Not Implemented&quot;,
  &quot;BAD_GATEWAY&quot;         =&gt; &quot;502 Bad Gateway&quot;,
  &quot;VARIANT_ALSO_VARIES&quot; =&gt; &quot;506 Variant Also Negotiates&quot;
}</dd>
    
      <dt id="LF-constant">LF</dt>
      <dd>&quot;\012&quot;</dd>
    
      <dt id="NEEDS_BINMODE-constant">NEEDS_BINMODE</dt>
      <dd>true if /WIN/ni.match(RUBY_PLATFORM) </dd>
    
      <dt id="PATH_SEPARATOR-constant">PATH_SEPARATOR</dt>
      <dd>{'UNIX'=&gt;'/', 'WINDOWS'=&gt;'\\', 'MACINTOSH'=&gt;':'}</dd>
    
      <dt id="REVISION-constant">REVISION</dt>
      <dd>'$Id: cgi.rb 12050 2007-03-12 17:55:03Z knu $' </dd>
    
      <dt id="RFC822_DAYS-constant">RFC822_DAYS</dt>
      <dd>%w[ Sun Mon Tue Wed Thu Fri Sat ]</dd>
    
      <dt id="RFC822_MONTHS-constant">RFC822_MONTHS</dt>
      <dd>%w[ Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ]</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(type = &quot;query&quot;)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Creates a new CGI instance.
</p>
<p>
<tt>type</tt> specifies which version of HTML to load the HTML generation
methods for. The following versions of HTML are supported:
</p>
<table>
<tr><td valign="top">html3:</td><td>HTML 3.x

</td></tr>
<tr><td valign="top">html4:</td><td>HTML 4.0

</td></tr>
<tr><td valign="top">html4Tr:</td><td>HTML 4.0 Transitional

</td></tr>
<tr><td valign="top">html4Fr:</td><td>HTML 4.0 with Framesets

</td></tr>
</table>
<p>
If not specified, no HTML generation methods will be loaded.
</p>
<p>
If the CGI object is not created in a standard CGI call environment (that
is, it can&#8217;t locate REQUEST_METHOD in its environment), then it will
run in &quot;offline&quot; mode. In this mode, it reads its parameters from
the command line or (failing that) from standard input. Otherwise, cookies
and other parameters are parsed automatically from the standard CGI
locations, which varies according to the REQUEST_METHOD.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 2294</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L2294">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">2294
2295
2296
2297
2298
2299
2300
2301
2302
2303
2304
2305
2306
2307
2308
2309
2310
2311
2312
2313
2314
2315
2316
2317
2318
2319
2320
2321
2322
2323
2324
2325
2326
2327
2328
2329
2330
2331</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='string val'>&quot;query&quot;</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='MOD_RUBY constant id'>MOD_RUBY</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='ENV constant id'>ENV</span><span class='dot token'>.</span><span class='key? fid id'>key?</span><span class='lparen token'>(</span><span class='string val'>&quot;GATEWAY_INTERFACE&quot;</span><span class='rparen token'>)</span>
    <span class='Apache constant id'>Apache</span><span class='dot token'>.</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='setup_cgi_env identifier id'>setup_cgi_env</span>
  <span class='end end kw'>end</span>

  <span class='extend identifier id'>extend</span> <span class='QueryExtension constant id'>QueryExtension</span>
  <span class='@multipart ivar id'>@multipart</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='if if kw'>if</span> <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='CGI_PARAMS constant id'>CGI_PARAMS</span><span class='rparen token'>)</span>
    <span class='warn identifier id'>warn</span> <span class='string val'>&quot;do not use CGI_PARAMS and CGI_COOKIES&quot;</span>
    <span class='@params ivar id'>@params</span> <span class='assign token'>=</span> <span class='CGI_PARAMS constant id'>CGI_PARAMS</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='@cookies ivar id'>@cookies</span> <span class='assign token'>=</span> <span class='CGI_COOKIES constant id'>CGI_COOKIES</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='else else kw'>else</span>
    <span class='initialize_query identifier id'>initialize_query</span><span class='lparen token'>(</span><span class='rparen token'>)</span>  <span class='comment val'># set @params, @cookies</span>
  <span class='end end kw'>end</span>
  <span class='@output_cookies ivar id'>@output_cookies</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='@output_hidden ivar id'>@output_hidden</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

  <span class='case case kw'>case</span> <span class='type identifier id'>type</span>
  <span class='when when kw'>when</span> <span class='string val'>&quot;html3&quot;</span>
    <span class='extend identifier id'>extend</span> <span class='Html3 constant id'>Html3</span>
    <span class='element_init identifier id'>element_init</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
    <span class='extend identifier id'>extend</span> <span class='HtmlExtension constant id'>HtmlExtension</span>
  <span class='when when kw'>when</span> <span class='string val'>&quot;html4&quot;</span>
    <span class='extend identifier id'>extend</span> <span class='Html4 constant id'>Html4</span>
    <span class='element_init identifier id'>element_init</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
    <span class='extend identifier id'>extend</span> <span class='HtmlExtension constant id'>HtmlExtension</span>
  <span class='when when kw'>when</span> <span class='string val'>&quot;html4Tr&quot;</span>
    <span class='extend identifier id'>extend</span> <span class='Html4Tr constant id'>Html4Tr</span>
    <span class='element_init identifier id'>element_init</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
    <span class='extend identifier id'>extend</span> <span class='HtmlExtension constant id'>HtmlExtension</span>
  <span class='when when kw'>when</span> <span class='string val'>&quot;html4Fr&quot;</span>
    <span class='extend identifier id'>extend</span> <span class='Html4Tr constant id'>Html4Tr</span>
    <span class='element_init identifier id'>element_init</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
    <span class='extend identifier id'>extend</span> <span class='Html4Fr constant id'>Html4Fr</span>
    <span class='element_init identifier id'>element_init</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
    <span class='extend identifier id'>extend</span> <span class='HtmlExtension constant id'>HtmlExtension</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#escape-class_method">escape</span><span class='args'>(string)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
URL-encode a string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#escapeElement-class_method">escapeElement</span><span class='args'>(string, *elements)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Escape only the tags of certain HTML elements in <tt>string</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#escapeHTML-class_method">escapeHTML</span><span class='args'>(string)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Escape special characters in HTML, namely &amp;\&quot;&lt;&gt;
</p>
<pre class="code">
  <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeHTML identifier id'>escapeHTML</span><span class='lparen token'>(</span><span class='string val'>'Usage: foo &quot;bar&quot; &lt;baz&gt;'</span><span class='rparen token'>)</span>
     <span class='comment val'># =&gt; &quot;Usage: foo &amp;quot;bar&amp;quot; &amp;lt;baz&amp;gt;&quot;.</span>
</pre>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#parse-class_method">parse</span><span class='args'>(query)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Parse an HTTP query string into a hash of key=&gt;value pairs.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pretty-class_method">pretty</span><span class='args'>(string, shift = &quot;  &quot;)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Prettify (indent) an HTML string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#rfc1123_date-class_method">rfc1123_date</span><span class='args'>(time)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Format a <tt>Time</tt> object as a String using the format specified by RFC
1123.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#unescape-class_method">unescape</span><span class='args'>(string)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
URL-decode a string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#unescapeElement-class_method">unescapeElement</span><span class='args'>(string, *elements)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Undo escaping such as that done by CGI::escapeElement().
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#unescapeHTML-class_method">unescapeHTML</span><span class='args'>(string)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Unescape a string that has been HTML-escaped
</p>
<pre class="code">
  <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescapeHTML identifier id'>unescapeHTML</span><span class='lparen token'>(</span><span class='string val'>&quot;Usage: foo &amp;quot;bar&amp;quot; &amp;lt;baz&amp;gt;&quot;</span><span class='rparen token'>)</span>
     <span class='comment val'># =&gt; &quot;Usage: foo \&quot;bar\&quot; &lt;baz&gt;&quot;.</span>
</pre>

        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h2>Public Class Methods Included from <a href="CGI/QueryExtension.html" title="CGI::QueryExtension">CGI::QueryExtension</a></h2>
    <p><span class='name'><a href="CGI/QueryExtension.html#%5B%5D-instance_method" title="[]">[]</a></span>, <span class='name'><a href="CGI/QueryExtension.html#has_key%3F-instance_method" title="has_key?">has_key?</a></span>, <span class='name'><a href="CGI/QueryExtension.html#keys-instance_method" title="keys">keys</a></span>, <span class='name'><a href="CGI/QueryExtension.html#multipart%3F-instance_method" title="multipart?">multipart?</a></span>, <span class='name'><a href="CGI/QueryExtension.html#params%3D-instance_method" title="params=">params=</a></span>, <span class='name'><a href="CGI/QueryExtension.html#raw_cookie-instance_method" title="raw_cookie">raw_cookie</a></span>, <span class='name'><a href="CGI/QueryExtension.html#raw_cookie2-instance_method" title="raw_cookie2">raw_cookie2</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#header-instance_method">#header</span><span class='args'>(options = &quot;text/html&quot;)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create an HTTP header block as a string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#out-instance_method">#out</span><span class='args'>(options = &quot;text/html&quot;)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Print an HTTP header and body to $DEFAULT_OUTPUT ($&gt;).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#print-instance_method">#print</span><span class='args'>(*options)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Print an argument or list of arguments to the default output stream.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>escape</h3>
</div><div id="escape-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>escape</span><span class='args'>(string)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
URL-encode a string.
</p>
<pre class="code">
  <span class='url_encoded_string identifier id'>url_encoded_string</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escape identifier id'>escape</span><span class='lparen token'>(</span><span class='string val'>&quot;'Stop!' said Fred&quot;</span><span class='rparen token'>)</span>
     <span class='comment val'># =&gt; &quot;%27Stop%21%27&lt;tt&gt;said&lt;/tt&gt;Fred&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 341</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L341">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">341
342
343
344
345</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escape identifier id'>escape</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='rparen token'>)</span>
  <span class='string identifier id'>string</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/([^ a-zA-Z0-9_.-]+)/n</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='string val'>'%'</span> <span class='plus op'>+</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='unpack identifier id'>unpack</span><span class='lparen token'>(</span><span class='string val'>'H2'</span> <span class='mult op'>*</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'%'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='upcase identifier id'>upcase</span>
  <span class='end end kw'>end</span><span class='dot token'>.</span><span class='tr identifier id'>tr</span><span class='lparen token'>(</span><span class='string val'>' '</span><span class='comma token'>,</span> <span class='string val'>'+'</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>escapeElement</h3>
</div><div id="escapeElement-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>escapeElement</span><span class='args'>(string, *elements)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Escape only the tags of certain HTML elements in <tt>string</tt>.
</p>
<p>
Takes an element or elements or array of elements. Each element is
specified by the name of the element, without angle brackets. This matches
both the start and the end tag of that element. The attribute list of the
open tag will also be escaped (for instance, the double-quotes surrounding
attribute values).
</p>
<pre class="code">
  <span class='print identifier id'>print</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeElement identifier id'>escapeElement</span><span class='lparen token'>(</span><span class='string val'>'&lt;BR&gt;&lt;A HREF=&quot;url&quot;&gt;&lt;/A&gt;'</span><span class='comma token'>,</span> <span class='string val'>&quot;A&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;IMG&quot;</span><span class='rparen token'>)</span>
    <span class='comment val'># &quot;&lt;BR&gt;&amp;lt;A HREF=&amp;quot;url&amp;quot;&amp;gt;&amp;lt;/A&amp;gt&quot;</span>

  <span class='print identifier id'>print</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeElement identifier id'>escapeElement</span><span class='lparen token'>(</span><span class='string val'>'&lt;BR&gt;&lt;A HREF=&quot;url&quot;&gt;&lt;/A&gt;'</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>&quot;A&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;IMG&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='comment val'># &quot;&lt;BR&gt;&amp;lt;A HREF=&amp;quot;url&amp;quot;&amp;gt;&amp;lt;/A&amp;gt&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 417</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L417">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">417
418
419
420
421
422
423
424
425
426</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeElement identifier id'>escapeElement</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='elements identifier id'>elements</span><span class='rparen token'>)</span>
  <span class='elements identifier id'>elements</span> <span class='assign token'>=</span> <span class='elements identifier id'>elements</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='elements identifier id'>elements</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='elements identifier id'>elements</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='string identifier id'>string</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='dregexp node'>/&lt;\/?(?:#{elements.join(&quot;|&quot;)})(?!\w)(?:.|\n)*?&gt;/n</span><span class='i identifier id'>i</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
      <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeHTML identifier id'>escapeHTML</span><span class='lparen token'>(</span><span class='$&amp; back_ref id'>$&amp;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='string identifier id'>string</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>escapeHTML</h3>
</div><div id="escapeHTML-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>escapeHTML</span><span class='args'>(string)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Escape special characters in HTML, namely &amp;\&quot;&lt;&gt;
</p>
<pre class="code">
  <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeHTML identifier id'>escapeHTML</span><span class='lparen token'>(</span><span class='string val'>'Usage: foo &quot;bar&quot; &lt;baz&gt;'</span><span class='rparen token'>)</span>
     <span class='comment val'># =&gt; &quot;Usage: foo &amp;quot;bar&amp;quot; &amp;lt;baz&amp;gt;&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 361</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L361">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">361
362
363</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeHTML identifier id'>escapeHTML</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='rparen token'>)</span>
  <span class='string identifier id'>string</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/&amp;/n</span><span class='comma token'>,</span> <span class='string val'>'&amp;amp;'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/\&quot;/n</span><span class='comma token'>,</span> <span class='string val'>'&amp;quot;'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/&gt;/n</span><span class='comma token'>,</span> <span class='string val'>'&amp;gt;'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/&lt;/n</span><span class='comma token'>,</span> <span class='string val'>'&amp;lt;'</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>parse</h3>
</div><div id="parse-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>parse</span><span class='args'>(query)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Parse an HTTP query string into a hash of key=&gt;value pairs.
</p>
<pre class="code">
  <span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='string val'>&quot;query_string&quot;</span><span class='rparen token'>)</span>
    <span class='comment val'># {&quot;name1&quot; =&gt; [&quot;value1&quot;, &quot;value2&quot;, ...],</span>
    <span class='comment val'>#  &quot;name2&quot; =&gt; [&quot;value1&quot;, &quot;value2&quot;, ...], ... }</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 895</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L895">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">895
896
897
898
899
900
901
902
903
904
905
906
907
908</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='query identifier id'>query</span><span class='rparen token'>)</span>
  <span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='Hash constant id'>Hash</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='freeze identifier id'>freeze</span><span class='rparen token'>)</span>

  <span class='query identifier id'>query</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/[&amp;;]/n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pairs identifier id'>pairs</span><span class='bitor op'>|</span>
    <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='pairs identifier id'>pairs</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'='</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescape identifier id'>unescape</span><span class='lparen token'>(</span><span class='v identifier id'>v</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='if if kw'>if</span> <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='rparen token'>)</span>
      <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='value identifier id'>value</span><span class='rbrack token'>]</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='params identifier id'>params</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pretty</h3>
</div><div id="pretty-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pretty</span><span class='args'>(string, shift = &quot;  &quot;)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Prettify (indent) an HTML string.
</p>
<p>
<tt>string</tt> is the HTML string to indent. <tt>shift</tt> is the
indentation unit to use; it defaults to two spaces.
</p>
<pre class="code">
  <span class='print identifier id'>print</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='pretty identifier id'>pretty</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;HTML&gt;&lt;BODY&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='comment val'># &lt;HTML&gt;</span>
    <span class='comment val'>#   &lt;BODY&gt;</span>
    <span class='comment val'>#   &lt;/BODY&gt;</span>
    <span class='comment val'># &lt;/HTML&gt;</span>

  <span class='print identifier id'>print</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='pretty identifier id'>pretty</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;HTML&gt;&lt;BODY&gt;&lt;/BODY&gt;&lt;/HTML&gt;&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;\t&quot;</span><span class='rparen token'>)</span>
    <span class='comment val'># &lt;HTML&gt;</span>
    <span class='comment val'>#         &lt;BODY&gt;</span>
    <span class='comment val'>#         &lt;/BODY&gt;</span>
    <span class='comment val'># &lt;/HTML&gt;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 1215</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L1215">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1215
1216
1217
1218
1219
1220
1221
1222
1223
1224</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='pretty identifier id'>pretty</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='comma token'>,</span> <span class='shift identifier id'>shift</span> <span class='assign token'>=</span> <span class='string val'>&quot;  &quot;</span><span class='rparen token'>)</span>
  <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='string identifier id'>string</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/(?!\A)&lt;(?:.|\n)*?&gt;/n</span><span class='comma token'>,</span> <span class='string val'>&quot;\n\\0&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/&lt;(?:.|\n)*?&gt;(?!\n)/n</span><span class='comma token'>,</span> <span class='string val'>&quot;\\0\n&quot;</span><span class='rparen token'>)</span>
  <span class='end_pos identifier id'>end_pos</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='while while kw'>while</span> <span class='end_pos identifier id'>end_pos</span> <span class='assign token'>=</span> <span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='index identifier id'>index</span><span class='lparen token'>(</span><span class='regexp val'>/^&lt;\/(\w+)/n</span><span class='comma token'>,</span> <span class='end_pos identifier id'>end_pos</span><span class='rparen token'>)</span>
    <span class='element identifier id'>element</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='start_pos identifier id'>start_pos</span> <span class='assign token'>=</span> <span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='rindex identifier id'>rindex</span><span class='lparen token'>(</span><span class='dregexp node'>/^\s*&lt;#{element}/n</span><span class='i identifier id'>i</span><span class='comma token'>,</span> <span class='end_pos identifier id'>end_pos</span><span class='rparen token'>)</span>
    <span class='lines identifier id'>lines</span><span class='lbrack token'>[</span><span class='start_pos identifier id'>start_pos</span> <span class='dot3 op'>...</span> <span class='end_pos identifier id'>end_pos</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;__&quot;</span> <span class='plus op'>+</span> <span class='lines identifier id'>lines</span><span class='lbrack token'>[</span><span class='start_pos identifier id'>start_pos</span> <span class='dot3 op'>...</span> <span class='end_pos identifier id'>end_pos</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/\n(?!\z)/n</span><span class='comma token'>,</span> <span class='string val'>&quot;\n&quot;</span> <span class='plus op'>+</span> <span class='shift identifier id'>shift</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>&quot;__&quot;</span>
  <span class='end end kw'>end</span>
  <span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='dregexp node'>/^((?:#{Regexp::quote(shift)})*)__(?=&lt;\/?\w)/n</span><span class='comma token'>,</span> <span class='string val'>'\1'</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rfc1123_date</h3>
</div><div id="rfc1123_date-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rfc1123_date</span><span class='args'>(time)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Format a <tt>Time</tt> object as a String using the format specified by RFC
1123.
</p>
<pre class="code">
  <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='rfc1123_date identifier id'>rfc1123_date</span><span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='rparen token'>)</span>
    <span class='comment val'># Sat, 01 Jan 2000 00:00:00 GMT</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 454</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L454">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">454
455
456
457
458
459</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='rfc1123_date identifier id'>rfc1123_date</span><span class='lparen token'>(</span><span class='time identifier id'>time</span><span class='rparen token'>)</span>
  <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='time identifier id'>time</span><span class='dot token'>.</span><span class='clone identifier id'>clone</span><span class='dot token'>.</span><span class='gmtime identifier id'>gmtime</span>
  <span class='return return kw'>return</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>&quot;%s, %.2d %s %.4d %.2d:%.2d:%.2d GMT&quot;</span><span class='comma token'>,</span>
              <span class='RFC822_DAYS constant id'>RFC822_DAYS</span><span class='lbrack token'>[</span><span class='t identifier id'>t</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='day identifier id'>day</span><span class='comma token'>,</span> <span class='RFC822_MONTHS constant id'>RFC822_MONTHS</span><span class='lbrack token'>[</span><span class='t identifier id'>t</span><span class='dot token'>.</span><span class='month identifier id'>month</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='year identifier id'>year</span><span class='comma token'>,</span>
              <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span><span class='comma token'>,</span> <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>unescape</h3>
</div><div id="unescape-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>unescape</span><span class='args'>(string)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
URL-decode a string.
</p>
<pre class="code">
  <span class='string identifier id'>string</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescape identifier id'>unescape</span><span class='lparen token'>(</span><span class='string val'>&quot;%27Stop%21%27&lt;tt&gt;said&lt;/tt&gt;Fred&quot;</span><span class='rparen token'>)</span>
     <span class='comment val'># =&gt; &quot;'Stop!' said Fred&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 351</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L351">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">351
352
353
354
355</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescape identifier id'>unescape</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='rparen token'>)</span>
  <span class='string identifier id'>string</span><span class='dot token'>.</span><span class='tr identifier id'>tr</span><span class='lparen token'>(</span><span class='string val'>'+'</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/((?:%[0-9a-fA-F]{2})+)/n</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>'%'</span><span class='rparen token'>)</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='pack identifier id'>pack</span><span class='lparen token'>(</span><span class='string val'>'H*'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>unescapeElement</h3>
</div><div id="unescapeElement-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>unescapeElement</span><span class='args'>(string, *elements)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Undo escaping such as that done by CGI::escapeElement()
</p>
<pre class="code">
  <span class='print identifier id'>print</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescapeElement identifier id'>unescapeElement</span><span class='lparen token'>(</span>
          <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeHTML identifier id'>escapeHTML</span><span class='lparen token'>(</span><span class='string val'>'&lt;BR&gt;&lt;A HREF=&quot;url&quot;&gt;&lt;/A&gt;'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>&quot;A&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;IMG&quot;</span><span class='rparen token'>)</span>
    <span class='comment val'># &quot;&amp;lt;BR&amp;gt;&lt;A HREF=&quot;url&quot;&gt;&lt;/A&gt;&quot;</span>

  <span class='print identifier id'>print</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescapeElement identifier id'>unescapeElement</span><span class='lparen token'>(</span>
          <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escapeHTML identifier id'>escapeHTML</span><span class='lparen token'>(</span><span class='string val'>'&lt;BR&gt;&lt;A HREF=&quot;url&quot;&gt;&lt;/A&gt;'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>&quot;A&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;IMG&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='comment val'># &quot;&amp;lt;BR&amp;gt;&lt;A HREF=&quot;url&quot;&gt;&lt;/A&gt;&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 438</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L438">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">438
439
440
441
442
443
444
445
446
447</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescapeElement identifier id'>unescapeElement</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='elements identifier id'>elements</span><span class='rparen token'>)</span>
  <span class='elements identifier id'>elements</span> <span class='assign token'>=</span> <span class='elements identifier id'>elements</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='elements identifier id'>elements</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='elements identifier id'>elements</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='string identifier id'>string</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='dregexp node'>/&amp;lt;\/?(?:#{elements.join(&quot;|&quot;)})(?!\w)(?:.|\n)*?&amp;gt;/n</span><span class='i identifier id'>i</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
      <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescapeHTML identifier id'>unescapeHTML</span><span class='lparen token'>(</span><span class='$&amp; back_ref id'>$&amp;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='string identifier id'>string</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>unescapeHTML</h3>
</div><div id="unescapeHTML-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>unescapeHTML</span><span class='args'>(string)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Unescape a string that has been HTML-escaped
</p>
<pre class="code">
  <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescapeHTML identifier id'>unescapeHTML</span><span class='lparen token'>(</span><span class='string val'>&quot;Usage: foo &amp;quot;bar&amp;quot; &amp;lt;baz&amp;gt;&quot;</span><span class='rparen token'>)</span>
     <span class='comment val'># =&gt; &quot;Usage: foo \&quot;bar\&quot; &lt;baz&gt;&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 369</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L369">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='unescapeHTML identifier id'>unescapeHTML</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='rparen token'>)</span>
  <span class='string identifier id'>string</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/&amp;(amp|quot|gt|lt|\#[0-9]+|\#x[0-9A-Fa-f]+);/n</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='match identifier id'>match</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='case case kw'>case</span> <span class='match identifier id'>match</span>
    <span class='when when kw'>when</span> <span class='string val'>'amp'</span>                 <span class='then then kw'>then</span> <span class='string val'>'&amp;'</span>
    <span class='when when kw'>when</span> <span class='string val'>'quot'</span>                <span class='then then kw'>then</span> <span class='string val'>'&quot;'</span>
    <span class='when when kw'>when</span> <span class='string val'>'gt'</span>                  <span class='then then kw'>then</span> <span class='string val'>'&gt;'</span>
    <span class='when when kw'>when</span> <span class='string val'>'lt'</span>                  <span class='then then kw'>then</span> <span class='string val'>'&lt;'</span>
    <span class='when when kw'>when</span> <span class='regexp val'>/\A#0*(\d+)\z/n</span>       <span class='then then kw'>then</span>
      <span class='if if kw'>if</span> <span class='Integer constant id'>Integer</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span> <span class='lt op'>&lt;</span> <span class='integer val'>256</span>
        <span class='Integer constant id'>Integer</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='chr identifier id'>chr</span>
      <span class='else else kw'>else</span>
        <span class='if if kw'>if</span> <span class='Integer constant id'>Integer</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span> <span class='lt op'>&lt;</span> <span class='integer val'>65536</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='$KCODE gvar id'>$KCODE</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>?u</span> <span class='or or kw'>or</span> <span class='$KCODE gvar id'>$KCODE</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>?U</span><span class='rparen token'>)</span>
          <span class='lbrack token'>[</span><span class='Integer constant id'>Integer</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='pack identifier id'>pack</span><span class='lparen token'>(</span><span class='string val'>&quot;U&quot;</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
          <span class='dstring node'>&quot;&amp;##{$1};&quot;</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='regexp val'>/\A#x([0-9a-f]+)\z/n</span><span class='i identifier id'>i</span> <span class='then then kw'>then</span>
      <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='hex identifier id'>hex</span> <span class='lt op'>&lt;</span> <span class='integer val'>256</span>
        <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='hex identifier id'>hex</span><span class='dot token'>.</span><span class='chr identifier id'>chr</span>
      <span class='else else kw'>else</span>
        <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='hex identifier id'>hex</span> <span class='lt op'>&lt;</span> <span class='integer val'>65536</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='$KCODE gvar id'>$KCODE</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>?u</span> <span class='or or kw'>or</span> <span class='$KCODE gvar id'>$KCODE</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>?U</span><span class='rparen token'>)</span>
          <span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='hex identifier id'>hex</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='pack identifier id'>pack</span><span class='lparen token'>(</span><span class='string val'>&quot;U&quot;</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
          <span class='dstring node'>&quot;&amp;#x#{$1};&quot;</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='dstring node'>&quot;&amp;#{match};&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>header</h3>
</div><div id="header-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>header</span><span class='args'>(options = &quot;text/html&quot;)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create an HTTP header block as a string.
</p>
<p>
Includes the empty line that ends the header block.
</p>
<p>
<tt>options</tt> can be a string specifying the Content-Type (defaults to
text/html), or a hash of header key/value pairs. The following header keys
are recognized:
</p>
<table>
<tr><td valign="top">type:</td><td>the Content-Type header. Defaults to &quot;text/html&quot;

</td></tr>
<tr><td valign="top">charset:</td><td>the charset of the body, appended to the Content-Type header.

</td></tr>
<tr><td valign="top">nph:</td><td>a boolean value. If true, prepend protocol string and status code, and
date; and sets default values for &quot;server&quot; and
&quot;connection&quot; if not explicitly set.

</td></tr>
<tr><td valign="top">status:</td><td>the HTTP status code, returned as the Status header. See the list of
available status codes below.

</td></tr>
<tr><td valign="top">server:</td><td>the server software, returned as the Server header.

</td></tr>
<tr><td valign="top">connection:</td><td>the connection type, returned as the Connection header (for instance,
&quot;close&quot;.

</td></tr>
<tr><td valign="top">length:</td><td>the length of the content that will be sent, returned as the Content-Length
header.

</td></tr>
<tr><td valign="top">language:</td><td>the language of the content, returned as the Content-Language header.

</td></tr>
<tr><td valign="top">expires:</td><td>the time on which the current content expires, as a <tt>Time</tt> object,
returned as the Expires header.

</td></tr>
<tr><td valign="top">cookie:</td><td>a cookie or cookies, returned as one or more Set-Cookie headers. The value
can be the literal string of the cookie; a CGI::Cookie object; an Array of
literal cookie strings or Cookie objects; or a hash all of whose values are
literal cookie strings or Cookie objects. These cookies are in addition to
the cookies held in the @output_cookies field.

</td></tr>
</table>
<p>
Other header lines can also be set; they are appended as key: value.
</p>
<pre class="code">
  <span class='header identifier id'>header</span>
    <span class='comment val'># Content-Type: text/html</span>

  <span class='header identifier id'>header</span><span class='lparen token'>(</span><span class='string val'>&quot;text/plain&quot;</span><span class='rparen token'>)</span>
    <span class='comment val'># Content-Type: text/plain</span>

  <span class='header identifier id'>header</span><span class='lparen token'>(</span><span class='string val'>&quot;nph&quot;</span>        <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span>
         <span class='string val'>&quot;status&quot;</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;OK&quot;</span><span class='comma token'>,</span>  <span class='comment val'># == &quot;200 OK&quot;</span>
           <span class='comment val'># &quot;status&quot;     =&gt; &quot;200 GOOD&quot;,</span>
         <span class='string val'>&quot;server&quot;</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'SERVER_SOFTWARE'</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
         <span class='string val'>&quot;connection&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;close&quot;</span><span class='comma token'>,</span>
         <span class='string val'>&quot;type&quot;</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;text/html&quot;</span><span class='comma token'>,</span>
         <span class='string val'>&quot;charset&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;iso-2022-jp&quot;</span><span class='comma token'>,</span>
           <span class='comment val'># Content-Type: text/html; charset=iso-2022-jp</span>
         <span class='string val'>&quot;length&quot;</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>103</span><span class='comma token'>,</span>
         <span class='string val'>&quot;language&quot;</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;ja&quot;</span><span class='comma token'>,</span>
         <span class='string val'>&quot;expires&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span> <span class='plus op'>+</span> <span class='integer val'>30</span><span class='comma token'>,</span>
         <span class='string val'>&quot;cookie&quot;</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='cookie1 identifier id'>cookie1</span><span class='comma token'>,</span> <span class='cookie2 identifier id'>cookie2</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
         <span class='string val'>&quot;my_header1&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;my_value&quot;</span>
         <span class='string val'>&quot;my_header2&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;my_value&quot;</span><span class='rparen token'>)</span>
</pre>
<p>
The status codes are:
</p>
<pre class="code">
  <span class='string val'>&quot;OK&quot;</span>                  <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;200 OK&quot;</span>
  <span class='string val'>&quot;PARTIAL_CONTENT&quot;</span>     <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;206 Partial Content&quot;</span>
  <span class='string val'>&quot;MULTIPLE_CHOICES&quot;</span>    <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;300 Multiple Choices&quot;</span>
  <span class='string val'>&quot;MOVED&quot;</span>               <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;301 Moved Permanently&quot;</span>
  <span class='string val'>&quot;REDIRECT&quot;</span>            <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;302 Found&quot;</span>
  <span class='string val'>&quot;NOT_MODIFIED&quot;</span>        <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;304 Not Modified&quot;</span>
  <span class='string val'>&quot;BAD_REQUEST&quot;</span>         <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;400 Bad Request&quot;</span>
  <span class='string val'>&quot;AUTH_REQUIRED&quot;</span>       <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;401 Authorization Required&quot;</span>
  <span class='string val'>&quot;FORBIDDEN&quot;</span>           <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;403 Forbidden&quot;</span>
  <span class='string val'>&quot;NOT_FOUND&quot;</span>           <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;404 Not Found&quot;</span>
  <span class='string val'>&quot;METHOD_NOT_ALLOWED&quot;</span>  <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;405 Method Not Allowed&quot;</span>
  <span class='string val'>&quot;NOT_ACCEPTABLE&quot;</span>      <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;406 Not Acceptable&quot;</span>
  <span class='string val'>&quot;LENGTH_REQUIRED&quot;</span>     <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;411 Length Required&quot;</span>
  <span class='string val'>&quot;PRECONDITION_FAILED&quot;</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;412 Precondition Failed&quot;</span>
  <span class='string val'>&quot;SERVER_ERROR&quot;</span>        <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;500 Internal Server Error&quot;</span>
  <span class='string val'>&quot;NOT_IMPLEMENTED&quot;</span>     <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;501 Method Not Implemented&quot;</span>
  <span class='string val'>&quot;BAD_GATEWAY&quot;</span>         <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;502 Bad Gateway&quot;</span>
  <span class='string val'>&quot;VARIANT_ALSO_VARIES&quot;</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;506 Variant Also Negotiates&quot;</span>
</pre>
<p>
This method does not perform charset conversion.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 539</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L539">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='header identifier id'>header</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='string val'>&quot;text/html&quot;</span><span class='rparen token'>)</span>

  <span class='buf identifier id'>buf</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>

  <span class='case case kw'>case</span> <span class='options identifier id'>options</span>
  <span class='when when kw'>when</span> <span class='String constant id'>String</span>
    <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;type&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='options identifier id'>options</span> <span class='rbrace token'>}</span>
  <span class='when when kw'>when</span> <span class='Hash constant id'>Hash</span>
    <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='end end kw'>end</span>

  <span class='unless unless kw'>unless</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;type&quot;</span><span class='rparen token'>)</span>
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;text/html&quot;</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;charset&quot;</span><span class='rparen token'>)</span>
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;type&quot;</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;; charset=&quot;</span> <span class='plus op'>+</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;charset&quot;</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;nph&quot;</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='MOD_RUBY constant id'>MOD_RUBY</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;nph&quot;</span><span class='rparen token'>)</span> <span class='or or kw'>or</span>
      <span class='lparen token'>(</span><span class='regexp val'>/IIS\/(\d+)/n</span><span class='dot token'>.</span><span class='match identifier id'>match</span><span class='lparen token'>(</span><span class='env_table identifier id'>env_table</span><span class='lbrack token'>[</span><span class='string val'>'SERVER_SOFTWARE'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='lt op'>&lt;</span> <span class='integer val'>5</span><span class='rparen token'>)</span>
    <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='lparen token'>(</span><span class='env_table identifier id'>env_table</span><span class='lbrack token'>[</span><span class='string val'>&quot;SERVER_PROTOCOL&quot;</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='string val'>&quot;HTTP/1.0&quot;</span><span class='rparen token'>)</span>  <span class='plus op'>+</span> <span class='string val'>&quot; &quot;</span> <span class='plus op'>+</span>
           <span class='lparen token'>(</span><span class='HTTP_STATUS constant id'>HTTP_STATUS</span><span class='lbrack token'>[</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;status&quot;</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;status&quot;</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='string val'>&quot;200 OK&quot;</span><span class='rparen token'>)</span> <span class='plus op'>+</span>
           <span class='EOL constant id'>EOL</span> <span class='plus op'>+</span>
           <span class='string val'>&quot;Date: &quot;</span> <span class='plus op'>+</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='rfc1123_date identifier id'>rfc1123_date</span><span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>

    <span class='unless unless kw'>unless</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;server&quot;</span><span class='rparen token'>)</span>
      <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;server&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='env_table identifier id'>env_table</span><span class='lbrack token'>[</span><span class='string val'>'SERVER_SOFTWARE'</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='unless unless kw'>unless</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;connection&quot;</span><span class='rparen token'>)</span>
      <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;connection&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;close&quot;</span>
    <span class='end end kw'>end</span>

    <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;status&quot;</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;status&quot;</span><span class='rparen token'>)</span>
    <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Status: &quot;</span> <span class='plus op'>+</span>
           <span class='lparen token'>(</span><span class='HTTP_STATUS constant id'>HTTP_STATUS</span><span class='lbrack token'>[</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;status&quot;</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;status&quot;</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
    <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;status&quot;</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;server&quot;</span><span class='rparen token'>)</span>
    <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Server: &quot;</span> <span class='plus op'>+</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;server&quot;</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;connection&quot;</span><span class='rparen token'>)</span>
    <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Connection: &quot;</span> <span class='plus op'>+</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;connection&quot;</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
  <span class='end end kw'>end</span>

  <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Content-Type: &quot;</span> <span class='plus op'>+</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;type&quot;</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;length&quot;</span><span class='rparen token'>)</span>
    <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Content-Length: &quot;</span> <span class='plus op'>+</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;length&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;language&quot;</span><span class='rparen token'>)</span>
    <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Content-Language: &quot;</span> <span class='plus op'>+</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;language&quot;</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;expires&quot;</span><span class='rparen token'>)</span>
    <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Expires: &quot;</span> <span class='plus op'>+</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='rfc1123_date identifier id'>rfc1123_date</span><span class='lparen token'>(</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;expires&quot;</span><span class='rparen token'>)</span> <span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;cookie&quot;</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;cookie&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='String constant id'>String</span><span class='rparen token'>)</span> <span class='or or kw'>or</span>
         <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;cookie&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Cookie constant id'>Cookie</span><span class='rparen token'>)</span>
      <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Set-Cookie: &quot;</span> <span class='plus op'>+</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;cookie&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
    <span class='elsif elsif kw'>elsif</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;cookie&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
      <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;cookie&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='cookie identifier id'>cookie</span><span class='bitor op'>|</span>
        <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Set-Cookie: &quot;</span> <span class='plus op'>+</span> <span class='cookie identifier id'>cookie</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
      <span class='rbrace token'>}</span>
    <span class='elsif elsif kw'>elsif</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;cookie&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span>
      <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>&quot;cookie&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each_value identifier id'>each_value</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='cookie identifier id'>cookie</span><span class='bitor op'>|</span>
        <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Set-Cookie: &quot;</span> <span class='plus op'>+</span> <span class='cookie identifier id'>cookie</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
      <span class='rbrace token'>}</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='@output_cookies ivar id'>@output_cookies</span>
    <span class='for for kw'>for</span> <span class='cookie identifier id'>cookie</span> <span class='in in kw'>in</span> <span class='@output_cookies ivar id'>@output_cookies</span>
      <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot;Set-Cookie: &quot;</span> <span class='plus op'>+</span> <span class='cookie identifier id'>cookie</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='buf identifier id'>buf</span> <span class='opasgn op'>+=</span> <span class='key identifier id'>key</span> <span class='plus op'>+</span> <span class='string val'>&quot;: &quot;</span> <span class='plus op'>+</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
  <span class='rbrace token'>}</span>

  <span class='if if kw'>if</span> <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='MOD_RUBY constant id'>MOD_RUBY</span><span class='rparen token'>)</span>
    <span class='table identifier id'>table</span> <span class='assign token'>=</span> <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='headers_out identifier id'>headers_out</span>
    <span class='buf identifier id'>buf</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='dregexp node'>/([^:]+): (.+)#{EOL}/n</span><span class='rparen token'>)</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
      <span class='warn identifier id'>warn</span> <span class='sprintf identifier id'>sprintf</span><span class='lparen token'>(</span><span class='string val'>&quot;name:%s value:%s\n&quot;</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$DEBUG gvar id'>$DEBUG</span>
      <span class='case case kw'>case</span> <span class='name identifier id'>name</span>
      <span class='when when kw'>when</span> <span class='string val'>'Set-Cookie'</span>
        <span class='table identifier id'>table</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='regexp val'>/^status$/n</span><span class='i identifier id'>i</span>
        <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='status_line identifier id'>status_line</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span>
        <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='status identifier id'>status</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='when when kw'>when</span> <span class='regexp val'>/^content-type$/n</span><span class='i identifier id'>i</span>
        <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='content_type identifier id'>content_type</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span>
      <span class='when when kw'>when</span> <span class='regexp val'>/^content-encoding$/n</span><span class='i identifier id'>i</span>
        <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='content_encoding identifier id'>content_encoding</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span>
      <span class='when when kw'>when</span> <span class='regexp val'>/^location$/n</span><span class='i identifier id'>i</span>
  <span class='if if kw'>if</span> <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='status identifier id'>status</span> <span class='eq op'>==</span> <span class='integer val'>200</span>
    <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='status identifier id'>status</span> <span class='assign token'>=</span> <span class='integer val'>302</span>
  <span class='end end kw'>end</span>
        <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='headers_out identifier id'>headers_out</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span>
      <span class='else else kw'>else</span>
        <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='headers_out identifier id'>headers_out</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span>
      <span class='end end kw'>end</span>
    <span class='rbrace token'>}</span>
    <span class='Apache constant id'>Apache</span><span class='colon2 op'>::</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='send_http_header identifier id'>send_http_header</span>
    <span class='string val'>''</span>
  <span class='else else kw'>else</span>
    <span class='buf identifier id'>buf</span> <span class='plus op'>+</span> <span class='EOL constant id'>EOL</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span> <span class='comment val'># header()</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>out</h3>
</div><div id="out-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>out</span><span class='args'>(options = &quot;text/html&quot;)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Print an HTTP header and body to $DEFAULT_OUTPUT ($&gt;)
</p>
<p>
The header is provided by <tt>options</tt>, as for #header(). The body of
the document is that returned by the passed- in block. This block takes no
arguments. It is required.
</p>
<pre class="code">
  <span class='cgi identifier id'>cgi</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='out identifier id'>out</span><span class='lbrace token'>{</span> <span class='string val'>&quot;string&quot;</span> <span class='rbrace token'>}</span>
    <span class='comment val'># Content-Type: text/html</span>
    <span class='comment val'># Content-Length: 6</span>
    <span class='comment val'>#</span>
    <span class='comment val'># string</span>

  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='out identifier id'>out</span><span class='lparen token'>(</span><span class='string val'>&quot;text/plain&quot;</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;string&quot;</span> <span class='rbrace token'>}</span>
    <span class='comment val'># Content-Type: text/plain</span>
    <span class='comment val'># Content-Length: 6</span>
    <span class='comment val'>#</span>
    <span class='comment val'># string</span>

  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='out identifier id'>out</span><span class='lparen token'>(</span><span class='string val'>&quot;nph&quot;</span>        <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span>
          <span class='string val'>&quot;status&quot;</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;OK&quot;</span><span class='comma token'>,</span>  <span class='comment val'># == &quot;200 OK&quot;</span>
          <span class='string val'>&quot;server&quot;</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'SERVER_SOFTWARE'</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;connection&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;close&quot;</span><span class='comma token'>,</span>
          <span class='string val'>&quot;type&quot;</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;text/html&quot;</span><span class='comma token'>,</span>
          <span class='string val'>&quot;charset&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;iso-2022-jp&quot;</span><span class='comma token'>,</span>
            <span class='comment val'># Content-Type: text/html; charset=iso-2022-jp</span>
          <span class='string val'>&quot;language&quot;</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;ja&quot;</span><span class='comma token'>,</span>
          <span class='string val'>&quot;expires&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='integer val'>3600</span> <span class='mult op'>*</span> <span class='integer val'>24</span> <span class='mult op'>*</span> <span class='integer val'>30</span><span class='rparen token'>)</span><span class='comma token'>,</span>
          <span class='string val'>&quot;cookie&quot;</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='cookie1 identifier id'>cookie1</span><span class='comma token'>,</span> <span class='cookie2 identifier id'>cookie2</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;my_header1&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;my_value&quot;</span><span class='comma token'>,</span>
          <span class='string val'>&quot;my_header2&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;my_value&quot;</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;string&quot;</span> <span class='rbrace token'>}</span>
</pre>
<p>
Content-Length is automatically calculated from the size of the String
returned by the content block.
</p>
<p>
If ENV[&#8216;REQUEST_METHOD&#8217;] == &quot;HEAD&quot;, then only the
header is outputted (the content block is still required, but it is
ignored).
</p>
<p>
If the charset is &quot;iso-2022-jp&quot; or &quot;euc-jp&quot; or
&quot;shift_jis&quot; then the content is converted to this charset, and
the language is set to &quot;ja&quot;.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 703</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L703">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='out identifier id'>out</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='string val'>&quot;text/html&quot;</span><span class='rparen token'>)</span> <span class='comment val'># :yield:</span>

  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;type&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='options identifier id'>options</span> <span class='rbrace token'>}</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='String constant id'>String</span><span class='rparen token'>)</span>
  <span class='content identifier id'>content</span> <span class='assign token'>=</span> <span class='yield yield kw'>yield</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;charset&quot;</span><span class='rparen token'>)</span>
    <span class='require identifier id'>require</span> <span class='string val'>&quot;nkf&quot;</span>
    <span class='case case kw'>case</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;charset&quot;</span><span class='rbrack token'>]</span>
    <span class='when when kw'>when</span> <span class='regexp val'>/iso-2022-jp/n</span><span class='i identifier id'>i</span>
      <span class='content identifier id'>content</span> <span class='assign token'>=</span> <span class='NKF constant id'>NKF</span><span class='colon2 op'>::</span><span class='nkf identifier id'>nkf</span><span class='lparen token'>(</span><span class='string val'>'-m0 -x -j'</span><span class='comma token'>,</span> <span class='content identifier id'>content</span><span class='rparen token'>)</span>
      <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;language&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;ja&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;language&quot;</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='regexp val'>/euc-jp/n</span><span class='i identifier id'>i</span>
      <span class='content identifier id'>content</span> <span class='assign token'>=</span> <span class='NKF constant id'>NKF</span><span class='colon2 op'>::</span><span class='nkf identifier id'>nkf</span><span class='lparen token'>(</span><span class='string val'>'-m0 -x -e'</span><span class='comma token'>,</span> <span class='content identifier id'>content</span><span class='rparen token'>)</span>
      <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;language&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;ja&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;language&quot;</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='regexp val'>/shift_jis/n</span><span class='i identifier id'>i</span>
      <span class='content identifier id'>content</span> <span class='assign token'>=</span> <span class='NKF constant id'>NKF</span><span class='colon2 op'>::</span><span class='nkf identifier id'>nkf</span><span class='lparen token'>(</span><span class='string val'>'-m0 -x -s'</span><span class='comma token'>,</span> <span class='content identifier id'>content</span><span class='rparen token'>)</span>
      <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;language&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;ja&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='string val'>&quot;language&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>&quot;length&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='content identifier id'>content</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='output identifier id'>output</span> <span class='assign token'>=</span> <span class='stdoutput identifier id'>stdoutput</span>
  <span class='output identifier id'>output</span><span class='dot token'>.</span><span class='binmode identifier id'>binmode</span> <span class='if if_mod kw'>if</span> <span class='defined? defined kw'>defined?</span> <span class='output identifier id'>output</span><span class='dot token'>.</span><span class='binmode identifier id'>binmode</span>
  <span class='output identifier id'>output</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='header identifier id'>header</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='output identifier id'>output</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='content identifier id'>content</span> <span class='unless unless_mod kw'>unless</span> <span class='string val'>&quot;HEAD&quot;</span> <span class='eq op'>==</span> <span class='env_table identifier id'>env_table</span><span class='lbrack token'>[</span><span class='string val'>'REQUEST_METHOD'</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>print</h3>
</div><div id="print-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>print</span><span class='args'>(*options)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Print an argument or list of arguments to the default output stream
</p>
<pre class="code">
  <span class='cgi identifier id'>cgi</span> <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='cgi identifier id'>cgi</span><span class='dot token'>.</span><span class='print identifier id'>print</span>    <span class='comment val'># default:  cgi.print == $DEFAULT_OUTPUT.print</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/cgi.rb', line 735</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/cgi.rb#L735">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">735
736
737</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='print identifier id'>print</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='stdoutput identifier id'>stdoutput</span><span class='dot token'>.</span><span class='print identifier id'>print</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>