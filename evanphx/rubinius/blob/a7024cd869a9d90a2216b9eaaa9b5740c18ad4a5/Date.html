<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>evanphx's rubinius - Class: Date - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/evanphx/commits/rubinius/master" rel="alternate" title="Recent Commits to rubinius:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("evanphx", "rubinius", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("evanphx", "rubinius", "a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/evanphx/rubinius/tree/">Source</a></li>
            <li class=""><a href="http://github.com/evanphx/rubinius/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/evanphx/rubinius/network">Network</a></li>            
            <li class=""><a href="http://github.com/evanphx/rubinius/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/evanphx/rubinius">Wiki</a></li>
            <li class=""><a href="http://github.com/evanphx/rubinius/graphs">Graphs</a></li>                    
            <li class="active"><a href="/evanphx/rubinius">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/evanphx">evanphx</a> / <b><a href="http://github.com/evanphx/rubinius/tree">rubinius</a></b>        
                <a id="namespaces_button" rel="evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Date">
  <h1>Class: Date</h1>
  <div class="section mixins">
  <h2>Included Modules</h2>
  <p>Comparable</p>
</div><div class="section docstring">
  <p>
Class representing a date.
</p>
<p>
See the documentation to the file date.rb for an overview.
</p>
<p>
Internally, the date is represented as an Astronomical Julian Day Number,
<tt>ajd</tt>. The Day of Calendar Reform, <tt>sg</tt>, is also stored, for
conversions to other date formats. (There is also an <tt>of</tt> field for
a time zone offset, but this is only for the use of the DateTime subclass.)
</p>
<p>
A new Date object is created using one of the object creation class methods
named after the corresponding date format, and the arguments appropriate to
that date format; for instance, Date::civil() (aliased to Date::new()) with
year, month, and day-of-month, or Date::ordinal() with year and
day-of-year. All of these object creation class methods also take the Day
of Calendar Reform as an optional argument.
</p>
<p>
Date objects are immutable once created.
</p>
<p>
Once a Date has been created, date values can be retrieved for the
different date formats supported using instance methods. For instance,
#mon() gives the Civil month, #cwday() gives the Commercial day of the
week, and #yday() gives the Ordinal day of the year. Date values can be
retrieved in any format, regardless of what format was used to create the
Date instance.
</p>
<p>
The Date class includes the Comparable module, allowing date objects to be
compared and sorted, ranges of dates to be created, and so forth.
</p>

</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="ABBR_DAYNAMES-constant">ABBR_DAYNAMES</dt>
      <dd>%w(Sun Mon Tue Wed Thu Fri Sat)</dd>
    
      <dt id="ABBR_MONTHNAMES-constant">ABBR_MONTHNAMES</dt>
      <dd>[nil] + %w(Jan Feb Mar Apr May Jun
Jul Aug Sep Oct Nov Dec)</dd>
    
      <dt id="DAYNAMES-constant">DAYNAMES</dt>
      <dd>%w(Sunday Monday Tuesday Wednesday Thursday Friday Saturday)</dd>
    
      <dt id="ENGLAND-constant">ENGLAND</dt>
      <dd>2361222 </dd>
    
      <dt id="GREGORIAN-constant">GREGORIAN</dt>
      <dd>-Infinity.new</dd>
    
      <dt id="HALF_DAYS_IN_DAY-constant">HALF_DAYS_IN_DAY</dt>
      <dd>Rational(1, 2) </dd>
    
      <dt id="HOURS_IN_DAY-constant">HOURS_IN_DAY</dt>
      <dd>Rational(1, 24) </dd>
    
      <dt id="ITALY-constant">ITALY</dt>
      <dd>2299161 </dd>
    
      <dt id="JULIAN-constant">JULIAN</dt>
      <dd>Infinity.new</dd>
    
      <dt id="LD_EPOCH_IN_CJD-constant">LD_EPOCH_IN_CJD</dt>
      <dd>2299160 </dd>
    
      <dt id="MILLISECONDS_IN_DAY-constant">MILLISECONDS_IN_DAY</dt>
      <dd>Rational(1, 86400*10**3) </dd>
    
      <dt id="MILLISECONDS_IN_SECOND-constant">MILLISECONDS_IN_SECOND</dt>
      <dd>Rational(1, 10**3) </dd>
    
      <dt id="MINUTES_IN_DAY-constant">MINUTES_IN_DAY</dt>
      <dd>Rational(1, 1440) </dd>
    
      <dt id="MJD_EPOCH_IN_AJD-constant">MJD_EPOCH_IN_AJD</dt>
      <dd>Rational(4800001, 2) </dd>
    
      <dt id="MJD_EPOCH_IN_CJD-constant">MJD_EPOCH_IN_CJD</dt>
      <dd>2400001 </dd>
    
      <dt id="MONTHNAMES-constant">MONTHNAMES</dt>
      <dd>[nil] + %w(January February March April May June July
August September October November December)</dd>
    
      <dt id="NANOSECONDS_IN_DAY-constant">NANOSECONDS_IN_DAY</dt>
      <dd>Rational(1, 86400*10**9) </dd>
    
      <dt id="NANOSECONDS_IN_SECOND-constant">NANOSECONDS_IN_SECOND</dt>
      <dd>Rational(1, 10**9) </dd>
    
      <dt id="SECONDS_IN_DAY-constant">SECONDS_IN_DAY</dt>
      <dd>Rational(1, 86400) </dd>
    
      <dt id="UNIX_EPOCH_IN_AJD-constant">UNIX_EPOCH_IN_AJD</dt>
      <dd>Rational(4881175, 2) </dd>
    
      <dt id="UNIX_EPOCH_IN_CJD-constant">UNIX_EPOCH_IN_CJD</dt>
      <dd>2440588 </dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(ajd = 0, of = 0, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
<b>NOTE</b> this is the documentation for the method new!(). If you are
reading this as the documentation for new(), that is because rdoc
doesn&#8217;t fully support the aliasing of the initialize() method. new()
is in fact an alias for #civil(): read the documentation for that method
instead.
</p>
<p>
Create a new Date object.
</p>
<p>
<tt>ajd</tt> is the Astronomical Julian Day Number. <tt>of</tt> is the
offset from UTC as a fraction of a day. Both default to 0.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform to use for this Date
object.
</p>
<p>
Using one of the factory methods such as Date::civil is generally easier
and safer.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1029</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1029">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1029</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span> <span class='assign token'>=</span> <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_httpdate-class_method">_httpdate</span><span class='args'>(str)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_iso8601-class_method">_iso8601</span><span class='args'>(str)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_jisx0301-class_method">_jisx0301</span><span class='args'>(str)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_load-class_method">_load</span><span class='args'>(str)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
def self.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse-class_method">_parse</span><span class='args'>(str, comp = true)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_day-class_method">_parse_day</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_ddd-class_method">_parse_ddd</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_eu-class_method">_parse_eu</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <h1>begin</h1>
<pre class="code">
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span>
</pre>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_iso-class_method">_parse_iso</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_iso2-class_method">_parse_iso2</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_jis-class_method">_parse_jis</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_mday-class_method">_parse_mday</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_mon-class_method">_parse_mon</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_sla_eu-class_method">_parse_sla_eu</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_sla_ja-class_method">_parse_sla_ja</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_sla_jp-class_method">_parse_sla_jp</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_sla_us-class_method">_parse_sla_us</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_time-class_method">_parse_time</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_us-class_method">_parse_us</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_vms-class_method">_parse_vms</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parse_year-class_method">_parse_year</span><span class='args'>(str, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_rfc2822-class_method">_rfc2822</span><span class='args'>(str)</span>
        <span class='block'></span>
        
          <span class='alias'>_rfc822</span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_rfc3339-class_method">_rfc3339</span><span class='args'>(str)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_strptime-class_method">_strptime</span><span class='args'>(str, fmt = '%F')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_strptime_i-class_method">_strptime_i</span><span class='args'>(str, fmt, e)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_xmlschema-class_method">_xmlschema</span><span class='args'>(str)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ajd_to_amjd-class_method">ajd_to_amjd</span><span class='args'>(ajd)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert an Astronomical Julian Day Number to an Astronomical Modified
Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ajd_to_jd-class_method">ajd_to_jd</span><span class='args'>(ajd, of = 0)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert an Astronomical Julian Day Number to a (civil) Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#amjd_to_ajd-class_method">amjd_to_ajd</span><span class='args'>(amjd)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert an Astronomical Modified Julian Day Number to an Astronomical
Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#civil-class_method">civil</span><span class='args'>(y = -4712, m = 1, d = 1, sg = ITALY)</span>
        <span class='block'></span>
        
          <span class='alias'>new</span>
        
      </th>
      <td class="docstring">
        <p>
Create a new Date object for the Civil Date specified by year <tt>y</tt>,
month <tt>m</tt>, and day-of-month <tt>d</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#civil_to_jd-class_method">civil_to_jd</span><span class='args'>(y, m, d, sg = GREGORIAN)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Civil Date to a Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#commercial-class_method">commercial</span><span class='args'>(y = 1582, w = 41, d = 5, sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a new Date object for the Commercial Date specified by year
<tt>y</tt>, week-of-year <tt>w</tt>, and day-of-week <tt>d</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#commercial_to_jd-class_method">commercial_to_jd</span><span class='args'>(y, w, d, ns = GREGORIAN)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Commercial Date to a Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#complete_frags-class_method">complete_frags</span><span class='args'>(elem)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#day_fraction_to_time-class_method">day_fraction_to_time</span><span class='args'>(fr)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a fractional day <tt>fr</tt> to [hours, minutes, seconds,
fraction_of_a_second].
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#fix_style-class_method">fix_style</span><span class='args'>(jd, sg)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#gregorian-3F-class_method">gregorian?</span><span class='args'>(jd, sg)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Does a given Julian Day Number fall inside the new-style (Gregorian)
calendar?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#gregorian_leap-3F-class_method">gregorian_leap?</span><span class='args'>(y)</span>
        <span class='block'></span>
        
          <span class='alias'>leap?</span>
        
      </th>
      <td class="docstring">
        <p>
Is a year a leap year in the Gregorian calendar?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd-class_method">jd</span><span class='args'>(jd = 0, sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a new Date object from a Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd_to_ajd-class_method">jd_to_ajd</span><span class='args'>(jd, fr, of = 0)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a (civil) Julian Day Number to an Astronomical Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd_to_civil-class_method">jd_to_civil</span><span class='args'>(jd, sg = GREGORIAN)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Julian Day Number to a Civil Date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd_to_commercial-class_method">jd_to_commercial</span><span class='args'>(jd, sg = GREGORIAN)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Julian Day Number to a Commercial Date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd_to_ld-class_method">jd_to_ld</span><span class='args'>(jd)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Julian Day Number to the number of days since the adoption of the
Gregorian Calendar (in Italy).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd_to_mjd-class_method">jd_to_mjd</span><span class='args'>(jd)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Julian Day Number to a Modified Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd_to_ordinal-class_method">jd_to_ordinal</span><span class='args'>(jd, sg = GREGORIAN)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Julian Day Number to an Ordinal Date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd_to_wday-class_method">jd_to_wday</span><span class='args'>(jd)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Julian Day Number to the day of the week.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd_to_weeknum-class_method">jd_to_weeknum</span><span class='args'>(jd, f = 0, sg = GREGORIAN)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#julian-3F-class_method">julian?</span><span class='args'>(jd, sg)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Does a given Julian Day Number fall inside the old-style (Julian)
calendar?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#julian_leap-3F-class_method">julian_leap?</span><span class='args'>(y)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Is a year a leap year in the Julian calendar?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ld_to_jd-class_method">ld_to_jd</span><span class='args'>(ld)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a count of the number of days since the adoption of the Gregorian
Calendar (in Italy) to a Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#mjd_to_jd-class_method">mjd_to_jd</span><span class='args'>(mjd)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Modified Julian Day Number to a Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#new_by_frags-class_method">new_by_frags</span><span class='args'>(elem, sg)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#now-class_method">now</span><span class='args'>(sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a new DateTime object representing the current time.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#num_pattern-3F-class_method">num_pattern?</span><span class='args'>(s)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <h1>begin</h1>
<pre class="code">
  <span class='def def kw'>def</span> <span class='beat identifier id'>beat</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='i identifier id'>i</span><span class='comma token'>,</span> <span class='f identifier id'>f</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='HOURS_IN_DAY constant id'>HOURS_IN_DAY</span><span class='rparen token'>)</span><span class='dot token'>.</span>
</pre>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ordinal-class_method">ordinal</span><span class='args'>(y = -4712, d = 1, sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a new Date object from an Ordinal Date, specified by year <tt>y</tt>
and day-of-year <tt>d</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ordinal_to_jd-class_method">ordinal_to_jd</span><span class='args'>(y, d, sg = GREGORIAN)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert an Ordinal Date to a Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#parse-class_method">parse</span><span class='args'>(str = '-4712-01-01', comp = false, sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a new Date object by parsing from a String, without specifying the
format.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#rewrite_frags-class_method">rewrite_frags</span><span class='args'>(elem)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#s3e-class_method">s3e</span><span class='args'>(e, y, m, d, bc = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#strptime-class_method">strptime</span><span class='args'>(str = '-4712-01-01', fmt = '%F', sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a new Date object by parsing from a String according to a specified
format.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#time_to_day_fraction-class_method">time_to_day_fraction</span><span class='args'>(h, min, s)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert an <tt>h</tt> hour, <tt>min</tt> minutes, <tt>s</tt> seconds period
to a fractional day.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#today-class_method">today</span><span class='args'>(sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a new Date object representing today.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#valid_civil-3F-class_method">valid_civil?</span><span class='args'>(y, m, d, sg = ITALY)</span>
        <span class='block'></span>
        
          <span class='alias'>valid_date?</span>
        
      </th>
      <td class="docstring">
        <p>
Do year <tt>y</tt>, month <tt>m</tt>, and day-of-month <tt>d</tt> make a
valid Civil Date? Returns the corresponding Julian Day Number if they do,
nil if they don&#8217;t.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#valid_commercial-3F-class_method">valid_commercial?</span><span class='args'>(y, w, d, sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Do year <tt>y</tt>, week-of-year <tt>w</tt>, and day-of-week <tt>d</tt>
make a valid Commercial Date? Returns the corresponding Julian Day Number
if they do, nil if they don&#8217;t.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#valid_date_frags-3F-class_method">valid_date_frags?</span><span class='args'>(elem, sg)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#valid_jd-3F-class_method">valid_jd?</span><span class='args'>(jd, sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Is <tt>jd</tt> a valid Julian Day Number?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#valid_ordinal-3F-class_method">valid_ordinal?</span><span class='args'>(y, d, sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Do the year <tt>y</tt> and day-of-year <tt>d</tt> make a valid Ordinal
Date? Returns the corresponding Julian Day Number if they do, or nil if
they don&#8217;t.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#valid_time-3F-class_method">valid_time?</span><span class='args'>(h, min, s)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Do hour <tt>h</tt>, minute <tt>min</tt>, and second <tt>s</tt> constitute a
valid time?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#valid_time_frags-3F-class_method">valid_time_frags?</span><span class='args'>(elem)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#valid_weeknum-3F-class_method">valid_weeknum?</span><span class='args'>(y, w, d, f, sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#weeknum-class_method">weeknum</span><span class='args'>(y = 1582, w = 41, d = 5, f = 0, sg = ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#weeknum_to_jd-class_method">weeknum_to_jd</span><span class='args'>(y, w, d, f = 0, ns = GREGORIAN)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#-2B-instance_method">#+</span><span class='args'>(n)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return a new Date object that is <tt>n</tt> days later than the current
one.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#--instance_method">#-</span><span class='args'>(x)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
If <tt>x</tt> is a Numeric value, create a new Date object that is
<tt>x</tt> days earlier than the current one.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#-3C-3C-instance_method">#<<</span><span class='args'>(n)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return a new Date object that is <tt>n</tt> months earlier than the current
one.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#-3C-3D-instance_method">#<=</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Compare this date with another date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#-3D-3D-3D-instance_method">#===</span><span class='args'>(other)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The relationship operator for Date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#-3E-3E-instance_method">#>></span><span class='args'>(n)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return a new Date object that is <tt>n</tt> months later than the current
one.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_dump-instance_method">#_dump</span><span class='args'>(limit)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Dump to Marshal format.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ajd-instance_method">#ajd</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the date as an Astronomical Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#amjd-instance_method">#amjd</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the date as an Astronomical Modified Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#asctime-instance_method">#asctime</span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#ctime</span>
        
      </th>
      <td class="docstring">
        <p>
alias_method :format, :strftime.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#cwday-instance_method">#cwday</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the commercial day of the week of this date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#cweek-instance_method">#cweek</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the commercial week of the year of this date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#cwyear-instance_method">#cwyear</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the commercial year of this date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#day_fraction-instance_method">#day_fraction</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get any fractional day part of the date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#downto-instance_method">#downto</span><span class='args'>(min, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Step backward one day at a time until we reach <tt>min</tt> (inclusive),
yielding each date as we go.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#england-instance_method">#england</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a copy of this Date object that uses the English/Colonial Day of
Calendar Reform.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#eql-3F-instance_method">#eql?</span><span class='args'>(other)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Is this Date equal to <tt>other</tt>?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#gregorian-instance_method">#gregorian</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a copy of this Date object that always uses the Gregorian Calendar.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#gregorian-3F-instance_method">#gregorian?</span><span class='args'>(self.class.gregorian?(jd, @sg))</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Is the current date new-style (Gregorian Calendar)?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#hash-instance_method">#hash</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Calculate a hash value for this date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#httpdate-instance_method">#httpdate</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#inspect-instance_method">#inspect</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return internal object state as a programmer-readable string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#iso8601-instance_method">#iso8601</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#italy-instance_method">#italy</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a copy of this Date object that uses the Italian/Catholic Day of
Calendar Reform.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jd-instance_method">#jd</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the date as a Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#jisx0301-instance_method">#jisx0301</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#julian-instance_method">#julian</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a copy of this Date object that always uses the Julian Calendar.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#julian-3F-instance_method">#julian?</span><span class='args'>(self.class.julian?(jd, @sg))</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Is the current date old-style (Julian Calendar)?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ld-instance_method">#ld</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the date as the number of days since the Day of Calendar Reform (in
Italy and the Catholic countries).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#leap-3F-instance_method">#leap?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Is this a leap year?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#mday-instance_method">#mday</span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#day</span>
        
      </th>
      <td class="docstring">
        <p>
Get the day-of-the-month of this date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#mjd-instance_method">#mjd</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the date as a Modified Julian Day Number.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#mon-instance_method">#mon</span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#month</span>
        
      </th>
      <td class="docstring">
        <p>
Get the month of this date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#new_start-instance_method">#new_start</span><span class='args'>(sg = self.class::ITALY)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a copy of this Date object using a new Day of Calendar Reform.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#next-instance_method">#next</span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#succ</span>
        
      </th>
      <td class="docstring">
        <p>
Return a new Date one day after this one.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#rfc2822-instance_method">#rfc2822</span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#rfc822</span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#rfc3339-instance_method">#rfc3339</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#start-instance_method">#start</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
When is the Day of Calendar Reform for this Date object?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#step-instance_method">#step</span><span class='args'>(limit, step = 1)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Step the current date forward <tt>step</tt> days at a time (or backward, if
<tt>step</tt> is negative) until we reach <tt>limit</tt> (inclusive),
yielding the resultant date at each step.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#strftime-instance_method">#strftime</span><span class='args'>(fmt = '%F')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_s-instance_method">#to_s</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return the date as a human-readable string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_yaml-instance_method">#to_yaml</span><span class='args'>(opts = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#upto-instance_method">#upto</span><span class='args'>(max, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Step forward one day at a time until we reach <tt>max</tt> (inclusive),
yielding each date as we go.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#wday-instance_method">#wday</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the week day of this date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#xmlschema-instance_method">#xmlschema</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#yday-instance_method">#yday</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the day-of-the-year of this date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#year-instance_method">#year</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get the year of this date.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>_httpdate</h3>
</div><div id="_httpdate-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_httpdate</span><span class='args'>(str)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 1206</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L1206">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_httpdate identifier id'>_httpdate</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='dregexp node'>/\A\s*(#{Format::ABBR_DAYS.keys.join('|')})\s*,\s+
      \d{2}\s+
      (#{Format::ABBR_MONTHS.keys.join('|')})\s+
      -?\d{4}\s+ # allow minus, anyway
      \d{2}:\d{2}:\d{2}\s+
      gmt\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='_rfc2822 identifier id'>_rfc2822</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='dregexp node'>/\A\s*(#{Format::DAYS.keys.join('|')})\s*,\s+
      \d{2}\s*-\s*
      (#{Format::ABBR_MONTHS.keys.join('|')})\s*-\s*
      \d{2}\s+
      \d{2}:\d{2}:\d{2}\s+
      gmt\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='dregexp node'>/\A\s*(#{Format::ABBR_DAYS.keys.join('|')})\s+
      (#{Format::ABBR_MONTHS.keys.join('|')})\s+
      \d{1,2}\s+
      \d{2}:\d{2}:\d{2}\s+
      \d{4}\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_iso8601</h3>
</div><div id="_iso8601-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_iso8601</span><span class='args'>(str)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 1107</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L1107">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_iso8601 identifier id'>_iso8601</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*(([-+]?\d{2,}|-)-\d{2}-\d{2}|
            ([-+]?\d{2,})?-\d{3}|
            (\d{2}|\d{4})?-w\d{2}-\d|
            -w-\d)
      (t
      \d{2}:\d{2}(:\d{2}([,.]\d+)?)?
      (z|[-+]\d{2}(:?\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(([-+]?(\d{2}|\d{4})|--)\d{2}\d{2}|
            ([-+]?(\d{2}|\d{4}))?\d{3}|-\d{3}|
            (\d{2}|\d{4})?w\d{2}\d)
      (t?
      \d{2}\d{2}(\d{2}([,.]\d+)?)?
      (z|[-+]\d{2}(\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(\d{2}:\d{2}(:\d{2}([,.]\d+)?)?
      (z|[-+]\d{2}(:?\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(\d{2}\d{2}(\d{2}([,.]\d+)?)?
      (z|[-+]\d{2}(\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_jisx0301</h3>
</div><div id="_jisx0301-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_jisx0301</span><span class='args'>(str)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 1230</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L1230">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_jisx0301 identifier id'>_jisx0301</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*[mtsh]?\d{2}\.\d{2}\.\d{2}
      (t
      (\d{2}:\d{2}(:\d{2}([,.]\d*)?)?
      (z|[-+]\d{2}(:?\d{2})?)?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*\d/</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/\A\s*(\d)/</span><span class='comma token'>,</span> <span class='string val'>'h\1'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='_iso8601 identifier id'>_iso8601</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_load</h3>
</div><div id="_load-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_load</span><span class='args'>(str)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
def self._load(str) new!(*Marshal.load(str)) end Load from Marshall format.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1365</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1365">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
    <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
         <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
  <span class='else else kw'>else</span>
    <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
  <span class='end end kw'>end</span>
  <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse</h3>
</div><div id="_parse-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse</span><span class='args'>(str, comp = true)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 1042</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L1042">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='comp identifier id'>comp</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>

  <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='comp identifier id'>comp</span>

  <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/[^-+',.\/:@[:alnum:]\[\]\x80-\xff]+/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>

  <span class='_parse_time identifier id'>_parse_time</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># || _parse_beat(str, e)</span>
  <span class='_parse_day identifier id'>_parse_day</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>

  <span class='_parse_eu identifier id'>_parse_eu</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>     <span class='orop op'>||</span>
  <span class='_parse_us identifier id'>_parse_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>     <span class='orop op'>||</span>
  <span class='_parse_iso identifier id'>_parse_iso</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
  <span class='_parse_jis identifier id'>_parse_jis</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
  <span class='_parse_vms identifier id'>_parse_vms</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
  <span class='_parse_sla_us identifier id'>_parse_sla_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
  <span class='_parse_iso2 identifier id'>_parse_iso2</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>   <span class='orop op'>||</span>
  <span class='_parse_year identifier id'>_parse_year</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>   <span class='orop op'>||</span>
  <span class='_parse_mon identifier id'>_parse_mon</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
  <span class='_parse_mday identifier id'>_parse_mday</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>   <span class='orop op'>||</span>
  <span class='_parse_ddd identifier id'>_parse_ddd</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b(bc\b|bce\b|b\.c\.|b\.c\.e\.)/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='minus op'>-</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A\s*(\d{1,2})\s*\z/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span>
      <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>31</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='v identifier id'>v</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span>
      <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>24</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='v identifier id'>v</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span>
    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span> <span class='andop op'>&amp;&amp;</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='leq op'>&lt;=</span> <span class='integer val'>99</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='opasgn op'>+=</span> <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span>
                    <span class='then then kw'>then</span> <span class='integer val'>1900</span> <span class='else else kw'>else</span> <span class='integer val'>2000</span> <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span> <span class='andop op'>&amp;&amp;</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='leq op'>&lt;=</span> <span class='integer val'>99</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='opasgn op'>+=</span> <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span>
                  <span class='then then kw'>then</span> <span class='integer val'>1900</span> <span class='else else kw'>else</span> <span class='integer val'>2000</span> <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='opasgn op'>||=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span>

  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_day</h3>
</div><div id="_parse_day-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_day</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 668</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L668">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">668
669
670
671
672
673
674
675
676
677
678
679</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_day identifier id'>_parse_day</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\b(#{Format::ABBR_DAYS.keys.join('|')})[^-\d\s]*/i</span><span class='no identifier id'>no</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_DAYS constant id'>ABBR_DAYS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
    <span class='true true kw'>true</span>
<span class='comment val'>=begin
  elsif str.sub!(/\b(?!\dth)(su|mo|tu|we|th|fr|sa)\b/in, ' ')
    e.wday = %w(su mo tu we th fr sa).index($1.downcase)
    true
=end
</span>

  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_ddd</h3>
</div><div id="_parse_ddd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_ddd</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 904</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L904">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_ddd identifier id'>_parse_ddd</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
              <span class='regexp val'>/([-+]?)(\d{2,14})
                (?:
                  \s*
                  t?
                  \s*
                  (\d{2,6})?(?:[,.](\d*))?
                )?
                (?:
                  \s*
                  (
                    z\b
                  |
                    [-+]\d{1,4}\b
                  |
                    \[[-+]?\d[^\]]*\]
                  )
                )?
              /i</span><span class='nx identifier id'>nx</span><span class='comma token'>,</span>
              <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
    <span class='when when kw'>when</span> <span class='integer val'>2</span>
      <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='else else kw'>else</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='integer val'>4</span>
      <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='else else kw'>else</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='integer val'>6</span>
      <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='else else kw'>else</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='integer val'>8</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='comma token'>,</span> <span class='integer val'>12</span><span class='comma token'>,</span> <span class='integer val'>14</span>
      <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-8</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>10</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-10</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
        <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>12</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-12</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
        <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>14</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-14</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
        <span class='end end kw'>end</span>
      <span class='else else kw'>else</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>8</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>10</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>10</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>12</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>12</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>14</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='integer val'>3</span>
      <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='else else kw'>else</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='integer val'>5</span>
      <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-5</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='else else kw'>else</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='integer val'>7</span>
      <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-7</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='else else kw'>else</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='if if kw'>if</span> <span class='$4 nth_ref id'>$4</span>
        <span class='case case kw'>case</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
        <span class='when when kw'>when</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>6</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>6</span>
        <span class='end end kw'>end</span>
      <span class='else else kw'>else</span>
        <span class='case case kw'>case</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
        <span class='when when kw'>when</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>6</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>6</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='$4 nth_ref id'>$4</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$5 nth_ref id'>$5</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>'['</span>
        <span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='assign token'>=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>-2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>':'</span><span class='rparen token'>)</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='n identifier id'>n</span> <span class='orop op'>||</span> <span class='o identifier id'>o</span>
        <span class='if if kw'>if</span> <span class='regexp val'>/\A\d/</span> <span class='match op'>=~</span> <span class='o identifier id'>o</span>
          <span class='o identifier id'>o</span> <span class='assign token'>=</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'+%s'</span><span class='comma token'>,</span> <span class='o identifier id'>o</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_eu</h3>
</div><div id="_parse_eu-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_eu</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <h1>begin</h1>
<pre class="code">
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_beat identifier id'>_parse_beat</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/@\s*(\d&lt;tt&gt;)(?:[,.](\d*))?/</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='beat identifier id'>beat</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='rparen token'>)</span>
      <span class='beat identifier id'>beat</span> <span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;= Rational($2.to_i, 10**$2.size) if $2
      secs = Rational(beat, 1000)
      h, min, s, fr = self.day_fraction_to_time(secs)
      e.hour = h
      e.min = min
      e.sec = s
      e.sec_fraction = fr * 86400
      e.zone = '+01:00'
      true
    end
  end
</span></pre>
<h1>end</h1>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 754</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L754">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_eu identifier id'>_parse_eu</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
              <span class='dregexp node'>/'?(\d+)[^-\d\s]*
               \s*
               (#{Format::ABBR_MONTHS.keys.join('|')})[^-\d\s']*
               (?:
                 \s*
                 (c(?:e|\.e\.)|b(?:ce|\.c\.e\.)|a(?:d|\.d\.)|b(?:c|\.c\.))?
                 \s*
                 ('?-?\d+(?:(?:st|nd|rd|th)\b)?)
               )?
              /i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span>
              <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
    <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$4 nth_ref id'>$4</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span>
        <span class='$3 nth_ref id'>$3</span> <span class='andop op'>&amp;&amp;</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'b'</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_iso</h3>
</div><div id="_parse_iso-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_iso</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 792</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L792">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">792
793
794
795
796
797</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_iso identifier id'>_parse_iso</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/('?[-+]?\d+)-(\d+)-('?-?\d+)/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_iso2</h3>
</div><div id="_parse_iso2-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_iso2</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 799</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L799">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_iso2 identifier id'>_parse_iso2</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b(\d{2}|\d{4})?-?w(\d{2})(?:-?(\d))?\b/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cweek identifier id'>cweek</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwday identifier id'>cwday</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
    <span class='true true kw'>true</span>
  <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/-w-(\d)\b/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwday identifier id'>cwday</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='true true kw'>true</span>
  <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/--(\d{2})?-(\d{2})\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='true true kw'>true</span>
  <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/--(\d{2})(\d{2})?\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
    <span class='true true kw'>true</span>
  <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/[,.](\d{2}|\d{4})-\d{3}\b/n</span> <span class='nmatch op'>!~</span> <span class='str identifier id'>str</span> <span class='andop op'>&amp;&amp;</span>
      <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b(\d{2}|\d{4})-(\d{3})\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='true true kw'>true</span>
  <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\d-\d{3}\b/n</span> <span class='nmatch op'>!~</span> <span class='str identifier id'>str</span> <span class='andop op'>&amp;&amp;</span>
      <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b-(\d{3})\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_jis</h3>
</div><div id="_parse_jis-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_jis</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 828</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L828">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">828
829
830
831
832
833
834
835
836
837
838
839
840</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_jis identifier id'>_parse_jis</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b([mtsh])(\d+)\.(\d+)\.(\d+)/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='era identifier id'>era</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'m'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1867</span><span class='comma token'>,</span>
            <span class='string val'>'t'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1911</span><span class='comma token'>,</span>
            <span class='string val'>'s'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1925</span><span class='comma token'>,</span>
            <span class='string val'>'h'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1988</span>
        <span class='rbrace token'>}</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='plus op'>+</span> <span class='era identifier id'>era</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_mday</h3>
</div><div id="_parse_mday-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_mday</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 897</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L897">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">897
898
899
900
901
902</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_mday identifier id'>_parse_mday</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/(\d+)(st|nd|rd|th)\b/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_mon</h3>
</div><div id="_parse_mon-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_mon</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 890</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L890">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">890
891
892
893
894
895</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_mon identifier id'>_parse_mon</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\b(#{Format::ABBR_MONTHS.keys.join('|')})\S*/i</span><span class='no identifier id'>no</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_sla_eu</h3>
</div><div id="_parse_sla_eu-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_sla_eu</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 861</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L861">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">861
862
863
864
865
866</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_eu identifier id'>_parse_sla_eu</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:[^\d]\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
    <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_sla_ja</h3>
</div><div id="_parse_sla_ja-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_sla_ja</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 854</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L854">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">854
855
856
857
858
859</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_ja identifier id'>_parse_sla_ja</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:[^\d]\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
    <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_sla_jp</h3>
</div><div id="_parse_sla_jp-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_sla_jp</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 876</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L876">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">876
877
878
879
880
881</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_jp identifier id'>_parse_sla_jp</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:\D\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
    <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_sla_us</h3>
</div><div id="_parse_sla_us-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_sla_us</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 868</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L868">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">868
869
870
871
872
873</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_us identifier id'>_parse_sla_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:[^\d]\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
    <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_time</h3>
</div><div id="_parse_time-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_time</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 680</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L680">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_time identifier id'>_parse_time</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
              <span class='regexp val'>/(
                 (?:
                   \d+\s*:\s*\d+
                   (?:
                     \s*:\s*\d+(?:[,.]\d*)?
                   )?
                 |
                   \d+\s*h(?:\s*\d+m?(?:\s*\d+s?)?)?
                 )
                 (?:
                   \s*
                   [ap](?:m\b|\.m\.)
                 )?
               |
                 \d+\s*[ap](?:m\b|\.m\.)
               )
               (?:
                 \s*
                 (
                   (?:gmt|utc?)?[-+]\d+(?:[,.:]\d+(?::\d+)?)?
                 |
                   [[:alpha:].\s]+(?:standard|daylight)\stime\b
                 |
                   [[:alpha:]]+(?:\sdst)?\b
                 )
               )?
              /i</span><span class='nx identifier id'>nx</span><span class='comma token'>,</span>
              <span class='string val'>' '</span><span class='rparen token'>)</span>

    <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>

    <span class='t identifier id'>t</span> <span class='match op'>=~</span> <span class='regexp val'>/\A(\d+)h?
            (?:\s*:?\s*(\d+)m?
              (?:
                \s*:?\s*(\d+)(?:[,.](\d+))?s?
              )?
            )?
          (?:\s*([ap])(?:m\b|\.m\.))?/i</span><span class='nx identifier id'>nx</span>

    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$4 nth_ref id'>$4</span>

    <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>%=</span> <span class='integer val'>12</span>
      <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'p'</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>+=</span> <span class='integer val'>12</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_us</h3>
</div><div id="_parse_us-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_us</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 773</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L773">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_us identifier id'>_parse_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
              <span class='dregexp node'>/\b(#{Format::ABBR_MONTHS.keys.join('|')})[^-\d\s']*
               \s*
               ('?\d+)[^-\d\s']*
               (?:
                 \s*
                 (c(?:e|\.e\.)|b(?:ce|\.c\.e\.)|a(?:d|\.d\.)|b(?:c|\.c\.))?
                 \s*
                 ('?-?\d+)
               )?
              /i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span>
              <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
    <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$4 nth_ref id'>$4</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span>
        <span class='$3 nth_ref id'>$3</span> <span class='andop op'>&amp;&amp;</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'b'</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_vms</h3>
</div><div id="_parse_vms-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_vms</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 842</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L842">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">842
843
844
845
846
847
848
849
850
851
852</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_vms identifier id'>_parse_vms</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/('?-?\d+)-(#{Format::ABBR_MONTHS.keys.join('|')})[^-]*
              -('?-?\d+)/i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\b(#{Format::ABBR_MONTHS.keys.join('|')})[^-]*
              -('?-?\d+)(?:-('?-?\d+))?/i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parse_year</h3>
</div><div id="_parse_year-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parse_year</span><span class='args'>(str, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 883</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L883">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">883
884
885
886
887
888</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_year identifier id'>_parse_year</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/'(\d+)\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_rfc2822</h3>
</div><div id="_rfc2822-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_rfc2822</span><span class='args'>(str)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="_rfc822-class_method">_rfc822</tt>
  
</p>
</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 1185</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L1185">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_rfc2822 identifier id'>_rfc2822</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='dregexp node'>/\A\s*(?:(?:#{Format::ABBR_DAYS.keys.join('|')})\s*,\s+)?
      \d{1,2}\s+
      (?:#{Format::ABBR_MONTHS.keys.join('|')})\s+
      -?(\d{2,})\s+ # allow minus, anyway
      \d{2}:\d{2}(:\d{2})?\s*
      (?:[-+]\d{4}|ut|gmt|e[sd]t|c[sd]t|m[sd]t|p[sd]t|[a-ik-z])\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='lt op'>&lt;</span> <span class='integer val'>4</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='lt op'>&lt;</span> <span class='integer val'>50</span>
        <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='integer val'>2000</span>
      <span class='elsif elsif kw'>elsif</span> <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='lt op'>&lt;</span> <span class='integer val'>1000</span>
        <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='integer val'>1900</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='e identifier id'>e</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_rfc3339</h3>
</div><div id="_rfc3339-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_rfc3339</span><span class='args'>(str)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 1132</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L1132">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1132
1133
1134
1135
1136
1137
1138
1139</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_rfc3339 identifier id'>_rfc3339</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*-?\d{4}-\d{2}-\d{2} # allow minus, anyway
      (t|\s)
      \d{2}:\d{2}:\d{2}(\.\d+)?
      (z|[-+]\d{2}:\d{2})\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_strptime</h3>
</div><div id="_strptime-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_strptime</span><span class='args'>(str, fmt = '%F')</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 570</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L570">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_strptime identifier id'>_strptime</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='assign token'>=</span><span class='string val'>'%F'</span><span class='rparen token'>)</span>
  <span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span>
    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='opasgn op'>+=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='mult op'>*</span> <span class='integer val'>100</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span>  <span class='year identifier id'>year</span> <span class='opasgn op'>+=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='mult op'>*</span> <span class='integer val'>100</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_merid identifier id'>_merid</span>
    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>%=</span> <span class='integer val'>12</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>+=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_merid identifier id'>_merid</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='unless unless kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='leftover identifier id'>leftover</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span>
  <span class='end end kw'>end</span>

  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_strptime_i</h3>
</div><div id="_strptime_i-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_strptime_i</span><span class='args'>(str, fmt, e)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 389</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L389">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='fmt identifier id'>fmt</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='regexp val'>/%([EO]?(?::{1,3}z|.))|(.)/</span><span class='m identifier id'>m</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='comma token'>,</span> <span class='c identifier id'>c</span><span class='bitor op'>|</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span>
    <span class='if if kw'>if</span> <span class='s identifier id'>s</span>
      <span class='case case kw'>case</span> <span class='s identifier id'>s</span>
      <span class='when when kw'>when</span> <span class='string val'>'A'</span><span class='comma token'>,</span> <span class='string val'>'a'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::DAYS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
                      <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::ABBR_DAYS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='DAYS constant id'>DAYS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_DAYS constant id'>ABBR_DAYS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'B'</span><span class='comma token'>,</span> <span class='string val'>'b'</span><span class='comma token'>,</span> <span class='string val'>'h'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::MONTHS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
                      <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::ABBR_MONTHS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='MONTHS constant id'>MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'C'</span><span class='comma token'>,</span> <span class='string val'>'EC'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                               <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,2})/</span>
                               <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                               <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'c'</span><span class='comma token'>,</span> <span class='string val'>'Ec'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%a %b %e %H:%M:%S %Y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'D'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%m/%d/%y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'d'</span><span class='comma token'>,</span> <span class='string val'>'e'</span><span class='comma token'>,</span> <span class='string val'>'Od'</span><span class='comma token'>,</span> <span class='string val'>'Oe'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A( \d|\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>31</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'F'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%Y-%m-%d'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'G'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                               <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,4})/</span>
                               <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                               <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'g'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>99</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='opasgn op'>||=</span> <span class='if if kw'>if</span> <span class='val identifier id'>val</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span> <span class='then then kw'>then</span> <span class='integer val'>19</span> <span class='else else kw'>else</span> <span class='integer val'>20</span> <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='string val'>'H'</span><span class='comma token'>,</span> <span class='string val'>'k'</span><span class='comma token'>,</span> <span class='string val'>'OH'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A( \d|\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>24</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'I'</span><span class='comma token'>,</span> <span class='string val'>'l'</span><span class='comma token'>,</span> <span class='string val'>'OI'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A( \d|\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>12</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'j'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,3})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>366</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'L'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                               <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,3})/</span>
                               <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                               <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
<span class='comment val'>#         val = Rational($1.to_i, 10**3)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'M'</span><span class='comma token'>,</span> <span class='string val'>'OM'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>59</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'m'</span><span class='comma token'>,</span> <span class='string val'>'Om'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>12</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'N'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                               <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,9})/</span>
                               <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                               <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
<span class='comment val'>#         val = Rational($1.to_i, 10**9)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'n'</span><span class='comma token'>,</span> <span class='string val'>'t'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>&quot;\s&quot;</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'P'</span><span class='comma token'>,</span> <span class='string val'>'p'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A([ap])(?:m\b|\.m\.)/i</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_merid identifier id'>_merid</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'a'</span> <span class='then then kw'>then</span> <span class='integer val'>0</span> <span class='else else kw'>else</span> <span class='integer val'>12</span> <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='string val'>'Q'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(-?\d{1,})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='integer val'>3</span><span class='rparen token'>)</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='seconds identifier id'>seconds</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'R'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%H:%M'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'r'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%I:%M:%S %p'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'S'</span><span class='comma token'>,</span> <span class='string val'>'OS'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>60</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'s'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(-?\d{1,})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='seconds identifier id'>seconds</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'T'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%H:%M:%S'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'U'</span><span class='comma token'>,</span> <span class='string val'>'W'</span><span class='comma token'>,</span> <span class='string val'>'OU'</span><span class='comma token'>,</span> <span class='string val'>'OW'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>53</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='s identifier id'>s</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>'U'</span> <span class='then then kw'>then</span> <span class='symbol val'>:wnum0=</span> <span class='else else kw'>else</span> <span class='symbol val'>:wnum1=</span> <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'u'</span><span class='comma token'>,</span> <span class='string val'>'Ou'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>7</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwday identifier id'>cwday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'V'</span><span class='comma token'>,</span> <span class='string val'>'OV'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>53</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cweek identifier id'>cweek</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'v'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%e-%b-%Y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'w'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>6</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'X'</span><span class='comma token'>,</span> <span class='string val'>'EX'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%H:%M:%S'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'x'</span><span class='comma token'>,</span> <span class='string val'>'Ex'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%m/%d/%y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'Y'</span><span class='comma token'>,</span> <span class='string val'>'EY'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                               <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,4})/</span>
                               <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                               <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='when when kw'>when</span> <span class='string val'>'y'</span><span class='comma token'>,</span> <span class='string val'>'Ey'</span><span class='comma token'>,</span> <span class='string val'>'Oy'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>99</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='opasgn op'>||=</span> <span class='if if kw'>if</span> <span class='val identifier id'>val</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span> <span class='then then kw'>then</span> <span class='integer val'>19</span> <span class='else else kw'>else</span> <span class='integer val'>20</span> <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='string val'>'Z'</span><span class='comma token'>,</span> <span class='regexp val'>/\A:{0,3}z/</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A((?:gmt|utc?)?[-+]\d+(?:[,.:]\d+(?::\d+)?)?
                                  |[[:alpha:].\s]+(?:standard|daylight)\s+time\b
                                  |[[:alpha:]]+(?:\s+dst)?\b
                                  )/i</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='val identifier id'>val</span><span class='rparen token'>)</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='offset identifier id'>offset</span>
      <span class='when when kw'>when</span> <span class='string val'>'%'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A%/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='string val'>'+'</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%a %b %e %H:%M:%S %Z %Y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'\\A'</span> <span class='plus op'>+</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='quote identifier id'>quote</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='case case kw'>case</span> <span class='c identifier id'>c</span>
      <span class='when when kw'>when</span> <span class='regexp val'>/\A[\s\v]/</span>
        <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A[\s\v]+/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'\\A'</span> <span class='plus op'>+</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='quote identifier id'>quote</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_xmlschema</h3>
</div><div id="_xmlschema-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_xmlschema</span><span class='args'>(str)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 1141</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L1141">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_xmlschema identifier id'>_xmlschema</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*(-?\d{4,})(?:-(\d{2})(?:-(\d{2}))?)?
      (?:t
        (\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?)?
      (z|[-+]\d{2}:\d{2})?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$4 nth_ref id'>$4</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='$5 nth_ref id'>$5</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$5 nth_ref id'>$5</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='$6 nth_ref id'>$6</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$6 nth_ref id'>$6</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$7 nth_ref id'>$7</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$7 nth_ref id'>$7</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$7 nth_ref id'>$7</span>
    <span class='if if kw'>if</span> <span class='$8 nth_ref id'>$8</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$8 nth_ref id'>$8</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='$8 nth_ref id'>$8</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
  <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?
      (z|[-+]\d{2}:\d{2})?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$4 nth_ref id'>$4</span>
    <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$5 nth_ref id'>$5</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='$5 nth_ref id'>$5</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
  <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(?:--(\d{2})(?:-(\d{2}))?|---(\d{2}))
      (z|[-+]\d{2}:\d{2})?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
    <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
    <span class='if if kw'>if</span> <span class='$4 nth_ref id'>$4</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ajd_to_amjd</h3>
</div><div id="ajd_to_amjd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ajd_to_amjd</span><span class='args'>(ajd)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert an Astronomical Julian Day Number to an Astronomical Modified
Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 526</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L526">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">526</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='ajd_to_amjd identifier id'>ajd_to_amjd</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='rparen token'>)</span> <span class='ajd identifier id'>ajd</span> <span class='minus op'>-</span> <span class='float val'>4800001</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ajd_to_jd</h3>
</div><div id="ajd_to_jd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ajd_to_jd</span><span class='args'>(ajd, of = 0)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert an Astronomical Julian Day Number to a (civil) Julian Day Number.
</p>
<p>
<tt>ajd</tt> is the Astronomical Julian Day Number to convert. <tt>of</tt>
is the offset from UTC as a fraction of a day (defaults to 0).
</p>
<p>
Returns the (civil) Julian Day Number as [day_number, fraction] where
<tt>fraction</tt> is always 1/2.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 492</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L492">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">492</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='ajd_to_jd identifier id'>ajd_to_jd</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span> <span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span> <span class='plus op'>+</span> <span class='of identifier id'>of</span> <span class='plus op'>+</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>amjd_to_ajd</h3>
</div><div id="amjd_to_ajd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>amjd_to_ajd</span><span class='args'>(amjd)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert an Astronomical Modified Julian Day Number to an Astronomical
Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 522</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L522">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">522</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='amjd_to_ajd identifier id'>amjd_to_ajd</span><span class='lparen token'>(</span><span class='amjd identifier id'>amjd</span><span class='rparen token'>)</span> <span class='amjd identifier id'>amjd</span> <span class='plus op'>+</span> <span class='float val'>4800001</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>civil</h3>
</div><div id="civil-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>civil</span><span class='args'>(y = -4712, m = 1, d = 1, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="new-class_method">new</tt>
  
</p>
</div><div class="section docstring">
  <p>
Create a new Date object for the Civil Date specified by year <tt>y</tt>,
month <tt>m</tt>, and day-of-month <tt>d</tt>.
</p>
<p>
<tt>m</tt> and <tt>d</tt> can be negative, in which case they count
backwards from the end of the year and the end of the month respectively.
No wraparound is performed, however, and invalid values cause an
ArgumentError to be raised. can be negative
</p>
<p>
<tt>y</tt> defaults to -4712, <tt>m</tt> to 1, and <tt>d</tt> to 1; this is
Julian Day Number day 0.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 738</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L738">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">738
739
740
741
742
743</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='civil identifier id'>civil</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='assign token'>=</span><span class='integer val'>-4712</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>'invalid date'</span>
  <span class='end end kw'>end</span>
  <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='jd_to_ajd identifier id'>jd_to_ajd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>civil_to_jd</h3>
</div><div id="civil_to_jd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>civil_to_jd</span><span class='args'>(y, m, d, sg = GREGORIAN)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Civil Date to a Julian Day Number. <tt>y</tt>, <tt>m</tt>, and
<tt>d</tt> are the year, month, and day of the month. <tt>sg</tt> specifies
the Day of Calendar Reform.
</p>
<p>
Returns the corresponding Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 396</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L396">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">396
397
398
399
400
401
402
403
404
405
406
407
408
409
410</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='m identifier id'>m</span> <span class='leq op'>&lt;=</span> <span class='integer val'>2</span>
    <span class='y identifier id'>y</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span>
    <span class='m identifier id'>m</span> <span class='opasgn op'>+=</span> <span class='integer val'>12</span>
  <span class='end end kw'>end</span>
  <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span> <span class='div op'>/</span> <span class='float val'>100.0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span>
  <span class='b identifier id'>b</span> <span class='assign token'>=</span> <span class='integer val'>2</span> <span class='minus op'>-</span> <span class='a identifier id'>a</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='div op'>/</span> <span class='float val'>4.0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span>
  <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='float val'>365.25</span> <span class='mult op'>*</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='integer val'>4716</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span> <span class='plus op'>+</span>
    <span class='lparen token'>(</span><span class='float val'>30.6001</span> <span class='mult op'>*</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span> <span class='plus op'>+</span>
    <span class='d identifier id'>d</span> <span class='plus op'>+</span> <span class='b identifier id'>b</span> <span class='minus op'>-</span> <span class='integer val'>1524</span>
  <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='jd identifier id'>jd</span> <span class='opasgn op'>-=</span> <span class='b identifier id'>b</span>
  <span class='end end kw'>end</span>
  <span class='jd identifier id'>jd</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>commercial</h3>
</div><div id="commercial-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>commercial</span><span class='args'>(y = 1582, w = 41, d = 5, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new Date object for the Commercial Date specified by year
<tt>y</tt>, week-of-year <tt>w</tt>, and day-of-week <tt>d</tt>.
</p>
<p>
Monday is day-of-week 1; Sunday is day-of-week 7.
</p>
<p>
<tt>w</tt> and <tt>d</tt> can be negative, in which case they count
backwards from the end of the year and the end of the week respectively. No
wraparound is performed, however, and invalid values cause an ArgumentError
to be raised.
</p>
<p>
<tt>y</tt> defaults to 1582, <tt>w</tt> to 41, and <tt>d</tt> to 5, the Day
of Calendar Reform for Italy and the Catholic countries.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 761</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L761">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">761
762
763
764
765
766</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='commercial identifier id'>commercial</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='assign token'>=</span><span class='integer val'>1582</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='assign token'>=</span><span class='integer val'>41</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='assign token'>=</span><span class='integer val'>5</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_commercial? fid id'>valid_commercial?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>'invalid date'</span>
  <span class='end end kw'>end</span>
  <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='jd_to_ajd identifier id'>jd_to_ajd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>commercial_to_jd</h3>
</div><div id="commercial_to_jd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>commercial_to_jd</span><span class='args'>(y, w, d, ns = GREGORIAN)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Commercial Date to a Julian Day Number.
</p>
<p>
<tt>y</tt>, <tt>w</tt>, and <tt>d</tt> are the (commercial) year, week of
the year, and day of the week of the Commercial Date to convert.
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 445</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L445">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">445
446
447
448
449
450</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='commercial_to_jd identifier id'>commercial_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='assign token'>=</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span>
  <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='rparen token'>)</span>
  <span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='mod op'>%</span> <span class='integer val'>7</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='plus op'>+</span>
    <span class='integer val'>7</span> <span class='mult op'>*</span> <span class='lparen token'>(</span><span class='w identifier id'>w</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span>
    <span class='lparen token'>(</span><span class='d identifier id'>d</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>complete_frags</h3>
</div><div id="complete_frags-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>complete_frags</span><span class='args'>(elem)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 797</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L797">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='complete_frags identifier id'>complete_frags</span><span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='i identifier id'>i</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='symbol val'>:time</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:jd</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='symbol val'>:ordinal</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:yday</span><span class='comma token'>,</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='symbol val'>:civil</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:mon</span><span class='comma token'>,</span> <span class='symbol val'>:mday</span><span class='comma token'>,</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='symbol val'>:commercial</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:cwyear</span><span class='comma token'>,</span> <span class='symbol val'>:cweek</span><span class='comma token'>,</span> <span class='symbol val'>:cwday</span><span class='comma token'>,</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='symbol val'>:wday</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:wday</span><span class='comma token'>,</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='symbol val'>:wnum0</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:wnum0</span><span class='comma token'>,</span> <span class='symbol val'>:wday</span><span class='comma token'>,</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='symbol val'>:wnum1</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:wnum1</span><span class='comma token'>,</span> <span class='symbol val'>:wday</span><span class='comma token'>,</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:cwyear</span><span class='comma token'>,</span> <span class='symbol val'>:cweek</span><span class='comma token'>,</span> <span class='symbol val'>:wday</span><span class='comma token'>,</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:wnum0</span><span class='comma token'>,</span> <span class='symbol val'>:cwday</span><span class='comma token'>,</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='lbrack token'>[</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:wnum1</span><span class='comma token'>,</span> <span class='symbol val'>:cwday</span><span class='comma token'>,</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='dot token'>.</span>
    <span class='collect identifier id'>collect</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='a identifier id'>a</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span><span class='semicolon token'>;</span> <span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='a identifier id'>a</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='dot token'>.</span>
    <span class='select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='a identifier id'>a</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='bitor op'>|</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='rbrace token'>}</span><span class='dot token'>.</span>
    <span class='sort_by identifier id'>sort_by</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='a identifier id'>a</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='comma token'>,</span> <span class='i identifier id'>i</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='last identifier id'>last</span>

  <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

  <span class='if if kw'>if</span> <span class='g identifier id'>g</span> <span class='andop op'>&amp;&amp;</span> <span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='minus op'>-</span> <span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>||=</span> <span class='Date constant id'>Date</span><span class='dot token'>.</span><span class='today identifier id'>today</span>

    <span class='case case kw'>case</span> <span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:ordinal</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:yday</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>1</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:civil</span>
      <span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span>
        <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='rbrack token'>]</span>
        <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:mon</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='integer val'>1</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:mday</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>1</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:commercial</span>
      <span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span>
        <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='rbrack token'>]</span>
        <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:cweek</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>1</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:cwday</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>1</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:wday</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:jd</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lparen token'>(</span><span class='d identifier id'>d</span> <span class='minus op'>-</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='plus op'>+</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:wday</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:wnum0</span>
      <span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span>
        <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='rbrack token'>]</span>
        <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:wnum0</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:wday</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:wnum1</span>
      <span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span>
        <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='rbrack token'>]</span>
        <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='e identifier id'>e</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:wnum1</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:wday</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='g identifier id'>g</span> <span class='andop op'>&amp;&amp;</span> <span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='symbol val'>:time</span>
    <span class='if if kw'>if</span> <span class='self self kw'>self</span> <span class='leq op'>&lt;=</span> <span class='DateTime constant id'>DateTime</span>
      <span class='d identifier id'>d</span> <span class='opasgn op'>||=</span> <span class='Date constant id'>Date</span><span class='dot token'>.</span><span class='today identifier id'>today</span>
      <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:jd</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:hour</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
  <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:min</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
  <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:sec</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
  <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:sec</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:sec</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>59</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='min identifier id'>min</span>

  <span class='elem identifier id'>elem</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>day_fraction_to_time</h3>
</div><div id="day_fraction_to_time-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>day_fraction_to_time</span><span class='args'>(fr)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a fractional day <tt>fr</tt> to [hours, minutes, seconds,
fraction_of_a_second]
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 507</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L507">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">507
508
509
510
511
512</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='day_fraction_to_time identifier id'>day_fraction_to_time</span><span class='lparen token'>(</span><span class='fr identifier id'>fr</span><span class='rparen token'>)</span>
  <span class='h identifier id'>h</span><span class='comma token'>,</span>   <span class='fr identifier id'>fr</span> <span class='assign token'>=</span> <span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>24</span><span class='rparen token'>)</span>
  <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='fr identifier id'>fr</span> <span class='assign token'>=</span> <span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>1440</span><span class='rparen token'>)</span>
  <span class='s identifier id'>s</span><span class='comma token'>,</span>   <span class='fr identifier id'>fr</span> <span class='assign token'>=</span> <span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='h identifier id'>h</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='s identifier id'>s</span><span class='comma token'>,</span> <span class='fr identifier id'>fr</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>fix_style</h3>
</div><div id="fix_style-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>fix_style</span><span class='args'>(jd, sg)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 360</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L360">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">360
361
362
363
364</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='fix_style identifier id'>fix_style</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='then then kw'>then</span> <span class='JULIAN constant id'>JULIAN</span>
  <span class='else else kw'>else</span> <span class='GREGORIAN constant id'>GREGORIAN</span> <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>gregorian?</h3>
</div><div id="gregorian-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>gregorian?</span><span class='args'>(jd, sg)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Does a given Julian Day Number fall inside the new-style (Gregorian)
calendar?
</p>
<p>
The reverse of self.os? See the documentation for that method for more
details.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 358</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L358">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">358</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='notop op'>!</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>gregorian_leap?</h3>
</div><div id="gregorian_leap-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>gregorian_leap?</span><span class='args'>(y)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="leap?-class_method">leap?</tt>
  
</p>
</div><div class="section docstring">
  <p>
Is a year a leap year in the Gregorian calendar?
</p>
<p>
All years divisible by 4 are leap years in the Gregorian calendar, except
for years divisible by 100 and not by 400.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 558</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L558">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">558</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='gregorian_leap? fid id'>gregorian_leap?</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='rparen token'>)</span> <span class='y identifier id'>y</span> <span class='mod op'>%</span> <span class='integer val'>4</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='andop op'>&amp;&amp;</span> <span class='y identifier id'>y</span> <span class='mod op'>%</span> <span class='integer val'>100</span> <span class='neq op'>!=</span> <span class='integer val'>0</span> <span class='orop op'>||</span> <span class='y identifier id'>y</span> <span class='mod op'>%</span> <span class='integer val'>400</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd</h3>
</div><div id="jd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd</span><span class='args'>(jd = 0, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new Date object from a Julian Day Number.
</p>
<p>
<tt>jd</tt> is the Julian Day Number; if not specified, it defaults to 0.
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 703</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L703">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">703
704
705
706</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span>
  <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_jd? fid id'>valid_jd?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='jd_to_ajd identifier id'>jd_to_ajd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd_to_ajd</h3>
</div><div id="jd_to_ajd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd_to_ajd</span><span class='args'>(jd, fr, of = 0)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a (civil) Julian Day Number to an Astronomical Julian Day Number.
</p>
<p>
<tt>jd</tt> is the Julian Day Number to convert, and <tt>fr</tt> is a
fractional day. <tt>of</tt> is the offset from UTC as a fraction of a day
(defaults to 0).
</p>
<p>
Returns the Astronomical Julian Day Number as a single numeric value.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 503</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L503">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">503</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='jd_to_ajd identifier id'>jd_to_ajd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='fr identifier id'>fr</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span> <span class='jd identifier id'>jd</span> <span class='plus op'>+</span> <span class='fr identifier id'>fr</span> <span class='minus op'>-</span> <span class='of identifier id'>of</span> <span class='minus op'>-</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd_to_civil</h3>
</div><div id="jd_to_civil-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd_to_civil</span><span class='args'>(jd, sg = GREGORIAN)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Julian Day Number to a Civil Date. <tt>jd</tt> is the Julian Day
Number. <tt>sg</tt> specifies the Day of Calendar Reform.
</p>
<p>
Returns the corresponding [year, month, day_of_month] as a three-element
array.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 418</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L418">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='jd identifier id'>jd</span>
  <span class='else else kw'>else</span>
    <span class='x identifier id'>x</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='float val'>1867216.25</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='float val'>36524.25</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='jd identifier id'>jd</span> <span class='plus op'>+</span> <span class='integer val'>1</span> <span class='plus op'>+</span> <span class='x identifier id'>x</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span> <span class='div op'>/</span> <span class='float val'>4.0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span>
  <span class='end end kw'>end</span>
  <span class='b identifier id'>b</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span> <span class='plus op'>+</span> <span class='integer val'>1524</span>
  <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='b identifier id'>b</span> <span class='minus op'>-</span> <span class='float val'>122.1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='float val'>365.25</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span>
  <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='float val'>365.25</span> <span class='mult op'>*</span> <span class='c identifier id'>c</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span>
  <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='b identifier id'>b</span> <span class='minus op'>-</span> <span class='d identifier id'>d</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='float val'>30.6001</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span>
  <span class='dom identifier id'>dom</span> <span class='assign token'>=</span> <span class='b identifier id'>b</span> <span class='minus op'>-</span> <span class='d identifier id'>d</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='float val'>30.6001</span> <span class='mult op'>*</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span>
  <span class='if if kw'>if</span> <span class='e identifier id'>e</span> <span class='leq op'>&lt;=</span> <span class='integer val'>13</span>
    <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='e identifier id'>e</span> <span class='minus op'>-</span> <span class='integer val'>1</span>
    <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span> <span class='minus op'>-</span> <span class='integer val'>4716</span>
  <span class='else else kw'>else</span>
    <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='e identifier id'>e</span> <span class='minus op'>-</span> <span class='integer val'>13</span>
    <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span> <span class='minus op'>-</span> <span class='integer val'>4715</span>
  <span class='end end kw'>end</span>
  <span class='return return kw'>return</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='dom identifier id'>dom</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd_to_commercial</h3>
</div><div id="jd_to_commercial-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd_to_commercial</span><span class='args'>(jd, sg = GREGORIAN)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Julian Day Number to a Commercial Date
</p>
<p>
<tt>jd</tt> is the Julian Day Number to convert. <tt>sg</tt> specifies the
Day of Calendar Reform.
</p>
<p>
Returns the corresponding Commercial Date as [commercial_year,
week_of_year, day_of_week]
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 459</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L459">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">459
460
461
462
463
464
465
466
467</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='jd_to_commercial identifier id'>jd_to_commercial</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span>
  <span class='ns identifier id'>ns</span> <span class='assign token'>=</span> <span class='fix_style identifier id'>fix_style</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
  <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='geq op'>&gt;=</span> <span class='commercial_to_jd identifier id'>commercial_to_jd</span><span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='rparen token'>)</span> <span class='then then kw'>then</span> <span class='a identifier id'>a</span> <span class='plus op'>+</span> <span class='integer val'>1</span> <span class='else else kw'>else</span> <span class='a identifier id'>a</span> <span class='end end kw'>end</span>
  <span class='w identifier id'>w</span> <span class='assign token'>=</span> <span class='integer val'>1</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='commercial_to_jd identifier id'>commercial_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='integer val'>7</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span>
  <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='mod op'>%</span> <span class='integer val'>7</span>
  <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='integer val'>7</span> <span class='if if_mod kw'>if</span> <span class='d identifier id'>d</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
  <span class='return return kw'>return</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd_to_ld</h3>
</div><div id="jd_to_ld-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd_to_ld</span><span class='args'>(jd)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Julian Day Number to the number of days since the adoption of the
Gregorian Calendar (in Italy).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 542</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L542">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">542</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='jd_to_ld identifier id'>jd_to_ld</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='integer val'>2299160</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd_to_mjd</h3>
</div><div id="jd_to_mjd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd_to_mjd</span><span class='args'>(jd)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Julian Day Number to a Modified Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 534</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L534">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">534</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='jd_to_mjd identifier id'>jd_to_mjd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='integer val'>2400001</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd_to_ordinal</h3>
</div><div id="jd_to_ordinal-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd_to_ordinal</span><span class='args'>(jd, sg = GREGORIAN)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Julian Day Number to an Ordinal Date.
</p>
<p>
<tt>jd</tt> is the Julian Day Number to convert. <tt>sg</tt> specifies the
Day of Calendar Reform.
</p>
<p>
Returns the corresponding Ordinal Date as [year, day_of_year]
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 385</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L385">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">385
386
387
388
389</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='jd_to_ordinal identifier id'>jd_to_ordinal</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span>
  <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
  <span class='doy identifier id'>doy</span> <span class='assign token'>=</span> <span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>12</span><span class='comma token'>,</span> <span class='integer val'>31</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='doy identifier id'>doy</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd_to_wday</h3>
</div><div id="jd_to_wday-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd_to_wday</span><span class='args'>(jd)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Julian Day Number to the day of the week.
</p>
<p>
Sunday is day-of-week 0; Saturday is day-of-week 6.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 547</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L547">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">547</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='mod op'>%</span> <span class='integer val'>7</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd_to_weeknum</h3>
</div><div id="jd_to_weeknum-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd_to_weeknum</span><span class='args'>(jd, f = 0, sg = GREGORIAN)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 474</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L474">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">474
475
476
477
478
479
480</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='jd_to_weeknum identifier id'>jd_to_weeknum</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='ns identifier id'>ns</span> <span class='assign token'>=</span> <span class='fix_style identifier id'>fix_style</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='rparen token'>)</span>
  <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='integer val'>6</span>
  <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='minus op'>-</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='mod op'>%</span> <span class='integer val'>7</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='integer val'>7</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>7</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>julian?</h3>
</div><div id="julian-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>julian?</span><span class='args'>(jd, sg)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Does a given Julian Day Number fall inside the old-style (Julian) calendar?
</p>
<p>
<tt>jd</tt> is the Julian Day Number in question. <tt>sg</tt> may be
Date::GREGORIAN, in which case the answer is false; it may be Date::JULIAN,
in which case the answer is true; or it may a number representing the Day
of Calendar Reform. Date::ENGLAND and Date::ITALY are two possible such
days.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 340</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L340">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">340
341
342
343
344
345
346
347
348
349
350
351</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='sg identifier id'>sg</span>
  <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span>
    <span class='jd identifier id'>jd</span> <span class='lt op'>&lt;</span> <span class='sg identifier id'>sg</span>
  <span class='else else kw'>else</span>
    <span class='if if kw'>if</span> <span class='$VERBOSE gvar id'>$VERBOSE</span>
      <span class='warn identifier id'>warn</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{caller.shift.sub(/:in .*/, '')}: &quot;</span> \
<span class='string val'>&quot;warning: do not use non-numerical object as julian day number anymore&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='not not kw'>not</span> <span class='sg identifier id'>sg</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>julian_leap?</h3>
</div><div id="julian_leap-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>julian_leap?</span><span class='args'>(y)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Is a year a leap year in the Julian calendar?
</p>
<p>
All years divisible by 4 are leap years in the Julian calendar.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 552</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L552">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">552</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='julian_leap? fid id'>julian_leap?</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='rparen token'>)</span> <span class='y identifier id'>y</span> <span class='mod op'>%</span> <span class='integer val'>4</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ld_to_jd</h3>
</div><div id="ld_to_jd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ld_to_jd</span><span class='args'>(ld)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a count of the number of days since the adoption of the Gregorian
Calendar (in Italy) to a Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 538</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L538">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">538</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='ld_to_jd identifier id'>ld_to_jd</span><span class='lparen token'>(</span><span class='ld identifier id'>ld</span><span class='rparen token'>)</span> <span class='ld identifier id'>ld</span> <span class='plus op'>+</span> <span class='integer val'>2299160</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>mjd_to_jd</h3>
</div><div id="mjd_to_jd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>mjd_to_jd</span><span class='args'>(mjd)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Modified Julian Day Number to a Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 530</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L530">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">530</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='mjd_to_jd identifier id'>mjd_to_jd</span><span class='lparen token'>(</span><span class='mjd identifier id'>mjd</span><span class='rparen token'>)</span> <span class='mjd identifier id'>mjd</span> <span class='plus op'>+</span> <span class='integer val'>2400001</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>new_by_frags</h3>
</div><div id="new_by_frags-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>new_by_frags</span><span class='args'>(elem, sg)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 940</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L940">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">940
941
942
943
944
945
946
947</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='new_by_frags identifier id'>new_by_frags</span><span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='elem identifier id'>elem</span> <span class='assign token'>=</span> <span class='rewrite_frags identifier id'>rewrite_frags</span><span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='rparen token'>)</span>
  <span class='elem identifier id'>elem</span> <span class='assign token'>=</span> <span class='complete_frags identifier id'>complete_frags</span><span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_date_frags? fid id'>valid_date_frags?</span><span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>'invalid date'</span>
  <span class='end end kw'>end</span>
  <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='jd_to_ajd identifier id'>jd_to_ajd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>now</h3>
</div><div id="now-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>now</span><span class='args'>(sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new DateTime object representing the current time.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1641</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1641">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1641</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='now identifier id'>now</span>  <span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='symbol val'>:to_datetime</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>num_pattern?</h3>
</div><div id="num_pattern-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>num_pattern?</span><span class='args'>(s)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <h1>begin</h1>
<pre class="code">
  <span class='def def kw'>def</span> <span class='beat identifier id'>beat</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='i identifier id'>i</span><span class='comma token'>,</span> <span class='f identifier id'>f</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='HOURS_IN_DAY constant id'>HOURS_IN_DAY</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='day_fraction identifier id'>day_fraction</span> <span class='mult op'>*</span> <span class='integer val'>1000</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='lparen token'>(</span><span class='string val'>'@%03d'</span> <span class='mod op'>%</span> <span class='i identifier id'>i</span><span class='rparen token'>)</span> <span class='plus op'>+</span>
      <span class='if if kw'>if</span> <span class='n identifier id'>n</span> <span class='lt op'>&lt;</span> <span class='integer val'>1</span>
        <span class='string val'>''</span>
      <span class='else else kw'>else</span>
        <span class='string val'>'.%0*d'</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='f identifier id'>f</span> <span class='div op'>/</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='round identifier id'>round</span><span class='rbrack token'>]</span>
      <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<h1>end</h1>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 383</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L383">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">383
384
385</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='num_pattern? fid id'>num_pattern?</span> <span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='regexp val'>/\A%[EO]?[CDdeFGgHIjkLlMmNQRrSsTUuVvWwXxYy\d]/</span> <span class='match op'>=~</span> <span class='s identifier id'>s</span> <span class='orop op'>||</span> <span class='regexp val'>/\A\d/</span> <span class='match op'>=~</span> <span class='s identifier id'>s</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ordinal</h3>
</div><div id="ordinal-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ordinal</span><span class='args'>(y = -4712, d = 1, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new Date object from an Ordinal Date, specified by year <tt>y</tt>
and day-of-year <tt>d</tt>. <tt>d</tt> can be negative, in which it counts
backwards from the end of the year. No year wraparound is performed,
however. An invalid value for <tt>d</tt> results in an ArgumentError being
raised.
</p>
<p>
<tt>y</tt> defaults to -4712, and <tt>d</tt> to 1; this is Julian Day
Number day 0.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 718</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L718">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">718
719
720
721
722
723</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='ordinal identifier id'>ordinal</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='assign token'>=</span><span class='integer val'>-4712</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_ordinal? fid id'>valid_ordinal?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>'invalid date'</span>
  <span class='end end kw'>end</span>
  <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='jd_to_ajd identifier id'>jd_to_ajd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ordinal_to_jd</h3>
</div><div id="ordinal_to_jd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ordinal_to_jd</span><span class='args'>(y, d, sg = GREGORIAN)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert an Ordinal Date to a Julian Day Number.
</p>
<p>
<tt>y</tt> and <tt>d</tt> are the year and day-of-year to convert.
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>
<p>
Returns the corresponding Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 374</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L374">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">374
375
376</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='ordinal_to_jd identifier id'>ordinal_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span>
  <span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>parse</h3>
</div><div id="parse-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>parse</span><span class='args'>(str = '-4712-01-01', comp = false, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new Date object by parsing from a String, without specifying the
format.
</p>
<p>
<tt>str</tt> is a String holding a date representation. <tt>comp</tt>
specifies whether to interpret 2-digit years as 19XX (&gt;= 69) or 20XX
(&lt; 69); the default is not to. The method will attempt to parse a date
from the String using various heuristics; see #_parse in date/format.rb for
more details. If parsing fails, an ArgumentError will be raised.
</p>
<p>
The default <tt>str</tt> is &#8217;-4712-01-01&#8217;; this is Julian Day
Number day 0.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 986</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L986">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">986
987
988
989</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='assign token'>=</span><span class='string val'>'-4712-01-01'</span><span class='comma token'>,</span> <span class='comp identifier id'>comp</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span>
  <span class='elem identifier id'>elem</span> <span class='assign token'>=</span> <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='comp identifier id'>comp</span><span class='rparen token'>)</span>
  <span class='new_by_frags identifier id'>new_by_frags</span><span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rewrite_frags</h3>
</div><div id="rewrite_frags-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rewrite_frags</span><span class='args'>(elem)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 777</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L777">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='rewrite_frags identifier id'>rewrite_frags</span><span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='elem identifier id'>elem</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='if if kw'>if</span> <span class='seconds identifier id'>seconds</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:seconds</span><span class='rbrack token'>]</span>
    <span class='d identifier id'>d</span><span class='comma token'>,</span>   <span class='fr identifier id'>fr</span> <span class='assign token'>=</span> <span class='seconds identifier id'>seconds</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>86400</span><span class='rparen token'>)</span>
    <span class='h identifier id'>h</span><span class='comma token'>,</span>   <span class='fr identifier id'>fr</span> <span class='assign token'>=</span> <span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>3600</span><span class='rparen token'>)</span>
    <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='fr identifier id'>fr</span> <span class='assign token'>=</span> <span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>60</span><span class='rparen token'>)</span>
    <span class='s identifier id'>s</span><span class='comma token'>,</span>   <span class='fr identifier id'>fr</span> <span class='assign token'>=</span> <span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:jd</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='UNIX_EPOCH_IN_CJD constant id'>UNIX_EPOCH_IN_CJD</span> <span class='plus op'>+</span> <span class='d identifier id'>d</span>
    <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:hour</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='h identifier id'>h</span>
    <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:min</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='min identifier id'>min</span>
    <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:sec</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='s identifier id'>s</span>
    <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:sec_fraction</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='fr identifier id'>fr</span>
    <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:seconds</span><span class='rparen token'>)</span>
    <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:offset</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='elem identifier id'>elem</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>s3e</h3>
</div><div id="s3e-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>s3e</span><span class='args'>(e, y, m, d, bc = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 598</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L598">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='bc identifier id'>bc</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='m identifier id'>m</span>
    <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='y identifier id'>y</span> <span class='andop op'>&amp;&amp;</span> <span class='m identifier id'>m</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='d identifier id'>d</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='y identifier id'>y</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>
    <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='andop op'>&amp;&amp;</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
      <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span>
      <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='andop op'>&amp;&amp;</span> <span class='d identifier id'>d</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;'&quot;</span>
      <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span>
      <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='y identifier id'>y</span>
    <span class='y identifier id'>y</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='regexp val'>/(\d+)(.+)?/</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='m identifier id'>m</span>
    <span class='if if kw'>if</span> <span class='m identifier id'>m</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;'&quot;</span> <span class='orop op'>||</span> <span class='m identifier id'>m</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
      <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='comment val'># us -&gt; be</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='d identifier id'>d</span>
    <span class='if if kw'>if</span> <span class='d identifier id'>d</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;'&quot;</span> <span class='orop op'>||</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
      <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='y identifier id'>y</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='y identifier id'>y</span>
    <span class='y identifier id'>y</span> <span class='match op'>=~</span> <span class='regexp val'>/([-+])?(\d+)/</span>
    <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span> <span class='orop op'>||</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
      <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
    <span class='end end kw'>end</span>
    <span class='iy identifier id'>iy</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='if if kw'>if</span> <span class='bc identifier id'>bc</span>
      <span class='iy identifier id'>iy</span> <span class='assign token'>=</span> <span class='minus op'>-</span><span class='iy identifier id'>iy</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
    <span class='end end kw'>end</span>
    
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='iy identifier id'>iy</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='m identifier id'>m</span>
    <span class='m identifier id'>m</span> <span class='match op'>=~</span> <span class='regexp val'>/\d+/</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='d identifier id'>d</span>
    <span class='d identifier id'>d</span> <span class='match op'>=~</span> <span class='regexp val'>/\d+/</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='c identifier id'>c</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span>
    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>strptime</h3>
</div><div id="strptime-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>strptime</span><span class='args'>(str = '-4712-01-01', fmt = '%F', sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new Date object by parsing from a String according to a specified
format.
</p>
<p>
<tt>str</tt> is a String holding a date representation. <tt>fmt</tt> is the
format that the date is in. See date/format.rb for details on supported
formats.
</p>
<p>
The default <tt>str</tt> is &#8217;-4712-01-01&#8217;, and the default
<tt>fmt</tt> is &#8217;%F&#8217;, which means Year-Month-Day_of_Month. This
gives Julian Day Number day 0.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>
<p>
An ArgumentError will be raised if <tt>str</tt> cannot be parsed.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 966</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L966">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">966
967
968
969</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='strptime identifier id'>strptime</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='assign token'>=</span><span class='string val'>'-4712-01-01'</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='assign token'>=</span><span class='string val'>'%F'</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span>
  <span class='elem identifier id'>elem</span> <span class='assign token'>=</span> <span class='_strptime identifier id'>_strptime</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='rparen token'>)</span>
  <span class='new_by_frags identifier id'>new_by_frags</span><span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>time_to_day_fraction</h3>
</div><div id="time_to_day_fraction-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>time_to_day_fraction</span><span class='args'>(h, min, s)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert an <tt>h</tt> hour, <tt>min</tt> minutes, <tt>s</tt> seconds period
to a fractional day.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 516</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L516">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">516
517
518</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='time_to_day_fraction identifier id'>time_to_day_fraction</span><span class='lparen token'>(</span><span class='h identifier id'>h</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='s identifier id'>s</span><span class='rparen token'>)</span>
  <span class='h identifier id'>h</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>24</span> <span class='plus op'>+</span> <span class='min identifier id'>min</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>1440</span> <span class='plus op'>+</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>today</h3>
</div><div id="today-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>today</span><span class='args'>(sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new Date object representing today.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1636</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1636">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1636</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='today identifier id'>today</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='symbol val'>:to_date</span><span class='rparen token'>)</span>    <span class='dot token'>.</span><span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>valid_civil?</h3>
</div><div id="valid_civil-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>valid_civil?</span><span class='args'>(y, m, d, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="valid_date?-class_method">valid_date?</tt>
  
</p>
</div><div class="section docstring">
  <p>
Do year <tt>y</tt>, month <tt>m</tt>, and day-of-month <tt>d</tt> make a
valid Civil Date? Returns the corresponding Julian Day Number if they do,
nil if they don&#8217;t.
</p>
<p>
<tt>m</tt> and <tt>d</tt> can be negative, in which case they count
backwards from the end of the year and the end of the month respectively.
No wraparound is performed, however, and invalid values cause an
ArgumentError to be raised. A date falling in the period skipped in the Day
of Calendar Reform adjustment is not valid.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 608</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L608">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='m identifier id'>m</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
    <span class='m identifier id'>m</span> <span class='opasgn op'>+=</span> <span class='integer val'>13</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
    <span class='ny identifier id'>ny</span><span class='comma token'>,</span> <span class='nm identifier id'>nm</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='m identifier id'>m</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='nm identifier id'>nm</span><span class='comma token'>,</span>    <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='nm identifier id'>nm</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='ny identifier id'>ny</span><span class='comma token'>,</span> <span class='nm identifier id'>nm</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='ns identifier id'>ns</span> <span class='assign token'>=</span> <span class='fix_style identifier id'>fix_style</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span><span class='ny identifier id'>ny</span><span class='comma token'>,</span> <span class='nm identifier id'>nm</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='jd identifier id'>jd</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>valid_commercial?</h3>
</div><div id="valid_commercial-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>valid_commercial?</span><span class='args'>(y, w, d, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Do year <tt>y</tt>, week-of-year <tt>w</tt>, and day-of-week <tt>d</tt>
make a valid Commercial Date? Returns the corresponding Julian Day Number
if they do, nil if they don&#8217;t.
</p>
<p>
Monday is day-of-week 1; Sunday is day-of-week 7.
</p>
<p>
<tt>w</tt> and <tt>d</tt> can be negative, in which case they count
backwards from the end of the year and the end of the week respectively. No
wraparound is performed, however, and invalid values cause an ArgumentError
to be raised. A date falling in the period skipped in the Day of Calendar
Reform adjustment is not valid.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 642</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L642">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">642
643
644
645
646
647
648
649
650
651
652
653
654
655
656</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='valid_commercial? fid id'>valid_commercial?</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>+=</span> <span class='integer val'>8</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='w identifier id'>w</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
    <span class='ny identifier id'>ny</span><span class='comma token'>,</span> <span class='nw identifier id'>nw</span><span class='comma token'>,</span> <span class='nd identifier id'>nd</span> <span class='assign token'>=</span>
      <span class='jd_to_commercial identifier id'>jd_to_commercial</span><span class='lparen token'>(</span><span class='commercial_to_jd identifier id'>commercial_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='w identifier id'>w</span> <span class='mult op'>*</span> <span class='integer val'>7</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='ny identifier id'>ny</span> <span class='eq op'>==</span> <span class='y identifier id'>y</span>
    <span class='w identifier id'>w</span> <span class='assign token'>=</span> <span class='nw identifier id'>nw</span>
  <span class='end end kw'>end</span>
  <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='commercial_to_jd identifier id'>commercial_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='jd_to_commercial identifier id'>jd_to_commercial</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='jd identifier id'>jd</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>valid_date_frags?</h3>
</div><div id="valid_date_frags-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>valid_date_frags?</span><span class='args'>(elem, sg)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 873</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L873">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='valid_date_frags? fid id'>valid_date_frags?</span><span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='catch identifier id'>catch</span> <span class='symbol val'>:jd</span> <span class='do do kw'>do</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:jd</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='all? fid id'>all?</span>
      <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_jd? fid id'>valid_jd?</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='lshft op'>&lt;&lt;</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='throw identifier id'>throw</span> <span class='symbol val'>:jd</span><span class='comma token'>,</span> <span class='jd identifier id'>jd</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:yday</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='all? fid id'>all?</span>
      <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_ordinal? fid id'>valid_ordinal?</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='lshft op'>&lt;&lt;</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='throw identifier id'>throw</span> <span class='symbol val'>:jd</span><span class='comma token'>,</span> <span class='jd identifier id'>jd</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:mon</span><span class='comma token'>,</span> <span class='symbol val'>:mday</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='all? fid id'>all?</span>
      <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='lshft op'>&lt;&lt;</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='throw identifier id'>throw</span> <span class='symbol val'>:jd</span><span class='comma token'>,</span> <span class='jd identifier id'>jd</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:cwyear</span><span class='comma token'>,</span> <span class='symbol val'>:cweek</span><span class='comma token'>,</span> <span class='symbol val'>:cwday</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:wday</span><span class='rbrack token'>]</span>
      <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:wday</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span> <span class='orop op'>||</span> <span class='integer val'>7</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='all? fid id'>all?</span>
      <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_commercial? fid id'>valid_commercial?</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='lshft op'>&lt;&lt;</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='throw identifier id'>throw</span> <span class='symbol val'>:jd</span><span class='comma token'>,</span> <span class='jd identifier id'>jd</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:wnum0</span><span class='comma token'>,</span> <span class='symbol val'>:wday</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:cwday</span><span class='rbrack token'>]</span>
      <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:cwday</span><span class='rbrack token'>]</span> <span class='mod op'>%</span> <span class='integer val'>7</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='all? fid id'>all?</span>
      <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_weeknum? fid id'>valid_weeknum?</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='lshft op'>&lt;&lt;</span> <span class='integer val'>0</span> <span class='lshft op'>&lt;&lt;</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='throw identifier id'>throw</span> <span class='symbol val'>:jd</span><span class='comma token'>,</span> <span class='jd identifier id'>jd</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:year</span><span class='comma token'>,</span> <span class='symbol val'>:wnum1</span><span class='comma token'>,</span> <span class='symbol val'>:wday</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
      <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='mod op'>%</span> <span class='integer val'>7</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:cwday</span><span class='rbrack token'>]</span>
      <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='lbrack token'>[</span><span class='symbol val'>:cwday</span><span class='rbrack token'>]</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='mod op'>%</span> <span class='integer val'>7</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='all? fid id'>all?</span>
      <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_weeknum? fid id'>valid_weeknum?</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='lshft op'>&lt;&lt;</span> <span class='integer val'>1</span> <span class='lshft op'>&lt;&lt;</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='throw identifier id'>throw</span> <span class='symbol val'>:jd</span><span class='comma token'>,</span> <span class='jd identifier id'>jd</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>valid_jd?</h3>
</div><div id="valid_jd-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>valid_jd?</span><span class='args'>(jd, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Is <tt>jd</tt> a valid Julian Day Number?
</p>
<p>
If it is, returns it. In fact, any value is treated as a valid Julian Day
Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 567</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L567">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">567</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='valid_jd? fid id'>valid_jd?</span> <span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='jd identifier id'>jd</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>valid_ordinal?</h3>
</div><div id="valid_ordinal-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>valid_ordinal?</span><span class='args'>(y, d, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Do the year <tt>y</tt> and day-of-year <tt>d</tt> make a valid Ordinal
Date? Returns the corresponding Julian Day Number if they do, or nil if
they don&#8217;t.
</p>
<p>
<tt>d</tt> can be a negative number, in which case it counts backwards from
the end of the year (-1 being the last day of the year). No year wraparound
is performed, however, so valid values of <tt>d</tt> are -365 .. -1, 1 ..
365 on a non-leap-year, -366 .. -1, 1 .. 366 on a leap year. A date falling
in the period skipped in the Day of Calendar Reform adjustment is not
valid.
</p>
<p>
<tt>sg</tt> specifies the Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 582</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L582">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">582
583
584
585
586
587
588
589
590
591
592
593
594</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='valid_ordinal? fid id'>valid_ordinal?</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
    <span class='ny identifier id'>ny</span><span class='comma token'>,</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='ordinal_to_jd identifier id'>ordinal_to_jd</span><span class='lparen token'>(</span><span class='ny identifier id'>ny</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='ns identifier id'>ns</span> <span class='assign token'>=</span> <span class='fix_style identifier id'>fix_style</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span><span class='y identifier id'>y</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='jd_to_ordinal identifier id'>jd_to_ordinal</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span><span class='ny identifier id'>ny</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='jd_to_ordinal identifier id'>jd_to_ordinal</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span> <span class='minus op'>-</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='ordinal_to_jd identifier id'>ordinal_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='jd_to_ordinal identifier id'>jd_to_ordinal</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='jd identifier id'>jd</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>valid_time?</h3>
</div><div id="valid_time-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>valid_time?</span><span class='args'>(h, min, s)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Do hour <tt>h</tt>, minute <tt>min</tt>, and second <tt>s</tt> constitute a
valid time?
</p>
<p>
If they do, returns their value as a fraction of a day. If not, returns
nil.
</p>
<p>
The 24-hour clock is used. Negative values of <tt>h</tt>, <tt>min</tt>, and
<tt>sec</tt> are treating as counting backwards from the end of the next
larger unit (e.g. a <tt>min</tt> of -2 is treated as 58). No wraparound is
performed.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 685</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L685">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">685
686
687
688
689
690
691
692
693
694
695
696</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='valid_time? fid id'>valid_time?</span> <span class='lparen token'>(</span><span class='h identifier id'>h</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='s identifier id'>s</span><span class='rparen token'>)</span>
  <span class='h identifier id'>h</span>   <span class='opasgn op'>+=</span> <span class='integer val'>24</span> <span class='if if_mod kw'>if</span> <span class='h identifier id'>h</span>   <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
  <span class='min identifier id'>min</span> <span class='opasgn op'>+=</span> <span class='integer val'>60</span> <span class='if if_mod kw'>if</span> <span class='min identifier id'>min</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
  <span class='s identifier id'>s</span>   <span class='opasgn op'>+=</span> <span class='integer val'>60</span> <span class='if if_mod kw'>if</span> <span class='s identifier id'>s</span>   <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>23</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='h identifier id'>h</span> <span class='andop op'>&amp;&amp;</span>
                 <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>59</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='min identifier id'>min</span> <span class='andop op'>&amp;&amp;</span>
                 <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>59</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='s identifier id'>s</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
                <span class='lparen token'>(</span><span class='integer val'>24</span> <span class='eq op'>==</span> <span class='h identifier id'>h</span> <span class='andop op'>&amp;&amp;</span>
                  <span class='integer val'>0</span> <span class='eq op'>==</span> <span class='min identifier id'>min</span> <span class='andop op'>&amp;&amp;</span>
                  <span class='integer val'>0</span> <span class='eq op'>==</span> <span class='s identifier id'>s</span><span class='rparen token'>)</span>
  <span class='time_to_day_fraction identifier id'>time_to_day_fraction</span><span class='lparen token'>(</span><span class='h identifier id'>h</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='s identifier id'>s</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>valid_time_frags?</h3>
</div><div id="valid_time_frags-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>valid_time_frags?</span><span class='args'>(elem)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 933</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L933">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">933
934
935
936</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='valid_time_frags? fid id'>valid_time_frags?</span> <span class='lparen token'>(</span><span class='elem identifier id'>elem</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='h identifier id'>h</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='s identifier id'>s</span> <span class='assign token'>=</span> <span class='elem identifier id'>elem</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='rparen token'>)</span>
  <span class='valid_time? fid id'>valid_time?</span><span class='lparen token'>(</span><span class='h identifier id'>h</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='s identifier id'>s</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>valid_weeknum?</h3>
</div><div id="valid_weeknum-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>valid_weeknum?</span><span class='args'>(y, w, d, f, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 658</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L658">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">658
659
660
661
662
663
664
665
666
667
668
669
670
671
672</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='valid_weeknum? fid id'>valid_weeknum?</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>+=</span> <span class='integer val'>7</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='w identifier id'>w</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span>
    <span class='ny identifier id'>ny</span><span class='comma token'>,</span> <span class='nw identifier id'>nw</span><span class='comma token'>,</span> <span class='nd identifier id'>nd</span><span class='comma token'>,</span> <span class='nf identifier id'>nf</span> <span class='assign token'>=</span>
      <span class='jd_to_weeknum identifier id'>jd_to_weeknum</span><span class='lparen token'>(</span><span class='weeknum_to_jd identifier id'>weeknum_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='w identifier id'>w</span> <span class='mult op'>*</span> <span class='integer val'>7</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='ny identifier id'>ny</span> <span class='eq op'>==</span> <span class='y identifier id'>y</span>
    <span class='w identifier id'>w</span> <span class='assign token'>=</span> <span class='nw identifier id'>nw</span>
  <span class='end end kw'>end</span>
  <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='weeknum_to_jd identifier id'>weeknum_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='jd_to_weeknum identifier id'>jd_to_weeknum</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
  <span class='jd identifier id'>jd</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>weeknum</h3>
</div><div id="weeknum-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>weeknum</span><span class='args'>(y = 1582, w = 41, d = 5, f = 0, sg = ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 768</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L768">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">768
769
770
771
772
773</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='weeknum identifier id'>weeknum</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='assign token'>=</span><span class='integer val'>1582</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='assign token'>=</span><span class='integer val'>41</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='assign token'>=</span><span class='integer val'>5</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='unless unless kw'>unless</span> <span class='jd identifier id'>jd</span> <span class='assign token'>=</span> <span class='valid_weeknum? fid id'>valid_weeknum?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>'invalid date'</span>
  <span class='end end kw'>end</span>
  <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='jd_to_ajd identifier id'>jd_to_ajd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>weeknum_to_jd</h3>
</div><div id="weeknum_to_jd-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>weeknum_to_jd</span><span class='args'>(y, w, d, f = 0, ns = GREGORIAN)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 469</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L469">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">469
470
471
472</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='weeknum_to_jd identifier id'>weeknum_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='assign token'>=</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='ns identifier id'>ns</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='integer val'>6</span>
  <span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='a identifier id'>a</span> <span class='minus op'>-</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='mod op'>%</span> <span class='integer val'>7</span> <span class='minus op'>-</span> <span class='integer val'>7</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='integer val'>7</span> <span class='mult op'>*</span> <span class='w identifier id'>w</span> <span class='plus op'>+</span> <span class='d identifier id'>d</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>+</h3>
</div><div id="-2B-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>+</span><span class='args'>(n)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return a new Date object that is <tt>n</tt> days later than the current
one.
</p>
<p>
<tt>n</tt> may be a negative value, in which case the new Date is earlier
than the current one; however, #-() might be more intuitive.
</p>
<p>
If <tt>n</tt> is not a Numeric, a TypeError will be thrown. In particular,
two Dates cannot be added to each other.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>TypeError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1214</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1214">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1214
1215
1216
1217
1218
1219</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
  <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>-</h3>
</div><div id="--instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>-</span><span class='args'>(x)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
If <tt>x</tt> is a Numeric value, create a new Date object that is
<tt>x</tt> days earlier than the current one.
</p>
<p>
If <tt>x</tt> is a Date, return the number of days between the two dates;
or, more precisely, how many days later the current date is than
<tt>x</tt>.
</p>
<p>
If <tt>x</tt> is neither Numeric nor a Date, a TypeError is raised.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>TypeError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1229</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1229">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1229
1230
1231
1232
1233
1234
1235</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
  <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
  <span class='end end kw'>end</span>
  <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>&lt;&lt;</h3>
</div><div id="-3C-3C-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'><<</span><span class='args'>(n)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return a new Date object that is <tt>n</tt> months earlier than the current
one.
</p>
<p>
If the day-of-the-month of the current Date is greater than the last day of
the target month, the day-of-the-month of the returned Date will be the
last day of the target month.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1300</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1300">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1300</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>&lt;=</h3>
</div><div id="-3C-3D-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'><=</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Compare this date with another date.
</p>
<p>
<tt>other</tt> can also be a Numeric value, in which case it is interpreted
as an Astronomical Julian Day Number.
</p>
<p>
Comparison is by Astronomical Julian Day Number, including fractional days.
This means that both the time and the timezone offset are taken into
account when comparing two DateTime instances. When comparing a DateTime
instance with a Date instance, the time of the latter will be considered as
falling on midnight UTC.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1248</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1248">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1248
1249
1250
1251
1252
1253
1254</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
  <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
  <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
  <span class='end end kw'>end</span>
  <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>===</h3>
</div><div id="-3D-3D-3D-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>===</span><span class='args'>(other)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The relationship operator for Date.
</p>
<p>
Compares dates by Julian Day Number. When comparing two DateTime instances,
or a DateTime with a Date, the instances will be regarded as equivalent if
they fall on the same date in local time.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1262</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1262">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1262
1263
1264
1265
1266
1267
1268</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
  <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
  <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
  <span class='end end kw'>end</span>
  <span class='false false kw'>false</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>&gt;&gt;</h3>
</div><div id="-3E-3E-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>>></span><span class='args'>(n)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return a new Date object that is <tt>n</tt> months later than the current
one.
</p>
<p>
If the day-of-the-month of the current Date is greater than the last day of
the target month, the day-of-the-month of the returned Date will be the
last day of the target month.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1286</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1286">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1286
1287
1288
1289
1290
1291
1292</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
  <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
  <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
  <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
  <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_dump</h3>
</div><div id="_dump-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_dump</span><span class='args'>(limit)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Dump to Marshal format.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1360</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1360">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1360</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ajd</h3>
</div><div id="ajd-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ajd</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the date as an Astronomical Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1032</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1032">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='ajd identifier id'>ajd</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the date as an Astronomical Modified Julian Day Number.</span>
  <span class='def def kw'>def</span> <span class='amjd identifier id'>amjd</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='ajd_to_amjd identifier id'>ajd_to_amjd</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:amjd</span>

  <span class='comment val'># Get the date as a Julian Day Number.</span>
  <span class='def def kw'>def</span> <span class='jd identifier id'>jd</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='ajd_to_jd identifier id'>ajd_to_jd</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get any fractional day part of the date.</span>
  <span class='def def kw'>def</span> <span class='day_fraction identifier id'>day_fraction</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='ajd_to_jd identifier id'>ajd_to_jd</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the date as a Modified Julian Day Number.</span>
  <span class='def def kw'>def</span> <span class='mjd identifier id'>mjd</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_mjd identifier id'>jd_to_mjd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the date as the number of days since the Day of Calendar</span>
  <span class='comment val'># Reform (in Italy and the Catholic countries).</span>
  <span class='def def kw'>def</span> <span class='ld identifier id'>ld</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_ld identifier id'>jd_to_ld</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:jd</span><span class='comma token'>,</span> <span class='symbol val'>:day_fraction</span><span class='comma token'>,</span> <span class='symbol val'>:mjd</span><span class='comma token'>,</span> <span class='symbol val'>:ld</span>

  <span class='comment val'># Get the date as a Civil Date, [year, month, day_of_month]</span>
  <span class='def def kw'>def</span> <span class='civil identifier id'>civil</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='comment val'># Get the date as an Ordinal Date, [year, day_of_year]</span>
  <span class='def def kw'>def</span> <span class='ordinal identifier id'>ordinal</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_ordinal identifier id'>jd_to_ordinal</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='comment val'># Get the date as a Commercial Date, [year, week_of_year, day_of_week]</span>
  <span class='def def kw'>def</span> <span class='commercial identifier id'>commercial</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_commercial identifier id'>jd_to_commercial</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='def def kw'>def</span> <span class='weeknum0 identifier id'>weeknum0</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='symbol val'>:jd_to_weeknum</span><span class='comma token'>,</span> <span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>
  <span class='def def kw'>def</span> <span class='weeknum1 identifier id'>weeknum1</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='symbol val'>:jd_to_weeknum</span><span class='comma token'>,</span> <span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:civil</span><span class='comma token'>,</span> <span class='symbol val'>:ordinal</span><span class='comma token'>,</span> <span class='symbol val'>:commercial</span><span class='comma token'>,</span> <span class='symbol val'>:weeknum0</span><span class='comma token'>,</span> <span class='symbol val'>:weeknum1</span>
  <span class='private identifier id'>private</span> <span class='symbol val'>:civil</span><span class='comma token'>,</span> <span class='symbol val'>:ordinal</span><span class='comma token'>,</span> <span class='symbol val'>:commercial</span><span class='comma token'>,</span> <span class='symbol val'>:weeknum0</span><span class='comma token'>,</span> <span class='symbol val'>:weeknum1</span>

  <span class='comment val'># Get the year of this date.</span>
  <span class='def def kw'>def</span> <span class='year identifier id'>year</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the day-of-the-year of this date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># January 1 is day-of-the-year 1</span>
  <span class='def def kw'>def</span> <span class='yday identifier id'>yday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='ordinal identifier id'>ordinal</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the month of this date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># January is month 1.</span>
  <span class='def def kw'>def</span> <span class='mon identifier id'>mon</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the day-of-the-month of this date.</span>
  <span class='def def kw'>def</span> <span class='mday identifier id'>mday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:month</span><span class='comma token'>,</span> <span class='symbol val'>:mon</span>
  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:day</span><span class='comma token'>,</span> <span class='symbol val'>:mday</span>

  <span class='def def kw'>def</span> <span class='wnum0 identifier id'>wnum0</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum0 identifier id'>weeknum0</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>
  <span class='def def kw'>def</span> <span class='wnum1 identifier id'>wnum1</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum1 identifier id'>weeknum1</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:wnum0</span><span class='comma token'>,</span> <span class='symbol val'>:wnum1</span>

  <span class='comment val'># Get the time of this date as [hours, minutes, seconds,</span>
  <span class='comment val'># fraction_of_a_second]</span>
  <span class='def def kw'>def</span> <span class='time identifier id'>time</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='day_fraction_to_time identifier id'>day_fraction_to_time</span><span class='lparen token'>(</span><span class='day_fraction identifier id'>day_fraction</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:time</span>
  <span class='private identifier id'>private</span> <span class='symbol val'>:time</span>

  <span class='comment val'># Get the hour of this date.</span>
  <span class='def def kw'>def</span> <span class='hour identifier id'>hour</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the minute of this date.</span>
  <span class='def def kw'>def</span> <span class='min identifier id'>min</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the second of this date.</span>
  <span class='def def kw'>def</span> <span class='sec identifier id'>sec</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the fraction-of-a-second of this date.  The unit is in days.</span>
  <span class='comment val'># I do NOT recommend you to use this method.</span>
  <span class='def def kw'>def</span> <span class='sec_fraction identifier id'>sec_fraction</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='comma token'>,</span> <span class='symbol val'>:sec_fraction</span>

  <span class='def def kw'>def</span> <span class='zone identifier id'>zone</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%:z'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:zone</span>

  <span class='comment val'># Get the commercial year of this date.  See *Commercial* *Date*</span>
  <span class='comment val'># in the introduction for how this differs from the normal year.</span>
  <span class='def def kw'>def</span> <span class='cwyear identifier id'>cwyear</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial week of the year of this date.</span>
  <span class='def def kw'>def</span> <span class='cweek identifier id'>cweek</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial day of the week of this date.  Monday is</span>
  <span class='comment val'># commercial day-of-week 1; Sunday is commercial day-of-week 7.</span>
  <span class='def def kw'>def</span> <span class='cwday identifier id'>cwday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the week day of this date.  Sunday is day-of-week 0;</span>
  <span class='comment val'># Saturday is day-of-week 6.</span>
  <span class='def def kw'>def</span> <span class='wday identifier id'>wday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:wday</span>

<span class='comment val'>=begin
  MONTHNAMES.each_with_index do |n, i|
    if n
      define_method(n.downcase + '?'){mon == i}
    end
  end

  DAYNAMES.each_with_index do |n, i|
    define_method(n.downcase + '?'){wday == i}
  end
=end
</span>


  <span class='comment val'># Is the current date old-style (Julian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Is the current date new-style (Gregorian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:julian?</span><span class='comma token'>,</span> <span class='symbol val'>:gregorian?</span>

  <span class='def def kw'>def</span> <span class='fix_style identifier id'>fix_style</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span>
    <span class='then then kw'>then</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span>
    <span class='else else kw'>else</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span> <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:fix_style</span>

  <span class='comment val'># Is this a leap year?</span>
  <span class='def def kw'>def</span> <span class='leap? fid id'>leap?</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                     <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>29</span>
  <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:leap?</span>

  <span class='comment val'># When is the Day of Calendar Reform for this Date object?</span>
  <span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@sg ivar id'>@sg</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object using a new Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the Italian/Catholic</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the English/Colonial</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Julian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Gregorian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='offset identifier id'>offset</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@of ivar id'>@of</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='of identifier id'>of</span>
      <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:offset</span><span class='comma token'>,</span> <span class='symbol val'>:new_offset</span>

  <span class='comment val'># Return a new Date object that is +n+ days later than the</span>
  <span class='comment val'># current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +n+ may be a negative value, in which case the new Date</span>
  <span class='comment val'># is earlier than the current one; however, #-() might be</span>
  <span class='comment val'># more intuitive.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +n+ is not a Numeric, a TypeError will be thrown.  In</span>
  <span class='comment val'># particular, two Dates cannot be added to each other.</span>
  <span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># If +x+ is a Numeric value, create a new Date object that is</span>
  <span class='comment val'># +x+ days earlier than the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is a Date, return the number of days between the</span>
  <span class='comment val'># two dates; or, more precisely, how many days later the current</span>
  <span class='comment val'># date is than +x+.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is neither Numeric nor a Date, a TypeError is raised.</span>
  <span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Compare this date with another date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ can also be a Numeric value, in which case it is</span>
  <span class='comment val'># interpreted as an Astronomical Julian Day Number.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Comparison is by Astronomical Julian Day Number, including</span>
  <span class='comment val'># fractional days.  This means that both the time and the</span>
  <span class='comment val'># timezone offset are taken into account when comparing</span>
  <span class='comment val'># two DateTime instances.  When comparing a DateTime instance</span>
  <span class='comment val'># with a Date instance, the time of the latter will be</span>
  <span class='comment val'># considered as falling on midnight UTC.</span>
  <span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># The relationship operator for Date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Compares dates by Julian Day Number.  When comparing</span>
  <span class='comment val'># two DateTime instances, or a DateTime with a Date,</span>
  <span class='comment val'># the instances will be regarded as equivalent if they</span>
  <span class='comment val'># fall on the same date in local time.</span>
  <span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='next_day identifier id'>next_day</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span> <span class='end end kw'>end</span>
<span class='comment val'># def prev_day(n=1) self - n end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:next_day</span>

  <span class='comment val'># Return a new Date one day after this one.</span>
  <span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>amjd</h3>
</div><div id="amjd-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>amjd</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the date as an Astronomical Modified Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1035</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1035">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1035</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='amjd identifier id'>amjd</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='ajd_to_amjd identifier id'>ajd_to_amjd</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>asctime</h3>
</div><div id="asctime-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>asctime</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="ctime-instance_method">ctime</tt>
  
</p>
</div><div class="section docstring">
  <p>
alias_method :format, :strftime
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 337</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L337">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">337</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='asctime identifier id'>asctime</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%c'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>cwday</h3>
</div><div id="cwday-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>cwday</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the commercial day of the week of this date. Monday is commercial
day-of-week 1; Sunday is commercial day-of-week 7.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1128</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1128">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='cwday identifier id'>cwday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the week day of this date.  Sunday is day-of-week 0;</span>
  <span class='comment val'># Saturday is day-of-week 6.</span>
  <span class='def def kw'>def</span> <span class='wday identifier id'>wday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:wday</span>

<span class='comment val'>=begin
  MONTHNAMES.each_with_index do |n, i|
    if n
      define_method(n.downcase + '?'){mon == i}
    end
  end

  DAYNAMES.each_with_index do |n, i|
    define_method(n.downcase + '?'){wday == i}
  end
=end
</span>


  <span class='comment val'># Is the current date old-style (Julian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Is the current date new-style (Gregorian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:julian?</span><span class='comma token'>,</span> <span class='symbol val'>:gregorian?</span>

  <span class='def def kw'>def</span> <span class='fix_style identifier id'>fix_style</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span>
    <span class='then then kw'>then</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span>
    <span class='else else kw'>else</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span> <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:fix_style</span>

  <span class='comment val'># Is this a leap year?</span>
  <span class='def def kw'>def</span> <span class='leap? fid id'>leap?</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                     <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>29</span>
  <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:leap?</span>

  <span class='comment val'># When is the Day of Calendar Reform for this Date object?</span>
  <span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@sg ivar id'>@sg</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object using a new Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the Italian/Catholic</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the English/Colonial</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Julian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Gregorian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='offset identifier id'>offset</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@of ivar id'>@of</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='of identifier id'>of</span>
      <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:offset</span><span class='comma token'>,</span> <span class='symbol val'>:new_offset</span>

  <span class='comment val'># Return a new Date object that is +n+ days later than the</span>
  <span class='comment val'># current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +n+ may be a negative value, in which case the new Date</span>
  <span class='comment val'># is earlier than the current one; however, #-() might be</span>
  <span class='comment val'># more intuitive.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +n+ is not a Numeric, a TypeError will be thrown.  In</span>
  <span class='comment val'># particular, two Dates cannot be added to each other.</span>
  <span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># If +x+ is a Numeric value, create a new Date object that is</span>
  <span class='comment val'># +x+ days earlier than the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is a Date, return the number of days between the</span>
  <span class='comment val'># two dates; or, more precisely, how many days later the current</span>
  <span class='comment val'># date is than +x+.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is neither Numeric nor a Date, a TypeError is raised.</span>
  <span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Compare this date with another date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ can also be a Numeric value, in which case it is</span>
  <span class='comment val'># interpreted as an Astronomical Julian Day Number.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Comparison is by Astronomical Julian Day Number, including</span>
  <span class='comment val'># fractional days.  This means that both the time and the</span>
  <span class='comment val'># timezone offset are taken into account when comparing</span>
  <span class='comment val'># two DateTime instances.  When comparing a DateTime instance</span>
  <span class='comment val'># with a Date instance, the time of the latter will be</span>
  <span class='comment val'># considered as falling on midnight UTC.</span>
  <span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># The relationship operator for Date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Compares dates by Julian Day Number.  When comparing</span>
  <span class='comment val'># two DateTime instances, or a DateTime with a Date,</span>
  <span class='comment val'># the instances will be regarded as equivalent if they</span>
  <span class='comment val'># fall on the same date in local time.</span>
  <span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='next_day identifier id'>next_day</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span> <span class='end end kw'>end</span>
<span class='comment val'># def prev_day(n=1) self - n end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:next_day</span>

  <span class='comment val'># Return a new Date one day after this one.</span>
  <span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>cweek</h3>
</div><div id="cweek-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>cweek</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the commercial week of the year of this date.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1124</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1124">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='cweek identifier id'>cweek</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial day of the week of this date.  Monday is</span>
  <span class='comment val'># commercial day-of-week 1; Sunday is commercial day-of-week 7.</span>
  <span class='def def kw'>def</span> <span class='cwday identifier id'>cwday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the week day of this date.  Sunday is day-of-week 0;</span>
  <span class='comment val'># Saturday is day-of-week 6.</span>
  <span class='def def kw'>def</span> <span class='wday identifier id'>wday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:wday</span>

<span class='comment val'>=begin
  MONTHNAMES.each_with_index do |n, i|
    if n
      define_method(n.downcase + '?'){mon == i}
    end
  end

  DAYNAMES.each_with_index do |n, i|
    define_method(n.downcase + '?'){wday == i}
  end
=end
</span>


  <span class='comment val'># Is the current date old-style (Julian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Is the current date new-style (Gregorian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:julian?</span><span class='comma token'>,</span> <span class='symbol val'>:gregorian?</span>

  <span class='def def kw'>def</span> <span class='fix_style identifier id'>fix_style</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span>
    <span class='then then kw'>then</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span>
    <span class='else else kw'>else</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span> <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:fix_style</span>

  <span class='comment val'># Is this a leap year?</span>
  <span class='def def kw'>def</span> <span class='leap? fid id'>leap?</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                     <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>29</span>
  <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:leap?</span>

  <span class='comment val'># When is the Day of Calendar Reform for this Date object?</span>
  <span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@sg ivar id'>@sg</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object using a new Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the Italian/Catholic</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the English/Colonial</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Julian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Gregorian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='offset identifier id'>offset</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@of ivar id'>@of</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='of identifier id'>of</span>
      <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:offset</span><span class='comma token'>,</span> <span class='symbol val'>:new_offset</span>

  <span class='comment val'># Return a new Date object that is +n+ days later than the</span>
  <span class='comment val'># current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +n+ may be a negative value, in which case the new Date</span>
  <span class='comment val'># is earlier than the current one; however, #-() might be</span>
  <span class='comment val'># more intuitive.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +n+ is not a Numeric, a TypeError will be thrown.  In</span>
  <span class='comment val'># particular, two Dates cannot be added to each other.</span>
  <span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># If +x+ is a Numeric value, create a new Date object that is</span>
  <span class='comment val'># +x+ days earlier than the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is a Date, return the number of days between the</span>
  <span class='comment val'># two dates; or, more precisely, how many days later the current</span>
  <span class='comment val'># date is than +x+.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is neither Numeric nor a Date, a TypeError is raised.</span>
  <span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Compare this date with another date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ can also be a Numeric value, in which case it is</span>
  <span class='comment val'># interpreted as an Astronomical Julian Day Number.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Comparison is by Astronomical Julian Day Number, including</span>
  <span class='comment val'># fractional days.  This means that both the time and the</span>
  <span class='comment val'># timezone offset are taken into account when comparing</span>
  <span class='comment val'># two DateTime instances.  When comparing a DateTime instance</span>
  <span class='comment val'># with a Date instance, the time of the latter will be</span>
  <span class='comment val'># considered as falling on midnight UTC.</span>
  <span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># The relationship operator for Date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Compares dates by Julian Day Number.  When comparing</span>
  <span class='comment val'># two DateTime instances, or a DateTime with a Date,</span>
  <span class='comment val'># the instances will be regarded as equivalent if they</span>
  <span class='comment val'># fall on the same date in local time.</span>
  <span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='next_day identifier id'>next_day</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span> <span class='end end kw'>end</span>
<span class='comment val'># def prev_day(n=1) self - n end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:next_day</span>

  <span class='comment val'># Return a new Date one day after this one.</span>
  <span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>cwyear</h3>
</div><div id="cwyear-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>cwyear</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the commercial year of this date. See <b>Commercial</b> <b>Date</b> in
the introduction for how this differs from the normal year.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1121</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1121">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='cwyear identifier id'>cwyear</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial week of the year of this date.</span>
  <span class='def def kw'>def</span> <span class='cweek identifier id'>cweek</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial day of the week of this date.  Monday is</span>
  <span class='comment val'># commercial day-of-week 1; Sunday is commercial day-of-week 7.</span>
  <span class='def def kw'>def</span> <span class='cwday identifier id'>cwday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the week day of this date.  Sunday is day-of-week 0;</span>
  <span class='comment val'># Saturday is day-of-week 6.</span>
  <span class='def def kw'>def</span> <span class='wday identifier id'>wday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:wday</span>

<span class='comment val'>=begin
  MONTHNAMES.each_with_index do |n, i|
    if n
      define_method(n.downcase + '?'){mon == i}
    end
  end

  DAYNAMES.each_with_index do |n, i|
    define_method(n.downcase + '?'){wday == i}
  end
=end
</span>


  <span class='comment val'># Is the current date old-style (Julian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Is the current date new-style (Gregorian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:julian?</span><span class='comma token'>,</span> <span class='symbol val'>:gregorian?</span>

  <span class='def def kw'>def</span> <span class='fix_style identifier id'>fix_style</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span>
    <span class='then then kw'>then</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span>
    <span class='else else kw'>else</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span> <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:fix_style</span>

  <span class='comment val'># Is this a leap year?</span>
  <span class='def def kw'>def</span> <span class='leap? fid id'>leap?</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                     <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>29</span>
  <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:leap?</span>

  <span class='comment val'># When is the Day of Calendar Reform for this Date object?</span>
  <span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@sg ivar id'>@sg</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object using a new Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the Italian/Catholic</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the English/Colonial</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Julian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Gregorian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='offset identifier id'>offset</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@of ivar id'>@of</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='of identifier id'>of</span>
      <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:offset</span><span class='comma token'>,</span> <span class='symbol val'>:new_offset</span>

  <span class='comment val'># Return a new Date object that is +n+ days later than the</span>
  <span class='comment val'># current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +n+ may be a negative value, in which case the new Date</span>
  <span class='comment val'># is earlier than the current one; however, #-() might be</span>
  <span class='comment val'># more intuitive.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +n+ is not a Numeric, a TypeError will be thrown.  In</span>
  <span class='comment val'># particular, two Dates cannot be added to each other.</span>
  <span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># If +x+ is a Numeric value, create a new Date object that is</span>
  <span class='comment val'># +x+ days earlier than the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is a Date, return the number of days between the</span>
  <span class='comment val'># two dates; or, more precisely, how many days later the current</span>
  <span class='comment val'># date is than +x+.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is neither Numeric nor a Date, a TypeError is raised.</span>
  <span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Compare this date with another date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ can also be a Numeric value, in which case it is</span>
  <span class='comment val'># interpreted as an Astronomical Julian Day Number.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Comparison is by Astronomical Julian Day Number, including</span>
  <span class='comment val'># fractional days.  This means that both the time and the</span>
  <span class='comment val'># timezone offset are taken into account when comparing</span>
  <span class='comment val'># two DateTime instances.  When comparing a DateTime instance</span>
  <span class='comment val'># with a Date instance, the time of the latter will be</span>
  <span class='comment val'># considered as falling on midnight UTC.</span>
  <span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># The relationship operator for Date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Compares dates by Julian Day Number.  When comparing</span>
  <span class='comment val'># two DateTime instances, or a DateTime with a Date,</span>
  <span class='comment val'># the instances will be regarded as equivalent if they</span>
  <span class='comment val'># fall on the same date in local time.</span>
  <span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='next_day identifier id'>next_day</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span> <span class='end end kw'>end</span>
<span class='comment val'># def prev_day(n=1) self - n end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:next_day</span>

  <span class='comment val'># Return a new Date one day after this one.</span>
  <span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>day_fraction</h3>
</div><div id="day_fraction-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>day_fraction</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get any fractional day part of the date.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1043</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1043">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1043</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='day_fraction identifier id'>day_fraction</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='ajd_to_jd identifier id'>ajd_to_jd</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>downto</h3>
</div><div id="downto-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>downto</span><span class='args'>(min, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Step backward one day at a time until we reach <tt>min</tt> (inclusive),
yielding each date as we go.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1339</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1339">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1339
1340
1341</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
  <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>england</h3>
</div><div id="england-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>england</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a copy of this Date object that uses the English/Colonial Day of
Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1184</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1184">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1184</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>eql?</h3>
</div><div id="eql-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>eql?</span><span class='args'>(other)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Is this Date equal to <tt>other</tt>?
</p>
<p>
<tt>other</tt> must both be a Date object, and represent the same date.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1346</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1346">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1346</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>gregorian</h3>
</div><div id="gregorian-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>gregorian</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a copy of this Date object that always uses the Gregorian Calendar.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1192</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1192">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1192</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>gregorian?</h3>
</div><div id="gregorian-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>gregorian?</span><span class='args'>(self.class.gregorian?(jd, @sg))</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Is the current date new-style (Gregorian Calendar)?
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1152</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1152">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1152</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>hash</h3>
</div><div id="hash-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>hash</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Calculate a hash value for this date.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1349</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1349">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>httpdate</h3>
</div><div id="httpdate-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>httpdate</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 351</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L351">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">351</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='httpdate identifier id'>httpdate</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%a, %d %b %Y %T GMT'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>inspect</h3>
</div><div id="inspect-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>inspect</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return internal object state as a programmer-readable string.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1352</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1352">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1352</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>iso8601</h3>
</div><div id="iso8601-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>iso8601</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 341</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L341">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">341</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='iso8601 identifier id'>iso8601</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%F'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>italy</h3>
</div><div id="italy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>italy</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a copy of this Date object that uses the Italian/Catholic Day of
Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1180</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1180">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1180</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jd</h3>
</div><div id="jd-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jd</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the date as a Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1040</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1040">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1040</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='jd identifier id'>jd</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='ajd_to_jd identifier id'>ajd_to_jd</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>jisx0301</h3>
</div><div id="jisx0301-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>jisx0301</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 353</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L353">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='jisx0301 identifier id'>jisx0301</span>
  <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='lt op'>&lt;</span> <span class='integer val'>2405160</span>
    <span class='iso8601 identifier id'>iso8601</span>
  <span class='else else kw'>else</span>
    <span class='case case kw'>case</span> <span class='jd identifier id'>jd</span>
    <span class='when when kw'>when</span> <span class='float val'>2405160</span><span class='dot3 op'>...</span><span class='integer val'>2419614</span>
      <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'M%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1867</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='float val'>2419614</span><span class='dot3 op'>...</span><span class='integer val'>2424875</span>
      <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'T%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1911</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='float val'>2424875</span><span class='dot3 op'>...</span><span class='integer val'>2447535</span>
      <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'S%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1925</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'H%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1988</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='g identifier id'>g</span> <span class='plus op'>+</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'.%m.%d'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>julian</h3>
</div><div id="julian-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>julian</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a copy of this Date object that always uses the Julian Calendar.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1188</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1188">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1188</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>julian?</h3>
</div><div id="julian-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>julian?</span><span class='args'>(self.class.julian?(jd, @sg))</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Is the current date old-style (Julian Calendar)?
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1149</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1149">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1149</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ld</h3>
</div><div id="ld-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ld</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the date as the number of days since the Day of Calendar Reform (in
Italy and the Catholic countries).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1050</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1050">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1050</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='ld identifier id'>ld</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_ld identifier id'>jd_to_ld</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>leap?</h3>
</div><div id="leap-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>leap?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Is this a leap year?
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1165</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1165">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1165
1166
1167
1168</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='leap? fid id'>leap?</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                   <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>29</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>mday</h3>
</div><div id="mday-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>mday</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="day-instance_method">day</tt>
  
</p>
</div><div class="section docstring">
  <p>
Get the day-of-the-month of this date.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1083</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1083">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='mday identifier id'>mday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:month</span><span class='comma token'>,</span> <span class='symbol val'>:mon</span>
  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:day</span><span class='comma token'>,</span> <span class='symbol val'>:mday</span>

  <span class='def def kw'>def</span> <span class='wnum0 identifier id'>wnum0</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum0 identifier id'>weeknum0</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>
  <span class='def def kw'>def</span> <span class='wnum1 identifier id'>wnum1</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum1 identifier id'>weeknum1</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:wnum0</span><span class='comma token'>,</span> <span class='symbol val'>:wnum1</span>

  <span class='comment val'># Get the time of this date as [hours, minutes, seconds,</span>
  <span class='comment val'># fraction_of_a_second]</span>
  <span class='def def kw'>def</span> <span class='time identifier id'>time</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='day_fraction_to_time identifier id'>day_fraction_to_time</span><span class='lparen token'>(</span><span class='day_fraction identifier id'>day_fraction</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:time</span>
  <span class='private identifier id'>private</span> <span class='symbol val'>:time</span>

  <span class='comment val'># Get the hour of this date.</span>
  <span class='def def kw'>def</span> <span class='hour identifier id'>hour</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the minute of this date.</span>
  <span class='def def kw'>def</span> <span class='min identifier id'>min</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the second of this date.</span>
  <span class='def def kw'>def</span> <span class='sec identifier id'>sec</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the fraction-of-a-second of this date.  The unit is in days.</span>
  <span class='comment val'># I do NOT recommend you to use this method.</span>
  <span class='def def kw'>def</span> <span class='sec_fraction identifier id'>sec_fraction</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='comma token'>,</span> <span class='symbol val'>:sec_fraction</span>

  <span class='def def kw'>def</span> <span class='zone identifier id'>zone</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%:z'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:zone</span>

  <span class='comment val'># Get the commercial year of this date.  See *Commercial* *Date*</span>
  <span class='comment val'># in the introduction for how this differs from the normal year.</span>
  <span class='def def kw'>def</span> <span class='cwyear identifier id'>cwyear</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial week of the year of this date.</span>
  <span class='def def kw'>def</span> <span class='cweek identifier id'>cweek</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial day of the week of this date.  Monday is</span>
  <span class='comment val'># commercial day-of-week 1; Sunday is commercial day-of-week 7.</span>
  <span class='def def kw'>def</span> <span class='cwday identifier id'>cwday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the week day of this date.  Sunday is day-of-week 0;</span>
  <span class='comment val'># Saturday is day-of-week 6.</span>
  <span class='def def kw'>def</span> <span class='wday identifier id'>wday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:wday</span>

<span class='comment val'>=begin
  MONTHNAMES.each_with_index do |n, i|
    if n
      define_method(n.downcase + '?'){mon == i}
    end
  end

  DAYNAMES.each_with_index do |n, i|
    define_method(n.downcase + '?'){wday == i}
  end
=end
</span>


  <span class='comment val'># Is the current date old-style (Julian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Is the current date new-style (Gregorian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:julian?</span><span class='comma token'>,</span> <span class='symbol val'>:gregorian?</span>

  <span class='def def kw'>def</span> <span class='fix_style identifier id'>fix_style</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span>
    <span class='then then kw'>then</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span>
    <span class='else else kw'>else</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span> <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:fix_style</span>

  <span class='comment val'># Is this a leap year?</span>
  <span class='def def kw'>def</span> <span class='leap? fid id'>leap?</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                     <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>29</span>
  <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:leap?</span>

  <span class='comment val'># When is the Day of Calendar Reform for this Date object?</span>
  <span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@sg ivar id'>@sg</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object using a new Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the Italian/Catholic</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the English/Colonial</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Julian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Gregorian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='offset identifier id'>offset</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@of ivar id'>@of</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='of identifier id'>of</span>
      <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:offset</span><span class='comma token'>,</span> <span class='symbol val'>:new_offset</span>

  <span class='comment val'># Return a new Date object that is +n+ days later than the</span>
  <span class='comment val'># current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +n+ may be a negative value, in which case the new Date</span>
  <span class='comment val'># is earlier than the current one; however, #-() might be</span>
  <span class='comment val'># more intuitive.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +n+ is not a Numeric, a TypeError will be thrown.  In</span>
  <span class='comment val'># particular, two Dates cannot be added to each other.</span>
  <span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># If +x+ is a Numeric value, create a new Date object that is</span>
  <span class='comment val'># +x+ days earlier than the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is a Date, return the number of days between the</span>
  <span class='comment val'># two dates; or, more precisely, how many days later the current</span>
  <span class='comment val'># date is than +x+.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is neither Numeric nor a Date, a TypeError is raised.</span>
  <span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Compare this date with another date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ can also be a Numeric value, in which case it is</span>
  <span class='comment val'># interpreted as an Astronomical Julian Day Number.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Comparison is by Astronomical Julian Day Number, including</span>
  <span class='comment val'># fractional days.  This means that both the time and the</span>
  <span class='comment val'># timezone offset are taken into account when comparing</span>
  <span class='comment val'># two DateTime instances.  When comparing a DateTime instance</span>
  <span class='comment val'># with a Date instance, the time of the latter will be</span>
  <span class='comment val'># considered as falling on midnight UTC.</span>
  <span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># The relationship operator for Date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Compares dates by Julian Day Number.  When comparing</span>
  <span class='comment val'># two DateTime instances, or a DateTime with a Date,</span>
  <span class='comment val'># the instances will be regarded as equivalent if they</span>
  <span class='comment val'># fall on the same date in local time.</span>
  <span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='next_day identifier id'>next_day</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span> <span class='end end kw'>end</span>
<span class='comment val'># def prev_day(n=1) self - n end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:next_day</span>

  <span class='comment val'># Return a new Date one day after this one.</span>
  <span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>mjd</h3>
</div><div id="mjd-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>mjd</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the date as a Modified Julian Day Number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1046</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1046">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1046</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='mjd identifier id'>mjd</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_mjd identifier id'>jd_to_mjd</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>mon</h3>
</div><div id="mon-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>mon</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="month-instance_method">month</tt>
  
</p>
</div><div class="section docstring">
  <p>
Get the month of this date.
</p>
<p>
January is month 1.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1080</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1080">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='mon identifier id'>mon</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the day-of-the-month of this date.</span>
  <span class='def def kw'>def</span> <span class='mday identifier id'>mday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:month</span><span class='comma token'>,</span> <span class='symbol val'>:mon</span>
  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:day</span><span class='comma token'>,</span> <span class='symbol val'>:mday</span>

  <span class='def def kw'>def</span> <span class='wnum0 identifier id'>wnum0</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum0 identifier id'>weeknum0</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>
  <span class='def def kw'>def</span> <span class='wnum1 identifier id'>wnum1</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum1 identifier id'>weeknum1</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:wnum0</span><span class='comma token'>,</span> <span class='symbol val'>:wnum1</span>

  <span class='comment val'># Get the time of this date as [hours, minutes, seconds,</span>
  <span class='comment val'># fraction_of_a_second]</span>
  <span class='def def kw'>def</span> <span class='time identifier id'>time</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='day_fraction_to_time identifier id'>day_fraction_to_time</span><span class='lparen token'>(</span><span class='day_fraction identifier id'>day_fraction</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:time</span>
  <span class='private identifier id'>private</span> <span class='symbol val'>:time</span>

  <span class='comment val'># Get the hour of this date.</span>
  <span class='def def kw'>def</span> <span class='hour identifier id'>hour</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the minute of this date.</span>
  <span class='def def kw'>def</span> <span class='min identifier id'>min</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the second of this date.</span>
  <span class='def def kw'>def</span> <span class='sec identifier id'>sec</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the fraction-of-a-second of this date.  The unit is in days.</span>
  <span class='comment val'># I do NOT recommend you to use this method.</span>
  <span class='def def kw'>def</span> <span class='sec_fraction identifier id'>sec_fraction</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='comma token'>,</span> <span class='symbol val'>:sec_fraction</span>

  <span class='def def kw'>def</span> <span class='zone identifier id'>zone</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%:z'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:zone</span>

  <span class='comment val'># Get the commercial year of this date.  See *Commercial* *Date*</span>
  <span class='comment val'># in the introduction for how this differs from the normal year.</span>
  <span class='def def kw'>def</span> <span class='cwyear identifier id'>cwyear</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial week of the year of this date.</span>
  <span class='def def kw'>def</span> <span class='cweek identifier id'>cweek</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial day of the week of this date.  Monday is</span>
  <span class='comment val'># commercial day-of-week 1; Sunday is commercial day-of-week 7.</span>
  <span class='def def kw'>def</span> <span class='cwday identifier id'>cwday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the week day of this date.  Sunday is day-of-week 0;</span>
  <span class='comment val'># Saturday is day-of-week 6.</span>
  <span class='def def kw'>def</span> <span class='wday identifier id'>wday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:wday</span>

<span class='comment val'>=begin
  MONTHNAMES.each_with_index do |n, i|
    if n
      define_method(n.downcase + '?'){mon == i}
    end
  end

  DAYNAMES.each_with_index do |n, i|
    define_method(n.downcase + '?'){wday == i}
  end
=end
</span>


  <span class='comment val'># Is the current date old-style (Julian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Is the current date new-style (Gregorian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:julian?</span><span class='comma token'>,</span> <span class='symbol val'>:gregorian?</span>

  <span class='def def kw'>def</span> <span class='fix_style identifier id'>fix_style</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span>
    <span class='then then kw'>then</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span>
    <span class='else else kw'>else</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span> <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:fix_style</span>

  <span class='comment val'># Is this a leap year?</span>
  <span class='def def kw'>def</span> <span class='leap? fid id'>leap?</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                     <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>29</span>
  <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:leap?</span>

  <span class='comment val'># When is the Day of Calendar Reform for this Date object?</span>
  <span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@sg ivar id'>@sg</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object using a new Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the Italian/Catholic</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the English/Colonial</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Julian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Gregorian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='offset identifier id'>offset</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@of ivar id'>@of</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='of identifier id'>of</span>
      <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:offset</span><span class='comma token'>,</span> <span class='symbol val'>:new_offset</span>

  <span class='comment val'># Return a new Date object that is +n+ days later than the</span>
  <span class='comment val'># current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +n+ may be a negative value, in which case the new Date</span>
  <span class='comment val'># is earlier than the current one; however, #-() might be</span>
  <span class='comment val'># more intuitive.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +n+ is not a Numeric, a TypeError will be thrown.  In</span>
  <span class='comment val'># particular, two Dates cannot be added to each other.</span>
  <span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># If +x+ is a Numeric value, create a new Date object that is</span>
  <span class='comment val'># +x+ days earlier than the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is a Date, return the number of days between the</span>
  <span class='comment val'># two dates; or, more precisely, how many days later the current</span>
  <span class='comment val'># date is than +x+.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is neither Numeric nor a Date, a TypeError is raised.</span>
  <span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Compare this date with another date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ can also be a Numeric value, in which case it is</span>
  <span class='comment val'># interpreted as an Astronomical Julian Day Number.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Comparison is by Astronomical Julian Day Number, including</span>
  <span class='comment val'># fractional days.  This means that both the time and the</span>
  <span class='comment val'># timezone offset are taken into account when comparing</span>
  <span class='comment val'># two DateTime instances.  When comparing a DateTime instance</span>
  <span class='comment val'># with a Date instance, the time of the latter will be</span>
  <span class='comment val'># considered as falling on midnight UTC.</span>
  <span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># The relationship operator for Date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Compares dates by Julian Day Number.  When comparing</span>
  <span class='comment val'># two DateTime instances, or a DateTime with a Date,</span>
  <span class='comment val'># the instances will be regarded as equivalent if they</span>
  <span class='comment val'># fall on the same date in local time.</span>
  <span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='next_day identifier id'>next_day</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span> <span class='end end kw'>end</span>
<span class='comment val'># def prev_day(n=1) self - n end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:next_day</span>

  <span class='comment val'># Return a new Date one day after this one.</span>
  <span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>new_start</h3>
</div><div id="new_start-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>new_start</span><span class='args'>(sg = self.class::ITALY)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a copy of this Date object using a new Day of Calendar Reform.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1176</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1176">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1176</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>next</h3>
</div><div id="next-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>next</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="succ-instance_method">succ</tt>
  
</p>
</div><div class="section docstring">
  <p>
Return a new Date one day after this one.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1276</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1276">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rfc2822</h3>
</div><div id="rfc2822-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rfc2822</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="rfc822-instance_method">rfc822</tt>
  
</p>
</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 347</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L347">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">347</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='rfc2822 identifier id'>rfc2822</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%a, %-d %b %Y %T %z'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rfc3339</h3>
</div><div id="rfc3339-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rfc3339</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 343</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L343">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='rfc3339 identifier id'>rfc3339</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='iso8601 identifier id'>iso8601</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='xmlschema identifier id'>xmlschema</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='iso8601 identifier id'>iso8601</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='def def kw'>def</span> <span class='rfc2822 identifier id'>rfc2822</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%a, %-d %b %Y %T %z'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:rfc822</span><span class='comma token'>,</span> <span class='symbol val'>:rfc2822</span>

  <span class='def def kw'>def</span> <span class='httpdate identifier id'>httpdate</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%a, %d %b %Y %T GMT'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='def def kw'>def</span> <span class='jisx0301 identifier id'>jisx0301</span>
    <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='lt op'>&lt;</span> <span class='integer val'>2405160</span>
      <span class='iso8601 identifier id'>iso8601</span>
    <span class='else else kw'>else</span>
      <span class='case case kw'>case</span> <span class='jd identifier id'>jd</span>
      <span class='when when kw'>when</span> <span class='float val'>2405160</span><span class='dot3 op'>...</span><span class='integer val'>2419614</span>
        <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'M%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1867</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='float val'>2419614</span><span class='dot3 op'>...</span><span class='integer val'>2424875</span>
        <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'T%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1911</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='float val'>2424875</span><span class='dot3 op'>...</span><span class='integer val'>2447535</span>
        <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'S%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1925</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'H%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1988</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='g identifier id'>g</span> <span class='plus op'>+</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'.%m.%d'</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def beat(n=0)
    i, f = (new_offset(HOURS_IN_DAY).day_fraction * 1000).divmod(1)
    ('@%03d' % i) +
      if n &lt; 1
        ''
      else
        '.%0*d' % [n, (f / Rational(1, 10**n)).round]
      end
  end
=end
</span>


  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='num_pattern? fid id'>num_pattern?</span> <span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='regexp val'>/\A%[EO]?[CDdeFGgHIjkLlMmNQRrSsTUuVvWwXxYy\d]/</span> <span class='match op'>=~</span> <span class='s identifier id'>s</span> <span class='orop op'>||</span> <span class='regexp val'>/\A\d/</span> <span class='match op'>=~</span> <span class='s identifier id'>s</span>
  <span class='end end kw'>end</span>

  <span class='private_class_method identifier id'>private_class_method</span> <span class='symbol val'>:num_pattern?</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='fmt identifier id'>fmt</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='regexp val'>/%([EO]?(?::{1,3}z|.))|(.)/</span><span class='m identifier id'>m</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='comma token'>,</span> <span class='c identifier id'>c</span><span class='bitor op'>|</span>
      <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span>
      <span class='if if kw'>if</span> <span class='s identifier id'>s</span>
        <span class='case case kw'>case</span> <span class='s identifier id'>s</span>
        <span class='when when kw'>when</span> <span class='string val'>'A'</span><span class='comma token'>,</span> <span class='string val'>'a'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::DAYS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
                        <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::ABBR_DAYS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='DAYS constant id'>DAYS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_DAYS constant id'>ABBR_DAYS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'B'</span><span class='comma token'>,</span> <span class='string val'>'b'</span><span class='comma token'>,</span> <span class='string val'>'h'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::MONTHS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
                        <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::ABBR_MONTHS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='MONTHS constant id'>MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'C'</span><span class='comma token'>,</span> <span class='string val'>'EC'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,2})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'c'</span><span class='comma token'>,</span> <span class='string val'>'Ec'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%a %b %e %H:%M:%S %Y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'D'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%m/%d/%y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'d'</span><span class='comma token'>,</span> <span class='string val'>'e'</span><span class='comma token'>,</span> <span class='string val'>'Od'</span><span class='comma token'>,</span> <span class='string val'>'Oe'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A( \d|\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>31</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'F'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%Y-%m-%d'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'G'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,4})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'g'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>99</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='opasgn op'>||=</span> <span class='if if kw'>if</span> <span class='val identifier id'>val</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span> <span class='then then kw'>then</span> <span class='integer val'>19</span> <span class='else else kw'>else</span> <span class='integer val'>20</span> <span class='end end kw'>end</span>
        <span class='when when kw'>when</span> <span class='string val'>'H'</span><span class='comma token'>,</span> <span class='string val'>'k'</span><span class='comma token'>,</span> <span class='string val'>'OH'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A( \d|\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>24</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'I'</span><span class='comma token'>,</span> <span class='string val'>'l'</span><span class='comma token'>,</span> <span class='string val'>'OI'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A( \d|\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>12</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'j'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,3})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>366</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'L'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,3})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
<span class='comment val'>#         val = Rational($1.to_i, 10**3)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'M'</span><span class='comma token'>,</span> <span class='string val'>'OM'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>59</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'m'</span><span class='comma token'>,</span> <span class='string val'>'Om'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>12</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'N'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,9})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
<span class='comment val'>#         val = Rational($1.to_i, 10**9)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'n'</span><span class='comma token'>,</span> <span class='string val'>'t'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>&quot;\s&quot;</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'P'</span><span class='comma token'>,</span> <span class='string val'>'p'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A([ap])(?:m\b|\.m\.)/i</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_merid identifier id'>_merid</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'a'</span> <span class='then then kw'>then</span> <span class='integer val'>0</span> <span class='else else kw'>else</span> <span class='integer val'>12</span> <span class='end end kw'>end</span>
        <span class='when when kw'>when</span> <span class='string val'>'Q'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(-?\d{1,})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='integer val'>3</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='seconds identifier id'>seconds</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'R'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%H:%M'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'r'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%I:%M:%S %p'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'S'</span><span class='comma token'>,</span> <span class='string val'>'OS'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>60</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'s'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(-?\d{1,})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='seconds identifier id'>seconds</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'T'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%H:%M:%S'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'U'</span><span class='comma token'>,</span> <span class='string val'>'W'</span><span class='comma token'>,</span> <span class='string val'>'OU'</span><span class='comma token'>,</span> <span class='string val'>'OW'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>53</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='s identifier id'>s</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>'U'</span> <span class='then then kw'>then</span> <span class='symbol val'>:wnum0=</span> <span class='else else kw'>else</span> <span class='symbol val'>:wnum1=</span> <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'u'</span><span class='comma token'>,</span> <span class='string val'>'Ou'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>7</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwday identifier id'>cwday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'V'</span><span class='comma token'>,</span> <span class='string val'>'OV'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>53</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cweek identifier id'>cweek</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'v'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%e-%b-%Y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'w'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>6</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'X'</span><span class='comma token'>,</span> <span class='string val'>'EX'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%H:%M:%S'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'x'</span><span class='comma token'>,</span> <span class='string val'>'Ex'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%m/%d/%y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'Y'</span><span class='comma token'>,</span> <span class='string val'>'EY'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,4})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'y'</span><span class='comma token'>,</span> <span class='string val'>'Ey'</span><span class='comma token'>,</span> <span class='string val'>'Oy'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>99</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='opasgn op'>||=</span> <span class='if if kw'>if</span> <span class='val identifier id'>val</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span> <span class='then then kw'>then</span> <span class='integer val'>19</span> <span class='else else kw'>else</span> <span class='integer val'>20</span> <span class='end end kw'>end</span>
        <span class='when when kw'>when</span> <span class='string val'>'Z'</span><span class='comma token'>,</span> <span class='regexp val'>/\A:{0,3}z/</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A((?:gmt|utc?)?[-+]\d+(?:[,.:]\d+(?::\d+)?)?
                                    |[[:alpha:].\s]+(?:standard|daylight)\s+time\b
                                    |[[:alpha:]]+(?:\s+dst)?\b
                                    )/i</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
          <span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='val identifier id'>val</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='offset identifier id'>offset</span>
        <span class='when when kw'>when</span> <span class='string val'>'%'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A%/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'+'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%a %b %e %H:%M:%S %Z %Y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'\\A'</span> <span class='plus op'>+</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='quote identifier id'>quote</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
      <span class='else else kw'>else</span>
        <span class='case case kw'>case</span> <span class='c identifier id'>c</span>
        <span class='when when kw'>when</span> <span class='regexp val'>/\A[\s\v]/</span>
          <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A[\s\v]+/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'\\A'</span> <span class='plus op'>+</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='quote identifier id'>quote</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private_class_method identifier id'>private_class_method</span> <span class='symbol val'>:_strptime_i</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_strptime identifier id'>_strptime</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='assign token'>=</span><span class='string val'>'%F'</span><span class='rparen token'>)</span>
    <span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>

    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='opasgn op'>+=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='mult op'>*</span> <span class='integer val'>100</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span>  <span class='year identifier id'>year</span> <span class='opasgn op'>+=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='mult op'>*</span> <span class='integer val'>100</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_merid identifier id'>_merid</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>%=</span> <span class='integer val'>12</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>+=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_merid identifier id'>_merid</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='unless unless kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='leftover identifier id'>leftover</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span>
    <span class='end end kw'>end</span>

    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='bc identifier id'>bc</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='rparen token'>)</span>
    <span class='unless unless kw'>unless</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='m identifier id'>m</span>
      <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='y identifier id'>y</span> <span class='andop op'>&amp;&amp;</span> <span class='m identifier id'>m</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='d identifier id'>d</span>
      <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='y identifier id'>y</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>
      <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='andop op'>&amp;&amp;</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
        <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span>
        <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='andop op'>&amp;&amp;</span> <span class='d identifier id'>d</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;'&quot;</span>
        <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span>
        <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='y identifier id'>y</span>
      <span class='y identifier id'>y</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='regexp val'>/(\d+)(.+)?/</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span>
        <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='m identifier id'>m</span>
      <span class='if if kw'>if</span> <span class='m identifier id'>m</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;'&quot;</span> <span class='orop op'>||</span> <span class='m identifier id'>m</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
        <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='comment val'># us -&gt; be</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='d identifier id'>d</span>
      <span class='if if kw'>if</span> <span class='d identifier id'>d</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;'&quot;</span> <span class='orop op'>||</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
        <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='y identifier id'>y</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='y identifier id'>y</span>
      <span class='y identifier id'>y</span> <span class='match op'>=~</span> <span class='regexp val'>/([-+])?(\d+)/</span>
      <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span> <span class='orop op'>||</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
        <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
      <span class='end end kw'>end</span>
      <span class='iy identifier id'>iy</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='if if kw'>if</span> <span class='bc identifier id'>bc</span>
        <span class='iy identifier id'>iy</span> <span class='assign token'>=</span> <span class='minus op'>-</span><span class='iy identifier id'>iy</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
      <span class='end end kw'>end</span>
      
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='iy identifier id'>iy</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='m identifier id'>m</span>
      <span class='m identifier id'>m</span> <span class='match op'>=~</span> <span class='regexp val'>/\d+/</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='d identifier id'>d</span>
      <span class='d identifier id'>d</span> <span class='match op'>=~</span> <span class='regexp val'>/\d+/</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='c identifier id'>c</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span>
    <span class='end end kw'>end</span>

  <span class='end end kw'>end</span>

  <span class='private_class_method identifier id'>private_class_method</span> <span class='symbol val'>:s3e</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_day identifier id'>_parse_day</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\b(#{Format::ABBR_DAYS.keys.join('|')})[^-\d\s]*/i</span><span class='no identifier id'>no</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_DAYS constant id'>ABBR_DAYS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
      <span class='true true kw'>true</span>
<span class='comment val'>=begin
    elsif str.sub!(/\b(?!\dth)(su|mo|tu|we|th|fr|sa)\b/in, ' ')
      e.wday = %w(su mo tu we th fr sa).index($1.downcase)
      true
=end
</span>

    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_time identifier id'>_parse_time</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
                <span class='regexp val'>/(
                   (?:
                     \d+\s*:\s*\d+
                     (?:
                       \s*:\s*\d+(?:[,.]\d*)?
                     )?
                   |
                     \d+\s*h(?:\s*\d+m?(?:\s*\d+s?)?)?
                   )
                   (?:
                     \s*
                     [ap](?:m\b|\.m\.)
                   )?
                 |
                   \d+\s*[ap](?:m\b|\.m\.)
                 )
                 (?:
                   \s*
                   (
                     (?:gmt|utc?)?[-+]\d+(?:[,.:]\d+(?::\d+)?)?
                   |
                     [[:alpha:].\s]+(?:standard|daylight)\stime\b
                   |
                     [[:alpha:]]+(?:\sdst)?\b
                   )
                 )?
                /i</span><span class='nx identifier id'>nx</span><span class='comma token'>,</span>
                <span class='string val'>' '</span><span class='rparen token'>)</span>

      <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>

      <span class='t identifier id'>t</span> <span class='match op'>=~</span> <span class='regexp val'>/\A(\d+)h?
              (?:\s*:?\s*(\d+)m?
                (?:
                  \s*:?\s*(\d+)(?:[,.](\d+))?s?
                )?
              )?
            (?:\s*([ap])(?:m\b|\.m\.))?/i</span><span class='nx identifier id'>nx</span>

      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$4 nth_ref id'>$4</span>

      <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>%=</span> <span class='integer val'>12</span>
        <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'p'</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>+=</span> <span class='integer val'>12</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def self._parse_beat(str, e) # :nodoc:
    if str.sub!(/@\s*(\d+)(?:[,.](\d*))?/, ' ')
      beat = Rational($1.to_i)
      beat += Rational($2.to_i, 10**$2.size) if $2
      secs = Rational(beat, 1000)
      h, min, s, fr = self.day_fraction_to_time(secs)
      e.hour = h
      e.min = min
      e.sec = s
      e.sec_fraction = fr * 86400
      e.zone = '+01:00'
      true
    end
  end
=end
</span>


  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_eu identifier id'>_parse_eu</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
                <span class='dregexp node'>/'?(\d+)[^-\d\s]*
                 \s*
                 (#{Format::ABBR_MONTHS.keys.join('|')})[^-\d\s']*
                 (?:
                   \s*
                   (c(?:e|\.e\.)|b(?:ce|\.c\.e\.)|a(?:d|\.d\.)|b(?:c|\.c\.))?
                   \s*
                   ('?-?\d+(?:(?:st|nd|rd|th)\b)?)
                 )?
                /i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span>
                <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$4 nth_ref id'>$4</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span>
          <span class='$3 nth_ref id'>$3</span> <span class='andop op'>&amp;&amp;</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'b'</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_us identifier id'>_parse_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
                <span class='dregexp node'>/\b(#{Format::ABBR_MONTHS.keys.join('|')})[^-\d\s']*
                 \s*
                 ('?\d+)[^-\d\s']*
                 (?:
                   \s*
                   (c(?:e|\.e\.)|b(?:ce|\.c\.e\.)|a(?:d|\.d\.)|b(?:c|\.c\.))?
                   \s*
                   ('?-?\d+)
                 )?
                /i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span>
                <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$4 nth_ref id'>$4</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span>
          <span class='$3 nth_ref id'>$3</span> <span class='andop op'>&amp;&amp;</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'b'</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_iso identifier id'>_parse_iso</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/('?[-+]?\d+)-(\d+)-('?-?\d+)/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_iso2 identifier id'>_parse_iso2</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b(\d{2}|\d{4})?-?w(\d{2})(?:-?(\d))?\b/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cweek identifier id'>cweek</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwday identifier id'>cwday</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/-w-(\d)\b/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwday identifier id'>cwday</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/--(\d{2})?-(\d{2})\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/--(\d{2})(\d{2})?\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/[,.](\d{2}|\d{4})-\d{3}\b/n</span> <span class='nmatch op'>!~</span> <span class='str identifier id'>str</span> <span class='andop op'>&amp;&amp;</span>
        <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b(\d{2}|\d{4})-(\d{3})\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\d-\d{3}\b/n</span> <span class='nmatch op'>!~</span> <span class='str identifier id'>str</span> <span class='andop op'>&amp;&amp;</span>
        <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b-(\d{3})\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_jis identifier id'>_parse_jis</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b([mtsh])(\d+)\.(\d+)\.(\d+)/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='era identifier id'>era</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'m'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1867</span><span class='comma token'>,</span>
              <span class='string val'>'t'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1911</span><span class='comma token'>,</span>
              <span class='string val'>'s'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1925</span><span class='comma token'>,</span>
              <span class='string val'>'h'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1988</span>
          <span class='rbrace token'>}</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='plus op'>+</span> <span class='era identifier id'>era</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_vms identifier id'>_parse_vms</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/('?-?\d+)-(#{Format::ABBR_MONTHS.keys.join('|')})[^-]*
                -('?-?\d+)/i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\b(#{Format::ABBR_MONTHS.keys.join('|')})[^-]*
                -('?-?\d+)(?:-('?-?\d+))?/i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_ja identifier id'>_parse_sla_ja</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:[^\d]\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
 
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_eu identifier id'>_parse_sla_eu</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:[^\d]\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_us identifier id'>_parse_sla_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:[^\d]\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>


  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_jp identifier id'>_parse_sla_jp</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:\D\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_year identifier id'>_parse_year</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/'(\d+)\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_mon identifier id'>_parse_mon</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\b(#{Format::ABBR_MONTHS.keys.join('|')})\S*/i</span><span class='no identifier id'>no</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_mday identifier id'>_parse_mday</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/(\d+)(st|nd|rd|th)\b/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_ddd identifier id'>_parse_ddd</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
                <span class='regexp val'>/([-+]?)(\d{2,14})
                  (?:
                    \s*
                    t?
                    \s*
                    (\d{2,6})?(?:[,.](\d*))?
                  )?
                  (?:
                    \s*
                    (
                      z\b
                    |
                      [-+]\d{1,4}\b
                    |
                      \[[-+]?\d[^\]]*\]
                    )
                  )?
                /i</span><span class='nx identifier id'>nx</span><span class='comma token'>,</span>
                <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='case case kw'>case</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
      <span class='when when kw'>when</span> <span class='integer val'>2</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>4</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>6</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>8</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='comma token'>,</span> <span class='integer val'>12</span><span class='comma token'>,</span> <span class='integer val'>14</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-8</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>10</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-10</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='end end kw'>end</span>
          <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>12</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-12</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='end end kw'>end</span>
          <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>14</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-14</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
          <span class='end end kw'>end</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>8</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>10</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>10</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>12</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>12</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>14</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>3</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>5</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-5</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>7</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-7</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span>
        <span class='if if kw'>if</span> <span class='$4 nth_ref id'>$4</span>
          <span class='case case kw'>case</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
          <span class='when when kw'>when</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>6</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>4</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>6</span>
          <span class='end end kw'>end</span>
        <span class='else else kw'>else</span>
          <span class='case case kw'>case</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
          <span class='when when kw'>when</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>6</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>4</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>6</span>
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$5 nth_ref id'>$5</span>
        <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>'['</span>
          <span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='assign token'>=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>-2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>':'</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='n identifier id'>n</span> <span class='orop op'>||</span> <span class='o identifier id'>o</span>
          <span class='if if kw'>if</span> <span class='regexp val'>/\A\d/</span> <span class='match op'>=~</span> <span class='o identifier id'>o</span>
            <span class='o identifier id'>o</span> <span class='assign token'>=</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'+%s'</span><span class='comma token'>,</span> <span class='o identifier id'>o</span><span class='rparen token'>)</span>
          <span class='end end kw'>end</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private_class_method identifier id'>private_class_method</span> <span class='symbol val'>:_parse_day</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_time</span><span class='comma token'>,</span> <span class='comment val'># :_parse_beat,</span>
        <span class='symbol val'>:_parse_eu</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_us</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_iso</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_iso2</span><span class='comma token'>,</span>
        <span class='symbol val'>:_parse_jis</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_vms</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_sla_jp</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_sla_eu</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_sla_us</span><span class='comma token'>,</span>
        <span class='symbol val'>:_parse_year</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_mon</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_mday</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_ddd</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='comp identifier id'>comp</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='rparen token'>)</span>
    <span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>

    <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='comp identifier id'>comp</span>

    <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/[^-+',.\/:@[:alnum:]\[\]\x80-\xff]+/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>

    <span class='_parse_time identifier id'>_parse_time</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># || _parse_beat(str, e)</span>
    <span class='_parse_day identifier id'>_parse_day</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>

    <span class='_parse_eu identifier id'>_parse_eu</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>     <span class='orop op'>||</span>
    <span class='_parse_us identifier id'>_parse_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>     <span class='orop op'>||</span>
    <span class='_parse_iso identifier id'>_parse_iso</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
    <span class='_parse_jis identifier id'>_parse_jis</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
    <span class='_parse_vms identifier id'>_parse_vms</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
    <span class='_parse_sla_us identifier id'>_parse_sla_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
    <span class='_parse_iso2 identifier id'>_parse_iso2</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>   <span class='orop op'>||</span>
    <span class='_parse_year identifier id'>_parse_year</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>   <span class='orop op'>||</span>
    <span class='_parse_mon identifier id'>_parse_mon</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
    <span class='_parse_mday identifier id'>_parse_mday</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>   <span class='orop op'>||</span>
    <span class='_parse_ddd identifier id'>_parse_ddd</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>

    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b(bc\b|bce\b|b\.c\.|b\.c\.e\.)/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='minus op'>-</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A\s*(\d{1,2})\s*\z/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span>
        <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>31</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='v identifier id'>v</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span>
        <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>24</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='v identifier id'>v</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span>
        <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span> <span class='andop op'>&amp;&amp;</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='leq op'>&lt;=</span> <span class='integer val'>99</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='opasgn op'>+=</span> <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span>
                      <span class='then then kw'>then</span> <span class='integer val'>1900</span> <span class='else else kw'>else</span> <span class='integer val'>2000</span> <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
        <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span> <span class='andop op'>&amp;&amp;</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='leq op'>&lt;=</span> <span class='integer val'>99</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='opasgn op'>+=</span> <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span>
                    <span class='then then kw'>then</span> <span class='integer val'>1900</span> <span class='else else kw'>else</span> <span class='integer val'>2000</span> <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='opasgn op'>||=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span>

    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_iso8601 identifier id'>_iso8601</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*(([-+]?\d{2,}|-)-\d{2}-\d{2}|
              ([-+]?\d{2,})?-\d{3}|
              (\d{2}|\d{4})?-w\d{2}-\d|
              -w-\d)
        (t
        \d{2}:\d{2}(:\d{2}([,.]\d+)?)?
        (z|[-+]\d{2}(:?\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(([-+]?(\d{2}|\d{4})|--)\d{2}\d{2}|
              ([-+]?(\d{2}|\d{4}))?\d{3}|-\d{3}|
              (\d{2}|\d{4})?w\d{2}\d)
        (t?
        \d{2}\d{2}(\d{2}([,.]\d+)?)?
        (z|[-+]\d{2}(\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(\d{2}:\d{2}(:\d{2}([,.]\d+)?)?
        (z|[-+]\d{2}(:?\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(\d{2}\d{2}(\d{2}([,.]\d+)?)?
        (z|[-+]\d{2}(\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_rfc3339 identifier id'>_rfc3339</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*-?\d{4}-\d{2}-\d{2} # allow minus, anyway
        (t|\s)
        \d{2}:\d{2}:\d{2}(\.\d+)?
        (z|[-+]\d{2}:\d{2})\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_xmlschema identifier id'>_xmlschema</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*(-?\d{4,})(?:-(\d{2})(?:-(\d{2}))?)?
        (?:t
          (\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?)?
        (z|[-+]\d{2}:\d{2})?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$4 nth_ref id'>$4</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='$5 nth_ref id'>$5</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$5 nth_ref id'>$5</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='$6 nth_ref id'>$6</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$6 nth_ref id'>$6</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$7 nth_ref id'>$7</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$7 nth_ref id'>$7</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$7 nth_ref id'>$7</span>
      <span class='if if kw'>if</span> <span class='$8 nth_ref id'>$8</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$8 nth_ref id'>$8</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='$8 nth_ref id'>$8</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?
        (z|[-+]\d{2}:\d{2})?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$4 nth_ref id'>$4</span>
      <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$5 nth_ref id'>$5</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='$5 nth_ref id'>$5</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(?:--(\d{2})(?:-(\d{2}))?|---(\d{2}))
        (z|[-+]\d{2}:\d{2})?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='if if kw'>if</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_rfc2822 identifier id'>_rfc2822</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='dregexp node'>/\A\s*(?:(?:#{Format::ABBR_DAYS.keys.join('|')})\s*,\s+)?
        \d{1,2}\s+
        (?:#{Format::ABBR_MONTHS.keys.join('|')})\s+
        -?(\d{2,})\s+ # allow minus, anyway
        \d{2}:\d{2}(:\d{2})?\s*
        (?:[-+]\d{4}|ut|gmt|e[sd]t|c[sd]t|m[sd]t|p[sd]t|[a-ik-z])\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='lt op'>&lt;</span> <span class='integer val'>4</span>
        <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='lt op'>&lt;</span> <span class='integer val'>50</span>
          <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='integer val'>2000</span>
        <span class='elsif elsif kw'>elsif</span> <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='lt op'>&lt;</span> <span class='integer val'>1000</span>
          <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='integer val'>1900</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='e identifier id'>e</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='class class kw'>class</span> <span class='lshft op'>&lt;&lt;</span> <span class='self self kw'>self</span><span class='semicolon token'>;</span> <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:_rfc822</span><span class='comma token'>,</span> <span class='symbol val'>:_rfc2822</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_httpdate identifier id'>_httpdate</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='dregexp node'>/\A\s*(#{Format::ABBR_DAYS.keys.join('|')})\s*,\s+
        \d{2}\s+
        (#{Format::ABBR_MONTHS.keys.join('|')})\s+
        -?\d{4}\s+ # allow minus, anyway
        \d{2}:\d{2}:\d{2}\s+
        gmt\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_rfc2822 identifier id'>_rfc2822</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='dregexp node'>/\A\s*(#{Format::DAYS.keys.join('|')})\s*,\s+
        \d{2}\s*-\s*
        (#{Format::ABBR_MONTHS.keys.join('|')})\s*-\s*
        \d{2}\s+
        \d{2}:\d{2}:\d{2}\s+
        gmt\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='dregexp node'>/\A\s*(#{Format::ABBR_DAYS.keys.join('|')})\s+
        (#{Format::ABBR_MONTHS.keys.join('|')})\s+
        \d{1,2}\s+
        \d{2}:\d{2}:\d{2}\s+
        \d{4}\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_jisx0301 identifier id'>_jisx0301</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*[mtsh]?\d{2}\.\d{2}\.\d{2}
        (t
        (\d{2}:\d{2}(:\d{2}([,.]\d*)?)?
        (z|[-+]\d{2}(:?\d{2})?)?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*\d/</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
        <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/\A\s*(\d)/</span><span class='comma token'>,</span> <span class='string val'>'h\1'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='_iso8601 identifier id'>_iso8601</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='Module constant id'>Module</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span>

    <span class='private identifier id'>private</span>

    <span class='def def kw'>def</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='zone identifier id'>zone</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
      <span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span>
      <span class='if if kw'>if</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\s+(standard|daylight)\s+time\z/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='dst identifier id'>dst</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span> <span class='eq op'>==</span> <span class='string val'>'daylight'</span>
      <span class='else else kw'>else</span>
        <span class='dst identifier id'>dst</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\s+dst\z/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ZONES constant id'>ZONES</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='zone identifier id'>zone</span><span class='rparen token'>)</span>
        <span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ZONES constant id'>ZONES</span><span class='lbrack token'>[</span><span class='zone identifier id'>zone</span><span class='rbrack token'>]</span>
        <span class='offset identifier id'>offset</span> <span class='opasgn op'>+=</span> <span class='integer val'>3600</span> <span class='if if_mod kw'>if</span> <span class='dst identifier id'>dst</span>
      <span class='elsif elsif kw'>elsif</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(?:gmt|utc?)?([-+])/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='sign identifier id'>sign</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
        <span class='if if kw'>if</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>':'</span><span class='rparen token'>)</span>
          <span class='hour identifier id'>hour</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='sec identifier id'>sec</span><span class='comma token'>,</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>':'</span><span class='rparen token'>)</span>
        <span class='elsif elsif kw'>elsif</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>'.'</span><span class='rparen token'>)</span>
          <span class='hour identifier id'>hour</span><span class='comma token'>,</span> <span class='fr identifier id'>fr</span><span class='comma token'>,</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/[,.]/</span><span class='rparen token'>)</span>
          <span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='mult op'>*</span> <span class='integer val'>60</span>
        <span class='else else kw'>else</span>
          <span class='case case kw'>case</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
          <span class='when when kw'>when</span> <span class='integer val'>3</span>
            <span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
            <span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
          <span class='else else kw'>else</span>
            <span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
            <span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
            <span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>4</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
        <span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='hour identifier id'>hour</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='mult op'>*</span> <span class='integer val'>3600</span> <span class='plus op'>+</span> <span class='min identifier id'>min</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='mult op'>*</span> <span class='integer val'>60</span> <span class='plus op'>+</span> <span class='sec identifier id'>sec</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='offset identifier id'>offset</span> <span class='opasgn op'>*=</span> <span class='integer val'>-1</span> <span class='if if_mod kw'>if</span> <span class='sign identifier id'>sign</span> <span class='eq op'>==</span> <span class='string val'>'-'</span>
      <span class='end end kw'>end</span>
      <span class='offset identifier id'>offset</span>
    <span class='end end kw'>end</span>

  <span class='end end kw'>end</span>

  <span class='extend identifier id'>extend</span>  <span class='t identifier id'>t</span>
  <span class='include identifier id'>include</span> <span class='t identifier id'>t</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>start</h3>
</div><div id="start-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>start</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
When is the Day of Calendar Reform for this Date object?
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1173</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1173">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@sg ivar id'>@sg</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object using a new Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the Italian/Catholic</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the English/Colonial</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Julian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Gregorian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='offset identifier id'>offset</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@of ivar id'>@of</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='of identifier id'>of</span>
      <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:offset</span><span class='comma token'>,</span> <span class='symbol val'>:new_offset</span>

  <span class='comment val'># Return a new Date object that is +n+ days later than the</span>
  <span class='comment val'># current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +n+ may be a negative value, in which case the new Date</span>
  <span class='comment val'># is earlier than the current one; however, #-() might be</span>
  <span class='comment val'># more intuitive.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +n+ is not a Numeric, a TypeError will be thrown.  In</span>
  <span class='comment val'># particular, two Dates cannot be added to each other.</span>
  <span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># If +x+ is a Numeric value, create a new Date object that is</span>
  <span class='comment val'># +x+ days earlier than the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is a Date, return the number of days between the</span>
  <span class='comment val'># two dates; or, more precisely, how many days later the current</span>
  <span class='comment val'># date is than +x+.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is neither Numeric nor a Date, a TypeError is raised.</span>
  <span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Compare this date with another date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ can also be a Numeric value, in which case it is</span>
  <span class='comment val'># interpreted as an Astronomical Julian Day Number.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Comparison is by Astronomical Julian Day Number, including</span>
  <span class='comment val'># fractional days.  This means that both the time and the</span>
  <span class='comment val'># timezone offset are taken into account when comparing</span>
  <span class='comment val'># two DateTime instances.  When comparing a DateTime instance</span>
  <span class='comment val'># with a Date instance, the time of the latter will be</span>
  <span class='comment val'># considered as falling on midnight UTC.</span>
  <span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># The relationship operator for Date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Compares dates by Julian Day Number.  When comparing</span>
  <span class='comment val'># two DateTime instances, or a DateTime with a Date,</span>
  <span class='comment val'># the instances will be regarded as equivalent if they</span>
  <span class='comment val'># fall on the same date in local time.</span>
  <span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='next_day identifier id'>next_day</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span> <span class='end end kw'>end</span>
<span class='comment val'># def prev_day(n=1) self - n end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:next_day</span>

  <span class='comment val'># Return a new Date one day after this one.</span>
  <span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>step</h3>
</div><div id="step-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>step</span><span class='args'>(limit, step = 1)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Step the current date forward <tt>step</tt> days at a time (or backward, if
<tt>step</tt> is negative) until we reach <tt>limit</tt> (inclusive),
yielding the resultant date at each step.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1316</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1316">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
  unless block_given?
    return to_enum(:step, limit, step)
  end
=end
</span>

  <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
  <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
  <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
    <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
    <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>strftime</h3>
</div><div id="strftime-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>strftime</span><span class='args'>(fmt = '%F')</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 217</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L217">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='fmt identifier id'>fmt</span><span class='assign token'>=</span><span class='string val'>'%F'</span><span class='rparen token'>)</span>
  <span class='fmt identifier id'>fmt</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/%([-_0^#]+)?(\d+)?([EO]?(?::{1,3}z|.))/</span><span class='m identifier id'>m</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='m identifier id'>m</span><span class='bitor op'>|</span>
    <span class='f identifier id'>f</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span>
    <span class='s identifier id'>s</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span>
    <span class='if if kw'>if</span> <span class='s identifier id'>s</span>
      <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='regexp val'>/./</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='bitor op'>|</span>
        <span class='case case kw'>case</span> <span class='k identifier id'>k</span>
        <span class='when when kw'>when</span> <span class='string val'>'-'</span><span class='semicolon token'>;</span> <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:p</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>'-'</span>
        <span class='when when kw'>when</span> <span class='string val'>'_'</span><span class='semicolon token'>;</span> <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:p</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;\s&quot;</span>
        <span class='when when kw'>when</span> <span class='string val'>'0'</span><span class='semicolon token'>;</span> <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:p</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>'0'</span>
        <span class='when when kw'>when</span> <span class='string val'>'^'</span><span class='semicolon token'>;</span> <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:u</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
        <span class='when when kw'>when</span> <span class='string val'>'#'</span><span class='semicolon token'>;</span> <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:x</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='w identifier id'>w</span>
      <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:w</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='w identifier id'>w</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='end end kw'>end</span>
    <span class='case case kw'>case</span> <span class='c identifier id'>c</span>
    <span class='when when kw'>when</span> <span class='string val'>'A'</span><span class='semicolon token'>;</span> <span class='emit_ad identifier id'>emit_ad</span><span class='lparen token'>(</span><span class='DAYNAMES constant id'>DAYNAMES</span><span class='lbrack token'>[</span><span class='wday identifier id'>wday</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'a'</span><span class='semicolon token'>;</span> <span class='emit_ad identifier id'>emit_ad</span><span class='lparen token'>(</span><span class='ABBR_DAYNAMES constant id'>ABBR_DAYNAMES</span><span class='lbrack token'>[</span><span class='wday identifier id'>wday</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'B'</span><span class='semicolon token'>;</span> <span class='emit_ad identifier id'>emit_ad</span><span class='lparen token'>(</span><span class='MONTHNAMES constant id'>MONTHNAMES</span><span class='lbrack token'>[</span><span class='mon identifier id'>mon</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'b'</span><span class='semicolon token'>;</span> <span class='emit_ad identifier id'>emit_ad</span><span class='lparen token'>(</span><span class='ABBR_MONTHNAMES constant id'>ABBR_MONTHNAMES</span><span class='lbrack token'>[</span><span class='mon identifier id'>mon</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'C'</span><span class='comma token'>,</span> <span class='string val'>'EC'</span><span class='semicolon token'>;</span> <span class='emit_sn identifier id'>emit_sn</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='div op'>/</span> <span class='integer val'>100</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'c'</span><span class='comma token'>,</span> <span class='string val'>'Ec'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%a %b %e %H:%M:%S %Y'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'D'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%m/%d/%y'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'d'</span><span class='comma token'>,</span> <span class='string val'>'Od'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='mday identifier id'>mday</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'e'</span><span class='comma token'>,</span> <span class='string val'>'Oe'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='mday identifier id'>mday</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'F'</span>
      <span class='if if kw'>if</span> <span class='m identifier id'>m</span> <span class='eq op'>==</span> <span class='string val'>'%F'</span>
        <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'%.4d-%02d-%02d'</span><span class='comma token'>,</span> <span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='mon identifier id'>mon</span><span class='comma token'>,</span> <span class='mday identifier id'>mday</span><span class='rparen token'>)</span> <span class='comment val'># 4p</span>
      <span class='else else kw'>else</span>
        <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%Y-%m-%d'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='string val'>'G'</span><span class='semicolon token'>;</span> <span class='emit_sn identifier id'>emit_sn</span><span class='lparen token'>(</span><span class='cwyear identifier id'>cwyear</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'g'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='cwyear identifier id'>cwyear</span> <span class='mod op'>%</span> <span class='integer val'>100</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'H'</span><span class='comma token'>,</span> <span class='string val'>'OH'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='hour identifier id'>hour</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'h'</span><span class='semicolon token'>;</span> <span class='emit_ad identifier id'>emit_ad</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%b'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'I'</span><span class='comma token'>,</span> <span class='string val'>'OI'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='hour identifier id'>hour</span> <span class='mod op'>%</span> <span class='integer val'>12</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span> <span class='orop op'>||</span> <span class='integer val'>12</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'j'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='yday identifier id'>yday</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'k'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='hour identifier id'>hour</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'L'</span>
      <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='div op'>/</span> <span class='MILLISECONDS_IN_SECOND constant id'>MILLISECONDS_IN_SECOND</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'l'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='hour identifier id'>hour</span> <span class='mod op'>%</span> <span class='integer val'>12</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span> <span class='orop op'>||</span> <span class='integer val'>12</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'M'</span><span class='comma token'>,</span> <span class='string val'>'OM'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'m'</span><span class='comma token'>,</span> <span class='string val'>'Om'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='mon identifier id'>mon</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'N'</span>
      <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='div op'>/</span> <span class='NANOSECONDS_IN_SECOND constant id'>NANOSECONDS_IN_SECOND</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='floor identifier id'>floor</span><span class='comma token'>,</span> <span class='integer val'>9</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'n'</span><span class='semicolon token'>;</span> <span class='string val'>&quot;\n&quot;</span>
    <span class='when when kw'>when</span> <span class='string val'>'P'</span><span class='semicolon token'>;</span> <span class='emit_ad identifier id'>emit_ad</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%p'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'p'</span><span class='semicolon token'>;</span> <span class='emit_au identifier id'>emit_au</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='hour identifier id'>hour</span> <span class='lt op'>&lt;</span> <span class='integer val'>12</span> <span class='then then kw'>then</span> <span class='string val'>'AM'</span> <span class='else else kw'>else</span> <span class='string val'>'PM'</span> <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'Q'</span>
      <span class='s identifier id'>s</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span> <span class='minus op'>-</span> <span class='UNIX_EPOCH_IN_AJD constant id'>UNIX_EPOCH_IN_AJD</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='MILLISECONDS_IN_DAY constant id'>MILLISECONDS_IN_DAY</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='round identifier id'>round</span>
      <span class='emit_sn identifier id'>emit_sn</span><span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'R'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%H:%M'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'r'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%I:%M:%S %p'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'S'</span><span class='comma token'>,</span> <span class='string val'>'OS'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='sec identifier id'>sec</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'s'</span>
      <span class='s identifier id'>s</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span> <span class='minus op'>-</span> <span class='UNIX_EPOCH_IN_AJD constant id'>UNIX_EPOCH_IN_AJD</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='SECONDS_IN_DAY constant id'>SECONDS_IN_DAY</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='round identifier id'>round</span>
      <span class='emit_sn identifier id'>emit_sn</span><span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'T'</span>
      <span class='if if kw'>if</span> <span class='m identifier id'>m</span> <span class='eq op'>==</span> <span class='string val'>'%T'</span>
        <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'%02d:%02d:%02d'</span><span class='comma token'>,</span> <span class='hour identifier id'>hour</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='sec identifier id'>sec</span><span class='rparen token'>)</span> <span class='comment val'># 4p</span>
      <span class='else else kw'>else</span>
        <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%H:%M:%S'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='string val'>'t'</span><span class='semicolon token'>;</span> <span class='string val'>&quot;\t&quot;</span>
    <span class='when when kw'>when</span> <span class='string val'>'U'</span><span class='comma token'>,</span> <span class='string val'>'W'</span><span class='comma token'>,</span> <span class='string val'>'OU'</span><span class='comma token'>,</span> <span class='string val'>'OW'</span>
      <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='c identifier id'>c</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>'U'</span> <span class='then then kw'>then</span> <span class='wnum0 identifier id'>wnum0</span> <span class='else else kw'>else</span> <span class='wnum1 identifier id'>wnum1</span> <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'u'</span><span class='comma token'>,</span> <span class='string val'>'Ou'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='cwday identifier id'>cwday</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'V'</span><span class='comma token'>,</span> <span class='string val'>'OV'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='cweek identifier id'>cweek</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'v'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%e-%b-%Y'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'w'</span><span class='comma token'>,</span> <span class='string val'>'Ow'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='wday identifier id'>wday</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'X'</span><span class='comma token'>,</span> <span class='string val'>'EX'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%H:%M:%S'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'x'</span><span class='comma token'>,</span> <span class='string val'>'Ex'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%m/%d/%y'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'Y'</span><span class='comma token'>,</span> <span class='string val'>'EY'</span><span class='semicolon token'>;</span> <span class='emit_sn identifier id'>emit_sn</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'y'</span><span class='comma token'>,</span> <span class='string val'>'Ey'</span><span class='comma token'>,</span> <span class='string val'>'Oy'</span><span class='semicolon token'>;</span> <span class='emit_n identifier id'>emit_n</span><span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mod op'>%</span> <span class='integer val'>100</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'Z'</span><span class='semicolon token'>;</span> <span class='emit_au identifier id'>emit_au</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%:z'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='regexp val'>/\A(:{0,3})z/</span>
      <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
      <span class='sign identifier id'>sign</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='offset identifier id'>offset</span> <span class='lt op'>&lt;</span> <span class='integer val'>0</span> <span class='then then kw'>then</span> <span class='integer val'>-1</span> <span class='else else kw'>else</span> <span class='integer val'>+1</span> <span class='end end kw'>end</span>
      <span class='fr identifier id'>fr</span> <span class='assign token'>=</span> <span class='offset identifier id'>offset</span><span class='dot token'>.</span><span class='abs identifier id'>abs</span>
      <span class='ss identifier id'>ss</span> <span class='assign token'>=</span> <span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='div identifier id'>div</span><span class='lparen token'>(</span><span class='SECONDS_IN_DAY constant id'>SECONDS_IN_DAY</span><span class='rparen token'>)</span> <span class='comment val'># 4p</span>
      <span class='hh identifier id'>hh</span><span class='comma token'>,</span> <span class='ss identifier id'>ss</span> <span class='assign token'>=</span> <span class='ss identifier id'>ss</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>3600</span><span class='rparen token'>)</span>
      <span class='mm identifier id'>mm</span><span class='comma token'>,</span> <span class='ss identifier id'>ss</span> <span class='assign token'>=</span> <span class='ss identifier id'>ss</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>60</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='t identifier id'>t</span> <span class='eq op'>==</span> <span class='integer val'>3</span>
        <span class='if if kw'>if</span>    <span class='ss identifier id'>ss</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span> <span class='then then kw'>then</span> <span class='t identifier id'>t</span> <span class='assign token'>=</span>  <span class='integer val'>2</span>
        <span class='elsif elsif kw'>elsif</span> <span class='mm identifier id'>mm</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span> <span class='then then kw'>then</span> <span class='t identifier id'>t</span> <span class='assign token'>=</span>  <span class='integer val'>1</span>
        <span class='else else kw'>else</span>                   <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='integer val'>-1</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='case case kw'>case</span> <span class='t identifier id'>t</span>
      <span class='when when kw'>when</span> <span class='integer val'>-1</span>
        <span class='tail identifier id'>tail</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
        <span class='sep identifier id'>sep</span> <span class='assign token'>=</span> <span class='string val'>''</span>
      <span class='when when kw'>when</span> <span class='integer val'>0</span>
        <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:w</span><span class='rbrack token'>]</span> <span class='opasgn op'>-=</span> <span class='integer val'>2</span> <span class='if if_mod kw'>if</span> <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:w</span><span class='rbrack token'>]</span>
        <span class='tail identifier id'>tail</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>'%02d'</span> <span class='mod op'>%</span> <span class='mm identifier id'>mm</span><span class='rbrack token'>]</span>
        <span class='sep identifier id'>sep</span> <span class='assign token'>=</span> <span class='string val'>''</span>
      <span class='when when kw'>when</span> <span class='integer val'>1</span>
        <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:w</span><span class='rbrack token'>]</span> <span class='opasgn op'>-=</span> <span class='integer val'>3</span> <span class='if if_mod kw'>if</span> <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:w</span><span class='rbrack token'>]</span>
        <span class='tail identifier id'>tail</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>'%02d'</span> <span class='mod op'>%</span> <span class='mm identifier id'>mm</span><span class='rbrack token'>]</span>
        <span class='sep identifier id'>sep</span> <span class='assign token'>=</span> <span class='string val'>':'</span>
      <span class='when when kw'>when</span> <span class='integer val'>2</span>
        <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:w</span><span class='rbrack token'>]</span> <span class='opasgn op'>-=</span> <span class='integer val'>6</span> <span class='if if_mod kw'>if</span> <span class='f identifier id'>f</span><span class='lbrack token'>[</span><span class='symbol val'>:w</span><span class='rbrack token'>]</span>
        <span class='tail identifier id'>tail</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>'%02d'</span> <span class='mod op'>%</span> <span class='mm identifier id'>mm</span><span class='comma token'>,</span> <span class='string val'>'%02d'</span> <span class='mod op'>%</span> <span class='ss identifier id'>ss</span><span class='rbrack token'>]</span>
        <span class='sep identifier id'>sep</span> <span class='assign token'>=</span> <span class='string val'>':'</span>
      <span class='end end kw'>end</span>
      <span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='emit_z identifier id'>emit_z</span><span class='lparen token'>(</span><span class='sign identifier id'>sign</span> <span class='mult op'>*</span> <span class='hh identifier id'>hh</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='tail identifier id'>tail</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='sep identifier id'>sep</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'%'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='string val'>'%'</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='string val'>'+'</span><span class='semicolon token'>;</span> <span class='emit_a identifier id'>emit_a</span><span class='lparen token'>(</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%a %b %e %H:%M:%S %Z %Y'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='f identifier id'>f</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_s</h3>
</div><div id="to_s-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_s</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return the date as a human-readable string.
</p>
<p>
The format used is YYYY-MM-DD.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1357</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1357">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_yaml</h3>
</div><div id="to_yaml-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_yaml</span><span class='args'>(opts = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/yaml/rubytypes.rb', line 349</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/yaml/rubytypes.rb#L349">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">349
350
351
352
353</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_yaml identifier id'>to_yaml</span><span class='lparen token'>(</span> <span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='rparen token'>)</span>
  <span class='YAML constant id'>YAML</span><span class='colon2 op'>::</span><span class='quick_emit identifier id'>quick_emit</span><span class='lparen token'>(</span> <span class='self self kw'>self</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='out identifier id'>out</span><span class='bitor op'>|</span>
          <span class='out identifier id'>out</span><span class='dot token'>.</span><span class='scalar identifier id'>scalar</span><span class='lparen token'>(</span> <span class='string val'>&quot;tag:yaml.org,2002:timestamp&quot;</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='comma token'>,</span> <span class='symbol val'>:plain</span> <span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>upto</h3>
</div><div id="upto-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>upto</span><span class='args'>(max, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Step forward one day at a time until we reach <tt>max</tt> (inclusive),
yielding each date as we go.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1333</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1333">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1333
1334
1335</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
  <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>wday</h3>
</div><div id="wday-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>wday</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the week day of this date. Sunday is day-of-week 0; Saturday is
day-of-week 6.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1132</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1132">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1132</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='wday identifier id'>wday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>xmlschema</h3>
</div><div id="xmlschema-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>xmlschema</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date/format.rb', line 345</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date/format.rb#L345">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006
1007
1008
1009
1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='xmlschema identifier id'>xmlschema</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='iso8601 identifier id'>iso8601</span> <span class='end end kw'>end</span> 

  <span class='def def kw'>def</span> <span class='rfc2822 identifier id'>rfc2822</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%a, %-d %b %Y %T %z'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:rfc822</span><span class='comma token'>,</span> <span class='symbol val'>:rfc2822</span>

  <span class='def def kw'>def</span> <span class='httpdate identifier id'>httpdate</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%a, %d %b %Y %T GMT'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='def def kw'>def</span> <span class='jisx0301 identifier id'>jisx0301</span>
    <span class='if if kw'>if</span> <span class='jd identifier id'>jd</span> <span class='lt op'>&lt;</span> <span class='integer val'>2405160</span>
      <span class='iso8601 identifier id'>iso8601</span>
    <span class='else else kw'>else</span>
      <span class='case case kw'>case</span> <span class='jd identifier id'>jd</span>
      <span class='when when kw'>when</span> <span class='float val'>2405160</span><span class='dot3 op'>...</span><span class='integer val'>2419614</span>
        <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'M%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1867</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='float val'>2419614</span><span class='dot3 op'>...</span><span class='integer val'>2424875</span>
        <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'T%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1911</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='float val'>2424875</span><span class='dot3 op'>...</span><span class='integer val'>2447535</span>
        <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'S%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1925</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='g identifier id'>g</span> <span class='assign token'>=</span> <span class='string val'>'H%02d'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='minus op'>-</span> <span class='integer val'>1988</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='g identifier id'>g</span> <span class='plus op'>+</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'.%m.%d'</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def beat(n=0)
    i, f = (new_offset(HOURS_IN_DAY).day_fraction * 1000).divmod(1)
    ('@%03d' % i) +
      if n &lt; 1
        ''
      else
        '.%0*d' % [n, (f / Rational(1, 10**n)).round]
      end
  end
=end
</span>


  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='num_pattern? fid id'>num_pattern?</span> <span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='regexp val'>/\A%[EO]?[CDdeFGgHIjkLlMmNQRrSsTUuVvWwXxYy\d]/</span> <span class='match op'>=~</span> <span class='s identifier id'>s</span> <span class='orop op'>||</span> <span class='regexp val'>/\A\d/</span> <span class='match op'>=~</span> <span class='s identifier id'>s</span>
  <span class='end end kw'>end</span>

  <span class='private_class_method identifier id'>private_class_method</span> <span class='symbol val'>:num_pattern?</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='fmt identifier id'>fmt</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='regexp val'>/%([EO]?(?::{1,3}z|.))|(.)/</span><span class='m identifier id'>m</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='comma token'>,</span> <span class='c identifier id'>c</span><span class='bitor op'>|</span>
      <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span>
      <span class='if if kw'>if</span> <span class='s identifier id'>s</span>
        <span class='case case kw'>case</span> <span class='s identifier id'>s</span>
        <span class='when when kw'>when</span> <span class='string val'>'A'</span><span class='comma token'>,</span> <span class='string val'>'a'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::DAYS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
                        <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::ABBR_DAYS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='DAYS constant id'>DAYS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_DAYS constant id'>ABBR_DAYS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'B'</span><span class='comma token'>,</span> <span class='string val'>'b'</span><span class='comma token'>,</span> <span class='string val'>'h'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::MONTHS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
                        <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A(#{Format::ABBR_MONTHS.keys.join('|')})/i</span><span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='MONTHS constant id'>MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'C'</span><span class='comma token'>,</span> <span class='string val'>'EC'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,2})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'c'</span><span class='comma token'>,</span> <span class='string val'>'Ec'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%a %b %e %H:%M:%S %Y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'D'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%m/%d/%y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'d'</span><span class='comma token'>,</span> <span class='string val'>'e'</span><span class='comma token'>,</span> <span class='string val'>'Od'</span><span class='comma token'>,</span> <span class='string val'>'Oe'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A( \d|\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>31</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'F'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%Y-%m-%d'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'G'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,4})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'g'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>99</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='opasgn op'>||=</span> <span class='if if kw'>if</span> <span class='val identifier id'>val</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span> <span class='then then kw'>then</span> <span class='integer val'>19</span> <span class='else else kw'>else</span> <span class='integer val'>20</span> <span class='end end kw'>end</span>
        <span class='when when kw'>when</span> <span class='string val'>'H'</span><span class='comma token'>,</span> <span class='string val'>'k'</span><span class='comma token'>,</span> <span class='string val'>'OH'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A( \d|\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>24</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'I'</span><span class='comma token'>,</span> <span class='string val'>'l'</span><span class='comma token'>,</span> <span class='string val'>'OI'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A( \d|\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>12</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'j'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,3})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>366</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'L'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,3})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
<span class='comment val'>#         val = Rational($1.to_i, 10**3)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'M'</span><span class='comma token'>,</span> <span class='string val'>'OM'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>59</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'m'</span><span class='comma token'>,</span> <span class='string val'>'Om'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>12</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'N'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,9})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
<span class='comment val'>#         val = Rational($1.to_i, 10**9)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'n'</span><span class='comma token'>,</span> <span class='string val'>'t'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>&quot;\s&quot;</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'P'</span><span class='comma token'>,</span> <span class='string val'>'p'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A([ap])(?:m\b|\.m\.)/i</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_merid identifier id'>_merid</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'a'</span> <span class='then then kw'>then</span> <span class='integer val'>0</span> <span class='else else kw'>else</span> <span class='integer val'>12</span> <span class='end end kw'>end</span>
        <span class='when when kw'>when</span> <span class='string val'>'Q'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(-?\d{1,})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='integer val'>3</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='seconds identifier id'>seconds</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'R'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%H:%M'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'r'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%I:%M:%S %p'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'S'</span><span class='comma token'>,</span> <span class='string val'>'OS'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>60</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'s'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(-?\d{1,})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='seconds identifier id'>seconds</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'T'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%H:%M:%S'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'U'</span><span class='comma token'>,</span> <span class='string val'>'W'</span><span class='comma token'>,</span> <span class='string val'>'OU'</span><span class='comma token'>,</span> <span class='string val'>'OW'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>53</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='s identifier id'>s</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>'U'</span> <span class='then then kw'>then</span> <span class='symbol val'>:wnum0=</span> <span class='else else kw'>else</span> <span class='symbol val'>:wnum1=</span> <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'u'</span><span class='comma token'>,</span> <span class='string val'>'Ou'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>7</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwday identifier id'>cwday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'V'</span><span class='comma token'>,</span> <span class='string val'>'OV'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>53</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cweek identifier id'>cweek</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'v'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%e-%b-%Y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'w'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>6</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'X'</span><span class='comma token'>,</span> <span class='string val'>'EX'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%H:%M:%S'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'x'</span><span class='comma token'>,</span> <span class='string val'>'Ex'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%m/%d/%y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'Y'</span><span class='comma token'>,</span> <span class='string val'>'EY'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='if if kw'>if</span> <span class='num_pattern? fid id'>num_pattern?</span><span class='lparen token'>(</span><span class='$' back_ref id'>$'</span><span class='rparen token'>)</span>
                                 <span class='then then kw'>then</span> <span class='regexp val'>/\A([-+]?\d{1,4})/</span>
                                 <span class='else else kw'>else</span> <span class='regexp val'>/\A([-+]?\d{1,})/</span>
                                 <span class='end end kw'>end</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='string val'>'y'</span><span class='comma token'>,</span> <span class='string val'>'Ey'</span><span class='comma token'>,</span> <span class='string val'>'Oy'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(\d{1,2})/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>99</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='opasgn op'>||=</span> <span class='if if kw'>if</span> <span class='val identifier id'>val</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span> <span class='then then kw'>then</span> <span class='integer val'>19</span> <span class='else else kw'>else</span> <span class='integer val'>20</span> <span class='end end kw'>end</span>
        <span class='when when kw'>when</span> <span class='string val'>'Z'</span><span class='comma token'>,</span> <span class='regexp val'>/\A:{0,3}z/</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A((?:gmt|utc?)?[-+]\d+(?:[,.:]\d+(?::\d+)?)?
                                    |[[:alpha:].\s]+(?:standard|daylight)\s+time\b
                                    |[[:alpha:]]+(?:\s+dst)?\b
                                    )/i</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
          <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
          <span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='val identifier id'>val</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='offset identifier id'>offset</span>
        <span class='when when kw'>when</span> <span class='string val'>'%'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A%/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='when when kw'>when</span> <span class='string val'>'+'</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='string val'>'%a %b %e %H:%M:%S %Z %Y'</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'\\A'</span> <span class='plus op'>+</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='quote identifier id'>quote</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
      <span class='else else kw'>else</span>
        <span class='case case kw'>case</span> <span class='c identifier id'>c</span>
        <span class='when when kw'>when</span> <span class='regexp val'>/\A[\s\v]/</span>
          <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A[\s\v]+/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
          <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'\\A'</span> <span class='plus op'>+</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='quote identifier id'>quote</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private_class_method identifier id'>private_class_method</span> <span class='symbol val'>:_strptime_i</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_strptime identifier id'>_strptime</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='assign token'>=</span><span class='string val'>'%F'</span><span class='rparen token'>)</span>
    <span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='_strptime_i identifier id'>_strptime_i</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='fmt identifier id'>fmt</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>

    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='opasgn op'>+=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='mult op'>*</span> <span class='integer val'>100</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span>  <span class='year identifier id'>year</span> <span class='opasgn op'>+=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_cent identifier id'>_cent</span> <span class='mult op'>*</span> <span class='integer val'>100</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_merid identifier id'>_merid</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>%=</span> <span class='integer val'>12</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>+=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_merid identifier id'>_merid</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='unless unless kw'>unless</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='leftover identifier id'>leftover</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span>
    <span class='end end kw'>end</span>

    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='bc identifier id'>bc</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='rparen token'>)</span>
    <span class='unless unless kw'>unless</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='m identifier id'>m</span>
      <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='y identifier id'>y</span> <span class='andop op'>&amp;&amp;</span> <span class='m identifier id'>m</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='d identifier id'>d</span>
      <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='y identifier id'>y</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>
      <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='andop op'>&amp;&amp;</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
        <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span>
        <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='d identifier id'>d</span> <span class='andop op'>&amp;&amp;</span> <span class='d identifier id'>d</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;'&quot;</span>
        <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span>
        <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='y identifier id'>y</span>
      <span class='y identifier id'>y</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='regexp val'>/(\d+)(.+)?/</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span>
        <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='m identifier id'>m</span>
      <span class='if if kw'>if</span> <span class='m identifier id'>m</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;'&quot;</span> <span class='orop op'>||</span> <span class='m identifier id'>m</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
        <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='comment val'># us -&gt; be</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='d identifier id'>d</span>
      <span class='if if kw'>if</span> <span class='d identifier id'>d</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;'&quot;</span> <span class='orop op'>||</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
        <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='y identifier id'>y</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='y identifier id'>y</span>
      <span class='y identifier id'>y</span> <span class='match op'>=~</span> <span class='regexp val'>/([-+])?(\d+)/</span>
      <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span> <span class='orop op'>||</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2</span>
        <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
      <span class='end end kw'>end</span>
      <span class='iy identifier id'>iy</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='if if kw'>if</span> <span class='bc identifier id'>bc</span>
        <span class='iy identifier id'>iy</span> <span class='assign token'>=</span> <span class='minus op'>-</span><span class='iy identifier id'>iy</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
      <span class='end end kw'>end</span>
      
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='iy identifier id'>iy</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='m identifier id'>m</span>
      <span class='m identifier id'>m</span> <span class='match op'>=~</span> <span class='regexp val'>/\d+/</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='d identifier id'>d</span>
      <span class='d identifier id'>d</span> <span class='match op'>=~</span> <span class='regexp val'>/\d+/</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='c identifier id'>c</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span>
    <span class='end end kw'>end</span>

  <span class='end end kw'>end</span>

  <span class='private_class_method identifier id'>private_class_method</span> <span class='symbol val'>:s3e</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_day identifier id'>_parse_day</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\b(#{Format::ABBR_DAYS.keys.join('|')})[^-\d\s]*/i</span><span class='no identifier id'>no</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='wday identifier id'>wday</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_DAYS constant id'>ABBR_DAYS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
      <span class='true true kw'>true</span>
<span class='comment val'>=begin
    elsif str.sub!(/\b(?!\dth)(su|mo|tu|we|th|fr|sa)\b/in, ' ')
      e.wday = %w(su mo tu we th fr sa).index($1.downcase)
      true
=end
</span>

    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_time identifier id'>_parse_time</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
                <span class='regexp val'>/(
                   (?:
                     \d+\s*:\s*\d+
                     (?:
                       \s*:\s*\d+(?:[,.]\d*)?
                     )?
                   |
                     \d+\s*h(?:\s*\d+m?(?:\s*\d+s?)?)?
                   )
                   (?:
                     \s*
                     [ap](?:m\b|\.m\.)
                   )?
                 |
                   \d+\s*[ap](?:m\b|\.m\.)
                 )
                 (?:
                   \s*
                   (
                     (?:gmt|utc?)?[-+]\d+(?:[,.:]\d+(?::\d+)?)?
                   |
                     [[:alpha:].\s]+(?:standard|daylight)\stime\b
                   |
                     [[:alpha:]]+(?:\sdst)?\b
                   )
                 )?
                /i</span><span class='nx identifier id'>nx</span><span class='comma token'>,</span>
                <span class='string val'>' '</span><span class='rparen token'>)</span>

      <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>

      <span class='t identifier id'>t</span> <span class='match op'>=~</span> <span class='regexp val'>/\A(\d+)h?
              (?:\s*:?\s*(\d+)m?
                (?:
                  \s*:?\s*(\d+)(?:[,.](\d+))?s?
                )?
              )?
            (?:\s*([ap])(?:m\b|\.m\.))?/i</span><span class='nx identifier id'>nx</span>

      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$4 nth_ref id'>$4</span>

      <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>%=</span> <span class='integer val'>12</span>
        <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'p'</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='opasgn op'>+=</span> <span class='integer val'>12</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def self._parse_beat(str, e) # :nodoc:
    if str.sub!(/@\s*(\d+)(?:[,.](\d*))?/, ' ')
      beat = Rational($1.to_i)
      beat += Rational($2.to_i, 10**$2.size) if $2
      secs = Rational(beat, 1000)
      h, min, s, fr = self.day_fraction_to_time(secs)
      e.hour = h
      e.min = min
      e.sec = s
      e.sec_fraction = fr * 86400
      e.zone = '+01:00'
      true
    end
  end
=end
</span>


  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_eu identifier id'>_parse_eu</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
                <span class='dregexp node'>/'?(\d+)[^-\d\s]*
                 \s*
                 (#{Format::ABBR_MONTHS.keys.join('|')})[^-\d\s']*
                 (?:
                   \s*
                   (c(?:e|\.e\.)|b(?:ce|\.c\.e\.)|a(?:d|\.d\.)|b(?:c|\.c\.))?
                   \s*
                   ('?-?\d+(?:(?:st|nd|rd|th)\b)?)
                 )?
                /i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span>
                <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$4 nth_ref id'>$4</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span>
          <span class='$3 nth_ref id'>$3</span> <span class='andop op'>&amp;&amp;</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'b'</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_us identifier id'>_parse_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
                <span class='dregexp node'>/\b(#{Format::ABBR_MONTHS.keys.join('|')})[^-\d\s']*
                 \s*
                 ('?\d+)[^-\d\s']*
                 (?:
                   \s*
                   (c(?:e|\.e\.)|b(?:ce|\.c\.e\.)|a(?:d|\.d\.)|b(?:c|\.c\.))?
                   \s*
                   ('?-?\d+)
                 )?
                /i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span>
                <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$4 nth_ref id'>$4</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span>
          <span class='$3 nth_ref id'>$3</span> <span class='andop op'>&amp;&amp;</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='eq op'>==</span> <span class='string val'>'b'</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_iso identifier id'>_parse_iso</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/('?[-+]?\d+)-(\d+)-('?-?\d+)/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_iso2 identifier id'>_parse_iso2</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b(\d{2}|\d{4})?-?w(\d{2})(?:-?(\d))?\b/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cweek identifier id'>cweek</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwday identifier id'>cwday</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/-w-(\d)\b/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwday identifier id'>cwday</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/--(\d{2})?-(\d{2})\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/--(\d{2})(\d{2})?\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/[,.](\d{2}|\d{4})-\d{3}\b/n</span> <span class='nmatch op'>!~</span> <span class='str identifier id'>str</span> <span class='andop op'>&amp;&amp;</span>
        <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b(\d{2}|\d{4})-(\d{3})\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\d-\d{3}\b/n</span> <span class='nmatch op'>!~</span> <span class='str identifier id'>str</span> <span class='andop op'>&amp;&amp;</span>
        <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b-(\d{3})\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_jis identifier id'>_parse_jis</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b([mtsh])(\d+)\.(\d+)\.(\d+)/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='era identifier id'>era</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'m'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1867</span><span class='comma token'>,</span>
              <span class='string val'>'t'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1911</span><span class='comma token'>,</span>
              <span class='string val'>'s'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1925</span><span class='comma token'>,</span>
              <span class='string val'>'h'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>1988</span>
          <span class='rbrace token'>}</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='plus op'>+</span> <span class='era identifier id'>era</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_vms identifier id'>_parse_vms</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/('?-?\d+)-(#{Format::ABBR_MONTHS.keys.join('|')})[^-]*
                -('?-?\d+)/i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\b(#{Format::ABBR_MONTHS.keys.join('|')})[^-]*
                -('?-?\d+)(?:-('?-?\d+))?/i</span><span class='nox identifier id'>nox</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_ja identifier id'>_parse_sla_ja</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:[^\d]\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
 
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_eu identifier id'>_parse_sla_eu</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:[^\d]\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_us identifier id'>_parse_sla_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:[^\d]\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>


  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_sla_jp identifier id'>_parse_sla_jp</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>%r|('?-?\d+)[/.]\s*('?\d+)(?:\D\s*('?-?\d+))?|n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='comment val'># '</span>
      <span class='s3e identifier id'>s3e</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='rparen token'>)</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_year identifier id'>_parse_year</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/'(\d+)\b/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_mon identifier id'>_parse_mon</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\b(#{Format::ABBR_MONTHS.keys.join('|')})\S*/i</span><span class='no identifier id'>no</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ABBR_MONTHS constant id'>ABBR_MONTHS</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rbrack token'>]</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_mday identifier id'>_parse_mday</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/(\d+)(st|nd|rd|th)\b/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse_ddd identifier id'>_parse_ddd</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span>
                <span class='regexp val'>/([-+]?)(\d{2,14})
                  (?:
                    \s*
                    t?
                    \s*
                    (\d{2,6})?(?:[,.](\d*))?
                  )?
                  (?:
                    \s*
                    (
                      z\b
                    |
                      [-+]\d{1,4}\b
                    |
                      \[[-+]?\d[^\]]*\]
                    )
                  )?
                /i</span><span class='nx identifier id'>nx</span><span class='comma token'>,</span>
                <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='case case kw'>case</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
      <span class='when when kw'>when</span> <span class='integer val'>2</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>4</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>6</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>8</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='comma token'>,</span> <span class='integer val'>12</span><span class='comma token'>,</span> <span class='integer val'>14</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-8</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>10</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-10</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='end end kw'>end</span>
          <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>12</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-12</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='end end kw'>end</span>
          <span class='if if kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>14</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-14</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
          <span class='end end kw'>end</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>8</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>10</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>10</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>12</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>12</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>14</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>3</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>5</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-5</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='when when kw'>when</span> <span class='integer val'>7</span>
        <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='andop op'>&amp;&amp;</span> <span class='$4 nth_ref id'>$4</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span><span class='integer val'>-7</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='else else kw'>else</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='yday identifier id'>yday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='$3 nth_ref id'>$3</span>
        <span class='if if kw'>if</span> <span class='$4 nth_ref id'>$4</span>
          <span class='case case kw'>case</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
          <span class='when when kw'>when</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>6</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>-4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>4</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span><span class='integer val'>-6</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>6</span>
          <span class='end end kw'>end</span>
        <span class='else else kw'>else</span>
          <span class='case case kw'>case</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
          <span class='when when kw'>when</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>6</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>4</span>
            <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span>  <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='lbrack token'>[</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='integer val'>6</span>
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$5 nth_ref id'>$5</span>
        <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>'['</span>
          <span class='o identifier id'>o</span><span class='comma token'>,</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='assign token'>=</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>-2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>':'</span><span class='rparen token'>)</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='n identifier id'>n</span> <span class='orop op'>||</span> <span class='o identifier id'>o</span>
          <span class='if if kw'>if</span> <span class='regexp val'>/\A\d/</span> <span class='match op'>=~</span> <span class='o identifier id'>o</span>
            <span class='o identifier id'>o</span> <span class='assign token'>=</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'+%s'</span><span class='comma token'>,</span> <span class='o identifier id'>o</span><span class='rparen token'>)</span>
          <span class='end end kw'>end</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='o identifier id'>o</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private_class_method identifier id'>private_class_method</span> <span class='symbol val'>:_parse_day</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_time</span><span class='comma token'>,</span> <span class='comment val'># :_parse_beat,</span>
        <span class='symbol val'>:_parse_eu</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_us</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_iso</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_iso2</span><span class='comma token'>,</span>
        <span class='symbol val'>:_parse_jis</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_vms</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_sla_jp</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_sla_eu</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_sla_us</span><span class='comma token'>,</span>
        <span class='symbol val'>:_parse_year</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_mon</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_mday</span><span class='comma token'>,</span> <span class='symbol val'>:_parse_ddd</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='comp identifier id'>comp</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='rparen token'>)</span>
    <span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>

    <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span> <span class='assign token'>=</span> <span class='comp identifier id'>comp</span>

    <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/[^-+',.\/:@[:alnum:]\[\]\x80-\xff]+/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>

    <span class='_parse_time identifier id'>_parse_time</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='comment val'># || _parse_beat(str, e)</span>
    <span class='_parse_day identifier id'>_parse_day</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>

    <span class='_parse_eu identifier id'>_parse_eu</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>     <span class='orop op'>||</span>
    <span class='_parse_us identifier id'>_parse_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>     <span class='orop op'>||</span>
    <span class='_parse_iso identifier id'>_parse_iso</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
    <span class='_parse_jis identifier id'>_parse_jis</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
    <span class='_parse_vms identifier id'>_parse_vms</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
    <span class='_parse_sla_us identifier id'>_parse_sla_us</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
    <span class='_parse_iso2 identifier id'>_parse_iso2</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>   <span class='orop op'>||</span>
    <span class='_parse_year identifier id'>_parse_year</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>   <span class='orop op'>||</span>
    <span class='_parse_mon identifier id'>_parse_mon</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>    <span class='orop op'>||</span>
    <span class='_parse_mday identifier id'>_parse_mday</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>   <span class='orop op'>||</span>
    <span class='_parse_ddd identifier id'>_parse_ddd</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='rparen token'>)</span>

    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\b(bc\b|bce\b|b\.c\.|b\.c\.e\.)/i</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='minus op'>-</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A\s*(\d{1,2})\s*\z/n</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span>
        <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>31</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='v identifier id'>v</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span>
        <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>24</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='v identifier id'>v</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='_comp identifier id'>_comp</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span>
        <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span> <span class='andop op'>&amp;&amp;</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='leq op'>&lt;=</span> <span class='integer val'>99</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='opasgn op'>+=</span> <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='cwyear identifier id'>cwyear</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span>
                      <span class='then then kw'>then</span> <span class='integer val'>1900</span> <span class='else else kw'>else</span> <span class='integer val'>2000</span> <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span>
        <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span> <span class='andop op'>&amp;&amp;</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='leq op'>&lt;=</span> <span class='integer val'>99</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='opasgn op'>+=</span> <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='geq op'>&gt;=</span> <span class='integer val'>69</span>
                    <span class='then then kw'>then</span> <span class='integer val'>1900</span> <span class='else else kw'>else</span> <span class='integer val'>2000</span> <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='opasgn op'>||=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span>

    <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_iso8601 identifier id'>_iso8601</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*(([-+]?\d{2,}|-)-\d{2}-\d{2}|
              ([-+]?\d{2,})?-\d{3}|
              (\d{2}|\d{4})?-w\d{2}-\d|
              -w-\d)
        (t
        \d{2}:\d{2}(:\d{2}([,.]\d+)?)?
        (z|[-+]\d{2}(:?\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(([-+]?(\d{2}|\d{4})|--)\d{2}\d{2}|
              ([-+]?(\d{2}|\d{4}))?\d{3}|-\d{3}|
              (\d{2}|\d{4})?w\d{2}\d)
        (t?
        \d{2}\d{2}(\d{2}([,.]\d+)?)?
        (z|[-+]\d{2}(\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(\d{2}:\d{2}(:\d{2}([,.]\d+)?)?
        (z|[-+]\d{2}(:?\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(\d{2}\d{2}(\d{2}([,.]\d+)?)?
        (z|[-+]\d{2}(\d{2})?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_rfc3339 identifier id'>_rfc3339</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*-?\d{4}-\d{2}-\d{2} # allow minus, anyway
        (t|\s)
        \d{2}:\d{2}:\d{2}(\.\d+)?
        (z|[-+]\d{2}:\d{2})\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_xmlschema identifier id'>_xmlschema</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*(-?\d{4,})(?:-(\d{2})(?:-(\d{2}))?)?
        (?:t
          (\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?)?
        (z|[-+]\d{2}:\d{2})?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='year identifier id'>year</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$4 nth_ref id'>$4</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='$5 nth_ref id'>$5</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$5 nth_ref id'>$5</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='$6 nth_ref id'>$6</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$6 nth_ref id'>$6</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$7 nth_ref id'>$7</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$7 nth_ref id'>$7</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$7 nth_ref id'>$7</span>
      <span class='if if kw'>if</span> <span class='$8 nth_ref id'>$8</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$8 nth_ref id'>$8</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='$8 nth_ref id'>$8</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?
        (z|[-+]\d{2}:\d{2})?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='sec_fraction identifier id'>sec_fraction</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='$4 nth_ref id'>$4</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='$4 nth_ref id'>$4</span>
      <span class='if if kw'>if</span> <span class='$5 nth_ref id'>$5</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$5 nth_ref id'>$5</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='$5 nth_ref id'>$5</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
    <span class='elsif elsif kw'>elsif</span> <span class='regexp val'>/\A\s*(?:--(\d{2})(?:-(\d{2}))?|---(\d{2}))
        (z|[-+]\d{2}:\d{2})?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='Bag constant id'>Bag</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mon identifier id'>mon</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$2 nth_ref id'>$2</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='mday identifier id'>mday</span> <span class='assign token'>=</span> <span class='$3 nth_ref id'>$3</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='$3 nth_ref id'>$3</span>
      <span class='if if kw'>if</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span>
        <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='$4 nth_ref id'>$4</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_rfc2822 identifier id'>_rfc2822</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='dregexp node'>/\A\s*(?:(?:#{Format::ABBR_DAYS.keys.join('|')})\s*,\s+)?
        \d{1,2}\s+
        (?:#{Format::ABBR_MONTHS.keys.join('|')})\s+
        -?(\d{2,})\s+ # allow minus, anyway
        \d{2}:\d{2}(:\d{2})?\s*
        (?:[-+]\d{4}|ut|gmt|e[sd]t|c[sd]t|m[sd]t|p[sd]t|[a-ik-z])\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='comma token'>,</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='lt op'>&lt;</span> <span class='integer val'>4</span>
        <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='lt op'>&lt;</span> <span class='integer val'>50</span>
          <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='integer val'>2000</span>
        <span class='elsif elsif kw'>elsif</span> <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='lt op'>&lt;</span> <span class='integer val'>1000</span>
          <span class='e identifier id'>e</span><span class='lbrack token'>[</span><span class='symbol val'>:year</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='integer val'>1900</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='e identifier id'>e</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='class class kw'>class</span> <span class='lshft op'>&lt;&lt;</span> <span class='self self kw'>self</span><span class='semicolon token'>;</span> <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:_rfc822</span><span class='comma token'>,</span> <span class='symbol val'>:_rfc2822</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_httpdate identifier id'>_httpdate</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='dregexp node'>/\A\s*(#{Format::ABBR_DAYS.keys.join('|')})\s*,\s+
        \d{2}\s+
        (#{Format::ABBR_MONTHS.keys.join('|')})\s+
        -?\d{4}\s+ # allow minus, anyway
        \d{2}:\d{2}:\d{2}\s+
        gmt\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_rfc2822 identifier id'>_rfc2822</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='dregexp node'>/\A\s*(#{Format::DAYS.keys.join('|')})\s*,\s+
        \d{2}\s*-\s*
        (#{Format::ABBR_MONTHS.keys.join('|')})\s*-\s*
        \d{2}\s+
        \d{2}:\d{2}:\d{2}\s+
        gmt\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='dregexp node'>/\A\s*(#{Format::ABBR_DAYS.keys.join('|')})\s+
        (#{Format::ABBR_MONTHS.keys.join('|')})\s+
        \d{1,2}\s+
        \d{2}:\d{2}:\d{2}\s+
        \d{4}\s*\z/i</span><span class='nox identifier id'>nox</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_jisx0301 identifier id'>_jisx0301</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*[mtsh]?\d{2}\.\d{2}\.\d{2}
        (t
        (\d{2}:\d{2}(:\d{2}([,.]\d*)?)?
        (z|[-+]\d{2}(:?\d{2})?)?)?)?\s*\z/i</span><span class='nx identifier id'>nx</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
      <span class='if if kw'>if</span> <span class='regexp val'>/\A\s*\d/</span> <span class='match op'>=~</span> <span class='str identifier id'>str</span>
        <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/\A\s*(\d)/</span><span class='comma token'>,</span> <span class='string val'>'h\1'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='_parse identifier id'>_parse</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='_iso8601 identifier id'>_iso8601</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='Module constant id'>Module</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span>

    <span class='private identifier id'>private</span>

    <span class='def def kw'>def</span> <span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='zone identifier id'>zone</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
      <span class='zone identifier id'>zone</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span>
      <span class='if if kw'>if</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\s+(standard|daylight)\s+time\z/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='dst identifier id'>dst</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span> <span class='eq op'>==</span> <span class='string val'>'daylight'</span>
      <span class='else else kw'>else</span>
        <span class='dst identifier id'>dst</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\s+dst\z/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ZONES constant id'>ZONES</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='zone identifier id'>zone</span><span class='rparen token'>)</span>
        <span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='Format constant id'>Format</span><span class='colon2 op'>::</span><span class='ZONES constant id'>ZONES</span><span class='lbrack token'>[</span><span class='zone identifier id'>zone</span><span class='rbrack token'>]</span>
        <span class='offset identifier id'>offset</span> <span class='opasgn op'>+=</span> <span class='integer val'>3600</span> <span class='if if_mod kw'>if</span> <span class='dst identifier id'>dst</span>
      <span class='elsif elsif kw'>elsif</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A(?:gmt|utc?)?([-+])/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='sign identifier id'>sign</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
        <span class='if if kw'>if</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>':'</span><span class='rparen token'>)</span>
          <span class='hour identifier id'>hour</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='sec identifier id'>sec</span><span class='comma token'>,</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>':'</span><span class='rparen token'>)</span>
        <span class='elsif elsif kw'>elsif</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>'.'</span><span class='rparen token'>)</span>
          <span class='hour identifier id'>hour</span><span class='comma token'>,</span> <span class='fr identifier id'>fr</span><span class='comma token'>,</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/[,.]/</span><span class='rparen token'>)</span>
          <span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='Rational constant id'>Rational</span><span class='lparen token'>(</span><span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='pow op'>**</span><span class='fr identifier id'>fr</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='mult op'>*</span> <span class='integer val'>60</span>
        <span class='else else kw'>else</span>
          <span class='case case kw'>case</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
          <span class='when when kw'>when</span> <span class='integer val'>3</span>
            <span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
            <span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
          <span class='else else kw'>else</span>
            <span class='hour identifier id'>hour</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
            <span class='min identifier id'>min</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
            <span class='sec identifier id'>sec</span> <span class='assign token'>=</span> <span class='zone identifier id'>zone</span><span class='lbrack token'>[</span><span class='integer val'>4</span><span class='comma token'>,</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
        <span class='offset identifier id'>offset</span> <span class='assign token'>=</span> <span class='hour identifier id'>hour</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='mult op'>*</span> <span class='integer val'>3600</span> <span class='plus op'>+</span> <span class='min identifier id'>min</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='mult op'>*</span> <span class='integer val'>60</span> <span class='plus op'>+</span> <span class='sec identifier id'>sec</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='offset identifier id'>offset</span> <span class='opasgn op'>*=</span> <span class='integer val'>-1</span> <span class='if if_mod kw'>if</span> <span class='sign identifier id'>sign</span> <span class='eq op'>==</span> <span class='string val'>'-'</span>
      <span class='end end kw'>end</span>
      <span class='offset identifier id'>offset</span>
    <span class='end end kw'>end</span>

  <span class='end end kw'>end</span>

  <span class='extend identifier id'>extend</span>  <span class='t identifier id'>t</span>
  <span class='include identifier id'>include</span> <span class='t identifier id'>t</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>yday</h3>
</div><div id="yday-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>yday</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the day-of-the-year of this date.
</p>
<p>
January 1 is day-of-the-year 1
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1075</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1075">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='yday identifier id'>yday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='ordinal identifier id'>ordinal</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the month of this date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># January is month 1.</span>
  <span class='def def kw'>def</span> <span class='mon identifier id'>mon</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the day-of-the-month of this date.</span>
  <span class='def def kw'>def</span> <span class='mday identifier id'>mday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:month</span><span class='comma token'>,</span> <span class='symbol val'>:mon</span>
  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:day</span><span class='comma token'>,</span> <span class='symbol val'>:mday</span>

  <span class='def def kw'>def</span> <span class='wnum0 identifier id'>wnum0</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum0 identifier id'>weeknum0</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>
  <span class='def def kw'>def</span> <span class='wnum1 identifier id'>wnum1</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum1 identifier id'>weeknum1</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:wnum0</span><span class='comma token'>,</span> <span class='symbol val'>:wnum1</span>

  <span class='comment val'># Get the time of this date as [hours, minutes, seconds,</span>
  <span class='comment val'># fraction_of_a_second]</span>
  <span class='def def kw'>def</span> <span class='time identifier id'>time</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='day_fraction_to_time identifier id'>day_fraction_to_time</span><span class='lparen token'>(</span><span class='day_fraction identifier id'>day_fraction</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:time</span>
  <span class='private identifier id'>private</span> <span class='symbol val'>:time</span>

  <span class='comment val'># Get the hour of this date.</span>
  <span class='def def kw'>def</span> <span class='hour identifier id'>hour</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the minute of this date.</span>
  <span class='def def kw'>def</span> <span class='min identifier id'>min</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the second of this date.</span>
  <span class='def def kw'>def</span> <span class='sec identifier id'>sec</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the fraction-of-a-second of this date.  The unit is in days.</span>
  <span class='comment val'># I do NOT recommend you to use this method.</span>
  <span class='def def kw'>def</span> <span class='sec_fraction identifier id'>sec_fraction</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='comma token'>,</span> <span class='symbol val'>:sec_fraction</span>

  <span class='def def kw'>def</span> <span class='zone identifier id'>zone</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%:z'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:zone</span>

  <span class='comment val'># Get the commercial year of this date.  See *Commercial* *Date*</span>
  <span class='comment val'># in the introduction for how this differs from the normal year.</span>
  <span class='def def kw'>def</span> <span class='cwyear identifier id'>cwyear</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial week of the year of this date.</span>
  <span class='def def kw'>def</span> <span class='cweek identifier id'>cweek</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial day of the week of this date.  Monday is</span>
  <span class='comment val'># commercial day-of-week 1; Sunday is commercial day-of-week 7.</span>
  <span class='def def kw'>def</span> <span class='cwday identifier id'>cwday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the week day of this date.  Sunday is day-of-week 0;</span>
  <span class='comment val'># Saturday is day-of-week 6.</span>
  <span class='def def kw'>def</span> <span class='wday identifier id'>wday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:wday</span>

<span class='comment val'>=begin
  MONTHNAMES.each_with_index do |n, i|
    if n
      define_method(n.downcase + '?'){mon == i}
    end
  end

  DAYNAMES.each_with_index do |n, i|
    define_method(n.downcase + '?'){wday == i}
  end
=end
</span>


  <span class='comment val'># Is the current date old-style (Julian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Is the current date new-style (Gregorian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:julian?</span><span class='comma token'>,</span> <span class='symbol val'>:gregorian?</span>

  <span class='def def kw'>def</span> <span class='fix_style identifier id'>fix_style</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span>
    <span class='then then kw'>then</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span>
    <span class='else else kw'>else</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span> <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:fix_style</span>

  <span class='comment val'># Is this a leap year?</span>
  <span class='def def kw'>def</span> <span class='leap? fid id'>leap?</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                     <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>29</span>
  <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:leap?</span>

  <span class='comment val'># When is the Day of Calendar Reform for this Date object?</span>
  <span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@sg ivar id'>@sg</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object using a new Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the Italian/Catholic</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the English/Colonial</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Julian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Gregorian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='offset identifier id'>offset</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@of ivar id'>@of</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='of identifier id'>of</span>
      <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:offset</span><span class='comma token'>,</span> <span class='symbol val'>:new_offset</span>

  <span class='comment val'># Return a new Date object that is +n+ days later than the</span>
  <span class='comment val'># current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +n+ may be a negative value, in which case the new Date</span>
  <span class='comment val'># is earlier than the current one; however, #-() might be</span>
  <span class='comment val'># more intuitive.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +n+ is not a Numeric, a TypeError will be thrown.  In</span>
  <span class='comment val'># particular, two Dates cannot be added to each other.</span>
  <span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># If +x+ is a Numeric value, create a new Date object that is</span>
  <span class='comment val'># +x+ days earlier than the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is a Date, return the number of days between the</span>
  <span class='comment val'># two dates; or, more precisely, how many days later the current</span>
  <span class='comment val'># date is than +x+.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is neither Numeric nor a Date, a TypeError is raised.</span>
  <span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Compare this date with another date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ can also be a Numeric value, in which case it is</span>
  <span class='comment val'># interpreted as an Astronomical Julian Day Number.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Comparison is by Astronomical Julian Day Number, including</span>
  <span class='comment val'># fractional days.  This means that both the time and the</span>
  <span class='comment val'># timezone offset are taken into account when comparing</span>
  <span class='comment val'># two DateTime instances.  When comparing a DateTime instance</span>
  <span class='comment val'># with a Date instance, the time of the latter will be</span>
  <span class='comment val'># considered as falling on midnight UTC.</span>
  <span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># The relationship operator for Date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Compares dates by Julian Day Number.  When comparing</span>
  <span class='comment val'># two DateTime instances, or a DateTime with a Date,</span>
  <span class='comment val'># the instances will be regarded as equivalent if they</span>
  <span class='comment val'># fall on the same date in local time.</span>
  <span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='next_day identifier id'>next_day</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span> <span class='end end kw'>end</span>
<span class='comment val'># def prev_day(n=1) self - n end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:next_day</span>

  <span class='comment val'># Return a new Date one day after this one.</span>
  <span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>year</h3>
</div><div id="year-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>year</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get the year of this date.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/date.rb', line 1070</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/evanphx/rubinius/blob/a7024cd869a9d90a2216b9eaaa9b5740c18ad4a5/lib/date.rb#L1070">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1070
1071
1072
1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085
1086
1087
1088
1089
1090
1091
1092
1093
1094
1095
1096
1097
1098
1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190
1191
1192
1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307
1308
1309
1310
1311
1312
1313
1314
1315
1316
1317
1318
1319
1320
1321
1322
1323
1324
1325
1326
1327
1328
1329
1330
1331
1332
1333
1334
1335
1336
1337
1338
1339
1340
1341
1342
1343
1344
1345
1346
1347
1348
1349
1350
1351
1352
1353
1354
1355
1356
1357
1358
1359
1360
1361
1362
1363
1364
1365
1366
1367
1368
1369
1370
1371
1372
1373
1374
1375
1376
1377
1378
1379
1380</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='year identifier id'>year</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the day-of-the-year of this date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># January 1 is day-of-the-year 1</span>
  <span class='def def kw'>def</span> <span class='yday identifier id'>yday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='ordinal identifier id'>ordinal</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the month of this date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># January is month 1.</span>
  <span class='def def kw'>def</span> <span class='mon identifier id'>mon</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the day-of-the-month of this date.</span>
  <span class='def def kw'>def</span> <span class='mday identifier id'>mday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='civil identifier id'>civil</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:month</span><span class='comma token'>,</span> <span class='symbol val'>:mon</span>
  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:day</span><span class='comma token'>,</span> <span class='symbol val'>:mday</span>

  <span class='def def kw'>def</span> <span class='wnum0 identifier id'>wnum0</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum0 identifier id'>weeknum0</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>
  <span class='def def kw'>def</span> <span class='wnum1 identifier id'>wnum1</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='weeknum1 identifier id'>weeknum1</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:wnum0</span><span class='comma token'>,</span> <span class='symbol val'>:wnum1</span>

  <span class='comment val'># Get the time of this date as [hours, minutes, seconds,</span>
  <span class='comment val'># fraction_of_a_second]</span>
  <span class='def def kw'>def</span> <span class='time identifier id'>time</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='day_fraction_to_time identifier id'>day_fraction_to_time</span><span class='lparen token'>(</span><span class='day_fraction identifier id'>day_fraction</span><span class='rparen token'>)</span> <span class='end end kw'>end</span> <span class='comment val'># :nodoc:</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:time</span>
  <span class='private identifier id'>private</span> <span class='symbol val'>:time</span>

  <span class='comment val'># Get the hour of this date.</span>
  <span class='def def kw'>def</span> <span class='hour identifier id'>hour</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the minute of this date.</span>
  <span class='def def kw'>def</span> <span class='min identifier id'>min</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the second of this date.</span>
  <span class='def def kw'>def</span> <span class='sec identifier id'>sec</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the fraction-of-a-second of this date.  The unit is in days.</span>
  <span class='comment val'># I do NOT recommend you to use this method.</span>
  <span class='def def kw'>def</span> <span class='sec_fraction identifier id'>sec_fraction</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='time identifier id'>time</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:hour</span><span class='comma token'>,</span> <span class='symbol val'>:min</span><span class='comma token'>,</span> <span class='symbol val'>:sec</span><span class='comma token'>,</span> <span class='symbol val'>:sec_fraction</span>

  <span class='def def kw'>def</span> <span class='zone identifier id'>zone</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%:z'</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:zone</span>

  <span class='comment val'># Get the commercial year of this date.  See *Commercial* *Date*</span>
  <span class='comment val'># in the introduction for how this differs from the normal year.</span>
  <span class='def def kw'>def</span> <span class='cwyear identifier id'>cwyear</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial week of the year of this date.</span>
  <span class='def def kw'>def</span> <span class='cweek identifier id'>cweek</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the commercial day of the week of this date.  Monday is</span>
  <span class='comment val'># commercial day-of-week 1; Sunday is commercial day-of-week 7.</span>
  <span class='def def kw'>def</span> <span class='cwday identifier id'>cwday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='commercial identifier id'>commercial</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span> <span class='end end kw'>end</span>

  <span class='comment val'># Get the week day of this date.  Sunday is day-of-week 0;</span>
  <span class='comment val'># Saturday is day-of-week 6.</span>
  <span class='def def kw'>def</span> <span class='wday identifier id'>wday</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_wday identifier id'>jd_to_wday</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:wday</span>

<span class='comment val'>=begin
  MONTHNAMES.each_with_index do |n, i|
    if n
      define_method(n.downcase + '?'){mon == i}
    end
  end

  DAYNAMES.each_with_index do |n, i|
    define_method(n.downcase + '?'){wday == i}
  end
=end
</span>


  <span class='comment val'># Is the current date old-style (Julian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='julian? fid id'>julian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='julian? fid id'>julian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Is the current date new-style (Gregorian Calendar)?</span>
  <span class='def def kw'>def</span> <span class='gregorian? fid id'>gregorian?</span> <span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='gregorian? fid id'>gregorian?</span><span class='lparen token'>(</span><span class='jd identifier id'>jd</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:julian?</span><span class='comma token'>,</span> <span class='symbol val'>:gregorian?</span>

  <span class='def def kw'>def</span> <span class='fix_style identifier id'>fix_style</span> <span class='comment val'># :nodoc:</span>
    <span class='if if kw'>if</span> <span class='julian? fid id'>julian?</span>
    <span class='then then kw'>then</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span>
    <span class='else else kw'>else</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span> <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:fix_style</span>

  <span class='comment val'># Is this a leap year?</span>
  <span class='def def kw'>def</span> <span class='leap? fid id'>leap?</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='jd_to_civil identifier id'>jd_to_civil</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='civil_to_jd identifier id'>civil_to_jd</span><span class='lparen token'>(</span><span class='year identifier id'>year</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                     <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>29</span>
  <span class='end end kw'>end</span>

  <span class='once identifier id'>once</span> <span class='symbol val'>:leap?</span>

  <span class='comment val'># When is the Day of Calendar Reform for this Date object?</span>
  <span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@sg ivar id'>@sg</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object using a new Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='sg identifier id'>sg</span><span class='assign token'>=</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the Italian/Catholic</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='italy identifier id'>italy</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ITALY constant id'>ITALY</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that uses the English/Colonial</span>
  <span class='comment val'># Day of Calendar Reform.</span>
  <span class='def def kw'>def</span> <span class='england identifier id'>england</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='ENGLAND constant id'>ENGLAND</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Julian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='julian identifier id'>julian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='JULIAN constant id'>JULIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Create a copy of this Date object that always uses the Gregorian</span>
  <span class='comment val'># Calendar.</span>
  <span class='def def kw'>def</span> <span class='gregorian identifier id'>gregorian</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='new_start identifier id'>new_start</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='colon2 op'>::</span><span class='GREGORIAN constant id'>GREGORIAN</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='offset identifier id'>offset</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@of ivar id'>@of</span> <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='new_offset identifier id'>new_offset</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='String constant id'>String</span> <span class='eqq op'>===</span> <span class='of identifier id'>of</span>
      <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='zone_to_diff identifier id'>zone_to_diff</span><span class='lparen token'>(</span><span class='of identifier id'>of</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>86400</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:offset</span><span class='comma token'>,</span> <span class='symbol val'>:new_offset</span>

  <span class='comment val'># Return a new Date object that is +n+ days later than the</span>
  <span class='comment val'># current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +n+ may be a negative value, in which case the new Date</span>
  <span class='comment val'># is earlier than the current one; however, #-() might be</span>
  <span class='comment val'># more intuitive.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +n+ is not a Numeric, a TypeError will be thrown.  In</span>
  <span class='comment val'># particular, two Dates cannot be added to each other.</span>
  <span class='def def kw'>def</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='n identifier id'>n</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># If +x+ is a Numeric value, create a new Date object that is</span>
  <span class='comment val'># +x+ days earlier than the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is a Date, return the number of days between the</span>
  <span class='comment val'># two dates; or, more precisely, how many days later the current</span>
  <span class='comment val'># date is than +x+.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If +x+ is neither Numeric nor a Date, a TypeError is raised.</span>
  <span class='def def kw'>def</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='string val'>'expected numeric or date'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Compare this date with another date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ can also be a Numeric value, in which case it is</span>
  <span class='comment val'># interpreted as an Astronomical Julian Day Number.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Comparison is by Astronomical Julian Day Number, including</span>
  <span class='comment val'># fractional days.  This means that both the time and the</span>
  <span class='comment val'># timezone offset are taken into account when comparing</span>
  <span class='comment val'># two DateTime instances.  When comparing a DateTime instance</span>
  <span class='comment val'># with a Date instance, the time of the latter will be</span>
  <span class='comment val'># considered as falling on midnight UTC.</span>
  <span class='def def kw'>def</span> <span class='cmp op'>&lt;=&gt;</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='@ajd ivar id'>@ajd</span> <span class='cmp op'>&lt;=&gt;</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='ajd identifier id'>ajd</span>
    <span class='end end kw'>end</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># The relationship operator for Date.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># Compares dates by Julian Day Number.  When comparing</span>
  <span class='comment val'># two DateTime instances, or a DateTime with a Date,</span>
  <span class='comment val'># the instances will be regarded as equivalent if they</span>
  <span class='comment val'># fall on the same date in local time.</span>
  <span class='def def kw'>def</span> <span class='eqq op'>===</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
    <span class='case case kw'>case</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Numeric constant id'>Numeric</span><span class='semicolon token'>;</span> <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span>
    <span class='when when kw'>when</span> <span class='Date constant id'>Date</span><span class='semicolon token'>;</span>    <span class='return return kw'>return</span> <span class='jd identifier id'>jd</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='jd identifier id'>jd</span>
    <span class='end end kw'>end</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='def def kw'>def</span> <span class='next_day identifier id'>next_day</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span> <span class='end end kw'>end</span>
<span class='comment val'># def prev_day(n=1) self - n end</span>

  <span class='private identifier id'>private</span> <span class='symbol val'>:next_day</span>

  <span class='comment val'># Return a new Date one day after this one.</span>
  <span class='def def kw'>def</span> <span class='next next kw'>next</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='next_day identifier id'>next_day</span> <span class='end end kw'>end</span>

  <span class='alias_method identifier id'>alias_method</span> <span class='symbol val'>:succ</span><span class='comma token'>,</span> <span class='symbol val'>:next</span>

  <span class='comment val'># Return a new Date object that is +n+ months later than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='rshft op'>&gt;&gt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='year identifier id'>year</span> <span class='mult op'>*</span> <span class='integer val'>12</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='mon identifier id'>mon</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='n identifier id'>n</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span>
    <span class='m identifier id'>m</span><span class='comma token'>,</span>   <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span>                    <span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='mday identifier id'>mday</span>
    <span class='d identifier id'>d</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='until until_mod kw'>until</span> <span class='jd2 identifier id'>jd2</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='valid_civil? fid id'>valid_civil?</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='d identifier id'>d</span><span class='comma token'>,</span> <span class='fix_style identifier id'>fix_style</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='jd2 identifier id'>jd2</span> <span class='minus op'>-</span> <span class='jd identifier id'>jd</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Return a new Date object that is +n+ months earlier than</span>
  <span class='comment val'># the current one.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># If the day-of-the-month of the current Date is greater</span>
  <span class='comment val'># than the last day of the target month, the day-of-the-month</span>
  <span class='comment val'># of the returned Date will be the last day of the target month.</span>
  <span class='def def kw'>def</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='rparen token'>)</span> <span class='self self kw'>self</span> <span class='rshft op'>&gt;&gt;</span> <span class='minus op'>-</span><span class='n identifier id'>n</span> <span class='end end kw'>end</span>

<span class='comment val'>=begin
  def next_month(n=1) self &gt;&gt; n end
  def prev_month(n=1) self &lt;&lt; n end

  def next_year(n=1) self &gt;&gt; n * 12 end
  def prev_year(n=1) self &lt;&lt; n * 12 end
=end
</span>


<span class='comment val'>#  require 'enumerator'</span>

  <span class='comment val'># Step the current date forward +step+ days at a</span>
  <span class='comment val'># time (or backward, if +step+ is negative) until</span>
  <span class='comment val'># we reach +limit+ (inclusive), yielding the resultant</span>
  <span class='comment val'># date at each step.</span>
  <span class='def def kw'>def</span> <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='step identifier id'>step</span><span class='assign token'>=</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
<span class='comment val'>=begin
    unless block_given?
      return to_enum(:step, limit, step)
    end
=end
</span>

    <span class='da identifier id'>da</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
    <span class='op identifier id'>op</span> <span class='assign token'>=</span> <span class='dstring node'>%w(- &lt;= &gt;=)</span><span class='lbrack token'>[</span><span class='step identifier id'>step</span> <span class='cmp op'>&lt;=&gt;</span> <span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='while while kw'>while</span> <span class='da identifier id'>da</span><span class='dot token'>.</span><span class='__send__ identifier id'>__send__</span><span class='lparen token'>(</span><span class='op identifier id'>op</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='rparen token'>)</span>
      <span class='yield yield kw'>yield</span> <span class='da identifier id'>da</span>
      <span class='da identifier id'>da</span> <span class='opasgn op'>+=</span> <span class='step identifier id'>step</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step forward one day at a time until we reach +max+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='integer val'>+1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Step backward one day at a time until we reach +min+</span>
  <span class='comment val'># (inclusive), yielding each date as we go.</span>
  <span class='def def kw'>def</span> <span class='downto identifier id'>downto</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :yield: date</span>
    <span class='step identifier id'>step</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Is this Date equal to +other+?</span>
  <span class='comment val'>#</span>
  <span class='comment val'># +other+ must both be a Date object, and represent the same date.</span>
  <span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span> <span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span> <span class='Date constant id'>Date</span> <span class='eqq op'>===</span> <span class='other identifier id'>other</span> <span class='andop op'>&amp;&amp;</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='other identifier id'>other</span> <span class='end end kw'>end</span>

  <span class='comment val'># Calculate a hash value for this date.</span>
  <span class='def def kw'>def</span> <span class='hash identifier id'>hash</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='@ajd ivar id'>@ajd</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return internal object state as a programmer-readable string.</span>
  <span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='format identifier id'>format</span><span class='lparen token'>(</span><span class='string val'>'#&lt;%s: %s,%s,%s&gt;'</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='comma token'>,</span> <span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

  <span class='comment val'># Return the date as a human-readable string.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># The format used is YYYY-MM-DD.</span>
  <span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='strftime identifier id'>strftime</span> <span class='end end kw'>end</span>

  <span class='comment val'># Dump to Marshal format.</span>
  <span class='def def kw'>def</span> <span class='_dump identifier id'>_dump</span><span class='lparen token'>(</span><span class='limit identifier id'>limit</span><span class='rparen token'>)</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='@ajd ivar id'>@ajd</span><span class='comma token'>,</span> <span class='@of ivar id'>@of</span><span class='comma token'>,</span> <span class='@sg ivar id'>@sg</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='integer val'>-1</span><span class='rparen token'>)</span> <span class='end end kw'>end</span>

<span class='comment val'># def self._load(str) new!(*Marshal.load(str)) end</span>

  <span class='comment val'># Load from Marshall format.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_load identifier id'>_load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span>     <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
           <span class='of identifier id'>of</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='ajd identifier id'>ajd</span> <span class='opasgn op'>-=</span> <span class='float val'>1</span><span class='dot token'>.</span><span class='to_r identifier id'>to_r</span><span class='div op'>/</span><span class='integer val'>2</span>
    <span class='else else kw'>else</span>
      <span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span>
    <span class='end end kw'>end</span>
    <span class='new! fid id'>new!</span><span class='lparen token'>(</span><span class='ajd identifier id'>ajd</span><span class='comma token'>,</span> <span class='of identifier id'>of</span><span class='comma token'>,</span> <span class='sg identifier id'>sg</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>