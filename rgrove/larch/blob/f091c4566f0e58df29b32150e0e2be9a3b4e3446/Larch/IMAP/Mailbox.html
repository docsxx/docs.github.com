<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>rgrove's larch - Class: Larch::IMAP::Mailbox - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/rgrove/commits/larch/master" rel="alternate" title="Recent Commits to larch:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("rgrove", "larch", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("rgrove", "larch", "f091c4566f0e58df29b32150e0e2be9a3b4e3446", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/rgrove/larch/tree/">Source</a></li>
            <li class=""><a href="http://github.com/rgrove/larch/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/rgrove/larch/network">Network</a></li>            
            <li class=""><a href="http://github.com/rgrove/larch/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/rgrove/larch">Wiki</a></li>
            <li class=""><a href="http://github.com/rgrove/larch/graphs">Graphs</a></li>                    
            <li class="active"><a href="/rgrove/larch">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/rgrove">rgrove</a> / <b><a href="http://github.com/rgrove/larch/tree">larch</a></b>        
                <a id="namespaces_button" rel="rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Larch_IMAP_Mailbox">
  <h1>Class: Larch::IMAP::Mailbox</h1>
  <div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">attr</td>
          <td class="readwrite">
            [<span id='attr-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>attr</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">delim</td>
          <td class="readwrite">
            [<span id='delim-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>delim</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">imap</td>
          <td class="readwrite">
            [<span id='imap-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>imap</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">name</td>
          <td class="readwrite">
            [<span id='name-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>name</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">state</td>
          <td class="readwrite">
            [<span id='state-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>state</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="REGEX_MESSAGE_ID-constant">REGEX_MESSAGE_ID</dt>
      <dd>/message-id\s*:\s*(\S+)/i</dd>
    
      <dt id="SCAN_INTERVAL-constant">SCAN_INTERVAL</dt>
      <dd>60</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(imap, name, delim, subscribed, *attr)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="param">
  <h3>Parameters:</h3>
  <dl>
  
  </dl>
</div><div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>ArgumentError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 13</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L13">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='imap identifier id'>imap</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='delim identifier id'>delim</span><span class='comma token'>,</span> <span class='subscribed identifier id'>subscribed</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='attr identifier id'>attr</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>&quot;must provide a Larch::IMAP instance&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='imap identifier id'>imap</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Larch constant id'>Larch</span><span class='colon2 op'>::</span><span class='IMAP constant id'>IMAP</span><span class='rparen token'>)</span>

  <span class='@imap ivar id'>@imap</span>       <span class='assign token'>=</span> <span class='imap identifier id'>imap</span>
  <span class='@name ivar id'>@name</span>       <span class='assign token'>=</span> <span class='name identifier id'>name</span>
  <span class='@delim ivar id'>@delim</span>      <span class='assign token'>=</span> <span class='delim identifier id'>delim</span>
  <span class='@subscribed ivar id'>@subscribed</span> <span class='assign token'>=</span> <span class='subscribed identifier id'>subscribed</span>
  <span class='@attr ivar id'>@attr</span>       <span class='assign token'>=</span> <span class='attr identifier id'>attr</span><span class='dot token'>.</span><span class='flatten identifier id'>flatten</span>

  <span class='@ids ivar id'>@ids</span>       <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@last_id ivar id'>@last_id</span>   <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@last_scan ivar id'>@last_scan</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='@mutex ivar id'>@mutex</span>     <span class='assign token'>=</span> <span class='Mutex constant id'>Mutex</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

  <span class='comment val'># Valid mailbox states are :closed (no mailbox open), :examined (mailbox</span>
  <span class='comment val'># open and read-only), or :selected (mailbox open and read-write).</span>
  <span class='@state ivar id'>@state</span> <span class='assign token'>=</span> <span class='symbol val'>:closed</span>

  <span class='comment val'># Create private convenience methods (debug, info, warn, etc.) to make</span>
  <span class='comment val'># logging easier.</span>
  <span class='Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='LEVELS constant id'>LEVELS</span><span class='dot token'>.</span><span class='each_key identifier id'>each_key</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='level identifier id'>level</span><span class='bitor op'>|</span>
    <span class='Mailbox constant id'>Mailbox</span><span class='dot token'>.</span><span class='class_eval identifier id'>class_eval</span> <span class='do do kw'>do</span>
      <span class='define_method identifier id'>define_method</span><span class='lparen token'>(</span><span class='level identifier id'>level</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='msg identifier id'>msg</span><span class='bitor op'>|</span>
        <span class='Larch constant id'>Larch</span><span class='dot token'>.</span><span class='log identifier id'>log</span><span class='dot token'>.</span><span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='level identifier id'>level</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{@imap.username}@#{@imap.host}: #{@name}: #{msg}&quot;</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>

      <span class='private identifier id'>private</span> <span class='level identifier id'>level</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#append-instance_method">#append</span><span class='args'>(message)</span>
        <span class='block'></span>
        
          <span class='alias'>#&lt;&lt;</span>
        
      </th>
      <td class="docstring">
        <p>
Appends the specified Larch::IMAP::Message to this mailbox if it
doesn&#8217;t already exist.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#each-instance_method">#each</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Iterates through Larch message ids in this mailbox, yielding each one to
the provided block.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#envelope-instance_method">#envelope</span><span class='args'>(message_id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets a Net::IMAP::Envelope for the specified message id.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#fetch-instance_method">#fetch</span><span class='args'>(message_id, peek = false)</span>
        <span class='block'></span>
        
          <span class='alias'>#[]</span>
        
      </th>
      <td class="docstring">
        <p>
Fetches a Larch::IMAP::Message struct representing the message with the
specified Larch message id.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_message-3F-instance_method">#has_message?</span><span class='args'>(message_id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns <tt>true</tt> if a message with the specified Larch
<em>message_id</em> exists in this mailbox, <tt>false</tt> otherwise.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#length-instance_method">#length</span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#size</span>
        
      </th>
      <td class="docstring">
        <p>
Gets the number of messages in this mailbox.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#peek-instance_method">#peek</span><span class='args'>(message_id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Same as fetch, but doesn&#8217;t mark the message as seen.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reset-instance_method">#reset</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Resets the mailbox state.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#scan-instance_method">#scan</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Fetches message headers from this mailbox.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#subscribe-instance_method">#subscribe</span><span class='args'>(force = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Subscribes to this mailbox.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#subscribed-3F-instance_method">#subscribed?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns <tt>true</tt> if this mailbox is subscribed, <tt>false</tt>
otherwise.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#unsubscribe-instance_method">#unsubscribe</span><span class='args'>(force = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Unsubscribes from this mailbox.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>append</h3>
</div><div id="append-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>append</span><span class='args'>(message)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="%3C%3C-instance_method">&lt;&lt;</tt>
  
</p>
</div><div class="section docstring">
  <p>
Appends the specified Larch::IMAP::Message to this mailbox if it
doesn&#8217;t already exist. Returns <tt>true</tt> if the message was
appended successfully, <tt>false</tt> if the message already exists in the
mailbox.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="param">
  <h3>Parameters:</h3>
  <dl>
  
  </dl>
</div><div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>ArgumentError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 47</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L47">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='append identifier id'>append</span><span class='lparen token'>(</span><span class='message identifier id'>message</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>&quot;must provide a Larch::IMAP::Message object&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='message identifier id'>message</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Larch constant id'>Larch</span><span class='colon2 op'>::</span><span class='IMAP constant id'>IMAP</span><span class='colon2 op'>::</span><span class='Message constant id'>Message</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='has_message? fid id'>has_message?</span><span class='lparen token'>(</span><span class='message identifier id'>message</span><span class='rparen token'>)</span>

  <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='safely identifier id'>safely</span> <span class='do do kw'>do</span>
    <span class='unless unless kw'>unless</span> <span class='imap_select identifier id'>imap_select</span><span class='lparen token'>(</span><span class='notop op'>!</span><span class='notop op'>!</span><span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='create_mailbox identifier id'>create_mailbox</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='raise identifier id'>raise</span> <span class='Larch constant id'>Larch</span><span class='colon2 op'>::</span><span class='IMAP constant id'>IMAP</span><span class='colon2 op'>::</span><span class='Error constant id'>Error</span><span class='comma token'>,</span> <span class='dstring node'>&quot;mailbox cannot contain messages: #{@name}&quot;</span>
    <span class='end end kw'>end</span>

    <span class='debug identifier id'>debug</span> <span class='dstring node'>&quot;appending message: #{message.id}&quot;</span>
    <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='append identifier id'>append</span><span class='lparen token'>(</span><span class='@name ivar id'>@name</span><span class='comma token'>,</span> <span class='message identifier id'>message</span><span class='dot token'>.</span><span class='rfc822 identifier id'>rfc822</span><span class='comma token'>,</span> <span class='message identifier id'>message</span><span class='dot token'>.</span><span class='flags identifier id'>flags</span><span class='comma token'>,</span> <span class='message identifier id'>message</span><span class='dot token'>.</span><span class='internaldate identifier id'>internaldate</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:dry_run</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>

  <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>each</h3>
</div><div id="each-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>each</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Iterates through Larch message ids in this mailbox, yielding each one to
the provided block.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 66</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L66">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">66
67
68
69</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='each identifier id'>each</span>
  <span class='scan identifier id'>scan</span>
  <span class='@ids ivar id'>@ids</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span><span class='dot token'>.</span><span class='each_key identifier id'>each_key</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='id identifier id'>id</span><span class='bitor op'>|</span> <span class='yield yield kw'>yield</span> <span class='id identifier id'>id</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>envelope</h3>
</div><div id="envelope-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>envelope</span><span class='args'>(message_id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets a Net::IMAP::Envelope for the specified message id.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="param">
  <h3>Parameters:</h3>
  <dl>
  
  </dl>
</div><div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="MessageNotFoundError.html" title="Larch::IMAP::MessageNotFoundError">Larch::IMAP::MessageNotFoundError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 72</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L72">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">72
73
74
75
76
77
78</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='envelope identifier id'>envelope</span><span class='lparen token'>(</span><span class='message_id identifier id'>message_id</span><span class='rparen token'>)</span>
  <span class='scan identifier id'>scan</span>
  <span class='raise identifier id'>raise</span> <span class='Larch constant id'>Larch</span><span class='colon2 op'>::</span><span class='IMAP constant id'>IMAP</span><span class='colon2 op'>::</span><span class='MessageNotFoundError constant id'>MessageNotFoundError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;message not found: #{message_id}&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='uid identifier id'>uid</span> <span class='assign token'>=</span> <span class='@ids ivar id'>@ids</span><span class='lbrack token'>[</span><span class='message_id identifier id'>message_id</span><span class='rbrack token'>]</span>

  <span class='debug identifier id'>debug</span> <span class='dstring node'>&quot;fetching envelope: #{message_id}&quot;</span>
  <span class='imap_uid_fetch identifier id'>imap_uid_fetch</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='uid identifier id'>uid</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>'ENVELOPE'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='dot token'>.</span><span class='attr identifier id'>attr</span><span class='lbrack token'>[</span><span class='string val'>'ENVELOPE'</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>fetch</h3>
</div><div id="fetch-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>fetch</span><span class='args'>(message_id, peek = false)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="%5B%5D-instance_method">[]</tt>
  
</p>
</div><div class="section docstring">
  <p>
Fetches a Larch::IMAP::Message struct representing the message with the
specified Larch message id.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="param">
  <h3>Parameters:</h3>
  <dl>
  
  </dl>
</div><div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="MessageNotFoundError.html" title="Larch::IMAP::MessageNotFoundError">Larch::IMAP::MessageNotFoundError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 82</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L82">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">82
83
84
85
86
87
88
89
90
91</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='fetch identifier id'>fetch</span><span class='lparen token'>(</span><span class='message_id identifier id'>message_id</span><span class='comma token'>,</span> <span class='peek identifier id'>peek</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='scan identifier id'>scan</span>
  <span class='raise identifier id'>raise</span> <span class='Larch constant id'>Larch</span><span class='colon2 op'>::</span><span class='IMAP constant id'>IMAP</span><span class='colon2 op'>::</span><span class='MessageNotFoundError constant id'>MessageNotFoundError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;message not found: #{message_id}&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='uid identifier id'>uid</span> <span class='assign token'>=</span> <span class='@ids ivar id'>@ids</span><span class='lbrack token'>[</span><span class='message_id identifier id'>message_id</span><span class='rbrack token'>]</span>

  <span class='debug identifier id'>debug</span> <span class='dstring node'>&quot;#{peek ? 'peeking at' : 'fetching'} message: #{message_id}&quot;</span>
  <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='imap_uid_fetch identifier id'>imap_uid_fetch</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='uid identifier id'>uid</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='lparen token'>(</span><span class='peek identifier id'>peek</span> <span class='integer val'>? </span><span class='string val'>'BODY.PEEK[]'</span> <span class='colon op'>:</span> <span class='string val'>'BODY[]'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='string val'>'FLAGS'</span><span class='comma token'>,</span> <span class='string val'>'INTERNALDATE'</span><span class='comma token'>,</span> <span class='string val'>'ENVELOPE'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span>

  <span class='Message constant id'>Message</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='message_id identifier id'>message_id</span><span class='comma token'>,</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='attr identifier id'>attr</span><span class='lbrack token'>[</span><span class='string val'>'ENVELOPE'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='attr identifier id'>attr</span><span class='lbrack token'>[</span><span class='string val'>'BODY[]'</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
      <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='attr identifier id'>attr</span><span class='lbrack token'>[</span><span class='string val'>'FLAGS'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='dot token'>.</span><span class='attr identifier id'>attr</span><span class='lbrack token'>[</span><span class='string val'>'INTERNALDATE'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_message?</h3>
</div><div id="has_message-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_message?</span><span class='args'>(message_id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns <tt>true</tt> if a message with the specified Larch
<em>message_id</em> exists in this mailbox, <tt>false</tt> otherwise.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 96</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L96">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">96
97
98
99</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='has_message? fid id'>has_message?</span><span class='lparen token'>(</span><span class='message_id identifier id'>message_id</span><span class='rparen token'>)</span>
  <span class='scan identifier id'>scan</span>
  <span class='@ids ivar id'>@ids</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='message_id identifier id'>message_id</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>length</h3>
</div><div id="length-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>length</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="size-instance_method">size</tt>
  
</p>
</div><div class="section docstring">
  <p>
Gets the number of messages in this mailbox.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 102</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L102">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">102
103
104
105</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='length identifier id'>length</span>
  <span class='scan identifier id'>scan</span>
  <span class='@ids ivar id'>@ids</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>peek</h3>
</div><div id="peek-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>peek</span><span class='args'>(message_id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Same as fetch, but doesn&#8217;t mark the message as seen.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 109</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L109">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">109
110
111</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='peek identifier id'>peek</span><span class='lparen token'>(</span><span class='message_id identifier id'>message_id</span><span class='rparen token'>)</span>
  <span class='fetch identifier id'>fetch</span><span class='lparen token'>(</span><span class='message_id identifier id'>message_id</span><span class='comma token'>,</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reset</h3>
</div><div id="reset-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reset</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Resets the mailbox state.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 114</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L114">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">114
115
116</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reset identifier id'>reset</span>
  <span class='@mutex ivar id'>@mutex</span><span class='dot token'>.</span><span class='synchronize identifier id'>synchronize</span> <span class='lbrace token'>{</span> <span class='@state ivar id'>@state</span> <span class='assign token'>=</span> <span class='symbol val'>:closed</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>scan</h3>
</div><div id="scan-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>scan</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Fetches message headers from this mailbox.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 119</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L119">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='scan identifier id'>scan</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='@last_scan ivar id'>@last_scan</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span> <span class='minus op'>-</span> <span class='@last_scan ivar id'>@last_scan</span><span class='rparen token'>)</span> <span class='lt op'>&lt;</span> <span class='SCAN_INTERVAL constant id'>SCAN_INTERVAL</span>

  <span class='begin begin kw'>begin</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='imap_examine identifier id'>imap_examine</span>
  <span class='rescue rescue kw'>rescue</span> <span class='Error constant id'>Error</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
    <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:create_mailbox</span><span class='rbrack token'>]</span>
    <span class='raise identifier id'>raise</span>
  <span class='end end kw'>end</span>

  <span class='last_id identifier id'>last_id</span> <span class='assign token'>=</span> <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='safely identifier id'>safely</span> <span class='lbrace token'>{</span> <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='responses identifier id'>responses</span><span class='lbrack token'>[</span><span class='string val'>'EXISTS'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='last identifier id'>last</span> <span class='rbrace token'>}</span>
  <span class='@mutex ivar id'>@mutex</span><span class='dot token'>.</span><span class='synchronize identifier id'>synchronize</span> <span class='lbrace token'>{</span> <span class='@last_scan ivar id'>@last_scan</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span> <span class='rbrace token'>}</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='last_id identifier id'>last_id</span> <span class='eq op'>==</span> <span class='@last_id ivar id'>@last_id</span>

  <span class='range identifier id'>range</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='@last_id ivar id'>@last_id</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span><span class='dot2 op'>..</span><span class='last_id identifier id'>last_id</span>
  <span class='@mutex ivar id'>@mutex</span><span class='dot token'>.</span><span class='synchronize identifier id'>synchronize</span> <span class='lbrace token'>{</span> <span class='@last_id ivar id'>@last_id</span> <span class='assign token'>=</span> <span class='last_id identifier id'>last_id</span> <span class='rbrace token'>}</span>

  <span class='info identifier id'>info</span> <span class='dstring node'>&quot;fetching message headers #{range}&quot;</span> <span class='lshft op'>&lt;&lt;</span>
      <span class='lparen token'>(</span><span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:fast_scan</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='string val'>' (fast scan)'</span> <span class='colon op'>:</span> <span class='string val'>''</span><span class='rparen token'>)</span>

  <span class='fields identifier id'>fields</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='fast_scan identifier id'>fast_scan</span><span class='rbrack token'>]</span>
    <span class='lbrack token'>[</span><span class='string val'>'UID'</span><span class='comma token'>,</span> <span class='string val'>'RFC822.SIZE'</span><span class='comma token'>,</span> <span class='string val'>'INTERNALDATE'</span><span class='rbrack token'>]</span>
  <span class='else else kw'>else</span>
    <span class='string val'>&quot;(UID BODY.PEEK[HEADER.FIELDS (MESSAGE-ID)] RFC822.SIZE INTERNALDATE)&quot;</span>
  <span class='end end kw'>end</span>

  <span class='imap_fetch identifier id'>imap_fetch</span><span class='lparen token'>(</span><span class='range identifier id'>range</span><span class='dot token'>.</span><span class='begin identifier id'>begin</span><span class='dot2 op'>..</span><span class='integer val'>-1</span><span class='comma token'>,</span> <span class='fields identifier id'>fields</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='data identifier id'>data</span><span class='bitor op'>|</span>
    <span class='id identifier id'>id</span> <span class='assign token'>=</span> <span class='create_id identifier id'>create_id</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='rparen token'>)</span>

    <span class='unless unless kw'>unless</span> <span class='uid identifier id'>uid</span> <span class='assign token'>=</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='attr identifier id'>attr</span><span class='lbrack token'>[</span><span class='string val'>'UID'</span><span class='rbrack token'>]</span>
      <span class='error identifier id'>error</span> <span class='dstring node'>&quot;UID not in IMAP response for message: #{id}&quot;</span>
      <span class='next next kw'>next</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='Larch constant id'>Larch</span><span class='dot token'>.</span><span class='log identifier id'>log</span><span class='dot token'>.</span><span class='level identifier id'>level</span> <span class='eq op'>==</span> <span class='colon op'>:</span><span class='debug identifier id'>debug</span> <span class='andop op'>&amp;&amp;</span> <span class='@ids ivar id'>@ids</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
      <span class='envelope identifier id'>envelope</span> <span class='assign token'>=</span> <span class='imap_uid_fetch identifier id'>imap_uid_fetch</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='uid identifier id'>uid</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>'ENVELOPE'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='dot token'>.</span><span class='attr identifier id'>attr</span><span class='lbrack token'>[</span><span class='string val'>'ENVELOPE'</span><span class='rbrack token'>]</span>
      <span class='debug identifier id'>debug</span> <span class='dstring node'>&quot;duplicate message? #{id} (Subject: #{envelope.subject})&quot;</span>
    <span class='end end kw'>end</span>

    <span class='@mutex ivar id'>@mutex</span><span class='dot token'>.</span><span class='synchronize identifier id'>synchronize</span> <span class='lbrace token'>{</span> <span class='@ids ivar id'>@ids</span><span class='lbrack token'>[</span><span class='id identifier id'>id</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='uid identifier id'>uid</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>subscribe</h3>
</div><div id="subscribe-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>subscribe</span><span class='args'>(force = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Subscribes to this mailbox.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 163</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L163">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">163
164
165
166
167</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='subscribe identifier id'>subscribe</span><span class='lparen token'>(</span><span class='force identifier id'>force</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='subscribed? fid id'>subscribed?</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='force identifier id'>force</span>
  <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='safely identifier id'>safely</span> <span class='lbrace token'>{</span> <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='subscribe identifier id'>subscribe</span><span class='lparen token'>(</span><span class='@name ivar id'>@name</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='unless unless_mod kw'>unless</span> <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:dry_run</span><span class='rbrack token'>]</span>
  <span class='@mutex ivar id'>@mutex</span><span class='dot token'>.</span><span class='synchronize identifier id'>synchronize</span> <span class='lbrace token'>{</span> <span class='@subscribed ivar id'>@subscribed</span> <span class='assign token'>=</span> <span class='true true kw'>true</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>subscribed?</h3>
</div><div id="subscribed-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>subscribed?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns <tt>true</tt> if this mailbox is subscribed, <tt>false</tt>
otherwise.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 170</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L170">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">170
171
172</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='subscribed? fid id'>subscribed?</span>
  <span class='@subscribed ivar id'>@subscribed</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>unsubscribe</h3>
</div><div id="unsubscribe-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>unsubscribe</span><span class='args'>(force = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Unsubscribes from this mailbox.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/larch/imap/mailbox.rb', line 175</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rgrove/larch/blob/f091c4566f0e58df29b32150e0e2be9a3b4e3446/lib/larch/imap/mailbox.rb#L175">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">175
176
177
178
179</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='unsubscribe identifier id'>unsubscribe</span><span class='lparen token'>(</span><span class='force identifier id'>force</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='subscribed? fid id'>subscribed?</span> <span class='orop op'>||</span> <span class='force identifier id'>force</span>
  <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='safely identifier id'>safely</span> <span class='lbrace token'>{</span> <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='unsubscribe identifier id'>unsubscribe</span><span class='lparen token'>(</span><span class='@name ivar id'>@name</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='unless unless_mod kw'>unless</span> <span class='@imap ivar id'>@imap</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:dry_run</span><span class='rbrack token'>]</span>
  <span class='@mutex ivar id'>@mutex</span><span class='dot token'>.</span><span class='synchronize identifier id'>synchronize</span> <span class='lbrace token'>{</span> <span class='@subscribed ivar id'>@subscribed</span> <span class='assign token'>=</span> <span class='false false kw'>false</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>