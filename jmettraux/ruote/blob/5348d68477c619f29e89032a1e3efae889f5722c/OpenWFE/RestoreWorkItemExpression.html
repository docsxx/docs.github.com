<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>jmettraux's ruote - Class: OpenWFE::RestoreWorkItemExpression - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/jmettraux/commits/ruote/master" rel="alternate" title="Recent Commits to ruote:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("jmettraux", "ruote", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("jmettraux", "ruote", "5348d68477c619f29e89032a1e3efae889f5722c", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/jmettraux/ruote/tree/">Source</a></li>
            <li class=""><a href="http://github.com/jmettraux/ruote/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/jmettraux/ruote/network">Network</a></li>            
            <li class=""><a href="http://github.com/jmettraux/ruote/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/jmettraux/ruote">Wiki</a></li>
            <li class=""><a href="http://github.com/jmettraux/ruote/graphs">Graphs</a></li>                    
            <li class="active"><a href="/jmettraux/ruote">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/jmettraux">jmettraux</a> / <b><a href="http://github.com/jmettraux/ruote/tree">ruote</a></b>        
                <a id="namespaces_button" rel="jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class OpenWFE_RestoreWorkItemExpression">
  <h1>Class: OpenWFE::RestoreWorkItemExpression</h1>
  <div class="section inheritance">
  <ul>
  <li><a title="OpenWFE::ObjectWithMeta" href="ObjectWithMeta.html">OpenWFE::ObjectWithMeta</a></li><ul><li><a title="OpenWFE::FlowExpression" href="FlowExpression.html">OpenWFE::FlowExpression</a></li><ul><li>OpenWFE::RestoreWorkItemExpression</li>
  </ul></ul></ul>
</div><div class="section mixins">
  <h2>Included Modules</h2>
  <p><a title="OpenWFE::MergeMixin" href="RestoreWorkItemExpression/MergeMixin.html">OpenWFE::MergeMixin</a>, <a title="OpenWFE::ValueMixin" href="RestoreWorkItemExpression/ValueMixin.html">OpenWFE::ValueMixin</a></p>
</div><div class="section docstring">
  <p>
&quot;restore&quot; is often used in conjunction with &quot;save&quot;
(SaveWorkItemExpression).
</p>
<p>
It can restore a workitem saved to a variable (it will actually restore the
payload of that workitem) or transfer the content of a field as top
attribute field.
</p>
<pre class="code">
  <span class='restore identifier id'>restore</span> <span class='symbol val'>:from_variable</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;freezed_workitem&quot;</span>
    <span class='comment val'>#</span>
    <span class='comment val'># takes the freezed payload at 'freezed_workitem' and makes it</span>
    <span class='comment val'># the payload of the current workitem</span>

  <span class='restore identifier id'>restore</span> <span class='symbol val'>:from_field</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;some_data&quot;</span>
    <span class='comment val'>#</span>
    <span class='comment val'># replaces the payload of the current workitem with the hash</span>
    <span class='comment val'># found in the field &quot;some_data&quot;</span>

  <span class='restore identifier id'>restore</span> <span class='symbol val'>:from_variable</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;v&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:to_field</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;f&quot;</span>
    <span class='comment val'>#</span>
    <span class='comment val'># will copy the payload saved under variable &quot;v&quot; as the value</span>
    <span class='comment val'># of the field &quot;f&quot;</span>

  <span class='restore identifier id'>restore</span> <span class='symbol val'>:from_variable</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;v&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:merge_lead</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:current</span>
    <span class='comment val'>#</span>
    <span class='comment val'># will restore the payload of the workitem saved under v</span>
    <span class='comment val'># but if fields of v are already present in the current workitem</span>
    <span class='comment val'># the current values will be kept</span>

  <span class='restore identifier id'>restore</span> <span class='symbol val'>:from_variable</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;v&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:merge_lead</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:restored</span>
    <span class='comment val'>#</span>
    <span class='comment val'># will restore the payload of the workitem saved under v</span>
    <span class='comment val'># but the workitem v payload will have priority.</span>
</pre>
<p>
Beware : you should not restore from a field that is not a hash. The top
level attributes (payload) of a workitem should always be a hash.
</p>
<p>
Since OpenWFEru 0.9.17, the &#8216;set-fields&#8217; alias can be used for
restore.
</p>
<pre class="code">
  <span class='sequence identifier id'>sequence</span> <span class='do do kw'>do</span>
    <span class='set_fields identifier id'>set_fields</span> <span class='symbol val'>:value</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span>
      <span class='string val'>&quot;customer&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;name&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Zigue&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;age&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>34</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
      <span class='string val'>&quot;approved&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span> <span class='rbrace token'>}</span>
    <span class='_print identifier id'>_print</span> <span class='string val'>&quot;${f:customer.name} (${f:customer.age}) ${f:approved}&quot;</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Along with this new alias, the expression now behave much like the
&#8216;set&#8217; expression, but still, targets the whole workitem
payload.
</p>
<p>
Note that &quot;set-fields&quot; can be used outside of the body of a
process definition (along with &quot;set&quot;) to separate &#8216;data
preparation&#8217; from actual process definition.
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Test44b6 constant id'>Test44b6</span> <span class='lt op'>&lt;</span> <span class='ProcessDefinition constant id'>ProcessDefinition</span>
    <span class='set_fields identifier id'>set_fields</span> <span class='symbol val'>:value</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span>
      <span class='string val'>&quot;customer&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;name&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Zigue&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;age&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>34</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
      <span class='string val'>&quot;approved&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span> <span class='rbrace token'>}</span>
    <span class='sequence identifier id'>sequence</span> <span class='do do kw'>do</span>
      <span class='_print identifier id'>_print</span> <span class='string val'>&quot;${f:customer.name} (${f:customer.age}) ${f:approved}&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Using set_fields at the beginning of a process can be useful for setting up
forms (keys without values for now).
</p>
<pre class="code">
  <span class='set_fields identifier id'>set_fields</span> <span class='symbol val'>:value</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span>
    <span class='string val'>&quot;name&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;address&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;email&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;&quot;</span>
  <span class='rbrace token'>}</span>
</pre>

</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <div class="inherited">
  
  <div>
    <h2>Public Class Methods Inherited from <a title="OpenWFE::FlowExpression" href="FlowExpression.html">OpenWFE::FlowExpression</a></h2>
    <p><span class='name'><a title="is_definition" href="FlowExpression.html#is_definition-class_method">is_definition</a></span>, <span class='name'><a title="is_definition?" href="FlowExpression.html#is_definition%3F-class_method">is_definition?</a></span>, <span class='name'><a title="names" href="FlowExpression.html#names-class_method">names</a></span>, <span class='name'><a title="new_exp" href="FlowExpression.html#new_exp-class_method">new_exp</a></span></p>
  </div>
  
  <div>
    <h2>Public Class Methods Inherited from <a title="OpenWFE::ObjectWithMeta" href="ObjectWithMeta.html">OpenWFE::ObjectWithMeta</a></h2>
    <p><span class='name'><a title="meta_def" href="ObjectWithMeta.html#meta_def-class_method">meta_def</a></span>, <span class='name'><a title="meta_eval" href="ObjectWithMeta.html#meta_eval-class_method">meta_eval</a></span>, <span class='name'><a title="metaclass" href="ObjectWithMeta.html#metaclass-class_method">metaclass</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reply-instance_method">#reply</span><span class='args'>(workitem)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
so that in can be placed outside of process definition bodies.
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Instance Methods Inherited from <a title="OpenWFE::FlowExpression" href="FlowExpression.html">OpenWFE::FlowExpression</a></h2>
    <p><span class='name'><a title="apply" href="FlowExpression.html#apply-instance_method">apply</a></span>, <span class='name'><a title="apply_child" href="FlowExpression.html#apply_child-instance_method">apply_child</a></span>, <span class='name'><a title="cancel" href="FlowExpression.html#cancel-instance_method">cancel</a></span>, <span class='name'><a title="clean_children" href="FlowExpression.html#clean_children-instance_method">clean_children</a></span>, <span class='name'><a title="delete_variable" href="FlowExpression.html#delete_variable-instance_method">delete_variable</a></span>, <span class='name'><a title="descendant_of?" href="FlowExpression.html#descendant_of%3F-instance_method">descendant_of?</a></span>, <span class='name'><a title="dup_environment" href="FlowExpression.html#dup_environment-instance_method">dup_environment</a></span>, <span class='name'><a title="fetch_environment" href="FlowExpression.html#fetch_environment-instance_method">fetch_environment</a></span>, <span class='name'><a title="fetch_text_content" href="FlowExpression.html#fetch_text_content-instance_method">fetch_text_content</a></span>, <span class='name'><a title="first_expression_child" href="FlowExpression.html#first_expression_child-instance_method">first_expression_child</a></span>, <span class='name'><a title="get_binding" href="FlowExpression.html#get_binding-instance_method">get_binding</a></span>, <span class='name'><a title="get_environment" href="FlowExpression.html#get_environment-instance_method">get_environment</a></span>, <span class='name'><a title="get_next_sub_id" href="FlowExpression.html#get_next_sub_id-instance_method">get_next_sub_id</a></span>, <span class='name'><a title="get_parent" href="FlowExpression.html#get_parent-instance_method">get_parent</a></span>, <span class='name'><a title="get_root_environment" href="FlowExpression.html#get_root_environment-instance_method">get_root_environment</a></span>, <span class='name'><a title="has_attribute" href="FlowExpression.html#has_attribute-instance_method">has_attribute</a></span>, <span class='name'><a title="has_no_expression_child" href="FlowExpression.html#has_no_expression_child-instance_method">has_no_expression_child</a></span>, <span class='name'><a title="lookup_array_attribute" href="FlowExpression.html#lookup_array_attribute-instance_method">lookup_array_attribute</a></span>, <span class='name'><a title="lookup_attribute" href="FlowExpression.html#lookup_attribute-instance_method">lookup_attribute</a></span>, <span class='name'><a title="lookup_attributes" href="FlowExpression.html#lookup_attributes-instance_method">lookup_attributes</a></span>, <span class='name'><a title="lookup_boolean_attribute" href="FlowExpression.html#lookup_boolean_attribute-instance_method">lookup_boolean_attribute</a></span>, <span class='name'><a title="lookup_downcase_attribute" href="FlowExpression.html#lookup_downcase_attribute-instance_method">lookup_downcase_attribute</a></span>, <span class='name'><a title="lookup_ref" href="FlowExpression.html#lookup_ref-instance_method">lookup_ref</a></span>, <span class='name'><a title="lookup_string_attribute" href="FlowExpression.html#lookup_string_attribute-instance_method">lookup_string_attribute</a></span>, <span class='name'><a title="lookup_sym_attribute" href="FlowExpression.html#lookup_sym_attribute-instance_method">lookup_sym_attribute</a></span>, <span class='name'><a title="lookup_value" href="FlowExpression.html#lookup_value-instance_method">lookup_value</a></span>, <span class='name'><a title="lookup_variable" href="FlowExpression.html#lookup_variable-instance_method">lookup_variable</a></span>, <span class='name'><a title="lookup_variable_stack" href="FlowExpression.html#lookup_variable_stack-instance_method">lookup_variable_stack</a></span>, <span class='name'><a title="lookup_vf_attribute" href="FlowExpression.html#lookup_vf_attribute-instance_method">lookup_vf_attribute</a></span>, <span class='name'><a title="marshal_dump" href="FlowExpression.html#marshal_dump-instance_method">marshal_dump</a></span>, <span class='name'><a title="marshal_load" href="FlowExpression.html#marshal_load-instance_method">marshal_load</a></span>, <span class='name'><a title="new_environment" href="FlowExpression.html#new_environment-instance_method">new_environment</a></span>, <span class='name'><a title="owns_its_environment?" href="FlowExpression.html#owns_its_environment%3F-instance_method">owns_its_environment?</a></span>, <span class='name'><a title="paused?" href="FlowExpression.html#paused%3F-instance_method">paused?</a></span>, <span class='name'><a title="raw_children" href="FlowExpression.html#raw_children-instance_method">raw_children</a></span>, <span class='name'><a title="raw_expression_children" href="FlowExpression.html#raw_expression_children-instance_method">raw_expression_children</a></span>, <span class='name'><a title="remove_child" href="FlowExpression.html#remove_child-instance_method">remove_child</a></span>, <span class='name'><a title="reply_to_parent" href="FlowExpression.html#reply_to_parent-instance_method">reply_to_parent</a></span>, <span class='name'><a title="set_variable" href="FlowExpression.html#set_variable-instance_method">set_variable</a></span>, <span class='name'><a title="store_itself" href="FlowExpression.html#store_itself-instance_method">store_itself</a></span>, <span class='name'><a title="to_s" href="FlowExpression.html#to_s-instance_method">to_s</a></span>, <span class='name'><a title="to_yaml_properties" href="FlowExpression.html#to_yaml_properties-instance_method">to_yaml_properties</a></span>, <span class='name'><a title="trigger_on_cancel" href="FlowExpression.html#trigger_on_cancel-instance_method">trigger_on_cancel</a></span></p>
  </div>
  
  <div>
    <h2>Public Instance Methods Inherited from <a title="OpenWFE::ObjectWithMeta" href="ObjectWithMeta.html">OpenWFE::ObjectWithMeta</a></h2>
    <p><span class='name'><a title="class_def" href="ObjectWithMeta.html#class_def-instance_method">class_def</a></span></p>
  </div>
  
</div>
<div class="clear"></div><div class="included">
  
  <div>
    <h2>Public Instance Methods Included from <a title="OpenWFE::MergeMixin" href="RestoreWorkItemExpression/MergeMixin.html">OpenWFE::MergeMixin</a></h2>
    <p><span class='name'><a title="merge_workitems" href="MergeMixin.html#merge_workitems-instance_method">merge_workitems</a></span></p>
  </div>
  
  <div>
    <h2>Public Instance Methods Included from <a title="OpenWFE::ValueMixin" href="RestoreWorkItemExpression/ValueMixin.html">OpenWFE::ValueMixin</a></h2>
    <p><span class='name'><a title="apply" href="ValueMixin.html#apply-instance_method">apply</a></span>, <span class='name'><a title="lookup_field_attribute" href="ValueMixin.html#lookup_field_attribute-instance_method">lookup_field_attribute</a></span>, <span class='name'><a title="lookup_variable_attribute" href="ValueMixin.html#lookup_variable_attribute-instance_method">lookup_variable_attribute</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>reply</h3>
</div><div id="reply-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reply</span><span class='args'>(workitem)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
so that in can be placed outside of process definition bodies
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/fe_save.rb', line 156</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/fe_save.rb#L156">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reply identifier id'>reply</span> <span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>

  <span class='from_field identifier id'>from_field</span> <span class='assign token'>=</span> <span class='lookup_string_attribute identifier id'>lookup_string_attribute</span> <span class='symbol val'>:from_field</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span>
  <span class='from_variable identifier id'>from_variable</span> <span class='assign token'>=</span> <span class='lookup_string_attribute identifier id'>lookup_string_attribute</span> <span class='symbol val'>:from_variable</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span>

  <span class='merge_lead identifier id'>merge_lead</span> <span class='assign token'>=</span> <span class='lookup_sym_attribute identifier id'>lookup_sym_attribute</span> <span class='symbol val'>:merge_lead</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span>

  <span class='merge_lead identifier id'>merge_lead</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span> \
    <span class='unless unless_mod kw'>unless</span> <span class='lbrack token'>[</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='symbol val'>:current</span><span class='comma token'>,</span> <span class='symbol val'>:restored</span> <span class='rbrack token'>]</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='merge_lead identifier id'>merge_lead</span><span class='rparen token'>)</span>

  <span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='workitem identifier id'>workitem</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='FIELD_RESULT constant id'>FIELD_RESULT</span><span class='rbrack token'>]</span>

  <span class='source identifier id'>source</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='from_field identifier id'>from_field</span>

    <span class='att identifier id'>att</span> <span class='assign token'>=</span> <span class='workitem identifier id'>workitem</span><span class='dot token'>.</span><span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span><span class='from_field identifier id'>from_field</span><span class='rparen token'>)</span>

    <span class='lwarn identifier id'>lwarn</span> <span class='lbrace token'>{</span>
      <span class='dstring node'>&quot;apply() field '#{from_field}' is NOT a hash, &quot;</span> <span class='plus op'>+</span>
      <span class='string val'>&quot;restored anyway&quot;</span>
    <span class='rbrace token'>}</span> <span class='unless unless_mod kw'>unless</span> <span class='att identifier id'>att</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span>

    <span class='att identifier id'>att</span>

  <span class='elsif elsif kw'>elsif</span> <span class='from_variable identifier id'>from_variable</span>

    <span class='lookup_variable identifier id'>lookup_variable</span><span class='lparen token'>(</span><span class='from_variable identifier id'>from_variable</span><span class='rparen token'>)</span>

  <span class='elsif elsif kw'>elsif</span> <span class='value identifier id'>value</span>

    <span class='value identifier id'>value</span>

  <span class='else else kw'>else</span>

    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='source identifier id'>source</span>

    <span class='workitem identifier id'>workitem</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='merge_lead identifier id'>merge_lead</span>
      <span class='do_merge identifier id'>do_merge</span><span class='lparen token'>(</span><span class='merge_lead identifier id'>merge_lead</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='source identifier id'>source</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='do_overwrite identifier id'>do_overwrite</span><span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='source identifier id'>source</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='comment val'># else, don't restore anything</span>

  <span class='reply_to_parent identifier id'>reply_to_parent</span><span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>