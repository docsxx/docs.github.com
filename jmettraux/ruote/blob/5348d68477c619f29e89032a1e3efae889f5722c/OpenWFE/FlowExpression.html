<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>jmettraux's ruote - Class: OpenWFE::FlowExpression - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/jmettraux/commits/ruote/master" rel="alternate" title="Recent Commits to ruote:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("jmettraux", "ruote", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("jmettraux", "ruote", "5348d68477c619f29e89032a1e3efae889f5722c", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/jmettraux/ruote/tree/">Source</a></li>
            <li class=""><a href="http://github.com/jmettraux/ruote/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/jmettraux/ruote/network">Network</a></li>            
            <li class=""><a href="http://github.com/jmettraux/ruote/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/jmettraux/ruote">Wiki</a></li>
            <li class=""><a href="http://github.com/jmettraux/ruote/graphs">Graphs</a></li>                    
            <li class="active"><a href="/jmettraux/ruote">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/jmettraux">jmettraux</a> / <b><a href="http://github.com/jmettraux/ruote/tree">ruote</a></b>        
                <a id="namespaces_button" rel="jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class OpenWFE_FlowExpression">
  <h1>Class: OpenWFE::FlowExpression</h1>
  <div class="section inheritance">
  <ul>
  <li><a title="OpenWFE::ObjectWithMeta" href="ObjectWithMeta.html">OpenWFE::ObjectWithMeta</a></li><ul><li>OpenWFE::FlowExpression</li>
  </ul></ul>
</div><div class="section mixins">
  <h2>Included Modules</h2>
  <p><a title="OpenWFE::Contextual" href="FlowExpression/Contextual.html">OpenWFE::Contextual</a>, <a title="OpenWFE::Logging" href="FlowExpression/Logging.html">OpenWFE::Logging</a>, <a title="OpenWFE::OwfeServiceLocator" href="FlowExpression/OwfeServiceLocator.html">OpenWFE::OwfeServiceLocator</a></p>
</div><div class="section docstring">
  <p>
FlowExpression
</p>
<p>
The base class for all OpenWFE flow expression classes. It gathers all the
methods for attributes and variable lookup.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">apply_time</td>
          <td class="readwrite">
            [<span id='apply_time-instance_method'>R</span><span id='apply_time=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
When the FlowExpression instance is applied, this time stamp is set to the
current date.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">attributes</td>
          <td class="readwrite">
            [<span id='attributes-instance_method'>R</span><span id='attributes=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The attributes of the expression, as found in the process definition.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">children</td>
          <td class="readwrite">
            [<span id='children-instance_method'>R</span><span id='children=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
An array of &#8216;flow expression id&#8217; instances.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">environment_id</td>
          <td class="readwrite">
            [<span id='environment_id-instance_method'>R</span><span id='environment_id=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The &#8216;flow expression id&#8217; of the environment this expression
works with.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">fei</td>
          <td class="readwrite">
            [<span id='fei-instance_method'>R</span><span id='fei=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The &#8216;flow expression id&#8217; the unique identifier within a
workflow instance for this expression instance.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">parent_id</td>
          <td class="readwrite">
            [<span id='parent_id-instance_method'>R</span><span id='parent_id=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The &#8216;flow expression id&#8217; of the parent expression.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">raw_rep_updated</td>
          <td class="readwrite">
            [<span id='raw_rep_updated-instance_method'>R</span><span id='raw_rep_updated=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Meant to contain a boolean value.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">raw_representation</td>
          <td class="readwrite">
            [<span id='raw_representation-instance_method'>R</span><span id='raw_representation=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Used by raw expressions to store the not yet interpreted branches of a
process, used by other expressions to store their representation at
&#8216;eval time&#8217;.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">updated_at</td>
          <td class="readwrite">
            [<span id='updated_at-instance_method'>R</span><span id='updated_at=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
When was this expression last updated ?.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#is_definition-class_method">is_definition</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#is_definition-3F-class_method">is_definition?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if the expression class is a &#8216;definition&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#names-class_method">names</span><span class='args'>(*exp_names)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
a nice &#8216;names&#8217; tag/method for registering the names of the
Expression classes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#new_exp-class_method">new_exp</span><span class='args'>(fei, parent_id, env_id, app_context, attributes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Builds a new instance of an expression.
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Class Methods Inherited from <a title="OpenWFE::ObjectWithMeta" href="ObjectWithMeta.html">OpenWFE::ObjectWithMeta</a></h2>
    <p><span class='name'><a title="meta_def" href="ObjectWithMeta.html#meta_def-class_method">meta_def</a></span>, <span class='name'><a title="meta_eval" href="ObjectWithMeta.html#meta_eval-class_method">meta_eval</a></span>, <span class='name'><a title="metaclass" href="ObjectWithMeta.html#metaclass-class_method">metaclass</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#apply-instance_method">#apply</span><span class='args'>(workitem)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
&#8212; the two most important methods for flow expressions ++.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#apply_child-instance_method">#apply_child</span><span class='args'>(child_index, workitem)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Given a child index (in the raw_children list/array), applies that child.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#cancel-instance_method">#cancel</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A default implementation for cancel : triggers any registered
&#8216;on_cancel&#8217; and then cancels all the children.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#clean_children-instance_method">#clean_children</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Takes care of removing all the children of this expression, if any.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_variable-instance_method">#delete_variable</span><span class='args'>(varname)</span>
        <span class='block'></span>
        
          <span class='alias'>#unset_variable</span>
        
      </th>
      <td class="docstring">
        <p>
Unsets a variable in the current environment.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#descendant_of-3F-instance_method">#descendant_of?</span><span class='args'>(fei)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if the expression with the given fei is an ancestor of this
expression.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#dup_environment-instance_method">#dup_environment</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
This method is called in expressionpool.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#fetch_environment-instance_method">#fetch_environment</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Just fetches the environment for this expression.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#fetch_text_content-instance_method">#fetch_text_content</span><span class='args'>(workitem, escape = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the text stored among the children.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#first_expression_child-instance_method">#first_expression_child</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the index of the first child that is an expression.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_binding-instance_method">#get_binding</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Currently only used by dollar.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_environment-instance_method">#get_environment</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the environment instance this expression uses.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_next_sub_id-instance_method">#get_next_sub_id</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the next sub process id available (this counter is stored in the
process environment under the key :next_sub_id).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_parent-instance_method">#get_parent</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
some convenience methods.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_root_environment-instance_method">#get_root_environment</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A shortcut for fetch_environment.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_attribute-instance_method">#has_attribute</span><span class='args'>(attname)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if the expression has the given attribute.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_no_expression_child-instance_method">#has_no_expression_child</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if the current expression has no expression among its
</p>
<dl>
<dt>raw</dt><dd>children.

</dd>
</dl>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_array_attribute-instance_method">#lookup_array_attribute</span><span class='args'>(attname, workitem, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
looks up an attribute, if it&#8217;s an array, returns it.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_attribute-instance_method">#lookup_attribute</span><span class='args'>(attname, workitem, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Looks up the value for an attribute of this expression.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_attributes-instance_method">#lookup_attributes</span><span class='args'>(workitem, _attributes = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a hash of all the FlowExpression attributes with their values
having undergone dollar variable substitution.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_boolean_attribute-instance_method">#lookup_boolean_attribute</span><span class='args'>(attname, workitem, default = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A convenience method for looking up a boolean value.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_downcase_attribute-instance_method">#lookup_downcase_attribute</span><span class='args'>(attname, workitem, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Like lookup_attribute() but returns the value downcased [ (and stripped).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_ref-instance_method">#lookup_ref</span><span class='args'>(workitem, prefix = '')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
looks up for &#8216;ref&#8217;, &#8216;variable-ref&#8217; and then for
&#8216;field-ref&#8217; if necessary.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_string_attribute-instance_method">#lookup_string_attribute</span><span class='args'>(attname, workitem, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the attribute value as a String (or nil if it&#8217;s not found).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_sym_attribute-instance_method">#lookup_sym_attribute</span><span class='args'>(attname, workitem, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the value of the attribute as a Symbol.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_value-instance_method">#lookup_value</span><span class='args'>(workitem, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
looks up for &#8216;value&#8217;, &#8216;variable-value&#8217; and then for
&#8216;field-value&#8217; if necessary.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_variable-instance_method">#lookup_variable</span><span class='args'>(varname)</span>
        <span class='block'></span>
        
          <span class='alias'>#lv</span>
        
      </th>
      <td class="docstring">
        <p>
Looks up the value of a variable in the current environment.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_variable_stack-instance_method">#lookup_variable_stack</span><span class='args'>(varname)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a stack of variable values, from here down to the engine
environment.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lookup_vf_attribute-instance_method">#lookup_vf_attribute</span><span class='args'>(workitem, att_name, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Looks up for value attributes like &#8216;field-ref&#8217; or
&#8216;variable-value&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#marshal_dump-instance_method">#marshal_dump</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#marshal_load-instance_method">#marshal_load</span><span class='args'>(s)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#new_environment-instance_method">#new_environment</span><span class='args'>(initial_vars = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
creates a new environment just for this expression.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#owns_its_environment-3F-instance_method">#owns_its_environment?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if the expression&#8217;s environment was generated for itself
(usually DefineExpression do have such envs).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#paused-3F-instance_method">#paused?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if this expression belongs to a paused flow.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#raw_children-instance_method">#raw_children</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Since OpenWFEru 0.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#raw_expression_children-instance_method">#raw_expression_children</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a list of children that are expressions (arrays).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_child-instance_method">#remove_child</span><span class='args'>(child_fei)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Removes a child from the expression children list.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reply-instance_method">#reply</span><span class='args'>(workitem)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
this default implementation immediately replies to the parent expression.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reply_to_parent-instance_method">#reply_to_parent</span><span class='args'>(workitem)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Triggers the reply to the parent expression (of course, via the expression
pool).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#set_variable-instance_method">#set_variable</span><span class='args'>(varname, value)</span>
        <span class='block'></span>
        
          <span class='alias'>#sv</span>
        
      </th>
      <td class="docstring">
        <p>
Sets a variable in the current environment.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#store_itself-instance_method">#store_itself</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Stores itself in the expression pool.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_s-instance_method">#to_s</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Some eye candy.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_yaml_properties-instance_method">#to_yaml_properties</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#trigger_on_cancel-instance_method">#trigger_on_cancel</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
triggers the on_cancel attribute of the expression, if any, and forgets it.
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Instance Methods Inherited from <a title="OpenWFE::ObjectWithMeta" href="ObjectWithMeta.html">OpenWFE::ObjectWithMeta</a></h2>
    <p><span class='name'><a title="class_def" href="ObjectWithMeta.html#class_def-instance_method">class_def</a></span></p>
  </div>
  
</div>
<div class="clear"></div><div class="included">
  
  <div>
    <h2>Public Instance Methods Included from <a title="OpenWFE::Contextual" href="FlowExpression/Contextual.html">OpenWFE::Contextual</a></h2>
    <p><span class='name'><a title="get_work_directory" href="Contextual.html#get_work_directory-instance_method">get_work_directory</a></span>, <span class='name'><a title="init_service" href="Contextual.html#init_service-instance_method">init_service</a></span>, <span class='name'><a title="lookup" href="Contextual.html#lookup-instance_method">lookup</a></span></p>
  </div>
  
  <div>
    <h2>Public Instance Methods Included from <a title="OpenWFE::Logging" href="FlowExpression/Logging.html">OpenWFE::Logging</a></h2>
    <p><span class='name'><a title="ldebug" href="Logging.html#ldebug-instance_method">ldebug</a></span>, <span class='name'><a title="ldebug_callstack" href="Logging.html#ldebug_callstack-instance_method">ldebug_callstack</a></span>, <span class='name'><a title="lerror" href="Logging.html#lerror-instance_method">lerror</a></span>, <span class='name'><a title="lfatal" href="Logging.html#lfatal-instance_method">lfatal</a></span>, <span class='name'><a title="linfo" href="Logging.html#linfo-instance_method">linfo</a></span>, <span class='name'><a title="llog" href="Logging.html#llog-instance_method">llog</a></span>, <span class='name'><a title="lunknown" href="Logging.html#lunknown-instance_method">lunknown</a></span>, <span class='name'><a title="lwarn" href="Logging.html#lwarn-instance_method">lwarn</a></span></p>
  </div>
  
  <div>
    <h2>Public Instance Methods Included from <a title="OpenWFE::OwfeServiceLocator" href="FlowExpression/OwfeServiceLocator.html">OpenWFE::OwfeServiceLocator</a></h2>
    <p><span class='name'><a title="get_def_parser" href="OwfeServiceLocator.html#get_def_parser-instance_method">get_def_parser</a></span>, <span class='name'><a title="get_engine" href="OwfeServiceLocator.html#get_engine-instance_method">get_engine</a></span>, <span class='name'><a title="get_error_journal" href="OwfeServiceLocator.html#get_error_journal-instance_method">get_error_journal</a></span>, <span class='name'><a title="get_expool" href="OwfeServiceLocator.html#get_expool-instance_method">get_expool</a></span>, <span class='name'><a title="get_expression_map" href="OwfeServiceLocator.html#get_expression_map-instance_method">get_expression_map</a></span>, <span class='name'><a title="get_expression_pool" href="OwfeServiceLocator.html#get_expression_pool-instance_method">get_expression_pool</a></span>, <span class='name'><a title="get_expression_storage" href="OwfeServiceLocator.html#get_expression_storage-instance_method">get_expression_storage</a></span>, <span class='name'><a title="get_expression_storages" href="OwfeServiceLocator.html#get_expression_storages-instance_method">get_expression_storages</a></span>, <span class='name'><a title="get_journal" href="OwfeServiceLocator.html#get_journal-instance_method">get_journal</a></span>, <span class='name'><a title="get_participant_map" href="OwfeServiceLocator.html#get_participant_map-instance_method">get_participant_map</a></span>, <span class='name'><a title="get_scheduler" href="OwfeServiceLocator.html#get_scheduler-instance_method">get_scheduler</a></span>, <span class='name'><a title="get_tree_checker" href="OwfeServiceLocator.html#get_tree_checker-instance_method">get_tree_checker</a></span>, <span class='name'><a title="get_wfid_generator" href="OwfeServiceLocator.html#get_wfid_generator-instance_method">get_wfid_generator</a></span>, <span class='name'><a title="get_workqueue" href="OwfeServiceLocator.html#get_workqueue-instance_method">get_workqueue</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>is_definition</h3>
</div><div id="is_definition-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>is_definition</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 783</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L783">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">783
784
785
786
787</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='is_definition identifier id'>is_definition</span>
  <span class='meta_def identifier id'>meta_def</span> <span class='symbol val'>:is_definition?</span> <span class='do do kw'>do</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>is_definition?</h3>
</div><div id="is_definition-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>is_definition?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if the expression class is a &#8216;definition&#8217;.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 780</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L780">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">780
781
782</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='is_definition? fid id'>is_definition?</span>
  <span class='false false kw'>false</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>names</h3>
</div><div id="names-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>names</span><span class='args'>(*exp_names)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
a nice &#8216;names&#8217; tag/method for registering the names of the
Expression classes.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 767</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L767">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">767
768
769
770
771
772
773
774
775</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='names identifier id'>names</span> <span class='lparen token'>(</span><span class='mult op'>*</span><span class='exp_names identifier id'>exp_names</span><span class='rparen token'>)</span>

  <span class='exp_names identifier id'>exp_names</span> <span class='assign token'>=</span> <span class='exp_names identifier id'>exp_names</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='n identifier id'>n</span><span class='bitor op'>|</span>
    <span class='n identifier id'>n</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='end end kw'>end</span>
  <span class='meta_def identifier id'>meta_def</span> <span class='symbol val'>:expression_names</span> <span class='do do kw'>do</span>
    <span class='exp_names identifier id'>exp_names</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>new_exp</h3>
</div><div id="new_exp-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>new_exp</span><span class='args'>(fei, parent_id, env_id, app_context, attributes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Builds a new instance of an expression
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 129</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L129">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">129
130
131
132
133
134
135
136
137
138
139
140
141
142
143</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='new_exp identifier id'>new_exp</span> <span class='lparen token'>(</span><span class='fei identifier id'>fei</span><span class='comma token'>,</span> <span class='parent_id identifier id'>parent_id</span><span class='comma token'>,</span> <span class='env_id identifier id'>env_id</span><span class='comma token'>,</span> <span class='app_context identifier id'>app_context</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>

  <span class='e identifier id'>e</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='fei identifier id'>fei</span> <span class='assign token'>=</span> <span class='fei identifier id'>fei</span>
  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='parent_id identifier id'>parent_id</span> <span class='assign token'>=</span> <span class='parent_id identifier id'>parent_id</span>
  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='environment_id identifier id'>environment_id</span> <span class='assign token'>=</span> <span class='env_id identifier id'>env_id</span>
  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='application_context identifier id'>application_context</span> <span class='assign token'>=</span> <span class='app_context identifier id'>app_context</span>
  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='attributes identifier id'>attributes</span>

  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='children identifier id'>children</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='apply_time identifier id'>apply_time</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

  <span class='e identifier id'>e</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>apply</h3>
</div><div id="apply-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>apply</span><span class='args'>(workitem)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
&#8212; the two most important methods for flow expressions ++
</p>
<p>
this default implementation immediately replies to the parent expression
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 153</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L153">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">153
154
155
156</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='apply identifier id'>apply</span> <span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>

  <span class='get_parent identifier id'>get_parent</span><span class='dot token'>.</span><span class='reply identifier id'>reply</span><span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='@parent_id ivar id'>@parent_id</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>apply_child</h3>
</div><div id="apply_child-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>apply_child</span><span class='args'>(child_index, workitem)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Given a child index (in the raw_children list/array), applies that child.
</p>
<p>
Does the bulk work of preparing the children and applying it (also cares
about registering the child in the @children array).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 724</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L724">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">724
725
726
727
728
729
730
731
732
733
734</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='apply_child identifier id'>apply_child</span> <span class='lparen token'>(</span><span class='child_index identifier id'>child_index</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>

  <span class='child_index identifier id'>child_index</span><span class='comma token'>,</span> <span class='child identifier id'>child</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='child_index identifier id'>child_index</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Integer constant id'>Integer</span><span class='rparen token'>)</span>
    <span class='lbrack token'>[</span> <span class='child_index identifier id'>child_index</span><span class='comma token'>,</span> <span class='raw_children identifier id'>raw_children</span><span class='lbrack token'>[</span><span class='child_index identifier id'>child_index</span><span class='rbrack token'>]</span> <span class='rbrack token'>]</span>
  <span class='else else kw'>else</span>
    <span class='lbrack token'>[</span> <span class='raw_children identifier id'>raw_children</span><span class='dot token'>.</span><span class='index identifier id'>index</span><span class='lparen token'>(</span><span class='child_index identifier id'>child_index</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='child_index identifier id'>child_index</span> <span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>

  <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='tlaunch_child identifier id'>tlaunch_child</span><span class='lparen token'>(</span>
    <span class='self self kw'>self</span><span class='comma token'>,</span> <span class='child identifier id'>child</span><span class='comma token'>,</span> <span class='child_index identifier id'>child_index</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='symbol val'>:register_child</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>cancel</h3>
</div><div id="cancel-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>cancel</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A default implementation for cancel : triggers any registered
&#8216;on_cancel&#8217; and then cancels all the children
</p>
<p>
Attempts to return an InFlowWorkItem
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 184</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L184">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">184
185
186
187
188
189
190
191
192
193
194</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='cancel identifier id'>cancel</span>

  <span class='trigger_on_cancel identifier id'>trigger_on_cancel</span>

  <span class='lparen token'>(</span><span class='@children ivar id'>@children</span> <span class='orop op'>||</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='child identifier id'>child</span><span class='bitor op'>|</span>

    <span class='comment val'>#wi = child.is_a?(String) ? nil : get_expression_pool.cancel(child)</span>
    <span class='wi identifier id'>wi</span> <span class='assign token'>=</span> <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='cancel identifier id'>cancel</span><span class='lparen token'>(</span><span class='child identifier id'>child</span><span class='rparen token'>)</span>
    <span class='workitem identifier id'>workitem</span> <span class='opasgn op'>||=</span> <span class='wi identifier id'>wi</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>clean_children</h3>
</div><div id="clean_children-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>clean_children</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Takes care of removing all the children of this expression, if any.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 554</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L554">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">554
555
556
557
558
559
560
561
562</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='clean_children identifier id'>clean_children</span>

  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='@children ivar id'>@children</span>

  <span class='@children ivar id'>@children</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='child_fei identifier id'>child_fei</span><span class='bitor op'>|</span>
    <span class='comment val'>#next unless child.is_a?(FlowExpressionId)</span>
    <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='child_fei identifier id'>child_fei</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_variable</h3>
</div><div id="delete_variable-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_variable</span><span class='args'>(varname)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="unset_variable-instance_method">unset_variable</tt>
  
</p>
</div><div class="section docstring">
  <p>
Unsets a variable in the current environment.
</p>
<p>
The variable name may be prefixed by / to indicate process level scope or
by // to indicate engine level (global) scope.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 347</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L347">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">347
348
349
350
351</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_variable identifier id'>delete_variable</span> <span class='lparen token'>(</span><span class='varname identifier id'>varname</span><span class='rparen token'>)</span>

  <span class='env identifier id'>env</span><span class='comma token'>,</span> <span class='var identifier id'>var</span> <span class='assign token'>=</span> <span class='lookup_environment identifier id'>lookup_environment</span><span class='lparen token'>(</span><span class='varname identifier id'>varname</span><span class='rparen token'>)</span>
  <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='var identifier id'>var</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>descendant_of?</h3>
</div><div id="descendant_of-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>descendant_of?</span><span class='args'>(fei)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if the expression with the given fei is an ancestor of this
expression.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 793</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L793">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">793
794
795
796
797
798
799
800
801
802</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='descendant_of? fid id'>descendant_of?</span> <span class='lparen token'>(</span><span class='fei identifier id'>fei</span><span class='rparen token'>)</span>

  <span class='comment val'>#p [ :d_of?, &quot;#{@fei.wfid} #{@fei.expid}&quot;, &quot;#{fei.wfid} #{fei.expid}&quot; ]</span>

  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='@parent_id ivar id'>@parent_id</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>
  <span class='return return kw'>return</span> <span class='true true kw'>true</span> <span class='if if_mod kw'>if</span> <span class='@parent_id ivar id'>@parent_id</span> <span class='eq op'>==</span> <span class='fei identifier id'>fei</span>
  <span class='return return kw'>return</span> <span class='true true kw'>true</span> <span class='if if_mod kw'>if</span> <span class='fei identifier id'>fei</span><span class='dot token'>.</span><span class='ancestor_of? fid id'>ancestor_of?</span><span class='lparen token'>(</span><span class='@fei ivar id'>@fei</span><span class='rparen token'>)</span> <span class='comment val'># shortcut</span>

  <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='fetch_expression identifier id'>fetch_expression</span><span class='lparen token'>(</span><span class='@parent_id ivar id'>@parent_id</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='descendant_of? fid id'>descendant_of?</span><span class='lparen token'>(</span><span class='fei identifier id'>fei</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>dup_environment</h3>
</div><div id="dup_environment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>dup_environment</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
This method is called in expressionpool.forget(). It duplicates the
expression&#8217;s current environment (deep copy) and attaches it as the
expression own environment. Returns the duplicated environment.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 540</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L540">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">540
541
542
543
544
545
546
547
548
549</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='dup_environment identifier id'>dup_environment</span>

  <span class='env identifier id'>env</span> <span class='assign token'>=</span> <span class='fetch_environment identifier id'>fetch_environment</span>
  <span class='env identifier id'>env</span> <span class='assign token'>=</span> <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='fei identifier id'>fei</span> <span class='assign token'>=</span> <span class='@fei ivar id'>@fei</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='fei identifier id'>fei</span><span class='dot token'>.</span><span class='expression_name identifier id'>expression_name</span> <span class='assign token'>=</span> <span class='EN_ENVIRONMENT constant id'>EN_ENVIRONMENT</span>
  <span class='@environment_id ivar id'>@environment_id</span> <span class='assign token'>=</span> <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='fei identifier id'>fei</span>

  <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='store_itself identifier id'>store_itself</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>fetch_environment</h3>
</div><div id="fetch_environment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>fetch_environment</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Just fetches the environment for this expression.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 267</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L267">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">267
268
269
270</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='fetch_environment identifier id'>fetch_environment</span>

  <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='fetch_expression identifier id'>fetch_expression</span><span class='lparen token'>(</span><span class='@environment_id ivar id'>@environment_id</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>fetch_text_content</h3>
</div><div id="fetch_text_content-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>fetch_text_content</span><span class='args'>(workitem, escape = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the text stored among the children
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 592</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L592">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">592
593
594
595
596
597
598
599
600
601
602</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='fetch_text_content identifier id'>fetch_text_content</span> <span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='escape identifier id'>escape</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='rparen token'>)</span>

  <span class='text identifier id'>text</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='children identifier id'>children</span> <span class='orop op'>||</span> <span class='raw_children identifier id'>raw_children</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='comma token'>,</span> <span class='child identifier id'>child</span><span class='bitor op'>|</span>

    <span class='r identifier id'>r</span> <span class='lshft op'>&lt;&lt;</span> <span class='child identifier id'>child</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='end end kw'>end</span>

  <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span> <span class='if if_mod kw'>if</span> <span class='text identifier id'>text</span> <span class='eq op'>==</span> <span class='string val'>''</span>

  <span class='escape identifier id'>escape</span> <span class='integer val'>? </span><span class='text identifier id'>text</span> <span class='colon op'>:</span> <span class='OpenWFE constant id'>OpenWFE</span><span class='colon2 op'>::</span><span class='dosub identifier id'>dosub</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>first_expression_child</h3>
</div><div id="first_expression_child-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>first_expression_child</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the index of the first child that is an expression.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 689</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L689">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">689
690
691
692</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='first_expression_child identifier id'>first_expression_child</span>

  <span class='@raw_representation ivar id'>@raw_representation</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='find identifier id'>find</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='c identifier id'>c</span><span class='bitor op'>|</span> <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_binding</h3>
</div><div id="get_binding-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_binding</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Currently only used by dollar.rb and its ${r:some_ruby_code}, returns the
binding in this flow expression.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 584</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L584">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">584
585
586
587</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_binding identifier id'>get_binding</span>

  <span class='binding identifier id'>binding</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_environment</h3>
</div><div id="get_environment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_environment</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the environment instance this expression uses. An environment is a
container (a scope) for variables in the process definition. Environments
themselves are FlowExpression instances.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 248</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L248">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">248
249
250
251</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_environment identifier id'>get_environment</span>

  <span class='fetch_environment identifier id'>fetch_environment</span> <span class='orop op'>||</span> <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='fetch_engine_environment identifier id'>fetch_engine_environment</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_next_sub_id</h3>
</div><div id="get_next_sub_id-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_next_sub_id</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the next sub process id available (this counter is stored in the
process environment under the key :next_sub_id)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 698</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L698">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_next_sub_id identifier id'>get_next_sub_id</span>

  <span class='env identifier id'>env</span> <span class='assign token'>=</span> <span class='get_root_environment identifier id'>get_root_environment</span>

  <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

  <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='variables identifier id'>variables</span><span class='lbrack token'>[</span><span class='symbol val'>:next_sub_id</span><span class='rbrack token'>]</span>
  <span class='n identifier id'>n</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='c identifier id'>c</span>
    <span class='c identifier id'>c</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
  <span class='else else kw'>else</span>
    <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='integer val'>1</span>
  <span class='end end kw'>end</span>
  <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='variables identifier id'>variables</span><span class='lbrack token'>[</span><span class='symbol val'>:next_sub_id</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='n identifier id'>n</span>
  <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='store_itself identifier id'>store_itself</span>

  <span class='c identifier id'>c</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_parent</h3>
</div><div id="get_parent-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_parent</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
some convenience methods
</p>
<p>
Returns the parent expression (not as a FlowExpressionId but directly as
the FlowExpression instance it is).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 222</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L222">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">222
223
224
225</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_parent identifier id'>get_parent</span>

  <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='fetch_expression identifier id'>fetch_expression</span><span class='lparen token'>(</span><span class='@parent_id ivar id'>@parent_id</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_root_environment</h3>
</div><div id="get_root_environment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_root_environment</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A shortcut for fetch_environment.get_root_environment
</p>
<p>
Returns the environment of the top process (the environement just before
the engine environment in the hierarchy).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 259</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L259">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">259
260
261
262</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_root_environment identifier id'>get_root_environment</span>

  <span class='fetch_environment identifier id'>fetch_environment</span><span class='dot token'>.</span><span class='get_root_environment identifier id'>get_root_environment</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_attribute</h3>
</div><div id="has_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_attribute</span><span class='args'>(attname)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if the expression has the given attribute. The attname
parameter can be a String or a Symbol.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 471</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L471">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">471
472
473
474
475
476</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='has_attribute identifier id'>has_attribute</span> <span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='rparen token'>)</span>

  <span class='attname identifier id'>attname</span> <span class='assign token'>=</span> <span class='OpenWFE constant id'>OpenWFE</span><span class='colon2 op'>::</span><span class='symbol_to_name identifier id'>symbol_to_name</span><span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='attname identifier id'>attname</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Symbol constant id'>Symbol</span><span class='rparen token'>)</span>

  <span class='lparen token'>(</span><span class='@attributes ivar id'>@attributes</span><span class='lbrack token'>[</span><span class='attname identifier id'>attname</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_no_expression_child</h3>
</div><div id="has_no_expression_child-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_no_expression_child</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if the current expression has no expression among its
</p>
<dl>
<dt>raw</dt><dd>children.

</dd>
</dl>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 681</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L681">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">681
682
683
684</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='has_no_expression_child identifier id'>has_no_expression_child</span>

  <span class='lparen token'>(</span><span class='first_expression_child identifier id'>first_expression_child</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_array_attribute</h3>
</div><div id="lookup_array_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_array_attribute</span><span class='args'>(attname, workitem, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
looks up an attribute, if it&#8217;s an array, returns it. Else (probably a
string) will split it (comma) and return it (each element trimmed).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 450</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L450">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_array_attribute identifier id'>lookup_array_attribute</span> <span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='tostring identifier id'>tostring</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:to_s</span><span class='rparen token'>)</span>

  <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>

  <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span> <span class='unless unless_mod kw'>unless</span> <span class='v identifier id'>v</span>

  <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span> <span class='rbrace token'>}</span> \
    <span class='unless unless_mod kw'>unless</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>

  <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='rbrace token'>}</span> \
    <span class='if if_mod kw'>if</span> <span class='tostring identifier id'>tostring</span>

  <span class='v identifier id'>v</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_attribute</h3>
</div><div id="lookup_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_attribute</span><span class='args'>(attname, workitem, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Looks up the value for an attribute of this expression.
</p>
<p>
if the expression is
</p>
<pre class="code">
  <span class='lt op'>&lt;</span><span class='participant identifier id'>participant</span> <span class='ref identifier id'>ref</span><span class='assign token'>=</span><span class='string val'>&quot;toto&quot;</span> <span class='div op'>/</span><span class='gt op'>&gt;</span>
</pre>
<p>
then
</p>
<pre class="code">
  <span class='participant_expression identifier id'>participant_expression</span><span class='dot token'>.</span><span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span><span class='string val'>&quot;toto&quot;</span><span class='comma token'>,</span> <span class='wi identifier id'>wi</span><span class='rparen token'>)</span>
</pre>
<p>
will yield &quot;toto&quot;
</p>
<p>
The various methods for looking up attributes do perform dollar variable
substitution. It&#8217;s ok to pass a Symbol for the attribute name.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 372</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L372">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_attribute identifier id'>lookup_attribute</span> <span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='default identifier id'>default</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:default</span><span class='rbrack token'>]</span>
  <span class='escape identifier id'>escape</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:escape</span><span class='rbrack token'>]</span>
  <span class='tostring identifier id'>tostring</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:to_s</span><span class='rbrack token'>]</span>

  <span class='attname identifier id'>attname</span> <span class='assign token'>=</span> <span class='OpenWFE constant id'>OpenWFE</span><span class='dot token'>.</span><span class='symbol_to_name identifier id'>symbol_to_name</span><span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='attname identifier id'>attname</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Symbol constant id'>Symbol</span><span class='rparen token'>)</span>

  <span class='text identifier id'>text</span> <span class='assign token'>=</span> <span class='@attributes ivar id'>@attributes</span><span class='lbrack token'>[</span><span class='attname identifier id'>attname</span><span class='rbrack token'>]</span>

  <span class='text identifier id'>text</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='text identifier id'>text</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>

    <span class='default identifier id'>default</span>

  <span class='elsif elsif kw'>elsif</span> <span class='escape identifier id'>escape</span> <span class='eq op'>==</span> <span class='true true kw'>true</span>

    <span class='text identifier id'>text</span>

  <span class='else else kw'>else</span>

    <span class='OpenWFE constant id'>OpenWFE</span><span class='dot token'>.</span><span class='dosub identifier id'>dosub</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='text identifier id'>text</span> <span class='assign token'>=</span> <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='if if_mod kw'>if</span> <span class='text identifier id'>text</span> <span class='and and kw'>and</span> <span class='tostring identifier id'>tostring</span>

  <span class='text identifier id'>text</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_attributes</h3>
</div><div id="lookup_attributes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_attributes</span><span class='args'>(workitem, _attributes = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a hash of all the FlowExpression attributes with their values
having undergone dollar variable substitution. If the _attributes parameter
is set (to an Array instance) then only the attributes named in that list
will be looked up.
</p>
<p>
It&#8217;s ok to pass an array of Symbol instances for the attributes
parameter.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 487</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L487">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">487
488
489
490
491
492
493
494
495
496
497
498
499
500</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_attributes identifier id'>lookup_attributes</span> <span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='_attributes identifier id'>_attributes</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>

  <span class='return return kw'>return</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='unless unless_mod kw'>unless</span> <span class='@attributes ivar id'>@attributes</span>

  <span class='lparen token'>(</span><span class='_attributes identifier id'>_attributes</span> <span class='orop op'>||</span> <span class='@attributes ivar id'>@attributes</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='comma token'>,</span> <span class='k identifier id'>k</span><span class='bitor op'>|</span>

    <span class='k identifier id'>k</span> <span class='assign token'>=</span> <span class='k identifier id'>k</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
    <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='@attributes ivar id'>@attributes</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span>

    <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='OpenWFE constant id'>OpenWFE</span><span class='colon2 op'>::</span><span class='dosub identifier id'>dosub</span> <span class='v identifier id'>v</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span>

    <span class='r identifier id'>r</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_boolean_attribute</h3>
</div><div id="lookup_boolean_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_boolean_attribute</span><span class='args'>(attname, workitem, default = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A convenience method for looking up a boolean value. It&#8217;s ok to pass
a Symbol for the attribute name.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 437</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L437">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">437
438
439
440
441
442
443</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_boolean_attribute identifier id'>lookup_boolean_attribute</span> <span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='default identifier id'>default</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='rparen token'>)</span>

  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='lookup_downcase_attribute identifier id'>lookup_downcase_attribute</span><span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='default identifier id'>default</span> <span class='if if_mod kw'>if</span> <span class='result identifier id'>result</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>

  <span class='lparen token'>(</span><span class='result identifier id'>result</span> <span class='eq op'>==</span> <span class='string val'>'true'</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_downcase_attribute</h3>
</div><div id="lookup_downcase_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_downcase_attribute</span><span class='args'>(attname, workitem, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Like lookup_attribute() but returns the value downcased [ (and stripped).
Returns nil if no such attribute was found.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 415</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L415">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">415
416
417
418
419
420</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_downcase_attribute identifier id'>lookup_downcase_attribute</span> <span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='lookup_string_attribute identifier id'>lookup_string_attribute</span><span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span> <span class='if if_mod kw'>if</span> <span class='result identifier id'>result</span>
  <span class='result identifier id'>result</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_ref</h3>
</div><div id="lookup_ref-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_ref</span><span class='args'>(workitem, prefix = '')</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
looks up for &#8216;ref&#8217;, &#8216;variable-ref&#8217; and then for
&#8216;field-ref&#8217; if necessary.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 618</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L618">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">618
619
620
621
622</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_ref identifier id'>lookup_ref</span> <span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='prefix identifier id'>prefix</span><span class='assign token'>=</span><span class='string val'>''</span><span class='rparen token'>)</span>

  <span class='ref identifier id'>ref</span> <span class='assign token'>=</span> <span class='lookup_vf_attribute identifier id'>lookup_vf_attribute</span><span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='string val'>'ref'</span><span class='comma token'>,</span> <span class='symbol val'>:prefix</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='prefix identifier id'>prefix</span><span class='rparen token'>)</span>
  <span class='ref identifier id'>ref</span> <span class='integer val'>? </span><span class='ref identifier id'>ref</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_string_attribute</h3>
</div><div id="lookup_string_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_string_attribute</span><span class='args'>(attname, workitem, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the attribute value as a String (or nil if it&#8217;s not found).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 403</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L403">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">403
404
405
406
407
408</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_string_attribute identifier id'>lookup_string_attribute</span> <span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='if if_mod kw'>if</span> <span class='result identifier id'>result</span>
  <span class='result identifier id'>result</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_sym_attribute</h3>
</div><div id="lookup_sym_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_sym_attribute</span><span class='args'>(attname, workitem, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the value of the attribute as a Symbol. Returns nil if there is no
attribute under the given name.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 426</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L426">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">426
427
428
429
430
431</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_sym_attribute identifier id'>lookup_sym_attribute</span> <span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='lookup_downcase_attribute identifier id'>lookup_downcase_attribute</span><span class='lparen token'>(</span><span class='attname identifier id'>attname</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span> <span class='if if_mod kw'>if</span> <span class='result identifier id'>result</span>
  <span class='result identifier id'>result</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_value</h3>
</div><div id="lookup_value-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_value</span><span class='args'>(workitem, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
looks up for &#8216;value&#8217;, &#8216;variable-value&#8217; and then for
&#8216;field-value&#8217; if necessary.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 608</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L608">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">608
609
610
611
612</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_value identifier id'>lookup_value</span> <span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='lookup_vf_attribute identifier id'>lookup_vf_attribute</span><span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='string val'>'value'</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
  <span class='lookup_vf_attribute identifier id'>lookup_vf_attribute</span><span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='string val'>'val'</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_variable</h3>
</div><div id="lookup_variable-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_variable</span><span class='args'>(varname)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="lv-instance_method">lv</tt>
  
</p>
</div><div class="section docstring">
  <p>
Looks up the value of a variable in the current environment. If not found
locally will lookup at the process level and even further in the engine
scope.
</p>
<p>
The variable name may be prefixed by / to indicate process level scope or
by // to indicate engine level (global) scope.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 320</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L320">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">320
321
322
323
324</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_variable identifier id'>lookup_variable</span> <span class='lparen token'>(</span><span class='varname identifier id'>varname</span><span class='rparen token'>)</span>

  <span class='env identifier id'>env</span><span class='comma token'>,</span> <span class='var identifier id'>var</span> <span class='assign token'>=</span> <span class='lookup_environment identifier id'>lookup_environment</span><span class='lparen token'>(</span><span class='varname identifier id'>varname</span><span class='rparen token'>)</span>
  <span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='var identifier id'>var</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_variable_stack</h3>
</div><div id="lookup_variable_stack-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_variable_stack</span><span class='args'>(varname)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a stack of variable values, from here down to the engine
environment.
</p>
<p>
A stack is simply an array whose first value is the local value and the
last value, the value registered in the engine env (if any is registered
there).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 336</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L336">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">336
337
338
339</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_variable_stack identifier id'>lookup_variable_stack</span> <span class='lparen token'>(</span><span class='varname identifier id'>varname</span><span class='rparen token'>)</span>

  <span class='get_environment identifier id'>get_environment</span><span class='dot token'>.</span><span class='lookup_variable_stack identifier id'>lookup_variable_stack</span><span class='lparen token'>(</span><span class='varname identifier id'>varname</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lookup_vf_attribute</h3>
</div><div id="lookup_vf_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lookup_vf_attribute</span><span class='args'>(workitem, att_name, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Looks up for value attributes like &#8216;field-ref&#8217; or
&#8216;variable-value&#8217;
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 627</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L627">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lookup_vf_attribute identifier id'>lookup_vf_attribute</span> <span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='att_name identifier id'>att_name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='att_name identifier id'>att_name</span> <span class='assign token'>=</span> <span class='att_name identifier id'>att_name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>

  <span class='prefix identifier id'>prefix</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:prefix</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='string val'>''</span>
  <span class='prefix identifier id'>prefix</span> <span class='assign token'>=</span> <span class='prefix identifier id'>prefix</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>

  <span class='dash identifier id'>dash</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='att_name identifier id'>att_name</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span> <span class='and and kw'>and</span> <span class='prefix identifier id'>prefix</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='string val'>'-'</span> <span class='colon op'>:</span> <span class='string val'>''</span>

  <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{prefix}#{dash}#{att_name}&quot;</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>

  <span class='att_name identifier id'>att_name</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;-#{att_name}&quot;</span> <span class='if if_mod kw'>if</span> <span class='att_name identifier id'>att_name</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
  <span class='prefix identifier id'>prefix</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{prefix}-&quot;</span> <span class='if if_mod kw'>if</span> <span class='prefix identifier id'>prefix</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>

  <span class='return return kw'>return</span> <span class='v identifier id'>v</span> <span class='if if_mod kw'>if</span> <span class='v identifier id'>v</span>

  <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span>
    <span class='dstring node'>&quot;#{prefix}variable#{att_name}&quot;</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
    <span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span>
    <span class='dstring node'>&quot;#{prefix}var#{att_name}&quot;</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
    <span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span>
    <span class='dstring node'>&quot;#{prefix}v#{att_name}&quot;</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>

  <span class='return return kw'>return</span> <span class='lookup_variable identifier id'>lookup_variable</span><span class='lparen token'>(</span><span class='v identifier id'>v</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='v identifier id'>v</span>

  <span class='f identifier id'>f</span> <span class='assign token'>=</span> <span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span>
    <span class='dstring node'>&quot;#{prefix}field#{att_name}&quot;</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
    <span class='lookup_attribute identifier id'>lookup_attribute</span><span class='lparen token'>(</span>
    <span class='dstring node'>&quot;#{prefix}f#{att_name}&quot;</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>

  <span class='f identifier id'>f</span> <span class='integer val'>? </span><span class='workitem identifier id'>workitem</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='f identifier id'>f</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>marshal_dump</h3>
</div><div id="marshal_dump-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>marshal_dump</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 804</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L804">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">804
805
806
807
808</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='marshal_dump identifier id'>marshal_dump</span> 
  <span class='iv identifier id'>iv</span> <span class='assign token'>=</span> <span class='instance_variables identifier id'>instance_variables</span>
  <span class='iv identifier id'>iv</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>'@application_context'</span><span class='rparen token'>)</span>
  <span class='iv identifier id'>iv</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='h identifier id'>h</span><span class='comma token'>,</span> <span class='vn identifier id'>vn</span><span class='bitor op'>|</span> <span class='h identifier id'>h</span><span class='lbrack token'>[</span><span class='vn identifier id'>vn</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='instance_variable_get identifier id'>instance_variable_get</span><span class='lparen token'>(</span><span class='vn identifier id'>vn</span><span class='rparen token'>)</span><span class='semicolon token'>;</span> <span class='h identifier id'>h</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>marshal_load</h3>
</div><div id="marshal_load-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>marshal_load</span><span class='args'>(s)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 810</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L810">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">810
811
812</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='marshal_load identifier id'>marshal_load</span> <span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc#</span>
  <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='instance_variable_set identifier id'>instance_variable_set</span><span class='lparen token'>(</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>new_environment</h3>
</div><div id="new_environment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>new_environment</span><span class='args'>(initial_vars = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
creates a new environment just for this expression
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 505</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L505">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='new_environment identifier id'>new_environment</span> <span class='lparen token'>(</span><span class='initial_vars identifier id'>initial_vars</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>

  <span class='@environment_id ivar id'>@environment_id</span> <span class='assign token'>=</span> <span class='@fei ivar id'>@fei</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='@environment_id ivar id'>@environment_id</span><span class='dot token'>.</span><span class='expression_name identifier id'>expression_name</span> <span class='assign token'>=</span> <span class='EN_ENVIRONMENT constant id'>EN_ENVIRONMENT</span>

  <span class='parent_fei identifier id'>parent_fei</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='parent identifier id'>parent</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

  <span class='parent identifier id'>parent</span><span class='comma token'>,</span> <span class='_fei identifier id'>_fei</span> <span class='assign token'>=</span> <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='fetch identifier id'>fetch</span><span class='lparen token'>(</span><span class='@parent_id ivar id'>@parent_id</span><span class='rparen token'>)</span> \
    <span class='if if_mod kw'>if</span> <span class='@parent_id ivar id'>@parent_id</span>

  <span class='parent_fei identifier id'>parent_fei</span> <span class='assign token'>=</span> <span class='parent identifier id'>parent</span><span class='dot token'>.</span><span class='environment_id identifier id'>environment_id</span> <span class='if if_mod kw'>if</span> <span class='parent identifier id'>parent</span>

  <span class='env identifier id'>env</span> <span class='assign token'>=</span> <span class='Environment constant id'>Environment</span><span class='dot token'>.</span><span class='new_env identifier id'>new_env</span><span class='lparen token'>(</span>
    <span class='@environment_id ivar id'>@environment_id</span><span class='comma token'>,</span> <span class='parent_fei identifier id'>parent_fei</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='@application_context ivar id'>@application_context</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>

  <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='variables identifier id'>variables</span><span class='dot token'>.</span><span class='merge! fid id'>merge!</span><span class='lparen token'>(</span><span class='initial_vars identifier id'>initial_vars</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='initial_vars identifier id'>initial_vars</span>

  <span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='@fei ivar id'>@fei</span><span class='dot token'>.</span><span class='wfname identifier id'>wfname</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='raw_representation identifier id'>raw_representation</span> \
    <span class='if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='not not kw'>not</span> <span class='@parent_id ivar id'>@parent_id</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='RawExpression constant id'>RawExpression</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='comment val'>#</span>
      <span class='comment val'># keeping track of the raw representation</span>
      <span class='comment val'># of the top expression (for top recursion)</span>

  <span class='env identifier id'>env</span><span class='dot token'>.</span><span class='store_itself identifier id'>store_itself</span>

  <span class='env identifier id'>env</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>owns_its_environment?</h3>
</div><div id="owns_its_environment-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>owns_its_environment?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if the expression&#8217;s environment was generated for itself
(usually DefineExpression do have such envs)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 276</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L276">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">276
277
278
279
280
281
282
283
284
285
286
287</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='owns_its_environment? fid id'>owns_its_environment?</span>

  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='not not kw'>not</span> <span class='@environment_id ivar id'>@environment_id</span>

  <span class='ei identifier id'>ei</span> <span class='assign token'>=</span> <span class='@fei ivar id'>@fei</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='vi identifier id'>vi</span> <span class='assign token'>=</span> <span class='@environment_id ivar id'>@environment_id</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>

  <span class='ei identifier id'>ei</span><span class='dot token'>.</span><span class='expression_name identifier id'>expression_name</span> <span class='assign token'>=</span> <span class='string val'>'neutral'</span>
  <span class='vi identifier id'>vi</span><span class='dot token'>.</span><span class='expression_name identifier id'>expression_name</span> <span class='assign token'>=</span> <span class='string val'>'neutral'</span>

  <span class='lparen token'>(</span><span class='ei identifier id'>ei</span> <span class='eq op'>==</span> <span class='vi identifier id'>vi</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>paused?</h3>
</div><div id="paused-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>paused?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if this expression belongs to a paused flow
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 292</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L292">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">292
293
294
295</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='paused? fid id'>paused?</span>

  <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='is_paused? fid id'>is_paused?</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>raw_children</h3>
</div><div id="raw_children-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>raw_children</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Since OpenWFEru 0.9.17, each expression keeps his @raw_representation this
is a shortcut for exp.raw_representation[2]
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 664</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L664">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">664
665
666
667</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='raw_children identifier id'>raw_children</span>

  <span class='@raw_representation ivar id'>@raw_representation</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>raw_expression_children</h3>
</div><div id="raw_expression_children-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>raw_expression_children</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a list of children that are expressions (arrays)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 672</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L672">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">672
673
674
675</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='raw_expression_children identifier id'>raw_expression_children</span>

  <span class='@raw_representation ivar id'>@raw_representation</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='c identifier id'>c</span><span class='bitor op'>|</span> <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_child</h3>
</div><div id="remove_child-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_child</span><span class='args'>(child_fei)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Removes a child from the expression children list.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 567</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L567">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">567
568
569
570
571
572
573
574
575
576
577
578</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_child identifier id'>remove_child</span> <span class='lparen token'>(</span><span class='child_fei identifier id'>child_fei</span><span class='rparen token'>)</span>

  <span class='i identifier id'>i</span> <span class='assign token'>=</span> <span class='@children ivar id'>@children</span><span class='dot token'>.</span><span class='index identifier id'>index</span><span class='lparen token'>(</span><span class='child_fei identifier id'>child_fei</span><span class='rparen token'>)</span>

  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='i identifier id'>i</span>

  <span class='@children ivar id'>@children</span><span class='dot token'>.</span><span class='delete_at identifier id'>delete_at</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='rparen token'>)</span>
  <span class='raw_children identifier id'>raw_children</span><span class='dot token'>.</span><span class='delete_at identifier id'>delete_at</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='rparen token'>)</span>
  <span class='@raw_rep_updated ivar id'>@raw_rep_updated</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>

  <span class='store_itself identifier id'>store_itself</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reply</h3>
</div><div id="reply-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reply</span><span class='args'>(workitem)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
this default implementation immediately replies to the parent expression
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 162</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L162">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">162
163
164
165</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reply identifier id'>reply</span> <span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>

  <span class='reply_to_parent identifier id'>reply_to_parent</span><span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reply_to_parent</h3>
</div><div id="reply_to_parent-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reply_to_parent</span><span class='args'>(workitem)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Triggers the reply to the parent expression (of course, via the expression
pool). Expressions do call this method when their job is done and the flow
should resume without them.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 173</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L173">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">173
174
175
176</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reply_to_parent identifier id'>reply_to_parent</span> <span class='lparen token'>(</span><span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>

  <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='reply_to_parent identifier id'>reply_to_parent</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>set_variable</h3>
</div><div id="set_variable-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>set_variable</span><span class='args'>(varname, value)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="sv-instance_method">sv</tt>
  
</p>
</div><div class="section docstring">
  <p>
Sets a variable in the current environment. Is usually called by the
&#8216;set&#8217; expression.
</p>
<p>
The variable name may be prefixed by / to indicate process level scope or
by // to indicate engine level (global) scope.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 304</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L304">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">304
305
306
307
308</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='set_variable identifier id'>set_variable</span> <span class='lparen token'>(</span><span class='varname identifier id'>varname</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>

  <span class='env identifier id'>env</span><span class='comma token'>,</span> <span class='var identifier id'>var</span> <span class='assign token'>=</span> <span class='lookup_environment identifier id'>lookup_environment</span><span class='lparen token'>(</span><span class='varname identifier id'>varname</span><span class='rparen token'>)</span>
  <span class='env identifier id'>env</span><span class='lbrack token'>[</span><span class='var identifier id'>var</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>store_itself</h3>
</div><div id="store_itself-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>store_itself</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Stores itself in the expression pool. It&#8217;s very important for
expressions in persisted context to save themselves as soon as their state
changed. Else this information would be lost at engine restart or simply if
the expression got swapped out of memory and reloaded later.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 234</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L234">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">234
235
236
237
238
239
240</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='store_itself identifier id'>store_itself</span>

  <span class='comment val'>#ldebug { &quot;store_itself() for  #{@fei.to_debug_s}&quot; }</span>
  <span class='comment val'>#ldebug { &quot;store_itself() \n#{OpenWFE::caller_to_s(0, 6)}&quot; }</span>

  <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='update identifier id'>update</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_s</h3>
</div><div id="to_s-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_s</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Some eye candy
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 739</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L739">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span>

  <span class='s identifier id'>s</span> <span class='assign token'>=</span>  <span class='dstring node'>&quot;* #{@fei.to_debug_s} [#{self.class.name}]&quot;</span>

  <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;\n   `--p--&gt; #{@parent_id.to_debug_s}&quot;</span> \
    <span class='if if_mod kw'>if</span> <span class='@parent_id ivar id'>@parent_id</span>

  <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;\n   `--e--&gt; #{@environment_id.to_debug_s}&quot;</span> \
    <span class='if if_mod kw'>if</span> <span class='@environment_id ivar id'>@environment_id</span>

  <span class='return return kw'>return</span> <span class='s identifier id'>s</span> <span class='unless unless_mod kw'>unless</span> <span class='@children ivar id'>@children</span>

  <span class='@children ivar id'>@children</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='c identifier id'>c</span><span class='bitor op'>|</span>
    <span class='sc identifier id'>sc</span> <span class='assign token'>=</span> <span class='if if kw'>if</span> <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='OpenWFE constant id'>OpenWFE</span><span class='colon2 op'>::</span><span class='FlowExpressionId constant id'>FlowExpressionId</span><span class='rparen token'>)</span>
      <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='to_debug_s identifier id'>to_debug_s</span>
    <span class='else else kw'>else</span>
      <span class='dstring node'>&quot;&gt;#{c.to_s}&lt;&quot;</span>
    <span class='end end kw'>end</span>
    <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;\n   `--c--&gt; #{sc}&quot;</span>
  <span class='end end kw'>end</span>

  <span class='s identifier id'>s</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_yaml_properties</h3>
</div><div id="to_yaml_properties-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_yaml_properties</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 814</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L814">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">814
815
816
817
818</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_yaml_properties identifier id'>to_yaml_properties</span> 
  <span class='l identifier id'>l</span> <span class='assign token'>=</span> <span class='super super kw'>super</span>
  <span class='l identifier id'>l</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>'@application_context'</span><span class='rparen token'>)</span>
  <span class='l identifier id'>l</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>trigger_on_cancel</h3>
</div><div id="trigger_on_cancel-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>trigger_on_cancel</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
triggers the on_cancel attribute of the expression, if any, and forgets
it&#8230;
</p>
<p>
makes sure to pass a copy of the cancelled process&#8217;s variables to the
on_cancel process/participant if any
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/openwfe/expressions/flowexpression.rb', line 203</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jmettraux/ruote/blob/5348d68477c619f29e89032a1e3efae889f5722c/lib/openwfe/expressions/flowexpression.rb#L203">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">203
204
205
206
207
208
209
210
211
212
213</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='trigger_on_cancel identifier id'>trigger_on_cancel</span>

  <span class='on_cancel identifier id'>on_cancel</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span> <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='string val'>'on_cancel'</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='return return kw'>return</span>

  <span class='on_cancel identifier id'>on_cancel</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span> <span class='assign token'>=</span> <span class='on_cancel identifier id'>on_cancel</span>

  <span class='template identifier id'>template</span> <span class='assign token'>=</span> <span class='lookup_variable identifier id'>lookup_variable</span><span class='lparen token'>(</span><span class='on_cancel identifier id'>on_cancel</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='lbrack token'>[</span> <span class='on_cancel identifier id'>on_cancel</span><span class='comma token'>,</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='rbrack token'>]</span>

  <span class='get_expression_pool identifier id'>get_expression_pool</span><span class='dot token'>.</span><span class='launch_subprocess identifier id'>launch_subprocess</span><span class='lparen token'>(</span>
    <span class='self self kw'>self</span><span class='comma token'>,</span><span class='template identifier id'>template</span><span class='comma token'>,</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='workitem identifier id'>workitem</span><span class='comma token'>,</span> <span class='get_environment identifier id'>get_environment</span><span class='dot token'>.</span><span class='lookup_all_variables identifier id'>lookup_all_variables</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>