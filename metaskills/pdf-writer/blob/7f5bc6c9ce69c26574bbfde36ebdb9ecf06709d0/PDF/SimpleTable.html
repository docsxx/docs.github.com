<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>metaskills's pdf-writer - Class: PDF::SimpleTable - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/metaskills/commits/pdf-writer/master" rel="alternate" title="Recent Commits to pdf-writer:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("metaskills", "pdf-writer", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='metaskills/pdf-writer/blob/7f5bc6c9ce69c26574bbfde36ebdb9ecf06709d0' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='metaskills/pdf-writer/blob/7f5bc6c9ce69c26574bbfde36ebdb9ecf06709d0' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("metaskills", "pdf-writer", "7f5bc6c9ce69c26574bbfde36ebdb9ecf06709d0", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/metaskills/pdf-writer/tree/">Source</a></li>
            <li class=""><a href="http://github.com/metaskills/pdf-writer/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/metaskills/pdf-writer/network">Network</a></li>            
            <li class=""><a href="http://github.com/metaskills/pdf-writer/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/metaskills/pdf-writer">Wiki</a></li>
            <li class=""><a href="http://github.com/metaskills/pdf-writer/graphs">Graphs</a></li>                    
            <li class="active"><a href="/metaskills/pdf-writer">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/metaskills">metaskills</a> / <b><a href="http://github.com/metaskills/pdf-writer/tree">pdf-writer</a></b>        
                <a id="namespaces_button" rel="metaskills/pdf-writer/blob/7f5bc6c9ce69c26574bbfde36ebdb9ecf06709d0" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="metaskills/pdf-writer/blob/7f5bc6c9ce69c26574bbfde36ebdb9ecf06709d0" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class PDF_SimpleTable">
  <h1>Class: PDF::SimpleTable</h1>
  <div class="section mixins">
  <h2>Included Modules</h2>
  <p>Transaction::Simple</p>
</div><div class="section docstring">
  <p>
This class will create tables with a relatively simple API and internal
implementation.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">bold_headings</td>
          <td class="readwrite">
            [<span id='bold_headings-instance_method'>R</span><span id='bold_headings=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Makes the heading text bold if <tt>true</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">column_gap</td>
          <td class="readwrite">
            [<span id='column_gap-instance_method'>R</span><span id='column_gap=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The space, in PDF user units, on the left and right sides of each cell.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">column_order</td>
          <td class="readwrite">
            [<span id='column_order-instance_method'>R</span><span id='column_order=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
An array that defines the order of the columns in the table.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">columns</td>
          <td class="readwrite">
            [<span id='columns-instance_method'>R</span><span id='columns=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
An array that defines columns and column options for the table.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">data</td>
          <td class="readwrite">
            [<span id='data-instance_method'>R</span><span id='data=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
An array of Hash entries.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">font_size</td>
          <td class="readwrite">
            [<span id='font_size-instance_method'>R</span><span id='font_size=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The font size of the data cells, in points.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">header_gap</td>
          <td class="readwrite">
            [<span id='header_gap-instance_method'>R</span><span id='header_gap=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The number of PDF user units to leave open at the top of a page after a
page break.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">heading_color</td>
          <td class="readwrite">
            [<span id='heading_color-instance_method'>R</span><span id='heading_color=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The text colour of the heading.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">heading_font_size</td>
          <td class="readwrite">
            [<span id='heading_font_size-instance_method'>R</span><span id='heading_font_size=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The font size of the heading cells, in points.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">inner_line_style</td>
          <td class="readwrite">
            [<span id='inner_line_style-instance_method'>R</span><span id='inner_line_style=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Defines the inner line style.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">line_color</td>
          <td class="readwrite">
            [<span id='line_color-instance_method'>R</span><span id='line_color=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The colour of the table lines.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">maximum_width</td>
          <td class="readwrite">
            [<span id='maximum_width-instance_method'>R</span><span id='maximum_width=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Specifies the maximum width of the table.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">minimum_space</td>
          <td class="readwrite">
            [<span id='minimum_space-instance_method'>R</span><span id='minimum_space=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The minimum space between the bottom of each row and the bottom margin.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">orientation</td>
          <td class="readwrite">
            [<span id='orientation-instance_method'>R</span><span id='orientation=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The orientation of the table relative to #position.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">outer_line_style</td>
          <td class="readwrite">
            [<span id='outer_line_style-instance_method'>R</span><span id='outer_line_style=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Defines the outer line style.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">position</td>
          <td class="readwrite">
            [<span id='position-instance_method'>R</span><span id='position=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The <tt>x</tt> position of the table.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">protect_rows</td>
          <td class="readwrite">
            [<span id='protect_rows-instance_method'>R</span><span id='protect_rows=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The number of rows to hold with the heading on the page.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">row_gap</td>
          <td class="readwrite">
            [<span id='row_gap-instance_method'>R</span><span id='row_gap=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The space, in PDF user units, added to the top and bottom of each row
between the text and the lines of the cell.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">shade_color2</td>
          <td class="readwrite">
            [<span id='shade_color2-instance_method'>R</span><span id='shade_color2=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The alternate row shading colour, used with #shade_rows of
<tt>:striped</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">shade_color</td>
          <td class="readwrite">
            [<span id='shade_color-instance_method'>R</span><span id='shade_color=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The main row shading colour.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">shade_heading_color</td>
          <td class="readwrite">
            [<span id='shade_heading_color-instance_method'>R</span><span id='shade_heading_color=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Defines the colour of the background shading for the heading if
#shade_headings is <tt>true</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">shade_headings</td>
          <td class="readwrite">
            [<span id='shade_headings-instance_method'>R</span><span id='shade_headings=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Places a background colour in the heading if <tt>true</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">shade_rows</td>
          <td class="readwrite">
            [<span id='shade_rows-instance_method'>R</span><span id='shade_rows=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Controls row shading.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">show_headings</td>
          <td class="readwrite">
            [<span id='show_headings-instance_method'>R</span><span id='show_headings=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Displays the headings for the table if <tt>true</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">show_lines</td>
          <td class="readwrite">
            [<span id='show_lines-instance_method'>R</span><span id='show_lines=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Whether to display the lines on the table or not.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">split_rows</td>
          <td class="readwrite">
            [<span id='split_rows-instance_method'>R</span><span id='split_rows=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Allows a table&#8217;s rows to be split across page boundaries if
<tt>true</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">text_color</td>
          <td class="readwrite">
            [<span id='text_color-instance_method'>R</span><span id='text_color=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The text colour of the body cells.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">title_color</td>
          <td class="readwrite">
            [<span id='title_color-instance_method'>R</span><span id='title_color=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The text colour of the title.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">title_font_size</td>
          <td class="readwrite">
            [<span id='title_font_size-instance_method'>R</span><span id='title_font_size=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The font size of the title, in points.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">title_gap</td>
          <td class="readwrite">
            [<span id='title_gap-instance_method'>R</span><span id='title_gap=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The gap, in PDF units, between the title and the table.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">title</td>
          <td class="readwrite">
            [<span id='title-instance_method'>R</span><span id='title=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The title to be put on the top of the table.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">width</td>
          <td class="readwrite">
            [<span id='width-instance_method'>R</span><span id='width=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Specifies the width of the table.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="VERSION-constant">VERSION</dt>
      <dd>'1.2.0'</dd>
    
      <dt id="WIDTH_FACTOR-constant">WIDTH_FACTOR</dt>
      <dd>1.01</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'></span>
    <span class='block'>{|_self| ... }</span>
  </tt>
</div>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="yieldparam">
  <h3>Yield Parameters:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a href="" title="PDF::SimpleTable">PDF::SimpleTable</a></tt>]</span>
      
      
        <span class='name'>_self</span>
      
      
    </dt>
    <dd>
      <span class='desc'><p>
the object that the method was called on
</p>
</span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/pdf/simpletable.rb', line 70</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/metaskills/pdf-writer/blob/7f5bc6c9ce69c26574bbfde36ebdb9ecf06709d0/lib/pdf/simpletable.rb#L70">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span>
  <span class='@column_order ivar id'>@column_order</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@data ivar id'>@data</span>         <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@columns ivar id'>@columns</span>      <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

  <span class='@show_lines ivar id'>@show_lines</span>           <span class='assign token'>=</span> <span class='symbol val'>:outer</span>
  <span class='@show_headings ivar id'>@show_headings</span>        <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='@shade_rows ivar id'>@shade_rows</span>           <span class='assign token'>=</span> <span class='symbol val'>:shaded</span>
  <span class='@shade_color ivar id'>@shade_color</span>          <span class='assign token'>=</span> <span class='Color constant id'>Color</span><span class='colon2 op'>::</span><span class='RGB constant id'>RGB</span><span class='colon2 op'>::</span><span class='Grey80 constant id'>Grey80</span>
  <span class='@shade_color2 ivar id'>@shade_color2</span>         <span class='assign token'>=</span> <span class='Color constant id'>Color</span><span class='colon2 op'>::</span><span class='RGB constant id'>RGB</span><span class='colon2 op'>::</span><span class='Grey70 constant id'>Grey70</span>
  <span class='@shade_headings ivar id'>@shade_headings</span>       <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='@shade_heading_color ivar id'>@shade_heading_color</span>  <span class='assign token'>=</span> <span class='Color constant id'>Color</span><span class='colon2 op'>::</span><span class='RGB constant id'>RGB</span><span class='colon2 op'>::</span><span class='Grey90 constant id'>Grey90</span>
  <span class='@font_size ivar id'>@font_size</span>            <span class='assign token'>=</span> <span class='integer val'>10</span>
  <span class='@heading_font_size ivar id'>@heading_font_size</span>    <span class='assign token'>=</span> <span class='integer val'>12</span>
  <span class='@title_font_size ivar id'>@title_font_size</span>      <span class='assign token'>=</span> <span class='integer val'>12</span>
  <span class='@title_gap ivar id'>@title_gap</span>            <span class='assign token'>=</span> <span class='integer val'>5</span>
  <span class='@title_color ivar id'>@title_color</span>          <span class='assign token'>=</span> <span class='Color constant id'>Color</span><span class='colon2 op'>::</span><span class='RGB constant id'>RGB</span><span class='colon2 op'>::</span><span class='Black constant id'>Black</span>
  <span class='@heading_color ivar id'>@heading_color</span>        <span class='assign token'>=</span> <span class='Color constant id'>Color</span><span class='colon2 op'>::</span><span class='RGB constant id'>RGB</span><span class='colon2 op'>::</span><span class='Black constant id'>Black</span>
  <span class='@text_color ivar id'>@text_color</span>           <span class='assign token'>=</span> <span class='Color constant id'>Color</span><span class='colon2 op'>::</span><span class='RGB constant id'>RGB</span><span class='colon2 op'>::</span><span class='Black constant id'>Black</span>
  <span class='@line_color ivar id'>@line_color</span>           <span class='assign token'>=</span> <span class='Color constant id'>Color</span><span class='colon2 op'>::</span><span class='RGB constant id'>RGB</span><span class='colon2 op'>::</span><span class='Black constant id'>Black</span>
  <span class='@position ivar id'>@position</span>             <span class='assign token'>=</span> <span class='symbol val'>:center</span>
  <span class='@orientation ivar id'>@orientation</span>          <span class='assign token'>=</span> <span class='symbol val'>:center</span>
  <span class='@bold_headings ivar id'>@bold_headings</span>        <span class='assign token'>=</span> <span class='false false kw'>false</span>

  <span class='@cols ivar id'>@cols</span>                 <span class='assign token'>=</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='Writer constant id'>Writer</span><span class='colon2 op'>::</span><span class='OHash constant id'>OHash</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@width ivar id'>@width</span>                <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@maximum_width ivar id'>@maximum_width</span>        <span class='assign token'>=</span> <span class='integer val'>0</span>

  <span class='@gap ivar id'>@gap</span>                  <span class='assign token'>=</span> <span class='integer val'>5</span>
  <span class='@row_gap ivar id'>@row_gap</span>              <span class='assign token'>=</span> <span class='integer val'>2</span>
  <span class='@column_gap ivar id'>@column_gap</span>           <span class='assign token'>=</span> <span class='integer val'>5</span>
  <span class='@header_gap ivar id'>@header_gap</span>           <span class='assign token'>=</span> <span class='integer val'>0</span>

  <span class='@minimum_space ivar id'>@minimum_space</span>        <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@protect_rows ivar id'>@protect_rows</span>         <span class='assign token'>=</span> <span class='integer val'>1</span>
  <span class='@split_rows ivar id'>@split_rows</span>           <span class='assign token'>=</span> <span class='false false kw'>false</span>

  <span class='@inner_line_style ivar id'>@inner_line_style</span>     <span class='assign token'>=</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='Writer constant id'>Writer</span><span class='colon2 op'>::</span><span class='StrokeStyle constant id'>StrokeStyle</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>
  <span class='@outer_line_style ivar id'>@outer_line_style</span>     <span class='assign token'>=</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='Writer constant id'>Writer</span><span class='colon2 op'>::</span><span class='StrokeStyle constant id'>StrokeStyle</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>

  <span class='yield yield kw'>yield</span> <span class='self self kw'>self</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#render_on-instance_method">#render_on</span><span class='args'>(pdf)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Render the table on the PDF::Writer document provided.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>render_on</h3>
</div><div id="render_on-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>render_on</span><span class='args'>(pdf)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Render the table on the PDF::Writer document provided.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/pdf/simpletable.rb', line 239</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/metaskills/pdf-writer/blob/7f5bc6c9ce69c26574bbfde36ebdb9ecf06709d0/lib/pdf/simpletable.rb#L239">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='render_on identifier id'>render_on</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='@column_order ivar id'>@column_order</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='Writer constant id'>Writer</span><span class='colon2 op'>::</span><span class='Lang constant id'>Lang</span><span class='lbrack token'>[</span><span class='symbol val'>:simpletable_columns_undefined</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='@data ivar id'>@data</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='Writer constant id'>Writer</span><span class='colon2 op'>::</span><span class='Lang constant id'>Lang</span><span class='lbrack token'>[</span><span class='symbol val'>:simpletable_data_empty</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>

  <span class='low_y identifier id'>low_y</span> <span class='assign token'>=</span> <span class='descender identifier id'>descender</span> <span class='assign token'>=</span> <span class='y0 identifier id'>y0</span> <span class='assign token'>=</span> <span class='y1 identifier id'>y1</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

  <span class='@cols ivar id'>@cols</span> <span class='assign token'>=</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='Writer constant id'>Writer</span><span class='colon2 op'>::</span><span class='OHash constant id'>OHash</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@column_order ivar id'>@column_order</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='bitor op'>|</span>
    <span class='col identifier id'>col</span> <span class='assign token'>=</span> <span class='@columns ivar id'>@columns</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span>
    <span class='if if kw'>if</span> <span class='col identifier id'>col</span>
      <span class='@cols ivar id'>@cols</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='col identifier id'>col</span>
    <span class='else else kw'>else</span>
      <span class='@cols ivar id'>@cols</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='SimpleTable constant id'>SimpleTable</span><span class='colon2 op'>::</span><span class='Column constant id'>Column</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='@gap ivar id'>@gap</span> <span class='assign token'>=</span> <span class='integer val'>2</span> <span class='mult op'>*</span> <span class='@column_gap ivar id'>@column_gap</span>

  <span class='max_width identifier id'>max_width</span> <span class='assign token'>=</span> <span class='__find_table_max_width__ identifier id'>__find_table_max_width__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='rparen token'>)</span>
  <span class='pos identifier id'>pos</span><span class='comma token'>,</span> <span class='t identifier id'>t</span><span class='comma token'>,</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='adjustment_width identifier id'>adjustment_width</span><span class='comma token'>,</span> <span class='set_width identifier id'>set_width</span> <span class='assign token'>=</span> <span class='__find_table_positions__ identifier id'>__find_table_positions__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='comma token'>,</span> <span class='max_width identifier id'>max_width</span><span class='rparen token'>)</span>

  <span class='comment val'># if max_width is specified, and the table is too wide, and the width</span>
  <span class='comment val'># has not been set, then set the width.</span>
  <span class='if if kw'>if</span> <span class='@width ivar id'>@width</span><span class='dot token'>.</span><span class='zero? fid id'>zero?</span> <span class='and and kw'>and</span> <span class='@maximum_width ivar id'>@maximum_width</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='t identifier id'>t</span> <span class='minus op'>-</span> <span class='x identifier id'>x</span><span class='rparen token'>)</span> <span class='gt op'>&gt;</span> <span class='@maximum_width ivar id'>@maximum_width</span><span class='rparen token'>)</span>
    <span class='@width ivar id'>@width</span> <span class='assign token'>=</span> <span class='@maximum_width ivar id'>@maximum_width</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='@width ivar id'>@width</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='adjustment_width identifier id'>adjustment_width</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='set_width identifier id'>set_width</span> <span class='lt op'>&lt;</span> <span class='@width ivar id'>@width</span><span class='rparen token'>)</span>
      <span class='comment val'># First find the current widths of the columns involved in this</span>
      <span class='comment val'># mystery</span>
    <span class='cols0 identifier id'>cols0</span> <span class='assign token'>=</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='Writer constant id'>Writer</span><span class='colon2 op'>::</span><span class='OHash constant id'>OHash</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='cols1 identifier id'>cols1</span> <span class='assign token'>=</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='Writer constant id'>Writer</span><span class='colon2 op'>::</span><span class='OHash constant id'>OHash</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

    <span class='xq identifier id'>xq</span> <span class='assign token'>=</span> <span class='presentWidth identifier id'>presentWidth</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='last identifier id'>last</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

    <span class='pos identifier id'>pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='colpos identifier id'>colpos</span><span class='bitor op'>|</span>
      <span class='if if kw'>if</span> <span class='@cols ivar id'>@cols</span><span class='lbrack token'>[</span><span class='last identifier id'>last</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span>
        <span class='@cols ivar id'>@cols</span><span class='lbrack token'>[</span><span class='last identifier id'>last</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='width identifier id'>width</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span>
        <span class='@cols ivar id'>@cols</span><span class='lbrack token'>[</span><span class='last identifier id'>last</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='width identifier id'>width</span> <span class='leq op'>&lt;=</span> <span class='integer val'>0</span>
        <span class='unless unless kw'>unless</span> <span class='last identifier id'>last</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span> <span class='last identifier id'>last</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
          <span class='cols0 identifier id'>cols0</span><span class='lbrack token'>[</span><span class='last identifier id'>last</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='colpos identifier id'>colpos</span> <span class='minus op'>-</span> <span class='xq identifier id'>xq</span> <span class='minus op'>-</span> <span class='@gap ivar id'>@gap</span>
          <span class='presentWidth identifier id'>presentWidth</span> <span class='opasgn op'>+=</span> <span class='lparen token'>(</span><span class='colpos identifier id'>colpos</span> <span class='minus op'>-</span> <span class='xq identifier id'>xq</span> <span class='minus op'>-</span> <span class='@gap ivar id'>@gap</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
      <span class='else else kw'>else</span>
        <span class='cols1 identifier id'>cols1</span><span class='lbrack token'>[</span><span class='last identifier id'>last</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='colpos identifier id'>colpos</span> <span class='minus op'>-</span> <span class='xq identifier id'>xq</span>
      <span class='end end kw'>end</span>
      <span class='last identifier id'>last</span> <span class='assign token'>=</span> <span class='name identifier id'>name</span>
      <span class='xq identifier id'>xq</span> <span class='assign token'>=</span> <span class='colpos identifier id'>colpos</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># cols0 contains the widths of all the columns which are not set</span>
    <span class='needed_width identifier id'>needed_width</span> <span class='assign token'>=</span> <span class='@width ivar id'>@width</span> <span class='minus op'>-</span> <span class='set_width identifier id'>set_width</span>

      <span class='comment val'># If needed width is negative then add it equally to each column,</span>
      <span class='comment val'># else get more tricky.</span>
    <span class='if if kw'>if</span> <span class='presentWidth identifier id'>presentWidth</span> <span class='lt op'>&lt;</span> <span class='needed_width identifier id'>needed_width</span>
      <span class='diff identifier id'>diff</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='needed_width identifier id'>needed_width</span> <span class='minus op'>-</span> <span class='presentWidth identifier id'>presentWidth</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='cols0 identifier id'>cols0</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
      <span class='cols0 identifier id'>cols0</span><span class='dot token'>.</span><span class='each_key identifier id'>each_key</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='bitor op'>|</span> <span class='cols0 identifier id'>cols0</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='diff identifier id'>diff</span> <span class='rbrace token'>}</span>
    <span class='else else kw'>else</span>
      <span class='cnt identifier id'>cnt</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='loop identifier id'>loop</span> <span class='do do kw'>do</span>
        <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='presentWidth identifier id'>presentWidth</span> <span class='leq op'>&lt;=</span> <span class='needed_width identifier id'>needed_width</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='lparen token'>(</span><span class='cnt identifier id'>cnt</span> <span class='geq op'>&gt;=</span> <span class='integer val'>100</span><span class='rparen token'>)</span>
        <span class='cnt identifier id'>cnt</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span> <span class='comment val'># insurance policy</span>
          <span class='comment val'># Find the widest columns and the next to widest width</span>
        <span class='aWidest identifier id'>aWidest</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
        <span class='nWidest identifier id'>nWidest</span> <span class='assign token'>=</span> <span class='widest identifier id'>widest</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
        <span class='cols0 identifier id'>cols0</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='w identifier id'>w</span><span class='bitor op'>|</span>
          <span class='if if kw'>if</span> <span class='w identifier id'>w</span> <span class='gt op'>&gt;</span> <span class='widest identifier id'>widest</span>
            <span class='aWidest identifier id'>aWidest</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='name identifier id'>name</span> <span class='rbrack token'>]</span>
            <span class='nWidest identifier id'>nWidest</span> <span class='assign token'>=</span> <span class='widest identifier id'>widest</span>
            <span class='widest identifier id'>widest</span> <span class='assign token'>=</span> <span class='w identifier id'>w</span>
          <span class='elsif elsif kw'>elsif</span> <span class='w identifier id'>w</span> <span class='eq op'>==</span> <span class='widest identifier id'>widest</span>
            <span class='aWidest identifier id'>aWidest</span> <span class='lshft op'>&lt;&lt;</span> <span class='name identifier id'>name</span>
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>

        <span class='comment val'># Then figure out what the width of the widest columns would</span>
        <span class='comment val'># have to be to take up all the slack.</span>
        <span class='newWidestWidth identifier id'>newWidestWidth</span> <span class='assign token'>=</span> <span class='widest identifier id'>widest</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='presentWidth identifier id'>presentWidth</span> <span class='minus op'>-</span> <span class='needed_width identifier id'>needed_width</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='aWidest identifier id'>aWidest</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
        <span class='if if kw'>if</span> <span class='newWidestWidth identifier id'>newWidestWidth</span> <span class='gt op'>&gt;</span> <span class='nWidest identifier id'>nWidest</span>
          <span class='aWidest identifier id'>aWidest</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='bitor op'>|</span> <span class='cols0 identifier id'>cols0</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='newWidestWidth identifier id'>newWidestWidth</span> <span class='rbrace token'>}</span>
          <span class='presentWidth identifier id'>presentWidth</span> <span class='assign token'>=</span> <span class='needed_width identifier id'>needed_width</span>
        <span class='else else kw'>else</span>
          <span class='comment val'># There is no space, reduce the size of the widest ones down</span>
          <span class='comment val'># to the next size down, and we will go round again</span>
          <span class='aWidest identifier id'>aWidest</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='bitor op'>|</span> <span class='cols0 identifier id'>cols0</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='nWidest identifier id'>nWidest</span> <span class='rbrace token'>}</span>
          <span class='presentWidth identifier id'>presentWidth</span> <span class='opasgn op'>-=</span> <span class='lparen token'>(</span><span class='widest identifier id'>widest</span> <span class='minus op'>-</span> <span class='nWidest identifier id'>nWidest</span><span class='rparen token'>)</span> <span class='mult op'>*</span> <span class='aWidest identifier id'>aWidest</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

      <span class='comment val'># cols0 now contains the new widths of the constrained columns. now</span>
      <span class='comment val'># need to update the pos and max_width arrays</span>
    <span class='xq identifier id'>xq</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='pos identifier id'>pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='colpos identifier id'>colpos</span><span class='bitor op'>|</span>
      <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='xq identifier id'>xq</span>

      <span class='if if kw'>if</span> <span class='@cols ivar id'>@cols</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span>
        <span class='@cols ivar id'>@cols</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='width identifier id'>width</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span>
        <span class='@cols ivar id'>@cols</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='width identifier id'>width</span> <span class='leq op'>&lt;=</span> <span class='integer val'>0</span>
        <span class='if if kw'>if</span> <span class='not not kw'>not</span> <span class='cols0 identifier id'>cols0</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
          <span class='xq identifier id'>xq</span> <span class='opasgn op'>+=</span> <span class='cols0 identifier id'>cols0</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='@gap ivar id'>@gap</span>
          <span class='max_width identifier id'>max_width</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='cols0 identifier id'>cols0</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span>
        <span class='end end kw'>end</span>
      <span class='else else kw'>else</span>
        <span class='xq identifier id'>xq</span> <span class='opasgn op'>+=</span> <span class='cols1 identifier id'>cols1</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='unless unless_mod kw'>unless</span> <span class='cols1 identifier id'>cols1</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='x identifier id'>x</span> <span class='plus op'>+</span> <span class='@width ivar id'>@width</span>
    <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='symbol val'>:__last_column__</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='t identifier id'>t</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># now adjust the table to the correct location across the page</span>
  <span class='case case kw'>case</span> <span class='@position ivar id'>@position</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:left</span>
    <span class='xref identifier id'>xref</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_left_margin identifier id'>absolute_left_margin</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:right</span>
    <span class='xref identifier id'>xref</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_right_margin identifier id'>absolute_right_margin</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:center</span>
    <span class='xref identifier id'>xref</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='margin_x_middle identifier id'>margin_x_middle</span>
  <span class='else else kw'>else</span>
    <span class='xref identifier id'>xref</span> <span class='assign token'>=</span> <span class='@position ivar id'>@position</span>
  <span class='end end kw'>end</span>

  <span class='case case kw'>case</span> <span class='@orientation ivar id'>@orientation</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:left</span>
    <span class='dx identifier id'>dx</span> <span class='assign token'>=</span> <span class='xref identifier id'>xref</span> <span class='minus op'>-</span> <span class='t identifier id'>t</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:right</span>
    <span class='dx identifier id'>dx</span> <span class='assign token'>=</span> <span class='xref identifier id'>xref</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:center</span>
    <span class='dx identifier id'>dx</span> <span class='assign token'>=</span> <span class='xref identifier id'>xref</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='t identifier id'>t</span> <span class='div op'>/</span> <span class='float val'>2.0</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='dx identifier id'>dx</span> <span class='assign token'>=</span> <span class='xref identifier id'>xref</span> <span class='plus op'>+</span> <span class='@orientation ivar id'>@orientation</span>
  <span class='end end kw'>end</span>

  <span class='pos identifier id'>pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span> <span class='plus op'>+</span> <span class='dx identifier id'>dx</span> <span class='rbrace token'>}</span>

  <span class='base_x0 identifier id'>base_x0</span> <span class='assign token'>=</span> <span class='x0 identifier id'>x0</span> <span class='assign token'>=</span> <span class='x identifier id'>x</span> <span class='plus op'>+</span> <span class='dx identifier id'>dx</span>
  <span class='base_x1 identifier id'>base_x1</span> <span class='assign token'>=</span> <span class='x1 identifier id'>x1</span> <span class='assign token'>=</span> <span class='t identifier id'>t</span> <span class='plus op'>+</span> <span class='dx identifier id'>dx</span>

  <span class='base_left_margin identifier id'>base_left_margin</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_left_margin identifier id'>absolute_left_margin</span>
  <span class='base_pos identifier id'>base_pos</span> <span class='assign token'>=</span> <span class='pos identifier id'>pos</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>

    <span class='comment val'># Ok, just about ready to make me a table.</span>
  <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color identifier id'>fill_color</span> <span class='@text_color ivar id'>@text_color</span>
  <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='stroke_color identifier id'>stroke_color</span> <span class='@shade_color ivar id'>@shade_color</span> 

  <span class='middle identifier id'>middle</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='plus op'>+</span> <span class='x1 identifier id'>x1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='float val'>2.0</span>

    <span class='comment val'># Start a transaction. This transaction will be used to regress the</span>
    <span class='comment val'># table if there are not enough rows protected. </span>
  <span class='tg identifier id'>tg</span> <span class='assign token'>=</span> <span class='Transaction constant id'>Transaction</span><span class='colon2 op'>::</span><span class='Simple constant id'>Simple</span><span class='colon2 op'>::</span><span class='Group constant id'>Group</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='rparen token'>)</span>
  <span class='tg identifier id'>tg</span><span class='dot token'>.</span><span class='start_transaction identifier id'>start_transaction</span><span class='lparen token'>(</span><span class='symbol val'>:table</span><span class='rparen token'>)</span>
  <span class='moved_once identifier id'>moved_once</span> <span class='assign token'>=</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='@protect_rows ivar id'>@protect_rows</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span>

  <span class='abortTable identifier id'>abortTable</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='loop identifier id'>loop</span> <span class='do do kw'>do</span> <span class='comment val'># while abortTable</span>
    <span class='break break kw'>break</span> <span class='unless unless_mod kw'>unless</span> <span class='abortTable identifier id'>abortTable</span>
    <span class='abortTable identifier id'>abortTable</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>

    <span class='dm identifier id'>dm</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_left_margin identifier id'>absolute_left_margin</span> <span class='minus op'>-</span> <span class='base_left_margin identifier id'>base_left_margin</span>
    <span class='base_pos identifier id'>base_pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span> <span class='rbrace token'>}</span>
    <span class='x0 identifier id'>x0</span> <span class='assign token'>=</span> <span class='base_x0 identifier id'>base_x0</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
    <span class='x1 identifier id'>x1</span> <span class='assign token'>=</span> <span class='base_x1 identifier id'>base_x1</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
    <span class='middle identifier id'>middle</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='plus op'>+</span> <span class='x1 identifier id'>x1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='float val'>2.0</span>

      <span class='comment val'># If the title is set, then render it.</span>
    <span class='unless unless kw'>unless</span> <span class='@title ivar id'>@title</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span> <span class='@title ivar id'>@title</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
      <span class='w identifier id'>w</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='text_width identifier id'>text_width</span><span class='lparen token'>(</span><span class='@title ivar id'>@title</span><span class='comma token'>,</span> <span class='@title_font_size ivar id'>@title_font_size</span><span class='rparen token'>)</span>
      <span class='_y identifier id'>_y</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span> <span class='minus op'>-</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='font_height identifier id'>font_height</span><span class='lparen token'>(</span><span class='@title_font_size ivar id'>@title_font_size</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='_y identifier id'>_y</span> <span class='lt op'>&lt;</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_bottom_margin identifier id'>absolute_bottom_margin</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='start_new_page identifier id'>start_new_page</span>

          <span class='comment val'># margins may have changed on the new page</span>
        <span class='dm identifier id'>dm</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_left_margin identifier id'>absolute_left_margin</span> <span class='minus op'>-</span> <span class='base_left_margin identifier id'>base_left_margin</span>
        <span class='base_pos identifier id'>base_pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span> <span class='rbrace token'>}</span>
        <span class='x0 identifier id'>x0</span> <span class='assign token'>=</span> <span class='base_x0 identifier id'>base_x0</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
        <span class='x1 identifier id'>x1</span> <span class='assign token'>=</span> <span class='base_x1 identifier id'>base_x1</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
        <span class='middle identifier id'>middle</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='plus op'>+</span> <span class='x1 identifier id'>x1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='float val'>2.0</span>
      <span class='end end kw'>end</span>

      <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span> <span class='opasgn op'>-=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='font_height identifier id'>font_height</span><span class='lparen token'>(</span><span class='@title_font_size ivar id'>@title_font_size</span><span class='rparen token'>)</span>
      <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color identifier id'>fill_color</span> <span class='@title_color ivar id'>@title_color</span>
      <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='add_text identifier id'>add_text</span><span class='lparen token'>(</span><span class='middle identifier id'>middle</span> <span class='minus op'>-</span> <span class='w identifier id'>w</span> <span class='div op'>/</span> <span class='float val'>2.0</span><span class='comma token'>,</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='title identifier id'>title</span><span class='comma token'>,</span> <span class='@title_font_size ivar id'>@title_font_size</span><span class='rparen token'>)</span>
      <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span> <span class='opasgn op'>-=</span> <span class='@title_gap ivar id'>@title_gap</span>
    <span class='end end kw'>end</span>

      <span class='comment val'># Margins may have changed on the new_page.</span>
    <span class='dm identifier id'>dm</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_left_margin identifier id'>absolute_left_margin</span> <span class='minus op'>-</span> <span class='base_left_margin identifier id'>base_left_margin</span>
    <span class='base_pos identifier id'>base_pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span> <span class='rbrace token'>}</span>
    <span class='x0 identifier id'>x0</span> <span class='assign token'>=</span> <span class='base_x0 identifier id'>base_x0</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
    <span class='x1 identifier id'>x1</span> <span class='assign token'>=</span> <span class='base_x1 identifier id'>base_x1</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
    <span class='middle identifier id'>middle</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='plus op'>+</span> <span class='x1 identifier id'>x1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='float val'>2.0</span>

    <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span>  <span class='comment val'># simplifies the code a bit</span>
    <span class='low_y identifier id'>low_y</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='if if_mod kw'>if</span> <span class='low_y identifier id'>low_y</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span> <span class='y identifier id'>y</span> <span class='lt op'>&lt;</span> <span class='low_y identifier id'>low_y</span> 

      <span class='comment val'># Make the table</span>
    <span class='height identifier id'>height</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='font_height identifier id'>font_height</span> <span class='@font_size ivar id'>@font_size</span>
    <span class='descender identifier id'>descender</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='font_descender identifier id'>font_descender</span> <span class='@font_size ivar id'>@font_size</span>

    <span class='y0 identifier id'>y0</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='descender identifier id'>descender</span>
    <span class='dy identifier id'>dy</span> <span class='assign token'>=</span> <span class='integer val'>0</span>

    <span class='if if kw'>if</span> <span class='@show_headings ivar id'>@show_headings</span>
      <span class='comment val'># This function will move the start of the table to a new page if</span>
      <span class='comment val'># it does not fit on this one.</span>
      <span class='hOID identifier id'>hOID</span> <span class='assign token'>=</span> <span class='__open_new_object__ identifier id'>__open_new_object__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='@shade_headings ivar id'>@shade_headings</span>
      <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color identifier id'>fill_color</span> <span class='@heading_color ivar id'>@heading_color</span>
      <span class='_height identifier id'>_height</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='__table_column_headings__ identifier id'>__table_column_headings__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='comma token'>,</span> <span class='pos identifier id'>pos</span><span class='comma token'>,</span> <span class='max_width identifier id'>max_width</span><span class='comma token'>,</span> <span class='height identifier id'>height</span><span class='comma token'>,</span>
        <span class='descender identifier id'>descender</span><span class='comma token'>,</span> <span class='@row_gap ivar id'>@row_gap</span><span class='comma token'>,</span> <span class='@heading_font_size ivar id'>@heading_font_size</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='rparen token'>)</span>
      <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color identifier id'>fill_color</span> <span class='@text_color ivar id'>@text_color</span>
      <span class='y0 identifier id'>y0</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='_height identifier id'>_height</span>
      <span class='y1 identifier id'>y1</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span>

      <span class='if if kw'>if</span> <span class='@shade_headings ivar id'>@shade_headings</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='close_object identifier id'>close_object</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color! fid id'>fill_color!</span> <span class='@shade_heading_color ivar id'>@shade_heading_color</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='rectangle identifier id'>rectangle</span><span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='minus op'>-</span> <span class='@gap ivar id'>@gap</span> <span class='div op'>/</span> <span class='float val'>2.0</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='x1 identifier id'>x1</span> <span class='minus op'>-</span> <span class='x0 identifier id'>x0</span><span class='comma token'>,</span> <span class='_height identifier id'>_height</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='fill identifier id'>fill</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='reopen_object identifier id'>reopen_object</span><span class='lparen token'>(</span><span class='hOID identifier id'>hOID</span><span class='rparen token'>)</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='close_object identifier id'>close_object</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='restore_state identifier id'>restore_state</span>
      <span class='end end kw'>end</span>

        <span class='comment val'># Margins may have changed on the new_page</span>
      <span class='dm identifier id'>dm</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_left_margin identifier id'>absolute_left_margin</span> <span class='minus op'>-</span> <span class='base_left_margin identifier id'>base_left_margin</span>
      <span class='base_pos identifier id'>base_pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span> <span class='rbrace token'>}</span>
      <span class='x0 identifier id'>x0</span> <span class='assign token'>=</span> <span class='base_x0 identifier id'>base_x0</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
      <span class='x1 identifier id'>x1</span> <span class='assign token'>=</span> <span class='base_x1 identifier id'>base_x1</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
      <span class='middle identifier id'>middle</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='plus op'>+</span> <span class='x1 identifier id'>x1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='float val'>2.0</span>
    <span class='else else kw'>else</span>
      <span class='y1 identifier id'>y1</span> <span class='assign token'>=</span> <span class='y0 identifier id'>y0</span>
    <span class='end end kw'>end</span>

    <span class='first_line identifier id'>first_line</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>

    <span class='comment val'># open an object here so that the text can be put in over the</span>
    <span class='comment val'># shading</span>
    <span class='tOID identifier id'>tOID</span> <span class='assign token'>=</span> <span class='__open_new_object__ identifier id'>__open_new_object__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='symbol val'>:none</span> <span class='eq op'>==</span> <span class='@shade_rows ivar id'>@shade_rows</span>

    <span class='cnt identifier id'>cnt</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='cnt identifier id'>cnt</span> <span class='assign token'>=</span> <span class='integer val'>1</span> <span class='unless unless_mod kw'>unless</span> <span class='@shade_headings ivar id'>@shade_headings</span>
    <span class='newPage identifier id'>newPage</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
    <span class='@data ivar id'>@data</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='row identifier id'>row</span><span class='bitor op'>|</span>
      <span class='cnt identifier id'>cnt</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
        <span class='comment val'># Start a transaction that will be used for this row to prevent it</span>
        <span class='comment val'># from being split.</span>
      <span class='unless unless kw'>unless</span> <span class='@split_rows ivar id'>@split_rows</span>
        <span class='pageStart identifier id'>pageStart</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='pageset identifier id'>pageset</span><span class='dot token'>.</span><span class='size identifier id'>size</span>

        <span class='columnStart identifier id'>columnStart</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='column_number identifier id'>column_number</span> <span class='if if_mod kw'>if</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='columns? fid id'>columns?</span>

        <span class='tg identifier id'>tg</span><span class='dot token'>.</span><span class='start_transaction identifier id'>start_transaction</span><span class='lparen token'>(</span><span class='symbol val'>:row</span><span class='rparen token'>)</span>
        <span class='row_orig identifier id'>row_orig</span> <span class='assign token'>=</span> <span class='row identifier id'>row</span>
        <span class='y_orig identifier id'>y_orig</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span>
        <span class='y0_orig identifier id'>y0_orig</span> <span class='assign token'>=</span> <span class='y0 identifier id'>y0</span>
        <span class='y1_orig identifier id'>y1_orig</span> <span class='assign token'>=</span> <span class='y1 identifier id'>y1</span>
      <span class='end end kw'>end</span> <span class='comment val'># unless @split_rows</span>

      <span class='ok identifier id'>ok</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
      <span class='second_turn identifier id'>second_turn</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
      <span class='loop identifier id'>loop</span> <span class='do do kw'>do</span> <span class='comment val'># while !abortTable and !ok</span>
        <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='abortTable identifier id'>abortTable</span> <span class='or or kw'>or</span> <span class='ok identifier id'>ok</span>

        <span class='mx identifier id'>mx</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
        <span class='newRow identifier id'>newRow</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>

        <span class='loop identifier id'>loop</span> <span class='do do kw'>do</span> <span class='comment val'># while !abortTable and (newPage or newRow)</span>
          <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='abortTable identifier id'>abortTable</span> <span class='or or kw'>or</span> <span class='not not kw'>not</span> <span class='lparen token'>(</span><span class='newPage identifier id'>newPage</span> <span class='or or kw'>or</span> <span class='newRow identifier id'>newRow</span><span class='rparen token'>)</span>

          <span class='y identifier id'>y</span> <span class='opasgn op'>-=</span> <span class='height identifier id'>height</span>
          <span class='low_y identifier id'>low_y</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='if if_mod kw'>if</span> <span class='low_y identifier id'>low_y</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span> <span class='y identifier id'>y</span> <span class='lt op'>&lt;</span> <span class='low_y identifier id'>low_y</span> 

          <span class='if if kw'>if</span> <span class='newPage identifier id'>newPage</span> <span class='or or kw'>or</span> <span class='y identifier id'>y</span> <span class='lt op'>&lt;</span> <span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_bottom_margin identifier id'>absolute_bottom_margin</span> <span class='plus op'>+</span> <span class='@minimum_space ivar id'>@minimum_space</span><span class='rparen token'>)</span>
              <span class='comment val'># check that enough rows are with the heading</span>
            <span class='moved_once identifier id'>moved_once</span> <span class='assign token'>=</span> <span class='abortTable identifier id'>abortTable</span> <span class='assign token'>=</span> <span class='true true kw'>true</span> <span class='if if_mod kw'>if</span> <span class='@protect_rows ivar id'>@protect_rows</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span> <span class='and and kw'>and</span> <span class='not not kw'>not</span> <span class='moved_once identifier id'>moved_once</span> <span class='and and kw'>and</span> <span class='cnt identifier id'>cnt</span> <span class='leq op'>&lt;=</span> <span class='@protect_rows ivar id'>@protect_rows</span>

            <span class='y2 identifier id'>y2</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='minus op'>-</span> <span class='mx identifier id'>mx</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='integer val'>2</span> <span class='mult op'>*</span> <span class='height identifier id'>height</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='descender identifier id'>descender</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='newRow identifier id'>newRow</span> <span class='integer val'>? </span><span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span> <span class='mult op'>*</span> <span class='height identifier id'>height</span>

            <span class='unless unless kw'>unless</span> <span class='symbol val'>:none</span> <span class='eq op'>==</span> <span class='@show_lines ivar id'>@show_lines</span>
              <span class='y0 identifier id'>y0</span> <span class='assign token'>=</span> <span class='y1 identifier id'>y1</span> <span class='unless unless_mod kw'>unless</span> <span class='@show_headings ivar id'>@show_headings</span>

              <span class='__table_draw_lines__ identifier id'>__table_draw_lines__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='comma token'>,</span> <span class='pos identifier id'>pos</span><span class='comma token'>,</span> <span class='@gap ivar id'>@gap</span><span class='comma token'>,</span> <span class='x0 identifier id'>x0</span><span class='comma token'>,</span> <span class='x1 identifier id'>x1</span><span class='comma token'>,</span> <span class='y0 identifier id'>y0</span><span class='comma token'>,</span> <span class='y1 identifier id'>y1</span><span class='comma token'>,</span> <span class='y2 identifier id'>y2</span><span class='comma token'>,</span>
                <span class='@line_color ivar id'>@line_color</span><span class='comma token'>,</span> <span class='@inner_line_style ivar id'>@inner_line_style</span><span class='comma token'>,</span> <span class='@outer_line_style ivar id'>@outer_line_style</span><span class='comma token'>,</span>
                <span class='@show_lines ivar id'>@show_lines</span><span class='rparen token'>)</span>
            <span class='end end kw'>end</span>

            <span class='unless unless kw'>unless</span> <span class='symbol val'>:none</span> <span class='eq op'>==</span> <span class='@shade_rows ivar id'>@shade_rows</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='close_object identifier id'>close_object</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='restore_state identifier id'>restore_state</span>
            <span class='end end kw'>end</span>

            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='start_new_page identifier id'>start_new_page</span>
            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='save_state identifier id'>save_state</span>

              <span class='comment val'># and the margins may have changed, this is due to the</span>
              <span class='comment val'># possibility of the columns being turned on as the columns are</span>
              <span class='comment val'># managed by manipulating the margins</span>
            <span class='dm identifier id'>dm</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_left_margin identifier id'>absolute_left_margin</span> <span class='minus op'>-</span> <span class='base_left_margin identifier id'>base_left_margin</span>
            <span class='base_pos identifier id'>base_pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span> <span class='rbrace token'>}</span>
            <span class='x0 identifier id'>x0</span> <span class='assign token'>=</span> <span class='base_x0 identifier id'>base_x0</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
            <span class='x1 identifier id'>x1</span> <span class='assign token'>=</span> <span class='base_x1 identifier id'>base_x1</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>

            <span class='tOID identifier id'>tOID</span> <span class='assign token'>=</span> <span class='__open_new_object__ identifier id'>__open_new_object__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='symbol val'>:none</span> <span class='eq op'>==</span> <span class='@shade_rows ivar id'>@shade_rows</span>

            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color! fid id'>fill_color!</span> <span class='@text_color ivar id'>@text_color</span>

            <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_top_margin identifier id'>absolute_top_margin</span> <span class='minus op'>-</span> <span class='@header_gap ivar id'>@header_gap</span>
            <span class='low_y identifier id'>low_y</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span>
            <span class='y0 identifier id'>y0</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='descender identifier id'>descender</span>
            <span class='mx identifier id'>mx</span> <span class='assign token'>=</span> <span class='integer val'>0</span>

            <span class='if if kw'>if</span> <span class='@show_headings ivar id'>@show_headings</span>
              <span class='old_y identifier id'>old_y</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span>

              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color identifier id'>fill_color</span> <span class='@heading_color ivar id'>@heading_color</span>
              <span class='_height identifier id'>_height</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='__table_column_headings__ identifier id'>__table_column_headings__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='comma token'>,</span> <span class='pos identifier id'>pos</span><span class='comma token'>,</span> <span class='max_width identifier id'>max_width</span><span class='comma token'>,</span>
                <span class='height identifier id'>height</span><span class='comma token'>,</span> <span class='descender identifier id'>descender</span><span class='comma token'>,</span> <span class='@row_gap ivar id'>@row_gap</span><span class='comma token'>,</span> <span class='@heading_font_size ivar id'>@heading_font_size</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='rparen token'>)</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color identifier id'>fill_color</span> <span class='@text_color ivar id'>@text_color</span>

              <span class='y0 identifier id'>y0</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='_height identifier id'>_height</span>
              <span class='y1 identifier id'>y1</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span>

              <span class='if if kw'>if</span> <span class='@shade_headings ivar id'>@shade_headings</span>
                <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color! fid id'>fill_color!</span> <span class='@shade_heading_color ivar id'>@shade_heading_color</span>
                <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='rectangle identifier id'>rectangle</span><span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='minus op'>-</span> <span class='@gap ivar id'>@gap</span> <span class='div op'>/</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='x1 identifier id'>x1</span> <span class='minus op'>-</span> <span class='x0 identifier id'>x0</span><span class='comma token'>,</span> <span class='_height identifier id'>_height</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='fill identifier id'>fill</span>
                <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color identifier id'>fill_color</span> <span class='@heading_color ivar id'>@heading_color</span>
                <span class='__table_column_headings__ identifier id'>__table_column_headings__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='comma token'>,</span> <span class='pos identifier id'>pos</span><span class='comma token'>,</span> <span class='max_width identifier id'>max_width</span><span class='comma token'>,</span> <span class='height identifier id'>height</span><span class='comma token'>,</span>
                                          <span class='descender identifier id'>descender</span><span class='comma token'>,</span> <span class='@row_gap ivar id'>@row_gap</span><span class='comma token'>,</span>
                                          <span class='@heading_font_size ivar id'>@heading_font_size</span><span class='comma token'>,</span> <span class='old_y identifier id'>old_y</span><span class='rparen token'>)</span>
                <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color identifier id'>fill_color</span> <span class='@text_color ivar id'>@text_color</span>
              <span class='end end kw'>end</span>

              <span class='dm identifier id'>dm</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_left_margin identifier id'>absolute_left_margin</span> <span class='minus op'>-</span> <span class='base_left_margin identifier id'>base_left_margin</span>
              <span class='base_pos identifier id'>base_pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span> <span class='rbrace token'>}</span>
              <span class='x0 identifier id'>x0</span> <span class='assign token'>=</span> <span class='base_x0 identifier id'>base_x0</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
              <span class='x1 identifier id'>x1</span> <span class='assign token'>=</span> <span class='base_x1 identifier id'>base_x1</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
              <span class='middle identifier id'>middle</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='plus op'>+</span> <span class='x1 identifier id'>x1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='float val'>2.0</span>
            <span class='else else kw'>else</span>
              <span class='y1 identifier id'>y1</span> <span class='assign token'>=</span> <span class='y0 identifier id'>y0</span>
            <span class='end end kw'>end</span>

            <span class='first_line identifier id'>first_line</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
            <span class='y identifier id'>y</span> <span class='opasgn op'>-=</span> <span class='height identifier id'>height</span>
            <span class='low_y identifier id'>low_y</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='if if_mod kw'>if</span> <span class='low_y identifier id'>low_y</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span> <span class='y identifier id'>y</span> <span class='lt op'>&lt;</span> <span class='low_y identifier id'>low_y</span> 
          <span class='end end kw'>end</span>

          <span class='newRow identifier id'>newRow</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>

            <span class='comment val'># Write the actual data. If these cells need to be split over</span>
            <span class='comment val'># a page, then newPage will be set, and the remaining text</span>
            <span class='comment val'># will be placed in leftOvers</span>
          <span class='newPage identifier id'>newPage</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
          <span class='leftOvers identifier id'>leftOvers</span> <span class='assign token'>=</span> <span class='PDF constant id'>PDF</span><span class='colon2 op'>::</span><span class='Writer constant id'>Writer</span><span class='colon2 op'>::</span><span class='OHash constant id'>OHash</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

          <span class='@cols ivar id'>@cols</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='column identifier id'>column</span><span class='bitor op'>|</span>
            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='pointer identifier id'>pointer</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='height identifier id'>height</span>
            <span class='colNewPage identifier id'>colNewPage</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>

            <span class='unless unless kw'>unless</span> <span class='row identifier id'>row</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
              <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='row identifier id'>row</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/\n/</span><span class='rparen token'>)</span>
              <span class='if if kw'>if</span> <span class='column identifier id'>column</span> <span class='and and kw'>and</span> <span class='column identifier id'>column</span><span class='dot token'>.</span><span class='link_name identifier id'>link_name</span>
                <span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='map! fid id'>map!</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='kk identifier id'>kk</span><span class='bitor op'>|</span>
                  <span class='link identifier id'>link</span> <span class='assign token'>=</span> <span class='row identifier id'>row</span><span class='lbrack token'>[</span><span class='column identifier id'>column</span><span class='dot token'>.</span><span class='link_name identifier id'>link_name</span><span class='rbrack token'>]</span>
                  <span class='if if kw'>if</span> <span class='link identifier id'>link</span>
                    <span class='dstring node'>&quot;&lt;c:alink uri='#{link}'&gt;#{kk}&lt;/c:alink&gt;&quot;</span>
                  <span class='else else kw'>else</span>
                    <span class='kk identifier id'>kk</span>
                  <span class='end end kw'>end</span>
                <span class='end end kw'>end</span>
              <span class='end end kw'>end</span>
            <span class='else else kw'>else</span>
              <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
            <span class='end end kw'>end</span>

            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span> <span class='opasgn op'>-=</span> <span class='@row_gap ivar id'>@row_gap</span>

            <span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='line identifier id'>line</span><span class='bitor op'>|</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='symbol val'>:preprocess_text</span><span class='comma token'>,</span> <span class='line identifier id'>line</span><span class='rparen token'>)</span>
              <span class='start identifier id'>start</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>

              <span class='loop identifier id'>loop</span> <span class='do do kw'>do</span>
                <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='line identifier id'>line</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span> <span class='line identifier id'>line</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='not not kw'>not</span> <span class='start identifier id'>start</span>
                <span class='start identifier id'>start</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>

                <span class='_y identifier id'>_y</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span> <span class='minus op'>-</span> <span class='height identifier id'>height</span> <span class='if if_mod kw'>if</span> <span class='not not kw'>not</span> <span class='colNewPage identifier id'>colNewPage</span>

                  <span class='comment val'># a new page is required</span>
                <span class='newPage identifier id'>newPage</span> <span class='assign token'>=</span> <span class='colNewPage identifier id'>colNewPage</span> <span class='assign token'>=</span> <span class='true true kw'>true</span> <span class='if if_mod kw'>if</span> <span class='_y identifier id'>_y</span> <span class='lt op'>&lt;</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_bottom_margin identifier id'>absolute_bottom_margin</span>

                <span class='if if kw'>if</span> <span class='colNewPage identifier id'>colNewPage</span>
                  <span class='if if kw'>if</span> <span class='leftOvers identifier id'>leftOvers</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
                    <span class='leftOvers identifier id'>leftOvers</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='line identifier id'>line</span><span class='rbrack token'>]</span>
                  <span class='else else kw'>else</span>
                    <span class='leftOvers identifier id'>leftOvers</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;\n#{line}&quot;</span>
                  <span class='end end kw'>end</span>
                  <span class='line identifier id'>line</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
                <span class='else else kw'>else</span>
                  <span class='if if kw'>if</span> <span class='column identifier id'>column</span> <span class='and and kw'>and</span> <span class='column identifier id'>column</span><span class='dot token'>.</span><span class='justification identifier id'>justification</span>
                    <span class='just identifier id'>just</span> <span class='assign token'>=</span> <span class='column identifier id'>column</span><span class='dot token'>.</span><span class='justification identifier id'>justification</span>
                  <span class='end end kw'>end</span>
                  <span class='just identifier id'>just</span> <span class='opasgn op'>||=</span> <span class='symbol val'>:left</span>

                  <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='_y identifier id'>_y</span>
                  <span class='line identifier id'>line</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='add_text_wrap identifier id'>add_text_wrap</span><span class='lparen token'>(</span><span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span><span class='comma token'>,</span>
                                           <span class='max_width identifier id'>max_width</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='line identifier id'>line</span><span class='comma token'>,</span>
                                           <span class='@font_size ivar id'>@font_size</span><span class='comma token'>,</span> <span class='just identifier id'>just</span><span class='rparen token'>)</span>
                <span class='end end kw'>end</span>
              <span class='end end kw'>end</span>
            <span class='end end kw'>end</span>

            <span class='dy identifier id'>dy</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='height identifier id'>height</span> <span class='minus op'>-</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='@row_gap ivar id'>@row_gap</span>
            <span class='mx identifier id'>mx</span> <span class='assign token'>=</span> <span class='dy identifier id'>dy</span> <span class='minus op'>-</span> <span class='height identifier id'>height</span> <span class='mult op'>*</span> <span class='lparen token'>(</span><span class='newPage identifier id'>newPage</span> <span class='integer val'>? </span><span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='dy identifier id'>dy</span> <span class='minus op'>-</span> <span class='height identifier id'>height</span> <span class='mult op'>*</span> <span class='lparen token'>(</span><span class='newPage identifier id'>newPage</span> <span class='integer val'>? </span><span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='gt op'>&gt;</span> <span class='mx identifier id'>mx</span>
          <span class='end end kw'>end</span>

            <span class='comment val'># Set row to leftOvers so that they will be processed onto the</span>
            <span class='comment val'># new page</span>
          <span class='row identifier id'>row</span> <span class='assign token'>=</span> <span class='leftOvers identifier id'>leftOvers</span>

          <span class='comment val'># Now add the shading underneath</span>
          <span class='unless unless kw'>unless</span> <span class='symbol val'>:none</span> <span class='eq op'>==</span> <span class='@shade_rows ivar id'>@shade_rows</span>
            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='close_object identifier id'>close_object</span>

            <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='cnt identifier id'>cnt</span> <span class='mod op'>%</span> <span class='integer val'>2</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='zero? fid id'>zero?</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color! fid id'>fill_color!</span><span class='lparen token'>(</span><span class='@shade_color ivar id'>@shade_color</span><span class='rparen token'>)</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='rectangle identifier id'>rectangle</span><span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='minus op'>-</span> <span class='@gap ivar id'>@gap</span> <span class='div op'>/</span> <span class='float val'>2.0</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='descender identifier id'>descender</span> <span class='plus op'>+</span> <span class='height identifier id'>height</span> <span class='minus op'>-</span> <span class='mx identifier id'>mx</span><span class='comma token'>,</span> <span class='x1 identifier id'>x1</span> <span class='minus op'>-</span> <span class='x0 identifier id'>x0</span><span class='comma token'>,</span> <span class='mx identifier id'>mx</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='fill identifier id'>fill</span>
            <span class='elsif elsif kw'>elsif</span> <span class='lparen token'>(</span><span class='cnt identifier id'>cnt</span> <span class='mod op'>%</span> <span class='integer val'>2</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span> <span class='and and kw'>and</span> <span class='symbol val'>:striped</span> <span class='eq op'>==</span> <span class='@shade_rows ivar id'>@shade_rows</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='fill_color! fid id'>fill_color!</span><span class='lparen token'>(</span><span class='@shade_color2 ivar id'>@shade_color2</span><span class='rparen token'>)</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='rectangle identifier id'>rectangle</span><span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='minus op'>-</span> <span class='@gap ivar id'>@gap</span> <span class='div op'>/</span> <span class='float val'>2.0</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='descender identifier id'>descender</span> <span class='plus op'>+</span> <span class='height identifier id'>height</span> <span class='minus op'>-</span> <span class='mx identifier id'>mx</span><span class='comma token'>,</span> <span class='x1 identifier id'>x1</span> <span class='minus op'>-</span> <span class='x0 identifier id'>x0</span><span class='comma token'>,</span> <span class='mx identifier id'>mx</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='fill identifier id'>fill</span>
            <span class='end end kw'>end</span>
            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='reopen_object identifier id'>reopen_object</span><span class='lparen token'>(</span><span class='tOID identifier id'>tOID</span><span class='rparen token'>)</span>
          <span class='end end kw'>end</span>

          <span class='if if kw'>if</span> <span class='symbol val'>:inner</span> <span class='eq op'>==</span> <span class='@show_lines ivar id'>@show_lines</span> <span class='or or kw'>or</span> <span class='symbol val'>:all</span> <span class='eq op'>==</span> <span class='@show_lines ivar id'>@show_lines</span>
            <span class='comment val'># draw a line on the top of the block</span>
            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='save_state identifier id'>save_state</span>
            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='stroke_color! fid id'>stroke_color!</span> <span class='@line_color ivar id'>@line_color</span>
            <span class='if if kw'>if</span> <span class='first_line identifier id'>first_line</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='stroke_style identifier id'>stroke_style</span> <span class='@outer_line_style ivar id'>@outer_line_style</span>
              <span class='first_line identifier id'>first_line</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
            <span class='else else kw'>else</span>
              <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='stroke_style identifier id'>stroke_style</span> <span class='@inner_line_style ivar id'>@inner_line_style</span>
            <span class='end end kw'>end</span>
            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='line identifier id'>line</span><span class='lparen token'>(</span><span class='x0 identifier id'>x0</span> <span class='minus op'>-</span> <span class='@gap ivar id'>@gap</span> <span class='div op'>/</span> <span class='float val'>2.0</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='descender identifier id'>descender</span> <span class='plus op'>+</span> <span class='height identifier id'>height</span><span class='comma token'>,</span> <span class='x1 identifier id'>x1</span> <span class='minus op'>-</span> <span class='@gap ivar id'>@gap</span> <span class='div op'>/</span> <span class='float val'>2.0</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='descender identifier id'>descender</span> <span class='plus op'>+</span> <span class='height identifier id'>height</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='stroke identifier id'>stroke</span>
            <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='restore_state identifier id'>restore_state</span>
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>

        <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='minus op'>-</span> <span class='mx identifier id'>mx</span> <span class='plus op'>+</span> <span class='height identifier id'>height</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span>
        <span class='low_y identifier id'>low_y</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='if if_mod kw'>if</span> <span class='low_y identifier id'>low_y</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='or or kw'>or</span> <span class='y identifier id'>y</span> <span class='lt op'>&lt;</span> <span class='low_y identifier id'>low_y</span> 

          <span class='comment val'># checking row split over pages</span>
        <span class='unless unless kw'>unless</span> <span class='@split_rows ivar id'>@split_rows</span>
          <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='pageset identifier id'>pageset</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='neq op'>!=</span> <span class='pageStart identifier id'>pageStart</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='columns? fid id'>columns?</span> <span class='and and kw'>and</span> <span class='columnStart identifier id'>columnStart</span> <span class='neq op'>!=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='column_number identifier id'>column_number</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='not not kw'>not</span> <span class='second_turn identifier id'>second_turn</span><span class='rparen token'>)</span>
            <span class='comment val'># then we need to go back and try that again!</span>
            <span class='newPage identifier id'>newPage</span> <span class='assign token'>=</span> <span class='second_turn identifier id'>second_turn</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
            <span class='tg identifier id'>tg</span><span class='dot token'>.</span><span class='rewind_transaction identifier id'>rewind_transaction</span><span class='lparen token'>(</span><span class='symbol val'>:row</span><span class='rparen token'>)</span>
            <span class='row identifier id'>row</span> <span class='assign token'>=</span> <span class='row_orig identifier id'>row_orig</span>
            <span class='low_y identifier id'>low_y</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='y_orig identifier id'>y_orig</span>
            <span class='y0 identifier id'>y0</span> <span class='assign token'>=</span> <span class='y0_orig identifier id'>y0_orig</span>
            <span class='y1 identifier id'>y1</span> <span class='assign token'>=</span> <span class='y1_orig identifier id'>y1_orig</span>
            <span class='ok identifier id'>ok</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>

            <span class='dm identifier id'>dm</span> <span class='assign token'>=</span> <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='absolute_left_margin identifier id'>absolute_left_margin</span> <span class='minus op'>-</span> <span class='base_left_margin identifier id'>base_left_margin</span>
            <span class='base_pos identifier id'>base_pos</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='pos identifier id'>pos</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span> <span class='rbrace token'>}</span>
            <span class='x0 identifier id'>x0</span> <span class='assign token'>=</span> <span class='base_x0 identifier id'>base_x0</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
            <span class='x1 identifier id'>x1</span> <span class='assign token'>=</span> <span class='base_x1 identifier id'>base_x1</span> <span class='plus op'>+</span> <span class='dm identifier id'>dm</span>
          <span class='else else kw'>else</span>
            <span class='tg identifier id'>tg</span><span class='dot token'>.</span><span class='commit_transaction identifier id'>commit_transaction</span><span class='lparen token'>(</span><span class='symbol val'>:row</span><span class='rparen token'>)</span>
            <span class='ok identifier id'>ok</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
          <span class='end end kw'>end</span>
        <span class='else else kw'>else</span>
          <span class='ok identifier id'>ok</span> <span class='assign token'>=</span> <span class='true true kw'>true</span> <span class='comment val'># don't go 'round the loop if splitting rows is allowed</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>

      <span class='if if kw'>if</span> <span class='abortTable identifier id'>abortTable</span>
          <span class='comment val'># abort_transaction if not ok only the outer transaction should</span>
          <span class='comment val'># be operational.</span>
        <span class='tg identifier id'>tg</span><span class='dot token'>.</span><span class='rewind_transaction identifier id'>rewind_transaction</span><span class='lparen token'>(</span><span class='symbol val'>:table</span><span class='rparen token'>)</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='start_new_page identifier id'>start_new_page</span>
          <span class='comment val'># fix a bug where a moved table will take up the whole page.</span>
        <span class='low_y identifier id'>low_y</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
        <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='save_state identifier id'>save_state</span>
        <span class='break break kw'>break</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='low_y identifier id'>low_y</span> <span class='leq op'>&lt;=</span> <span class='y identifier id'>y</span>
    <span class='y2 identifier id'>y2</span> <span class='assign token'>=</span> <span class='low_y identifier id'>low_y</span> <span class='plus op'>+</span> <span class='descender identifier id'>descender</span>
  <span class='else else kw'>else</span>
    <span class='y2 identifier id'>y2</span> <span class='assign token'>=</span> <span class='y identifier id'>y</span> <span class='plus op'>+</span> <span class='descender identifier id'>descender</span>
  <span class='end end kw'>end</span>

  <span class='unless unless kw'>unless</span> <span class='symbol val'>:none</span> <span class='eq op'>==</span> <span class='@show_lines ivar id'>@show_lines</span>
    <span class='y0 identifier id'>y0</span> <span class='assign token'>=</span> <span class='y1 identifier id'>y1</span> <span class='unless unless_mod kw'>unless</span> <span class='@show_headings ivar id'>@show_headings</span>

    <span class='__table_draw_lines__ identifier id'>__table_draw_lines__</span><span class='lparen token'>(</span><span class='pdf identifier id'>pdf</span><span class='comma token'>,</span> <span class='pos identifier id'>pos</span><span class='comma token'>,</span> <span class='@gap ivar id'>@gap</span><span class='comma token'>,</span> <span class='x0 identifier id'>x0</span><span class='comma token'>,</span> <span class='x1 identifier id'>x1</span><span class='comma token'>,</span> <span class='y0 identifier id'>y0</span><span class='comma token'>,</span> <span class='y1 identifier id'>y1</span><span class='comma token'>,</span> <span class='y2 identifier id'>y2</span><span class='comma token'>,</span> <span class='@line_color ivar id'>@line_color</span><span class='comma token'>,</span>
      <span class='@inner_line_style ivar id'>@inner_line_style</span><span class='comma token'>,</span> <span class='@outer_line_style ivar id'>@outer_line_style</span><span class='comma token'>,</span> <span class='@show_lines ivar id'>@show_lines</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># close the object for drawing the text on top</span>
  <span class='unless unless kw'>unless</span> <span class='symbol val'>:none</span> <span class='eq op'>==</span> <span class='@shade_rows ivar id'>@shade_rows</span>
    <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='close_object identifier id'>close_object</span>
    <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='restore_state identifier id'>restore_state</span>
  <span class='end end kw'>end</span>

  <span class='pdf identifier id'>pdf</span><span class='dot token'>.</span><span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='low_y identifier id'>low_y</span>

    <span class='comment val'># Table has been put on the page, the rows guarded as required; commit.</span>
  <span class='tg identifier id'>tg</span><span class='dot token'>.</span><span class='commit_transaction identifier id'>commit_transaction</span><span class='lparen token'>(</span><span class='symbol val'>:table</span><span class='rparen token'>)</span>

  <span class='y identifier id'>y</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ex identifier id'>ex</span>
  <span class='begin begin kw'>begin</span>
    <span class='tg identifier id'>tg</span><span class='dot token'>.</span><span class='abort_transaction identifier id'>abort_transaction</span><span class='lparen token'>(</span><span class='symbol val'>:table</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='tg identifier id'>tg</span><span class='dot token'>.</span><span class='transaction_open? fid id'>transaction_open?</span>
  <span class='rescue rescue kw'>rescue</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>
  <span class='raise identifier id'>raise</span> <span class='ex identifier id'>ex</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>