<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>kete's kete - Module: ExtendedContent - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/kete/commits/kete/master" rel="alternate" title="Recent Commits to kete:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    GitHubRepo.init("kete", "kete", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='kete/kete/blob/99f036ffce460efd4f5ee7794dfb7dce8a0e4bde' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='kete/kete/blob/99f036ffce460efd4f5ee7794dfb7dce8a0e4bde' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("kete", "kete", "99f036ffce460efd4f5ee7794dfb7dce8a0e4bde", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/kete/kete/tree/">Source</a></li>
            <li class=""><a href="http://github.com/kete/kete/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/kete/kete/network">Network</a></li>            
            <li class=""><a href="http://github.com/kete/kete/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/kete/kete">Wiki</a></li>
            <li class=""><a href="http://github.com/kete/kete/graphs">Graphs</a></li>                    
            <li class="active"><a href="/kete/kete">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/kete">kete</a> / <b><a href="http://github.com/kete/kete/tree">kete</a></b>        
                <a id="namespaces_button" rel="kete/kete/blob/99f036ffce460efd4f5ee7794dfb7dce8a0e4bde" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="kete/kete/blob/99f036ffce460efd4f5ee7794dfb7dce8a0e4bde" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module ExtendedContent">
  <h1>Module: ExtendedContent</h1>
  <div class="section docstring">
  <p>
ExtendedContent provides a way to access additional, extended content
directly on a model. (ExtendedContent is included in all Kete content
types.)
</p>
<p>
Extended Content definitions are configured separately by users with
ExtendedField records which are mapped to topic types or content types via
the TopicTypeToFieldMapping and ContentTypeToFieldMapping relationship
models. So, the relationships between item classes and extended fields is
something like AudioRecording -&gt; ContentTypeToFieldMapping(s) -&gt;
ExtendedField. In the case of Topics the relations are Topic -&gt;
TopicType -&gt; TopicTypeToFieldMapping(s) -&gt; ExtendedField. Refer to
the individual classes for more information.
</p>
<p>
On the model, extended content can be accessed by the
#extended_content_values accessor methods, and by the less efficient
individual accessor methods for each field. Behind the scenes the data
received as a Hash instance of values (or single value in the case of
accessor methods) is stored into a particular XML data structure in the
#extended_content attribute, which is present as a column in the item
class&#8217;s table.
</p>
<p>
XML Schema
</p>
<p>
Extended content is stored as XML in the #extended_content attribute in the
model. There are several conventions for how the XML is represented,
outlined below:
</p>
<p>
Items with single values are stored simply as follows:
&lt;field_label&gt;Value&lt;/field_label&gt;
</p>
<p>
Items with multiple values:
&lt;field_label_multiple&gt;&lt;1&gt;&lt;field_label&gt;Value&lt;/field_label&gt;&lt;/1&gt;&lt;2&gt;&lt;field_label&gt;Value
2&lt;/field_label&gt;&lt;/2&gt;&lt;/field_label_multiple&gt;
</p>
<p>
Choices with single values:
&lt;field_label&gt;&lt;1&gt;Value&lt;/1&gt;&lt;/field_label&gt;
</p>
<p>
Choices with multiple hierarchical values:
&lt;field_label&gt;&lt;1&gt;Value&lt;/1&gt;&lt;2&gt;Child of
value&lt;/2&gt;&lt;/field_label&gt;
</p>
<p>
Choices with multiple hierarchical values AND multiple values (i.e.
multiple different hierchical selections)
&lt;field_label_multiple&gt;&lt;1&gt;&lt;field_label&gt;&lt;1&gt;Value&lt;/1&gt;&lt;2&gt;Child
of value&lt;/2&gt;&lt;/field_label&gt;&lt;/1&gt; ..
</p>
<pre class="code">
  <span class='lt op'>&lt;</span><span class='integer val'>2</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='field_label identifier id'>field_label</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='integer val'>1</span><span class='gt op'>&gt;</span><span class='Value constant id'>Value</span><span class='lt op'>&lt;</span><span class='regexp val'>/1&gt;&lt;2&gt;Child of value&lt;/</span><span class='integer val'>2</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='regexp val'>/field_label&gt;&lt;/</span><span class='integer val'>2</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='regexp val'>/field_label_multiple&gt;
</span></pre>
<p>
Label/Value variation: Values are often what we want to match when we are
doing searches, etc. They are meant to be precise and can conform to
technical rules (e.g.
http://must_have_valid_protocol_and_domain/and/path/for/a_url/or/link/will/fail).
However, they often NOT what we want to be human facing. This is where a
corresponding label may come in.
</p>
<p>
For example, if I want to have an extended field for &quot;Father&quot; on
the &quot;Person&quot; Topic Type that links to a URL about the
person&#8217;s father, I probably don&#8217;t want to display
&quot;http://a_kete/site/topics/show/666-the-devil&quot;. I probably want
to display &quot;The Devil!&quot; and clicking on that takes me to the
appropriate topic, i.e. the URL.
</p>
<p>
The same can be said of forms. The user probably only wants to choose
&quot;The Devil!&quot; and not have to remember the exact URL to input. The
Choice model, in conjunction with the ExtendedField model, handles this in
&quot;Choices (dropdown)&quot; and &quot;Choices (autocomplete)&quot;
extended field ftypes. A choice may have a label (that the user sees) that
is different from the value (that the admin assigns the choice, but end
user doesn&#8217;t see) that gets saved to extended_content.
</p>
<p>
The problem is, how do you we get the label on the display side on an
item&#8217;s detail page when all that is submitted is the value?
</p>
<p>
We would like label, if it is different from value, to travel with the
value as it is used.
</p>
<ol>
<li>in forms, when value is different than label, we pass the form input value
of &quot;Label (Value)&quot;, unless otherwise handled (choices).

</li>
<li>when processing the form input in our model, via this module, we know to
split label and value using this convention

</li>
<li>model.extended_content we store the corresponding xml like so:

</li>
</ol>
<p>
Items with single values are stored simply as follows: &lt;field_label
label=&quot;Label&quot;&gt;Value&lt;/field_label&gt;
</p>
<p>
Items with multiple values:
&lt;field_label_multiple&gt;&lt;1&gt;&lt;field_label
label=&quot;Label&quot;&gt;Value&lt;/field_label&gt;&lt;/1&gt;&lt;2&gt;&lt;field_label
label=&quot;Label&quot;&gt;Value
2&lt;/field_label&gt;&lt;/2&gt;&lt;/field_label_multiple&gt;
</p>
<p>
Choices with single values: &lt;field_label&gt;&lt;1
label=&quot;Label&quot;&gt;Value&lt;/1&gt;&lt;/field_label&gt;
</p>
<p>
Choices with multiple hierarchical values: &lt;field_label&gt;&lt;1
label=&quot;Label&quot;&gt;Value&lt;/1&gt;&lt;2
label=&quot;Label&quot;&gt;Child of value&lt;/2&gt;&lt;/field_label&gt;
</p>
<p>
etc.
</p>
<p>
NOTE: a label attribute isn&#8217;t required for every value. So something
like this is valid:
</p>
<p>
Choices with multiple hierarchical values: &lt;field_label&gt;&lt;1
label=&quot;Label&quot;&gt;Value&lt;/1&gt;&lt;2&gt;Child of
value&lt;/2&gt;&lt;/field_label&gt;
</p>
<ol>
<li>when converting our xml to a hash for dealing with, we&#8217;ll have a
:label key/value pair.

</li>
</ol>
<p>
General notes on XML schema: XML element name for the OAI XML schema is
stored in the xml_element_name attribute in the XML tag, for instance:
&lt;field_name
xml_element_name=&quot;dc:description&quot;&gt;value&lt;/field_name&gt;
</p>
<p>
OAI XML Schema
</p>
<p>
The OAI XML Schema has a different representation to the internal XML
schema. The main differences are:
</p>
<ul>
<li>Where an XML element name has been declared in the ExtendedField record, it
is used as the tag name. For instance, &lt;field_name
xml_element_name=&quot;dc:subject&quot;&gt;value&lt;/field_name&gt; in the
internal XML is translated to &lt;dc:subject&gt;value&lt;/dc:subject&gt; in
the OAI XML.

</li>
<li>Where an XML element name is not given in the ExtendedField record, the
whole tag is wrapped verbatim in a dc:description tag. For instance,
&lt;field_name&gt;value&lt;/field_name&gt; translates to the following in
the OAI XML schema:
&lt;dc:description&gt;\n&lt;field_name&gt;value&lt;/field_name&gt;\n&lt;/dc:description&gt;.
Where multiple fields are missing XML element names, they are all wrapped
in a single dc:description tag.

</li>
<li>For values relating to the Choice ftypes are present, these are delimited
by colons. For instance, assuming that the ftype on the ExtendedField
record is a variation of Choice, a singular, single level selection would
be represented as follows: &lt;dc:description&gt;:choice
value:&lt;/dc:description&gt; (note the dc:description could be the field
name wrapped in a dc:description tag as mentioned in the point above in
some cases. Where hierarchical selections are present, the values are
presented as follows &lt;dc:description&gt;:first choice:child of first
choice:&lt;/dc:description&gt;.

</li>
</ul>

</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="CLASSES_WITH_SUMMARIES-constant">CLASSES_WITH_SUMMARIES</dt>
      <dd>['Topic', 'Document']</dd>
    
  </dl>
</div>

</div>
</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> Â©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>