<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: NewRelic::TransactionSample</title>
  </head>
  <body>
    <div id="content">
      <div class="section class NewRelic_TransactionSample">
  <h1 class="title">Class: NewRelic::TransactionSample</h1>
  <div class="section inheritance">
  <ul>
  <li><a href='../Object.html' title='Object'>Object</a></li><ul><li>NewRelic::TransactionSample</li>
  </ul></ul>
</div><div class="section mixins">
  <h1>Included Modules</h1>
  <p><a href='TransactionSample/TransactionAnalysis.html' title='NewRelic::TransactionAnalysis'>NewRelic::TransactionAnalysis</a></p>
</div><div class="section attributes">
  <h1>Attributes</h1>

  
    <div class="instance">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">params</td>
          <td class="readwrite">
            [<span id='params-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>params</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">root_segment</td>
          <td class="readwrite">
            [RW] 
          </td>
          <td class="visibility">
            protected
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>root_segment</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">sample_id</td>
          <td class="readwrite">
            [<span id='sample_id-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>sample_id</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div><div class="section constructor">
<h1>Constructor Summary</h1>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(time = Time.now.to_f, sample_id = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


284
285
286
287
288
289
290</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 284</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='time identifier id'>time</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span><span class='comma token'>,</span> <span class='sample_id identifier id'>sample_id</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='@sample_id ivar id'>@sample_id</span> <span class='assign token'>=</span> <span class='sample_id identifier id'>sample_id</span> <span class='orop op'>||</span> <span class='object_id identifier id'>object_id</span>
  <span class='@start_time ivar id'>@start_time</span> <span class='assign token'>=</span> <span class='time identifier id'>time</span>
  <span class='@root_segment ivar id'>@root_segment</span> <span class='assign token'>=</span> <span class='create_segment identifier id'>create_segment</span> <span class='integer val'>0</span><span class='integer val'>.0</span><span class='comma token'>,</span> <span class='string val'>&quot;ROOT&quot;</span>
  <span class='@params ivar id'>@params</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:request_params</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary class public">
    <h1>Public Class Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#close_connections-class_method' title='close_connections'>close_connections</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#get_connection-class_method' title='get_connection'>get_connection</a></span><span class='args'>(config)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#obfuscate_sql-class_method' title='obfuscate_sql'>obfuscate_sql</a></span><span class='args'>(sql)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#analyze-instance_method' title='#analyze'>#analyze</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#create_segment-instance_method' title='#create_segment'>#create_segment</a></span><span class='args'>(relative_timestamp, metric_name, segment_id = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#duration-instance_method' title='#duration'>#duration</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#each_segment-instance_method' title='#each_segment'>#each_segment</a></span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#find_segment-instance_method' title='#find_segment'>#find_segment</a></span><span class='args'>(id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#freeze-instance_method' title='#freeze'>#freeze</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#omit_segments_with-instance_method' title='#omit_segments_with'>#omit_segments_with</a></span><span class='args'>(regex)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
return a new transaction sample that treats segments with the given regular
expression in their name as if they were never called at all.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#path_string-instance_method' title='#path_string'>#path_string</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#prepare_to_send-instance_method' title='#prepare_to_send'>#prepare_to_send</a></span><span class='args'>(options={})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
return a new transaction sample that can be sent to the RPM service.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#start_time-instance_method' title='#start_time'>#start_time</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#to_s-instance_method' title='#to_s'>#to_s</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h1>Public Instance Methods Inherited from <a href='../Object.html' title='Object'>Object</a></h1>
    <p><span class='name'><a href='../Object.html#new_relic_load-instance_method' title='new_relic_load'>new_relic_load</a></span>, <span class='name'><a href='../Object.html#new_relic_require-instance_method' title='new_relic_require'>new_relic_require</a></span></p>
  </div>
  
</div>
<div class="clear"></div><div class="included">
  
  <div>
    <h1>Public Instance Methods Included from <a href='TransactionSample/TransactionAnalysis.html' title='NewRelic::TransactionAnalysis'>NewRelic::TransactionAnalysis</a></h1>
    <p><span class='name'><a href='TransactionAnalysis.html#breakdown_data-instance_method' title='breakdown_data'>breakdown_data</a></span>, <span class='name'><a href='TransactionAnalysis.html#database_time-instance_method' title='database_time'>database_time</a></span>, <span class='name'><a href='TransactionAnalysis.html#render_time-instance_method' title='render_time'>render_time</a></span>, <span class='name'><a href='TransactionAnalysis.html#sql_segments-instance_method' title='sql_segments'>sql_segments</a></span>, <span class='name'><a href='TransactionAnalysis.html#time_percentage-instance_method' title='time_percentage'>time_percentage</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails class public">
  <h1>Public Class Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>close_connections</h3>
</div><div id="close_connections-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>close_connections</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


265
266
267
268
269
270
271
272
273
274
275</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 265</span>

<span class='def def kw'>def</span> <span class='close_connections identifier id'>close_connections</span>
  <span class='@@connections ivar id'>@@connections</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@@connections ivar id'>@@connections</span><span class='dot token'>.</span><span class='values identifier id'>values</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='connection identifier id'>connection</span><span class='bitor op'>|</span>
    <span class='begin begin kw'>begin</span>
      <span class='connection identifier id'>connection</span><span class='dot token'>.</span><span class='disconnect! fid id'>disconnect!</span>
    <span class='rescue rescue kw'>rescue</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='@@connections ivar id'>@@connections</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_connection</h3>
</div><div id="get_connection-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_connection</span><span class='args'>(config)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 248</span>

<span class='def def kw'>def</span> <span class='get_connection identifier id'>get_connection</span><span class='lparen token'>(</span><span class='config identifier id'>config</span><span class='rparen token'>)</span>
  <span class='@@connections ivar id'>@@connections</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  
  <span class='connection identifier id'>connection</span> <span class='assign token'>=</span> <span class='@@connections ivar id'>@@connections</span><span class='lbrack token'>[</span><span class='config identifier id'>config</span><span class='rbrack token'>]</span>
  
  <span class='return return kw'>return</span> <span class='connection identifier id'>connection</span> <span class='if if_mod kw'>if</span> <span class='connection identifier id'>connection</span>
  
  <span class='begin begin kw'>begin</span>
    <span class='connection identifier id'>connection</span> <span class='assign token'>=</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{config[:adapter]}_connection&quot;</span><span class='comma token'>,</span> <span class='config identifier id'>config</span><span class='rparen token'>)</span>
    <span class='@@connections ivar id'>@@connections</span><span class='lbrack token'>[</span><span class='config identifier id'>config</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='connection identifier id'>connection</span>
  <span class='rescue rescue kw'>rescue</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
    <span class='NewRelic constant id'>NewRelic</span><span class='colon2 op'>::</span><span class='Agent constant id'>Agent</span><span class='dot token'>.</span><span class='agent identifier id'>agent</span><span class='dot token'>.</span><span class='log identifier id'>log</span><span class='dot token'>.</span><span class='error identifier id'>error</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Caught exception #{e} trying to get connection to DB for explain. Config: #{config}&quot;</span><span class='rparen token'>)</span>
    <span class='NewRelic constant id'>NewRelic</span><span class='colon2 op'>::</span><span class='Agent constant id'>Agent</span><span class='dot token'>.</span><span class='agent identifier id'>agent</span><span class='dot token'>.</span><span class='log identifier id'>log</span><span class='dot token'>.</span><span class='error identifier id'>error</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='backtrace identifier id'>backtrace</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>obfuscate_sql</h3>
</div><div id="obfuscate_sql-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>obfuscate_sql</span><span class='args'>(sql)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


243
244
245</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 243</span>

<span class='def def kw'>def</span> <span class='obfuscate_sql identifier id'>obfuscate_sql</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='rparen token'>)</span>
  <span class='NewRelic constant id'>NewRelic</span><span class='colon2 op'>::</span><span class='Agent constant id'>Agent</span><span class='dot token'>.</span><span class='instance identifier id'>instance</span><span class='dot token'>.</span><span class='obfuscator identifier id'>obfuscator</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='sql identifier id'>sql</span><span class='rparen token'>)</span> 
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div><div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>analyze</h3>
</div><div id="analyze-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>analyze</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


379
380
381
382
383
384
385
386
387
388
389
390
391</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 379</span>

<span class='def def kw'>def</span> <span class='analyze identifier id'>analyze</span>
  <span class='sample identifier id'>sample</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
  <span class='original_path_string identifier id'>original_path_string</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='loop identifier id'>loop</span> <span class='do do kw'>do</span>
    <span class='original_path_string identifier id'>original_path_string</span> <span class='assign token'>=</span> <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='path_string identifier id'>path_string</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
    <span class='new_sample identifier id'>new_sample</span> <span class='assign token'>=</span> <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='new_sample identifier id'>new_sample</span><span class='dot token'>.</span><span class='root_segment identifier id'>root_segment</span> <span class='assign token'>=</span> <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='root_segment identifier id'>root_segment</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='new_sample identifier id'>new_sample</span><span class='dot token'>.</span><span class='root_segment identifier id'>root_segment</span><span class='dot token'>.</span><span class='called_segments identifier id'>called_segments</span> <span class='assign token'>=</span> <span class='analyze_called_segments identifier id'>analyze_called_segments</span><span class='lparen token'>(</span><span class='root_segment identifier id'>root_segment</span><span class='dot token'>.</span><span class='called_segments identifier id'>called_segments</span><span class='rparen token'>)</span>
    <span class='sample identifier id'>sample</span> <span class='assign token'>=</span> <span class='new_sample identifier id'>new_sample</span>
    <span class='return return kw'>return</span> <span class='sample identifier id'>sample</span> <span class='if if_mod kw'>if</span> <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='path_string identifier id'>path_string</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='eq op'>==</span> <span class='original_path_string identifier id'>original_path_string</span>
  <span class='end end kw'>end</span>
  
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>create_segment</h3>
</div><div id="create_segment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create_segment</span><span class='args'>(relative_timestamp, metric_name, segment_id = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>TypeError</tt>]</span>
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


300
301
302
303</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 300</span>

<span class='def def kw'>def</span> <span class='create_segment identifier id'>create_segment</span> <span class='lparen token'>(</span><span class='relative_timestamp identifier id'>relative_timestamp</span><span class='comma token'>,</span> <span class='metric_name identifier id'>metric_name</span><span class='comma token'>,</span> <span class='segment_id identifier id'>segment_id</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;Frozen Transaction Sample&quot;</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='frozen? fid id'>frozen?</span>
  <span class='NewRelic constant id'>NewRelic</span><span class='colon2 op'>::</span><span class='TransactionSample constant id'>TransactionSample</span><span class='colon2 op'>::</span><span class='Segment constant id'>Segment</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='relative_timestamp identifier id'>relative_timestamp</span><span class='comma token'>,</span> <span class='metric_name identifier id'>metric_name</span><span class='comma token'>,</span> <span class='segment_id identifier id'>segment_id</span><span class='rparen token'>)</span>    
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>duration</h3>
</div><div id="duration-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>duration</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


311
312
313</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 311</span>

<span class='def def kw'>def</span> <span class='duration identifier id'>duration</span>
  <span class='root_segment identifier id'>root_segment</span><span class='dot token'>.</span><span class='duration identifier id'>duration</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>each_segment</h3>
</div><div id="each_segment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>each_segment</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


315
316
317</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 315</span>

<span class='def def kw'>def</span> <span class='each_segment identifier id'>each_segment</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='@root_segment ivar id'>@root_segment</span><span class='dot token'>.</span><span class='each_segment identifier id'>each_segment</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>find_segment</h3>
</div><div id="find_segment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>find_segment</span><span class='args'>(id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


319
320
321</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 319</span>

<span class='def def kw'>def</span> <span class='find_segment identifier id'>find_segment</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='@root_segment ivar id'>@root_segment</span><span class='dot token'>.</span><span class='find_segment identifier id'>find_segment</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>freeze</h3>
</div><div id="freeze-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>freeze</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


305
306
307
308
309</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 305</span>

<span class='def def kw'>def</span> <span class='freeze identifier id'>freeze</span>
  <span class='@root_segment ivar id'>@root_segment</span><span class='dot token'>.</span><span class='freeze identifier id'>freeze</span>
  <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='freeze identifier id'>freeze</span>
  <span class='super super kw'>super</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>omit_segments_with</h3>
</div><div id="omit_segments_with-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>omit_segments_with</span><span class='args'>(regex)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
return a new transaction sample that treats segments with the given regular
expression in their name as if they were never called at all. This allows
us to strip out segments from traces captured in development environment
that would not normally show up in production (like Rails/Application Code
Loading)
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


346
347
348
349
350
351
352
353
354
355
356</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 346</span>

<span class='def def kw'>def</span> <span class='omit_segments_with identifier id'>omit_segments_with</span><span class='lparen token'>(</span><span class='regex identifier id'>regex</span><span class='rparen token'>)</span>
  <span class='regex identifier id'>regex</span> <span class='assign token'>=</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='regex identifier id'>regex</span><span class='rparen token'>)</span>
  
  <span class='sample identifier id'>sample</span> <span class='assign token'>=</span> <span class='TransactionSample constant id'>TransactionSample</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='@start_time ivar id'>@start_time</span><span class='comma token'>,</span> <span class='sample_id identifier id'>sample_id</span><span class='rparen token'>)</span>
  
  <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span><span class='rbrace token'>}</span>
    
  <span class='delta identifier id'>delta</span> <span class='assign token'>=</span> <span class='build_segment_with_omissions identifier id'>build_segment_with_omissions</span><span class='lparen token'>(</span><span class='sample identifier id'>sample</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='integer val'>.0</span><span class='comma token'>,</span> <span class='@root_segment ivar id'>@root_segment</span><span class='comma token'>,</span> <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='root_segment identifier id'>root_segment</span><span class='comma token'>,</span> <span class='regex identifier id'>regex</span><span class='rparen token'>)</span>
  <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='root_segment identifier id'>root_segment</span><span class='dot token'>.</span><span class='end_trace identifier id'>end_trace</span><span class='lparen token'>(</span><span class='@root_segment ivar id'>@root_segment</span><span class='dot token'>.</span><span class='exit_timestamp identifier id'>exit_timestamp</span> <span class='minus op'>-</span> <span class='delta identifier id'>delta</span><span class='rparen token'>)</span> 
  <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='freeze identifier id'>freeze</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>path_string</h3>
</div><div id="path_string-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>path_string</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


296
297
298</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 296</span>

<span class='def def kw'>def</span> <span class='path_string identifier id'>path_string</span>
  <span class='@root_segment ivar id'>@root_segment</span><span class='dot token'>.</span><span class='path_string identifier id'>path_string</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>prepare_to_send</h3>
</div><div id="prepare_to_send-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>prepare_to_send</span><span class='args'>(options={})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
return a new transaction sample that can be sent to the RPM service. this
involves potentially one or more of the following options
</p>
<pre class="code">
  <span class='symbol val'>:explain_sql</span> <span class='colon op'>:</span> <span class='run identifier id'>run</span> <span class='EXPLAIN constant id'>EXPLAIN</span> <span class='on identifier id'>on</span> <span class='all identifier id'>all</span> <span class='queries identifier id'>queries</span> <span class='whose identifier id'>whose</span> <span class='response identifier id'>response</span> <span class='times identifier id'>times</span> <span class='equal identifier id'>equal</span> <span class='the identifier id'>the</span> <span class='value identifier id'>value</span> <span class='for for kw'>for</span> <span class='this identifier id'>this</span> <span class='key identifier id'>key</span>
      <span class='lparen token'>(</span><span class='for for kw'>for</span> <span class='example identifier id'>example</span> <span class='colon op'>:</span><span class='explain_sql identifier id'>explain_sql</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='float val'>2.0</span> <span class='would identifier id'>would</span> <span class='explain identifier id'>explain</span> <span class='everything identifier id'>everything</span> <span class='over identifier id'>over</span> <span class='integer val'>2</span> <span class='seconds identifier id'>seconds</span><span class='dot token'>.</span>  <span class='integer val'>0</span><span class='integer val'>.0</span> <span class='would identifier id'>would</span> <span class='explain identifier id'>explain</span> <span class='everything identifier id'>everything</span><span class='dot token'>.</span><span class='rparen token'>)</span>
  <span class='symbol val'>:keep_backtraces</span> <span class='colon op'>:</span> <span class='keep identifier id'>keep</span> <span class='backtraces identifier id'>backtraces</span><span class='comma token'>,</span> <span class='significantly identifier id'>significantly</span> <span class='increasing identifier id'>increasing</span> <span class='size identifier id'>size</span> <span class='of identifier id'>of</span> <span class='trace identifier id'>trace</span> <span class='lparen token'>(</span><span class='off identifier id'>off</span> <span class='by identifier id'>by</span> <span class='default identifier id'>default</span><span class='rparen token'>)</span>
  <span class='symbol val'>:obfuscate_sql</span> <span class='colon op'>:</span> <span class='clear identifier id'>clear</span> <span class='sql identifier id'>sql</span> <span class='fields identifier id'>fields</span> <span class='of identifier id'>of</span> <span class='potentially identifier id'>potentially</span> <span class='sensitive identifier id'>sensitive</span> <span class='values identifier id'>values</span> <span class='lparen token'>(</span><span class='higher identifier id'>higher</span> <span class='overhead identifier id'>overhead</span><span class='comma token'>,</span> <span class='better identifier id'>better</span> <span class='security identifier id'>security</span><span class='rparen token'>)</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


364
365
366
367
368
369
370
371
372
373
374
375
376
377</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 364</span>

<span class='def def kw'>def</span> <span class='prepare_to_send identifier id'>prepare_to_send</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='sample identifier id'>sample</span> <span class='assign token'>=</span> <span class='TransactionSample constant id'>TransactionSample</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='@start_time ivar id'>@start_time</span><span class='comma token'>,</span> <span class='sample_id identifier id'>sample_id</span><span class='rparen token'>)</span>
  
  <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='params identifier id'>params</span><span class='dot token'>.</span><span class='merge! fid id'>merge!</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='params identifier id'>params</span>
  
  <span class='begin begin kw'>begin</span>
    <span class='build_segment_for_transfer identifier id'>build_segment_for_transfer</span><span class='lparen token'>(</span><span class='sample identifier id'>sample</span><span class='comma token'>,</span> <span class='@root_segment ivar id'>@root_segment</span><span class='comma token'>,</span> <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='root_segment identifier id'>root_segment</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='ensure ensure kw'>ensure</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='close_connections identifier id'>close_connections</span>
  <span class='end end kw'>end</span>
  
  <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='root_segment identifier id'>root_segment</span><span class='dot token'>.</span><span class='end_trace identifier id'>end_trace</span><span class='lparen token'>(</span><span class='@root_segment ivar id'>@root_segment</span><span class='dot token'>.</span><span class='exit_timestamp identifier id'>exit_timestamp</span><span class='rparen token'>)</span> 
  <span class='sample identifier id'>sample</span><span class='dot token'>.</span><span class='freeze identifier id'>freeze</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>start_time</h3>
</div><div id="start_time-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>start_time</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


292
293
294</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 292</span>

<span class='def def kw'>def</span> <span class='start_time identifier id'>start_time</span>
  <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='at identifier id'>at</span><span class='lparen token'>(</span><span class='@start_time ivar id'>@start_time</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_s</h3>
</div><div id="to_s-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_s</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/new_relic/transaction_sample.rb', line 323</span>

<span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span>
  <span class='s identifier id'>s</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Transaction Sample collected at #{start_time}\n&quot;</span>
  <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;  {\n&quot;</span>
  <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;  Path: #{params[:path]} \n&quot;</span>
  
  <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span><span class='v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='next next kw'>next</span> <span class='if if_mod kw'>if</span> <span class='k identifier id'>k</span> <span class='eq op'>==</span> <span class='symbol val'>:path</span>
    <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;  #{k}: &quot;</span> <span class='lshft op'>&lt;&lt;</span>
    <span class='case case kw'>case</span> <span class='v identifier id'>v</span>
      <span class='when when kw'>when</span> <span class='Enumerable constant id'>Enumerable</span><span class='semicolon token'>;</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='symbol val'>:to_s</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;; &quot;</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='v identifier id'>v</span>
    <span class='end end kw'>end</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;\n&quot;</span>
  <span class='end end kw'>end</span>
  <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;  }\n\n&quot;</span>
  <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span>  <span class='@root_segment ivar id'>@root_segment</span><span class='dot token'>.</span><span class='to_debug_str identifier id'>to_debug_str</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>