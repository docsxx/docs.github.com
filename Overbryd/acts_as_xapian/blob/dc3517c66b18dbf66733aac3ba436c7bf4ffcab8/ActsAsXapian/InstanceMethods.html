<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>Overbryd's acts_as_xapian - Module: ActsAsXapian::InstanceMethods - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/Overbryd/commits/acts_as_xapian/master" rel="alternate" title="Recent Commits to acts_as_xapian:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("Overbryd", "acts_as_xapian", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("Overbryd", "acts_as_xapian", "dc3517c66b18dbf66733aac3ba436c7bf4ffcab8", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/Overbryd/acts_as_xapian/tree/">Source</a></li>
            <li class=""><a href="http://github.com/Overbryd/acts_as_xapian/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/Overbryd/acts_as_xapian/network">Network</a></li>            
            <li class=""><a href="http://github.com/Overbryd/acts_as_xapian/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/Overbryd/acts_as_xapian">Wiki</a></li>
            <li class=""><a href="http://github.com/Overbryd/acts_as_xapian/graphs">Graphs</a></li>                    
            <li class="active"><a href="/Overbryd/acts_as_xapian">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/Overbryd">Overbryd</a> / <b><a href="http://github.com/Overbryd/acts_as_xapian/tree">acts_as_xapian</a></b>        
                <a id="namespaces_button" rel="Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module ActsAsXapian_InstanceMethods">
  <h1>Module: ActsAsXapian::InstanceMethods</h1>
  <div class="section docstring">
  <p>
Instance methods that get injected into your model.
</p>

</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#xapian_destroy-instance_method">#xapian_destroy</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Delete record from the Xapian database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#xapian_document_term-instance_method">#xapian_document_term</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Used internally.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#xapian_index-instance_method">#xapian_index</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Store record in the Xapian database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#xapian_mark_needs_destroy-instance_method">#xapian_mark_needs_destroy</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#xapian_mark_needs_index-instance_method">#xapian_mark_needs_index</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Used to mark changes needed by batch indexer.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#xapian_value-instance_method">#xapian_value</span><span class='args'>(field, type = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Extract value of a field from the model.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>xapian_destroy</h3>
</div><div id="xapian_destroy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>xapian_destroy</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Delete record from the Xapian database
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/acts_as_xapian.rb', line 664</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8/lib/acts_as_xapian.rb#L664">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">664
665
666</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='xapian_destroy identifier id'>xapian_destroy</span>
    <span class='ActsAsXapian constant id'>ActsAsXapian</span><span class='dot token'>.</span><span class='writable_db identifier id'>writable_db</span><span class='dot token'>.</span><span class='delete_document identifier id'>delete_document</span><span class='lparen token'>(</span><span class='string val'>&quot;I&quot;</span> <span class='plus op'>+</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='xapian_document_term identifier id'>xapian_document_term</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>xapian_document_term</h3>
</div><div id="xapian_document_term-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>xapian_document_term</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Used internally
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/acts_as_xapian.rb', line 600</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8/lib/acts_as_xapian.rb#L600">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">600
601
602</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='xapian_document_term identifier id'>xapian_document_term</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='string val'>&quot;-&quot;</span> <span class='plus op'>+</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='id identifier id'>id</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>xapian_index</h3>
</div><div id="xapian_index-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>xapian_index</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Store record in the Xapian database
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/acts_as_xapian.rb', line 623</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8/lib/acts_as_xapian.rb#L623">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='xapian_index identifier id'>xapian_index</span>
    <span class='comment val'># if we have a conditional function for indexing, call it and destory object if failed</span>
    <span class='if if kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='xapian_options identifier id'>xapian_options</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='symbol val'>:if</span><span class='rparen token'>)</span>
        <span class='if_value identifier id'>if_value</span> <span class='assign token'>=</span> <span class='xapian_value identifier id'>xapian_value</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='xapian_options identifier id'>xapian_options</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:boolean</span><span class='rparen token'>)</span>
        <span class='if if kw'>if</span> <span class='not not kw'>not</span> <span class='if_value identifier id'>if_value</span>
            <span class='self self kw'>self</span><span class='dot token'>.</span><span class='xapian_destroy identifier id'>xapian_destroy</span>
            <span class='return return kw'>return</span>
        <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># otherwise (re)write the Xapian record for the object</span>
    <span class='doc identifier id'>doc</span> <span class='assign token'>=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='Document constant id'>Document</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='ActsAsXapian constant id'>ActsAsXapian</span><span class='dot token'>.</span><span class='term_generator identifier id'>term_generator</span><span class='dot token'>.</span><span class='document identifier id'>document</span> <span class='assign token'>=</span> <span class='doc identifier id'>doc</span>

    <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='xapian_document_term identifier id'>xapian_document_term</span>

    <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='add_term identifier id'>add_term</span><span class='lparen token'>(</span><span class='string val'>&quot;M&quot;</span> <span class='plus op'>+</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rparen token'>)</span>
    <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='add_term identifier id'>add_term</span><span class='lparen token'>(</span><span class='string val'>&quot;I&quot;</span> <span class='plus op'>+</span> <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='data identifier id'>data</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='xapian_options identifier id'>xapian_options</span><span class='lbrack token'>[</span><span class='symbol val'>:terms</span><span class='rbrack token'>]</span>
      <span class='for for kw'>for</span> <span class='term identifier id'>term</span> <span class='in in kw'>in</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='xapian_options identifier id'>xapian_options</span><span class='lbrack token'>[</span><span class='symbol val'>:terms</span><span class='rbrack token'>]</span>
          <span class='ActsAsXapian constant id'>ActsAsXapian</span><span class='dot token'>.</span><span class='term_generator identifier id'>term_generator</span><span class='dot token'>.</span><span class='increase_termpos identifier id'>increase_termpos</span> <span class='comment val'># stop phrases spanning different text fields</span>
          <span class='ActsAsXapian constant id'>ActsAsXapian</span><span class='dot token'>.</span><span class='term_generator identifier id'>term_generator</span><span class='dot token'>.</span><span class='index_text identifier id'>index_text</span><span class='lparen token'>(</span><span class='xapian_value identifier id'>xapian_value</span><span class='lparen token'>(</span><span class='term identifier id'>term</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='term identifier id'>term</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='xapian_options identifier id'>xapian_options</span><span class='lbrack token'>[</span><span class='symbol val'>:values</span><span class='rbrack token'>]</span>
      <span class='for for kw'>for</span> <span class='value identifier id'>value</span> <span class='in in kw'>in</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='xapian_options identifier id'>xapian_options</span><span class='lbrack token'>[</span><span class='symbol val'>:values</span><span class='rbrack token'>]</span>
          <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='add_value identifier id'>add_value</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='xapian_value identifier id'>xapian_value</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span> 
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='xapian_options identifier id'>xapian_options</span><span class='lbrack token'>[</span><span class='symbol val'>:texts</span><span class='rbrack token'>]</span>
      <span class='for for kw'>for</span> <span class='text identifier id'>text</span> <span class='in in kw'>in</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='xapian_options identifier id'>xapian_options</span><span class='lbrack token'>[</span><span class='symbol val'>:texts</span><span class='rbrack token'>]</span>
          <span class='ActsAsXapian constant id'>ActsAsXapian</span><span class='dot token'>.</span><span class='term_generator identifier id'>term_generator</span><span class='dot token'>.</span><span class='increase_termpos identifier id'>increase_termpos</span> <span class='comment val'># stop phrases spanning different text fields</span>
          <span class='comment val'># XXX the &quot;1&quot; here is a weight that could be varied for a boost function</span>
          <span class='ActsAsXapian constant id'>ActsAsXapian</span><span class='dot token'>.</span><span class='term_generator identifier id'>term_generator</span><span class='dot token'>.</span><span class='index_text identifier id'>index_text</span><span class='lparen token'>(</span><span class='xapian_value identifier id'>xapian_value</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rparen token'>)</span> 
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='ActsAsXapian constant id'>ActsAsXapian</span><span class='dot token'>.</span><span class='writable_db identifier id'>writable_db</span><span class='dot token'>.</span><span class='replace_document identifier id'>replace_document</span><span class='lparen token'>(</span><span class='string val'>&quot;I&quot;</span> <span class='plus op'>+</span> <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='data identifier id'>data</span><span class='comma token'>,</span> <span class='doc identifier id'>doc</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>xapian_mark_needs_destroy</h3>
</div><div id="xapian_mark_needs_destroy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>xapian_mark_needs_destroy</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/acts_as_xapian.rb', line 681</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8/lib/acts_as_xapian.rb#L681">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">681
682
683
684
685
686
687
688
689
690
691
692</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='xapian_mark_needs_destroy identifier id'>xapian_mark_needs_destroy</span>
    <span class='model identifier id'>model</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='base_class identifier id'>base_class</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
    <span class='model_id identifier id'>model_id</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='id identifier id'>id</span>
    <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='transaction identifier id'>transaction</span> <span class='do do kw'>do</span>
        <span class='found identifier id'>found</span> <span class='assign token'>=</span> <span class='ActsAsXapianJob constant id'>ActsAsXapianJob</span><span class='dot token'>.</span><span class='delete_all identifier id'>delete_all</span><span class='lparen token'>(</span><span class='lbrack token'>[</span> <span class='string val'>&quot;model = ? and model_id = ?&quot;</span><span class='comma token'>,</span> <span class='model identifier id'>model</span><span class='comma token'>,</span> <span class='model_id identifier id'>model_id</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
        <span class='job identifier id'>job</span> <span class='assign token'>=</span> <span class='ActsAsXapianJob constant id'>ActsAsXapianJob</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
        <span class='job identifier id'>job</span><span class='dot token'>.</span><span class='model identifier id'>model</span> <span class='assign token'>=</span> <span class='model identifier id'>model</span>
        <span class='job identifier id'>job</span><span class='dot token'>.</span><span class='model_id identifier id'>model_id</span> <span class='assign token'>=</span> <span class='model_id identifier id'>model_id</span>
        <span class='job identifier id'>job</span><span class='dot token'>.</span><span class='action identifier id'>action</span> <span class='assign token'>=</span> <span class='string val'>'destroy'</span>
        <span class='job identifier id'>job</span><span class='dot token'>.</span><span class='save! fid id'>save!</span>
    <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>xapian_mark_needs_index</h3>
</div><div id="xapian_mark_needs_index-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>xapian_mark_needs_index</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Used to mark changes needed by batch indexer
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/acts_as_xapian.rb', line 669</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8/lib/acts_as_xapian.rb#L669">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">669
670
671
672
673
674
675
676
677
678
679
680</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='xapian_mark_needs_index identifier id'>xapian_mark_needs_index</span>
    <span class='model identifier id'>model</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='base_class identifier id'>base_class</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
    <span class='model_id identifier id'>model_id</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='id identifier id'>id</span>
    <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='transaction identifier id'>transaction</span> <span class='do do kw'>do</span>
        <span class='found identifier id'>found</span> <span class='assign token'>=</span> <span class='ActsAsXapianJob constant id'>ActsAsXapianJob</span><span class='dot token'>.</span><span class='delete_all identifier id'>delete_all</span><span class='lparen token'>(</span><span class='lbrack token'>[</span> <span class='string val'>&quot;model = ? and model_id = ?&quot;</span><span class='comma token'>,</span> <span class='model identifier id'>model</span><span class='comma token'>,</span> <span class='model_id identifier id'>model_id</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
        <span class='job identifier id'>job</span> <span class='assign token'>=</span> <span class='ActsAsXapianJob constant id'>ActsAsXapianJob</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
        <span class='job identifier id'>job</span><span class='dot token'>.</span><span class='model identifier id'>model</span> <span class='assign token'>=</span> <span class='model identifier id'>model</span>
        <span class='job identifier id'>job</span><span class='dot token'>.</span><span class='model_id identifier id'>model_id</span> <span class='assign token'>=</span> <span class='model_id identifier id'>model_id</span>
        <span class='job identifier id'>job</span><span class='dot token'>.</span><span class='action identifier id'>action</span> <span class='assign token'>=</span> <span class='string val'>'update'</span>
        <span class='job identifier id'>job</span><span class='dot token'>.</span><span class='save! fid id'>save!</span>
    <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>xapian_value</h3>
</div><div id="xapian_value-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>xapian_value</span><span class='args'>(field, type = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Extract value of a field from the model
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/acts_as_xapian.rb', line 605</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Overbryd/acts_as_xapian/blob/dc3517c66b18dbf66733aac3ba436c7bf4ffcab8/lib/acts_as_xapian.rb#L605">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='xapian_value identifier id'>xapian_value</span><span class='lparen token'>(</span><span class='field identifier id'>field</span><span class='comma token'>,</span> <span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='lbrack token'>[</span><span class='field identifier id'>field</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='field identifier id'>field</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:date</span>
        <span class='if if kw'>if</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='rparen token'>)</span>
            <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='utc identifier id'>utc</span><span class='dot token'>.</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>&quot;%Y%m%d&quot;</span><span class='rparen token'>)</span>
        <span class='elsif elsif kw'>elsif</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Date constant id'>Date</span><span class='rparen token'>)</span>
            <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='to_time identifier id'>to_time</span><span class='dot token'>.</span><span class='utc identifier id'>utc</span><span class='dot token'>.</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>&quot;%Y%m%d&quot;</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
            <span class='raise identifier id'>raise</span> <span class='string val'>&quot;Only Time or Date types supported by acts_as_xapian for :date fields, got &quot;</span> <span class='plus op'>+</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
        <span class='end end kw'>end</span>
    <span class='elsif elsif kw'>elsif</span> <span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:boolean</span>
        <span class='value identifier id'>value</span> <span class='integer val'>? </span><span class='true true kw'>true</span> <span class='colon op'>:</span> <span class='false false kw'>false</span>
    <span class='else else kw'>else</span>
        <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
    <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> Â©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>