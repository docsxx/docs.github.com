<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: ActiveMerchant::Billing::PaymentExpressGateway</title>
  </head>
  <body>
    <div id="content">
      <div class="section class ActiveMerchant_Billing_PaymentExpressGateway">
  <h1 class="title">Class: ActiveMerchant::Billing::PaymentExpressGateway</h1>
  <div class="section inheritance">
  <ul>
  <li><a href='Gateway.html' title='ActiveMerchant::Billing::Gateway'>ActiveMerchant::Billing::Gateway</a></li><ul><li>ActiveMerchant::Billing::PaymentExpressGateway</li>
  </ul></ul>
</div><div class="section docstring">
  <p>
In NZ DPS supports ANZ, Westpac, National Bank, ASB and BNZ. In Australia
DPS supports ANZ, NAB, Westpac, CBA, St George and Bank of South Australia.
The Maybank in Malaysia is supported and the Citibank for Singapore.
</p>

</div><div class="section constants">
  <div class="thisclass">
  <h1>Constants</h1>
  <dl>
    
      <dt id="APPROVED-constant">APPROVED</dt>
      <dd>'1'</dd>
    
      <dt id="TRANSACTIONS-constant">TRANSACTIONS</dt>
      <dd>{        :purchase       =&gt; 'Purchase',        :credit         =&gt; 'Refund',        :authorization  =&gt; 'Auth',        :capture        =&gt; 'Complete',        :validate       =&gt; 'Validate'      }</dd>
    
      <dt id="URL-constant">URL</dt>
      <dd>'https://www.paymentexpress.com/pxpost.aspx'</dd>
    
  </dl>
</div>
<div class="inherited">
  
  <div>
    <h1>Constants Inherited from <a href='Gateway.html' title='ActiveMerchant::Billing::Gateway'>ActiveMerchant::Billing::Gateway</a></h1>
    <p><span class='name'><a href='Gateway.html#DEBIT_CARDS-constant' title='DEBIT_CARDS'>DEBIT_CARDS</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
</div><div class="section constructor">
<h1>Constructor Summary</h1>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
We require the DPS gateway username and password when the object is
created.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


37
38
39
40
41
42
43</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/active_merchant/billing/gateways/payment_express.rb', line 37</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='comment val'># A DPS username and password must exist </span>
  <span class='requires! fid id'>requires!</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='symbol val'>:login</span><span class='comma token'>,</span> <span class='symbol val'>:password</span><span class='rparen token'>)</span>
  <span class='comment val'># Make the options an instance variable</span>
  <span class='@options ivar id'>@options</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span>
  <span class='super super kw'>super</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary class public">
    <div class="inherited">
  
  <div>
    <h1>Public Class Methods Inherited from <a href='Gateway.html' title='ActiveMerchant::Billing::Gateway'>ActiveMerchant::Billing::Gateway</a></h1>
    <p><span class='name'><a href='Gateway.html#card_brand-class_method' title='card_brand'>card_brand</a></span>, <span class='name'><a href='Gateway.html#inherited-class_method' title='inherited'>inherited</a></span>, <span class='name'><a href='Gateway.html#supports%3F-class_method' title='supports?'>supports?</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#authorize-instance_method' title='#authorize'>#authorize</a></span><span class='args'>(money, credit_card, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
NOTE: Perhaps in options we allow a transaction note to be inserted
Verifies that funds are available for the requested card and amount and
reserves the specified amount.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#capture-instance_method' title='#capture'>#capture</a></span><span class='args'>(money, identification, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Transfer pre-authorized funds immediately See: http://www.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#credit-instance_method' title='#credit'>#credit</a></span><span class='args'>(money, identification, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Refund funds to the card holder.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#purchase-instance_method' title='#purchase'>#purchase</a></span><span class='args'>(money, payment_source, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Funds are transferred immediately.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#store-instance_method' title='#store'>#store</a></span><span class='args'>(credit_card, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
token based billing initiates a &quot;Validate&quot; transcation to store
card data on payment express servers returns a &quot;token&quot; that can
be used to rebill this card see: http://www.
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h1>Public Instance Methods Inherited from <a href='Gateway.html' title='ActiveMerchant::Billing::Gateway'>ActiveMerchant::Billing::Gateway</a></h1>
    <p><span class='name'><a href='Gateway.html#amount-instance_method' title='amount'>amount</a></span>, <span class='name'><a href='Gateway.html#card_brand-instance_method' title='card_brand'>card_brand</a></span>, <span class='name'><a href='Gateway.html#currency-instance_method' title='currency'>currency</a></span>, <span class='name'><a href='Gateway.html#name-instance_method' title='name'>name</a></span>, <span class='name'><a href='Gateway.html#requires_start_date_or_issue_number%3F-instance_method' title='requires_start_date_or_issue_number?'>requires_start_date_or_issue_number?</a></span>, <span class='name'><a href='Gateway.html#test%3F-instance_method' title='test?'>test?</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>authorize</h3>
</div><div id="authorize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>authorize</span><span class='args'>(money, credit_card, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
NOTE: Perhaps in options we allow a transaction note to be inserted
Verifies that funds are available for the requested card and amount and
reserves the specified amount. See:
http://www.paymentexpress.com/technical_resources/ecommerce_nonhosted/pxpost.html#Authcomplete
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


63
64
65
66
67
68</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/active_merchant/billing/gateways/payment_express.rb', line 63</span>

<span class='def def kw'>def</span> <span class='authorize identifier id'>authorize</span><span class='lparen token'>(</span><span class='money identifier id'>money</span><span class='comma token'>,</span> <span class='credit_card identifier id'>credit_card</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:credit_card</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='credit_card identifier id'>credit_card</span>

  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='build_purchase_or_authorization_request identifier id'>build_purchase_or_authorization_request</span><span class='lparen token'>(</span><span class='money identifier id'>money</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='commit identifier id'>commit</span><span class='lparen token'>(</span><span class='symbol val'>:authorization</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>capture</h3>
</div><div id="capture-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>capture</span><span class='args'>(money, identification, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Transfer pre-authorized funds immediately See:
http://www.paymentexpress.com/technical_resources/ecommerce_nonhosted/pxpost.html#Authcomplete
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


72
73
74
75</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/active_merchant/billing/gateways/payment_express.rb', line 72</span>

<span class='def def kw'>def</span> <span class='capture identifier id'>capture</span><span class='lparen token'>(</span><span class='money identifier id'>money</span><span class='comma token'>,</span> <span class='identification identifier id'>identification</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='build_capture_or_credit_request identifier id'>build_capture_or_credit_request</span><span class='lparen token'>(</span><span class='money identifier id'>money</span><span class='comma token'>,</span> <span class='identification identifier id'>identification</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>                                            
  <span class='commit identifier id'>commit</span><span class='lparen token'>(</span><span class='symbol val'>:capture</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>credit</h3>
</div><div id="credit-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>credit</span><span class='args'>(money, identification, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Refund funds to the card holder
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


78
79
80
81
82
83</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/active_merchant/billing/gateways/payment_express.rb', line 78</span>

<span class='def def kw'>def</span> <span class='credit identifier id'>credit</span><span class='lparen token'>(</span><span class='money identifier id'>money</span><span class='comma token'>,</span> <span class='identification identifier id'>identification</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='requires! fid id'>requires!</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='symbol val'>:description</span><span class='rparen token'>)</span>
  
  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='build_capture_or_credit_request identifier id'>build_capture_or_credit_request</span><span class='lparen token'>(</span><span class='money identifier id'>money</span><span class='comma token'>,</span> <span class='identification identifier id'>identification</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>                                            
  <span class='commit identifier id'>commit</span><span class='lparen token'>(</span><span class='symbol val'>:credit</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>purchase</h3>
</div><div id="purchase-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>purchase</span><span class='args'>(money, payment_source, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Funds are transferred immediately.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


46
47
48
49
50
51
52
53
54
55
56
57
58</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/active_merchant/billing/gateways/payment_express.rb', line 46</span>

<span class='def def kw'>def</span> <span class='purchase identifier id'>purchase</span><span class='lparen token'>(</span><span class='money identifier id'>money</span><span class='comma token'>,</span> <span class='payment_source identifier id'>payment_source</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  
  <span class='credit_card identifier id'>credit_card</span> <span class='assign token'>=</span> <span class='payment_source identifier id'>payment_source</span> <span class='if if_mod kw'>if</span> <span class='payment_source identifier id'>payment_source</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:number</span><span class='rparen token'>)</span>
  
  <span class='if if kw'>if</span> <span class='credit_card identifier id'>credit_card</span>        
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:credit_card</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='credit_card identifier id'>credit_card</span>
  <span class='else else kw'>else</span>
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:token</span><span class='rbrack token'>]</span>       <span class='assign token'>=</span> <span class='payment_source identifier id'>payment_source</span>
  <span class='end end kw'>end</span>
  
  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='build_purchase_or_authorization_request identifier id'>build_purchase_or_authorization_request</span><span class='lparen token'>(</span><span class='money identifier id'>money</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='commit identifier id'>commit</span><span class='lparen token'>(</span><span class='symbol val'>:purchase</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='rparen token'>)</span>      
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>store</h3>
</div><div id="store-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>store</span><span class='args'>(credit_card, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
token based billing initiates a &quot;Validate&quot; transcation to store
card data on payment express servers returns a &quot;token&quot; that can
be used to rebill this card see:
http://www.paymentexpress.com/technical_resources/ecommerce_nonhosted/pxpost.html#Tokenbilling
PaymentExpress does not support unstoring a stored card.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


91
92
93
94</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/active_merchant/billing/gateways/payment_express.rb', line 91</span>

<span class='def def kw'>def</span> <span class='store identifier id'>store</span><span class='lparen token'>(</span><span class='credit_card identifier id'>credit_card</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='request identifier id'>request</span>  <span class='assign token'>=</span> <span class='build_token_request identifier id'>build_token_request</span><span class='lparen token'>(</span><span class='credit_card identifier id'>credit_card</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='commit identifier id'>commit</span><span class='lparen token'>(</span><span class='symbol val'>:validate</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>