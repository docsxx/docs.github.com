<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>kbingman's paperclipped - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/kbingman/commits/paperclipped/master" rel="alternate" title="Recent Commits to paperclipped:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("kbingman", "paperclipped", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='kbingman/paperclipped/blob/fbc7ca165388379c6a00f4434dc2cf1afd114904' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='kbingman/paperclipped/blob/fbc7ca165388379c6a00f4434dc2cf1afd114904' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("kbingman", "paperclipped", "fbc7ca165388379c6a00f4434dc2cf1afd114904", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/kbingman/paperclipped/tree/">Source</a></li>
            <li class=""><a href="http://github.com/kbingman/paperclipped/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/kbingman/paperclipped/network">Network</a></li>            
            <li class=""><a href="http://github.com/kbingman/paperclipped/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/kbingman/paperclipped">Wiki</a></li>
            <li class=""><a href="http://github.com/kbingman/paperclipped/graphs">Graphs</a></li>                    
            <li class="active"><a href="/kbingman/paperclipped">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/kbingman">kbingman</a> / <b><a href="http://github.com/kbingman/paperclipped/tree">paperclipped</a></b>        
                <a id="namespaces_button" rel="kbingman/paperclipped/blob/fbc7ca165388379c6a00f4434dc2cf1afd114904" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="kbingman/paperclipped/blob/fbc7ca165388379c6a00f4434dc2cf1afd114904" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h2>Paperclipped</h2>

<h2>IMPORTANT!</h2>

<p>This version of Paperclipped technically requires Radiant 0.8.0 or higher. Changes in the caching system and the updgrade to Rails 2.3.2 break the previous versions of the extension, but there are a few work arounds and it should work with 0.7.1. Just in case, the previous version is still around, on a branch marked Radiant-0.7.1.</p>

<p>Let me know if this works and if you run into any issues.</p>

<h3>Installation</h3>

<p>To install paperclipped, just run</p>

<pre class="code"><span class='rake identifier id'>rake</span> <span class='production identifier id'>production</span> <span class='db identifier id'>db</span><span class='symbol val'>:migrate</span><span class='symbol val'>:extensions</span>
<span class='rake identifier id'>rake</span> <span class='production identifier id'>production</span> <span class='radiant identifier id'>radiant</span><span class='symbol val'>:extensions</span><span class='symbol val'>:paperclipped</span><span class='symbol val'>:update</span>
</pre>

<p>This runs the database migrations and installs the javascripts, images and css.</p>

<h3>Configuration</h3>

<p>If you install the Settings Extension (highly recommended), you can also easily adjust both the sizes of any additional thumbnails and which thumbnails are displayed in the image edit view. The default is the original file, but any image size can be used by giving in the name of that size.</p>

<p>If you do install the Settings Extension you should be sure to add a config.exetensions line to your environment.rb file:</p>

<pre class="code"><span class='config identifier id'>config</span><span class='dot token'>.</span><span class='extensions identifier id'>extensions</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='symbol val'>:settings</span><span class='comma token'>,</span> <span class='symbol val'>:all</span> <span class='rbrack token'>]</span>
</pre>

<p>Also the Settings Extension migration should be run before Paperclipped's migration.</p>

<p>You also need the ImageSize gem required in <code>environment.rb</code>:</p>

<pre class="code"><span class='config identifier id'>config</span><span class='dot token'>.</span><span class='gem identifier id'>gem</span> <span class='string val'>'imagesize'</span><span class='comma token'>,</span> <span class='symbol val'>:lib</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'image_size'</span>
</pre>

<p>The configuration settings also enable a list of the allowed file types, maximum file size and should you need it, the path to your installation of Image Magick (this should not be needed, but I sometimes had a problem when using mod_rails).</p>

<h3>Using Paperclipped</h3>

<p>Once installed, you get a new Tab with the entire assets library, a Bucket Ã  la Mephisto (though only the concept is stolen) and a search. You can also easily attach assets to any page and directly upload them to a page.</p>

<h3>Asset Tags</h3>

<p>There are a veriety of new tags. The basic tag is the <code>&lt;r:assets /></code> tag, which can be used either alone or as a double tag. This tag requires the "title" attribute, which references the asset. If you use the drag and drop from the asset bucket, this title will be added for you.</p>

<p>The <code>&lt;r:assets /></code> tag can be combined with other tags for a variety of uses:</p>

<pre class="code"><span class='lt op'>&lt;</span><span class='r identifier id'>r</span><span class='symbol val'>:assets</span><span class='symbol val'>:image</span> <span class='title identifier id'>title</span><span class='assign token'>=</span><span class='string val'>&quot;foo&quot;</span> <span class='div op'>/</span><span class='gt op'>&gt;</span> <span class='will identifier id'>will</span> <span class='return return kw'>return</span> <span class='lt op'>&lt;</span><span class='img identifier id'>img</span> <span class='src identifier id'>src</span><span class='assign token'>=</span><span class='string val'>&quot;/path/to/foo&quot;</span> <span class='alt identifier id'>alt</span><span class='assign token'>=</span><span class='string val'>&quot;foo&quot;</span> <span class='div op'>/</span><span class='gt op'>&gt;</span>

<span class='lt op'>&lt;</span><span class='r identifier id'>r</span><span class='symbol val'>:assets</span><span class='symbol val'>:link</span> <span class='title identifier id'>title</span><span class='assign token'>=</span><span class='string val'>&quot;foo&quot;</span> <span class='div op'>/</span><span class='gt op'>&gt;</span> <span class='will identifier id'>will</span> <span class='return return kw'>return</span> <span class='lt op'>&lt;</span><span class='a identifier id'>a</span> <span class='href identifier id'>href</span><span class='assign token'>=</span><span class='string val'>&quot;/path/to/foo&quot;</span><span class='gt op'>&gt;</span><span class='foo identifier id'>foo</span><span class='lt op'>&lt;</span><span class='regexp val'>/a&gt;
</span></pre>

<p>You could also use:</p>

<pre class="code"><span class='lt op'>&lt;</span><span class='r identifier id'>r</span><span class='symbol val'>:assets</span><span class='symbol val'>:link</span> <span class='title identifier id'>title</span><span class='assign token'>=</span><span class='string val'>&quot;foo&quot;</span> <span class='text identifier id'>text</span><span class='assign token'>=</span><span class='string val'>&quot;This is the link to foo&quot;</span> <span class='div op'>/</span><span class='gt op'>&gt;</span> <span class='will identifier id'>will</span> <span class='return return kw'>return</span> <span class='lt op'>&lt;</span><span class='a identifier id'>a</span> <span class='href identifier id'>href</span><span class='assign token'>=</span><span class='string val'>&quot;/path/to/foo&quot;</span><span class='gt op'>&gt;</span><span class='This constant id'>This</span> <span class='is identifier id'>is</span> <span class='the identifier id'>the</span> <span class='link identifier id'>link</span> <span class='to identifier id'>to</span> <span class='foo identifier id'>foo</span><span class='lt op'>&lt;</span><span class='regexp val'>/a&gt;
</span></pre>

<p>or</p>

<pre class="code"><span class='lt op'>&lt;</span><span class='r identifier id'>r</span><span class='symbol val'>:assets</span><span class='symbol val'>:link</span> <span class='title identifier id'>title</span><span class='assign token'>=</span><span class='string val'>&quot;foo&quot;</span><span class='gt op'>&gt;</span><span class='This constant id'>This</span> <span class='is identifier id'>is</span> <span class='another identifier id'>another</span> <span class='link identifier id'>link</span><span class='lt op'>&lt;</span><span class='regexp val'>/r:link&gt;
</span></pre>

<p>Asset links are also available, such as content_type, file_size, and url.</p>

<p>Another important tag is the <code>&lt;r:assets:each>...&lt;/r:assets:each></code>. If a page has attached assets, the assets:each tag will cycle through each asset. You can then use an image, link or url tag to display or connect your assets. Usage:</p>

<pre class="code"><span class='lt op'>&lt;</span><span class='r identifier id'>r</span><span class='symbol val'>:assets</span><span class='symbol val'>:each</span> <span class='lbrack token'>[</span><span class='limit identifier id'>limit</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='offset identifier id'>offset</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='order identifier id'>order</span><span class='assign token'>=</span><span class='string val'>&quot;asc|desc&quot;</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='by identifier id'>by</span><span class='assign token'>=</span><span class='string val'>&quot;position|title|...&quot;</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='extensions identifier id'>extensions</span><span class='assign token'>=</span><span class='string val'>&quot;png|pdf|doc&quot;</span><span class='rbrack token'>]</span><span class='gt op'>&gt;</span>
  <span class='dot3 op'>...</span>
<span class='lt op'>&lt;</span><span class='regexp val'>/r:assets:each&gt;
</span></pre>

<p><code>&lt;r:assets:each&gt;</code> parameters:</p>

<ul>
<li><code>limit</code> and <code>offset</code> let you specify a range of assets;</li>
<li><code>order</code> and <code>by</code> lets you control sorting;</li>
<li><code>extensions</code> allows you to filter assets by file extensions; you can specify multiple extensions separated by <code>|</code>.</li>
</ul>


<p><code><pre class="code"><span class='lt op'>&lt;</span><span class='r identifier id'>r</span><span class='symbol val'>:if_assets</span> <span class='lbrack token'>[</span><span class='min_count identifier id'>min_count</span><span class='assign token'>=</span><span class='string val'>&quot;0&quot;</span><span class='rbrack token'>]</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='regexp val'>/code&gt; and &lt;code&gt;&lt;r:unless_assets [min_count=&quot;0&quot;]&gt;&lt;/</span><span class='code identifier id'>code</span><span class='gt op'>&gt;</span>
</pre></p>

<p>conditional tags let you optionally render content based on the existance of tags. They accept the same options as <code>&lt;r:assets:each&gt;</code>.</p>

<p>Thumbnails are automatically generated for images when the images are uploaded. By default, two sizes are made for use within the extension itself. These are "icon" 42px by 42px and "thumbnail" which is fit into 100px, maintaining its aspect ratio.</p>

<p>You can access sizes of image assets for various versions with the tags <code>&lt;r:assets:width [size="original"]/&gt;</code> and <code>&lt;r:assets:height [size="original"]/&gt;</code>.</p>

<p>Also, for vertical centering of images, you have the handy <code>&lt;r:assets:top_padding container="&lt;container height&gt;" [size="icon"]/&gt;</code> tag. Working example:</p>

<pre class="code"><span class='lt op'>&lt;</span><span class='ul identifier id'>ul</span><span class='gt op'>&gt;</span>
  <span class='lt op'>&lt;</span><span class='r identifier id'>r</span><span class='symbol val'>:assets</span><span class='symbol val'>:each</span><span class='gt op'>&gt;</span>
    <span class='lt op'>&lt;</span><span class='li identifier id'>li</span> <span class='style identifier id'>style</span><span class='assign token'>=</span><span class='string val'>&quot;height:140px&quot;</span><span class='gt op'>&gt;</span>
      <span class='lt op'>&lt;</span><span class='img identifier id'>img</span> <span class='style identifier id'>style</span><span class='assign token'>=</span><span class='string val'>&quot;padding-top:&lt;r:top_padding size='category' container='140' /&gt;px&quot;</span> 
           <span class='src identifier id'>src</span><span class='assign token'>=</span><span class='string val'>&quot;&lt;r:url /&gt;&quot;</span> <span class='alt identifier id'>alt</span><span class='assign token'>=</span><span class='string val'>&quot;&lt;r:title /&gt;&quot;</span> <span class='div op'>/</span><span class='gt op'>&gt;</span>
    <span class='lt op'>&lt;</span><span class='regexp val'>/li&gt;
  &lt;/</span><span class='r identifier id'>r</span><span class='symbol val'>:assets</span><span class='symbol val'>:each</span><span class='gt op'>&gt;</span>
<span class='lt op'>&lt;</span><span class='regexp val'>/ul&gt;
</span></pre>

<h3>Using Amazon s3</h3>

<p>Everything works as before, but now if you want to add S3 support, you simply set the storage setting to "s3".</p>

<pre class="code"><span class='Radiant constant id'>Radiant</span><span class='colon2 op'>::</span><span class='Config constant id'>Config</span><span class='lbrack token'>[</span><span class='assets identifier id'>assets</span><span class='dot token'>.</span><span class='storage identifier id'>storage</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;s3&quot;</span>
</pre>


<p>Then add 3 new settings with your Amazon credentials, either in the console or with the <a href="http://github.com/Squeegy/radiant-settings/tree/master">Settings</a> extension:</p>

<pre class="code"><span class='Radiant constant id'>Radiant</span><span class='colon2 op'>::</span><span class='Config constant id'>Config</span><span class='lbrack token'>[</span><span class='assets identifier id'>assets</span><span class='dot token'>.</span><span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='bucket identifier id'>bucket</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;my_supercool_bucket&quot;</span>
<span class='Radiant constant id'>Radiant</span><span class='colon2 op'>::</span><span class='Config constant id'>Config</span><span class='lbrack token'>[</span><span class='assets identifier id'>assets</span><span class='dot token'>.</span><span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;123456&quot;</span>
<span class='Radiant constant id'>Radiant</span><span class='colon2 op'>::</span><span class='Config constant id'>Config</span><span class='lbrack token'>[</span><span class='assets identifier id'>assets</span><span class='dot token'>.</span><span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='secret identifier id'>secret</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>&quot;123456789ABCDEF&quot;</span>
</pre>


<p>and finally the path you want to use within your bucket, which uses the same notation as the Paperclip plugin.</p>

<pre class="code"><span class='Radiant constant id'>Radiant</span><span class='colon2 op'>::</span><span class='Config constant id'>Config</span><span class='lbrack token'>[</span><span class='assets identifier id'>assets</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='symbol val'>:class</span><span class='div op'>/</span><span class='symbol val'>:id</span><span class='div op'>/</span><span class='symbol val'>:basename_</span><span class='symbol val'>:style</span><span class='dot token'>.</span><span class='symbol val'>:extension</span> 
</pre>


<p>The path setting, along with a new <code>url</code> setting can be used with the file system to customize both the path and url of your assets.</p>

<h3>Migrating from the page_attachments extension</h3>

<p>If you're moving from page_attachments to paperclipped, here's how to migrate smoothly:</p>

<p>First, remove or disable the page_attachments extension, and install the paperclipped extension.
For example:</p>

<pre class="code"><span class='rake identifier id'>rake</span> <span class='ray identifier id'>ray</span><span class='symbol val'>:dis</span> <span class='name identifier id'>name</span><span class='assign token'>=</span><span class='page_attachments identifier id'>page_attachments</span>
<span class='rake identifier id'>rake</span> <span class='ray identifier id'>ray</span><span class='symbol val'>:assets</span>
</pre>


<p>The migration has now copied your original <code>page_attachments</code> table to <code>old_page_attachments</code>.</p>

<pre class="code"><span class='rake identifier id'>rake</span> <span class='radiant identifier id'>radiant</span><span class='symbol val'>:extensions</span><span class='symbol val'>:paperclipped</span><span class='symbol val'>:migrate_from_page_attachments</span>
</pre>


<p>This rake task will create paperclipped-style attachments for all <code>OldPageAttachments</code>. It will also ask you if you want to clean up the old table and thumbnails in <code>/public/page_attachments</code>.</p>

<p>Done!</p>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> Â©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>