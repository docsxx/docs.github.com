<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>thoughtbot's paperclip - Module: Paperclip::Storage::S3 - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/thoughtbot/commits/paperclip/master" rel="alternate" title="Recent Commits to paperclip:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("thoughtbot", "paperclip", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("thoughtbot", "paperclip", "121609fab38f2aba5ac3cbe0d6b26fd664ee3090", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/thoughtbot/paperclip/tree/">Source</a></li>
            <li class=""><a href="http://github.com/thoughtbot/paperclip/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/thoughtbot/paperclip/network">Network</a></li>            
            <li class=""><a href="http://github.com/thoughtbot/paperclip/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/thoughtbot/paperclip">Wiki</a></li>
            <li class=""><a href="http://github.com/thoughtbot/paperclip/graphs">Graphs</a></li>                    
            <li class="active"><a href="/thoughtbot/paperclip">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/thoughtbot">thoughtbot</a> / <b><a href="http://github.com/thoughtbot/paperclip/tree">paperclip</a></b>        
                <a id="namespaces_button" rel="thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Paperclip_Storage_S3">
  <h1>Module: Paperclip::Storage::S3</h1>
  <div class="section docstring">
  <p>
Amazon&#8217;s S3 file hosting service is a scalable, easy place to store
files for distribution. You can find out more about it at
http://aws.amazon.com/s3 There are a few S3-specific options for
has_attached_file:
</p>
<ul>
<li><tt>s3_credentials</tt>: Takes a path, a File, or a Hash. The path (or File) must
point to a YAML file containing the <tt>access_key_id</tt> and
<tt>secret_access_key</tt> that Amazon gives you. You can
&#8216;environment-space&#8217; this just like you do to your database.yml
file, so different environments can use different accounts:

<pre class="code">
  <span class='development identifier id'>development</span><span class='colon op'>:</span>
    <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='float val'>123</span><span class='dot3 op'>...</span>
    <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='float val'>123</span><span class='dot3 op'>...</span>
  <span class='test identifier id'>test</span><span class='colon op'>:</span>
    <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='abc identifier id'>abc</span><span class='dot3 op'>...</span>
    <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='abc identifier id'>abc</span><span class='dot3 op'>...</span>
  <span class='production identifier id'>production</span><span class='colon op'>:</span>
    <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='float val'>456</span><span class='dot3 op'>...</span>
    <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='float val'>456</span><span class='dot3 op'>...</span>
</pre>
<p>
This is not required, however, and the file may simply look like this:
</p>
<pre class="code">
  <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='float val'>456</span><span class='dot3 op'>...</span>
  <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='float val'>456</span><span class='dot3 op'>...</span>
</pre>
<p>
In which case, those access keys will be used in all environments. You can
also put your bucket name in this file, instead of adding it to the code
directly. This is useful when you want the same account but a different
bucket for development versus production.
</p>
</li>
<li><tt>s3_permissions</tt>: This is a String that should be one of the
&quot;canned&quot; access policies that S3 provides (more information can
be found here:
http://docs.amazonwebservices.com/AmazonS3/2006-03-01/RESTAccessPolicy.html#RESTCannedAccessPolicies)
The default for Paperclip is &quot;public-read&quot;.

</li>
<li><tt>s3_protocol</tt>: The protocol for the URLs generated to your S3 assets. Can
be either &#8216;http&#8217; or &#8216;https&#8217;. Defaults to
&#8216;http&#8217; when your :s3_permissions are &#8216;public-read&#8217;
(the default), and &#8216;https&#8217; when your :s3_permissions are
anything else.

</li>
<li><tt>s3_headers</tt>: A hash of headers such as {&#8216;Expires&#8217; =&gt;
1.year.from_now.httpdate}

</li>
<li><tt>bucket</tt>: This is the name of the S3 bucket that will store your
files. Remember that the bucket must be unique across all of Amazon S3. If
the bucket does not exist Paperclip will attempt to create it. The bucket
name will not be interpolated. You can define the bucket as a Proc if you
want to determine it&#8217;s name at runtime. Paperclip will call that Proc
with attachment as the only argument.

</li>
<li><tt>s3_host_alias</tt>: The fully-qualified domain name (FQDN) that is the alias
to the S3 domain of your bucket. Used with the :s3_alias_url url
interpolation. See the link in the <tt>url</tt> entry for more information
about S3 domains and buckets.

</li>
<li><tt>url</tt>: There are three options for the S3 url. You can choose to
have the bucket&#8217;s name placed domain-style (bucket.s3.amazonaws.com)
or path-style (s3.amazonaws.com/bucket). Lastly, you can specify a CNAME
(which requires the CNAME to be specified as :s3_alias_url. You can read
more about CNAMEs and S3 at
http://docs.amazonwebservices.com/AmazonS3/latest/index.html?VirtualHosting.html
Normally, this won&#8217;t matter in the slightest and you can leave the
default (which is path-style, or :s3_path_url). But in some cases paths
don&#8217;t work and you need to use the domain-style (:s3_domain_url).
Anything else here will be treated like path-style. NOTE: If you use a
CNAME for use with CloudFront, you can NOT specify https as your
:s3_protocol; This is *not supported* by S3/CloudFront. Finally, when using
the host alias, the :bucket parameter is ignored, as the hostname is used
as the bucket name by S3.

</li>
<li><tt>path</tt>: This is the key under the bucket in which the file will be
stored. The URL will be constructed from the bucket and the path. This is
what you will want to interpolate. Keys should be unique, like filenames,
and despite the fact that S3 (strictly speaking) does not support
directories, you can still use a / to separate parts of your file name.

</li>
</ul>

</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#extended-class_method">extended</span><span class='args'>(base)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bucket_name-instance_method">#bucket_name</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#exists-3F-instance_method">#exists?</span><span class='args'>(style = default_style)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#flush_deletes-instance_method">#flush_deletes</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#flush_writes-instance_method">#flush_writes</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#parse_credentials-instance_method">#parse_credentials</span><span class='args'>(creds)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#s3-instance_method">#s3</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#s3_bucket-instance_method">#s3_bucket</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#s3_host_alias-instance_method">#s3_host_alias</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#s3_protocol-instance_method">#s3_protocol</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_file-instance_method">#to_file</span><span class='args'>(style = default_style)</span>
        <span class='block'></span>
        
          <span class='alias'>#to_io</span>
        
      </th>
      <td class="docstring">
        <p>
Returns representation of the data of the file assigned to the given style,
in the format most representative of the current storage.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>extended</h3>
</div><div id="extended-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>extended</span><span class='args'>(base)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 130</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L130">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='extended identifier id'>extended</span> <span class='base identifier id'>base</span>
  <span class='require identifier id'>require</span> <span class='string val'>'right_aws'</span>
  <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='instance_eval identifier id'>instance_eval</span> <span class='do do kw'>do</span>
    <span class='@s3_credentials ivar id'>@s3_credentials</span> <span class='assign token'>=</span> <span class='parse_credentials identifier id'>parse_credentials</span><span class='lparen token'>(</span><span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:s3_credentials</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='@bucket ivar id'>@bucket</span>         <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='rbrack token'>]</span>         <span class='orop op'>||</span> <span class='@s3_credentials ivar id'>@s3_credentials</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='rbrack token'>]</span>
    <span class='@bucket ivar id'>@bucket</span>         <span class='assign token'>=</span> <span class='@bucket ivar id'>@bucket</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='@bucket ivar id'>@bucket</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Proc constant id'>Proc</span><span class='rparen token'>)</span>
    <span class='@s3_options ivar id'>@s3_options</span>     <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:s3_options</span><span class='rbrack token'>]</span>     <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
    <span class='@s3_permissions ivar id'>@s3_permissions</span> <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:s3_permissions</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='string val'>'public-read'</span>
    <span class='@s3_protocol ivar id'>@s3_protocol</span>    <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:s3_protocol</span><span class='rbrack token'>]</span>    <span class='orop op'>||</span> <span class='lparen token'>(</span><span class='@s3_permissions ivar id'>@s3_permissions</span> <span class='eq op'>==</span> <span class='string val'>'public-read'</span> <span class='question op'>?</span> <span class='string val'>'http'</span> <span class='colon op'>:</span> <span class='string val'>'https'</span><span class='rparen token'>)</span>
    <span class='@s3_headers ivar id'>@s3_headers</span>     <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:s3_headers</span><span class='rbrack token'>]</span>     <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
    <span class='@s3_host_alias ivar id'>@s3_host_alias</span>  <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:s3_host_alias</span><span class='rbrack token'>]</span>
    <span class='@url ivar id'>@url</span>            <span class='assign token'>=</span> <span class='string val'>&quot;:s3_path_url&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='@url ivar id'>@url</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='match identifier id'>match</span><span class='lparen token'>(</span><span class='regexp val'>/^:s3.*url$/</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='Paperclip constant id'>Paperclip</span><span class='dot token'>.</span><span class='interpolates identifier id'>interpolates</span><span class='lparen token'>(</span><span class='symbol val'>:s3_alias_url</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attachment identifier id'>attachment</span><span class='comma token'>,</span> <span class='style identifier id'>style</span><span class='bitor op'>|</span>
    <span class='dstring node'>&quot;#{attachment.s3_protocol}://#{attachment.s3_host_alias}/#{attachment.path(style).gsub(%r{^/}, &quot;&quot;)}&quot;</span>
  <span class='end end kw'>end</span>
  <span class='Paperclip constant id'>Paperclip</span><span class='dot token'>.</span><span class='interpolates identifier id'>interpolates</span><span class='lparen token'>(</span><span class='symbol val'>:s3_path_url</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attachment identifier id'>attachment</span><span class='comma token'>,</span> <span class='style identifier id'>style</span><span class='bitor op'>|</span>
    <span class='dstring node'>&quot;#{attachment.s3_protocol}://s3.amazonaws.com/#{attachment.bucket_name}/#{attachment.path(style).gsub(%r{^/}, &quot;&quot;)}&quot;</span>
  <span class='end end kw'>end</span>
  <span class='Paperclip constant id'>Paperclip</span><span class='dot token'>.</span><span class='interpolates identifier id'>interpolates</span><span class='lparen token'>(</span><span class='symbol val'>:s3_domain_url</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attachment identifier id'>attachment</span><span class='comma token'>,</span> <span class='style identifier id'>style</span><span class='bitor op'>|</span>
    <span class='dstring node'>&quot;#{attachment.s3_protocol}://#{attachment.bucket_name}.s3.amazonaws.com/#{attachment.path(style).gsub(%r{^/}, &quot;&quot;)}&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>bucket_name</h3>
</div><div id="bucket_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bucket_name</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 164</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L164">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">164
165
166</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='bucket_name identifier id'>bucket_name</span>
  <span class='@bucket ivar id'>@bucket</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>exists?</h3>
</div><div id="exists-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>exists?</span><span class='args'>(style = default_style)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 177</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L177">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">177
178
179</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='exists? fid id'>exists?</span><span class='lparen token'>(</span><span class='style identifier id'>style</span> <span class='assign token'>=</span> <span class='default_style identifier id'>default_style</span><span class='rparen token'>)</span>
  <span class='s3_bucket identifier id'>s3_bucket</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='lparen token'>(</span><span class='style identifier id'>style</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='true true kw'>true</span> <span class='colon op'>:</span> <span class='false false kw'>false</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>flush_deletes</h3>
</div><div id="flush_deletes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>flush_deletes</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 206</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L206">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">206
207
208
209
210
211
212
213
214
215
216
217
218</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='flush_deletes identifier id'>flush_deletes</span> 
  <span class='@queued_for_delete ivar id'>@queued_for_delete</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='path identifier id'>path</span><span class='bitor op'>|</span>
    <span class='begin begin kw'>begin</span>
      <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='dstring node'>&quot;deleting #{path}&quot;</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='file identifier id'>file</span> <span class='assign token'>=</span> <span class='s3_bucket identifier id'>s3_bucket</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='rparen token'>)</span>
        <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span>
      <span class='end end kw'>end</span>
    <span class='rescue rescue kw'>rescue</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='AwsError constant id'>AwsError</span>
      <span class='comment val'># Ignore this.</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='@queued_for_delete ivar id'>@queued_for_delete</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>flush_writes</h3>
</div><div id="flush_writes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>flush_writes</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 192</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L192">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">192
193
194
195
196
197
198
199
200
201
202
203
204</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='flush_writes identifier id'>flush_writes</span> 
  <span class='@queued_for_write ivar id'>@queued_for_write</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='style identifier id'>style</span><span class='comma token'>,</span> <span class='file identifier id'>file</span><span class='bitor op'>|</span>
    <span class='begin begin kw'>begin</span>
      <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='dstring node'>&quot;saving #{path(style)}&quot;</span><span class='rparen token'>)</span>
      <span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='s3_bucket identifier id'>s3_bucket</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='lparen token'>(</span><span class='style identifier id'>style</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='key identifier id'>key</span><span class='dot token'>.</span><span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='file identifier id'>file</span>
      <span class='key identifier id'>key</span><span class='dot token'>.</span><span class='put identifier id'>put</span><span class='lparen token'>(</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='@s3_permissions ivar id'>@s3_permissions</span><span class='comma token'>,</span> <span class='lbrace token'>{</span><span class='string val'>'Content-type'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='instance_read identifier id'>instance_read</span><span class='lparen token'>(</span><span class='symbol val'>:content_type</span><span class='rparen token'>)</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='@s3_headers ivar id'>@s3_headers</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='rescue rescue kw'>rescue</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='AwsError constant id'>AwsError</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
      <span class='raise identifier id'>raise</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='@queued_for_write ivar id'>@queued_for_write</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>parse_credentials</h3>
</div><div id="parse_credentials-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>parse_credentials</span><span class='args'>(creds)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 172</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L172">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">172
173
174
175</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='parse_credentials identifier id'>parse_credentials</span> <span class='creds identifier id'>creds</span>
  <span class='creds identifier id'>creds</span> <span class='assign token'>=</span> <span class='find_credentials identifier id'>find_credentials</span><span class='lparen token'>(</span><span class='creds identifier id'>creds</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='stringify_keys identifier id'>stringify_keys</span>
  <span class='lparen token'>(</span><span class='creds identifier id'>creds</span><span class='lbrack token'>[</span><span class='RAILS_ENV constant id'>RAILS_ENV</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='creds identifier id'>creds</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='symbolize_keys identifier id'>symbolize_keys</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>s3</h3>
</div><div id="s3-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>s3</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 154</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L154">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">154
155
156
157
158</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='s3 identifier id'>s3</span>
  <span class='@s3 ivar id'>@s3</span> <span class='opasgn op'>||=</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='S3 constant id'>S3</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='@s3_credentials ivar id'>@s3_credentials</span><span class='lbrack token'>[</span><span class='symbol val'>:access_key_id</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                           <span class='@s3_credentials ivar id'>@s3_credentials</span><span class='lbrack token'>[</span><span class='symbol val'>:secret_access_key</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                           <span class='@s3_options ivar id'>@s3_options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>s3_bucket</h3>
</div><div id="s3_bucket-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>s3_bucket</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 160</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L160">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">160
161
162</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='s3_bucket identifier id'>s3_bucket</span>
  <span class='@s3_bucket ivar id'>@s3_bucket</span> <span class='opasgn op'>||=</span> <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='bucket identifier id'>bucket</span><span class='lparen token'>(</span><span class='@bucket ivar id'>@bucket</span><span class='comma token'>,</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='@s3_permissions ivar id'>@s3_permissions</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>s3_host_alias</h3>
</div><div id="s3_host_alias-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>s3_host_alias</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 168</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L168">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">168
169
170</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='s3_host_alias identifier id'>s3_host_alias</span>
  <span class='@s3_host_alias ivar id'>@s3_host_alias</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>s3_protocol</h3>
</div><div id="s3_protocol-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>s3_protocol</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 181</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L181">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">181
182
183</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='s3_protocol identifier id'>s3_protocol</span>
  <span class='@s3_protocol ivar id'>@s3_protocol</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_file</h3>
</div><div id="to_file-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_file</span><span class='args'>(style = default_style)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="to_io-instance_method">to_io</tt>
  
</p>
</div><div class="section docstring">
  <p>
Returns representation of the data of the file assigned to the given style,
in the format most representative of the current storage.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/paperclip/storage.rb', line 187</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/thoughtbot/paperclip/blob/121609fab38f2aba5ac3cbe0d6b26fd664ee3090/lib/paperclip/storage.rb#L187">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">187
188
189</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_file identifier id'>to_file</span> <span class='style identifier id'>style</span> <span class='assign token'>=</span> <span class='default_style identifier id'>default_style</span>
  <span class='@queued_for_write ivar id'>@queued_for_write</span><span class='lbrack token'>[</span><span class='style identifier id'>style</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='s3_bucket identifier id'>s3_bucket</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='lparen token'>(</span><span class='style identifier id'>style</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> Â©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>