<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>technoweenie's attachment_fu - Module: Technoweenie::AttachmentFu::Backends::S3Backend - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/technoweenie/commits/attachment_fu/master" rel="alternate" title="Recent Commits to attachment_fu:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("technoweenie", "attachment_fu", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("technoweenie", "attachment_fu", "fa08cb03914b02b66853b4615cd3eca768291ca7", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/technoweenie/attachment_fu/tree/">Source</a></li>
            <li class=""><a href="http://github.com/technoweenie/attachment_fu/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/technoweenie/attachment_fu/network">Network</a></li>            
            <li class=""><a href="http://github.com/technoweenie/attachment_fu/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/technoweenie/attachment_fu">Wiki</a></li>
            <li class=""><a href="http://github.com/technoweenie/attachment_fu/graphs">Graphs</a></li>                    
            <li class="active"><a href="/technoweenie/attachment_fu">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/technoweenie">technoweenie</a> / <b><a href="http://github.com/technoweenie/attachment_fu/tree">attachment_fu</a></b>        
                <a id="namespaces_button" rel="technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Technoweenie_AttachmentFu_Backends_S3Backend">
  <h1>Module: Technoweenie::AttachmentFu::Backends::S3Backend</h1>
  <div class="section docstring">
  <h1>AWS::S3 Storage Backend</h1>
<p>
Enables use of {Amazon&#8217;s Simple Storage
Service}[http://aws.amazon.com/s3] as a storage mechanism
</p>
<h2>Requirements</h2>
<p>
Requires the <tt>Library</tt>[http://amazon.rubyforge.org] for S3 by
Marcel Molina Jr. installed either as a gem or a as a Rails plugin.
</p>
<h2>Configuration</h2>
<p>
Configuration is done via <tt>RAILS_ROOT/config/amazon_s3.yml</tt> and is
loaded according to the <tt>RAILS_ENV</tt>. The minimum connection options
that you must specify are a bucket name, your access key id and your secret
access key. If you don&#8217;t already have your access keys, all you need
to sign up for the S3 service is an account at Amazon. You can sign up for
S3 and get access keys by visiting http://aws.amazon.com/s3.
</p>
<p>
If you wish to use Amazon CloudFront to serve the files, you can also
specify a distibution domain for the bucket. To read more about CloudFront,
visit http://aws.amazon.com/cloudfront
</p>
<p>
Example configuration (RAILS_ROOT/config/amazon_s3.yml)
</p>
<pre class="code">
  <span class='development identifier id'>development</span><span class='colon op'>:</span>
    <span class='bucket_name identifier id'>bucket_name</span><span class='colon op'>:</span> <span class='appname_development identifier id'>appname_development</span>
    <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>
    <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>
    <span class='distribution_domain identifier id'>distribution_domain</span><span class='colon op'>:</span> <span class='XXXX constant id'>XXXX</span><span class='dot token'>.</span><span class='cloudfront identifier id'>cloudfront</span><span class='dot token'>.</span><span class='net identifier id'>net</span>

  <span class='test identifier id'>test</span><span class='colon op'>:</span>
    <span class='bucket_name identifier id'>bucket_name</span><span class='colon op'>:</span> <span class='appname_test identifier id'>appname_test</span>
    <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>
    <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>
    <span class='distribution_domain identifier id'>distribution_domain</span><span class='colon op'>:</span> <span class='XXXX constant id'>XXXX</span><span class='dot token'>.</span><span class='cloudfront identifier id'>cloudfront</span><span class='dot token'>.</span><span class='net identifier id'>net</span>

  <span class='production identifier id'>production</span><span class='colon op'>:</span>
    <span class='bucket_name identifier id'>bucket_name</span><span class='colon op'>:</span> <span class='appname identifier id'>appname</span>
    <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>
    <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>
    <span class='distribution_domain identifier id'>distribution_domain</span><span class='colon op'>:</span> <span class='XXXX constant id'>XXXX</span><span class='dot token'>.</span><span class='cloudfront identifier id'>cloudfront</span><span class='dot token'>.</span><span class='net identifier id'>net</span>
</pre>
<p>
You can change the location of the config path by passing a full path to
the :s3_config_path option.
</p>
<pre class="code">
  <span class='has_attachment identifier id'>has_attachment</span> <span class='symbol val'>:storage</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:s3</span><span class='comma token'>,</span> <span class='symbol val'>:s3_config_path</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lparen token'>(</span><span class='RAILS_ROOT constant id'>RAILS_ROOT</span> <span class='plus op'>+</span> <span class='string val'>'/config/s3.yml'</span><span class='rparen token'>)</span>
</pre>
<h3>Required configuration parameters</h3>
<ul>
<li><tt>:access_key_id</tt> - The access key id for your S3 account. Provided
by Amazon.

</li>
<li><tt>:secret_access_key</tt> - The secret access key for your S3 account.
Provided by Amazon.

</li>
<li><tt>:bucket_name</tt> - A unique bucket name (think of the bucket_name as
being like a database name).

</li>
</ul>
<p>
If any of these required arguments is missing, a MissingAccessKey exception
will be raised from AWS::S3.
</p>
<h2>About bucket names</h2>
<p>
Bucket names have to be globaly unique across the S3 system. And you can
only have up to 100 of them, so it&#8217;s a good idea to think of a bucket
as being like a database, hence the correspondance in this implementation
to the development, test, and production environments.
</p>
<p>
The number of objects you can store in a bucket is, for all intents and
purposes, unlimited.
</p>
<h3>Optional configuration parameters</h3>
<ul>
<li><tt>:server</tt> - The server to make requests to. Defaults to
<tt>s3.amazonaws.com</tt>.

</li>
<li><tt>:port</tt> - The port to the requests should be made on. Defaults to 80
or 443 if <tt>:use_ssl</tt> is set.

</li>
<li><tt>:use_ssl</tt> - If set to true, <tt>:port</tt> will be implicitly set
to 443, unless specified otherwise. Defaults to false.

</li>
<li><tt>:distribution_domain</tt> - The CloudFront distribution domain for the
bucket. This can either be the assigned

<pre class="code">
  <span class='distribution identifier id'>distribution</span> <span class='domain identifier id'>domain</span> <span class='lparen token'>(</span><span class='ie identifier id'>ie</span><span class='dot token'>.</span> <span class='XXX constant id'>XXX</span><span class='dot token'>.</span><span class='cloudfront identifier id'>cloudfront</span><span class='dot token'>.</span><span class='net identifier id'>net</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='a identifier id'>a</span> <span class='chosen identifier id'>chosen</span> <span class='domain identifier id'>domain</span> <span class='using identifier id'>using</span> <span class='a identifier id'>a</span> <span class='CNAME constant id'>CNAME</span><span class='dot token'>.</span> <span class='See constant id'>See</span> <span class='CloudFront constant id'>CloudFront</span> <span class='for for kw'>for</span> <span class='more identifier id'>more</span> <span class='details identifier id'>details</span><span class='dot token'>.</span>
</pre>
</li>
</ul>
<h2>Usage</h2>
<p>
To specify S3 as the storage mechanism for a model, set the
acts_as_attachment <tt>:storage</tt> option to <tt>:s3</tt>.
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Photo constant id'>Photo</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='has_attachment identifier id'>has_attachment</span> <span class='symbol val'>:storage</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:s3</span>
  <span class='end end kw'>end</span>
</pre>
<h3>Customizing the path</h3>
<p>
By default, files are prefixed using a pseudo hierarchy in the form of
<tt>:table_name/:id</tt>, which results in S3 urls that look like:
http(s)://:server/:bucket_name/:table_name/:id/:filename with :table_name
representing the customizable portion of the path. You can customize this
prefix using the <tt>:path_prefix</tt> option:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Photo constant id'>Photo</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='has_attachment identifier id'>has_attachment</span> <span class='symbol val'>:storage</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:s3</span><span class='comma token'>,</span> <span class='symbol val'>:path_prefix</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'my/custom/path'</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Which would result in URLs like
<tt>http(s)://:server/:bucket_name/my/custom/path/:id/:filename.</tt>
</p>
<h3>Using different bucket names on different models</h3>
<p>
By default the bucket name that the file will be stored to is the one
specified by the <tt>:bucket_name</tt> key in the amazon_s3.yml file. You
can use the <tt>:bucket_key</tt> option to overide this behavior on a per
model basis. For instance if you want a bucket that will hold only Photos
you can do this:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Photo constant id'>Photo</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='has_attachment identifier id'>has_attachment</span> <span class='symbol val'>:storage</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:s3</span><span class='comma token'>,</span> <span class='symbol val'>:bucket_key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:photo_bucket_name</span>
  <span class='end end kw'>end</span>
</pre>
<p>
And then your amazon_s3.yml file needs to look like this.
</p>
<pre class="code">
  <span class='development identifier id'>development</span><span class='colon op'>:</span>
    <span class='bucket_name identifier id'>bucket_name</span><span class='colon op'>:</span> <span class='appname_development identifier id'>appname_development</span>
    <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>
    <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>

  <span class='test identifier id'>test</span><span class='colon op'>:</span>
    <span class='bucket_name identifier id'>bucket_name</span><span class='colon op'>:</span> <span class='appname_test identifier id'>appname_test</span>
    <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>
    <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>

  <span class='production identifier id'>production</span><span class='colon op'>:</span>
    <span class='bucket_name identifier id'>bucket_name</span><span class='colon op'>:</span> <span class='appname identifier id'>appname</span>
    <span class='photo_bucket_name identifier id'>photo_bucket_name</span><span class='colon op'>:</span> <span class='appname_photos identifier id'>appname_photos</span>
    <span class='access_key_id identifier id'>access_key_id</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>
    <span class='secret_access_key identifier id'>secret_access_key</span><span class='colon op'>:</span> <span class='lt op'>&lt;</span><span class='your identifier id'>your</span> <span class='key identifier id'>key</span><span class='gt op'>&gt;</span>

 <span class='If constant id'>If</span> <span class='the identifier id'>the</span> <span class='bucket_key identifier id'>bucket_key</span> <span class='you identifier id'>you</span> <span class='specify identifier id'>specify</span> <span class='is identifier id'>is</span> <span class='not not kw'>not</span> <span class='there identifier id'>there</span> <span class='in in kw'>in</span> <span class='a identifier id'>a</span> <span class='certain identifier id'>certain</span> <span class='environment identifier id'>environment</span> <span class='then then kw'>then</span> <span class='attachment_fu identifier id'>attachment_fu</span> <span class='will identifier id'>will</span>
 <span class='default identifier id'>default</span> <span class='to identifier id'>to</span> <span class='the identifier id'>the</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='bucket_name identifier id'>bucket_name</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt; key.  This way you only have to create special buckets
 this can be helpful if you only need special buckets in certain environments.
</span></pre>
<h3>Permissions</h3>
<p>
By default, files are stored on S3 with public access permissions. You can
customize this using the <tt>:s3_access</tt> option to
<tt>has_attachment</tt>. Available values are <tt>:private</tt>,
<tt>:public_read_write</tt>, and <tt>:authenticated_read</tt>.
</p>
<h3>Other options</h3>
<p>
Of course, all the usual configuration options apply, such as content_type
and thumbnails:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Photo constant id'>Photo</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='has_attachment identifier id'>has_attachment</span> <span class='symbol val'>:storage</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:s3</span><span class='comma token'>,</span> <span class='symbol val'>:content_type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>'application/pdf'</span><span class='comma token'>,</span> <span class='symbol val'>:image</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:resize_to</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'x50'</span>
    <span class='has_attachment identifier id'>has_attachment</span> <span class='symbol val'>:storage</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:s3</span><span class='comma token'>,</span> <span class='symbol val'>:thumbnails</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:thumb</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='integer val'>50</span><span class='comma token'>,</span> <span class='integer val'>50</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:geometry</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'x50'</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
</pre>
<h3>Accessing S3 URLs</h3>
<p>
You can get an object&#8217;s URL using the s3_url accessor. For example,
assuming that for your postcard app you had a bucket name like
&#8216;postcard_world_development&#8217;, and an attachment model called
Photo:
</p>
<pre class="code">
  <span class='@postcard ivar id'>@postcard</span><span class='dot token'>.</span><span class='s3_url identifier id'>s3_url</span> <span class='comment val'># =&gt; http(s)://s3.amazonaws.com/postcard_world_development/photos/1/mexico.jpg</span>
</pre>
<p>
The resulting url is in the form:
http(s)://:server/:bucket_name/:table_name/:id/:file. The optional
thumbnail argument will output the thumbnail&#8217;s filename (if any).
</p>
<p>
Additionally, you can get an object&#8217;s base path relative to the
bucket root using <tt>base_path</tt>:
</p>
<pre class="code">
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='file_base_path identifier id'>file_base_path</span> <span class='comment val'># =&gt; photos/1</span>
</pre>
<p>
And the full path (including the filename) using <tt>full_filename</tt>:
</p>
<pre class="code">
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='full_filename identifier id'>full_filename</span> <span class='comment val'># =&gt; photos/</span>
</pre>
<p>
Niether <tt>base_path</tt> or <tt>full_filename</tt> include the bucket
name as part of the path. You can retrieve the bucket name using the
<tt>bucket_name</tt> method.
</p>
<h3>Accessing CloudFront URLs</h3>
<p>
You can get an object&#8217;s CloudFront URL using the cloudfront_url
accessor. Using the example from above:
</p>

</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#distribution_domain-class_method">distribution_domain</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#hostname-class_method">hostname</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#included-class_method">included</span><span class='args'>(base)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#port_string-class_method">port_string</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#protocol-class_method">protocol</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attachment_path_id-instance_method">#attachment_path_id</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The attachment ID used in the full path of a file.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#authenticated_s3_url-instance_method">#authenticated_s3_url</span><span class='args'>(*args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
All private objects are accessible via an authenticated GET request to the
S3 servers.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#base_path-instance_method">#base_path</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The pseudo hierarchy containing the file relative to the bucket name
Example: <tt>:table_name/:id</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#cloudfront_distribution_domain-instance_method">#cloudfront_distribution_domain</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#cloudfront_url-instance_method">#cloudfront_url</span><span class='args'>(thumbnail = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
All public objects are accessible via a GET request to CloudFront.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#create_temp_file-instance_method">#create_temp_file</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#current_data-instance_method">#current_data</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#filename-3D-instance_method">#filename=</span><span class='args'>(value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Overwrites the base filename writer in order to store the old filename.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#full_filename-instance_method">#full_filename</span><span class='args'>(thumbnail = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The full path to the file relative to the bucket name Example:
<tt>:table_name/:id/:filename</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#public_filename-instance_method">#public_filename</span><span class='args'>(*args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#s3_hostname-instance_method">#s3_hostname</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#s3_port_string-instance_method">#s3_port_string</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#s3_protocol-instance_method">#s3_protocol</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#s3_url-instance_method">#s3_url</span><span class='args'>(thumbnail = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
All public objects are accessible via a GET request to the S3 servers.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>distribution_domain</h3>
</div><div id="distribution_domain-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>distribution_domain</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 220</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L220">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">220
221
222</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='distribution_domain identifier id'>distribution_domain</span>
  <span class='@distribution_domain ivar id'>@distribution_domain</span> <span class='assign token'>=</span> <span class='s3_config identifier id'>s3_config</span><span class='lbrack token'>[</span><span class='symbol val'>:distribution_domain</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>hostname</h3>
</div><div id="hostname-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>hostname</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 212</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L212">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">212
213
214</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='hostname identifier id'>hostname</span>
  <span class='@hostname ivar id'>@hostname</span> <span class='opasgn op'>||=</span> <span class='s3_config identifier id'>s3_config</span><span class='lbrack token'>[</span><span class='symbol val'>:server</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='AWS constant id'>AWS</span><span class='colon2 op'>::</span><span class='S3 constant id'>S3</span><span class='colon2 op'>::</span><span class='DEFAULT_HOST constant id'>DEFAULT_HOST</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>included</h3>
</div><div id="included-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>included</span><span class='args'>(base)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 175</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L175">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='included identifier id'>included</span><span class='lparen token'>(</span><span class='base identifier id'>base</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='mattr_reader identifier id'>mattr_reader</span> <span class='symbol val'>:bucket_name</span><span class='comma token'>,</span> <span class='symbol val'>:s3_config</span>

  <span class='begin begin kw'>begin</span>
    <span class='require identifier id'>require</span> <span class='string val'>'aws/s3'</span>
    <span class='include identifier id'>include</span> <span class='AWS constant id'>AWS</span><span class='colon2 op'>::</span><span class='S3 constant id'>S3</span>
  <span class='rescue rescue kw'>rescue</span> <span class='LoadError constant id'>LoadError</span>
    <span class='raise identifier id'>raise</span> <span class='RequiredLibraryNotFoundError constant id'>RequiredLibraryNotFoundError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'AWS::S3 could not be loaded'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='begin begin kw'>begin</span>
    <span class='@@s3_config_path ivar id'>@@s3_config_path</span> <span class='assign token'>=</span> <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='attachment_options identifier id'>attachment_options</span><span class='lbrack token'>[</span><span class='symbol val'>:s3_config_path</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='lparen token'>(</span><span class='RAILS_ROOT constant id'>RAILS_ROOT</span> <span class='plus op'>+</span> <span class='string val'>'/config/amazon_s3.yml'</span><span class='rparen token'>)</span>
    <span class='@@s3_config ivar id'>@@s3_config</span> <span class='assign token'>=</span> <span class='@@s3_config ivar id'>@@s3_config</span> <span class='assign token'>=</span> <span class='YAML constant id'>YAML</span><span class='dot token'>.</span><span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='ERB constant id'>ERB</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='@@s3_config_path ivar id'>@@s3_config_path</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='result identifier id'>result</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='RAILS_ENV constant id'>RAILS_ENV</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='symbolize_keys identifier id'>symbolize_keys</span>
  <span class='comment val'>#rescue</span>
  <span class='comment val'>#  raise ConfigFileNotFoundError.new('File %s not found' % @@s3_config_path)</span>
  <span class='end end kw'>end</span>

  <span class='bucket_key identifier id'>bucket_key</span> <span class='assign token'>=</span> <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='attachment_options identifier id'>attachment_options</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket_key</span><span class='rbrack token'>]</span>

  <span class='if if kw'>if</span> <span class='bucket_key identifier id'>bucket_key</span> <span class='and and kw'>and</span> <span class='s3_config identifier id'>s3_config</span><span class='lbrack token'>[</span><span class='bucket_key identifier id'>bucket_key</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span><span class='rbrack token'>]</span>
    <span class='eval_string identifier id'>eval_string</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;def bucket_name()\n  \&quot;#{s3_config[bucket_key.to_sym]}\&quot;\nend&quot;</span>
  <span class='else else kw'>else</span>
    <span class='eval_string identifier id'>eval_string</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;def bucket_name()\n  \&quot;#{s3_config[:bucket_name]}\&quot;\nend&quot;</span>
  <span class='end end kw'>end</span>
  <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='class_eval identifier id'>class_eval</span><span class='lparen token'>(</span><span class='eval_string identifier id'>eval_string</span><span class='comma token'>,</span> <span class='__FILE__ __file__ kw'>__FILE__</span><span class='comma token'>,</span> <span class='__LINE__ __line__ kw'>__LINE__</span><span class='rparen token'>)</span>

  <span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='establish_connection! fid id'>establish_connection!</span><span class='lparen token'>(</span><span class='s3_config identifier id'>s3_config</span><span class='dot token'>.</span><span class='slice identifier id'>slice</span><span class='lparen token'>(</span><span class='symbol val'>:access_key_id</span><span class='comma token'>,</span> <span class='symbol val'>:secret_access_key</span><span class='comma token'>,</span> <span class='symbol val'>:server</span><span class='comma token'>,</span> <span class='symbol val'>:port</span><span class='comma token'>,</span> <span class='symbol val'>:use_ssl</span><span class='comma token'>,</span> <span class='symbol val'>:persistent</span><span class='comma token'>,</span> <span class='symbol val'>:proxy</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

  <span class='comment val'># Bucket.create(@@bucket_name)</span>

  <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='before_update identifier id'>before_update</span> <span class='symbol val'>:rename_file</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>port_string</h3>
</div><div id="port_string-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>port_string</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 216</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L216">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">216
217
218</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='port_string identifier id'>port_string</span>
  <span class='@port_string ivar id'>@port_string</span> <span class='opasgn op'>||=</span> <span class='lparen token'>(</span><span class='s3_config identifier id'>s3_config</span><span class='lbrack token'>[</span><span class='symbol val'>:port</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='orop op'>||</span> <span class='s3_config identifier id'>s3_config</span><span class='lbrack token'>[</span><span class='symbol val'>:port</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='lparen token'>(</span><span class='s3_config identifier id'>s3_config</span><span class='lbrack token'>[</span><span class='symbol val'>:use_ssl</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='integer val'>443</span> <span class='colon op'>:</span> <span class='integer val'>80</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='string val'>''</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;:#{s3_config[:port]}&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>protocol</h3>
</div><div id="protocol-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>protocol</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 208</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L208">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">208
209
210</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='protocol identifier id'>protocol</span>
  <span class='@protocol ivar id'>@protocol</span> <span class='opasgn op'>||=</span> <span class='s3_config identifier id'>s3_config</span><span class='lbrack token'>[</span><span class='symbol val'>:use_ssl</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='string val'>'https://'</span> <span class='colon op'>:</span> <span class='string val'>'http://'</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>attachment_path_id</h3>
</div><div id="attachment_path_id-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attachment_path_id</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The attachment ID used in the full path of a file
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 249</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L249">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">249
250
251</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attachment_path_id identifier id'>attachment_path_id</span>
  <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:parent_id</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='parent_id identifier id'>parent_id</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='id identifier id'>id</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>authenticated_s3_url</h3>
</div><div id="authenticated_s3_url-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>authenticated_s3_url</span><span class='args'>(*args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
All private objects are accessible via an authenticated GET request to the
S3 servers. You can generate an authenticated url for an object like this:
</p>
<pre class="code">
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='authenticated_s3_url identifier id'>authenticated_s3_url</span>
</pre>
<p>
By default authenticated urls expire 5 minutes after they were generated.
</p>
<p>
Expiration options can be specified either with an absolute time using the
<tt>:expires</tt> option, or with a number of seconds relative to now with
the <tt>:expires_in</tt> option:
</p>
<pre class="code">
  <span class='comment val'># Absolute expiration date (October 13th, 2025)</span>
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='authenticated_s3_url identifier id'>authenticated_s3_url</span><span class='lparen token'>(</span><span class='symbol val'>:expires</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='mktime identifier id'>mktime</span><span class='lparen token'>(</span><span class='integer val'>2025</span><span class='comma token'>,</span><span class='integer val'>10</span><span class='comma token'>,</span><span class='integer val'>13</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='rparen token'>)</span>

  <span class='comment val'># Expiration in five hours from now</span>
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='authenticated_s3_url identifier id'>authenticated_s3_url</span><span class='lparen token'>(</span><span class='symbol val'>:expires_in</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='float val'>5</span><span class='dot token'>.</span><span class='hours identifier id'>hours</span><span class='rparen token'>)</span>
</pre>
<p>
You can specify whether the url should go over SSL with the
<tt>:use_ssl</tt> option. By default, the ssl settings for the current
connection will be used:
</p>
<pre class="code">
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='authenticated_s3_url identifier id'>authenticated_s3_url</span><span class='lparen token'>(</span><span class='symbol val'>:use_ssl</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
</pre>
<p>
Finally, the optional thumbnail argument will output the thumbnail&#8217;s
filename (if any):
</p>
<pre class="code">
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='authenticated_s3_url identifier id'>authenticated_s3_url</span><span class='lparen token'>(</span><span class='string val'>'thumbnail'</span><span class='comma token'>,</span> <span class='symbol val'>:expires_in</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='float val'>5</span><span class='dot token'>.</span><span class='hours identifier id'>hours</span><span class='comma token'>,</span> <span class='symbol val'>:use_ssl</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 324</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L324">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">324
325
326
327
328
329</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='authenticated_s3_url identifier id'>authenticated_s3_url</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span>   <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='extract_options! fid id'>extract_options!</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:expires_in</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:expires_in</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:expires_in</span><span class='rbrack token'>]</span>
  <span class='thumbnail identifier id'>thumbnail</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span>
  <span class='S3Object constant id'>S3Object</span><span class='dot token'>.</span><span class='url_for identifier id'>url_for</span><span class='lparen token'>(</span><span class='full_filename identifier id'>full_filename</span><span class='lparen token'>(</span><span class='thumbnail identifier id'>thumbnail</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='bucket_name identifier id'>bucket_name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>base_path</h3>
</div><div id="base_path-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>base_path</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The pseudo hierarchy containing the file relative to the bucket name
Example: <tt>:table_name/:id</tt>
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 255</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L255">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">255
256
257</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='base_path identifier id'>base_path</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='attachment_options identifier id'>attachment_options</span><span class='lbrack token'>[</span><span class='symbol val'>:path_prefix</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='attachment_path_id identifier id'>attachment_path_id</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>cloudfront_distribution_domain</h3>
</div><div id="cloudfront_distribution_domain-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>cloudfront_distribution_domain</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 351</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L351">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">351
352
353</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='cloudfront_distribution_domain identifier id'>cloudfront_distribution_domain</span>
  <span class='Technoweenie constant id'>Technoweenie</span><span class='colon2 op'>::</span><span class='AttachmentFu constant id'>AttachmentFu</span><span class='colon2 op'>::</span><span class='Backends constant id'>Backends</span><span class='colon2 op'>::</span><span class='S3Backend constant id'>S3Backend</span><span class='dot token'>.</span><span class='distribution_domain identifier id'>distribution_domain</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>cloudfront_url</h3>
</div><div id="cloudfront_url-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>cloudfront_url</span><span class='args'>(thumbnail = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
All public objects are accessible via a GET request to CloudFront. You can
generate a url for an object using the cloudfront_url method.
</p>
<pre class="code">
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='cloudfront_url identifier id'>cloudfront_url</span>
</pre>
<p>
The resulting url is in the form:
<tt>http://:distribution_domain/:table_name/:id/:file</tt> using the
<tt>:distribution_domain</tt> variable set in the configuration parameters
in <tt>RAILS_ROOT/config/amazon_s3.yml</tt>.
</p>
<p>
The optional thumbnail argument will output the thumbnail&#8217;s filename
(if any).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 288</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L288">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">288
289
290</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='cloudfront_url identifier id'>cloudfront_url</span><span class='lparen token'>(</span><span class='thumbnail identifier id'>thumbnail</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='string val'>&quot;http://&quot;</span> <span class='plus op'>+</span> <span class='cloudfront_distribution_domain identifier id'>cloudfront_distribution_domain</span> <span class='plus op'>+</span> <span class='string val'>&quot;/&quot;</span> <span class='plus op'>+</span> <span class='full_filename identifier id'>full_filename</span><span class='lparen token'>(</span><span class='thumbnail identifier id'>thumbnail</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>create_temp_file</h3>
</div><div id="create_temp_file-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create_temp_file</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 331</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L331">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">331
332
333</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='create_temp_file identifier id'>create_temp_file</span>
  <span class='write_to_temp_file identifier id'>write_to_temp_file</span> <span class='current_data identifier id'>current_data</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>current_data</h3>
</div><div id="current_data-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>current_data</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 335</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L335">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">335
336
337</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='current_data identifier id'>current_data</span>
  <span class='S3Object constant id'>S3Object</span><span class='dot token'>.</span><span class='value identifier id'>value</span> <span class='full_filename identifier id'>full_filename</span><span class='comma token'>,</span> <span class='bucket_name identifier id'>bucket_name</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>filename=</h3>
</div><div id="filename-3D-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>filename=</span><span class='args'>(value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Overwrites the base filename writer in order to store the old filename
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 243</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L243">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">243
244
245
246</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='filename= identifier id'>filename=</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='@old_filename ivar id'>@old_filename</span> <span class='assign token'>=</span> <span class='filename identifier id'>filename</span> <span class='unless unless_mod kw'>unless</span> <span class='filename identifier id'>filename</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='orop op'>||</span> <span class='@old_filename ivar id'>@old_filename</span>
  <span class='write_attribute identifier id'>write_attribute</span> <span class='symbol val'>:filename</span><span class='comma token'>,</span> <span class='sanitize_filename identifier id'>sanitize_filename</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>full_filename</h3>
</div><div id="full_filename-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>full_filename</span><span class='args'>(thumbnail = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The full path to the file relative to the bucket name Example:
<tt>:table_name/:id/:filename</tt>
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 261</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L261">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">261
262
263</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='full_filename identifier id'>full_filename</span><span class='lparen token'>(</span><span class='thumbnail identifier id'>thumbnail</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='base_path identifier id'>base_path</span><span class='comma token'>,</span> <span class='thumbnail_name_for identifier id'>thumbnail_name_for</span><span class='lparen token'>(</span><span class='thumbnail identifier id'>thumbnail</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>public_filename</h3>
</div><div id="public_filename-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>public_filename</span><span class='args'>(*args)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 292</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L292">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">292
293
294
295
296
297
298</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='public_filename identifier id'>public_filename</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='attachment_options identifier id'>attachment_options</span><span class='lbrack token'>[</span><span class='symbol val'>:cloudfront</span><span class='rbrack token'>]</span>
    <span class='cloudfront_url identifier id'>cloudfront_url</span><span class='lparen token'>(</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='s3_url identifier id'>s3_url</span><span class='lparen token'>(</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>s3_hostname</h3>
</div><div id="s3_hostname-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>s3_hostname</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 343</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L343">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">343
344
345</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='s3_hostname identifier id'>s3_hostname</span>
  <span class='Technoweenie constant id'>Technoweenie</span><span class='colon2 op'>::</span><span class='AttachmentFu constant id'>AttachmentFu</span><span class='colon2 op'>::</span><span class='Backends constant id'>Backends</span><span class='colon2 op'>::</span><span class='S3Backend constant id'>S3Backend</span><span class='dot token'>.</span><span class='hostname identifier id'>hostname</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>s3_port_string</h3>
</div><div id="s3_port_string-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>s3_port_string</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 347</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L347">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">347
348
349</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='s3_port_string identifier id'>s3_port_string</span>
  <span class='Technoweenie constant id'>Technoweenie</span><span class='colon2 op'>::</span><span class='AttachmentFu constant id'>AttachmentFu</span><span class='colon2 op'>::</span><span class='Backends constant id'>Backends</span><span class='colon2 op'>::</span><span class='S3Backend constant id'>S3Backend</span><span class='dot token'>.</span><span class='port_string identifier id'>port_string</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>s3_protocol</h3>
</div><div id="s3_protocol-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>s3_protocol</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 339</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L339">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">339
340
341</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='s3_protocol identifier id'>s3_protocol</span>
  <span class='Technoweenie constant id'>Technoweenie</span><span class='colon2 op'>::</span><span class='AttachmentFu constant id'>AttachmentFu</span><span class='colon2 op'>::</span><span class='Backends constant id'>Backends</span><span class='colon2 op'>::</span><span class='S3Backend constant id'>S3Backend</span><span class='dot token'>.</span><span class='protocol identifier id'>protocol</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>s3_url</h3>
</div><div id="s3_url-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>s3_url</span><span class='args'>(thumbnail = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
All public objects are accessible via a GET request to the S3 servers. You
can generate a url for an object using the s3_url method.
</p>
<pre class="code">
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='s3_url identifier id'>s3_url</span>
</pre>
<p>
The resulting url is in the form:
<tt>http(s)://:server/:bucket_name/:table_name/:id/:file</tt> where the
<tt>:server</tt> variable defaults to <tt>AWS::S3 URL::DEFAULT_HOST</tt>
(s3.amazonaws.com) and can be set using the configuration parameters in
<tt>RAILS_ROOT/config/amazon_s3.yml</tt>.
</p>
<p>
The optional thumbnail argument will output the thumbnail&#8217;s filename
(if any).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/technoweenie/attachment_fu/backends/s3_backend.rb', line 275</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/technoweenie/attachment_fu/blob/fa08cb03914b02b66853b4615cd3eca768291ca7/lib/technoweenie/attachment_fu/backends/s3_backend.rb#L275">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">275
276
277</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='s3_url identifier id'>s3_url</span><span class='lparen token'>(</span><span class='thumbnail identifier id'>thumbnail</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='s3_protocol identifier id'>s3_protocol</span> <span class='plus op'>+</span> <span class='s3_hostname identifier id'>s3_hostname</span> <span class='plus op'>+</span> <span class='s3_port_string identifier id'>s3_port_string</span><span class='comma token'>,</span> <span class='bucket_name identifier id'>bucket_name</span><span class='comma token'>,</span> <span class='full_filename identifier id'>full_filename</span><span class='lparen token'>(</span><span class='thumbnail identifier id'>thumbnail</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>