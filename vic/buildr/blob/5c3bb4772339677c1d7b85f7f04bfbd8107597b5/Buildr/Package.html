<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>vic's buildr - Module: Buildr::Package - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/vic/commits/buildr/master" rel="alternate" title="Recent Commits to buildr:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("vic", "buildr", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='vic/buildr/blob/5c3bb4772339677c1d7b85f7f04bfbd8107597b5' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='vic/buildr/blob/5c3bb4772339677c1d7b85f7f04bfbd8107597b5' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("vic", "buildr", "5c3bb4772339677c1d7b85f7f04bfbd8107597b5", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/vic/buildr/tree/">Source</a></li>
            <li class=""><a href="http://github.com/vic/buildr/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/vic/buildr/network">Network</a></li>            
            <li class=""><a href="http://github.com/vic/buildr/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/vic/buildr">Wiki</a></li>
            <li class=""><a href="http://github.com/vic/buildr/graphs">Graphs</a></li>                    
            <li class="active"><a href="/vic/buildr">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/vic">vic</a> / <b><a href="http://github.com/vic/buildr/tree">buildr</a></b>        
                <a id="namespaces_button" rel="vic/buildr/blob/5c3bb4772339677c1d7b85f7f04bfbd8107597b5" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="vic/buildr/blob/5c3bb4772339677c1d7b85f7f04bfbd8107597b5" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Buildr_Package">
  <h1>Module: Buildr::Package</h1>
  <div class="section mixins">
  <h2>Included Modules</h2>
  <p><a href="Package/Extension.html" title="Buildr::Extension">Buildr::Extension</a></p>
</div><div class="section docstring">
  <p>
Methods added to Project to support packaging and tasks for packaging,
installing and uploading packages.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">group</td>
          <td class="readwrite">
            [<span id='group-instance_method'>R</span><span id='group=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Group used for packaging.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">version</td>
          <td class="readwrite">
            [<span id='version-instance_method'>R</span><span id='version=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Version used for packaging.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#id-instance_method">#id</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The project&#8217;s identifier.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#package-instance_method">#package</span><span class='args'>(*args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
:call-seq:
</p>
<pre class="code">
  <span class='package identifier id'>package</span><span class='lparen token'>(</span><span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='spec? fid id'>spec?</span><span class='rparen token'>)</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='task identifier id'>task</span><span class='dot token'>.</span>
</pre>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#packages-instance_method">#packages</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
:call-seq:
</p>
<pre class="code">
  <span class='packages identifier id'>packages</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='tasks identifier id'>tasks</span><span class='dot token'>.</span>
</pre>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>id</h3>
</div><div id="id-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>id</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The project&#8217;s identifier. Same as the project name, with colons
replaced by dashes. The ID for project foo:bar is foo-bar.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/buildr/packaging/package.rb', line 57</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/vic/buildr/blob/5c3bb4772339677c1d7b85f7f04bfbd8107597b5/lib/buildr/packaging/package.rb#L57">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">57
58
59</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='id identifier id'>id</span>
  <span class='name identifier id'>name</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='string val'>':'</span><span class='comma token'>,</span> <span class='string val'>'-'</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>package</h3>
</div><div id="package-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>package</span><span class='args'>(*args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
:call-seq:
</p>
<pre class="code">
  <span class='package identifier id'>package</span><span class='lparen token'>(</span><span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='spec? fid id'>spec?</span><span class='rparen token'>)</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='task identifier id'>task</span>
</pre>
<p>
Defines and returns a package created by this project.
</p>
<p>
The first argument declares the package type. For example, :jar to create a
JAR file. The package is an artifact that takes its artifact specification
from the project. You can override the artifact specification by passing
various options in the second argument, for example:
</p>
<pre class="code">
  <span class='package identifier id'>package</span><span class='lparen token'>(</span><span class='symbol val'>:zip</span><span class='comma token'>,</span> <span class='symbol val'>:classifier=</span><span class='gt op'>&gt;</span><span class='string val'>'sources'</span><span class='rparen token'>)</span>
</pre>
<p>
Packages that are ZIP files provides various ways to include additional
files, directories, and even merge ZIPs together. Have a look at ZipTask
for more information. In case you&#8217;re wondering, JAR and WAR packages
are ZIP files.
</p>
<p>
You can also enhance a JAR package using the ZipTask#with method that
accepts the following options:
</p>
<ul>
<li>:manifest &#8212; Specifies how to create the MANIFEST.MF. By default, uses
the project&#8217;s #manifest property.

</li>
<li>:meta_inf &#8212; Specifies files to be included in the META-INF directory.
By default, uses the project&#8217;s #meta-inf property.

</li>
</ul>
<p>
The WAR package supports the same options and adds a few more:
</p>
<ul>
<li>:classes &#8212; Directories of class files to include in WEB-INF/classes.
Includes the compile target directory by default.

</li>
<li>:libs &#8212; Artifacts and files to include in WEB-INF/libs. Includes the
compile classpath dependencies by default.

</li>
</ul>
<p>
For example:
</p>
<pre class="code">
  <span class='define identifier id'>define</span> <span class='string val'>'project'</span> <span class='do do kw'>do</span>
    <span class='define identifier id'>define</span> <span class='string val'>'beans'</span> <span class='do do kw'>do</span>
      <span class='package identifier id'>package</span> <span class='symbol val'>:jar</span>
    <span class='end end kw'>end</span>
    <span class='define identifier id'>define</span> <span class='string val'>'webapp'</span> <span class='do do kw'>do</span>
      <span class='compile identifier id'>compile</span><span class='dot token'>.</span><span class='with identifier id'>with</span> <span class='project identifier id'>project</span><span class='lparen token'>(</span><span class='string val'>'beans'</span><span class='rparen token'>)</span>
      <span class='package identifier id'>package</span><span class='lparen token'>(</span><span class='symbol val'>:war</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='with identifier id'>with</span> <span class='symbol val'>:libs=</span><span class='gt op'>&gt;</span><span class='MYSQL_JDBC constant id'>MYSQL_JDBC</span>
    <span class='end end kw'>end</span>
    <span class='package identifier id'>package</span><span class='lparen token'>(</span><span class='symbol val'>:zip</span><span class='comma token'>,</span> <span class='symbol val'>:classifier=</span><span class='gt op'>&gt;</span><span class='string val'>'sources'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='include identifier id'>include</span> <span class='path_to identifier id'>path_to</span><span class='lparen token'>(</span><span class='string val'>'.'</span><span class='rparen token'>)</span>
 <span class='end end kw'>end</span>
</pre>
<p>
Two other packaging types are:
</p>
<ul>
<li>package :sources &#8212; Creates a ZIP file with the source code and
classifier &#8216;sources&#8217;, for use by IDEs.

</li>
<li>package :javadoc &#8212; Creates a ZIP file with the Javadocs and
classifier &#8216;javadoc&#8217;. You can use the javadoc method to further
customize it.

</li>
</ul>
<p>
A package is also an artifact. The following tasks operate on packages
created by the project:
</p>
<pre class="code">
  <span class='buildr identifier id'>buildr</span> <span class='upload identifier id'>upload</span>     <span class='comment val'># Upload packages created by the project</span>
  <span class='buildr identifier id'>buildr</span> <span class='install identifier id'>install</span>    <span class='comment val'># Install packages created by the project</span>
  <span class='buildr identifier id'>buildr</span> <span class='package identifier id'>package</span>    <span class='comment val'># Create packages</span>
  <span class='buildr identifier id'>buildr</span> <span class='uninstall identifier id'>uninstall</span>  <span class='comment val'># Remove previously installed packages</span>
</pre>
<p>
If you want to add additional packaging types, implement a method with the
name package_as_[type] that accepts a file name and returns an appropriate
Rake task. For example:
</p>
<pre class="code">
  <span class='def def kw'>def</span> <span class='package_as_zip identifier id'>package_as_zip</span><span class='lparen token'>(</span><span class='file_name identifier id'>file_name</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
    <span class='ZipTask constant id'>ZipTask</span><span class='dot token'>.</span><span class='define_task identifier id'>define_task</span><span class='lparen token'>(</span><span class='file_name identifier id'>file_name</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
</pre>
<p>
The file name is determined from the specification passed to the package
method, however, some packagers need to override this. For example,
package(:sources) produces a file with the extension &#8216;zip&#8217; and
the classifier &#8216;sources&#8217;. If you need to overwrite the default
implementation, you should also include a method named
package_as_[type]_respec. For example:
</p>
<pre class="code">
  <span class='def def kw'>def</span> <span class='package_as_sources_spec identifier id'>package_as_sources_spec</span><span class='lparen token'>(</span><span class='spec identifier id'>spec</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
    <span class='lbrace token'>{</span> <span class='symbol val'>:type=</span><span class='gt op'>&gt;</span><span class='symbol val'>:zip</span><span class='comma token'>,</span> <span class='symbol val'>:classifier=</span><span class='gt op'>&gt;</span><span class='string val'>'sources'</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='spec identifier id'>spec</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/buildr/packaging/package.rb', line 130</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/vic/buildr/blob/5c3bb4772339677c1d7b85f7f04bfbd8107597b5/lib/buildr/packaging/package.rb#L130">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='package identifier id'>package</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='spec identifier id'>spec</span> <span class='assign token'>=</span> <span class='Hash constant id'>Hash</span> <span class='eqq op'>===</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='last identifier id'>last</span> <span class='integer val'>? </span><span class='args identifier id'>args</span><span class='dot token'>.</span><span class='pop identifier id'>pop</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span> <span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='if if kw'>if</span> <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:file</span><span class='rbrack token'>]</span>
    <span class='rake_check_options identifier id'>rake_check_options</span> <span class='spec identifier id'>spec</span><span class='comma token'>,</span> <span class='symbol val'>:file</span><span class='comma token'>,</span> <span class='symbol val'>:type</span>
    <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:type</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span> <span class='orop op'>||</span> <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:type</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:file</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'.'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='last identifier id'>last</span>
    <span class='file_name identifier id'>file_name</span> <span class='assign token'>=</span> <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:file</span><span class='rbrack token'>]</span>
  <span class='else else kw'>else</span>
    <span class='rake_check_options identifier id'>rake_check_options</span> <span class='spec identifier id'>spec</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='ActsAsArtifact constant id'>ActsAsArtifact</span><span class='colon2 op'>::</span><span class='ARTIFACT_ATTRIBUTES constant id'>ARTIFACT_ATTRIBUTES</span>
    <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:id</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='id identifier id'>id</span>
    <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:group</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='group identifier id'>group</span>
    <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:version</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='version identifier id'>version</span>
    <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:type</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span> <span class='orop op'>||</span> <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:type</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='compile identifier id'>compile</span><span class='dot token'>.</span><span class='packaging identifier id'>packaging</span> <span class='orop op'>||</span> <span class='symbol val'>:zip</span>
  <span class='end end kw'>end</span>

  <span class='packager identifier id'>packager</span> <span class='assign token'>=</span> <span class='method identifier id'>method</span><span class='lparen token'>(</span><span class='dstring node'>&quot;package_as_#{spec[:type]}&quot;</span><span class='rparen token'>)</span> <span class='rescue rescue kw'>rescue</span> <span class='fail identifier id'>fail</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Don't know how to create a package of type #{spec[:type]}&quot;</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='packager identifier id'>packager</span><span class='dot token'>.</span><span class='arity identifier id'>arity</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
    <span class='unless unless kw'>unless</span> <span class='file_name identifier id'>file_name</span>
      <span class='spec identifier id'>spec</span> <span class='assign token'>=</span> <span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='dstring node'>&quot;package_as_#{spec[:type]}_spec&quot;</span><span class='comma token'>,</span> <span class='spec identifier id'>spec</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='dstring node'>&quot;package_as_#{spec[:type]}_spec&quot;</span><span class='rparen token'>)</span>
      <span class='file_name identifier id'>file_name</span> <span class='assign token'>=</span> <span class='path_to identifier id'>path_to</span><span class='lparen token'>(</span><span class='symbol val'>:target</span><span class='comma token'>,</span> <span class='Artifact constant id'>Artifact</span><span class='dot token'>.</span><span class='hash_to_file_name identifier id'>hash_to_file_name</span><span class='lparen token'>(</span><span class='spec identifier id'>spec</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='package identifier id'>package</span> <span class='assign token'>=</span> <span class='packages identifier id'>packages</span><span class='dot token'>.</span><span class='find identifier id'>find</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='pkg identifier id'>pkg</span><span class='bitor op'>|</span> <span class='pkg identifier id'>pkg</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='eq op'>==</span> <span class='file_name identifier id'>file_name</span> <span class='rbrace token'>}</span> <span class='orop op'>||</span> <span class='packager identifier id'>packager</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='file_name identifier id'>file_name</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='Buildr constant id'>Buildr</span><span class='dot token'>.</span><span class='application identifier id'>application</span><span class='dot token'>.</span><span class='deprecated identifier id'>deprecated</span> <span class='string val'>&quot;We changed the way package_as methods are implemented.  See the package method documentation for more details.&quot;</span>
    <span class='file_name identifier id'>file_name</span> <span class='opasgn op'>||=</span> <span class='path_to identifier id'>path_to</span><span class='lparen token'>(</span><span class='symbol val'>:target</span><span class='comma token'>,</span> <span class='Artifact constant id'>Artifact</span><span class='dot token'>.</span><span class='hash_to_file_name identifier id'>hash_to_file_name</span><span class='lparen token'>(</span><span class='spec identifier id'>spec</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='package identifier id'>package</span> <span class='assign token'>=</span> <span class='packager identifier id'>packager</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='file_name identifier id'>file_name</span><span class='comma token'>,</span> <span class='spec identifier id'>spec</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># First time: prepare package for install, uninstall and upload tasks.</span>
  <span class='unless unless kw'>unless</span> <span class='packages identifier id'>packages</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='package identifier id'>package</span><span class='rparen token'>)</span>
    <span class='comment val'># We already run build before package, but we also need to do so if the package itself is</span>
    <span class='comment val'># used as a dependency, before we get to run the package task.</span>
    <span class='task identifier id'>task</span> <span class='string val'>'package'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='package identifier id'>package</span>
    <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='enhance identifier id'>enhance</span> <span class='lbrack token'>[</span><span class='task identifier id'>task</span><span class='lparen token'>(</span><span class='string val'>'build'</span><span class='rparen token'>)</span><span class='rbrack token'>]</span>
    <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='enhance identifier id'>enhance</span> <span class='lbrace token'>{</span> <span class='info identifier id'>info</span> <span class='dstring node'>&quot;Packaging #{File.basename(file_name)}&quot;</span> <span class='rbrace token'>}</span>

    <span class='if if kw'>if</span> <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:file</span><span class='rbrack token'>]</span>
      <span class='class class kw'>class</span> <span class='lshft op'>&lt;&lt;</span> <span class='package identifier id'>package</span> <span class='semicolon token'>;</span> <span class='self self kw'>self</span> <span class='semicolon token'>;</span> <span class='end end kw'>end</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='symbol val'>:define_method</span><span class='comma token'>,</span> <span class='symbol val'>:type</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='spec identifier id'>spec</span><span class='lbrack token'>[</span><span class='symbol val'>:type</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
    <span class='elsif elsif kw'>elsif</span> <span class='notop op'>!</span><span class='package identifier id'>package</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:install</span><span class='rparen token'>)</span>
      <span class='comment val'># Make it an artifact using the specifications, and tell it how to create a POM.</span>
      <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='extend identifier id'>extend</span> <span class='ActsAsArtifact constant id'>ActsAsArtifact</span>
      <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='symbol val'>:apply_spec</span><span class='comma token'>,</span> <span class='spec identifier id'>spec</span><span class='dot token'>.</span><span class='only identifier id'>only</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='Artifact constant id'>Artifact</span><span class='colon2 op'>::</span><span class='ARTIFACT_ATTRIBUTES constant id'>ARTIFACT_ATTRIBUTES</span><span class='rparen token'>)</span>
      <span class='comment val'># Another task to create the POM file.</span>
      <span class='pom identifier id'>pom</span> <span class='assign token'>=</span> <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='pom identifier id'>pom</span>
      <span class='pom identifier id'>pom</span><span class='dot token'>.</span><span class='enhance identifier id'>enhance</span> <span class='do do kw'>do</span>
        <span class='mkpath identifier id'>mkpath</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='pom identifier id'>pom</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
        <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='pom identifier id'>pom</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='file identifier id'>file</span><span class='bitor op'>|</span> <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='write identifier id'>write</span> <span class='pom identifier id'>pom</span><span class='dot token'>.</span><span class='pom_xml identifier id'>pom_xml</span> <span class='rbrace token'>}</span>
      <span class='end end kw'>end</span>
      <span class='file identifier id'>file</span><span class='lparen token'>(</span><span class='Buildr constant id'>Buildr</span><span class='dot token'>.</span><span class='repositories identifier id'>repositories</span><span class='dot token'>.</span><span class='locate identifier id'>locate</span><span class='lparen token'>(</span><span class='package identifier id'>package</span><span class='rparen token'>)</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='package identifier id'>package</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='install identifier id'>install</span> <span class='rbrace token'>}</span>

      <span class='comment val'># Add the package to the list of packages created by this project, and</span>
      <span class='comment val'># register it as an artifact. The later is required so if we look up the spec</span>
      <span class='comment val'># we find the package in the project's target directory, instead of finding it</span>
      <span class='comment val'># in the local repository and attempting to install it.</span>
      <span class='Artifact constant id'>Artifact</span><span class='dot token'>.</span><span class='register identifier id'>register</span> <span class='package identifier id'>package</span><span class='comma token'>,</span> <span class='pom identifier id'>pom</span>
    <span class='end end kw'>end</span>

    <span class='task identifier id'>task</span><span class='lparen token'>(</span><span class='string val'>'install'</span><span class='rparen token'>)</span>   <span class='lbrace token'>{</span> <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='install identifier id'>install</span> <span class='if if_mod kw'>if</span> <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:install</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='task identifier id'>task</span><span class='lparen token'>(</span><span class='string val'>'uninstall'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='uninstall identifier id'>uninstall</span> <span class='if if_mod kw'>if</span> <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:uninstall</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='task identifier id'>task</span><span class='lparen token'>(</span><span class='string val'>'upload'</span><span class='rparen token'>)</span>    <span class='lbrace token'>{</span> <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='upload identifier id'>upload</span> <span class='if if_mod kw'>if</span> <span class='package identifier id'>package</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:upload</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>

    <span class='packages identifier id'>packages</span> <span class='lshft op'>&lt;&lt;</span> <span class='package identifier id'>package</span>
  <span class='end end kw'>end</span>
  <span class='package identifier id'>package</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>packages</h3>
</div><div id="packages-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>packages</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
:call-seq:
</p>
<pre class="code">
  <span class='packages identifier id'>packages</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='tasks identifier id'>tasks</span>
</pre>
<p>
Returns all packages created by this project. A project may create any
number of packages.
</p>
<p>
This method is used whenever you pass a project to Buildr#artifact or any
other method that accepts artifact specifications and projects. You can use
it to list all packages created by the project. If you want to return a
specific package, it is often more convenient to call #package with the
type.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/buildr/packaging/package.rb', line 204</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/vic/buildr/blob/5c3bb4772339677c1d7b85f7f04bfbd8107597b5/lib/buildr/packaging/package.rb#L204">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">204
205
206</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='packages identifier id'>packages</span>
  <span class='@packages ivar id'>@packages</span> <span class='opasgn op'>||=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>