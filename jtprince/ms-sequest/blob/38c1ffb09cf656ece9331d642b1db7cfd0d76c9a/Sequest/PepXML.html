<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>jtprince's ms-sequest - Class: Sequest::PepXML - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/jtprince/commits/ms-sequest/master" rel="alternate" title="Recent Commits to ms-sequest:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("jtprince", "ms-sequest", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("jtprince", "ms-sequest", "38c1ffb09cf656ece9331d642b1db7cfd0d76c9a", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/jtprince/ms-sequest/tree/">Source</a></li>
            <li class=""><a href="http://github.com/jtprince/ms-sequest/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/jtprince/ms-sequest/network">Network</a></li>            
            <li class=""><a href="http://github.com/jtprince/ms-sequest/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/jtprince/ms-sequest">Wiki</a></li>
            <li class=""><a href="http://github.com/jtprince/ms-sequest/graphs">Graphs</a></li>                    
            <li class="active"><a href="/jtprince/ms-sequest">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/jtprince">jtprince</a> / <b><a href="http://github.com/jtprince/ms-sequest/tree">ms-sequest</a></b>        
                <a id="namespaces_button" rel="jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Sequest_PepXML">
  <h1>Class: Sequest::PepXML</h1>
  <div class="section mixins">
  <h2>Included Modules</h2>
  <p><a href="PepXML/SpecIDXML.html" title="SpecIDXML">SpecIDXML</a></p>
</div><div class="section attributes">
  
    <div class="">
      <h2>Class Attributes</h2>
      <table>
      
        <tr>
          <th class="name">pepxml_version</td>
          <td class="readwrite">
            [<span id='pepxml_version-class_method'>R</span><span id='pepxml_version=-class_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>pepxml_version</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">avg_parent</td>
          <td class="readwrite">
            [<span id='avg_parent-instance_method'>R</span><span id='avg_parent=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>avg_parent</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">base_name</td>
          <td class="readwrite">
            [<span id='base_name-instance_method'>R</span><span id='base_name=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
the full path name (no extension).
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">h_plus</td>
          <td class="readwrite">
            [<span id='h_plus-instance_method'>R</span><span id='h_plus=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>h_plus</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">msms_pipeline_analysis</td>
          <td class="readwrite">
            [<span id='msms_pipeline_analysis-instance_method'>R</span><span id='msms_pipeline_analysis=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>msms_pipeline_analysis</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">pepxml_version</td>
          <td class="readwrite">
            [<span id='pepxml_version-instance_method'>R</span><span id='pepxml_version=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>pepxml_version</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="DEF_VERSION-constant">DEF_VERSION</dt>
      <dd>18</dd>
    
      <dt id="Default_Options-constant">Default_Options</dt>
      <dd>{
  :out_path =&gt; '.',
  #:backup_db_path =&gt; '.',
  # a PepXML option
  :pepxml_version =&gt; DEF_VERSION,  
  ## MSMSRunSummary options:
  # string must be recognized in sample_enzyme.rb 
  # or create your own SampleEnzyme object
  :ms_manufacturer =&gt; 'ThermoFinnigan',
  :ms_model =&gt; 'LCQ Deca XP Plus',
  :ms_ionization =&gt; 'ESI',
  :ms_mass_analyzer =&gt; 'Ion Trap',
  :ms_detector =&gt; 'UNKNOWN',
  :ms_data =&gt; '.',      # path to ms data files (raw or mzxml)
  :raw_data_type =&gt; &quot;raw&quot;,
  :raw_data =&gt; &quot;.mzXML&quot;, ## even if you don't have it?
  ## SearchSummary options:
  :out_data_type =&gt; &quot;out&quot;, ## may be srf?? don't think pepxml recognizes this yet
  :out_data =&gt; &quot;.tgz&quot;, ## may be srf??
  :copy_mzxml =&gt; false, # copy the mzxml file to the out_path (create it if necessary)
  :print =&gt; false, # print the objects to file
}</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(pepxml_version = DEF_VERSION, sequest_params_obj = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
msms_pipeline_analysis is set to the result of the yielded block and
set_mono_or_avg is called with params if given
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 189</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L189">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">189
190
191
192
193
194
195
196
197
198</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='pepxml_version identifier id'>pepxml_version</span><span class='assign token'>=</span><span class='DEF_VERSION constant id'>DEF_VERSION</span><span class='comma token'>,</span> <span class='sequest_params_obj identifier id'>sequest_params_obj</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='pepxml_version identifier id'>pepxml_version</span> <span class='assign token'>=</span> <span class='pepxml_version identifier id'>pepxml_version</span>
  <span class='if if kw'>if</span> <span class='sequest_params_obj identifier id'>sequest_params_obj</span>
    <span class='set_mono_or_avg identifier id'>set_mono_or_avg</span><span class='lparen token'>(</span><span class='sequest_params_obj identifier id'>sequest_params_obj</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='block_given? fid id'>block_given?</span>
    <span class='@msms_pipeline_analysis ivar id'>@msms_pipeline_analysis</span> <span class='assign token'>=</span> <span class='yield yield kw'>yield</span>
    <span class='@base_name ivar id'>@base_name</span> <span class='assign token'>=</span> <span class='@msms_pipeline_analysis ivar id'>@msms_pipeline_analysis</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span><span class='dot token'>.</span><span class='base_name identifier id'>base_name</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_prot_num_and_first_prot_by_pep-class_method">_prot_num_and_first_prot_by_pep</span><span class='args'>(pep_array)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
updates the private attrs _num_prots and _first_prot on bioworks pep
objects.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#base_name_noext-class_method">base_name_noext</span><span class='args'>(file)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
given any kind of filename (from windows or whatever) returns the base of
the filename with no file extension.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#make_base_name-class_method">make_base_name</span><span class='args'>(path, filename)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
combines filename in a manner consistent with the path.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#new_from_srf-class_method">new_from_srf</span><span class='args'>(srf, opts = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
will dynamically set :ms_model and :ms_mass_analyzer from srf info
(ignoring defaults or anything passed in) for LTQ Orbitrap and LCQ Deca XP
See SRF::Sequest::PepXML::Default_Options hash for defaults unless given,
the out_path will be given as the path of the srf_file srf may be an object
or a filename.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#set_from_bioworks-class_method">set_from_bioworks</span><span class='args'>(bioworks_file, opts = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
takes an .
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#set_from_bioworks_xml-class_method">set_from_bioworks_xml</span><span class='args'>(bioworks, params, opts = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Takes bioworks 3.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#date-instance_method">#date</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#doctype-instance_method">#doctype</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
for pepxml_version == 0.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#fragment_mass_type-instance_method">#fragment_mass_type</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#header-instance_method">#header</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#precursor_mass_type-instance_method">#precursor_mass_type</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#set_mono_or_avg-instance_method">#set_mono_or_avg</span><span class='args'>(sequest_params_obj)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
sets @h_plus and @avg_parent from the sequest params object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#spectrum_queries-instance_method">#spectrum_queries</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
attr_accessor :spectrum_queries, :params, :base_name, :search_engine,
:database, :raw_data_type, :raw_data, :out_data_type, :out_data,
:sample_enzyme, :pepxml_version returns an array of spectrum queries.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#style_sheet-instance_method">#style_sheet</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#summary_xml-instance_method">#summary_xml</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_pepxml-instance_method">#to_pepxml</span><span class='args'>(file = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
outputs pepxml, (to file if given).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#xml_version-instance_method">#xml_version</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>_prot_num_and_first_prot_by_pep</h3>
</div><div id="_prot_num_and_first_prot_by_pep-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_prot_num_and_first_prot_by_pep</span><span class='args'>(pep_array)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
updates the private attrs _num_prots and _first_prot on bioworks pep
objects. Ideally, we&#8217;d like these attributes to reside elsewhere, but
for memory concerns, this is best for now.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 242</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L242">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">242
243
244
245
246
247
248
249
250
251
252
253</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_prot_num_and_first_prot_by_pep identifier id'>_prot_num_and_first_prot_by_pep</span><span class='lparen token'>(</span><span class='pep_array identifier id'>pep_array</span><span class='rparen token'>)</span>
  <span class='pep_array identifier id'>pep_array</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:aaseq</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='aasq identifier id'>aasq</span><span class='comma token'>,</span> <span class='pep_arr identifier id'>pep_arr</span><span class='bitor op'>|</span>
    <span class='prts identifier id'>prts</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='pep_arr identifier id'>pep_arr</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span> <span class='prts identifier id'>prts</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span> <span class='mult op'>*</span><span class='lparen token'>(</span><span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span><span class='rparen token'>)</span> <span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='prts identifier id'>prts</span><span class='dot token'>.</span><span class='uniq! fid id'>uniq!</span>
    <span class='_size identifier id'>_size</span> <span class='assign token'>=</span> <span class='prts identifier id'>prts</span><span class='dot token'>.</span><span class='size identifier id'>size</span> 
    <span class='pep_arr identifier id'>pep_arr</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span>
      <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='_num_prots identifier id'>_num_prots</span> <span class='assign token'>=</span> <span class='_size identifier id'>_size</span>
      <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='_first_prot identifier id'>_first_prot</span> <span class='assign token'>=</span> <span class='prts identifier id'>prts</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>base_name_noext</h3>
</div><div id="base_name_noext-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>base_name_noext</span><span class='args'>(file)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
given any kind of filename (from windows or whatever) returns the base of
the filename with no file extension
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 769</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L769">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">769
770
771
772</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='base_name_noext identifier id'>base_name_noext</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='string val'>&quot;\\&quot;</span><span class='comma token'>,</span> <span class='string val'>'/'</span><span class='rparen token'>)</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='basename identifier id'>basename</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/\.[\w^\.]+$/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>make_base_name</h3>
</div><div id="make_base_name-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>make_base_name</span><span class='args'>(path, filename)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
combines filename in a manner consistent with the path
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 744</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L744">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">744
745
746
747
748
749
750
751
752
753
754</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='make_base_name identifier id'>make_base_name</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
  <span class='sep identifier id'>sep</span> <span class='assign token'>=</span> <span class='string val'>'/'</span>
  <span class='if if kw'>if</span> <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'/'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='lt op'>&lt;</span> <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>&quot;\\&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
    <span class='sep identifier id'>sep</span> <span class='assign token'>=</span> <span class='string val'>&quot;\\&quot;</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='last identifier id'>last</span> <span class='eq op'>==</span> <span class='sep identifier id'>sep</span>
    <span class='path identifier id'>path</span> <span class='plus op'>+</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='basename identifier id'>basename</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='path identifier id'>path</span> <span class='plus op'>+</span> <span class='sep identifier id'>sep</span> <span class='plus op'>+</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='basename identifier id'>basename</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>new_from_srf</h3>
</div><div id="new_from_srf-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>new_from_srf</span><span class='args'>(srf, opts = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
will dynamically set :ms_model and :ms_mass_analyzer from srf info
(ignoring defaults or anything passed in) for LTQ Orbitrap and LCQ Deca XP
See SRF::Sequest::PepXML::Default_Options hash for defaults unless given,
the out_path will be given as the path of the srf_file srf may be an object
or a filename
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 285</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L285">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='new_from_srf identifier id'>new_from_srf</span><span class='lparen token'>(</span><span class='srf identifier id'>srf</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='Default_Options constant id'>Default_Options</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='rparen token'>)</span>

  <span class='comment val'>## read the srf file</span>
  <span class='if if kw'>if</span> <span class='srf identifier id'>srf</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='String constant id'>String</span>
    <span class='srf identifier id'>srf</span> <span class='assign token'>=</span> <span class='SRF constant id'>SRF</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='srf identifier id'>srf</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>## set the outpath</span>
  <span class='out_path identifier id'>out_path</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:out_path</span><span class='rparen token'>)</span>

  <span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='srf identifier id'>srf</span><span class='dot token'>.</span><span class='params identifier id'>params</span>

  <span class='comment val'>## check to see if we need backup_db</span>
  <span class='backup_db_path identifier id'>backup_db_path</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:backup_db_path</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='dot token'>.</span><span class='database identifier id'>database</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='backup_db_path identifier id'>backup_db_path</span>
    <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='database_path identifier id'>database_path</span> <span class='assign token'>=</span> <span class='backup_db_path identifier id'>backup_db_path</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>#######################################################################</span>
  <span class='comment val'># PREPARE THE OPTIONS:</span>
  <span class='comment val'>#######################################################################</span>
  <span class='comment val'>## remove items from the options hash that don't belong to </span>
  <span class='ppxml_version identifier id'>ppxml_version</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:pepxml_version</span><span class='rparen token'>)</span>
  <span class='out_data_type identifier id'>out_data_type</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:out_data_type</span><span class='rparen token'>)</span>
  <span class='out_data identifier id'>out_data</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:out_data</span><span class='rparen token'>)</span>

  <span class='comment val'>## Extract meta info from srf</span>
  <span class='bn_noext identifier id'>bn_noext</span> <span class='assign token'>=</span> <span class='base_name_noext identifier id'>base_name_noext</span><span class='lparen token'>(</span><span class='srf identifier id'>srf</span><span class='dot token'>.</span><span class='header identifier id'>header</span><span class='dot token'>.</span><span class='raw_filename identifier id'>raw_filename</span><span class='rparen token'>)</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:ms_model</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='srf identifier id'>srf</span><span class='dot token'>.</span><span class='header identifier id'>header</span><span class='dot token'>.</span><span class='model identifier id'>model</span>
  <span class='case case kw'>case</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:ms_model</span><span class='rbrack token'>]</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/Orbitrap/</span>
    <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:ms_mass_analyzer</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>'Orbitrap'</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/LCQ Deca XP/</span>
    <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:ms_mass_analyzer</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>'Ion Trap'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>## Create the base name</span>
  <span class='full_base_name_no_ext identifier id'>full_base_name_no_ext</span> <span class='assign token'>=</span> <span class='make_base_name identifier id'>make_base_name</span><span class='lparen token'>(</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='out_path identifier id'>out_path</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='bn_noext identifier id'>bn_noext</span><span class='rparen token'>)</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:base_name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='full_base_name_no_ext identifier id'>full_base_name_no_ext</span>

  <span class='comment val'>## Create the search summary:</span>
  <span class='search_summary_options identifier id'>search_summary_options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span>
    <span class='symbol val'>:search_database</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SearchDatabase constant id'>SearchDatabase</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span><span class='comma token'>,</span>
    <span class='symbol val'>:base_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='full_base_name_no_ext identifier id'>full_base_name_no_ext</span><span class='comma token'>,</span>
    <span class='symbol val'>:out_data_type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='out_data_type identifier id'>out_data_type</span><span class='comma token'>,</span>
    <span class='symbol val'>:out_data</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='out_data identifier id'>out_data</span>
  <span class='rbrace token'>}</span>
  <span class='modifications_string identifier id'>modifications_string</span> <span class='assign token'>=</span> <span class='srf identifier id'>srf</span><span class='dot token'>.</span><span class='header identifier id'>header</span><span class='dot token'>.</span><span class='modifications identifier id'>modifications</span>
  <span class='search_summary identifier id'>search_summary</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SearchSummary constant id'>SearchSummary</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='params identifier id'>params</span><span class='comma token'>,</span> <span class='modifications_string identifier id'>modifications_string</span><span class='comma token'>,</span> <span class='search_summary_options identifier id'>search_summary_options</span><span class='rparen token'>)</span>

  <span class='comment val'># create the sample enzyme from the params object:</span>
  <span class='sample_enzyme_obj identifier id'>sample_enzyme_obj</span> <span class='assign token'>=</span> 
    <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:sample_enzyme</span><span class='rbrack token'>]</span>
      <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:sample_enzyme</span><span class='rbrack token'>]</span>
    <span class='else else kw'>else</span>
      <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='sample_enzyme identifier id'>sample_enzyme</span>
    <span class='end end kw'>end</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:sample_enzyme</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='sample_enzyme_obj identifier id'>sample_enzyme_obj</span>

  <span class='comment val'>## Create the pepxml obj and top level objects</span>
  <span class='pepxml_obj identifier id'>pepxml_obj</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='ppxml_version identifier id'>ppxml_version</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span> 
  <span class='pipeline identifier id'>pipeline</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='MSMSPipelineAnalysis constant id'>MSMSPipelineAnalysis</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:date=</span><span class='gt op'>&gt;</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span><span class='symbol val'>:summary_xml=</span><span class='gt op'>&gt;</span> <span class='bn_noext identifier id'>bn_noext</span> <span class='plus op'>+</span><span class='string val'>'.xml'</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='msms_pipeline_analysis identifier id'>msms_pipeline_analysis</span> <span class='assign token'>=</span> <span class='pipeline identifier id'>pipeline</span>
  <span class='pipeline identifier id'>pipeline</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='MSMSRunSummary constant id'>MSMSRunSummary</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
  <span class='pipeline identifier id'>pipeline</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span><span class='dot token'>.</span><span class='search_summary identifier id'>search_summary</span> <span class='assign token'>=</span> <span class='search_summary identifier id'>search_summary</span>
  <span class='modifications_obj identifier id'>modifications_obj</span> <span class='assign token'>=</span> <span class='search_summary identifier id'>search_summary</span><span class='dot token'>.</span><span class='modifications identifier id'>modifications</span>

  <span class='comment val'>## name some common variables we'll need</span>
  <span class='h_plus identifier id'>h_plus</span> <span class='assign token'>=</span> <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='h_plus identifier id'>h_plus</span>
  <span class='avg_parent identifier id'>avg_parent</span> <span class='assign token'>=</span> <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='avg_parent identifier id'>avg_parent</span>


  <span class='comment val'>## COPY MZXML FILES IF NECESSARY</span>
  <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:copy_mzxml</span><span class='rbrack token'>]</span>
    <span class='mzxml_pathname_noext identifier id'>mzxml_pathname_noext</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:ms_data</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='bn_noext identifier id'>bn_noext</span><span class='rparen token'>)</span>
    <span class='to_copy identifier id'>to_copy</span> <span class='assign token'>=</span> <span class='MS constant id'>MS</span><span class='colon2 op'>::</span><span class='Converter constant id'>Converter</span><span class='colon2 op'>::</span><span class='MzXML constant id'>MzXML</span><span class='dot token'>.</span><span class='file_to_mzxml identifier id'>file_to_mzxml</span><span class='lparen token'>(</span><span class='mzxml_pathname_noext identifier id'>mzxml_pathname_noext</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='to_copy identifier id'>to_copy</span>
      <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='cp identifier id'>cp</span> <span class='to_copy identifier id'>to_copy</span><span class='comma token'>,</span> <span class='out_path identifier id'>out_path</span>
    <span class='else else kw'>else</span>
      <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;Couldn't file mzXML file with base: #{mzxml_pathname_noext}&quot;</span>
      <span class='puts identifier id'>puts</span> <span class='string val'>&quot;Perhaps you need to specifiy the location of the raw data&quot;</span>
      <span class='puts identifier id'>puts</span> <span class='string val'>&quot;or need an mzXML converter (readw or t2x)&quot;</span>
      <span class='exit identifier id'>exit</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>


  <span class='comment val'>#######################################################################</span>
  <span class='comment val'># CREATE the spectrum_queries_ar</span>
  <span class='comment val'>#######################################################################</span>
  <span class='srf_index identifier id'>srf_index</span> <span class='assign token'>=</span> <span class='srf identifier id'>srf</span><span class='dot token'>.</span><span class='index identifier id'>index</span>
  <span class='out_files identifier id'>out_files</span> <span class='assign token'>=</span> <span class='srf identifier id'>srf</span><span class='dot token'>.</span><span class='out_files identifier id'>out_files</span>
  <span class='spectrum_queries_arr identifier id'>spectrum_queries_arr</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='srf identifier id'>srf</span><span class='dot token'>.</span><span class='dta_files identifier id'>dta_files</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>
  <span class='files_with_hits_index identifier id'>files_with_hits_index</span> <span class='assign token'>=</span> <span class='integer val'>0</span>  <span class='comment val'>## will end up being 1 indexed</span>

  <span class='deltacn_orig identifier id'>deltacn_orig</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:deltacn_orig</span><span class='rbrack token'>]</span>
  <span class='deltacn_index identifier id'>deltacn_index</span> <span class='assign token'>=</span> 
    <span class='if if kw'>if</span> <span class='deltacn_orig identifier id'>deltacn_orig</span> <span class='semicolon token'>;</span> <span class='integer val'>20</span>
    <span class='else else kw'>else</span> <span class='integer val'>19</span>
    <span class='end end kw'>end</span>

  <span class='srf identifier id'>srf</span><span class='dot token'>.</span><span class='dta_files identifier id'>dta_files</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='dta_file identifier id'>dta_file</span><span class='comma token'>,</span><span class='dta_i identifier id'>dta_i</span><span class='bitor op'>|</span>
    <span class='next next kw'>next</span> <span class='if if_mod kw'>if</span> <span class='out_files identifier id'>out_files</span><span class='lbrack token'>[</span><span class='dta_i identifier id'>dta_i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='num_hits identifier id'>num_hits</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
    <span class='files_with_hits_index identifier id'>files_with_hits_index</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>

    <span class='precursor_neutral_mass identifier id'>precursor_neutral_mass</span> <span class='assign token'>=</span> <span class='dta_file identifier id'>dta_file</span><span class='dot token'>.</span><span class='mh identifier id'>mh</span> <span class='minus op'>-</span> <span class='h_plus identifier id'>h_plus</span>

    <span class='lparen token'>(</span><span class='start_scan identifier id'>start_scan</span><span class='comma token'>,</span> <span class='end_scan identifier id'>end_scan</span><span class='comma token'>,</span> <span class='charge identifier id'>charge</span><span class='rparen token'>)</span> <span class='assign token'>=</span> <span class='srf_index identifier id'>srf_index</span><span class='lbrack token'>[</span><span class='dta_i identifier id'>dta_i</span><span class='rbrack token'>]</span>
    <span class='sq_hash identifier id'>sq_hash</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span>
      <span class='symbol val'>:spectrum</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='bn_noext identifier id'>bn_noext</span><span class='comma token'>,</span> <span class='start_scan identifier id'>start_scan</span><span class='comma token'>,</span> <span class='end_scan identifier id'>end_scan</span><span class='comma token'>,</span> <span class='charge identifier id'>charge</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'.'</span><span class='rparen token'>)</span><span class='comma token'>,</span>
      <span class='symbol val'>:start_scan</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='start_scan identifier id'>start_scan</span><span class='comma token'>,</span>
      <span class='symbol val'>:end_scan</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='end_scan identifier id'>end_scan</span><span class='comma token'>,</span>
      <span class='symbol val'>:precursor_neutral_mass</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='precursor_neutral_mass identifier id'>precursor_neutral_mass</span><span class='comma token'>,</span>
      <span class='symbol val'>:assumed_charge</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='charge identifier id'>charge</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span>
      <span class='symbol val'>:pepxml_version</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ppxml_version identifier id'>ppxml_version</span><span class='comma token'>,</span>
      <span class='symbol val'>:index</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='files_with_hits_index identifier id'>files_with_hits_index</span><span class='comma token'>,</span>
    <span class='rbrace token'>}</span>

    <span class='spectrum_query identifier id'>spectrum_query</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SpectrumQuery constant id'>SpectrumQuery</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='sq_hash identifier id'>sq_hash</span><span class='rparen token'>)</span>


    <span class='hits identifier id'>hits</span> <span class='assign token'>=</span> <span class='out_files identifier id'>out_files</span><span class='lbrack token'>[</span><span class='dta_i identifier id'>dta_i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='hits identifier id'>hits</span>

    <span class='search_hits identifier id'>search_hits</span> <span class='assign token'>=</span> 
      <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:all_hits</span><span class='rbrack token'>]</span>
        <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='out_files identifier id'>out_files</span><span class='lbrack token'>[</span><span class='dta_i identifier id'>dta_i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='num_hits identifier id'>num_hits</span><span class='rparen token'>)</span>  <span class='comment val'># all hits</span>
      <span class='else else kw'>else</span>
        <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>  <span class='comment val'># top hit only</span>
      <span class='end end kw'>end</span>

    <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='lparen token'>(</span><span class='search_hits identifier id'>search_hits</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='hit_i identifier id'>hit_i</span><span class='bitor op'>|</span>
      <span class='hit identifier id'>hit</span> <span class='assign token'>=</span> <span class='hits identifier id'>hits</span><span class='lbrack token'>[</span><span class='hit_i identifier id'>hit_i</span><span class='rbrack token'>]</span>
      <span class='comment val'># under the modified deltacn schema (like bioworks)</span>
      <span class='comment val'># Get proper deltacn and deltacnstar</span>
      <span class='comment val'># under new srf, deltacn is already corrected for what prophet wants,</span>
      <span class='comment val'># deltacn_orig_updated is how to access the old one</span>
      <span class='comment val'># Prophet deltacn is not the same as the native Sequest deltacn</span>
      <span class='comment val'># It is the deltacn of the second best hit!</span>

      <span class='comment val'>## mass calculations:</span>
      <span class='calc_neutral_pep_mass identifier id'>calc_neutral_pep_mass</span> <span class='assign token'>=</span> <span class='hit identifier id'>hit</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='minus op'>-</span> <span class='h_plus identifier id'>h_plus</span>


      <span class='sequence identifier id'>sequence</span> <span class='assign token'>=</span> <span class='hit identifier id'>hit</span><span class='dot token'>.</span><span class='sequence identifier id'>sequence</span>

      <span class='comment val'>#  NEED TO MODIFY SPLIT SEQUENCE TO DO MODS!</span>
      <span class='comment val'>## THIS IS ALL INNER LOOP, so we make every effort at speed here:</span>
      <span class='lparen token'>(</span><span class='prevaa identifier id'>prevaa</span><span class='comma token'>,</span> <span class='pepseq identifier id'>pepseq</span><span class='comma token'>,</span> <span class='nextaa identifier id'>nextaa</span><span class='rparen token'>)</span> <span class='assign token'>=</span> <span class='SpecID constant id'>SpecID</span><span class='colon2 op'>::</span><span class='Pep constant id'>Pep</span><span class='dot token'>.</span><span class='prepare_sequence identifier id'>prepare_sequence</span><span class='lparen token'>(</span><span class='sequence identifier id'>sequence</span><span class='rparen token'>)</span>
      <span class='comment val'># 0=mh 1=deltacn_orig 2=sp 3=xcorr 4=id 5=num_other_loci 6=rsp 7=ions_matched 8=ions_total 9=sequence 10=prots 11=deltamass 12=ppm 13=aaseq 14=base_name 15=first_scan 16=last_scan 17=charge 18=srf 19=deltacn 20=deltacn_orig_updated</span>

      <span class='sh_hash identifier id'>sh_hash</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span>
        <span class='symbol val'>:hit_rank</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hit_i identifier id'>hit_i</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='comma token'>,</span>
        <span class='symbol val'>:peptide</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='pepseq identifier id'>pepseq</span><span class='comma token'>,</span>
        <span class='symbol val'>:peptide_prev_aa</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='prevaa identifier id'>prevaa</span><span class='comma token'>,</span>
        <span class='symbol val'>:peptide_next_aa</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='nextaa identifier id'>nextaa</span><span class='comma token'>,</span>
        <span class='symbol val'>:protein</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hit identifier id'>hit</span><span class='lbrack token'>[</span><span class='integer val'>10</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='dot token'>.</span><span class='reference identifier id'>reference</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>&quot; &quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='comma token'>,</span> 
        <span class='symbol val'>:num_tot_proteins</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hit identifier id'>hit</span><span class='lbrack token'>[</span><span class='integer val'>10</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='comma token'>,</span>
        <span class='symbol val'>:num_matched_ions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hit identifier id'>hit</span><span class='lbrack token'>[</span><span class='integer val'>7</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
        <span class='symbol val'>:tot_num_ions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hit identifier id'>hit</span><span class='lbrack token'>[</span><span class='integer val'>8</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
        <span class='symbol val'>:calc_neutral_pep_mass</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='calc_neutral_pep_mass identifier id'>calc_neutral_pep_mass</span><span class='comma token'>,</span>
        <span class='symbol val'>:massdiff</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='precursor_neutral_mass identifier id'>precursor_neutral_mass</span> <span class='minus op'>-</span> <span class='calc_neutral_pep_mass identifier id'>calc_neutral_pep_mass</span><span class='comma token'>,</span> 
        <span class='symbol val'>:num_tol_term</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='sample_enzyme_obj identifier id'>sample_enzyme_obj</span><span class='dot token'>.</span><span class='num_tol_term identifier id'>num_tol_term</span><span class='lparen token'>(</span><span class='sequence identifier id'>sequence</span><span class='rparen token'>)</span><span class='comma token'>,</span>
        <span class='symbol val'>:num_missed_cleavages</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='sample_enzyme_obj identifier id'>sample_enzyme_obj</span><span class='dot token'>.</span><span class='num_missed_cleavages identifier id'>num_missed_cleavages</span><span class='lparen token'>(</span><span class='pepseq identifier id'>pepseq</span><span class='rparen token'>)</span><span class='comma token'>,</span>
        <span class='symbol val'>:is_rejected</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='comma token'>,</span>
        <span class='comment val'># These are search score attributes:</span>
        <span class='symbol val'>:xcorr</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hit identifier id'>hit</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
        <span class='symbol val'>:deltacn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hit identifier id'>hit</span><span class='lbrack token'>[</span><span class='deltacn_index identifier id'>deltacn_index</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
        <span class='symbol val'>:spscore</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hit identifier id'>hit</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
        <span class='symbol val'>:sprank</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hit identifier id'>hit</span><span class='lbrack token'>[</span><span class='integer val'>6</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
        <span class='symbol val'>:modification_info</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='modifications_obj identifier id'>modifications_obj</span><span class='dot token'>.</span><span class='modification_info identifier id'>modification_info</span><span class='lparen token'>(</span><span class='SpecID constant id'>SpecID</span><span class='colon2 op'>::</span><span class='Pep constant id'>Pep</span><span class='dot token'>.</span><span class='split_sequence identifier id'>split_sequence</span><span class='lparen token'>(</span><span class='sequence identifier id'>sequence</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='comma token'>,</span>
      <span class='rbrace token'>}</span>
      <span class='unless unless kw'>unless</span> <span class='deltacn_orig identifier id'>deltacn_orig</span>
        <span class='sh_hash identifier id'>sh_hash</span><span class='lbrack token'>[</span><span class='symbol val'>:deltacnstar</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> 
          <span class='if if kw'>if</span> <span class='hits identifier id'>hits</span><span class='lbrack token'>[</span><span class='hit_i identifier id'>hit_i</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>  <span class='comment val'># no next hit? then its deltacnstar == 1</span>
          <span class='string val'>'1'</span>
          <span class='else else kw'>else</span>
          <span class='string val'>'0'</span>
          <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='search_hits identifier id'>search_hits</span><span class='lbrack token'>[</span><span class='hit_i identifier id'>hit_i</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SearchHit constant id'>SearchHit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='sh_hash identifier id'>sh_hash</span><span class='rparen token'>)</span> <span class='comment val'># there can be multiple hits</span>
    <span class='end end kw'>end</span>

    <span class='search_result identifier id'>search_result</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SearchResult constant id'>SearchResult</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='search_result identifier id'>search_result</span><span class='dot token'>.</span><span class='search_hits identifier id'>search_hits</span> <span class='assign token'>=</span> <span class='search_hits identifier id'>search_hits</span>
    <span class='spectrum_query identifier id'>spectrum_query</span><span class='dot token'>.</span><span class='search_results identifier id'>search_results</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='search_result identifier id'>search_result</span><span class='rbrack token'>]</span>
    <span class='spectrum_queries_arr identifier id'>spectrum_queries_arr</span><span class='lbrack token'>[</span><span class='files_with_hits_index identifier id'>files_with_hits_index</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='spectrum_query identifier id'>spectrum_query</span>
  <span class='end end kw'>end</span>
  <span class='spectrum_queries_arr identifier id'>spectrum_queries_arr</span><span class='dot token'>.</span><span class='compact! fid id'>compact!</span>

  <span class='pipeline identifier id'>pipeline</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span><span class='dot token'>.</span><span class='spectrum_queries identifier id'>spectrum_queries</span> <span class='assign token'>=</span> <span class='spectrum_queries_arr identifier id'>spectrum_queries_arr</span> 
  <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='base_name identifier id'>base_name</span> <span class='assign token'>=</span> <span class='pipeline identifier id'>pipeline</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span><span class='dot token'>.</span><span class='base_name identifier id'>base_name</span>
  <span class='pipeline identifier id'>pipeline</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span><span class='dot token'>.</span><span class='spectrum_queries identifier id'>spectrum_queries</span> <span class='assign token'>=</span>  <span class='spectrum_queries_arr identifier id'>spectrum_queries_arr</span> 

  <span class='pepxml_obj identifier id'>pepxml_obj</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>set_from_bioworks</h3>
</div><div id="set_from_bioworks-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>set_from_bioworks</span><span class='args'>(bioworks_file, opts = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
takes an .srg or bioworks.xml file if possible, ensures that an mzXML file
is present for each pepxml file :print =&gt; true, will print files NOTES:
num_tol_term and num_missing_cleavages are both calculated from the
sample_enzyme. Thus, a No_Enzyme search may still pass in a :sample_enzyme
option to get these calculated.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 488</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L488">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='set_from_bioworks identifier id'>set_from_bioworks</span><span class='lparen token'>(</span><span class='bioworks_file identifier id'>bioworks_file</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
<span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='Default_Options constant id'>Default_Options</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
<span class='comment val'>## Create the out_path directory if necessary</span>

  <span class='unless unless kw'>unless</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:out_path</span><span class='rbrack token'>]</span>
    <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mkpath identifier id'>mkpath</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:out_path</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='unless unless kw'>unless</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='directory? fid id'>directory?</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:out_path</span><span class='rbrack token'>]</span>
    <span class='abort identifier id'>abort</span> <span class='dstring node'>&quot;#{opts[:out_path]} must be a directory!&quot;</span>
  <span class='end end kw'>end</span>

  <span class='spec_id identifier id'>spec_id</span> <span class='assign token'>=</span> <span class='SpecID constant id'>SpecID</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='bioworks_file identifier id'>bioworks_file</span><span class='rparen token'>)</span>
  <span class='pepxml_objs identifier id'>pepxml_objs</span> <span class='assign token'>=</span> 
    <span class='if if kw'>if</span> <span class='spec_id identifier id'>spec_id</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='Bioworks constant id'>Bioworks</span>
      <span class='abort identifier id'>abort</span><span class='lparen token'>(</span><span class='string val'>&quot;must have opts[:params] set!&quot;</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:params</span><span class='rbrack token'>]</span>
      <span class='set_from_bioworks_xml identifier id'>set_from_bioworks_xml</span><span class='lparen token'>(</span><span class='bioworks_file identifier id'>bioworks_file</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:params</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
    <span class='elsif elsif kw'>elsif</span> <span class='spec_id identifier id'>spec_id</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='SRFGroup constant id'>SRFGroup</span>
      <span class='spec_id identifier id'>spec_id</span><span class='dot token'>.</span><span class='srfs identifier id'>srfs</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='srf identifier id'>srf</span><span class='bitor op'>|</span>
        <span class='new_from_srf identifier id'>new_from_srf</span><span class='lparen token'>(</span><span class='srf identifier id'>srf</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='rparen token'>)</span> 
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='abort identifier id'>abort</span> <span class='string val'>&quot;invalid object&quot;</span>
    <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:print</span><span class='rbrack token'>]</span>
    <span class='pepxml_objs identifier id'>pepxml_objs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='obj identifier id'>obj</span><span class='bitor op'>|</span>
      <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='to_pepxml identifier id'>to_pepxml</span><span class='lparen token'>(</span><span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='base_name identifier id'>base_name</span> <span class='plus op'>+</span> <span class='string val'>&quot;.xml&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='pepxml_objs identifier id'>pepxml_objs</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>set_from_bioworks_xml</h3>
</div><div id="set_from_bioworks_xml-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>set_from_bioworks_xml</span><span class='args'>(bioworks, params, opts = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Takes bioworks 3.2/3.3 xml output (with no filters) Returns a list of
PepXML objects params = sequest.params file bioworks = bioworks.xml
exported multi-consensus view file pepxml_version = 0 for tpp 1.2.3
pepxml_version = 18 for tpp 2.8.2, 2.8.3, 2.9.2
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 527</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L527">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='set_from_bioworks_xml identifier id'>set_from_bioworks_xml</span><span class='lparen token'>(</span><span class='bioworks identifier id'>bioworks</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='Default_Options constant id'>Default_Options</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
  <span class='pepxml_version identifier id'>pepxml_version</span><span class='comma token'>,</span> <span class='ms_manufacturer identifier id'>ms_manufacturer</span><span class='comma token'>,</span> <span class='ms_model identifier id'>ms_model</span><span class='comma token'>,</span> <span class='ms_ionization identifier id'>ms_ionization</span><span class='comma token'>,</span> <span class='ms_mass_analyzer identifier id'>ms_mass_analyzer</span><span class='comma token'>,</span> <span class='ms_detector identifier id'>ms_detector</span><span class='comma token'>,</span> <span class='raw_data_type identifier id'>raw_data_type</span><span class='comma token'>,</span> <span class='raw_data identifier id'>raw_data</span><span class='comma token'>,</span> <span class='out_data_type identifier id'>out_data_type</span><span class='comma token'>,</span> <span class='out_data identifier id'>out_data</span><span class='comma token'>,</span> <span class='ms_data identifier id'>ms_data</span><span class='comma token'>,</span> <span class='out_path identifier id'>out_path</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:pepxml_version</span><span class='comma token'>,</span> <span class='symbol val'>:ms_manufacturer</span><span class='comma token'>,</span> <span class='symbol val'>:ms_model</span><span class='comma token'>,</span> <span class='symbol val'>:ms_ionization</span><span class='comma token'>,</span> <span class='symbol val'>:ms_mass_analyzer</span><span class='comma token'>,</span> <span class='symbol val'>:ms_detector</span><span class='comma token'>,</span> <span class='symbol val'>:raw_data_type</span><span class='comma token'>,</span> <span class='symbol val'>:raw_data</span><span class='comma token'>,</span> <span class='symbol val'>:out_data_type</span><span class='comma token'>,</span> <span class='symbol val'>:out_data</span><span class='comma token'>,</span> <span class='symbol val'>:ms_data</span><span class='comma token'>,</span> <span class='symbol val'>:out_path</span><span class='rparen token'>)</span>



  <span class='unless unless kw'>unless</span> <span class='out_path identifier id'>out_path</span>
    <span class='out_path identifier id'>out_path</span> <span class='assign token'>=</span> <span class='string val'>'.'</span>
  <span class='end end kw'>end</span>

  <span class='supported_versions identifier id'>supported_versions</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='integer val'>18</span><span class='rbrack token'>]</span>

  <span class='unless unless kw'>unless</span> <span class='supported_versions identifier id'>supported_versions</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:pepxml_version</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> 
    <span class='abort identifier id'>abort</span> <span class='dstring node'>&quot;pepxml_version: #{pepxml_version} not currently supported.  Current support is for versions #{supported_versions.join(', ')}&quot;</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>## Turn params and bioworks_obj into objects if necessary:</span>
  <span class='comment val'># Params:</span>
  <span class='if if kw'>if</span> <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='class identifier id'>class</span> <span class='eq op'>==</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='Params constant id'>Params</span>  <span class='comment val'># OK!</span>
  <span class='elsif elsif kw'>elsif</span> <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='class identifier id'>class</span> <span class='eq op'>==</span> <span class='String constant id'>String</span> <span class='semicolon token'>;</span> <span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='Params constant id'>Params</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>                         <span class='semicolon token'>;</span> <span class='abort identifier id'>abort</span> <span class='dstring node'>&quot;Don't recognize #{params} as object or string!&quot;</span>
  <span class='end end kw'>end</span>
  <span class='comment val'># Bioworks:</span>
  <span class='if if kw'>if</span> <span class='bioworks identifier id'>bioworks</span><span class='dot token'>.</span><span class='class identifier id'>class</span> <span class='eq op'>==</span> <span class='Bioworks constant id'>Bioworks</span>  <span class='comment val'># OK!</span>
  <span class='elsif elsif kw'>elsif</span> <span class='bioworks identifier id'>bioworks</span><span class='dot token'>.</span><span class='class identifier id'>class</span> <span class='eq op'>==</span> <span class='String constant id'>String</span> <span class='semicolon token'>;</span> <span class='bioworks identifier id'>bioworks</span> <span class='assign token'>=</span> <span class='SpecID constant id'>SpecID</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='bioworks identifier id'>bioworks</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>                           <span class='semicolon token'>;</span> <span class='abort identifier id'>abort</span> <span class='dstring node'>&quot;Don't recognize #{bioworks} as object or string!&quot;</span>
  <span class='end end kw'>end</span>

  <span class='sample_enzyme_obj identifier id'>sample_enzyme_obj</span> <span class='assign token'>=</span> 
    <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:sample_enzyme</span><span class='rbrack token'>]</span>
      <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:sample_enzyme</span><span class='rbrack token'>]</span>
    <span class='else else kw'>else</span>
      <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='sample_enzyme identifier id'>sample_enzyme</span>
    <span class='end end kw'>end</span>

  <span class='comment val'>#puts &quot;bioworks.peps.size: #{bioworks.peps.size}&quot;; #puts &quot;bioworks.prots.size: #{bioworks.prots.size}&quot;; #puts &quot;Bioworks.version: #{bioworks.version}&quot;</span>

  <span class='comment val'>## TURN THIS ON IF YOU THINK YOU MIGHT NOT BE GETTING PEPTIDES from</span>
  <span class='comment val'>## bioworks</span>
  <span class='comment val'>#bioworks.peps.each { |pep| if pep.class != Bioworks::Pep ; puts &quot;trying to pass as pep: &quot;; p pep; abort &quot;NOT a pep!&quot; end }</span>

  <span class='comment val'>## check to see if we need backup_db</span>

  <span class='backup_db_path identifier id'>backup_db_path</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:backup_db_path</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='dot token'>.</span><span class='database identifier id'>database</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='backup_db_path identifier id'>backup_db_path</span>
    <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='database_path identifier id'>database_path</span> <span class='assign token'>=</span> <span class='backup_db_path identifier id'>backup_db_path</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>## Start</span>
  <span class='split_bio_objs identifier id'>split_bio_objs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='comment val'>## (num_prots_by_pep, prot_by_pep) = </span>
  <span class='comment val'>#num_prots_by_pep.each do |k,v| puts &quot;k: #{k} v: #{v}\n&quot;; break end ; prot_by_pep.each do |k,v| puts &quot;k: #{k} v: #{v}&quot; ; break end ; abort &quot;HERE&quot;</span>

  <span class='modifications_string identifier id'>modifications_string</span> <span class='assign token'>=</span> <span class='bioworks identifier id'>bioworks</span><span class='dot token'>.</span><span class='modifications identifier id'>modifications</span>

  <span class='comment val'>## Create a hash of spectrum_query arrays by filename (this very big block):</span>
  <span class='spectrum_queries_by_base_name identifier id'>spectrum_queries_by_base_name</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='comment val'># Hash by the filenames to split into filenames:</span>
  <span class='pepxml_objects identifier id'>pepxml_objects</span> <span class='assign token'>=</span> <span class='bioworks identifier id'>bioworks</span><span class='dot token'>.</span><span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:base_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='base_name identifier id'>base_name</span><span class='comma token'>,</span> <span class='pep_arr identifier id'>pep_arr</span><span class='bitor op'>|</span>

    <span class='search_summary identifier id'>search_summary</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SearchSummary constant id'>SearchSummary</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='comma token'>,</span> <span class='modifications_string identifier id'>modifications_string</span><span class='comma token'>,</span> <span class='lbrace token'>{</span><span class='symbol val'>:search_database</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SearchDatabase constant id'>SearchDatabase</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:out_data_type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='out_data_type identifier id'>out_data_type</span><span class='comma token'>,</span> <span class='symbol val'>:out_data</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='out_data identifier id'>out_data</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='modifications_obj identifier id'>modifications_obj</span> <span class='assign token'>=</span> <span class='search_summary identifier id'>search_summary</span><span class='dot token'>.</span><span class='modifications identifier id'>modifications</span>

    <span class='pepxml_obj identifier id'>pepxml_obj</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='pepxml_version identifier id'>pepxml_version</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
    <span class='full_base_name_no_ext identifier id'>full_base_name_no_ext</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='make_base_name identifier id'>make_base_name</span><span class='lparen token'>(</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='out_path identifier id'>out_path</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='base_name identifier id'>base_name</span><span class='rparen token'>)</span>

    <span class='case case kw'>case</span> <span class='pepxml_version identifier id'>pepxml_version</span>
    <span class='when when kw'>when</span> <span class='integer val'>18</span>
      <span class='pipeline identifier id'>pipeline</span> <span class='assign token'>=</span>  <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='MSMSPipelineAnalysis constant id'>MSMSPipelineAnalysis</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:date=</span><span class='gt op'>&gt;</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span><span class='symbol val'>:summary_xml=</span><span class='gt op'>&gt;</span><span class='base_name identifier id'>base_name</span><span class='plus op'>+</span><span class='string val'>'.xml'</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='msms_run_summary identifier id'>msms_run_summary</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='MSMSRunSummary constant id'>MSMSRunSummary</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span>
        <span class='symbol val'>:base_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='full_base_name_no_ext identifier id'>full_base_name_no_ext</span><span class='comma token'>,</span>
        <span class='symbol val'>:ms_manufacturer</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ms_manufacturer identifier id'>ms_manufacturer</span><span class='comma token'>,</span>
        <span class='symbol val'>:ms_model</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ms_model identifier id'>ms_model</span><span class='comma token'>,</span>
        <span class='symbol val'>:ms_ionization</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ms_ionization identifier id'>ms_ionization</span><span class='comma token'>,</span>
        <span class='symbol val'>:ms_mass_analyzer</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ms_mass_analyzer identifier id'>ms_mass_analyzer</span><span class='comma token'>,</span>
        <span class='symbol val'>:ms_detector</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ms_detector identifier id'>ms_detector</span><span class='comma token'>,</span>
        <span class='symbol val'>:raw_data_type</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='raw_data_type identifier id'>raw_data_type</span><span class='comma token'>,</span>
        <span class='symbol val'>:raw_data</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='raw_data identifier id'>raw_data</span><span class='comma token'>,</span>
        <span class='symbol val'>:sample_enzyme</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='sample_enzyme_obj identifier id'>sample_enzyme_obj</span><span class='comma token'>,</span> <span class='comment val'># usually, params.sample_enzyme,</span>
        <span class='symbol val'>:search_summary</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='search_summary identifier id'>search_summary</span><span class='comma token'>,</span>
      <span class='rbrace token'>}</span><span class='rparen token'>)</span> 
      <span class='pipeline identifier id'>pipeline</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span> <span class='assign token'>=</span> <span class='msms_run_summary identifier id'>msms_run_summary</span>
      <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='msms_pipeline_analysis identifier id'>msms_pipeline_analysis</span> <span class='assign token'>=</span> <span class='pipeline identifier id'>pipeline</span>
      <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='msms_pipeline_analysis identifier id'>msms_pipeline_analysis</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span><span class='dot token'>.</span><span class='search_summary identifier id'>search_summary</span><span class='dot token'>.</span><span class='base_name identifier id'>base_name</span> <span class='assign token'>=</span>  <span class='full_base_name_no_ext identifier id'>full_base_name_no_ext</span>
      <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='base_name identifier id'>base_name</span> <span class='assign token'>=</span> <span class='full_base_name_no_ext identifier id'>full_base_name_no_ext</span>
      <span class='pepxml_obj identifier id'>pepxml_obj</span> 
    <span class='end end kw'>end</span>

    <span class='comment val'># Create a hash by pep object containing num_tot_proteins</span>
    <span class='comment val'># This is only valid if all hits are present (no previous thresholding)</span>
    <span class='comment val'># Since out2summary only acts on one folder at a time,</span>
    <span class='comment val'># we should only do it for one folder at a time! (that's why we do this</span>
    <span class='comment val'># here instead of globally)</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='_prot_num_and_first_prot_by_pep identifier id'>_prot_num_and_first_prot_by_pep</span><span class='lparen token'>(</span><span class='pep_arr identifier id'>pep_arr</span><span class='rparen token'>)</span>
    <span class='prec_mz_arr identifier id'>prec_mz_arr</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
    <span class='case case kw'>case</span> <span class='x identifier id'>x</span> <span class='assign token'>=</span> <span class='bioworks identifier id'>bioworks</span><span class='dot token'>.</span><span class='version identifier id'>version</span>
    <span class='when when kw'>when</span> <span class='regexp val'>/3.2/</span> 
      <span class='calc_prec_by identifier id'>calc_prec_by</span> <span class='assign token'>=</span> <span class='symbol val'>:prec_mz_arr</span>
      <span class='comment val'># get the precursor_mz array for this filename</span>
      <span class='mzxml_file identifier id'>mzxml_file</span> <span class='assign token'>=</span> <span class='MS constant id'>MS</span><span class='colon2 op'>::</span><span class='Converter constant id'>Converter</span><span class='colon2 op'>::</span><span class='MzXML constant id'>MzXML</span><span class='dot token'>.</span><span class='file_to_mzxml identifier id'>file_to_mzxml</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='ms_data identifier id'>ms_data</span><span class='comma token'>,</span> <span class='base_name identifier id'>base_name</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='prec_mz_arr identifier id'>prec_mz_arr</span> <span class='assign token'>=</span> <span class='MS constant id'>MS</span><span class='colon2 op'>::</span><span class='MSRun constant id'>MSRun</span><span class='dot token'>.</span><span class='precursor_mz_by_scan_num identifier id'>precursor_mz_by_scan_num</span><span class='lparen token'>(</span><span class='mzxml_file identifier id'>mzxml_file</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='regexp val'>/3.3/</span>
      <span class='calc_prec_by identifier id'>calc_prec_by</span> <span class='assign token'>=</span> <span class='symbol val'>:deltamass</span>
    <span class='else else kw'>else</span>
      <span class='abort identifier id'>abort</span> <span class='dstring node'>&quot;invalid BioworksBrowser version: #{x}&quot;</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:copy_mzxml</span><span class='rbrack token'>]</span>
      <span class='to_copy identifier id'>to_copy</span> <span class='assign token'>=</span> <span class='MS constant id'>MS</span><span class='colon2 op'>::</span><span class='Converter constant id'>Converter</span><span class='colon2 op'>::</span><span class='MzXML constant id'>MzXML</span><span class='dot token'>.</span><span class='file_to_mzxml identifier id'>file_to_mzxml</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='ms_data identifier id'>ms_data</span><span class='comma token'>,</span> <span class='base_name identifier id'>base_name</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='to_copy identifier id'>to_copy</span>
        <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='cp identifier id'>cp</span> <span class='to_copy identifier id'>to_copy</span><span class='comma token'>,</span> <span class='out_path identifier id'>out_path</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>


    <span class='spectrum_queries_ar identifier id'>spectrum_queries_ar</span> <span class='assign token'>=</span> <span class='pep_arr identifier id'>pep_arr</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:first_scan</span><span class='comma token'>,</span> <span class='symbol val'>:last_scan</span><span class='comma token'>,</span> <span class='symbol val'>:charge</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span><span class='arr identifier id'>arr</span><span class='bitor op'>|</span>


      <span class='comment val'># Sort_by_rank and take the top hit (to mimick out2summary):</span>

      <span class='arr identifier id'>arr</span> <span class='assign token'>=</span> <span class='arr identifier id'>arr</span><span class='dot token'>.</span><span class='sort_by identifier id'>sort_by</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='xcorr identifier id'>xcorr</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span> <span class='rbrace token'>}</span> <span class='comment val'># ascending</span>
      <span class='top_pep identifier id'>top_pep</span> <span class='assign token'>=</span> <span class='arr identifier id'>arr</span><span class='dot token'>.</span><span class='pop identifier id'>pop</span>
      <span class='second_hit identifier id'>second_hit</span> <span class='assign token'>=</span> <span class='arr identifier id'>arr</span><span class='dot token'>.</span><span class='last identifier id'>last</span> <span class='comment val'># needed for deltacnstar</span>


      <span class='case case kw'>case</span> <span class='calc_prec_by identifier id'>calc_prec_by</span>
      <span class='when when kw'>when</span> <span class='symbol val'>:prec_mz_arr</span>
        <span class='precursor_neutral_mass identifier id'>precursor_neutral_mass</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SpectrumQuery constant id'>SpectrumQuery</span><span class='dot token'>.</span><span class='calc_precursor_neutral_mass identifier id'>calc_precursor_neutral_mass</span><span class='lparen token'>(</span><span class='calc_prec_by identifier id'>calc_prec_by</span><span class='comma token'>,</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='first_scan identifier id'>first_scan</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='last_scan identifier id'>last_scan</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='prec_mz_arr identifier id'>prec_mz_arr</span><span class='comma token'>,</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='charge identifier id'>charge</span><span class='comma token'>,</span> <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='avg_parent identifier id'>avg_parent</span><span class='rparen token'>)</span>
      <span class='when when kw'>when</span> <span class='symbol val'>:deltamass</span>
        <span class='precursor_neutral_mass identifier id'>precursor_neutral_mass</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SpectrumQuery constant id'>SpectrumQuery</span><span class='dot token'>.</span><span class='calc_precursor_neutral_mass identifier id'>calc_precursor_neutral_mass</span><span class='lparen token'>(</span><span class='calc_prec_by identifier id'>calc_prec_by</span><span class='comma token'>,</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='mass identifier id'>mass</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span><span class='comma token'>,</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='deltamass identifier id'>deltamass</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span><span class='comma token'>,</span> <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='avg_parent identifier id'>avg_parent</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>

      <span class='calc_neutral_pep_mass identifier id'>calc_neutral_pep_mass</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='mass identifier id'>mass</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span> <span class='minus op'>-</span> <span class='pepxml_obj identifier id'>pepxml_obj</span><span class='dot token'>.</span><span class='h_plus identifier id'>h_plus</span><span class='rparen token'>)</span>

      <span class='comment val'># deltacn &amp; star:</span>
      <span class='comment val'># (NOTE: OLD?? out2summary wants the deltacn of the 2nd best hit.)</span>
      <span class='if if kw'>if</span> <span class='second_hit identifier id'>second_hit</span> 
        <span class='comment val'>#top_pep.deltacn = second_hit.deltacn </span>
        <span class='deltacnstar identifier id'>deltacnstar</span> <span class='assign token'>=</span> <span class='string val'>'0'</span>
      <span class='else else kw'>else</span> 
        <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='deltacn identifier id'>deltacn</span> <span class='assign token'>=</span> <span class='string val'>'1.0'</span>
        <span class='deltacnstar identifier id'>deltacnstar</span> <span class='assign token'>=</span> <span class='string val'>'1'</span>
      <span class='end end kw'>end</span>
      <span class='comment val'># Create the nested structure of queries{results{hits}}</span>
      <span class='comment val'># (Ruby's blocks work beautifully for things like this)</span>
      <span class='spec_query identifier id'>spec_query</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SpectrumQuery constant id'>SpectrumQuery</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span>
        <span class='symbol val'>:spectrum</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='base_name identifier id'>base_name</span><span class='comma token'>,</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='first_scan identifier id'>first_scan</span><span class='comma token'>,</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='last_scan identifier id'>last_scan</span><span class='comma token'>,</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='charge identifier id'>charge</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;.&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span>
        <span class='symbol val'>:start_scan</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='first_scan identifier id'>first_scan</span><span class='comma token'>,</span>
        <span class='symbol val'>:end_scan</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='last_scan identifier id'>last_scan</span><span class='comma token'>,</span>
        <span class='symbol val'>:precursor_neutral_mass</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='precursor_neutral_mass identifier id'>precursor_neutral_mass</span><span class='comma token'>,</span>
        <span class='symbol val'>:assumed_charge</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='charge identifier id'>charge</span><span class='comma token'>,</span>
        <span class='symbol val'>:pepxml_version</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='pepxml_version identifier id'>pepxml_version</span><span class='comma token'>,</span>
      <span class='rbrace token'>}</span><span class='rparen token'>)</span> 


      <span class='search_result identifier id'>search_result</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SearchResult constant id'>SearchResult</span><span class='dot token'>.</span><span class='new identifier id'>new</span> 
      <span class='comment val'>#puts &quot;set MASSDIFF: &quot;</span>
      <span class='comment val'>#p precursor_neutral_mass - calc_neutral_pep_mass</span>
      <span class='comment val'>## Calculate some interdependent values;</span>
      <span class='comment val'># NOTE: the bioworks mass is reallyf M+H if two or more scans went</span>
      <span class='comment val'># into the search_hit; calc_neutral_pep_mass is simply the avg of</span>
      <span class='comment val'># precursor masses adjusted to be neutral</span>
      <span class='lparen token'>(</span><span class='prevaa identifier id'>prevaa</span><span class='comma token'>,</span> <span class='pepseq identifier id'>pepseq</span><span class='comma token'>,</span> <span class='nextaa identifier id'>nextaa</span><span class='rparen token'>)</span> <span class='assign token'>=</span> <span class='SpecID constant id'>SpecID</span><span class='colon2 op'>::</span><span class='Pep constant id'>Pep</span><span class='dot token'>.</span><span class='prepare_sequence identifier id'>prepare_sequence</span><span class='lparen token'>(</span><span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='sequence identifier id'>sequence</span><span class='rparen token'>)</span>
      <span class='lparen token'>(</span><span class='num_matched_ions identifier id'>num_matched_ions</span><span class='comma token'>,</span> <span class='tot_num_ions identifier id'>tot_num_ions</span><span class='rparen token'>)</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SearchHit constant id'>SearchHit</span><span class='dot token'>.</span><span class='split_ions identifier id'>split_ions</span><span class='lparen token'>(</span><span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='ions identifier id'>ions</span><span class='rparen token'>)</span>
      <span class='search_hit identifier id'>search_hit</span> <span class='assign token'>=</span> <span class='Sequest constant id'>Sequest</span><span class='colon2 op'>::</span><span class='PepXML constant id'>PepXML</span><span class='colon2 op'>::</span><span class='SearchHit constant id'>SearchHit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span>
        <span class='symbol val'>:hit_rank</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='comma token'>,</span>
        <span class='symbol val'>:peptide</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='pepseq identifier id'>pepseq</span><span class='comma token'>,</span>
        <span class='symbol val'>:peptide_prev_aa</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='prevaa identifier id'>prevaa</span><span class='comma token'>,</span>
        <span class='symbol val'>:peptide_next_aa</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='nextaa identifier id'>nextaa</span><span class='comma token'>,</span>
        <span class='symbol val'>:protein</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='_first_prot identifier id'>_first_prot</span><span class='dot token'>.</span><span class='reference identifier id'>reference</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>&quot; &quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='comma token'>,</span> 
        <span class='symbol val'>:num_tot_proteins</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='_num_prots identifier id'>_num_prots</span><span class='comma token'>,</span>
        <span class='symbol val'>:num_matched_ions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='num_matched_ions identifier id'>num_matched_ions</span><span class='comma token'>,</span>
        <span class='symbol val'>:tot_num_ions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='tot_num_ions identifier id'>tot_num_ions</span><span class='comma token'>,</span>
        <span class='symbol val'>:calc_neutral_pep_mass</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='calc_neutral_pep_mass identifier id'>calc_neutral_pep_mass</span><span class='comma token'>,</span>
        <span class='symbol val'>:massdiff</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='precursor_neutral_mass identifier id'>precursor_neutral_mass</span> <span class='minus op'>-</span> <span class='calc_neutral_pep_mass identifier id'>calc_neutral_pep_mass</span><span class='comma token'>,</span>
        <span class='symbol val'>:num_tol_term</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='sample_enzyme_obj identifier id'>sample_enzyme_obj</span><span class='dot token'>.</span><span class='num_tol_term identifier id'>num_tol_term</span><span class='lparen token'>(</span><span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='sequence identifier id'>sequence</span><span class='rparen token'>)</span><span class='comma token'>,</span>
        <span class='symbol val'>:num_missed_cleavages</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='sample_enzyme_obj identifier id'>sample_enzyme_obj</span><span class='dot token'>.</span><span class='num_missed_cleavages identifier id'>num_missed_cleavages</span><span class='lparen token'>(</span><span class='pepseq identifier id'>pepseq</span><span class='rparen token'>)</span><span class='comma token'>,</span>
        <span class='symbol val'>:is_rejected</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='comma token'>,</span>
        <span class='comment val'># These are search score attributes:</span>
        <span class='symbol val'>:xcorr</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='xcorr identifier id'>xcorr</span><span class='comma token'>,</span>
        <span class='symbol val'>:deltacn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='deltacn identifier id'>deltacn</span><span class='comma token'>,</span>
        <span class='symbol val'>:deltacnstar</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='deltacnstar identifier id'>deltacnstar</span><span class='comma token'>,</span>
        <span class='symbol val'>:spscore</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='sp identifier id'>sp</span><span class='comma token'>,</span>
        <span class='symbol val'>:sprank</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='rsp identifier id'>rsp</span><span class='comma token'>,</span>
        <span class='symbol val'>:modification_info</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='modifications_obj identifier id'>modifications_obj</span><span class='dot token'>.</span><span class='modification_info identifier id'>modification_info</span><span class='lparen token'>(</span><span class='SpecID constant id'>SpecID</span><span class='colon2 op'>::</span><span class='Pep constant id'>Pep</span><span class='dot token'>.</span><span class='split_sequence identifier id'>split_sequence</span><span class='lparen token'>(</span><span class='top_pep identifier id'>top_pep</span><span class='dot token'>.</span><span class='sequence identifier id'>sequence</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='comma token'>,</span>
        <span class='symbol val'>:spectrum_query</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='spec_query identifier id'>spec_query</span><span class='comma token'>,</span>
      <span class='rbrace token'>}</span><span class='rparen token'>)</span>
      <span class='search_result identifier id'>search_result</span><span class='dot token'>.</span><span class='search_hits identifier id'>search_hits</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='search_hit identifier id'>search_hit</span><span class='rbrack token'>]</span> <span class='comment val'># there can be multiple search hits</span>
      <span class='spec_query identifier id'>spec_query</span><span class='dot token'>.</span><span class='search_results identifier id'>search_results</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='search_result identifier id'>search_result</span><span class='rbrack token'>]</span>  <span class='comment val'># can be multiple search_results</span>
      <span class='spec_query identifier id'>spec_query</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># create an index by spectrum as results end up typically in out2summary</span>
    <span class='comment val'># (I really dislike this order, however)</span>
    <span class='spectrum_queries_ar identifier id'>spectrum_queries_ar</span> <span class='assign token'>=</span> <span class='spectrum_queries_ar identifier id'>spectrum_queries_ar</span><span class='dot token'>.</span><span class='sort_by identifier id'>sort_by</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='spectrum identifier id'>spectrum</span> <span class='rbrace token'>}</span>
    <span class='spectrum_queries_ar identifier id'>spectrum_queries_ar</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='res identifier id'>res</span><span class='comma token'>,</span><span class='index identifier id'>index</span><span class='bitor op'>|</span> <span class='res identifier id'>res</span><span class='dot token'>.</span><span class='index identifier id'>index</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{index + 1}&quot;</span> <span class='rbrace token'>}</span>
    <span class='pipeline identifier id'>pipeline</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span><span class='dot token'>.</span><span class='spectrum_queries identifier id'>spectrum_queries</span> <span class='assign token'>=</span> <span class='spectrum_queries_ar identifier id'>spectrum_queries_ar</span>
    <span class='pepxml_obj identifier id'>pepxml_obj</span>
  <span class='end end kw'>end</span> <span class='comment val'>## collects pepxml_objs</span>
  <span class='comment val'># summary_xml is the short basename of the pepxml file (e.g., &quot;020.xml&quot;)</span>
  <span class='pepxml_objects identifier id'>pepxml_objects</span><span class='dot token'>.</span><span class='sort_by identifier id'>sort_by</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='obj identifier id'>obj</span><span class='bitor op'>|</span> <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='summary_xml identifier id'>summary_xml</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>date</h3>
</div><div id="date-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>date</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 213</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L213">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">213
214
215</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='date identifier id'>date</span>
  <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>doctype</h3>
</div><div id="doctype-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>doctype</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
for pepxml_version == 0
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 222</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L222">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">222
223
224</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='doctype identifier id'>doctype</span>
  <span class='string val'>'&lt;!DOCTYPE msms_pipeline_analysis SYSTEM &quot;/usr/bin/msms_analysis3.dtd&quot;&gt;'</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>fragment_mass_type</h3>
</div><div id="fragment_mass_type-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>fragment_mass_type</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 739</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L739">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">739
740
741</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='fragment_mass_type identifier id'>fragment_mass_type</span>
  <span class='@params ivar id'>@params</span><span class='dot token'>.</span><span class='fragment_mass_type identifier id'>fragment_mass_type</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>header</h3>
</div><div id="header-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>header</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 233</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L233">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">233
234
235
236
237</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='header identifier id'>header</span>
  <span class='case case kw'>case</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='pepxml_version identifier id'>pepxml_version</span>
  <span class='when when kw'>when</span> <span class='integer val'>18</span> <span class='semicolon token'>;</span> <span class='xml_version identifier id'>xml_version</span> <span class='plus op'>+</span> <span class='style_sheet identifier id'>style_sheet</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>precursor_mass_type</h3>
</div><div id="precursor_mass_type-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>precursor_mass_type</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 735</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L735">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">735
736
737</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='precursor_mass_type identifier id'>precursor_mass_type</span>
  <span class='@params ivar id'>@params</span><span class='dot token'>.</span><span class='precursor_mass_type identifier id'>precursor_mass_type</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>set_mono_or_avg</h3>
</div><div id="set_mono_or_avg-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>set_mono_or_avg</span><span class='args'>(sequest_params_obj)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
sets @h_plus and @avg_parent from the sequest params object
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 201</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L201">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">201
202
203
204
205
206
207
208
209
210
211</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='set_mono_or_avg identifier id'>set_mono_or_avg</span><span class='lparen token'>(</span><span class='sequest_params_obj identifier id'>sequest_params_obj</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='sequest_params_obj identifier id'>sequest_params_obj</span><span class='dot token'>.</span><span class='precursor_mass_type identifier id'>precursor_mass_type</span>
  <span class='when when kw'>when</span> <span class='string val'>&quot;monoisotopic&quot;</span> <span class='semicolon token'>;</span> <span class='@avg_parent ivar id'>@avg_parent</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='else else kw'>else</span> <span class='semicolon token'>;</span> <span class='@avg_parent ivar id'>@avg_parent</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>

  <span class='case case kw'>case</span> <span class='@avg_parent ivar id'>@avg_parent</span>
  <span class='when when kw'>when</span> <span class='true true kw'>true</span> <span class='semicolon token'>;</span> <span class='@h_plus ivar id'>@h_plus</span> <span class='assign token'>=</span> <span class='SpecID constant id'>SpecID</span><span class='colon2 op'>::</span><span class='AVG constant id'>AVG</span><span class='lbrack token'>[</span><span class='symbol val'>:h_plus</span><span class='rbrack token'>]</span>
  <span class='when when kw'>when</span> <span class='false false kw'>false</span> <span class='semicolon token'>;</span> <span class='@h_plus ivar id'>@h_plus</span> <span class='assign token'>=</span> <span class='SpecID constant id'>SpecID</span><span class='colon2 op'>::</span><span class='MONO constant id'>MONO</span><span class='lbrack token'>[</span><span class='symbol val'>:h_plus</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>spectrum_queries</h3>
</div><div id="spectrum_queries-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>spectrum_queries</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
attr_accessor :spectrum_queries, :params, :base_name, :search_engine,
:database, :raw_data_type, :raw_data, :out_data_type, :out_data,
:sample_enzyme, :pepxml_version returns an array of spectrum queries
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 183</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L183">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">183
184
185</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='spectrum_queries identifier id'>spectrum_queries</span>
  <span class='msms_pipeline_analysis identifier id'>msms_pipeline_analysis</span><span class='dot token'>.</span><span class='msms_run_summary identifier id'>msms_run_summary</span><span class='dot token'>.</span><span class='spectrum_queries identifier id'>spectrum_queries</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>style_sheet</h3>
</div><div id="style_sheet-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>style_sheet</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 226</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L226">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">226
227
228
229
230
231</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='style_sheet identifier id'>style_sheet</span>
  <span class='case case kw'>case</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='pepxml_version identifier id'>pepxml_version</span>
  <span class='when when kw'>when</span> <span class='integer val'>18</span>
  <span class='string val'>'&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;/tools/bin/TPP/tpp/schema/pepXML_std.xsl&quot;?&gt;'</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>summary_xml</h3>
</div><div id="summary_xml-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>summary_xml</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 731</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L731">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">731
732
733</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='summary_xml identifier id'>summary_xml</span>
  <span class='base_name identifier id'>base_name</span> <span class='plus op'>+</span> <span class='string val'>&quot;.xml&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_pepxml</h3>
</div><div id="to_pepxml-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_pepxml</span><span class='args'>(file = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
outputs pepxml, (to file if given)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 757</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L757">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">757
758
759
760
761
762
763
764
765</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_pepxml identifier id'>to_pepxml</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='string identifier id'>string</span> <span class='assign token'>=</span> <span class='header identifier id'>header</span>
  <span class='string identifier id'>string</span> <span class='lshft op'>&lt;&lt;</span> <span class='@msms_pipeline_analysis ivar id'>@msms_pipeline_analysis</span><span class='dot token'>.</span><span class='to_pepxml identifier id'>to_pepxml</span>

  <span class='if if kw'>if</span> <span class='file identifier id'>file</span>
    <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='comma token'>,</span> <span class='string val'>&quot;w&quot;</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='fh identifier id'>fh</span><span class='bitor op'>|</span> <span class='fh identifier id'>fh</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string identifier id'>string</span> <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='string identifier id'>string</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>xml_version</h3>
</div><div id="xml_version-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>xml_version</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/sequest/pepxml.rb', line 217</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/ms-sequest/blob/38c1ffb09cf656ece9331d642b1db7cfd0d76c9a/lib/ms/sequest/pepxml.rb#L217">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">217
218
219</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='xml_version identifier id'>xml_version</span> 
  <span class='string val'>'&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;'</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>