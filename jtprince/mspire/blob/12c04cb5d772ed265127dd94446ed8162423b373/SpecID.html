<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>jtprince's mspire - Module: SpecID - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/jtprince/commits/mspire/master" rel="alternate" title="Recent Commits to mspire:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("jtprince", "mspire", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("jtprince", "mspire", "12c04cb5d772ed265127dd94446ed8162423b373", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/jtprince/mspire/tree/">Source</a></li>
            <li class=""><a href="http://github.com/jtprince/mspire/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/jtprince/mspire/network">Network</a></li>            
            <li class=""><a href="http://github.com/jtprince/mspire/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/jtprince/mspire">Wiki</a></li>
            <li class=""><a href="http://github.com/jtprince/mspire/graphs">Graphs</a></li>                    
            <li class="active"><a href="/jtprince/mspire">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/jtprince">jtprince</a> / <b><a href="http://github.com/jtprince/mspire/tree">mspire</a></b>        
                <a id="namespaces_button" rel="jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module SpecID">
  <h1>Module: SpecID</h1>
  <div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">filename</td>
          <td class="readwrite">
            [<span id='filename-instance_method'>R</span><span id='filename=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
A relative pathname of the file the specid object is derived from.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">hi_prob_best</td>
          <td class="readwrite">
            [<span id='hi_prob_best-instance_method'>R</span><span id='hi_prob_best=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
True if a high protein/peptide score is better than low, false otherwise
This is set automatically for known file types.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">peps</td>
          <td class="readwrite">
            [<span id='peps-instance_method'>R</span><span id='peps=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>peps</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">prots</td>
          <td class="readwrite">
            [<span id='prots-instance_method'>R</span><span id='prots=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>prots</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="AVG-constant">AVG</dt>
      <dd>Mass::AVG</dd>
    
      <dt id="MONO-constant">MONO</dt>
      <dd>Mass::MONO</dd>
    
  </dl>
</div>

</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#classify_by_prot-class_method">classify_by_prot</span><span class='args'>(items, regex, decoy_on_match = true, ties = :both)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
includes the peptide hit in both returns (target, decoy) (for peps) ties
can be :both, true (target wins), false (decoy wins) regardless of ties
behavior, will partition out the proteins to be appropriate for the
peptide.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#extend_args-class_method">extend_args</span><span class='args'>(arg, desired_size)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
takes a comma separated list or array and extends the last to create an
array of desired size.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#file_type-class_method">file_type</span><span class='args'>(file)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
# takes the existing spec_id object and marshals it into &quot;file.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#from_file-class_method">from_file</span><span class='args'>(file, tp = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
tp = file_type a single srf file will be packaged into an SRFGroup object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#occams_razor-class_method">occams_razor</span><span class='args'>(array_of_prots, update_prots = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
takes an array of proteins, each having peps peptide grouping is done by-
the protein with the most unique peptides ends up taking any degenerate
peptides, tie goes to one with most hits total, then the one that had the
top xcorr(s) (before removing any peptides).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#peps-3F-class_method">peps?</span><span class='args'>(ar)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#protein_list-class_method">protein_list</span><span class='args'>(pephits, kind = :no_update)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
given some list of SpecID::Pep based objects, returns the list of proteins
associated with those peptides kind must be a symbol: :no_update (current
proteins are returned, but their peps attribute is not updated) :update
(current proteins returned with peps attribute updated) :new (new proteins
are created complete with peps attribute).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#prots-3F-class_method">prots?</span><span class='args'>(ar)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#by_tps-instance_method">#by_tps</span><span class='args'>(classification_method, tp, fp)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
returns number of true positives (array) and the specified output (as
parallel array).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#classify-instance_method">#classify</span><span class='args'>(items, classify_item_by)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns (match, nomatch) items = symbol (:prots, :peps) Returns two arrays,
those returning true from classify_item_by and those returning false.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#classify_by_decoy_flag-instance_method">#classify_by_decoy_flag</span><span class='args'>(items, flag, decoy_on_match = true, prefix = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
returns [tp, fp] based on the protein prefix for items where items =
(:prot|:peps) this may result in a duplication of some peptides if they
match both normal and decoy proteins.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#classify_by_regex-instance_method">#classify_by_regex</span><span class='args'>(items, regex, decoy_on_match = true, ties = :both)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
for older stuff.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#inspect-instance_method">#inspect</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#min_and_best10-instance_method">#min_and_best10</span><span class='args'>(hash)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
These are pretty specific to Smriti&#8217;s needs: Given a hash of peptide
arrays by some attribute key Return two sorted arrays of sorted
probabilities The first of the min and second of the best 10 of each
peptide array.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#num_hits_and_ppv_for_prob-instance_method">#num_hits_and_ppv_for_prob</span><span class='args'>(false_flag, prefix = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
convenience method for the common task of determining precision for
proteins (with decoy proteins found by false_flag) returns (num_hits,
precision).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#num_hits_and_ppv_for_protein_prophet_probabilities-instance_method">#num_hits_and_ppv_for_protein_prophet_probabilities</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
sorts the probabilities and then calcs predicted number hits and precision
for protein probabilities (summing probabilities) one_minus_ppv =
SUM(1-probX)/#prots = what is commonly and mistakenly called false positive
rate SUM(1-probX)/#prots.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pep_probs_by_bn_scan-instance_method">#pep_probs_by_bn_scan</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
USE these if you have multiple files in your bioworks.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pep_probs_by_bn_scan_charge-instance_method">#pep_probs_by_bn_scan_charge</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
(prob_list_by_min, prob_list_by_best10) same as pep_probs_by_scan but per
charge state NOTE: you may want to hash on base_name first!.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pep_probs_by_bn_seq_charge-instance_method">#pep_probs_by_bn_seq_charge</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
(prob_list_by_min) hashes on seq-charge and returns the sorted list of
probabilities of top hit per seq-charge NOTE: you may want to hash on
base_name first!.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pep_probs_by_pep_prots-instance_method">#pep_probs_by_pep_prots</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
returns a sorted lists of probabilities based on all pepprots (a peptide
associated with a protein).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pep_probs_by_scan-instance_method">#pep_probs_by_scan</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
WARNING! These might be dangerous to your health if there are multiple
files collected in your bioworks file.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pep_probs_by_scan_charge-instance_method">#pep_probs_by_scan_charge</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
(prob_list_by_min, prob_list_by_best10) same as pep_probs_by_scan but per
charge state NOTE: you may want to hash on base_name first!.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pep_probs_by_seq_charge-instance_method">#pep_probs_by_seq_charge</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
(prob_list_by_min) hashes on seq-charge and returns the sorted list of
probabilities of top hit per seq-charge NOTE: you may want to hash on
base_name first!.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pep_prots-instance_method">#pep_prots</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
from the unique set of peptide hits, create a separate peptide hit for each
protein reference where that peptide only references that protein e.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#probability_proc-instance_method">#probability_proc</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
returns a proc for getting all probabilities so that an ascending sort will
put the best scores first.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#rank_and_classify-instance_method">#rank_and_classify</span><span class='args'>(items, rank_item_by, classify_item_by)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
returns two arrays, true positives and false positives (determined by proc
classify_item_by) sorted by proc rank_item_by.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#separate_by_prefix-instance_method">#separate_by_prefix</span><span class='args'>(items, fp_prefix)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#sorted_probabilities-instance_method">#sorted_probabilities</span><span class='args'>(peptides)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a list of sorted probabilities given the array of peptides.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>classify_by_prot</h3>
</div><div id="classify_by_prot-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>classify_by_prot</span><span class='args'>(items, regex, decoy_on_match = true, ties = :both)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
includes the peptide hit in both returns (target, decoy) (for peps) ties
can be :both, true (target wins), false (decoy wins) regardless of ties
behavior, will partition out the proteins to be appropriate for the peptide
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 276</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L276">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='classify_by_prot identifier id'>classify_by_prot</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='comma token'>,</span> <span class='regex identifier id'>regex</span><span class='comma token'>,</span> <span class='decoy_on_match identifier id'>decoy_on_match</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='comma token'>,</span> <span class='ties identifier id'>ties</span><span class='assign token'>=</span><span class='symbol val'>:both</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='items identifier id'>items</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
    <span class='return return kw'>return</span> <span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
  <span class='elsif elsif kw'>elsif</span> <span class='prots? fid id'>prots?</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='rparen token'>)</span>
    <span class='myproc identifier id'>myproc</span> <span class='assign token'>=</span> <span class='proc identifier id'>proc</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='prt identifier id'>prt</span><span class='bitor op'>|</span> 
      <span class='if if kw'>if</span> <span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='reference identifier id'>reference</span> <span class='match op'>=~</span> <span class='regex identifier id'>regex</span> <span class='semicolon token'>;</span> <span class='notop op'>!</span><span class='decoy_on_match identifier id'>decoy_on_match</span>
      <span class='else else kw'>else</span> <span class='semicolon token'>;</span> <span class='decoy_on_match identifier id'>decoy_on_match</span> <span class='end end kw'>end</span> 
    <span class='rbrace token'>}</span>
    <span class='return return kw'>return</span> <span class='classify identifier id'>classify</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='comma token'>,</span> <span class='myproc identifier id'>myproc</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='peps? fid id'>peps?</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='rparen token'>)</span>
    <span class='match identifier id'>match</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='semicolon token'>;</span> <span class='nomatch identifier id'>nomatch</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='items identifier id'>items</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span> 
      <span class='lparen token'>(</span><span class='match_prots identifier id'>match_prots</span><span class='comma token'>,</span> <span class='nomatch_prots identifier id'>nomatch_prots</span><span class='rparen token'>)</span> <span class='assign token'>=</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span><span class='dot token'>.</span><span class='partition identifier id'>partition</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='prot identifier id'>prot</span><span class='bitor op'>|</span>
        <span class='prot identifier id'>prot</span><span class='dot token'>.</span><span class='reference identifier id'>reference</span> <span class='match op'>=~</span> <span class='regex identifier id'>regex</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='match_prots identifier id'>match_prots</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
        <span class='nomatch identifier id'>nomatch</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
      <span class='elsif elsif kw'>elsif</span> <span class='nomatch_prots identifier id'>nomatch_prots</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
        <span class='match identifier id'>match</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
      <span class='else else kw'>else</span> <span class='comment val'>## both have hits</span>
        <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span> <span class='assign token'>=</span> <span class='match_prots identifier id'>match_prots</span>
        <span class='nomatch_pep identifier id'>nomatch_pep</span> <span class='assign token'>=</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
        <span class='nomatch_pep identifier id'>nomatch_pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span> <span class='assign token'>=</span> <span class='nomatch_prots identifier id'>nomatch_prots</span>

        <span class='comment val'># resolve ties</span>
        <span class='case case kw'>case</span> <span class='ties identifier id'>ties</span>
        <span class='when when kw'>when</span> <span class='true true kw'>true</span>
          <span class='if if kw'>if</span> <span class='decoy_on_match identifier id'>decoy_on_match</span>
            <span class='nomatch identifier id'>nomatch</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
          <span class='else else kw'>else</span>
            <span class='match identifier id'>match</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
          <span class='end end kw'>end</span>
        <span class='when when kw'>when</span> <span class='false false kw'>false</span>
          <span class='if if kw'>if</span> <span class='decoy_on_match identifier id'>decoy_on_match</span>
            <span class='match identifier id'>match</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
          <span class='else else kw'>else</span>
            <span class='nomatch identifier id'>nomatch</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
          <span class='end end kw'>end</span>
        <span class='when when kw'>when</span> <span class='symbol val'>:both</span>
          <span class='match identifier id'>match</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
          <span class='nomatch identifier id'>nomatch</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
        <span class='else else kw'>else</span> <span class='semicolon token'>;</span> <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='decoy_on_match identifier id'>decoy_on_match</span>
      <span class='return return kw'>return</span> <span class='lbrack token'>[</span><span class='nomatch identifier id'>nomatch</span> <span class='comma token'>,</span> <span class='match identifier id'>match</span><span class='rbrack token'>]</span>
    <span class='else else kw'>else</span>
      <span class='return return kw'>return</span> <span class='lbrack token'>[</span><span class='match identifier id'>match</span><span class='comma token'>,</span> <span class='nomatch identifier id'>nomatch</span><span class='rbrack token'>]</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>&quot;arg1 is ar of objects descended from SpecID::Prot/Pep&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>extend_args</h3>
</div><div id="extend_args-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>extend_args</span><span class='args'>(arg, desired_size)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
takes a comma separated list or array and extends the last to create an
array of desired size
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 163</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L163">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='extend_args identifier id'>extend_args</span><span class='lparen token'>(</span><span class='arg identifier id'>arg</span><span class='comma token'>,</span> <span class='desired_size identifier id'>desired_size</span><span class='rparen token'>)</span>
  <span class='arg_arr identifier id'>arg_arr</span> <span class='assign token'>=</span> <span class='arg identifier id'>arg</span>
  <span class='if if kw'>if</span> <span class='arg identifier id'>arg</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='String constant id'>String</span>
    <span class='arg_arr identifier id'>arg_arr</span> <span class='assign token'>=</span> <span class='arg identifier id'>arg</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='new_arr identifier id'>new_arr</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='last_arg identifier id'>last_arg</span> <span class='assign token'>=</span> <span class='arg_arr identifier id'>arg_arr</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
  <span class='desired_size identifier id'>desired_size</span><span class='dot token'>.</span><span class='times identifier id'>times</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='arg_arr identifier id'>arg_arr</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span>
      <span class='new_arr identifier id'>new_arr</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='arg_arr identifier id'>arg_arr</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span>
      <span class='last_arg identifier id'>last_arg</span> <span class='assign token'>=</span> <span class='new_arr identifier id'>new_arr</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span>
    <span class='else else kw'>else</span>
      <span class='new_arr identifier id'>new_arr</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='last_arg identifier id'>last_arg</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='new_arr identifier id'>new_arr</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>file_type</h3>
</div><div id="file_type-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>file_type</span><span class='args'>(file)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
# takes the existing spec_id object and marshals it into
&quot;file.msh&quot;
</p>
<pre class="code">
 <span class='comment val'># a new file will always look for a file.msh to load</span>
 <span class='def def kw'>def</span> <span class='marshal identifier id'>marshal</span><span class='lparen token'>(</span><span class='force identifier id'>force</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='rparen token'>)</span>
   <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span> <span class='@marshal_file ivar id'>@marshal_file</span><span class='rparen token'>)</span><span class='bitor op'>|</span> <span class='force identifier id'>force</span>
     <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='@marshal_file ivar id'>@marshal_file</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='out identifier id'>out</span><span class='bitor op'>|</span> <span class='Marshal constant id'>Marshal</span><span class='dot token'>.</span><span class='dump identifier id'>dump</span><span class='lparen token'>(</span><span class='@obj ivar id'>@obj</span><span class='comma token'>,</span> <span class='out identifier id'>out</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
   <span class='end end kw'>end</span>
 <span class='end end kw'>end</span>
</pre>
<p>
Returns &#8216;bioworks&#8217; if bioworks xml, &#8216;protproph&#8217; if
Protein prophet &#8216;srf&#8217; if SRF file, &#8216;srg&#8217; if search
results group file.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 457</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L457">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='file_type identifier id'>file_type</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='file identifier id'>file</span> <span class='match op'>=~</span> <span class='regexp val'>/\.srg$/</span>
    <span class='return return kw'>return</span> <span class='string val'>'srg'</span>
  <span class='elsif elsif kw'>elsif</span> <span class='file identifier id'>file</span> <span class='match op'>=~</span> <span class='regexp val'>/\.sqg$/</span>
    <span class='return return kw'>return</span> <span class='string val'>'sqg'</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='IO constant id'>IO</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='comma token'>,</span> <span class='integer val'>7</span><span class='comma token'>,</span><span class='integer val'>438</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='string val'>'Enzyme:'</span>
    <span class='return return kw'>return</span> <span class='string val'>'srf'</span>
  <span class='end end kw'>end</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='fh identifier id'>fh</span><span class='bitor op'>|</span>
    <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    <span class='float val'>8</span><span class='dot token'>.</span><span class='times identifier id'>times</span> <span class='lbrace token'>{</span> <span class='lines identifier id'>lines</span> <span class='lshft op'>&lt;&lt;</span> <span class='fh identifier id'>fh</span><span class='dot token'>.</span><span class='readline identifier id'>readline</span> <span class='rbrace token'>}</span>
    <span class='if if kw'>if</span> <span class='lines identifier id'>lines</span> <span class='match op'>=~</span> <span class='regexp val'>/&lt;bioworksinfo&gt;/</span>
      <span class='return return kw'>return</span> <span class='string val'>'bioworks'</span>
    <span class='elsif elsif kw'>elsif</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='lines identifier id'>lines</span> <span class='match op'>=~</span> <span class='regexp val'>/&lt;protein_summary/</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='lines identifier id'>lines</span> <span class='match op'>=~</span> <span class='Proph constant id'>Proph</span><span class='colon2 op'>::</span><span class='ProtSummary constant id'>ProtSummary</span><span class='colon2 op'>::</span><span class='Filetype_and_version_re_old constant id'>Filetype_and_version_re_old</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='lparen token'>(</span><span class='lines identifier id'>lines</span> <span class='match op'>=~</span> <span class='Proph constant id'>Proph</span><span class='colon2 op'>::</span><span class='ProtSummary constant id'>ProtSummary</span><span class='colon2 op'>::</span><span class='Filetype_and_version_re_new constant id'>Filetype_and_version_re_new</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='return return kw'>return</span> <span class='string val'>'protproph'</span>
    <span class='elsif elsif kw'>elsif</span> <span class='lines identifier id'>lines</span> <span class='match op'>=~</span> <span class='regexp val'>/&lt;msms_pipeline_analysis.*&lt;peptideprophet_summary/</span><span class='m identifier id'>m</span>
      <span class='return return kw'>return</span> <span class='string val'>'pepproph'</span>
    <span class='end end kw'>end</span>
    <span class='comment val'># assumes the header of a sqt file is less than 200 lines ...</span>
    <span class='float val'>200</span><span class='dot token'>.</span><span class='times identifier id'>times</span> <span class='do do kw'>do</span> 
      <span class='line identifier id'>line</span> <span class='assign token'>=</span> <span class='fh identifier id'>fh</span><span class='dot token'>.</span><span class='gets identifier id'>gets</span>
      <span class='if if kw'>if</span> <span class='line identifier id'>line</span>
        <span class='lines identifier id'>lines</span> <span class='lshft op'>&lt;&lt;</span> <span class='line identifier id'>line</span>
      <span class='else else kw'>else</span> <span class='semicolon token'>;</span> <span class='break break kw'>break</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='lines identifier id'>lines</span> <span class='match op'>=~</span> <span class='regexp val'>/^H\tDatabase/</span> <span class='and and kw'>and</span> <span class='lines identifier id'>lines</span> <span class='match op'>=~</span> <span class='regexp val'>/^H\tSQTGenerator/</span>
      <span class='return return kw'>return</span> <span class='string val'>'sqt'</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>from_file</h3>
</div><div id="from_file-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>from_file</span><span class='args'>(file, tp = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
tp = file_type a single srf file will be packaged into an SRFGroup object
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 60</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L60">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='from_file identifier id'>from_file</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='comma token'>,</span> <span class='tp identifier id'>tp</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='obj identifier id'>obj</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='unless unless kw'>unless</span> <span class='tp identifier id'>tp</span>
    <span class='tp identifier id'>tp</span> <span class='assign token'>=</span> <span class='file_type identifier id'>file_type</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='obj identifier id'>obj</span> <span class='assign token'>=</span> <span class='case case kw'>case</span> <span class='tp identifier id'>tp</span>
  <span class='when when kw'>when</span> <span class='string val'>'srf'</span>
    <span class='comment val'>#@hi_prob_best = false</span>
    <span class='SRFGroup constant id'>SRFGroup</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='file identifier id'>file</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>'srg'</span>
    <span class='comment val'>#@hi_prob_best = false</span>
    <span class='SRFGroup constant id'>SRFGroup</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>'bioworks'</span>
    <span class='comment val'>#@hi_prob_best = false</span>
    <span class='Bioworks constant id'>Bioworks</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>'protproph'</span>
    <span class='comment val'>#@hi_prob_best = true</span>
    <span class='Proph constant id'>Proph</span><span class='colon2 op'>::</span><span class='ProtSummary constant id'>ProtSummary</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>'pepproph'</span>
    <span class='Proph constant id'>Proph</span><span class='colon2 op'>::</span><span class='PepSummary constant id'>PepSummary</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>'sqg'</span>
    <span class='SQTGroup constant id'>SQTGroup</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>'sqt'</span>
    <span class='SQTGroup constant id'>SQTGroup</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='file identifier id'>file</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='abort identifier id'>abort</span> <span class='dstring node'>&quot;UNRECOGNIZED file type for #{file}&quot;</span>
  <span class='end end kw'>end</span>
  <span class='obj identifier id'>obj</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>occams_razor</h3>
</div><div id="occams_razor-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>occams_razor</span><span class='args'>(array_of_prots, update_prots = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
takes an array of proteins, each having peps peptide grouping is done by-
the protein with the most unique peptides ends up taking any degenerate
peptides, tie goes to one with most hits total, then the one that had the
top xcorr(s) (before removing any peptides).All other proteins with
identical peptides will lose those peptides. So, the rich stay rich, and
the poor get poorer. returns an array of triplets where each is [prot,
pep_hits, uniq_aaseqs] (uniq_aaseqs is an array) where the protein contains
&gt;= 1 peptide. The internal links (prot.peps and pep.prots) is NOT
modified!! update_prots == true will set each protein with the peptides
found
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 193</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L193">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='occams_razor identifier id'>occams_razor</span><span class='lparen token'>(</span><span class='array_of_prots identifier id'>array_of_prots</span><span class='comma token'>,</span> <span class='update_prots identifier id'>update_prots</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='peps_found identifier id'>peps_found</span> <span class='assign token'>=</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span> 

  <span class='to_sort identifier id'>to_sort</span> <span class='assign token'>=</span> <span class='array_of_prots identifier id'>array_of_prots</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='prot identifier id'>prot</span><span class='bitor op'>|</span>
    <span class='pps identifier id'>pps</span> <span class='assign token'>=</span> <span class='prot identifier id'>prot</span><span class='dot token'>.</span><span class='peps identifier id'>peps</span>

    <span class='peps_by_uniq_aaseq identifier id'>peps_by_uniq_aaseq</span> <span class='assign token'>=</span> <span class='pps identifier id'>pps</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:aaseq</span><span class='rparen token'>)</span>
    <span class='uniq_aaseqs identifier id'>uniq_aaseqs</span> <span class='assign token'>=</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='pps identifier id'>pps</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='aaseq identifier id'>aaseq</span> <span class='rbrace token'>}</span> <span class='rparen token'>)</span>
    <span class='xcorrs identifier id'>xcorrs</span> <span class='assign token'>=</span> <span class='pps identifier id'>pps</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='xcorr identifier id'>xcorr</span> <span class='rbrace token'>}</span>

    <span class='silly identifier id'>silly</span> <span class='assign token'>=</span> <span class='OpenStruct constant id'>OpenStruct</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='comment val'># 0                1         2            3     4            5</span>
    <span class='lbrack token'>[</span><span class='uniq_aaseqs identifier id'>uniq_aaseqs</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='comma token'>,</span> <span class='pps identifier id'>pps</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='comma token'>,</span> <span class='xcorrs identifier id'>xcorrs</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span><span class='comma token'>,</span> <span class='prot identifier id'>prot</span><span class='comma token'>,</span> <span class='uniq_aaseqs identifier id'>uniq_aaseqs</span><span class='comma token'>,</span> <span class='peps_by_uniq_aaseq identifier id'>peps_by_uniq_aaseq</span><span class='rbrack token'>]</span> 
  <span class='end end kw'>end</span>
  <span class='prot_triplets identifier id'>prot_triplets</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='to_sort identifier id'>to_sort</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span><span class='dot token'>.</span><span class='reverse identifier id'>reverse</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='ar identifier id'>ar</span><span class='bitor op'>|</span>
    <span class='prot identifier id'>prot</span> <span class='assign token'>=</span> <span class='ar identifier id'>ar</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span>
    <span class='comment val'>## overlapping set:</span>
    <span class='common identifier id'>common</span> <span class='assign token'>=</span> <span class='peps_found identifier id'>peps_found</span> <span class='bitand op'>&amp;</span> <span class='ar identifier id'>ar</span><span class='lbrack token'>[</span><span class='integer val'>4</span><span class='rbrack token'>]</span>
    <span class='comment val'>## find the uniq ones in our little set of peptides:</span>
    <span class='uniq identifier id'>uniq</span> <span class='assign token'>=</span> <span class='ar identifier id'>ar</span><span class='lbrack token'>[</span><span class='integer val'>4</span><span class='rbrack token'>]</span> <span class='minus op'>-</span> <span class='common identifier id'>common</span>
    <span class='pep_hits identifier id'>pep_hits</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='if if kw'>if</span> <span class='uniq identifier id'>uniq</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
      <span class='comment val'>## add to the found list:</span>
      <span class='peps_found identifier id'>peps_found</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='uniq identifier id'>uniq</span><span class='rparen token'>)</span>
      <span class='uniq identifier id'>uniq</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='seq identifier id'>seq</span><span class='bitor op'>|</span>
        <span class='pep_hits identifier id'>pep_hits</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span> <span class='mult op'>*</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='lbrack token'>[</span><span class='integer val'>5</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='seq identifier id'>seq</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rparen token'>)</span> 
      <span class='end end kw'>end</span>
      <span class='prot_triplets identifier id'>prot_triplets</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='prot identifier id'>prot</span><span class='comma token'>,</span> <span class='pep_hits identifier id'>pep_hits</span><span class='comma token'>,</span> <span class='uniq identifier id'>uniq</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='rbrack token'>]</span>
      <span class='prot identifier id'>prot</span><span class='dot token'>.</span><span class='peps identifier id'>peps</span> <span class='assign token'>=</span> <span class='pep_hits identifier id'>pep_hits</span> <span class='if if_mod kw'>if</span> <span class='update_prots identifier id'>update_prots</span> 
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='prot_triplets identifier id'>prot_triplets</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>peps?</h3>
</div><div id="peps-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>peps?</span><span class='args'>(ar)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 255</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L255">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">255
256
257</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='peps? fid id'>peps?</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='rparen token'>)</span>
  <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='SpecID constant id'>SpecID</span><span class='colon2 op'>::</span><span class='Pep constant id'>Pep</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>protein_list</h3>
</div><div id="protein_list-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>protein_list</span><span class='args'>(pephits, kind = :no_update)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
given some list of SpecID::Pep based objects, returns the list of proteins
associated with those peptides kind must be a symbol: :no_update (current
proteins are returned, but their peps attribute is not updated) :update
(current proteins returned with peps attribute updated) :new (new proteins
are created complete with peps attribute)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 107</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L107">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='protein_list identifier id'>protein_list</span><span class='lparen token'>(</span><span class='pephits identifier id'>pephits</span><span class='comma token'>,</span> <span class='kind identifier id'>kind</span><span class='assign token'>=</span><span class='symbol val'>:no_update</span><span class='rparen token'>)</span>

  <span class='orig_pephits_prts identifier id'>orig_pephits_prts</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='if if kw'>if</span> <span class='kind identifier id'>kind</span> <span class='eq op'>==</span> <span class='symbol val'>:new</span>
    <span class='new_prots identifier id'>new_prots</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
    <span class='pephits identifier id'>pephits</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='comma token'>,</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
      <span class='orig_pephits_prts identifier id'>orig_pephits_prts</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span>
      <span class='peps_new_prts identifier id'>peps_new_prts</span> <span class='assign token'>=</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='prt identifier id'>prt</span><span class='bitor op'>|</span>
        <span class='if if kw'>if</span> <span class='new_prots identifier id'>new_prots</span><span class='dot token'>.</span><span class='key? fid id'>key?</span> <span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='reference identifier id'>reference</span>
          <span class='already_exists identifier id'>already_exists</span> <span class='assign token'>=</span> <span class='new_prots identifier id'>new_prots</span><span class='lbrack token'>[</span><span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='reference identifier id'>reference</span><span class='rbrack token'>]</span>
        <span class='else else kw'>else</span>
          <span class='np identifier id'>np</span> <span class='assign token'>=</span> <span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
          <span class='np identifier id'>np</span><span class='dot token'>.</span><span class='peps identifier id'>peps</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
          <span class='new_prots identifier id'>new_prots</span><span class='lbrack token'>[</span><span class='np identifier id'>np</span><span class='dot token'>.</span><span class='reference identifier id'>reference</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='np identifier id'>np</span>
          <span class='np identifier id'>np</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span> <span class='assign token'>=</span> <span class='peps_new_prts identifier id'>peps_new_prts</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='kind identifier id'>kind</span> <span class='eq op'>==</span> <span class='symbol val'>:update</span>
    <span class='pephits identifier id'>pephits</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span>
      <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='prt identifier id'>prt</span><span class='bitor op'>|</span>
        <span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='peps identifier id'>peps</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='prot_set identifier id'>prot_set</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='pephits identifier id'>pephits</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span>
    <span class='prts identifier id'>prts</span> <span class='assign token'>=</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span>
    <span class='prts identifier id'>prts</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='prt identifier id'>prt</span><span class='bitor op'>|</span>
      <span class='prot_set identifier id'>prot_set</span><span class='lbrack token'>[</span> <span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='reference identifier id'>reference</span> <span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='prt identifier id'>prt</span> 
    <span class='end end kw'>end</span>
    <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='kind identifier id'>kind</span> <span class='eq op'>==</span> <span class='symbol val'>:update</span> <span class='orop op'>||</span> <span class='kind identifier id'>kind</span> <span class='eq op'>==</span> <span class='symbol val'>:new</span><span class='rparen token'>)</span>
      <span class='prts identifier id'>prts</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='prt identifier id'>prt</span><span class='bitor op'>|</span>
        <span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='peps identifier id'>peps</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='comment val'>## Reset the original protein hits</span>
  <span class='if if kw'>if</span> <span class='kind identifier id'>kind</span> <span class='eq op'>==</span> <span class='symbol val'>:new</span>
    <span class='pephits identifier id'>pephits</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='comma token'>,</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
      <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span> <span class='assign token'>=</span> <span class='orig_pephits_prts identifier id'>orig_pephits_prts</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='prot_set identifier id'>prot_set</span><span class='dot token'>.</span><span class='values identifier id'>values</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>prots?</h3>
</div><div id="prots-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>prots?</span><span class='args'>(ar)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 251</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L251">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">251
252
253</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='prots? fid id'>prots?</span><span class='lparen token'>(</span><span class='ar identifier id'>ar</span><span class='rparen token'>)</span>
  <span class='ar identifier id'>ar</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='SpecID constant id'>SpecID</span><span class='colon2 op'>::</span><span class='Prot constant id'>Prot</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>by_tps</h3>
</div><div id="by_tps-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>by_tps</span><span class='args'>(classification_method, tp, fp)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
returns number of true positives (array) and the specified output (as
parallel array). Requires the classification method and a sorted array of
tp values and an array fp values. (This is simply a wrapper around
ROC#by_tps method!)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 232</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L232">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">232
233
234</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='by_tps identifier id'>by_tps</span><span class='lparen token'>(</span><span class='classification_method identifier id'>classification_method</span><span class='comma token'>,</span> <span class='tp identifier id'>tp</span><span class='comma token'>,</span> <span class='fp identifier id'>fp</span><span class='rparen token'>)</span>
  <span class='ROC constant id'>ROC</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='dot token'>.</span><span class='by_tps identifier id'>by_tps</span><span class='lparen token'>(</span><span class='classification_method identifier id'>classification_method</span><span class='comma token'>,</span> <span class='tp identifier id'>tp</span><span class='comma token'>,</span> <span class='fp identifier id'>fp</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>classify</h3>
</div><div id="classify-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>classify</span><span class='args'>(items, classify_item_by)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns (match, nomatch) items = symbol (:prots, :peps) Returns two arrays,
those returning true from classify_item_by and those returning false
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 351</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L351">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">351
352
353
354
355
356
357
358
359
360
361
362</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='classify identifier id'>classify</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='comma token'>,</span> <span class='classify_item_by identifier id'>classify_item_by</span><span class='rparen token'>)</span>
  <span class='its identifier id'>its</span> <span class='assign token'>=</span> <span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='rparen token'>)</span>
  <span class='f identifier id'>f</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='semicolon token'>;</span> <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='its identifier id'>its</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='it identifier id'>it</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='classify_item_by identifier id'>classify_item_by</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='it identifier id'>it</span><span class='rparen token'>)</span>
      <span class='t identifier id'>t</span> <span class='lshft op'>&lt;&lt;</span> <span class='it identifier id'>it</span>
    <span class='else else kw'>else</span>
      <span class='f identifier id'>f</span> <span class='lshft op'>&lt;&lt;</span> <span class='it identifier id'>it</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='lbrack token'>[</span><span class='t identifier id'>t</span><span class='comma token'>,</span><span class='f identifier id'>f</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>classify_by_decoy_flag</h3>
</div><div id="classify_by_decoy_flag-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>classify_by_decoy_flag</span><span class='args'>(items, flag, decoy_on_match = true, prefix = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
returns [tp, fp] based on the protein prefix for items where items =
(:prot|:peps) this may result in a duplication of some peptides if they
match both normal and decoy proteins. In this case, the protein arrays are
split, too, so that each points only to its breed of protein.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 338</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L338">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">338
339
340
341
342
343
344
345</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='classify_by_decoy_flag identifier id'>classify_by_decoy_flag</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='comma token'>,</span> <span class='flag identifier id'>flag</span><span class='comma token'>,</span> <span class='decoy_on_match identifier id'>decoy_on_match</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='comma token'>,</span> <span class='prefix identifier id'>prefix</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='prefix identifier id'>prefix</span>
    <span class='regex identifier id'>regex</span> <span class='assign token'>=</span> <span class='dregexp node'>/^#{Regexp.escape(flag)}/</span> 
  <span class='else else kw'>else</span>
    <span class='regex identifier id'>regex</span> <span class='assign token'>=</span> <span class='dregexp node'>/#{Regexp.escape(flag)}/</span> 
  <span class='end end kw'>end</span>
  <span class='classify_by_regex identifier id'>classify_by_regex</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='comma token'>,</span> <span class='regex identifier id'>regex</span><span class='comma token'>,</span> <span class='decoy_on_match identifier id'>decoy_on_match</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>classify_by_regex</h3>
</div><div id="classify_by_regex-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>classify_by_regex</span><span class='args'>(items, regex, decoy_on_match = true, ties = :both)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
for older stuff
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 260</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L260">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">260
261
262
263
264
265
266
267
268
269</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='classify_by_regex identifier id'>classify_by_regex</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='comma token'>,</span> <span class='regex identifier id'>regex</span><span class='comma token'>,</span> <span class='decoy_on_match identifier id'>decoy_on_match</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='comma token'>,</span> <span class='ties identifier id'>ties</span><span class='assign token'>=</span><span class='symbol val'>:both</span><span class='rparen token'>)</span>
  <span class='objects identifier id'>objects</span> <span class='assign token'>=</span> 
    <span class='case case kw'>case</span> <span class='items identifier id'>items</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:prots</span>
      <span class='prots identifier id'>prots</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:peps</span>
      <span class='peps identifier id'>peps</span>
    <span class='end end kw'>end</span>
  <span class='SpecID constant id'>SpecID</span><span class='dot token'>.</span><span class='classify_by_prot identifier id'>classify_by_prot</span><span class='lparen token'>(</span><span class='objects identifier id'>objects</span><span class='comma token'>,</span> <span class='regex identifier id'>regex</span><span class='comma token'>,</span> <span class='decoy_on_match identifier id'>decoy_on_match</span><span class='comma token'>,</span> <span class='ties identifier id'>ties</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>inspect</h3>
</div><div id="inspect-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>inspect</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 90</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L90">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">90
91
92
93
94
95
96
97
98</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span>
  <span class='peps_string identifier id'>peps_string</span> <span class='assign token'>=</span>
    <span class='if if kw'>if</span> <span class='peps identifier id'>peps</span>
      <span class='dstring node'>&quot;peps(#)=#{peps.size}&quot;</span>
    <span class='else else kw'>else</span>
      <span class='string val'>&quot;peps=(nil)&quot;</span>
    <span class='end end kw'>end</span>
  <span class='dstring node'>&quot;&lt;#{self.class} #{peps_string}&gt;&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>min_and_best10</h3>
</div><div id="min_and_best10-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>min_and_best10</span><span class='args'>(hash)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
These are pretty specific to Smriti&#8217;s needs: Given a hash of peptide
arrays by some attribute key Return two sorted arrays of sorted
probabilities The first of the min and second of the best 10 of each
peptide array
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 497</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L497">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='min_and_best10 identifier id'>min_and_best10</span><span class='lparen token'>(</span><span class='hash identifier id'>hash</span><span class='rparen token'>)</span>
  <span class='comment val'>## choose the min probability and sort by prob</span>
  <span class='min_peptides identifier id'>min_peptides</span> <span class='assign token'>=</span> <span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span><span class='v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='comma token'>,</span><span class='b identifier id'>b</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='peptide_probability identifier id'>peptide_probability</span> <span class='cmp op'>&lt;=&gt;</span> <span class='b identifier id'>b</span><span class='dot token'>.</span><span class='peptide_probability identifier id'>peptide_probability</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='comment val'>#puts min_peptides[0] # -&gt; Bioworks::Pep</span>
  <span class='min_sorted_peps identifier id'>min_sorted_peps</span> <span class='assign token'>=</span> <span class='sorted_probabilities identifier id'>sorted_probabilities</span><span class='lparen token'>(</span><span class='min_peptides identifier id'>min_peptides</span><span class='rparen token'>)</span>
  <span class='comment val'>#puts min_sorted_peps[0] # -&gt; probability (Float)</span>

  <span class='peptides_by_tens identifier id'>peptides_by_tens</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> 
  <span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span><span class='v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='arr identifier id'>arr</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='sort_by identifier id'>sort_by</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='peptide_probability identifier id'>peptide_probability</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='slice identifier id'>slice</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>10</span><span class='rparen token'>)</span>
    <span class='peptides_by_tens identifier id'>peptides_by_tens</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arr identifier id'>arr</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='top_10_sorted_peps identifier id'>top_10_sorted_peps</span> <span class='assign token'>=</span> <span class='sorted_probabilities identifier id'>sorted_probabilities</span><span class='lparen token'>(</span><span class='peptides_by_tens identifier id'>peptides_by_tens</span><span class='rparen token'>)</span>
  <span class='comment val'>#puts top_10_sorted_peps[0] # -&gt; float</span>
  <span class='comment val'>#puts &quot;size: top_10_sorted_peps.size : #{top_10_sorted_peps.size}&quot;</span>
  <span class='comment val'>#puts &quot;size: min_sorted_peps.size : #{min_sorted_peps.size}&quot;</span>
  <span class='comment val'>#p top_10_sorted_peps</span>
  <span class='comment val'>#p min_sorted_peps </span>
  <span class='return return kw'>return</span> <span class='min_sorted_peps identifier id'>min_sorted_peps</span><span class='comma token'>,</span> <span class='top_10_sorted_peps identifier id'>top_10_sorted_peps</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>num_hits_and_ppv_for_prob</h3>
</div><div id="num_hits_and_ppv_for_prob-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>num_hits_and_ppv_for_prob</span><span class='args'>(false_flag, prefix = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
convenience method for the common task of determining precision for
proteins (with decoy proteins found by false_flag) returns (num_hits,
precision)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 429</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L429">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='num_hits_and_ppv_for_prob identifier id'>num_hits_and_ppv_for_prob</span><span class='lparen token'>(</span><span class='false_flag identifier id'>false_flag</span><span class='comma token'>,</span> <span class='prefix identifier id'>prefix</span><span class='assign token'>=</span><span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='prefix identifier id'>prefix</span>
    <span class='regex identifier id'>regex</span> <span class='assign token'>=</span> <span class='dregexp node'>/^#{Regexp.escape(false_flag)}/</span> 
  <span class='else else kw'>else</span>
    <span class='regex identifier id'>regex</span> <span class='assign token'>=</span> <span class='dregexp node'>/#{Regexp.escape(false_flag)}/</span> 
  <span class='end end kw'>end</span>
  <span class='prob_proc identifier id'>prob_proc</span> <span class='assign token'>=</span> <span class='probability_proc identifier id'>probability_proc</span>
  <span class='myproc identifier id'>myproc</span> <span class='assign token'>=</span> <span class='proc identifier id'>proc</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='prt identifier id'>prt</span><span class='bitor op'>|</span> 
    <span class='if if kw'>if</span> <span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='reference identifier id'>reference</span> <span class='match op'>=~</span> <span class='regex identifier id'>regex</span> <span class='semicolon token'>;</span> <span class='false false kw'>false</span>
    <span class='else else kw'>else</span> <span class='semicolon token'>;</span> <span class='true true kw'>true</span> <span class='end end kw'>end</span> 
  <span class='rbrace token'>}</span>

  <span class='real_hits identifier id'>real_hits</span><span class='comma token'>,</span> <span class='decoy_hits identifier id'>decoy_hits</span> <span class='assign token'>=</span> <span class='rank_and_classify identifier id'>rank_and_classify</span><span class='lparen token'>(</span><span class='symbol val'>:prots</span><span class='comma token'>,</span> <span class='prob_proc identifier id'>prob_proc</span><span class='comma token'>,</span> <span class='myproc identifier id'>myproc</span><span class='rparen token'>)</span>
  
  <span class='lparen token'>(</span><span class='num_hits identifier id'>num_hits</span><span class='comma token'>,</span> <span class='num_tps identifier id'>num_tps</span><span class='comma token'>,</span> <span class='precision identifier id'>precision</span><span class='rparen token'>)</span> <span class='assign token'>=</span> <span class='DecoyROC constant id'>DecoyROC</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='dot token'>.</span><span class='pred_and_tps_and_ppv identifier id'>pred_and_tps_and_ppv</span><span class='lparen token'>(</span><span class='real_hits identifier id'>real_hits</span><span class='comma token'>,</span> <span class='decoy_hits identifier id'>decoy_hits</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span><span class='num_hits identifier id'>num_hits</span><span class='comma token'>,</span> <span class='precision identifier id'>precision</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>num_hits_and_ppv_for_protein_prophet_probabilities</h3>
</div><div id="num_hits_and_ppv_for_protein_prophet_probabilities-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>num_hits_and_ppv_for_protein_prophet_probabilities</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
sorts the probabilities and then calcs predicted number hits and precision
for protein probabilities (summing probabilities) one_minus_ppv =
SUM(1-probX)/#prots = what is commonly and mistakenly called false positive
rate SUM(1-probX)/#prots
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 409</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L409">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='num_hits_and_ppv_for_protein_prophet_probabilities identifier id'>num_hits_and_ppv_for_protein_prophet_probabilities</span>
  <span class='current_sum_one_minus_prob identifier id'>current_sum_one_minus_prob</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='num_prots identifier id'>num_prots</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='ppv identifier id'>ppv</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='prot_cnt identifier id'>prot_cnt</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='probs identifier id'>probs</span> <span class='assign token'>=</span> <span class='prots identifier id'>prots</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='probability identifier id'>probability</span><span class='rbrace token'>}</span>
  <span class='sorted identifier id'>sorted</span> <span class='assign token'>=</span> <span class='probs identifier id'>probs</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span><span class='dot token'>.</span><span class='reverse identifier id'>reverse</span>
  <span class='sorted identifier id'>sorted</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='prob identifier id'>prob</span><span class='bitor op'>|</span>
    <span class='prot_cnt identifier id'>prot_cnt</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
    <span class='num_prots identifier id'>num_prots</span> <span class='lshft op'>&lt;&lt;</span> <span class='prot_cnt identifier id'>prot_cnt</span>
    <span class='current_sum_one_minus_prob identifier id'>current_sum_one_minus_prob</span> <span class='opasgn op'>+=</span> <span class='float val'>1.0</span> <span class='minus op'>-</span> <span class='prob identifier id'>prob</span>
    <span class='ppv identifier id'>ppv</span> <span class='lshft op'>&lt;&lt;</span> <span class='float val'>1.0</span> <span class='minus op'>-</span> <span class='lparen token'>(</span> <span class='current_sum_one_minus_prob identifier id'>current_sum_one_minus_prob</span> <span class='div op'>/</span> <span class='prot_cnt identifier id'>prot_cnt</span> <span class='rparen token'>)</span>
    <span class='comment val'># current_fpr_ratio = current_sum_one_minus_prob / prot_cnt</span>
  <span class='end end kw'>end</span>
  <span class='lbrack token'>[</span><span class='num_prots identifier id'>num_prots</span><span class='comma token'>,</span> <span class='ppv identifier id'>ppv</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pep_probs_by_bn_scan</h3>
</div><div id="pep_probs_by_bn_scan-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pep_probs_by_bn_scan</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
USE these if you have multiple files in your bioworks.xml file
</p>
<p>
(prob_list_by_min, prob_list_by_best10) returns 2 sorted lists of
probabilities based on:
</p>
<pre class="code">
  <span class='float val'>1</span><span class='dot token'>.</span> <span class='best identifier id'>best</span> <span class='peptide identifier id'>peptide</span> <span class='hit identifier id'>hit</span>
  <span class='float val'>2</span><span class='dot token'>.</span> <span class='top identifier id'>top</span> <span class='integer val'>10</span> <span class='peptide identifier id'>peptide</span> <span class='hits identifier id'>hits</span>
</pre>
<p>
on a per scan basis NOTE: you may want to hash on base_name first!
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 582</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L582">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">582
583
584
585</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pep_probs_by_bn_scan identifier id'>pep_probs_by_bn_scan</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:base_name</span><span class='comma token'>,</span> <span class='symbol val'>:first_scan</span><span class='comma token'>,</span> <span class='symbol val'>:last_scan</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='min_and_best10 identifier id'>min_and_best10</span><span class='lparen token'>(</span><span class='hash identifier id'>hash</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pep_probs_by_bn_scan_charge</h3>
</div><div id="pep_probs_by_bn_scan_charge-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pep_probs_by_bn_scan_charge</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
(prob_list_by_min, prob_list_by_best10) same as pep_probs_by_scan but per
charge state NOTE: you may want to hash on base_name first!
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 591</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L591">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">591
592
593
594</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pep_probs_by_bn_scan_charge identifier id'>pep_probs_by_bn_scan_charge</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:base_name</span><span class='comma token'>,</span> <span class='symbol val'>:first_scan</span><span class='comma token'>,</span> <span class='symbol val'>:last_scan</span><span class='comma token'>,</span> <span class='symbol val'>:charge</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='min_and_best10 identifier id'>min_and_best10</span><span class='lparen token'>(</span><span class='hash identifier id'>hash</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pep_probs_by_bn_seq_charge</h3>
</div><div id="pep_probs_by_bn_seq_charge-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pep_probs_by_bn_seq_charge</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
(prob_list_by_min) hashes on seq-charge and returns the sorted list of
probabilities of top hit per seq-charge NOTE: you may want to hash on
base_name first!
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 600</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L600">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">600
601
602
603
604
605
606</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pep_probs_by_bn_seq_charge identifier id'>pep_probs_by_bn_seq_charge</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:base_name</span><span class='comma token'>,</span> <span class='symbol val'>:sequence</span><span class='comma token'>,</span> <span class='symbol val'>:charge</span><span class='rparen token'>)</span>
  <span class='min_peptides identifier id'>min_peptides</span> <span class='assign token'>=</span> <span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span><span class='v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='comma token'>,</span><span class='b identifier id'>b</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='peptide_probability identifier id'>peptide_probability</span> <span class='cmp op'>&lt;=&gt;</span> <span class='b identifier id'>b</span><span class='dot token'>.</span><span class='peptide_probability identifier id'>peptide_probability</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='sorted_probabilities identifier id'>sorted_probabilities</span><span class='lparen token'>(</span><span class='min_peptides identifier id'>min_peptides</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pep_probs_by_pep_prots</h3>
</div><div id="pep_probs_by_pep_prots-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pep_probs_by_pep_prots</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
returns a sorted lists of probabilities based on all pepprots (a peptide
associated with a protein)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 532</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L532">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">532
533
534</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pep_probs_by_pep_prots identifier id'>pep_probs_by_pep_prots</span>
  <span class='sorted_probabilities identifier id'>sorted_probabilities</span><span class='lparen token'>(</span><span class='peps identifier id'>peps</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pep_probs_by_scan</h3>
</div><div id="pep_probs_by_scan-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pep_probs_by_scan</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
WARNING! These might be dangerous to your health if there are multiple
files collected in your bioworks file
</p>
<p>
(prob_list_by_min, prob_list_by_best10) returns 2 sorted lists of
probabilities based on:
</p>
<pre class="code">
  <span class='float val'>1</span><span class='dot token'>.</span> <span class='best identifier id'>best</span> <span class='peptide identifier id'>peptide</span> <span class='hit identifier id'>hit</span>
  <span class='float val'>2</span><span class='dot token'>.</span> <span class='top identifier id'>top</span> <span class='integer val'>10</span> <span class='peptide identifier id'>peptide</span> <span class='hits identifier id'>hits</span>
</pre>
<p>
on a per scan basis NOTE: you may want to hash on base_name first!
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 547</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L547">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">547
548
549
550</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pep_probs_by_scan identifier id'>pep_probs_by_scan</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:first_scan</span><span class='comma token'>,</span> <span class='symbol val'>:last_scan</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='min_and_best10 identifier id'>min_and_best10</span><span class='lparen token'>(</span><span class='hash identifier id'>hash</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pep_probs_by_scan_charge</h3>
</div><div id="pep_probs_by_scan_charge-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pep_probs_by_scan_charge</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
(prob_list_by_min, prob_list_by_best10) same as pep_probs_by_scan but per
charge state NOTE: you may want to hash on base_name first!
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 556</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L556">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">556
557
558
559</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pep_probs_by_scan_charge identifier id'>pep_probs_by_scan_charge</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:first_scan</span><span class='comma token'>,</span> <span class='symbol val'>:last_scan</span><span class='comma token'>,</span> <span class='symbol val'>:charge</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='min_and_best10 identifier id'>min_and_best10</span><span class='lparen token'>(</span><span class='hash identifier id'>hash</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pep_probs_by_seq_charge</h3>
</div><div id="pep_probs_by_seq_charge-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pep_probs_by_seq_charge</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
(prob_list_by_min) hashes on seq-charge and returns the sorted list of
probabilities of top hit per seq-charge NOTE: you may want to hash on
base_name first!
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 565</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L565">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">565
566
567
568
569
570
571</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pep_probs_by_seq_charge identifier id'>pep_probs_by_seq_charge</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='symbol val'>:sequence</span><span class='comma token'>,</span> <span class='symbol val'>:charge</span><span class='rparen token'>)</span>
  <span class='min_peptides identifier id'>min_peptides</span> <span class='assign token'>=</span> <span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span><span class='v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='min identifier id'>min</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='comma token'>,</span><span class='b identifier id'>b</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='peptide_probability identifier id'>peptide_probability</span> <span class='cmp op'>&lt;=&gt;</span> <span class='b identifier id'>b</span><span class='dot token'>.</span><span class='peptide_probability identifier id'>peptide_probability</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='sorted_probabilities identifier id'>sorted_probabilities</span><span class='lparen token'>(</span><span class='min_peptides identifier id'>min_peptides</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pep_prots</h3>
</div><div id="pep_prots-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pep_prots</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
from the unique set of peptide hits, create a separate peptide hit for each
protein reference where that peptide only references that protein e.g.
pep.prots = [(a single protein)]
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 239</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L239">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">239
240
241
242
243
244
245
246
247
248
249</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pep_prots identifier id'>pep_prots</span>
  <span class='pps identifier id'>pps</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span>
    <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='prt identifier id'>prt</span><span class='bitor op'>|</span>
      <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>     
      <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='prots identifier id'>prots</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='prt identifier id'>prt</span><span class='rbrack token'>]</span>
      <span class='pps identifier id'>pps</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='pps identifier id'>pps</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>probability_proc</h3>
</div><div id="probability_proc-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>probability_proc</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
returns a proc for getting all probabilities so that an ascending sort will
put the best scores first
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 383</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L383">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">383
384
385
386
387
388
389
390</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='probability_proc identifier id'>probability_proc</span>
  <span class='if if kw'>if</span> <span class='hi_prob_best identifier id'>hi_prob_best</span>
    <span class='get_prob_proc identifier id'>get_prob_proc</span> <span class='assign token'>=</span> <span class='proc identifier id'>proc</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='prt identifier id'>prt</span><span class='bitor op'>|</span> <span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='probability identifier id'>probability</span> <span class='mult op'>*</span> <span class='integer val'>-1</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='get_prob_proc identifier id'>get_prob_proc</span> <span class='assign token'>=</span> <span class='proc identifier id'>proc</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='prt identifier id'>prt</span><span class='bitor op'>|</span> <span class='prt identifier id'>prt</span><span class='dot token'>.</span><span class='probability identifier id'>probability</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='get_prob_proc identifier id'>get_prob_proc</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rank_and_classify</h3>
</div><div id="rank_and_classify-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rank_and_classify</span><span class='args'>(items, rank_item_by, classify_item_by)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
returns two arrays, true positives and false positives (determined by proc
classify_item_by) sorted by proc rank_item_by. Items will be ranked from
lowest to highest based on the return value of rank_item_by. items is a
symbol (:prots or :peps)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 368</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L368">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">368
369
370
371
372
373
374
375
376
377
378</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='rank_and_classify identifier id'>rank_and_classify</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='comma token'>,</span> <span class='rank_item_by identifier id'>rank_item_by</span><span class='comma token'>,</span> <span class='classify_item_by identifier id'>classify_item_by</span><span class='rparen token'>)</span>
  <span class='its identifier id'>its</span> <span class='assign token'>=</span> <span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='rparen token'>)</span>
  <span class='comment val'>#its.each do |it| puts it.probability.to_s ; puts it.reference end</span>
  <span class='doublets identifier id'>doublets</span> <span class='assign token'>=</span> <span class='its identifier id'>its</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='item identifier id'>item</span><span class='bitor op'>|</span>
    <span class='lbrack token'>[</span> <span class='rank_item_by identifier id'>rank_item_by</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='item identifier id'>item</span><span class='rparen token'>)</span><span class='comma token'>,</span>
      <span class='classify_item_by identifier id'>classify_item_by</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='item identifier id'>item</span><span class='rparen token'>)</span> <span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='roc identifier id'>roc</span> <span class='assign token'>=</span> <span class='ROC constant id'>ROC</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='tp identifier id'>tp</span><span class='comma token'>,</span> <span class='fp identifier id'>fp</span> <span class='assign token'>=</span> <span class='roc identifier id'>roc</span><span class='dot token'>.</span><span class='doublets_to_separate identifier id'>doublets_to_separate</span><span class='lparen token'>(</span><span class='doublets identifier id'>doublets</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='tp identifier id'>tp</span><span class='comma token'>,</span> <span class='fp identifier id'>fp</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>separate_by_prefix</h3>
</div><div id="separate_by_prefix-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>separate_by_prefix</span><span class='args'>(items, fp_prefix)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 392</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L392">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">392
393
394
395
396
397
398
399
400
401</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='separate_by_prefix identifier id'>separate_by_prefix</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='comma token'>,</span> <span class='fp_prefix identifier id'>fp_prefix</span><span class='rparen token'>)</span>
  <span class='its identifier id'>its</span> <span class='assign token'>=</span> <span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='items identifier id'>items</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='items identifier id'>items</span> <span class='eq op'>==</span> <span class='symbol val'>:prots</span>
  <span class='elsif elsif kw'>elsif</span> <span class='items identifier id'>items</span> <span class='eq op'>==</span> <span class='symbol val'>:peps</span>
    <span class='abort identifier id'>abort</span> <span class='string val'>&quot;not implemented yet&quot;</span>
  <span class='else else kw'>else</span>
    <span class='abort identifier id'>abort</span> <span class='string val'>&quot;no other items recognized yet&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>sorted_probabilities</h3>
</div><div id="sorted_probabilities-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>sorted_probabilities</span><span class='args'>(peptides)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a list of sorted probabilities given the array of peptides
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id.rb', line 522</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/12c04cb5d772ed265127dd94446ed8162423b373/lib/spec_id.rb#L522">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">522
523
524
525
526
527
528</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='sorted_probabilities identifier id'>sorted_probabilities</span><span class='lparen token'>(</span><span class='peptides identifier id'>peptides</span><span class='rparen token'>)</span>
  <span class='comment val'>#puts peptides.first.peptide_probability.class</span>
  <span class='comment val'>#peptides.each do |pep| print pep.class.to_s + &quot; &quot; end</span>
  <span class='comment val'>#puts peptides.first.is_a? Array</span>
  <span class='comment val'>#abort &quot;DFHDFD&quot;</span>
  <span class='peptides identifier id'>peptides</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='probability identifier id'>probability</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>