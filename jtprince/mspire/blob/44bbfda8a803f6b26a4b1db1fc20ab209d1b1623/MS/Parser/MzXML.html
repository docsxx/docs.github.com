<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>jtprince's mspire - Module: MS::Parser::MzXML - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/jtprince/commits/mspire/master" rel="alternate" title="Recent Commits to mspire:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("jtprince", "mspire", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("jtprince", "mspire", "44bbfda8a803f6b26a4b1db1fc20ab209d1b1623", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/jtprince/mspire/tree/">Source</a></li>
            <li class=""><a href="http://github.com/jtprince/mspire/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/jtprince/mspire/network">Network</a></li>            
            <li class=""><a href="http://github.com/jtprince/mspire/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/jtprince/mspire">Wiki</a></li>
            <li class=""><a href="http://github.com/jtprince/mspire/graphs">Graphs</a></li>                    
            <li class="active"><a href="/jtprince/mspire">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/jtprince">jtprince</a> / <b><a href="http://github.com/jtprince/mspire/tree">mspire</a></b>        
                <a id="namespaces_button" rel="jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module MS_Parser_MzXML">
  <h1>Module: MS::Parser::MzXML</h1>
  <div class="section mixins">
  <h2>Included Modules</h2>
  <p><a title="MS::Parser" href="../Parser.html">MS::Parser</a>, <a title="XMLStyleParser" href="MzXML/XMLStyleParser.html">XMLStyleParser</a></p>
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="Base_dir_for_parsers-constant">Base_dir_for_parsers</dt>
      <dd>'ms/parser/mzxml'</dd>
    
  </dl>
</div>

</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#fix_bad_scan_tags-class_method">fix_bad_scan_tags</span><span class='args'>(filename, newfilename = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
warning: clobbers file unless a newfilename is provided! returns the output
filename will fix any size file!.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#fix_bad_scan_tags_from_io-class_method">fix_bad_scan_tags_from_io</span><span class='args'>(io, out_io)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
this is a memory efficient method to fix bad scan tags prints cleaned up
file to out_io no effort is made to rewind the io objects, the user must do
this if they plan to continue using these objects!.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_bad_scan_tag-3F-class_method">has_bad_scan_tag?</span><span class='args'>(filename)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_bad_scan_tag_from_io-3F-class_method">has_bad_scan_tag_from_io?</span><span class='args'>(io)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
very efficient algorithm to check for malformed xml typical of readw
output.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_bad_scan_tag_from_string-3F-class_method">has_bad_scan_tag_from_string?</span><span class='args'>(string)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
returns a string with double &lt;/scan&gt;&lt;/scan&gt; tags into single
and missing &lt;/scan&gt; tags after peaks added in we do this in windows
style since these are generated off a windows machine only def self.
</p>

        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h2>Public Class Methods Included from <a title="MS::Parser" href="../Parser.html">MS::Parser</a></h2>
    <p><span class='name'><a title="filetype_and_version" href="../Parser.html#filetype_and_version-class_method">filetype_and_version</a></span>, <span class='name'><a title="require_and_create_parser" href="../Parser.html#require_and_create_parser-class_method">require_and_create_parser</a></span></p>
  </div>
  
  <div>
    <h2>Public Class Methods Included from <a title="XMLStyleParser" href="MzXML/XMLStyleParser.html">XMLStyleParser</a></h2>
    <p><span class='name'><a title="available_xml_parsers" href="../../XMLStyleParser.html#available_xml_parsers-class_method">available_xml_parsers</a></span>, <span class='name'><a title="choose_parser" href="../../XMLStyleParser.html#choose_parser-class_method">choose_parser</a></span>, <span class='name'><a title="require_parse_files" href="../../XMLStyleParser.html#require_parse_files-class_method">require_parse_files</a></span>, <span class='name'><a title="require_parsers" href="../../XMLStyleParser.html#require_parsers-class_method">require_parsers</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_el-instance_method">#_el</span><span class='args'>(name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#basic_info-instance_method">#basic_info</span><span class='args'>(mzxml_file)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a hash of basic info on an mzXML run:
</p>
<pre class="code">
  <span class='mult op'>*</span><span class='mzXML_elemt identifier id'>mzXML_elemt</span><span class='mult op'>*</span>   <span class='mult op'>*</span><span class='hash identifier id'>hash</span> <span class='keys identifier id'>keys</span> <span class='lparen token'>(</span><span class='symbols identifier id'>symbols</span><span class='rparen token'>)</span><span class='mult op'>*</span>
  <span class='scanCount identifier id'>scanCount</span>       <span class='scan_count identifier id'>scan_count</span>
  <span class='startTime identifier id'>startTime</span>       <span class='start_time identifier id'>start_time</span>
  <span class='endTime identifier id'>endTime</span>         <span class='end_time identifier id'>end_time</span>
  <span class='startMz identifier id'>startMz</span>         <span class='start_mz identifier id'>start_mz</span>
  <span class='endMz identifier id'>endMz</span>           <span class='end_mz identifier id'>end_mz</span><span class='dot token'>.</span>
</pre>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#precursor_mz_and_inten_by_scan-instance_method">#precursor_mz_and_inten_by_scan</span><span class='args'>(file)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns hash where hash[scan_num] = [precursorMz, precursorIntensity]
Parent scans are not hashed Keys and values are both strings.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#precursor_mz_by_scan_for_path-instance_method">#precursor_mz_by_scan_for_path</span><span class='args'>(path, extension, parse_type = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a Hash indexed by filename (with no extension) for a given path
extension = glob (string) or regex The basename is given as: file.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#precursor_mz_by_scan_num-instance_method">#precursor_mz_by_scan_num</span><span class='args'>(file)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns array where array[scan_num] = precursorMz precursorMz are Floats
Array index likely starts at 1!.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#scans_by_num-instance_method">#scans_by_num</span><span class='args'>(mzXML_file, parse_type = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array of scans indexed by scan number NOTE that the first scan
(zero indexed) will likely be nil! accepts an optional parse_type =
&#8216;xmlparser&#8217; | &#8216;rexml&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#start_and_end_mz-instance_method">#start_and_end_mz</span><span class='args'>(mzxml_file)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
returns [start_mz, end_mz] of the first full scan (ms_level == 1).
</p>

        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h2>Public Instance Methods Included from <a title="XMLStyleParser" href="MzXML/XMLStyleParser.html">XMLStyleParser</a></h2>
    <p><span class='name'><a title="parse" href="../../XMLStyleParser.html#parse-instance_method">parse</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>fix_bad_scan_tags</h3>
</div><div id="fix_bad_scan_tags-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>fix_bad_scan_tags</span><span class='args'>(filename, newfilename = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
warning: clobbers file unless a newfilename is provided! returns the output
filename will fix any size file!
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 15</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L15">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='fix_bad_scan_tags identifier id'>fix_bad_scan_tags</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='comma token'>,</span> <span class='newfilename identifier id'>newfilename</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>

  <span class='out_io identifier id'>out_io</span> <span class='assign token'>=</span> 
    <span class='if if kw'>if</span> <span class='newfilename identifier id'>newfilename</span>
      <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='newfilename identifier id'>newfilename</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='Tempfile constant id'>Tempfile</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='basename identifier id'>basename</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='fh identifier id'>fh</span><span class='bitor op'>|</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='fix_bad_scan_tags_from_io identifier id'>fix_bad_scan_tags_from_io</span><span class='lparen token'>(</span><span class='fh identifier id'>fh</span><span class='comma token'>,</span> <span class='out_io identifier id'>out_io</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='out_io identifier id'>out_io</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
  <span class='unless unless kw'>unless</span> <span class='newfilename identifier id'>newfilename</span>
    <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mv identifier id'>mv</span> <span class='out_io identifier id'>out_io</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='filename identifier id'>filename</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>fix_bad_scan_tags_from_io</h3>
</div><div id="fix_bad_scan_tags_from_io-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>fix_bad_scan_tags_from_io</span><span class='args'>(io, out_io)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
this is a memory efficient method to fix bad scan tags prints cleaned up
file to out_io no effort is made to rewind the io objects, the user must do
this if they plan to continue using these objects!
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 36</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L36">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='fix_bad_scan_tags_from_io identifier id'>fix_bad_scan_tags_from_io</span><span class='lparen token'>(</span><span class='io identifier id'>io</span><span class='comma token'>,</span> <span class='out_io identifier id'>out_io</span><span class='rparen token'>)</span>
  <span class='regexp identifier id'>regexp</span> <span class='assign token'>=</span> <span class='regexp val'>/&lt;\/scan&gt;/</span> 
  <span class='end_scan_line identifier id'>end_scan_line</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>

  <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lparen token'>(</span><span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='line identifier id'>line</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='end_scan_line identifier id'>end_scan_line</span> <span class='andop op'>&amp;&amp;</span> <span class='line identifier id'>line</span> <span class='match op'>=~</span> <span class='regexp identifier id'>regexp</span>
      <span class='comment val'># two end scan lines! # don't print to out_io</span>
      <span class='end_scan_line identifier id'>end_scan_line</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='line identifier id'>line</span> <span class='match op'>=~</span> <span class='regexp identifier id'>regexp</span>
      <span class='out_io identifier id'>out_io</span><span class='dot token'>.</span><span class='print identifier id'>print</span><span class='lparen token'>(</span><span class='line identifier id'>line</span><span class='rparen token'>)</span>
      <span class='end_scan_line identifier id'>end_scan_line</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
    <span class='else else kw'>else</span>
      <span class='out_io identifier id'>out_io</span><span class='dot token'>.</span><span class='print identifier id'>print</span><span class='lparen token'>(</span><span class='line identifier id'>line</span><span class='rparen token'>)</span>
      <span class='end_scan_line identifier id'>end_scan_line</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_bad_scan_tag?</h3>
</div><div id="has_bad_scan_tag-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_bad_scan_tag?</span><span class='args'>(filename)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 71</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L71">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">71
72
73
74
75</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='has_bad_scan_tag? fid id'>has_bad_scan_tag?</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='fh identifier id'>fh</span><span class='bitor op'>|</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='has_bad_scan_tag_from_io? fid id'>has_bad_scan_tag_from_io?</span><span class='lparen token'>(</span><span class='fh identifier id'>fh</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_bad_scan_tag_from_io?</h3>
</div><div id="has_bad_scan_tag_from_io-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_bad_scan_tag_from_io?</span><span class='args'>(io)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
very efficient algorithm to check for malformed xml typical of readw
output. The extra closing scan tags come after the last ms/ms scan in a
cycle rewinds the io after looking
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 80</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L80">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='has_bad_scan_tag_from_io? fid id'>has_bad_scan_tag_from_io?</span><span class='lparen token'>(</span><span class='io identifier id'>io</span><span class='rparen token'>)</span>
  <span class='seen_first_ms_level identifier id'>seen_first_ms_level</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='seen_higher_ms_level identifier id'>seen_higher_ms_level</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='cur_ms_level identifier id'>cur_ms_level</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='found_double_end_tag identifier id'>found_double_end_tag</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='found_end_tag identifier id'>found_end_tag</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lparen token'>(</span><span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='line identifier id'>line</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='line identifier id'>line</span> <span class='match op'>=~</span> <span class='regexp val'>/&lt;\/scan&gt;/</span>
      <span class='if if kw'>if</span> <span class='found_end_tag identifier id'>found_end_tag</span>  <span class='comment val'># already found one!</span>
        <span class='found_double_end_tag identifier id'>found_double_end_tag</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
        <span class='break break kw'>break</span>
      <span class='end end kw'>end</span>
      <span class='found_end_tag identifier id'>found_end_tag</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
    <span class='else else kw'>else</span>
      <span class='found_end_tag identifier id'>found_end_tag</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
    <span class='end end kw'>end</span>

    <span class='if if kw'>if</span> <span class='line identifier id'>line</span> <span class='match op'>=~</span> <span class='regexp val'>/msLevel=&quot;(\d+)&quot;/</span>
      <span class='cur_ms_level identifier id'>cur_ms_level</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
      <span class='if if kw'>if</span> <span class='seen_first_ms_level identifier id'>seen_first_ms_level</span> <span class='andop op'>&amp;&amp;</span> <span class='seen_higher_ms_level identifier id'>seen_higher_ms_level</span> <span class='andop op'>&amp;&amp;</span> <span class='cur_ms_level identifier id'>cur_ms_level</span> <span class='eq op'>==</span> <span class='string val'>'1'</span>
        <span class='break break kw'>break</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='cur_ms_level identifier id'>cur_ms_level</span> <span class='eq op'>==</span> <span class='string val'>'1'</span>
        <span class='seen_first_ms_level identifier id'>seen_first_ms_level</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
      <span class='elsif elsif kw'>elsif</span> <span class='cur_ms_level identifier id'>cur_ms_level</span> <span class='eq op'>==</span> <span class='string val'>'2'</span>
        <span class='seen_higher_ms_level identifier id'>seen_higher_ms_level</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='rewind identifier id'>rewind</span>
  <span class='found_double_end_tag identifier id'>found_double_end_tag</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_bad_scan_tag_from_string?</h3>
</div><div id="has_bad_scan_tag_from_string-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_bad_scan_tag_from_string?</span><span class='args'>(string)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
returns a string with double &lt;/scan&gt;&lt;/scan&gt; tags into single
and missing &lt;/scan&gt; tags after peaks added in we do this in windows
style since these are generated off a windows machine only def
self.fix_bad_scan_tags(string)
</p>
<pre class="code">
 <span class='string identifier id'>string</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/&lt;\/scan&gt;\s&lt;tt&gt;&lt;\/scan&gt;/</span><span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='string val'>'&lt;/scan&gt;'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/&lt;\/peaks&gt;\s&lt;/</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='lt op'>&lt;</span><span class='scan identifier id'>scan</span><span class='div op'>/</span><span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='string val'>&quot;&lt;/peaks&gt;\r\n  &lt;/scan&gt;\r\n  &lt;scan&quot;</span><span class='rparen token'>)</span>
</pre>
<p>
end returns true if it has the bad tag
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 63</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L63">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">63
64
65
66
67
68
69</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='has_bad_scan_tag_from_string? fid id'>has_bad_scan_tag_from_string?</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='string identifier id'>string</span><span class='dot token'>.</span><span class='match identifier id'>match</span><span class='lparen token'>(</span><span class='regexp val'>/&lt;\/scan&gt;\s+&lt;\/scan&gt;/</span><span class='m identifier id'>m</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='else else kw'>else</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>_el</h3>
</div><div id="_el-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_el</span><span class='args'>(name)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 268</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L268">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">268
269
270
271
272
273
274
275
276
277
278</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='re identifier id'>re</span> <span class='assign token'>=</span> <span class='dregexp node'>/#{name}=&quot;(.*)&quot;/</span>
  <span class='while while kw'>while</span> <span class='@line ivar id'>@line</span> <span class='nmatch op'>!~</span> <span class='re identifier id'>re</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='@fh ivar id'>@fh</span><span class='dot token'>.</span><span class='eof? fid id'>eof?</span>
    <span class='@line ivar id'>@line</span> <span class='assign token'>=</span> <span class='@fh ivar id'>@fh</span><span class='dot token'>.</span><span class='readline identifier id'>readline</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span>
    <span class='return return kw'>return</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='else else kw'>else</span>
    <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>basic_info</h3>
</div><div id="basic_info-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>basic_info</span><span class='args'>(mzxml_file)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a hash of basic info on an mzXML run:
</p>
<pre class="code">
  <span class='mult op'>*</span><span class='mzXML_elemt identifier id'>mzXML_elemt</span><span class='mult op'>*</span>   <span class='mult op'>*</span><span class='hash identifier id'>hash</span> <span class='keys identifier id'>keys</span> <span class='lparen token'>(</span><span class='symbols identifier id'>symbols</span><span class='rparen token'>)</span><span class='mult op'>*</span>
  <span class='scanCount identifier id'>scanCount</span>       <span class='scan_count identifier id'>scan_count</span>
  <span class='startTime identifier id'>startTime</span>       <span class='start_time identifier id'>start_time</span>
  <span class='endTime identifier id'>endTime</span>         <span class='end_time identifier id'>end_time</span>
  <span class='startMz identifier id'>startMz</span>         <span class='start_mz identifier id'>start_mz</span>
  <span class='endMz identifier id'>endMz</span>           <span class='end_mz identifier id'>end_mz</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 215</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L215">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='basic_info identifier id'>basic_info</span><span class='lparen token'>(</span><span class='mzxml_file identifier id'>mzxml_file</span><span class='rparen token'>)</span>
  <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;parsing: #{mzxml_file} #{File.exist?(mzxml_file)}&quot;</span> <span class='if if_mod kw'>if</span> <span class='$VERBOSE gvar id'>$VERBOSE</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='scan_count_tmp identifier id'>scan_count_tmp</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>5</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='n identifier id'>n</span><span class='bitor op'>|</span> <span class='scan_count_tmp identifier id'>scan_count_tmp</span><span class='lbrack token'>[</span><span class='n identifier id'>n</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='integer val'>0</span> <span class='end end kw'>end</span>
  <span class='@fh ivar id'>@fh</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='mzxml_file identifier id'>mzxml_file</span><span class='rparen token'>)</span>
  <span class='@line ivar id'>@line</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
  <span class='scan_count_tmp identifier id'>scan_count_tmp</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;scanCount&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='symbol val'>:start_time</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;startTime&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^PT/</span><span class='comma token'>,</span> <span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/S$/</span><span class='comma token'>,</span><span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
  <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='symbol val'>:end_time</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;endTime&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^PT/</span><span class='comma token'>,</span> <span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/S$/</span><span class='comma token'>,</span><span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
  <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='symbol val'>:ms_level</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;msLevel&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  <span class='scan_count_tmp identifier id'>scan_count_tmp</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='integer val'>1</span>
  <span class='if if kw'>if</span> <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='ms_level identifier id'>ms_level</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
    <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='symbol val'>:start_mz</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;startMz&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
    <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='symbol val'>:end_mz</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;endMz&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
  <span class='end end kw'>end</span>

  <span class='while while kw'>while</span> <span class='notop op'>!</span><span class='@fh ivar id'>@fh</span><span class='dot token'>.</span><span class='eof? fid id'>eof?</span>
    <span class='@line ivar id'>@line</span> <span class='assign token'>=</span> <span class='@fh ivar id'>@fh</span><span class='dot token'>.</span><span class='readline identifier id'>readline</span> 
    <span class='ms_level identifier id'>ms_level</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;msLevel&quot;</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='ms_level identifier id'>ms_level</span>
      <span class='scan_count_tmp identifier id'>scan_count_tmp</span><span class='lbrack token'>[</span><span class='ms_level identifier id'>ms_level</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
    <span class='else else kw'>else</span>
      <span class='break break kw'>break</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='scan_count identifier id'>scan_count</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='scan_count_tmp identifier id'>scan_count_tmp</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='cnt identifier id'>cnt</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='cnt identifier id'>cnt</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
      <span class='scan_count identifier id'>scan_count</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='cnt identifier id'>cnt</span>
    <span class='else else kw'>else</span>
      <span class='break break kw'>break</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='symbol val'>:scan_count</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='scan_count identifier id'>scan_count</span>
  <span class='@fh ivar id'>@fh</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
  <span class='hash identifier id'>hash</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>precursor_mz_and_inten_by_scan</h3>
</div><div id="precursor_mz_and_inten_by_scan-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>precursor_mz_and_inten_by_scan</span><span class='args'>(file)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns hash where hash[scan_num] = [precursorMz, precursorIntensity]
Parent scans are not hashed Keys and values are both strings
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 197</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L197">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">197
198
199</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='precursor_mz_and_inten_by_scan identifier id'>precursor_mz_and_inten_by_scan</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='comment val'># in progress</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>precursor_mz_by_scan_for_path</h3>
</div><div id="precursor_mz_by_scan_for_path-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>precursor_mz_by_scan_for_path</span><span class='args'>(path, extension, parse_type = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a Hash indexed by filename (with no extension) for a given path
extension = glob (string) or regex The basename is given as:
file.split(&#8217;.&#8217;).first
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 173</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L173">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='precursor_mz_by_scan_for_path identifier id'>precursor_mz_by_scan_for_path</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='extension identifier id'>extension</span><span class='comma token'>,</span> <span class='parse_type identifier id'>parse_type</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='Dir constant id'>Dir</span><span class='dot token'>.</span><span class='chdir identifier id'>chdir</span> <span class='path identifier id'>path</span> <span class='do do kw'>do</span>
    <span class='files identifier id'>files</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='if if kw'>if</span> <span class='extension identifier id'>extension</span><span class='dot token'>.</span><span class='class identifier id'>class</span> <span class='eq op'>==</span> <span class='String constant id'>String</span>
      <span class='files identifier id'>files</span> <span class='assign token'>=</span> <span class='Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='extension identifier id'>extension</span><span class='rbrack token'>]</span>
    <span class='elsif elsif kw'>elsif</span> <span class='extension identifier id'>extension</span><span class='dot token'>.</span><span class='class identifier id'>class</span> <span class='eq op'>==</span> <span class='Regexp constant id'>Regexp</span>
      <span class='files identifier id'>files</span> <span class='assign token'>=</span> <span class='Dir constant id'>Dir</span><span class='dot token'>.</span><span class='entries identifier id'>entries</span><span class='lparen token'>(</span><span class='string val'>&quot;.&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='find_all identifier id'>find_all</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='dir identifier id'>dir</span><span class='bitor op'>|</span>
        <span class='dir identifier id'>dir</span> <span class='match op'>=~</span> <span class='extension identifier id'>extension</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;extension: #{extension} not a String or Regexp!&quot;</span>
    <span class='end end kw'>end</span>
    <span class='files identifier id'>files</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='file identifier id'>file</span><span class='bitor op'>|</span>
      <span class='base identifier id'>base</span> <span class='assign token'>=</span> <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'.'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
      <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='base identifier id'>base</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='precursor_mz_by_scan identifier id'>precursor_mz_by_scan</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='comma token'>,</span> <span class='parse_type identifier id'>parse_type</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='hash identifier id'>hash</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>precursor_mz_by_scan_num</h3>
</div><div id="precursor_mz_by_scan_num-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>precursor_mz_by_scan_num</span><span class='args'>(file)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns array where array[scan_num] = precursorMz precursorMz are Floats
Array index likely starts at 1!
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 204</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L204">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">204
205
206</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='precursor_mz_by_scan_num identifier id'>precursor_mz_by_scan_num</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='comment val'>## THIS SHOULD BE CREATED IN specific XML LIBS</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>scans_by_num</h3>
</div><div id="scans_by_num-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>scans_by_num</span><span class='args'>(mzXML_file, parse_type = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array of scans indexed by scan number NOTE that the first scan
(zero indexed) will likely be nil! accepts an optional parse_type =
&#8216;xmlparser&#8217; | &#8216;rexml&#8217;
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 131</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L131">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='scans_by_num identifier id'>scans_by_num</span><span class='lparen token'>(</span><span class='mzXML_file identifier id'>mzXML_file</span><span class='comma token'>,</span> <span class='parse_type identifier id'>parse_type</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='parse_type identifier id'>parse_type</span>
    <span class='parse_type identifier id'>parse_type</span> <span class='assign token'>=</span> <span class='default_parser identifier id'>default_parser</span>
  <span class='end end kw'>end</span>
  <span class='scans identifier id'>scans</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='case case kw'>case</span> <span class='parse_type identifier id'>parse_type</span>
  <span class='when when kw'>when</span> <span class='string val'>'xmlparser'</span> 
    <span class='parser identifier id'>parser</span> <span class='assign token'>=</span> <span class='MS constant id'>MS</span><span class='colon2 op'>::</span><span class='MzXML constant id'>MzXML</span><span class='colon2 op'>::</span><span class='XMLParser constant id'>XMLParser</span><span class='colon2 op'>::</span><span class='TimeMzIntenIndexer constant id'>TimeMzIntenIndexer</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='IO constant id'>IO</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='mzXML_file identifier id'>mzXML_file</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='scans identifier id'>scans</span> <span class='assign token'>=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='scans_by_num identifier id'>scans_by_num</span>
  <span class='when when kw'>when</span> <span class='string val'>'rexml'</span> <span class='comment val'># use REXML</span>
    <span class='comment val'># This is really too slow for files of this size</span>
    <span class='doc identifier id'>doc</span> <span class='assign token'>=</span> <span class='REXML constant id'>REXML</span><span class='colon2 op'>::</span><span class='Document constant id'>Document</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='mzXML_file identifier id'>mzXML_file</span><span class='rparen token'>)</span>
    <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='elements identifier id'>elements</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lparen token'>(</span><span class='string val'>'msRun/scan'</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='scan identifier id'>scan</span><span class='bitor op'>|</span>
      <span class='rt identifier id'>rt</span> <span class='assign token'>=</span> <span class='scan identifier id'>scan</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>'retentionTime'</span><span class='rbrack token'>]</span>  <span class='comment val'>## like PT0.154000S&quot;</span>
      <span class='level identifier id'>level</span> <span class='assign token'>=</span> <span class='scan identifier id'>scan</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>'msLevel'</span><span class='rbrack token'>]</span>
      <span class='to_print identifier id'>to_print</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
      <span class='prec_mz identifier id'>prec_mz</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
      <span class='prec_int identifier id'>prec_int</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
      <span class='if if kw'>if</span> <span class='level identifier id'>level</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='neq op'>!=</span> <span class='integer val'>1</span>
        <span class='scan identifier id'>scan</span><span class='dot token'>.</span><span class='elements identifier id'>elements</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lparen token'>(</span><span class='string val'>&quot;precursorMz&quot;</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='prec identifier id'>prec</span><span class='bitor op'>|</span>
          <span class='prec_mz identifier id'>prec_mz</span> <span class='assign token'>=</span> <span class='prec identifier id'>prec</span><span class='dot token'>.</span><span class='text identifier id'>text</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
          <span class='prec_int identifier id'>prec_int</span> <span class='assign token'>=</span> <span class='prec identifier id'>prec</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>&quot;precursorIntensity&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='comment val'># remove the leading PT and trailing S on the retention time!</span>
      <span class='rt identifier id'>rt</span> <span class='assign token'>=</span> <span class='rt identifier id'>rt</span><span class='lbrack token'>[</span><span class='float val'>2</span><span class='dot3 op'>...</span><span class='integer val'>-1</span><span class='rbrack token'>]</span>

      <span class='num identifier id'>num</span> <span class='assign token'>=</span> <span class='scan identifier id'>scan</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>'num'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
      <span class='scans identifier id'>scans</span><span class='lbrack token'>[</span><span class='num identifier id'>num</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='MS constant id'>MS</span><span class='colon2 op'>::</span><span class='Scan constant id'>Scan</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='num identifier id'>num</span><span class='comma token'>,</span> <span class='scan identifier id'>scan</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>'msLevel'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='rt identifier id'>rt</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span><span class='comma token'>,</span> <span class='prec_mz identifier id'>prec_mz</span><span class='comma token'>,</span> <span class='prec_int identifier id'>prec_int</span><span class='rparen token'>)</span> 
    <span class='end end kw'>end</span> <span class='comment val'>#doc.elements</span>
  <span class='else else kw'>else</span>
    <span class='throw identifier id'>throw</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;invalid parse type: #{parse_type}&quot;</span>
  <span class='end end kw'>end</span>
  <span class='comment val'>## update the scans for parents</span>
  <span class='MS constant id'>MS</span><span class='colon2 op'>::</span><span class='Scan constant id'>Scan</span><span class='dot token'>.</span><span class='add_parent_scan identifier id'>add_parent_scan</span><span class='lparen token'>(</span><span class='scans identifier id'>scans</span><span class='rparen token'>)</span>
  <span class='scans identifier id'>scans</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>start_and_end_mz</h3>
</div><div id="start_and_end_mz-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>start_and_end_mz</span><span class='args'>(mzxml_file)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
returns [start_mz, end_mz] of the first full scan (ms_level == 1)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/ms/parser/mzxml.rb', line 255</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/44bbfda8a803f6b26a4b1db1fc20ab209d1b1623/lib/ms/parser/mzxml.rb#L255">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">255
256
257
258
259
260
261
262
263
264
265
266</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='start_and_end_mz identifier id'>start_and_end_mz</span><span class='lparen token'>(</span><span class='mzxml_file identifier id'>mzxml_file</span><span class='rparen token'>)</span>
  <span class='@fh ivar id'>@fh</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='mzxml_file identifier id'>mzxml_file</span><span class='rparen token'>)</span>
  <span class='ms_level identifier id'>ms_level</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@line ivar id'>@line</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
  <span class='while while kw'>while</span> <span class='ms_level identifier id'>ms_level</span> <span class='neq op'>!=</span> <span class='integer val'>1</span>
    <span class='ms_level identifier id'>ms_level</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;msLevel&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  <span class='end end kw'>end</span>
  <span class='start_mz identifier id'>start_mz</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;startMz&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
  <span class='end_mz identifier id'>end_mz</span> <span class='assign token'>=</span> <span class='_el identifier id'>_el</span><span class='lparen token'>(</span><span class='string val'>&quot;endMz&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span>
  <span class='@fh ivar id'>@fh</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
  <span class='lbrack token'>[</span><span class='start_mz identifier id'>start_mz</span><span class='comma token'>,</span> <span class='end_mz identifier id'>end_mz</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>