<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>jtprince's mspire - Class: SpecID::Precision::Filter::Peps - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/jtprince/commits/mspire/master" rel="alternate" title="Recent Commits to mspire:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("jtprince", "mspire", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='jtprince/mspire/blob/2872943029ed4d6ec73a4801cd11ecb0d3891b4b' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='jtprince/mspire/blob/2872943029ed4d6ec73a4801cd11ecb0d3891b4b' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("jtprince", "mspire", "2872943029ed4d6ec73a4801cd11ecb0d3891b4b", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/jtprince/mspire/tree/">Source</a></li>
            <li class=""><a href="http://github.com/jtprince/mspire/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/jtprince/mspire/network">Network</a></li>            
            <li class=""><a href="http://github.com/jtprince/mspire/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/jtprince/mspire">Wiki</a></li>
            <li class=""><a href="http://github.com/jtprince/mspire/graphs">Graphs</a></li>                    
            <li class="active"><a href="/jtprince/mspire">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/jtprince">jtprince</a> / <b><a href="http://github.com/jtprince/mspire/tree">mspire</a></b>        
                <a id="namespaces_button" rel="jtprince/mspire/blob/2872943029ed4d6ec73a4801cd11ecb0d3891b4b" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="jtprince/mspire/blob/2872943029ed4d6ec73a4801cd11ecb0d3891b4b" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class SpecID_Precision_Filter_Peps">
  <h1>Class: SpecID::Precision::Filter::Peps</h1>
  <div class="section inheritance">
  <ul>
  <li><a title="SpecID::Precision::Filter" href="../Filter.html">SpecID::Precision::Filter</a></li><ul><li>SpecID::Precision::Filter::Peps</li>
  </ul></ul>
</div><div class="section constants">
  <div class="inherited">
  
  <div>
    <h2>Constants Inherited from <a title="SpecID::Precision::Filter" href="../Filter.html">SpecID::Precision::Filter</a></h2>
    <p><span class='name'><a title="FV_DEFAULTS" href="../Filter.html#FV_DEFAULTS-constant">FV_DEFAULTS</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(meth = nil, *opts)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
can pass in the method to call. If you have static options and you will
reuse your filter, you can pass them in here. BEWARE: this will override
any passed into the method at filter time. If you need to do that, make a
new, blank filter and pass in your args at filter time
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id/precision/filter.rb', line 530</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/2872943029ed4d6ec73a4801cd11ecb0d3891b4b/lib/spec_id/precision/filter.rb#L530">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">530
531
532
533
534
535
536
537</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='meth identifier id'>meth</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
  <span class='@method ivar id'>@method</span> <span class='assign token'>=</span> <span class='meth identifier id'>meth</span>
  <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='@opts ivar id'>@opts</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span>
  <span class='else else kw'>else</span>
    <span class='@opts ivar id'>@opts</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#standard_sequest_filter-instance_method">#standard_sequest_filter</span><span class='args'>(peps, x1, x2, x3, deltacn, ppm, include_deltacnstar = true)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
returns self for chaining ( &gt;= +3 charge for the x3).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#top_hit-instance_method">#top_hit</span><span class='args'>(peps, opts = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
passes the top peptide hits per attributes that it is hashed by all hits
with same score as top score are returned assumes that all attributes are
cast properly: Float,Integer, etc converts xcorr, deltacn, deltamass, mass,
and charge into numerical types deletes the protein array (but not relevant
proteins) hashes on [pep.
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Instance Methods Inherited from <a title="SpecID::Precision::Filter" href="../Filter.html">SpecID::Precision::Filter</a></h2>
    <p><span class='name'><a title="filter_and_validate" href="../Filter.html#filter_and_validate-instance_method">filter_and_validate</a></span>, <span class='name'><a title="filter_and_validate_cmdline" href="../Filter.html#filter_and_validate_cmdline-instance_method">filter_and_validate_cmdline</a></span>, <span class='name'><a title="get_pephit_precision" href="../Filter.html#get_pephit_precision-instance_method">get_pephit_precision</a></span>, <span class='name'><a title="peptide_precision_to_protein_precision" href="../Filter.html#peptide_precision_to_protein_precision-instance_method">peptide_precision_to_protein_precision</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>standard_sequest_filter</h3>
</div><div id="standard_sequest_filter-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>standard_sequest_filter</span><span class='args'>(peps, x1, x2, x3, deltacn, ppm, include_deltacnstar = true)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
returns self for chaining ( &gt;= +3 charge for the x3)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id/precision/filter.rb', line 616</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/2872943029ed4d6ec73a4801cd11ecb0d3891b4b/lib/spec_id/precision/filter.rb#L616">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='standard_sequest_filter identifier id'>standard_sequest_filter</span><span class='lparen token'>(</span><span class='peps identifier id'>peps</span><span class='comma token'>,</span> <span class='x1 identifier id'>x1</span><span class='comma token'>,</span><span class='x2 identifier id'>x2</span><span class='comma token'>,</span><span class='x3 identifier id'>x3</span><span class='comma token'>,</span><span class='deltacn identifier id'>deltacn</span><span class='comma token'>,</span><span class='ppm identifier id'>ppm</span><span class='comma token'>,</span><span class='include_deltacnstar identifier id'>include_deltacnstar</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span>
    <span class='pep_deltacn identifier id'>pep_deltacn</span> <span class='assign token'>=</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='deltacn identifier id'>deltacn</span>
    <span class='pep_charge identifier id'>pep_charge</span> <span class='assign token'>=</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='charge identifier id'>charge</span>

    <span class='comment val'>## The outer parentheses are critical to getting the correct answer!</span>
    <span class='_passing identifier id'>_passing</span> <span class='assign token'>=</span> <span class='lparen token'>(</span> <span class='lparen token'>(</span><span class='pep_deltacn identifier id'>pep_deltacn</span> <span class='geq op'>&gt;=</span> <span class='deltacn identifier id'>deltacn</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='pep_charge identifier id'>pep_charge</span> <span class='eq op'>==</span> <span class='integer val'>1</span> <span class='andop op'>&amp;&amp;</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='xcorr identifier id'>xcorr</span> <span class='geq op'>&gt;=</span> <span class='x1 identifier id'>x1</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='lparen token'>(</span><span class='pep_charge identifier id'>pep_charge</span> <span class='eq op'>==</span> <span class='integer val'>2</span> <span class='andop op'>&amp;&amp;</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='xcorr identifier id'>xcorr</span> <span class='geq op'>&gt;=</span> <span class='x2 identifier id'>x2</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='lparen token'>(</span><span class='pep_charge identifier id'>pep_charge</span> <span class='geq op'>&gt;=</span> <span class='integer val'>3</span> <span class='andop op'>&amp;&amp;</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='xcorr identifier id'>xcorr</span> <span class='geq op'>&gt;=</span> <span class='x3 identifier id'>x3</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span> <span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='ppm identifier id'>ppm</span> <span class='leq op'>&lt;=</span> <span class='ppm identifier id'>ppm</span> <span class='rparen token'>)</span><span class='rparen token'>)</span>

    <span class='if if kw'>if</span> <span class='_passing identifier id'>_passing</span>
      <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='notop op'>!</span><span class='include_deltacnstar identifier id'>include_deltacnstar</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='pep_deltacn identifier id'>pep_deltacn</span> <span class='gt op'>&gt;</span> <span class='float val'>1.0</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='false false kw'>false</span>
      <span class='else else kw'>else</span>
        <span class='true true kw'>true</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='false false kw'>false</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>top_hit</h3>
</div><div id="top_hit-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>top_hit</span><span class='args'>(peps, opts = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
passes the top peptide hits per attributes that it is hashed by all hits
with same score as top score are returned assumes that all attributes are
cast properly: Float,Integer, etc converts xcorr, deltacn, deltamass, mass,
and charge into numerical types deletes the protein array (but not relevant
proteins) hashes on [pep.basename, pep.first_scan.to_i, pep.charge.to_i]
returns self for chaining opts
</p>
<pre class="code">
  <span class='symbol val'>:per</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Array constant id'>Array</span> <span class='of identifier id'>of</span> <span class='attributes identifier id'>attributes</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='g identifier id'>g</span><span class='dot token'>.</span> <span class='lbrack token'>[</span><span class='symbol val'>:first_scan</span><span class='comma token'>,</span> <span class='symbol val'>:charge</span><span class='rbrack token'>]</span>   <span class='comment val'># TODO: allow lambda</span>
  <span class='symbol val'>:by</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='an identifier id'>an</span> <span class='array identifier id'>array</span> <span class='for for kw'>for</span> <span class='sort_by_attributes identifier id'>sort_by_attributes</span>
          <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='g identifier id'>g</span><span class='dot token'>.</span> <span class='lbrack token'>[</span><span class='symbol val'>:xcorr</span><span class='comma token'>,</span> <span class='symbol val'>:deltacn</span><span class='comma token'>,</span> <span class='symbol val'>:ppm</span><span class='comma token'>,</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='geq op'>&gt;=</span><span class='bitand op'>&amp;</span><span class='gt identifier id'>gt</span><span class='semicolon token'>;</span> <span class='lbrack token'>[</span><span class='symbol val'>:xcorr</span><span class='comma token'>,</span> <span class='symbol val'>:deltacn</span><span class='rbrack token'>]</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;]
  :ties =&gt; *false | true | :as_array
            false -     one top hit is selected by random (by sorting)
            true  -     all ties are included in final answer
            :as_array - ties are included as an array
</span></pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/spec_id/precision/filter.rb', line 554</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jtprince/mspire/blob/2872943029ed4d6ec73a4801cd11ecb0d3891b4b/lib/spec_id/precision/filter.rb#L554">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='top_hit identifier id'>top_hit</span><span class='lparen token'>(</span><span class='peps identifier id'>peps</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='comment val'># get the top peptide by firstscan/charge (equivalent to .out files)</span>
  <span class='top_peps identifier id'>top_peps</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='comment val'>#hash = peps.hash_by(*(opts[:per]))</span>
  <span class='per_array identifier id'>per_array</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:per</span><span class='rbrack token'>]</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='peps identifier id'>peps</span><span class='dot token'>.</span><span class='hash_by identifier id'>hash_by</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='per_array identifier id'>per_array</span><span class='rparen token'>)</span>
  <span class='ties identifier id'>ties</span> <span class='assign token'>=</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:ties</span><span class='rbrack token'>]</span>
  <span class='if if kw'>if</span> <span class='ties identifier id'>ties</span> <span class='eq op'>==</span> <span class='colon op'>:</span><span class='as_array identifier id'>as_array</span>
    <span class='as_array identifier id'>as_array</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
  <span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='values identifier id'>values</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='best_to_worst identifier id'>best_to_worst</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='sort_by_attributes identifier id'>sort_by_attributes</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:by</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='ties identifier id'>ties</span>

      <span class='best_hit identifier id'>best_hit</span> <span class='assign token'>=</span> <span class='best_to_worst identifier id'>best_to_worst</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
      <span class='comment val'>## get the values that matter for the top hit </span>
      <span class='comment val'># here get the attributes we are considering</span>
      <span class='atts identifier id'>atts</span> <span class='assign token'>=</span>
        <span class='if if kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='by identifier id'>by</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='last identifier id'>last</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='Hash constant id'>Hash</span>
          <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:by</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='integer val'>-1</span><span class='rbrack token'>]</span>
        <span class='else else kw'>else</span>
          <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:by</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
        <span class='end end kw'>end</span>
      <span class='comment val'># find the best hits values</span>
      <span class='top_hit_vals identifier id'>top_hit_vals</span> <span class='assign token'>=</span> <span class='atts identifier id'>atts</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='att identifier id'>att</span><span class='bitor op'>|</span> 
        <span class='best_hit identifier id'>best_hit</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='att identifier id'>att</span><span class='rparen token'>)</span>        
      <span class='end end kw'>end</span>

      <span class='tying_peps identifier id'>tying_peps</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
      <span class='best_to_worst identifier id'>best_to_worst</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pep identifier id'>pep</span><span class='bitor op'>|</span>
        <span class='tie identifier id'>tie</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
        <span class='atts identifier id'>atts</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='att identifier id'>att</span><span class='comma token'>,</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
          <span class='unless unless kw'>unless</span> <span class='lparen token'>(</span><span class='pep identifier id'>pep</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='att identifier id'>att</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='top_hit_vals identifier id'>top_hit_vals</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
            <span class='tie identifier id'>tie</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
            <span class='break break kw'>break</span> 
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
        <span class='if if kw'>if</span> <span class='tie identifier id'>tie</span>
          <span class='tying_peps identifier id'>tying_peps</span> <span class='lshft op'>&lt;&lt;</span> <span class='pep identifier id'>pep</span>
        <span class='else else kw'>else</span>
          <span class='break break kw'>break</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='as_array identifier id'>as_array</span>
        <span class='if if kw'>if</span> <span class='tying_peps identifier id'>tying_peps</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
          <span class='top_peps identifier id'>top_peps</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span> <span class='mult op'>*</span><span class='tying_peps identifier id'>tying_peps</span> <span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
          <span class='top_peps identifier id'>top_peps</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span> <span class='tying_peps identifier id'>tying_peps</span> <span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
      <span class='else else kw'>else</span>
        <span class='top_peps identifier id'>top_peps</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span> <span class='mult op'>*</span><span class='tying_peps identifier id'>tying_peps</span> <span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='top_peps identifier id'>top_peps</span> <span class='lshft op'>&lt;&lt;</span> <span class='best_to_worst identifier id'>best_to_worst</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='top_peps identifier id'>top_peps</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>