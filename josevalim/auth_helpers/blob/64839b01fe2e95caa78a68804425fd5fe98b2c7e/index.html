<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>josevalim's auth_helpers - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/josevalim/commits/auth_helpers/master" rel="alternate" title="Recent Commits to auth_helpers:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("josevalim", "auth_helpers", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='josevalim/auth_helpers/blob/64839b01fe2e95caa78a68804425fd5fe98b2c7e' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='josevalim/auth_helpers/blob/64839b01fe2e95caa78a68804425fd5fe98b2c7e' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("josevalim", "auth_helpers", "64839b01fe2e95caa78a68804425fd5fe98b2c7e", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/josevalim/auth_helpers/tree/">Source</a></li>
            <li class=""><a href="http://github.com/josevalim/auth_helpers/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/josevalim/auth_helpers/network">Network</a></li>            
            <li class=""><a href="http://github.com/josevalim/auth_helpers/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/josevalim/auth_helpers">Wiki</a></li>
            <li class=""><a href="http://github.com/josevalim/auth_helpers/graphs">Graphs</a></li>                    
            <li class="active"><a href="/josevalim/auth_helpers">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/josevalim">josevalim</a> / <b><a href="http://github.com/josevalim/auth_helpers/tree">auth_helpers</a></b>        
                <a id="namespaces_button" rel="josevalim/auth_helpers/blob/64839b01fe2e95caa78a68804425fd5fe98b2c7e" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="josevalim/auth_helpers/blob/64839b01fe2e95caa78a68804425fd5fe98b2c7e" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <p>
AuthHelpers License: MIT Version: 0.3.0
</p>
<p>
You can also read this README in pretty html at the GitHub project Wiki
page:
</p>
<pre class="code">
  <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/wiki.github.com/</span><span class='josevalim identifier id'>josevalim</span><span class='div op'>/</span><span class='auth_helpers identifier id'>auth_helpers</span>
</pre>
<p>
Description
</p>
<hr size="9"></hr><p>
AuthHelpers is a collection of modules to improve your Authlogic models. It
mainly exposes some convenience methods to help on confirmation and
passwords management, it also deals automatically with associations and
notifications.
</p>
<p>
Authlogic also include some controllers to deal with the modules added. For
example, if you add Recoverable to your model, you can have all password
management for free, if you inherit from the Recoverable controller:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='AccountPasswordsController constant id'>AccountPasswordsController</span> <span class='lt op'>&lt;</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Controller constant id'>Controller</span><span class='symbol val'>:Recoverable</span>
  <span class='end end kw'>end</span>
</pre>
<p>
This functionality is powered by InheritedResources, which is available at:
</p>
<pre class="code">
  <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/github.com/</span><span class='josevalim identifier id'>josevalim</span><span class='div op'>/</span><span class='inherited_resources identifier id'>inherited_resources</span>
</pre>
<p>
Installation
</p>
<hr size="10"></hr><p>
Install AuthHelpers is very easy. It is stored in GitHub, so just run the
following:
</p>
<pre class="code">
   <span class='gem identifier id'>gem</span> <span class='sources identifier id'>sources</span> <span class='minus op'>-</span><span class='a identifier id'>a</span> <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/gems.github.com
   sudo gem install josevalim-auth_helpers
</span></pre>
<p>
If you want it as plugin, just do:
</p>
<pre class="code">
   <span class='script identifier id'>script</span><span class='div op'>/</span><span class='plugin identifier id'>plugin</span> <span class='install identifier id'>install</span> <span class='git identifier id'>git</span><span class='symbol val'>:/</span><span class='regexp val'>/github.com/</span><span class='josevalim identifier id'>josevalim</span><span class='div op'>/</span><span class='auth_helpers identifier id'>auth_helpers</span><span class='dot token'>.</span><span class='git identifier id'>git</span>
</pre>
<p>
Example app
</p>
<hr size="9"></hr><pre class="code">
  <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/github.com/</span><span class='josevalim identifier id'>josevalim</span><span class='div op'>/</span><span class='starter identifier id'>starter</span>
</pre>
<p>
Modules
</p>
<hr size="5"></hr><pre class="code">
  <span class='class class kw'>class</span> <span class='Account constant id'>Account</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='acts_as_authentic identifier id'>acts_as_authentic</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span>
      <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='validations_scope identifier id'>validations_scope</span> <span class='assign token'>=</span> <span class='symbol val'>:accountable_type</span>
      <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='require_password_confirmation identifier id'>require_password_confirmation</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
    <span class='end end kw'>end</span>

    <span class='include identifier id'>include</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span><span class='colon2 op'>::</span><span class='Associatable constant id'>Associatable</span>
    <span class='include identifier id'>include</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span><span class='colon2 op'>::</span><span class='Confirmable constant id'>Confirmable</span>
    <span class='include identifier id'>include</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span><span class='colon2 op'>::</span><span class='Recoverable constant id'>Recoverable</span>
    <span class='include identifier id'>include</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span><span class='colon2 op'>::</span><span class='Updatable constant id'>Updatable</span>
  <span class='end end kw'>end</span>
</pre>
<h2>Associatable</h2>
<p>
This module automatically creates a belongs_to association for the first
*_id in the table. This module exists because, whenever it&#8217;s
possible, I follow the pattern of having an account model and then all
accountable objects uses this model (it autodetects polymorphic
associations too).
</p>
<h2>Confirmable</h2>
<p>
Adds the confirmation handling. It sends an e-mail to the user on account
creation, and adds find_and_confirm,
find_and_resend_confirmation_instructions as class methods plus confirmed?
and confirm! as instance methods.
</p>
<p>
When used with Updatable, also sends an e-mail the user changes his e-mail
address.
</p>
<h2>Recoverable</h2>
<p>
Adds the reset password code handling. Adds
find_and_resend_confirmation_instructions and find_and_reset_password class
methods plus reset_password instance method.
</p>
<h2>Updatable</h2>
<p>
It adds email and password confirmations and hack into update_attributes to
ensure the another confirmation instruction is sent when the user changes
the e-mail.
</p>
<p>
Authlogic already supports password confirmation, but it&#8217;s coupled
with the validates_length_of :password_confirmation, which is unecessary.
So in order to use this module, is advisable to disable
require_password_confirmation from Authlogic.
</p>
<pre class="code">
  <span class='acts_as_authentic identifier id'>acts_as_authentic</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span>
    <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='require_password_confirmation identifier id'>require_password_confirmation</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Specs
</p>
<hr size="3"></hr><p>
All modules come with specs, that&#8217;s why the library does not have
tests per se. So if you want to test the Account model declared above, just
do:
</p>
<pre class="code">
  <span class='describe identifier id'>describe</span> <span class='Account constant id'>Account</span> <span class='do do kw'>do</span>
    <span class='include identifier id'>include</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Spec constant id'>Spec</span><span class='colon2 op'>::</span><span class='Associatable constant id'>Associatable</span>
    <span class='include identifier id'>include</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Spec constant id'>Spec</span><span class='colon2 op'>::</span><span class='Confirmable constant id'>Confirmable</span>
    <span class='include identifier id'>include</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Spec constant id'>Spec</span><span class='colon2 op'>::</span><span class='Recoverable constant id'>Recoverable</span>
    <span class='include identifier id'>include</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Spec constant id'>Spec</span><span class='colon2 op'>::</span><span class='Updatable constant id'>Updatable</span>

    <span class='before identifier id'>before</span><span class='lparen token'>(</span><span class='symbol val'>:each</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
      <span class='@valid_attributes ivar id'>@valid_attributes</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span>
        <span class='symbol val'>:email</span>                 <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;is.valid@email.com&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:email_confirmation</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;is.valid@email.com&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:password</span>              <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;abcdef&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:password_confirmation</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;abcdef&quot;</span>
      <span class='rbrace token'>}</span>
    <span class='end end kw'>end</span>

    <span class='it identifier id'>it</span> <span class='string val'>&quot;should create a new instance given valid attributes&quot;</span> <span class='do do kw'>do</span>
      <span class='Account constant id'>Account</span><span class='dot token'>.</span><span class='create! fid id'>create!</span><span class='lparen token'>(</span><span class='@valid_attributes ivar id'>@valid_attributes</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
The only requirement you have for the tests is to have a @valid_attributes
instance variable set with a hash of valid attributes.
</p>
<p>
Notifications
</p>
<hr size="10"></hr><p>
AuthHelpers also comes with default notification files. At some point you
will want to prettify your notification views, so you just need to do:
</p>
<pre class="code">
  <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Notifier constant id'>Notifier</span><span class='dot token'>.</span><span class='sender identifier id'>sender</span> <span class='assign token'>=</span> <span class='string val'>%(&quot;José Valim&quot; &lt;jose.valim@gmail.com&gt;)</span>
  <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Notifier constant id'>Notifier</span><span class='dot token'>.</span><span class='template_root identifier id'>template_root</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{RAILS_ROOT}/app/views&quot;</span>
</pre>
<p>
Then make a copy of the plugin views folder to your app/views and start to
work on them.
</p>
<p>
Notification has some basic specs which fail if you don&#8217;t include the
perishable token in your emails. Just put a file in
spec/models/auth_helpers/notifier.rb with the following contents:
</p>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='__FILE__ __file__ kw'>__FILE__</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>'/../../spec_helper'</span><span class='rparen token'>)</span>

  <span class='module module kw'>module</span> <span class='AuthHelpers constant id'>AuthHelpers</span>
    <span class='describe identifier id'>describe</span> <span class='Notifier constant id'>Notifier</span> <span class='do do kw'>do</span>
      <span class='include identifier id'>include</span> <span class='AuthHelpers constant id'>AuthHelpers</span><span class='colon2 op'>::</span><span class='Spec constant id'>Spec</span><span class='colon2 op'>::</span><span class='Notifier constant id'>Notifier</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
I18n
</p>
<hr size="2"></hr><p>
Those helpers rely on I18n. Assuming the account model below, you need to
configure the following messages:
</p>
<pre class="code">
  <span class='activerecord identifier id'>activerecord</span><span class='colon op'>:</span>
    <span class='errors identifier id'>errors</span><span class='colon op'>:</span>
      <span class='models identifier id'>models</span><span class='colon op'>:</span>
        <span class='account identifier id'>account</span><span class='colon op'>:</span>
          <span class='already_confirmed identifier id'>already_confirmed</span><span class='colon op'>:</span> <span class='was identifier id'>was</span> <span class='already identifier id'>already</span> <span class='confirmed identifier id'>confirmed</span>
          <span class='not_found identifier id'>not_found</span><span class='colon op'>:</span> <span class='could identifier id'>could</span> <span class='not not kw'>not</span> <span class='be identifier id'>be</span> <span class='found identifier id'>found</span><span class='dot token'>.</span> <span class='Are constant id'>Are</span> <span class='you identifier id'>you</span> <span class='sure identifier id'>sure</span> <span class='you identifier id'>you</span> <span class='gave identifier id'>gave</span> <span class='the identifier id'>the</span> <span class='right identifier id'>right</span> <span class='e identifier id'>e</span><span class='minus op'>-</span><span class='mail identifier id'>mail</span> <span class='address? fid id'>address?</span>
          <span class='perishable_token identifier id'>perishable_token</span><span class='colon op'>:</span>
            <span class='invalid_confirmation identifier id'>invalid_confirmation</span><span class='colon op'>:</span> <span class='is identifier id'>is</span> <span class='invalid identifier id'>invalid</span><span class='dot token'>.</span> <span class='Are constant id'>Are</span> <span class='you identifier id'>you</span> <span class='sure identifier id'>sure</span> <span class='you identifier id'>you</span> <span class='copied identifier id'>copied</span> <span class='the identifier id'>the</span> <span class='right identifier id'>right</span> <span class='link identifier id'>link</span> <span class='from identifier id'>from</span> <span class='your identifier id'>your</span> <span class='e identifier id'>e</span><span class='minus op'>-</span><span class='mail? fid id'>mail?</span>
            <span class='invalid_reset_password identifier id'>invalid_reset_password</span><span class='colon op'>:</span> <span class='is identifier id'>is</span> <span class='invalid identifier id'>invalid</span><span class='dot token'>.</span> <span class='Are constant id'>Are</span> <span class='you identifier id'>you</span> <span class='sure identifier id'>sure</span> <span class='you identifier id'>you</span> <span class='copied identifier id'>copied</span> <span class='the identifier id'>the</span> <span class='right identifier id'>right</span> <span class='link identifier id'>link</span> <span class='from identifier id'>from</span> <span class='your identifier id'>your</span> <span class='e identifier id'>e</span><span class='minus op'>-</span><span class='mail? fid id'>mail?</span>
</pre>
<p>
Need more?
</p>
<hr size="8"></hr><p>
Right now, this plugin contains the modules that I needed so far. If you
are building an invitation system on top of your authlogic models, you
could fork the project and add the Invitable module. Uou will never have to
write it again in your next projects and it shouldn&#8217;t be harder than
inheriting a few modules and few controllers.
</p>
<p>
Bugs and Feedback
</p>
<hr size="10"></hr><p>
If you discover any bugs, please send an e-mail to jose.valim@gmail.com
</p>
<p>
Copyright &#169; 2009 José Valim http://josevalim.blogspot.com/
</p>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>