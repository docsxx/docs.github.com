<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>dim's ruby-net-ldap - Class: Net::LDAP - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/dim/commits/ruby-net-ldap/master" rel="alternate" title="Recent Commits to ruby-net-ldap:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("dim", "ruby-net-ldap", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("dim", "ruby-net-ldap", "228de90192f74d1096653bb895f1f1bdd364b78f", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/dim/ruby-net-ldap/tree/">Source</a></li>
            <li class=""><a href="http://github.com/dim/ruby-net-ldap/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/dim/ruby-net-ldap/network">Network</a></li>            
            <li class=""><a href="http://github.com/dim/ruby-net-ldap/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/dim/ruby-net-ldap">Wiki</a></li>
            <li class=""><a href="http://github.com/dim/ruby-net-ldap/graphs">Graphs</a></li>                    
            <li class="active"><a href="/dim/ruby-net-ldap">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/dim">dim</a> / <b><a href="http://github.com/dim/ruby-net-ldap/tree">ruby-net-ldap</a></b>        
                <a id="namespaces_button" rel="dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Net_LDAP">
  <h1>Class: Net::LDAP</h1>
  <div class="section docstring">
  <h2>Net::LDAP</h2>
<p>
This library provides a pure-Ruby implementation of the LDAP client
protocol, per RFC-2251. It can be used to access any server which
implements the LDAP protocol.
</p>
<p>
Net::LDAP is intended to provide full LDAP functionality while hiding the
more arcane aspects the LDAP protocol itself, and thus presenting as
Ruby-like a programming interface as possible.
</p>
<h2>Quick-start for the Impatient</h2>
<h3>Quick Example of a user-authentication against an LDAP directory:</h3>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'rubygems'</span>
 <span class='require identifier id'>require</span> <span class='string val'>'net/ldap'</span>

 <span class='ldap identifier id'>ldap</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='your_server_ip_address identifier id'>your_server_ip_address</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='port identifier id'>port</span> <span class='assign token'>=</span> <span class='integer val'>389</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='auth identifier id'>auth</span> <span class='string val'>&quot;joe_user&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;opensesame&quot;</span>
 <span class='if if kw'>if</span> <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span>
   <span class='comment val'># authentication succeeded</span>
 <span class='else else kw'>else</span>
   <span class='comment val'># authentication failed</span>
 <span class='end end kw'>end</span>
</pre>
<h3>Quick Example of a search against an LDAP directory:</h3>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'rubygems'</span>
 <span class='require identifier id'>require</span> <span class='string val'>'net/ldap'</span>

 <span class='ldap identifier id'>ldap</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='server_ip_address identifier id'>server_ip_address</span><span class='comma token'>,</span>
      <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>389</span><span class='comma token'>,</span>
      <span class='symbol val'>:auth</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span>
            <span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:simple</span><span class='comma token'>,</span>
            <span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;cn=manager,dc=example,dc=com&quot;</span><span class='comma token'>,</span>
            <span class='symbol val'>:password</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;opensesame&quot;</span>
      <span class='rbrace token'>}</span>

 <span class='filter identifier id'>filter</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='colon2 op'>::</span><span class='Filter constant id'>Filter</span><span class='dot token'>.</span><span class='eq identifier id'>eq</span><span class='lparen token'>(</span> <span class='string val'>&quot;cn&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;George*&quot;</span> <span class='rparen token'>)</span>
 <span class='treebase identifier id'>treebase</span> <span class='assign token'>=</span> <span class='string val'>&quot;dc=example,dc=com&quot;</span>

 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span> <span class='symbol val'>:base</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='treebase identifier id'>treebase</span><span class='comma token'>,</span> <span class='symbol val'>:filter</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='filter identifier id'>filter</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
   <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;DN: #{entry.dn}&quot;</span>
   <span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='bitor op'>|</span>
     <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;   #{attribute}:&quot;</span>
     <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
       <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;      ---&gt;#{value}&quot;</span>
     <span class='end end kw'>end</span>
   <span class='end end kw'>end</span>
 <span class='end end kw'>end</span>

 <span class='p identifier id'>p</span> <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='get_operation_result identifier id'>get_operation_result</span>
</pre>
<h2>A Brief Introduction to LDAP</h2>
<p>
We&#8217;re going to provide a quick, informal introduction to LDAP
terminology and typical operations. If you&#8217;re comfortable with this
material, skip ahead to &quot;How to use Net::LDAP.&quot; If you want a
more rigorous treatment of this material, we recommend you start with the
various IETF and ITU standards that relate to LDAP.
</p>
<h3>Entities</h3>
<p>
LDAP is an Internet-standard protocol used to access directory servers. The
basic search unit is the <em>entity,</em> which corresponds to a person or
other domain-specific object. A directory service which supports the LDAP
protocol typically stores information about a number of entities.
</p>
<h3>Principals</h3>
<p>
LDAP servers are typically used to access information about people, but
also very often about such items as printers, computers, and other
resources. To reflect this, LDAP uses the term <em>entity,</em> or less
commonly, <em>principal,</em> to denote its basic data-storage unit.
</p>
<h3>Distinguished Names</h3>
<p>
In LDAP&#8217;s view of the world, an entity is uniquely identified by a
globally-unique text string called a <em>Distinguished Name,</em>
originally defined in the X.400 standards from which LDAP is ultimately
derived. Much like a DNS hostname, a DN is a &quot;flattened&quot; text
representation of a string of tree nodes. Also like DNS (and unlike Java
package names), a DN expresses a chain of tree-nodes written from left to
right in order from the most-resolved node to the most-general one.
</p>
<p>
If you know the DN of a person or other entity, then you can query an
LDAP-enabled directory for information (attributes) about the entity.
Alternatively, you can query the directory for a list of DNs matching a set
of criteria that you supply.
</p>
<h3>Attributes</h3>
<p>
In the LDAP view of the world, a DN uniquely identifies an entity.
Information about the entity is stored as a set of <em>Attributes.</em> An
attribute is a text string which is associated with zero or more values.
Most LDAP-enabled directories store a well-standardized range of
attributes, and constrain their values according to standard rules.
</p>
<p>
A good example of an attribute is <tt>sn,</tt> which stands for
&quot;Surname.&quot; This attribute is generally used to store a
person&#8217;s surname, or last name. Most directories enforce the standard
convention that an entity&#8217;s <tt>sn</tt> attribute have <em>exactly
one</em> value. In LDAP jargon, that means that <tt>sn</tt> must be
<em>present</em> and <em>single-valued.</em>
</p>
<p>
Another attribute is <tt>mail,</tt> which is used to store email addresses.
(No, there is no attribute called &quot;email,&quot; perhaps because X.400
terminology predates the invention of the term <em>email.</em>)
<tt>mail</tt> differs from <tt>sn</tt> in that most directories permit any
number of values for the <tt>mail</tt> attribute, including zero.
</p>
<h3>Tree-Base</h3>
<p>
We said above that X.400 Distinguished Names are <em>globally unique.</em>
In a manner reminiscent of DNS, LDAP supposes that each directory server
contains authoritative attribute data for a set of DNs corresponding to a
specific sub-tree of the (notional) global directory tree. This subtree is
generally configured into a directory server when it is created. It matters
for this discussion because most servers will not allow you to query them
unless you specify a correct tree-base.
</p>
<p>
Let&#8217;s say you work for the engineering department of Big Company,
Inc., whose internet domain is bigcompany.com. You may find that your
departmental directory is stored in a server with a defined tree-base of
</p>
<pre class="code">
 <span class='ou identifier id'>ou</span><span class='assign token'>=</span><span class='engineering identifier id'>engineering</span><span class='comma token'>,</span><span class='dc identifier id'>dc</span><span class='assign token'>=</span><span class='bigcompany identifier id'>bigcompany</span><span class='comma token'>,</span><span class='dc identifier id'>dc</span><span class='assign token'>=</span><span class='com identifier id'>com</span>
</pre>
<p>
You will need to supply this string as the <em>tree-base</em> when querying
this directory. (Ou is a very old X.400 term meaning &quot;organizational
unit.&quot; Dc is a more recent term meaning &quot;domain component.&quot;)
</p>
<h3>LDAP Versions</h3>
<p>
(stub, discuss v2 and v3)
</p>
<h3>LDAP Operations</h3>
<p>
The essential operations are: #bind, #search, #add, #modify, #delete, and
#rename.
</p>
<h4>Bind</h4>
<p>
#bind supplies a user&#8217;s authentication credentials to a server, which
in turn verifies or rejects them. There is a range of possibilities for
credentials, but most directories support a simple username and password
authentication.
</p>
<p>
Taken by itself, #bind can be used to authenticate a user against
information stored in a directory, for example to permit or deny access to
some other resource. In terms of the other LDAP operations, most
directories require a successful #bind to be performed before the other
operations will be permitted. Some servers permit certain operations to be
performed with an &quot;anonymous&quot; binding, meaning that no
credentials are presented by the user. (We&#8217;re glossing over a lot of
platform-specific detail here.)
</p>
<h4>Search</h4>
<p>
Calling #search against the directory involves specifying a treebase, a set
of <em>search filters,</em> and a list of attribute values. The filters
specify ranges of possible values for particular attributes. Multiple
filters can be joined together with AND, OR, and NOT operators. A server
will respond to a #search by returning a list of matching DNs together with
a set of attribute values for each entity, depending on what attributes the
search requested.
</p>
<h4>Add</h4>
<p>
#add specifies a new DN and an initial set of attribute values. If the
operation succeeds, a new entity with the corresponding DN and attributes
is added to the directory.
</p>
<h4>Modify</h4>
<p>
#modify specifies an entity DN, and a list of attribute operations. #modify
is used to change the attribute values stored in the directory for a
particular entity. #modify may add or delete attributes (which are lists of
values) or it change attributes by adding to or deleting from their values.
Net::LDAP provides three easier methods to modify an entry&#8217;s
attribute values: #add_attribute, #replace_attribute, and
#delete_attribute.
</p>
<h4>Delete</h4>
<p>
#delete specifies an entity DN. If it succeeds, the entity and all its
attributes is removed from the directory.
</p>
<h4>Rename (or Modify RDN)</h4>
<p>
#rename (or #modify_rdn) is an operation added to version 3 of the LDAP
protocol. It responds to the often-arising need to change the DN of an
entity without discarding its attribute values. In earlier LDAP versions,
the only way to do this was to delete the whole entity and add it again
with a different DN.
</p>
<p>
#rename works by taking an &quot;old&quot; DN (the one to change) and a
&quot;new RDN,&quot; which is the left-most part of the DN string. If
successful, #rename changes the entity DN so that its left-most node
corresponds to the new RDN given in the request. (RDN, or &quot;relative
distinguished name,&quot; denotes a single tree-node as expressed in a DN,
which is a chain of tree nodes.)
</p>
<h2>How to use Net::LDAP</h2>
<p>
To access Net::LDAP functionality in your Ruby programs, start by requiring
the library:
</p>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'net/ldap'</span>
</pre>
<p>
If you installed the Gem version of Net::LDAP, and depending on your
version of Ruby and rubygems, you <em>may</em> also need to require
rubygems explicitly:
</p>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'rubygems'</span>
 <span class='require identifier id'>require</span> <span class='string val'>'net/ldap'</span>
</pre>
<p>
Most operations with Net::LDAP start by instantiating a Net::LDAP object.
The constructor for this object takes arguments specifying the network
location (address and port) of the LDAP server, and also the binding
(authentication) credentials, typically a username and password. Given an
object of class Net:LDAP, you can then perform LDAP operations by calling
instance methods on the object. These are documented with usage examples
below.
</p>
<p>
The Net::LDAP library is designed to be very disciplined about how it makes
network connections to servers. This is different from many of the standard
native-code libraries that are provided on most platforms, which share
bloodlines with the original Netscape/Michigan LDAP client implementations.
These libraries sought to insulate user code from the workings of the
network. This is a good idea of course, but the practical effect has been
confusing and many difficult bugs have been caused by the opacity of the
native libraries, and their variable behavior across platforms.
</p>
<p>
In general, Net::LDAP instance methods which invoke server operations make
a connection to the server when the method is called. They execute the
operation (typically binding first) and then disconnect from the server.
The exception is Net::LDAP#open, which makes a connection to the server and
then keeps it open while it executes a user-supplied block. Net::LDAP#open
closes the connection on completion of the block.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">base</td>
          <td class="readwrite">
            [<span id='base-instance_method'>R</span><span id='base=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>base</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">host</td>
          <td class="readwrite">
            [<span id='host-instance_method'>R</span><span id='host=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>host</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">port</td>
          <td class="readwrite">
            [<span id='port-instance_method'>R</span><span id='port=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>port</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="AsnSyntax-constant">AsnSyntax</dt>
      <dd>BER.compile_syntax({
  :application =&gt; {
    :primitive =&gt; {
      2 =&gt; :null                # UnbindRequest body
    },
    :constructed =&gt; {
      0 =&gt; :array,              # BindRequest
      1 =&gt; :array,              # BindResponse
      2 =&gt; :array,              # UnbindRequest
      3 =&gt; :array,              # SearchRequest
      4 =&gt; :array,              # SearchData
      5 =&gt; :array,              # SearchResult
      6 =&gt; :array,              # ModifyRequest
      7 =&gt; :array,              # ModifyResponse
      8 =&gt; :array,              # AddRequest
      9 =&gt; :array,              # AddResponse
      10 =&gt; :array,             # DelRequest
      11 =&gt; :array,             # DelResponse
      12 =&gt; :array,             # ModifyRdnRequest
      13 =&gt; :array,             # ModifyRdnResponse
      14 =&gt; :array,             # CompareRequest
      15 =&gt; :array,             # CompareResponse
      16 =&gt; :array,             # AbandonRequest
      19 =&gt; :array,             # SearchResultReferral
      24 =&gt; :array,             # Unsolicited Notification
    }
  },
  :context_specific =&gt; {
    :primitive =&gt; {
      0 =&gt; :string,             # password
      1 =&gt; :string,             # Kerberos v4
      2 =&gt; :string,             # Kerberos v5
      7 =&gt; :string,             # serverSaslCreds
    },
    :constructed =&gt; {
      0 =&gt; :array,              # RFC-2251 Control and Filter-AND
      1 =&gt; :array,              # SearchFilter-OR
      2 =&gt; :array,              # SearchFilter-NOT
      3 =&gt; :array,              # Seach referral
      4 =&gt; :array,              # unknown use in Microsoft Outlook
      5 =&gt; :array,              # SearchFilter-GE
      6 =&gt; :array,              # SearchFilter-LE
      7 =&gt; :array,              # serverSaslCreds
    }
  }
})</dd>
    
      <dt id="DefaultAuth-constant">DefaultAuth</dt>
      <dd>{:method =&gt; :anonymous}</dd>
    
      <dt id="DefaultHost-constant">DefaultHost</dt>
      <dd>&quot;127.0.0.1&quot;</dd>
    
      <dt id="DefaultPort-constant">DefaultPort</dt>
      <dd>389</dd>
    
      <dt id="DefaultTreebase-constant">DefaultTreebase</dt>
      <dd>&quot;dc=com&quot;</dd>
    
      <dt id="ResultStrings-constant">ResultStrings</dt>
      <dd>{
  0 =&gt; &quot;Success&quot;,
  1 =&gt; &quot;Operations Error&quot;,
  2 =&gt; &quot;Protocol Error&quot;,
  3 =&gt; &quot;Time Limit Exceeded&quot;,
  4 =&gt; &quot;Size Limit Exceeded&quot;,
  12 =&gt; &quot;Unavailable crtical extension&quot;,
  14 =&gt; &quot;saslBindInProgress&quot;,
  16 =&gt; &quot;No Such Attribute&quot;,
  17 =&gt; &quot;Undefined Attribute Type&quot;,
  20 =&gt; &quot;Attribute or Value Exists&quot;,
  32 =&gt; &quot;No Such Object&quot;,
  34 =&gt; &quot;Invalid DN Syntax&quot;,
  48 =&gt; &quot;Inappropriate Authentication&quot;,
  49 =&gt; &quot;Invalid Credentials&quot;,
  50 =&gt; &quot;Insufficient Access Rights&quot;,
  51 =&gt; &quot;Busy&quot;,
  52 =&gt; &quot;Unavailable&quot;,
  53 =&gt; &quot;Unwilling to perform&quot;,
  65 =&gt; &quot;Object Class Violation&quot;,
  68 =&gt; &quot;Entry Already Exists&quot;
}</dd>
    
      <dt id="SearchScope_BaseObject-constant">SearchScope_BaseObject</dt>
      <dd>0</dd>
    
      <dt id="SearchScope_SingleLevel-constant">SearchScope_SingleLevel</dt>
      <dd>1</dd>
    
      <dt id="SearchScope_WholeSubtree-constant">SearchScope_WholeSubtree</dt>
      <dd>2</dd>
    
      <dt id="SearchScopes-constant">SearchScopes</dt>
      <dd>[SearchScope_BaseObject, SearchScope_SingleLevel, SearchScope_WholeSubtree]</dd>
    
      <dt id="StartTlsOid-constant">StartTlsOid</dt>
      <dd>&quot;1.3.6.1.4.1.1466.20037&quot;</dd>
    
      <dt id="VERSION-constant">VERSION</dt>
      <dd>&quot;0.1.0&quot;</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(args = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Instantiate an object of type Net::LDAP to perform directory operations.
This constructor takes a Hash containing arguments, all of which are either
optional or may be specified later with other methods as described below.
The following arguments are supported:
</p>
<ul>
<li>:host =&gt; the LDAP server&#8217;s IP-address (default 127.0.0.1)

</li>
<li>:port =&gt; the LDAP server&#8217;s TCP port (default 389)

</li>
<li>:auth =&gt; a Hash containing authorization parameters. Currently supported
values include: <tt>=&amp;gt; :anonymous</tt> and {:method =&gt; :simple,
:username =&gt; your_user_name, :password =&gt; your_password } The
password parameter may be a Proc that returns a String.

</li>
<li>:base =&gt; a default treebase parameter for searches performed against the
LDAP server. If you don&#8217;t give this value, then each call to #search
must specify a treebase parameter. If you do give this value, then it will
be used in subsequent calls to #search that do not specify a treebase. If
you give a treebase value in any particular call to #search, that value
will override any treebase value you give here.

</li>
<li>:encryption =&gt; specifies the encryption to be used in communicating with
the LDAP server. The value is either a Hash containing additional
parameters, or the Symbol :simple_tls, which is equivalent to specifying
the Hash <tt>=&amp;gt; :simple_tls</tt>. There is a fairly large range of
potential values that may be given for this parameter. See #encryption for
details.

</li>
</ul>
<p>
Instantiating a Net::LDAP object does <em>not</em> result in network
traffic to the LDAP server. It simply stores the connection and binding
parameters in the object.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 383</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L383">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span> <span class='args identifier id'>args</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@host ivar id'>@host</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:host</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='DefaultHost constant id'>DefaultHost</span>
  <span class='@port ivar id'>@port</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:port</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='DefaultPort constant id'>DefaultPort</span>
  <span class='@verbose ivar id'>@verbose</span> <span class='assign token'>=</span> <span class='false false kw'>false</span> <span class='comment val'># Make this configurable with a switch on the class.</span>
  <span class='@auth ivar id'>@auth</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:auth</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='DefaultAuth constant id'>DefaultAuth</span>
  <span class='@base ivar id'>@base</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:base</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='DefaultTreebase constant id'>DefaultTreebase</span>
  <span class='encryption identifier id'>encryption</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:encryption</span><span class='rbrack token'>]</span> <span class='comment val'># may be nil</span>

  <span class='if if kw'>if</span> <span class='pr identifier id'>pr</span> <span class='assign token'>=</span> <span class='@auth ivar id'>@auth</span><span class='lbrack token'>[</span><span class='symbol val'>:password</span><span class='rbrack token'>]</span> <span class='and and kw'>and</span> <span class='pr identifier id'>pr</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:call</span><span class='rparen token'>)</span>
    <span class='@auth ivar id'>@auth</span><span class='lbrack token'>[</span><span class='symbol val'>:password</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='pr identifier id'>pr</span><span class='dot token'>.</span><span class='call identifier id'>call</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># This variable is only set when we are created with LDAP::open.</span>
  <span class='comment val'># All of our internal methods will connect using it, or else</span>
  <span class='comment val'># they will create their own.</span>
  <span class='@open_connection ivar id'>@open_connection</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#open-class_method">open</span><span class='args'>(args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
#open takes the same parameters as #new.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#result2string-class_method">result2string</span><span class='args'>(code)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
LDAP::result2string.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#add-instance_method">#add</span><span class='args'>(args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Adds a new entry to the remote LDAP server.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#add_attribute-instance_method">#add_attribute</span><span class='args'>(dn, attribute, value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Add a value to an attribute.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#authenticate-instance_method">#authenticate</span><span class='args'>(username, password)</span>
        <span class='block'></span>
        
          <span class='alias'>#auth</span>
        
      </th>
      <td class="docstring">
        <p>
Convenience method to specify authentication credentials to the LDAP
server.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bind-instance_method">#bind</span><span class='args'>(auth = @auth)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
#bind connects to an LDAP server and requests authentication based on the
<tt>:auth</tt> parameter passed to #open or #new.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bind_as-instance_method">#bind_as</span><span class='args'>(args = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
#bind_as is for testing authentication credentials.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete-instance_method">#delete</span><span class='args'>(args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Delete an entry from the LDAP directory.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_attribute-instance_method">#delete_attribute</span><span class='args'>(dn, attribute)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Delete an attribute and all its values.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#encryption-instance_method">#encryption</span><span class='args'>(args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convenience method to specify encryption characteristics for connections to
LDAP servers.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_operation_result-instance_method">#get_operation_result</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a meaningful result any time after a protocol operation (#bind,
#search, #add, #modify, #rename, #delete) has completed.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#modify-instance_method">#modify</span><span class='args'>(args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Modifies the attribute values of a particular entry on the LDAP directory.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#modify_rdn-instance_method">#modify_rdn</span><span class='args'>(args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
modify_rdn is an alias for #rename.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#open-instance_method">#open</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Opens a network connection to the server and then passes <tt>self</tt> to
the caller-supplied block.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#paged_searches_supported-3F-instance_method">#paged_searches_supported?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
&#8212; Convenience method to query server capabilities.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#rename-instance_method">#rename</span><span class='args'>(args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Rename an entry on the remote DIS by changing the last RDN of its DN.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#replace_attribute-instance_method">#replace_attribute</span><span class='args'>(dn, attribute, value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Replace the value of an attribute.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#search-instance_method">#search</span><span class='args'>(args = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Searches the LDAP directory for directory entries.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#search_root_dse-instance_method">#search_root_dse</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
(Experimental, subject to change).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#search_subschema_entry-instance_method">#search_subschema_entry</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Return the root Subschema record from the LDAP server as a
Net::LDAP::Entry, or an empty Entry if the server doesn&#8217;t return the
record.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>open</h3>
</div><div id="open-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>open</span><span class='args'>(args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
#open takes the same parameters as #new. #open makes a network connection
to the LDAP server and then passes a newly-created Net::LDAP object to the
caller-supplied block. Within the block, you can call any of the instance
methods of Net::LDAP to perform operations against the LDAP directory.
#open will perform all the operations in the user-supplied block on the
same network connection, which will be closed automatically when the block
finishes.
</p>
<pre class="code">
 <span class='comment val'># (PSEUDOCODE)</span>
 <span class='auth identifier id'>auth</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:simple</span><span class='comma token'>,</span> <span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='username identifier id'>username</span><span class='comma token'>,</span> <span class='symbol val'>:password</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='password identifier id'>password</span><span class='rbrace token'>}</span>
 <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ipaddress identifier id'>ipaddress</span><span class='comma token'>,</span> <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>389</span><span class='comma token'>,</span> <span class='symbol val'>:auth</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='auth identifier id'>auth</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='ldap identifier id'>ldap</span><span class='bitor op'>|</span>
   <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span> <span class='dot3 op'>...</span> <span class='rparen token'>)</span>
   <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span> <span class='dot3 op'>...</span> <span class='rparen token'>)</span>
   <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='modify identifier id'>modify</span><span class='lparen token'>(</span> <span class='dot3 op'>...</span> <span class='rparen token'>)</span>
 <span class='end end kw'>end</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 501</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L501">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">501
502
503
504</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='LDAP constant id'>LDAP</span><span class='colon2 op'>::</span><span class='open identifier id'>open</span> <span class='args identifier id'>args</span>
  <span class='ldap1 identifier id'>ldap1</span> <span class='assign token'>=</span> <span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='args identifier id'>args</span>
  <span class='ldap1 identifier id'>ldap1</span><span class='dot token'>.</span><span class='open identifier id'>open</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='ldap identifier id'>ldap</span><span class='bitor op'>|</span> <span class='yield yield kw'>yield</span> <span class='ldap identifier id'>ldap</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>result2string</h3>
</div><div id="result2string-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>result2string</span><span class='args'>(code)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
LDAP::result2string
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 359</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L359">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">359
360
361</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='LDAP constant id'>LDAP</span><span class='colon2 op'>::</span><span class='result2string identifier id'>result2string</span> <span class='code identifier id'>code</span> 
  <span class='ResultStrings constant id'>ResultStrings</span><span class='lbrack token'>[</span><span class='code identifier id'>code</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='dstring node'>&quot;unknown result (#{code})&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>add</h3>
</div><div id="add-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add</span><span class='args'>(args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Adds a new entry to the remote LDAP server. Supported arguments:
</p>
<table>
<tr><td valign="top">:dn :</td><td>Full DN of the new entry

</td></tr>
<tr><td valign="top">:attributes :</td><td>Attributes of the new entry.

</td></tr>
</table>
<p>
The attributes argument is supplied as a Hash keyed by Strings or Symbols
giving the attribute name, and mapping to Strings or Arrays of Strings
giving the actual attribute values. Observe that most LDAP directories
enforce schema constraints on the attributes contained in entries. #add
will fail with a server-generated error if your attributes violate the
server-specific constraints. Here&#8217;s an example:
</p>
<pre class="code">
 <span class='dn identifier id'>dn</span> <span class='assign token'>=</span> <span class='string val'>&quot;cn=George Smith,ou=people,dc=example,dc=com&quot;</span>
 <span class='attr identifier id'>attr</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span>
   <span class='symbol val'>:cn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;George Smith&quot;</span><span class='comma token'>,</span>
   <span class='symbol val'>:objectclass</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;top&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;inetorgperson&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='symbol val'>:sn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Smith&quot;</span><span class='comma token'>,</span>
   <span class='symbol val'>:mail</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;gsmith@example.com&quot;</span>
 <span class='rbrace token'>}</span>
 <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='open identifier id'>open</span> <span class='lparen token'>(</span><span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='host identifier id'>host</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='ldap identifier id'>ldap</span><span class='bitor op'>|</span>
   <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span> <span class='symbol val'>:dn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='symbol val'>:attributes</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attr identifier id'>attr</span> <span class='rparen token'>)</span>
 <span class='end end kw'>end</span>
</pre>
<p>
&#8212; Provisional modification: Connection#add returns a full hash with
LDAP status values, instead of the simple result number we&#8217;re used to
getting.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 850</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L850">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='add identifier id'>add</span> <span class='args identifier id'>args</span>
  <span class='if if kw'>if</span> <span class='@open_connection ivar id'>@open_connection</span>
      <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='@open_connection ivar id'>@open_connection</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='begin begin kw'>begin</span>
      <span class='conn identifier id'>conn</span> <span class='assign token'>=</span> <span class='Connection constant id'>Connection</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@host ivar id'>@host</span><span class='comma token'>,</span> <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@port ivar id'>@port</span><span class='comma token'>,</span> <span class='symbol val'>:encryption</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@encryption ivar id'>@encryption</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:auth</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='@auth ivar id'>@auth</span> <span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
        <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='ensure ensure kw'>ensure</span>
      <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='close identifier id'>close</span> <span class='if if_mod kw'>if</span> <span class='conn identifier id'>conn</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='@result ivar id'>@result</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>add_attribute</h3>
</div><div id="add_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_attribute</span><span class='args'>(dn, attribute, value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Add a value to an attribute. Takes the full DN of the entry to modify, the
name (Symbol or String) of the attribute, and the value (String or Array).
If the attribute does not exist (and there are no schema violations),
#add_attribute will create it with the caller-specified values. If the
attribute already exists (and there are no schema violations), the
caller-specified values will be <em>added</em> to the values already
present.
</p>
<p>
Returns True or False to indicate whether the operation succeeded or
failed, with extended information available by calling
#get_operation_result. See also #replace_attribute and #delete_attribute.
</p>
<pre class="code">
 <span class='dn identifier id'>dn</span> <span class='assign token'>=</span> <span class='string val'>&quot;cn=modifyme,dc=example,dc=com&quot;</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='add_attribute identifier id'>add_attribute</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='symbol val'>:mail</span><span class='comma token'>,</span> <span class='string val'>&quot;newmailaddress@example.com&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 981</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L981">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">981
982
983</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='add_attribute identifier id'>add_attribute</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='value identifier id'>value</span>
  <span class='modify identifier id'>modify</span> <span class='symbol val'>:dn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='symbol val'>:operations</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='symbol val'>:add</span><span class='comma token'>,</span> <span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>authenticate</h3>
</div><div id="authenticate-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>authenticate</span><span class='args'>(username, password)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="auth-instance_method">auth</tt>
  
</p>
</div><div class="section docstring">
  <p>
Convenience method to specify authentication credentials to the LDAP
server. Currently supports simple authentication requiring a username and
password.
</p>
<p>
Observe that on most LDAP servers, the username is a complete DN. However,
with A/D, it&#8217;s often possible to give only a user-name rather than a
complete DN. In the latter case, beware that many A/D servers are
configured to permit anonymous (uncredentialled) binding, and will silently
accept your binding as anonymous if you give an unrecognized username. This
is not usually what you want. (See #get_operation_result.)
</p>
<p>
<b>Important:</b> The password argument may be a Proc that returns a
string. This makes it possible for you to write client programs that
solicit passwords from users or from other data sources without showing
them in your code or on command lines.
</p>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'net/ldap'</span>

 <span class='ldap identifier id'>ldap</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='server_ip_address identifier id'>server_ip_address</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='authenticate identifier id'>authenticate</span> <span class='string val'>&quot;cn=Your Username,cn=Users,dc=example,dc=com&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;your_psw&quot;</span>
</pre>
<p>
Alternatively (with a password block):
</p>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'net/ldap'</span>

 <span class='ldap identifier id'>ldap</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='server_ip_address identifier id'>server_ip_address</span>
 <span class='psw identifier id'>psw</span> <span class='assign token'>=</span> <span class='proc identifier id'>proc</span> <span class='lbrace token'>{</span> <span class='your_psw_function identifier id'>your_psw_function</span> <span class='rbrace token'>}</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='authenticate identifier id'>authenticate</span> <span class='string val'>&quot;cn=Your Username,cn=Users,dc=example,dc=com&quot;</span><span class='comma token'>,</span> <span class='psw identifier id'>psw</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 433</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L433">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">433
434
435
436</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='authenticate identifier id'>authenticate</span> <span class='username identifier id'>username</span><span class='comma token'>,</span> <span class='password identifier id'>password</span>
  <span class='password identifier id'>password</span> <span class='assign token'>=</span> <span class='password identifier id'>password</span><span class='dot token'>.</span><span class='call identifier id'>call</span> <span class='if if_mod kw'>if</span> <span class='password identifier id'>password</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:call</span><span class='rparen token'>)</span>
  <span class='@auth ivar id'>@auth</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:simple</span><span class='comma token'>,</span> <span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='username identifier id'>username</span><span class='comma token'>,</span> <span class='symbol val'>:password</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='password identifier id'>password</span><span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>bind</h3>
</div><div id="bind-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bind</span><span class='args'>(auth = @auth)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
#bind connects to an LDAP server and requests authentication based on the
<tt>:auth</tt> parameter passed to #open or #new. It takes no parameters.
</p>
<p>
User code does not need to call #bind directly. It will be called
implicitly by the library whenever you invoke an LDAP operation, such as
#search or #add.
</p>
<p>
It is useful, however, to call #bind in your own code when the only
operation you intend to perform against the directory is to validate a
login credential. #bind returns true or false to indicate whether the
binding was successful. Reasons for failure include malformed or
unrecognized usernames and incorrect passwords. Use #get_operation_result
to find out what happened in case of failure.
</p>
<p>
Here&#8217;s a typical example using #bind to authenticate a credential
which was (perhaps) solicited from the user of a web site:
</p>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'net/ldap'</span>
 <span class='ldap identifier id'>ldap</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='your_server_ip_address identifier id'>your_server_ip_address</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='port identifier id'>port</span> <span class='assign token'>=</span> <span class='integer val'>389</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='auth identifier id'>auth</span> <span class='your_user_name identifier id'>your_user_name</span><span class='comma token'>,</span> <span class='your_user_password identifier id'>your_user_password</span>
 <span class='if if kw'>if</span> <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span>
   <span class='comment val'># authentication succeeded</span>
 <span class='else else kw'>else</span>
   <span class='comment val'># authentication failed</span>
   <span class='p identifier id'>p</span> <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='get_operation_result identifier id'>get_operation_result</span>
 <span class='end end kw'>end</span>
</pre>
<p>
Here&#8217;s a more succinct example which does exactly the same thing, but
collects all the required parameters into arguments:
</p>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'net/ldap'</span>
 <span class='ldap identifier id'>ldap</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:host=</span><span class='gt op'>&gt;</span><span class='your_server_ip_address identifier id'>your_server_ip_address</span><span class='comma token'>,</span> <span class='symbol val'>:port=</span><span class='gt op'>&gt;</span><span class='integer val'>389</span> <span class='rparen token'>)</span>
 <span class='if if kw'>if</span> <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span><span class='lparen token'>(</span> <span class='symbol val'>:method=</span><span class='gt op'>&gt;</span><span class='symbol val'>:simple</span><span class='comma token'>,</span> <span class='symbol val'>:username=</span><span class='gt op'>&gt;</span><span class='your_user_name identifier id'>your_user_name</span><span class='comma token'>,</span> <span class='symbol val'>:password=</span><span class='gt op'>&gt;</span><span class='your_user_password identifier id'>your_user_password</span> <span class='rparen token'>)</span>
   <span class='comment val'># authentication succeeded</span>
 <span class='else else kw'>else</span>
   <span class='comment val'># authentication failed</span>
   <span class='p identifier id'>p</span> <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='get_operation_result identifier id'>get_operation_result</span>
 <span class='end end kw'>end</span>
</pre>
<p>
You don&#8217;t need to pass a user-password as a String object to bind.
You can also pass a Ruby Proc object which returns a string. This will
cause bind to execute the Proc (which might then solicit input from a user
with console display suppressed). The String value returned from the Proc
is used as the password.
</p>
<p>
You don&#8217;t have to create a new instance of Net::LDAP every time you
perform a binding in this way. If you prefer, you can cache the Net::LDAP
object and re-use it to perform subsequent bindings, <em>provided</em> you
call #auth to specify a new credential before calling #bind. Otherwise,
you&#8217;ll just re-authenticate the previous user! (You don&#8217;t need
to re-set the values of #host and #port.) As noted in the documentation for
#auth, the password parameter can be a Ruby Proc instead of a String.
</p>
<p>
&#8212; If there is an @open_connection, then perform the bind on it.
Otherwise, connect, bind, and disconnect. The latter operation is obviously
useful only as an auth check.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 747</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L747">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">747
748
749
750
751
752
753
754
755
756
757
758
759
760</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='bind identifier id'>bind</span> <span class='auth identifier id'>auth</span><span class='assign token'>=</span><span class='@auth ivar id'>@auth</span>
  <span class='if if kw'>if</span> <span class='@open_connection ivar id'>@open_connection</span>
    <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='@open_connection ivar id'>@open_connection</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span> <span class='auth identifier id'>auth</span>
  <span class='else else kw'>else</span>
    <span class='begin begin kw'>begin</span>
      <span class='conn identifier id'>conn</span> <span class='assign token'>=</span> <span class='Connection constant id'>Connection</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@host ivar id'>@host</span><span class='comma token'>,</span> <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@port ivar id'>@port</span> <span class='comma token'>,</span> <span class='symbol val'>:encryption</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@encryption ivar id'>@encryption</span><span class='rparen token'>)</span>
      <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span> <span class='auth identifier id'>auth</span>
    <span class='ensure ensure kw'>ensure</span>
      <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='close identifier id'>close</span> <span class='if if_mod kw'>if</span> <span class='conn identifier id'>conn</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='@result ivar id'>@result</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>bind_as</h3>
</div><div id="bind_as-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bind_as</span><span class='args'>(args = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
#bind_as is for testing authentication credentials.
</p>
<p>
As described under #bind, most LDAP servers require that you supply a
complete DN as a binding-credential, along with an authenticator such as a
password. But for many applications (such as authenticating users to a
Rails application), you often don&#8217;t have a full DN to identify the
user. You usually get a simple identifier like a username or an email
address, along with a password. #bind_as allows you to authenticate these
user-identifiers.
</p>
<p>
#bind_as is a combination of a search and an LDAP binding. First, it
connects and binds to the directory as normal. Then it searches the
directory for an entry corresponding to the email address, username, or
other string that you supply. If the entry exists, then #bind_as will
<b>re-bind</b> as that user with the password (or other authenticator) that
you supply.
</p>
<p>
#bind_as takes the same parameters as #search, <em>with the addition of an
authenticator.</em> Currently, this authenticator must be
<tt>:password</tt>. Its value may be either a String, or a <tt>proc</tt>
that returns a String. #bind_as returns <tt>false</tt> on failure. On
success, it returns a result set, just as #search does. This result set is
an Array of objects of type Net::LDAP::Entry. It contains the directory
attributes corresponding to the user. (Just test whether the return value
is logically true, if you don&#8217;t need this additional information.)
</p>
<p>
Here&#8217;s how you would use #bind_as to authenticate an email address
and password:
</p>
<pre class="code">
 <span class='require identifier id'>require</span> <span class='string val'>'net/ldap'</span>

 <span class='user identifier id'>user</span><span class='comma token'>,</span><span class='psw identifier id'>psw</span> <span class='assign token'>=</span> <span class='string val'>&quot;joe_user@yourcompany.com&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;joes_psw&quot;</span>

 <span class='ldap identifier id'>ldap</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='string val'>&quot;192.168.0.100&quot;</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='port identifier id'>port</span> <span class='assign token'>=</span> <span class='integer val'>389</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='auth identifier id'>auth</span> <span class='string val'>&quot;cn=manager,dc=yourcompany,dc=com&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;topsecret&quot;</span>

 <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='bind_as identifier id'>bind_as</span><span class='lparen token'>(</span>
   <span class='symbol val'>:base</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;dc=yourcompany,dc=com&quot;</span><span class='comma token'>,</span>
   <span class='symbol val'>:filter</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dstring node'>&quot;(mail=#{user})&quot;</span><span class='comma token'>,</span>
   <span class='symbol val'>:password</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='psw identifier id'>psw</span>
 <span class='rparen token'>)</span>
 <span class='if if kw'>if</span> <span class='result identifier id'>result</span>
   <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;Authenticated #{result.first.dn}&quot;</span>
 <span class='else else kw'>else</span>
   <span class='puts identifier id'>puts</span> <span class='string val'>&quot;Authentication FAILED.&quot;</span>
 <span class='end end kw'>end</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 809</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L809">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">809
810
811
812
813
814
815
816
817
818
819
820</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='bind_as identifier id'>bind_as</span> <span class='args identifier id'>args</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='open identifier id'>open</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='me identifier id'>me</span><span class='bitor op'>|</span>
    <span class='rs identifier id'>rs</span> <span class='assign token'>=</span> <span class='search identifier id'>search</span> <span class='args identifier id'>args</span>
    <span class='if if kw'>if</span> <span class='rs identifier id'>rs</span> <span class='and and kw'>and</span> <span class='rs identifier id'>rs</span><span class='dot token'>.</span><span class='first identifier id'>first</span> <span class='and and kw'>and</span> <span class='dn identifier id'>dn</span> <span class='assign token'>=</span> <span class='rs identifier id'>rs</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='dot token'>.</span><span class='dn identifier id'>dn</span>
      <span class='password identifier id'>password</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:password</span><span class='rbrack token'>]</span>
      <span class='password identifier id'>password</span> <span class='assign token'>=</span> <span class='password identifier id'>password</span><span class='dot token'>.</span><span class='call identifier id'>call</span> <span class='if if_mod kw'>if</span> <span class='password identifier id'>password</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:call</span><span class='rparen token'>)</span>
      <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='rs identifier id'>rs</span> <span class='if if_mod kw'>if</span> <span class='bind identifier id'>bind</span> <span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:simple</span><span class='comma token'>,</span> <span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='symbol val'>:password</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='password identifier id'>password</span>
    <span class='end end kw'>end</span>
  <span class='rbrace token'>}</span>
  <span class='result identifier id'>result</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete</h3>
</div><div id="delete-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete</span><span class='args'>(args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Delete an entry from the LDAP directory. Takes a hash of arguments. The
only supported argument is :dn, which must give the complete DN of the
entry to be deleted. Returns True or False to indicate whether the delete
succeeded. Extended status information is available by calling
#get_operation_result.
</p>
<pre class="code">
 <span class='dn identifier id'>dn</span> <span class='assign token'>=</span> <span class='string val'>&quot;mail=deleteme@example.com,ou=people,dc=example,dc=com&quot;</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span> <span class='symbol val'>:dn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dn identifier id'>dn</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 1056</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L1056">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete identifier id'>delete</span> <span class='args identifier id'>args</span>
  <span class='if if kw'>if</span> <span class='@open_connection ivar id'>@open_connection</span>
      <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='@open_connection ivar id'>@open_connection</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='begin begin kw'>begin</span>
      <span class='conn identifier id'>conn</span> <span class='assign token'>=</span> <span class='Connection constant id'>Connection</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@host ivar id'>@host</span><span class='comma token'>,</span> <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@port ivar id'>@port</span><span class='comma token'>,</span> <span class='symbol val'>:encryption</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@encryption ivar id'>@encryption</span> <span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:auth</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='@auth ivar id'>@auth</span> <span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
        <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='ensure ensure kw'>ensure</span>
      <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='@result ivar id'>@result</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_attribute</h3>
</div><div id="delete_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_attribute</span><span class='args'>(dn, attribute)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Delete an attribute and all its values. Takes the full DN of the entry to
modify, and the name (Symbol or String) of the attribute to delete.
</p>
<p>
Returns True or False to indicate whether the operation succeeded or
failed, with extended information available by calling
#get_operation_result. See also #add_attribute and #replace_attribute.
</p>
<pre class="code">
 <span class='dn identifier id'>dn</span> <span class='assign token'>=</span> <span class='string val'>&quot;cn=modifyme,dc=example,dc=com&quot;</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='delete_attribute identifier id'>delete_attribute</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='symbol val'>:mail</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 1015</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L1015">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1015
1016
1017</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_attribute identifier id'>delete_attribute</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='attribute identifier id'>attribute</span>
  <span class='modify identifier id'>modify</span> <span class='symbol val'>:dn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='symbol val'>:operations</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='symbol val'>:delete</span><span class='comma token'>,</span> <span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>encryption</h3>
</div><div id="encryption-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>encryption</span><span class='args'>(args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convenience method to specify encryption characteristics for connections to
LDAP servers. Called implicitly by #new and #open, but may also be called
by user code if desired. The single argument is generally a Hash (but see
below for convenience alternatives). This implementation is currently a
stub, supporting only a few encryption alternatives. As additional
capabilities are added, more configuration values will be added here.
</p>
<p>
Currently, the only supported argument is <tt>=&amp;gt; :simple_tls</tt>.
(Equivalently, you may pass the symbol :simple_tls all by itself, without
enclosing it in a Hash.)
</p>
<p>
The :simple_tls encryption method encrypts <em>all</em> communications with
the LDAP server. It completely establishes SSL/TLS encryption with the LDAP
server before any LDAP-protocol data is exchanged. There is no plaintext
negotiation and no special encryption-request controls are sent to the
server. <em>The :simple_tls option is the simplest, easiest way to encrypt
communications between Net::LDAP and LDAP servers.</em> It&#8217;s intended
for cases where you have an implicit level of trust in the authenticity of
the LDAP server. No validation of the LDAP server&#8217;s SSL certificate
is performed. This means that :simple_tls will not produce errors if the
LDAP server&#8217;s encryption certificate is not signed by a well-known
Certification Authority. If you get communications or protocol errors when
using this option, check with your LDAP server administrator. Pay
particular attention to the TCP port you are connecting to. It&#8217;s
impossible for an LDAP server to support plaintext LDAP communications and
<em>simple TLS</em> connections on the same port. The standard TCP port for
unencrypted LDAP connections is 389, but the standard port for simple-TLS
encrypted connections is 636. Be sure you are using the correct port.
</p>
<p>
<em>[Note: a future version of Net::LDAP will support the STARTTLS LDAP
control, which will enable encrypted communications on the same TCP port
used for unencrypted connections.]</em>
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 477</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L477">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">477
478
479
480
481
482
483</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='encryption identifier id'>encryption</span> <span class='args identifier id'>args</span>
  <span class='case case kw'>case</span> <span class='args identifier id'>args</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:simple_tls</span><span class='comma token'>,</span> <span class='symbol val'>:start_tls</span>
          <span class='args identifier id'>args</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='args identifier id'>args</span><span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='@encryption ivar id'>@encryption</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_operation_result</h3>
</div><div id="get_operation_result-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_operation_result</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a meaningful result any time after a protocol operation (#bind,
#search, #add, #modify, #rename, #delete) has completed. It returns an
#OpenStruct containing an LDAP result code (0 means success), and a
human-readable string.
</p>
<pre class="code">
 <span class='unless unless kw'>unless</span> <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span>
   <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;Result: #{ldap.get_operation_result.code}&quot;</span>
   <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;Message: #{ldap.get_operation_result.message}&quot;</span>
 <span class='end end kw'>end</span>
</pre>
<p>
Certain operations return additional information, accessible through
members of the object returned from #get_operation_result. Check
#get_operation_result.error_message and #get_operation_result.matched_dn.
</p>
<p>
&#8212; Modified the implementation, 20Mar07. We might get a hash of LDAP
response codes instead of a simple numeric code.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 524</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L524">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">524
525
526
527
528
529
530
531
532
533
534
535
536
537</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_operation_result identifier id'>get_operation_result</span>
  <span class='os identifier id'>os</span> <span class='assign token'>=</span> <span class='OpenStruct constant id'>OpenStruct</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='if if kw'>if</span> <span class='@result ivar id'>@result</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span>
          <span class='os identifier id'>os</span><span class='dot token'>.</span><span class='code identifier id'>code</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='@result ivar id'>@result</span><span class='lbrack token'>[</span><span class='symbol val'>:resultCode</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
          <span class='os identifier id'>os</span><span class='dot token'>.</span><span class='error_message identifier id'>error_message</span> <span class='assign token'>=</span> <span class='@result ivar id'>@result</span><span class='lbrack token'>[</span><span class='symbol val'>:errorMessage</span><span class='rbrack token'>]</span>
          <span class='os identifier id'>os</span><span class='dot token'>.</span><span class='matched_dn identifier id'>matched_dn</span> <span class='assign token'>=</span> <span class='@result ivar id'>@result</span><span class='lbrack token'>[</span><span class='symbol val'>:matchedDN</span><span class='rbrack token'>]</span>
  <span class='elsif elsif kw'>elsif</span> <span class='@result ivar id'>@result</span>
    <span class='os identifier id'>os</span><span class='dot token'>.</span><span class='code identifier id'>code</span> <span class='assign token'>=</span> <span class='@result ivar id'>@result</span>
  <span class='else else kw'>else</span>
    <span class='os identifier id'>os</span><span class='dot token'>.</span><span class='code identifier id'>code</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='end end kw'>end</span>
  <span class='os identifier id'>os</span><span class='dot token'>.</span><span class='message identifier id'>message</span> <span class='assign token'>=</span> <span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='result2string identifier id'>result2string</span><span class='lparen token'>(</span> <span class='os identifier id'>os</span><span class='dot token'>.</span><span class='code identifier id'>code</span> <span class='rparen token'>)</span>
  <span class='os identifier id'>os</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>modify</h3>
</div><div id="modify-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>modify</span><span class='args'>(args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Modifies the attribute values of a particular entry on the LDAP directory.
Takes a hash with arguments. Supported arguments are:
</p>
<table>
<tr><td valign="top">:dn :</td><td>(the full DN of the entry whose attributes are to be modified)

</td></tr>
<tr><td valign="top">:operations :</td><td>(the modifications to be performed, detailed next)

</td></tr>
</table>
<p>
This method returns True or False to indicate whether the operation
succeeded or failed, with extended information available by calling
#get_operation_result.
</p>
<p>
Also see #add_attribute, #replace_attribute, or #delete_attribute, which
provide simpler interfaces to this functionality.
</p>
<p>
The LDAP protocol provides a full and well thought-out set of operations
for changing the values of attributes, but they are necessarily somewhat
complex and not always intuitive. If these instructions are confusing or
incomplete, please send us email or create a bug report on rubyforge.
</p>
<p>
The :operations parameter to #modify takes an array of
operation-descriptors. Each individual operation is specified in one
element of the array, and most LDAP servers will attempt to perform the
operations in order.
</p>
<p>
Each of the operations appearing in the Array must itself be an Array with
exactly three elements:
</p>
<table>
<tr><td valign="top">an operator:</td><td>must be :add, :replace, or :delete

</td></tr>
<tr><td valign="top">an attribute name:</td><td>the attribute name (string or symbol) to modify

</td></tr>
<tr><td valign="top">a value:</td><td>either a string or an array of strings.

</td></tr>
</table>
<p>
The :add operator will, unsurprisingly, add the specified values to the
specified attribute. If the attribute does not already exist, :add will
create it. Most LDAP servers will generate an error if you try to add a
value that already exists.
</p>
<p>
:replace will erase the current value(s) for the specified attribute, if
there are any, and replace them with the specified value(s).
</p>
<p>
:delete will remove the specified value(s) from the specified attribute. If
you pass nil, an empty string, or an empty array as the value parameter to
a :delete operation, the <em>entire</em> <em>attribute</em> will be
deleted, along with all of its values.
</p>
<p>
For example:
</p>
<pre class="code">
 <span class='dn identifier id'>dn</span> <span class='assign token'>=</span> <span class='string val'>&quot;mail=modifyme@example.com,ou=people,dc=example,dc=com&quot;</span>
 <span class='ops identifier id'>ops</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span>
   <span class='lbrack token'>[</span><span class='symbol val'>:add</span><span class='comma token'>,</span> <span class='symbol val'>:mail</span><span class='comma token'>,</span> <span class='string val'>&quot;aliasaddress@example.com&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='symbol val'>:replace</span><span class='comma token'>,</span> <span class='symbol val'>:mail</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>&quot;newaddress@example.com&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;newalias@example.com&quot;</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='lbrack token'>[</span><span class='symbol val'>:delete</span><span class='comma token'>,</span> <span class='symbol val'>:sn</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='rbrack token'>]</span>
 <span class='rbrack token'>]</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='modify identifier id'>modify</span> <span class='symbol val'>:dn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='symbol val'>:operations</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ops identifier id'>ops</span>
</pre>
<p>
<em>(This example is contrived since you probably wouldn&#8217;t add a mail
value right before replacing the whole attribute, but it shows that order
of execution matters. Also, many LDAP servers won&#8217;t let you delete SN
because that would be a schema violation.)</em>
</p>
<p>
It&#8217;s essential to keep in mind that if you specify more than one
operation in a call to #modify, most LDAP servers will attempt to perform
all of the operations in the order you gave them. This matters because you
may specify operations on the same attribute which must be performed in a
certain order.
</p>
<p>
Most LDAP servers will <em>stop</em> processing your modifications if one
of them causes an error on the server (such as a schema-constraint
violation). If this happens, you will probably get a result code from the
server that reflects only the operation that failed, and you may or may not
get extended information that will tell you which one failed. #modify has
no notion of an atomic transaction. If you specify a chain of modifications
in one call to #modify, and one of them fails, the preceding ones will
usually not be &quot;rolled back,&quot; resulting in a partial update. This
is a limitation of the LDAP protocol, not of Net::LDAP.
</p>
<p>
The lack of transactional atomicity in LDAP means that you&#8217;re usually
better off using the convenience methods #add_attribute,
#replace_attribute, and #delete_attribute, which are are wrappers over
#modify. However, certain LDAP servers may provide concurrency semantics,
in which the several operations contained in a single #modify call are not
interleaved with other modification-requests received simultaneously by the
server. It bears repeating that this concurrency does <em>not</em> imply
transactional atomicity, which LDAP does not provide.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 948</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L948">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='modify identifier id'>modify</span> <span class='args identifier id'>args</span>
  <span class='if if kw'>if</span> <span class='@open_connection ivar id'>@open_connection</span>
      <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='@open_connection ivar id'>@open_connection</span><span class='dot token'>.</span><span class='modify identifier id'>modify</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='begin begin kw'>begin</span>
      <span class='conn identifier id'>conn</span> <span class='assign token'>=</span> <span class='Connection constant id'>Connection</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@host ivar id'>@host</span><span class='comma token'>,</span> <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@port ivar id'>@port</span><span class='comma token'>,</span> <span class='symbol val'>:encryption</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@encryption ivar id'>@encryption</span> <span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:auth</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='@auth ivar id'>@auth</span> <span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
        <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='modify identifier id'>modify</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='ensure ensure kw'>ensure</span>
      <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='close identifier id'>close</span> <span class='if if_mod kw'>if</span> <span class='conn identifier id'>conn</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='@result ivar id'>@result</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>modify_rdn</h3>
</div><div id="modify_rdn-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>modify_rdn</span><span class='args'>(args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
modify_rdn is an alias for #rename.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 1041</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L1041">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1041
1042
1043</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='modify_rdn identifier id'>modify_rdn</span> <span class='args identifier id'>args</span>
  <span class='rename identifier id'>rename</span> <span class='args identifier id'>args</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>open</h3>
</div><div id="open-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>open</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Opens a network connection to the server and then passes <tt>self</tt> to
the caller-supplied block. The connection is closed when the block
completes. Used for executing multiple LDAP operations without requiring a
separate network connection (and authentication) for each one.
<em>Note:</em> You do not need to log-in or &quot;bind&quot; to the server.
This will be done for you automatically. For an even simpler approach, see
the class method Net::LDAP#open.
</p>
<pre class="code">
 <span class='comment val'># (PSEUDOCODE)</span>
 <span class='auth identifier id'>auth</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:method</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:simple</span><span class='comma token'>,</span> <span class='symbol val'>:username</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='username identifier id'>username</span><span class='comma token'>,</span> <span class='symbol val'>:password</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='password identifier id'>password</span><span class='rbrace token'>}</span>
 <span class='ldap identifier id'>ldap</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ipaddress identifier id'>ipaddress</span><span class='comma token'>,</span> <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>389</span><span class='comma token'>,</span> <span class='symbol val'>:auth</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='auth identifier id'>auth</span> <span class='rparen token'>)</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='open identifier id'>open</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='ldap identifier id'>ldap</span><span class='bitor op'>|</span>
   <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span> <span class='dot3 op'>...</span> <span class='rparen token'>)</span>
   <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span> <span class='dot3 op'>...</span> <span class='rparen token'>)</span>
   <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='modify identifier id'>modify</span><span class='lparen token'>(</span> <span class='dot3 op'>...</span> <span class='rparen token'>)</span>
 <span class='end end kw'>end</span>
</pre>
<p>
&#8212; First we make a connection and then a binding, but we don&#8217;t
do anything with the bind results. We then pass self to the caller&#8217;s
block, where he will execute his LDAP operations. Of course they will all
generate auth failures if the bind was unsuccessful.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a title="LdapError" href="LDAP/LdapError.html">LdapError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 563</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L563">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">563
564
565
566
567
568
569
570
571
572
573</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='open identifier id'>open</span>
  <span class='raise identifier id'>raise</span> <span class='LdapError constant id'>LdapError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='string val'>&quot;open already in progress&quot;</span> <span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='@open_connection ivar id'>@open_connection</span>
  <span class='begin begin kw'>begin</span>
    <span class='@open_connection ivar id'>@open_connection</span> <span class='assign token'>=</span> <span class='Connection constant id'>Connection</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@host ivar id'>@host</span><span class='comma token'>,</span> <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@port ivar id'>@port</span><span class='comma token'>,</span> <span class='symbol val'>:encryption</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@encryption ivar id'>@encryption</span> <span class='rparen token'>)</span>
    <span class='@open_connection ivar id'>@open_connection</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span> <span class='@auth ivar id'>@auth</span>
    <span class='yield yield kw'>yield</span> <span class='self self kw'>self</span>
  <span class='ensure ensure kw'>ensure</span>
    <span class='@open_connection ivar id'>@open_connection</span><span class='dot token'>.</span><span class='close identifier id'>close</span> <span class='if if_mod kw'>if</span> <span class='@open_connection ivar id'>@open_connection</span>
    <span class='@open_connection ivar id'>@open_connection</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>paged_searches_supported?</h3>
</div><div id="paged_searches_supported-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>paged_searches_supported?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
&#8212; Convenience method to query server capabilities. Only do this once
per Net::LDAP object. Note, we call a search, and we might be called from
inside a search! MUST refactor the root_dse call out.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 1150</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L1150">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1150
1151
1152
1153</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='paged_searches_supported? fid id'>paged_searches_supported?</span>
  <span class='@server_caps ivar id'>@server_caps</span> <span class='opasgn op'>||=</span> <span class='search_root_dse identifier id'>search_root_dse</span>
  <span class='@server_caps ivar id'>@server_caps</span><span class='lbrack token'>[</span><span class='symbol val'>:supportedcontrol</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='LdapControls constant id'>LdapControls</span><span class='colon2 op'>::</span><span class='PagedResults constant id'>PagedResults</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rename</h3>
</div><div id="rename-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rename</span><span class='args'>(args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Rename an entry on the remote DIS by changing the last RDN of its DN.
<em>Documentation</em> <em>stub</em>
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 1023</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L1023">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='rename identifier id'>rename</span> <span class='args identifier id'>args</span>
  <span class='if if kw'>if</span> <span class='@open_connection ivar id'>@open_connection</span>
      <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='@open_connection ivar id'>@open_connection</span><span class='dot token'>.</span><span class='rename identifier id'>rename</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='begin begin kw'>begin</span>
      <span class='conn identifier id'>conn</span> <span class='assign token'>=</span> <span class='Connection constant id'>Connection</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@host ivar id'>@host</span><span class='comma token'>,</span> <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@port ivar id'>@port</span><span class='comma token'>,</span> <span class='symbol val'>:encryption</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@encryption ivar id'>@encryption</span> <span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:auth</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='@auth ivar id'>@auth</span> <span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
        <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='rename identifier id'>rename</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='ensure ensure kw'>ensure</span>
      <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='close identifier id'>close</span> <span class='if if_mod kw'>if</span> <span class='conn identifier id'>conn</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='@result ivar id'>@result</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>replace_attribute</h3>
</div><div id="replace_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>replace_attribute</span><span class='args'>(dn, attribute, value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Replace the value of an attribute. #replace_attribute can be thought of as
equivalent to calling #delete_attribute followed by #add_attribute. It
takes the full DN of the entry to modify, the name (Symbol or String) of
the attribute, and the value (String or Array). If the attribute does not
exist, it will be created with the caller-specified value(s). If the
attribute does exist, its values will be <em>discarded</em> and replaced
with the caller-specified values.
</p>
<p>
Returns True or False to indicate whether the operation succeeded or
failed, with extended information available by calling
#get_operation_result. See also #add_attribute and #delete_attribute.
</p>
<pre class="code">
 <span class='dn identifier id'>dn</span> <span class='assign token'>=</span> <span class='string val'>&quot;cn=modifyme,dc=example,dc=com&quot;</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='replace_attribute identifier id'>replace_attribute</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='symbol val'>:mail</span><span class='comma token'>,</span> <span class='string val'>&quot;newmailaddress@example.com&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 1000</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L1000">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1000
1001
1002</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='replace_attribute identifier id'>replace_attribute</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='value identifier id'>value</span>
  <span class='modify identifier id'>modify</span> <span class='symbol val'>:dn</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='dn identifier id'>dn</span><span class='comma token'>,</span> <span class='symbol val'>:operations</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='lbrack token'>[</span><span class='symbol val'>:replace</span><span class='comma token'>,</span> <span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>search</h3>
</div><div id="search-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>search</span><span class='args'>(args = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Searches the LDAP directory for directory entries. Takes a hash argument
with parameters. Supported parameters include:
</p>
<ul>
<li>:base (a string specifying the tree-base for the search);

</li>
<li>:filter (an object of type Net::LDAP::Filter, defaults to objectclass=*);

</li>
<li>:attributes (a string or array of strings specifying the LDAP attributes to
return from the server);

</li>
<li>:return_result (a boolean specifying whether to return a result set).

</li>
<li>:attributes_only (a boolean flag, defaults false)

</li>
<li>:scope (one of: Net::LDAP::SearchScope_BaseObject,
Net::LDAP::SearchScope_SingleLevel, Net::LDAP::SearchScope_WholeSubtree.
Default is WholeSubtree.)

</li>
<li>:size (an integer indicating the maximum number of search entries to
return. Default is zero, which signifies no limit.)

</li>
</ul>
<p>
#search queries the LDAP server and passes <em>each entry</em> to the
caller-supplied block, as an object of type Net::LDAP::Entry. If the search
returns 1000 entries, the block will be called 1000 times. If the search
returns no entries, the block will not be called.
</p>
<p>
&#8212; ORIGINAL TEXT, replaced 04May06. #search returns either a
result-set or a boolean, depending on the value of the
<tt>:return_result</tt> argument. The default behavior is to return a
result set, which is a hash. Each key in the hash is a string specifying
the DN of an entry. The corresponding value for each key is a
Net::LDAP::Entry object. If you request a result set and #search fails with
an error, it will return nil. Call #get_operation_result to get the error
information returned by the LDAP server. ++ #search returns either a
result-set or a boolean, depending on the value of the
<tt>:return_result</tt> argument. The default behavior is to return a
result set, which is an Array of objects of class Net::LDAP::Entry. If you
request a result set and #search fails with an error, it will return nil.
Call #get_operation_result to get the error information returned by the
LDAP server.
</p>
<p>
When <tt>:return_result =&gt; false,</tt> #search will return only a
Boolean, to indicate whether the operation succeeded. This can improve
performance with very large result sets, because the library can discard
each entry from memory after your block processes it.
</p>
<pre class="code">
 <span class='treebase identifier id'>treebase</span> <span class='assign token'>=</span> <span class='string val'>&quot;dc=example,dc=com&quot;</span>
 <span class='filter identifier id'>filter</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='colon2 op'>::</span><span class='Filter constant id'>Filter</span><span class='dot token'>.</span><span class='eq identifier id'>eq</span><span class='lparen token'>(</span> <span class='string val'>&quot;mail&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;a*.com&quot;</span> <span class='rparen token'>)</span>
 <span class='attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>&quot;mail&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;cn&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;sn&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;objectclass&quot;</span><span class='rbrack token'>]</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span> <span class='symbol val'>:base</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='treebase identifier id'>treebase</span><span class='comma token'>,</span> <span class='symbol val'>:filter</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='filter identifier id'>filter</span><span class='comma token'>,</span> <span class='symbol val'>:attributes</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='symbol val'>:return_result</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
   <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;DN: #{entry.dn}&quot;</span>
   <span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attr identifier id'>attr</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='bitor op'>|</span>
     <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;.......#{attr}:&quot;</span>
     <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
       <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;          #{value}&quot;</span>
     <span class='end end kw'>end</span>
   <span class='end end kw'>end</span>
 <span class='end end kw'>end</span>
</pre>
<p>
&#8212; This is a re-implementation of search that replaces the original
one (now renamed searchx and possibly destined to go away). The difference
is that we return a dataset (or nil) from the call, and pass _each entry_
as it is received from the server to the caller-supplied block. This will
probably make things far faster as we can do useful work during the network
latency of the search. The downside is that we have no access to the whole
set while processing the blocks, so we can&#8217;t do stuff like sort the
DNs until after the call completes. It&#8217;s also possible that this
interacts badly with server timeouts. We&#8217;ll have to ensure that
something reasonable happens if the caller has processed half a result set
when we throw a timeout error. Another important difference is that we
return a result set from this method rather than a T/F indication. Since
this can be very heavy-weight, we define an argument flag that the caller
can set to suppress the return of a result set, if he&#8217;s planning to
process every entry as it comes from the server.
</p>
<p>
REINTERPRETED the result set, 04May06. Originally this was a hash of
entries keyed by DNs. But let&#8217;s get away from making users handle
DNs. Change it to a plain array. Eventually we may want to return a Dataset
object that delegates to an internal array, so we can provide sort methods
and what-not.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 654</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L654">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='search identifier id'>search</span> <span class='args identifier id'>args</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='unless unless kw'>unless</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:ignore_server_caps</span><span class='rbrack token'>]</span>
    <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:paged_searches_supported</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='paged_searches_supported? fid id'>paged_searches_supported?</span>
  <span class='end end kw'>end</span>

  <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:base</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='@base ivar id'>@base</span>
  <span class='result_set identifier id'>result_set</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='args identifier id'>args</span> <span class='and and kw'>and</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:return_result</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='false false kw'>false</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='nil nil kw'>nil</span> <span class='colon op'>:</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>

  <span class='if if kw'>if</span> <span class='@open_connection ivar id'>@open_connection</span>
    <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='@open_connection ivar id'>@open_connection</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
      <span class='result_set identifier id'>result_set</span> <span class='lshft op'>&lt;&lt;</span> <span class='entry identifier id'>entry</span> <span class='if if_mod kw'>if</span> <span class='result_set identifier id'>result_set</span>
      <span class='yield yield kw'>yield</span><span class='lparen token'>(</span> <span class='entry identifier id'>entry</span> <span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
    <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='begin begin kw'>begin</span>
      <span class='conn identifier id'>conn</span> <span class='assign token'>=</span> <span class='Connection constant id'>Connection</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@host ivar id'>@host</span><span class='comma token'>,</span> <span class='symbol val'>:port</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@port ivar id'>@port</span><span class='comma token'>,</span> <span class='symbol val'>:encryption</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@encryption ivar id'>@encryption</span> <span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='bind identifier id'>bind</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='symbol val'>:auth</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='@auth ivar id'>@auth</span> <span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
        <span class='@result ivar id'>@result</span> <span class='assign token'>=</span> <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span> <span class='args identifier id'>args</span> <span class='rparen token'>)</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
          <span class='result_set identifier id'>result_set</span> <span class='lshft op'>&lt;&lt;</span> <span class='entry identifier id'>entry</span> <span class='if if_mod kw'>if</span> <span class='result_set identifier id'>result_set</span>
          <span class='yield yield kw'>yield</span><span class='lparen token'>(</span> <span class='entry identifier id'>entry</span> <span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
        <span class='rbrace token'>}</span>
      <span class='end end kw'>end</span>
    <span class='ensure ensure kw'>ensure</span>
      <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='close identifier id'>close</span> <span class='if if_mod kw'>if</span> <span class='conn identifier id'>conn</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='@result ivar id'>@result</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='and and kw'>and</span> <span class='result_set identifier id'>result_set</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>search_root_dse</h3>
</div><div id="search_root_dse-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>search_root_dse</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
(Experimental, subject to change). Return the rootDSE record from the LDAP
server as a Net::LDAP::Entry, or an empty Entry if the server doesn&#8217;t
return the record. &#8212; cf. RFC4512 graf 5.1. Note that the rootDSE
record we return on success has an empty DN, which is correct. On failure,
the empty Entry will have a nil DN. There&#8217;s no real reason for that,
so it can be changed if desired. The funky number-disagreements in the set
of attribute names is correct per the RFC. We may be called by #search
itself, which may need to determine things like paged search capabilities.
So to avoid an infinite regress, set :ignore_server_caps, which prevents us
getting called recursively.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 1087</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L1087">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1087
1088
1089
1090
1091
1092
1093
1094
1095</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='search_root_dse identifier id'>search_root_dse</span>
  <span class='rs identifier id'>rs</span> <span class='assign token'>=</span> <span class='search identifier id'>search</span><span class='lparen token'>(</span>
    <span class='symbol val'>:ignore_server_caps=</span><span class='gt op'>&gt;</span><span class='true true kw'>true</span><span class='comma token'>,</span>
    <span class='symbol val'>:base=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:scope=</span><span class='gt op'>&gt;</span><span class='SearchScope_BaseObject constant id'>SearchScope_BaseObject</span><span class='comma token'>,</span>
    <span class='symbol val'>:attributes=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='symbol val'>:namingContexts</span><span class='comma token'>,</span><span class='symbol val'>:supportedLdapVersion</span><span class='comma token'>,</span><span class='symbol val'>:altServer</span><span class='comma token'>,</span><span class='symbol val'>:supportedControl</span><span class='comma token'>,</span><span class='symbol val'>:supportedExtension</span><span class='comma token'>,</span><span class='symbol val'>:supportedFeatures</span><span class='comma token'>,</span><span class='symbol val'>:supportedSASLMechanisms</span><span class='rbrack token'>]</span>
  <span class='rparen token'>)</span>
  <span class='lparen token'>(</span><span class='rs identifier id'>rs</span> <span class='and and kw'>and</span> <span class='rs identifier id'>rs</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='Entry constant id'>Entry</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>search_subschema_entry</h3>
</div><div id="search_subschema_entry-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>search_subschema_entry</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Return the root Subschema record from the LDAP server as a
Net::LDAP::Entry, or an empty Entry if the server doesn&#8217;t return the
record. On success, the Net::LDAP::Entry returned from this call will have
the attributes :dn, :objectclasses, and :attributetypes. If there is an
error, call #get_operation_result for more information.
</p>
<pre class="code">
 <span class='ldap identifier id'>ldap</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='LDAP constant id'>LDAP</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='host identifier id'>host</span> <span class='assign token'>=</span> <span class='string val'>&quot;your.ldap.host&quot;</span>
 <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='auth identifier id'>auth</span> <span class='string val'>&quot;your-user-dn&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;your-psw&quot;</span>
 <span class='subschema_entry identifier id'>subschema_entry</span> <span class='assign token'>=</span> <span class='ldap identifier id'>ldap</span><span class='dot token'>.</span><span class='search_subschema_entry identifier id'>search_subschema_entry</span>

 <span class='subschema_entry identifier id'>subschema_entry</span><span class='dot token'>.</span><span class='attributetypes identifier id'>attributetypes</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attrtype identifier id'>attrtype</span><span class='bitor op'>|</span>
     <span class='comment val'># your code</span>
 <span class='end end kw'>end</span>

 <span class='subschema_entry identifier id'>subschema_entry</span><span class='dot token'>.</span><span class='objectclasses identifier id'>objectclasses</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attrtype identifier id'>attrtype</span><span class='bitor op'>|</span>
     <span class='comment val'># your code</span>
 <span class='end end kw'>end</span>
</pre>
<p>
&#8212; cf. RFC4512 section 4, particulary graff 4.4. The :dn attribute in
the returned Entry is the subschema name as returned from the server. Set
:ignore_server_caps, see the notes in search_root_dse.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/net/ldap.rb', line 1122</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/dim/ruby-net-ldap/blob/228de90192f74d1096653bb895f1f1bdd364b78f/lib/net/ldap.rb#L1122">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='search_subschema_entry identifier id'>search_subschema_entry</span>
        <span class='rs identifier id'>rs</span> <span class='assign token'>=</span> <span class='search identifier id'>search</span><span class='lparen token'>(</span>
                    <span class='symbol val'>:ignore_server_caps=</span><span class='gt op'>&gt;</span><span class='true true kw'>true</span><span class='comma token'>,</span>
                    <span class='symbol val'>:base=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:scope=</span><span class='gt op'>&gt;</span><span class='SearchScope_BaseObject constant id'>SearchScope_BaseObject</span><span class='comma token'>,</span>
                    <span class='symbol val'>:attributes=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='symbol val'>:subschemaSubentry</span><span class='rbrack token'>]</span>
        <span class='rparen token'>)</span>
        <span class='return return kw'>return</span> <span class='Entry constant id'>Entry</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='rs identifier id'>rs</span> <span class='and and kw'>and</span> <span class='rs identifier id'>rs</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='rparen token'>)</span>
        <span class='subschema_name identifier id'>subschema_name</span> <span class='assign token'>=</span> <span class='rs identifier id'>rs</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='dot token'>.</span><span class='subschemasubentry identifier id'>subschemasubentry</span>
        <span class='return return kw'>return</span> <span class='Entry constant id'>Entry</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='subschema_name identifier id'>subschema_name</span> <span class='and and kw'>and</span> <span class='subschema_name identifier id'>subschema_name</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='rparen token'>)</span>

        <span class='rs identifier id'>rs</span> <span class='assign token'>=</span> <span class='search identifier id'>search</span><span class='lparen token'>(</span>
                    <span class='symbol val'>:ignore_server_caps=</span><span class='gt op'>&gt;</span><span class='true true kw'>true</span><span class='comma token'>,</span>
                    <span class='symbol val'>:base=</span><span class='gt op'>&gt;</span><span class='subschema_name identifier id'>subschema_name</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='comma token'>,</span>
                    <span class='symbol val'>:scope=</span><span class='gt op'>&gt;</span><span class='SearchScope_BaseObject constant id'>SearchScope_BaseObject</span><span class='comma token'>,</span>
                    <span class='symbol val'>:filter=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;objectclass=subschema&quot;</span><span class='comma token'>,</span>
                    <span class='symbol val'>:attributes=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='symbol val'>:objectclasses</span><span class='comma token'>,</span> <span class='symbol val'>:attributetypes</span><span class='rbrack token'>]</span>
        <span class='rparen token'>)</span>

        <span class='lparen token'>(</span><span class='rs identifier id'>rs</span> <span class='and and kw'>and</span> <span class='rs identifier id'>rs</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='Entry constant id'>Entry</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>