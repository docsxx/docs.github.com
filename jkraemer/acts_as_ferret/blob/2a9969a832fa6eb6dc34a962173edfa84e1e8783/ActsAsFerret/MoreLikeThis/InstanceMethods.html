<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>jkraemer's acts_as_ferret - Module: ActsAsFerret::MoreLikeThis::InstanceMethods - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/jkraemer/commits/acts_as_ferret/master" rel="alternate" title="Recent Commits to acts_as_ferret:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("jkraemer", "acts_as_ferret", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='jkraemer/acts_as_ferret/blob/2a9969a832fa6eb6dc34a962173edfa84e1e8783' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='jkraemer/acts_as_ferret/blob/2a9969a832fa6eb6dc34a962173edfa84e1e8783' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("jkraemer", "acts_as_ferret", "2a9969a832fa6eb6dc34a962173edfa84e1e8783", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/jkraemer/acts_as_ferret/tree/">Source</a></li>
            <li class=""><a href="http://github.com/jkraemer/acts_as_ferret/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/jkraemer/acts_as_ferret/network">Network</a></li>            
            <li class=""><a href="http://github.com/jkraemer/acts_as_ferret/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/jkraemer/acts_as_ferret">Wiki</a></li>
            <li class=""><a href="http://github.com/jkraemer/acts_as_ferret/graphs">Graphs</a></li>                    
            <li class="active"><a href="/jkraemer/acts_as_ferret">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/jkraemer">jkraemer</a> / <b><a href="http://github.com/jkraemer/acts_as_ferret/tree">acts_as_ferret</a></b>        
                <a id="namespaces_button" rel="jkraemer/acts_as_ferret/blob/2a9969a832fa6eb6dc34a962173edfa84e1e8783" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="jkraemer/acts_as_ferret/blob/2a9969a832fa6eb6dc34a962173edfa84e1e8783" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module ActsAsFerret_MoreLikeThis_InstanceMethods">
  <h1>Module: ActsAsFerret::MoreLikeThis::InstanceMethods</h1>
  <div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#more_like_this-instance_method">#more_like_this</span><span class='args'>(options = {}, ferret_options = {}, ar_options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
returns other instances of this class, which have similar contents like
this one.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>more_like_this</h3>
</div><div id="more_like_this-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>more_like_this</span><span class='args'>(options = {}, ferret_options = {}, ar_options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
returns other instances of this class, which have similar contents like
this one. Basically works like this: find out n most interesting (i.e.
characteristic) terms from this document, and then build a query from those
which is run against the whole index. Which terms are interesting is
decided on variour criteria which can be influenced by the given options.
</p>
<p>
The algorithm used here is a quite straight port of the MoreLikeThis class
from Apache Lucene.
</p>
<p>
options are: :field_names : Array of field names to use for similarity
search (mandatory) :min_term_freq =&gt; 2, # Ignore terms with less than
this frequency in the source doc. :min_doc_freq =&gt; 5, # Ignore words
which do not occur in at least this many docs :min_word_length =&gt; nil, #
Ignore words shorter than this length (longer words tend to
</p>
<pre class="code">
                           <span class='be identifier id'>be</span> <span class='more identifier id'>more</span> <span class='characteristic identifier id'>characteristic</span> <span class='for for kw'>for</span> <span class='the identifier id'>the</span> <span class='document identifier id'>document</span> <span class='they identifier id'>they</span> <span class='occur identifier id'>occur</span> <span class='in in kw'>in</span><span class='rparen token'>)</span><span class='dot token'>.</span>
</pre>
<p>
:max_word_length =&gt; nil, # Ignore words if greater than this len.
:max_query_terms =&gt; 25, # maximum number of terms in the query built
:max_num_tokens =&gt; 5000, # maximum number of tokens to examine in a
single field :boost =&gt; false, # when true, a boost according to the
relative score of
</p>
<pre class="code">
                           <span class='a identifier id'>a</span> <span class='term identifier id'>term</span> <span class='is identifier id'>is</span> <span class='applied identifier id'>applied</span> <span class='to identifier id'>to</span> <span class='this identifier id'>this</span> <span class='Term constant id'>Term</span><span class='string val'>'s TermQuery.
</span></pre>
<p>
:similarity =&gt; &#8216;DefaultAAFSimilarity&#8217; # the similarity
implementation to use (the default
</p>
<pre class="code">
                                          <span class='equals identifier id'>equals</span> <span class='Ferret constant id'>Ferret</span><span class='string val'>'s internal similarity implementation)
</span></pre>
<p>
:analyzer =&gt; &#8216;Ferret::Analysis::StandardAnalyzer&#8217; # class
name of the analyzer to use :append_to_query =&gt; nil # proc taking a
query object as argument, which will be called after generating the query.
can be used to further manipulate the query used to find related documents,
i.e. to constrain the search to a given class in single table inheritance
scenarios ferret_options : Ferret options handed over to find_with_ferret
(i.e. for limits and sorting) ar_options : options handed over to
find_with_ferret for AR scoping
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/more_like_this.rb', line 34</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jkraemer/acts_as_ferret/blob/2a9969a832fa6eb6dc34a962173edfa84e1e8783/lib/more_like_this.rb#L34">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='more_like_this identifier id'>more_like_this</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='ferret_options identifier id'>ferret_options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='ar_options identifier id'>ar_options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span>
    <span class='symbol val'>:field_names</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span>  <span class='comment val'># Default field names</span>
    <span class='symbol val'>:min_term_freq</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>2</span><span class='comma token'>,</span>  <span class='comment val'># Ignore terms with less than this frequency in the source doc.</span>
    <span class='symbol val'>:min_doc_freq</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>5</span><span class='comma token'>,</span>   <span class='comment val'># Ignore words which do not occur in at least this many docs</span>
    <span class='symbol val'>:min_word_length</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='comment val'># Ignore words if less than this len. Default is not to ignore any words.</span>
    <span class='symbol val'>:max_word_length</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='comment val'># Ignore words if greater than this len. Default is not to ignore any words.</span>
    <span class='symbol val'>:max_query_terms</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>25</span><span class='comma token'>,</span>  <span class='comment val'># maximum number of terms in the query built</span>
    <span class='symbol val'>:max_num_tokens</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>5000</span><span class='comma token'>,</span> <span class='comment val'># maximum number of tokens to analyze when analyzing contents</span>
    <span class='symbol val'>:boost</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span><span class='comma token'>,</span>      
    <span class='symbol val'>:similarity</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'ActsAsFerret::MoreLikeThis::DefaultAAFSimilarity'</span><span class='comma token'>,</span>  <span class='comment val'># class name of the similarity implementation to use</span>
    <span class='symbol val'>:analyzer</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Ferret::Analysis::StandardAnalyzer'</span><span class='comma token'>,</span> <span class='comment val'># class name of the analyzer to use</span>
    <span class='symbol val'>:append_to_query</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span>
    <span class='symbol val'>:base_class</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span> <span class='comment val'># base class to use for querying, useful in STI scenarios where BaseClass.find_with_ferret can be used to retrieve results from other classes, too</span>
  <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='update identifier id'>update</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='comment val'>#index.search_each('id:*') do |doc, score|</span>
  <span class='comment val'>#  puts &quot;#{doc} == #{index[doc][:description]}&quot;</span>
  <span class='comment val'>#end</span>
  <span class='clazz identifier id'>clazz</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:base_class</span><span class='rbrack token'>]</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:base_class</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='clazz identifier id'>clazz</span><span class='dot token'>.</span><span class='name identifier id'>name</span>
  <span class='query identifier id'>query</span> <span class='assign token'>=</span> <span class='clazz identifier id'>clazz</span><span class='dot token'>.</span><span class='aaf_index identifier id'>aaf_index</span><span class='dot token'>.</span><span class='build_more_like_this_query identifier id'>build_more_like_this_query</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='ferret_key identifier id'>ferret_key</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:append_to_query</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='query identifier id'>query</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:append_to_query</span><span class='rbrack token'>]</span>
  <span class='clazz identifier id'>clazz</span><span class='dot token'>.</span><span class='find_with_ferret identifier id'>find_with_ferret</span><span class='lparen token'>(</span><span class='query identifier id'>query</span><span class='comma token'>,</span> <span class='ferret_options identifier id'>ferret_options</span><span class='comma token'>,</span> <span class='ar_options identifier id'>ar_options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>