<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>collective's crabgrass - Class: GreenCloth - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/collective/commits/crabgrass/master" rel="alternate" title="Recent Commits to crabgrass:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("collective", "crabgrass", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("collective", "crabgrass", "d5ca62efc4e95fa5c92c788fb8b16d4f01717896", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/collective/crabgrass/tree/">Source</a></li>
            <li class=""><a href="http://github.com/collective/crabgrass/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/collective/crabgrass/network">Network</a></li>            
            <li class=""><a href="http://github.com/collective/crabgrass/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/collective/crabgrass">Wiki</a></li>
            <li class=""><a href="http://github.com/collective/crabgrass/graphs">Graphs</a></li>                    
            <li class="active"><a href="/collective/crabgrass">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/collective">collective</a> / <b><a href="http://github.com/collective/crabgrass/tree">crabgrass</a></b>        
                <a id="namespaces_button" rel="collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class GreenCloth">
  <h1>Class: GreenCloth</h1>
  <div class="section inheritance">
  <ul>
  <li>RedCloth::TextileDoc</li><ul><li>GreenCloth</li>
  </ul></ul>
</div><div class="section mixins">
  <h2>Included Modules</h2>
  <p><a href="GreenCloth/GreenclothOutline.html" title="GreenclothOutline">GreenclothOutline</a></p>
</div><div class="section docstring">
  <p>
GREENCLOTH PARSER
</p>
<p>
Our modifications to RedCloth take two forms: changes to the html formatter
and changes to the TextileDoc. Here lie the changes to the TextileDoc. For
changes to formatter, see above.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">formatter</td>
          <td class="readwrite">
            [<span id='formatter-instance_method'>R</span><span id='formatter=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>formatter</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">offtags</td>
          <td class="readwrite">
            [<span id='offtags-instance_method'>R</span><span id='offtags=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>offtags</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">original</td>
          <td class="readwrite">
            [<span id='original-instance_method'>R</span><span id='original=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>original</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">outline</td>
          <td class="readwrite">
            [<span id='outline-instance_method'>R</span><span id='outline=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
custom restrictions if true, enable table of contents.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="AUTO_LINK_RE-constant">AUTO_LINK_RE</dt>
      <dd>%r{
  (                          # (a) LEADING TEXT
    &lt;\w+.*?&gt;|                # leading HTML tag, or
    [^=!:'&quot;/]|               # 'leading punctuation, or
    ^                        # beginning of line
  )
  (                          # (b) PROTOCOL 
    (?:#{PROTOCOL}s?://)|    # protocol spec, or
    (?:www\.)                # www.*
  )
  (                          # (c) URL
    [-\w]+                   # subdomain or domain
    (?:\.[-\w]+)*            # remaining subdomains or domain
    (?::\d+)?                # port
    (?:/(?:(?:[#{URL_CHAR}]|(?:[#{URL_PUNCT}][^\s$]))+)?)* # path
    (?:\?[\w\+%&amp;=.;-]+?)?    # query string
    (?:\#[\w\-\.]*)?         # trailing anchor
  )?
  (\1|\r?\n|$|[#{URL_PUNCT}](\s|\r?\n|$))  #(d) TRAILING TEXT
}x</dd>
    
      <dt id="BRACKET_FORMATTERS-constant">BRACKET_FORMATTERS</dt>
      <dd>/[\+\-\^\*\?_@=~]/</dd>
    
      <dt id="BRACKET_LINK_RE-constant">BRACKET_LINK_RE</dt>
      <dd>/
  (^|.)         # start of line or any character $1
  \[(.)         # begin [ ($2 =&gt; first char)
  ([ \t]*[^\[\]]+)    # $text : one or more characters that are not [ or ] ($3)
  [ \t]*        # optional white space
  (.)\]         # end ] ($4 =&gt; last char)
/x </dd>
    
      <dt id="CODE_TAG_RE-constant">CODE_TAG_RE</dt>
      <dd>/(.?)(?:(&lt;\/?#{ CODE_TAGS }[^&gt;]*&gt;))(.*?)(&lt;\/?\3&gt;|\Z)/mi</dd>
    
      <dt id="CODE_TAGS-constant">CODE_TAGS</dt>
      <dd>/(code|pre)/</dd>
    
      <dt id="DYNAMIC_SYMBOLS-constant">DYNAMIC_SYMBOLS</dt>
      <dd>['toc']</dd>
    
      <dt id="DYNAMIC_SYMBOLS_RE-constant">DYNAMIC_SYMBOLS_RE</dt>
      <dd>/^\s*\[\[(#{DYNAMIC_SYMBOLS.join('|')})\]\]\s*$/</dd>
    
      <dt id="HEADINGS_RE-constant">HEADINGS_RE</dt>
      <dd>/^(.+?)\s*\r?\n([=-])[=-]+\s*?(\r?\n\r?\n?|$)/</dd>
    
      <dt id="LONG_WORD_CHAR_MAX-constant">LONG_WORD_CHAR_MAX</dt>
      <dd>30</dd>
    
      <dt id="LONG_WORDS_RE-constant">LONG_WORDS_RE</dt>
      <dd>/(\w{#{LONG_WORD_CHAR_MAX},})/</dd>
    
      <dt id="OFFTAG_PREFIX-constant">OFFTAG_PREFIX</dt>
      <dd>'offtag'</dd>
    
      <dt id="OFFTAG_RE-constant">OFFTAG_RE</dt>
      <dd>/\}#{OFFTAG_PREFIX}#([\d]+)\{/  </dd>
    
      <dt id="PROTOCOL-constant">PROTOCOL</dt>
      <dd>'(?:sips?|https?|s?ftps?)'</dd>
    
      <dt id="QUOTED_BLOCK_RE-constant">QUOTED_BLOCK_RE</dt>
      <dd>/(^&gt;.*$(.+\n)*\n*)+/</dd>
    
      <dt id="TABLE_TABS_RE-constant">TABLE_TABS_RE</dt>
      <dd>/^\t.*\t(\r?\n|$)/</dd>
    
      <dt id="TEXTILE_HEADING_RE-constant">TEXTILE_HEADING_RE</dt>
      <dd>/^h[123]\./</dd>
    
      <dt id="URL_CHAR-constant">URL_CHAR</dt>
      <dd>'\w' + Regexp::quote('+%$*\'()-~')</dd>
    
      <dt id="URL_PUNCT-constant">URL_PUNCT</dt>
      <dd>Regexp::quote(',.;:!?')</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(string, default_owner_name = 'page', restrictions = [])</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 303</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L303">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">303
304
305
306
307
308
309
310
311</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='comma token'>,</span> <span class='default_owner_name identifier id'>default_owner_name</span> <span class='assign token'>=</span> <span class='string val'>'page'</span><span class='comma token'>,</span> <span class='restrictions identifier id'>restrictions</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='@default_owner ivar id'>@default_owner</span> <span class='assign token'>=</span> <span class='default_owner_name identifier id'>default_owner_name</span>
  <span class='restrictions identifier id'>restrictions</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='bitor op'>|</span> <span class='method identifier id'>method</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{r}=&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span> <span class='true true kw'>true</span> <span class='rparen token'>)</span> <span class='rbrace token'>}</span>

  <span class='comment val'># filter_ids    -- don't allow the user to set dom ids in the markup. This can</span>
  <span class='comment val'>#                  royally mess with the display of a page.</span>
  <span class='comment val'># sanitize_html -- allows some basic html, see ALLOWED_TAGS aboved.</span>
  <span class='super super kw'>super</span><span class='lparen token'>(</span><span class='string identifier id'>string</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:filter_ids</span><span class='comma token'>,</span> <span class='symbol val'>:sanitize_html</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#apply_inline_filters-instance_method">#apply_inline_filters</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
what is this used for???.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#auto_links-instance_method">#auto_links</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bracket_links-instance_method">#bracket_links</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#codetitle-instance_method">#codetitle</span><span class='args'>(opts)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
this is called automatically when line starts with &quot;codetitle.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_leading_whitespace-instance_method">#delete_leading_whitespace</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
why is this needed?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#dynamic_symbols-instance_method">#dynamic_symbols</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#extract_headings-instance_method">#extract_headings</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
populates @headings, and then restores the string to its original form.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#extract_offtags-instance_method">#extract_offtags</span><span class='args'>(html)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#flush_left-instance_method">#flush_left</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#format_block_code-instance_method">#format_block_code</span><span class='args'>(tag, body, leading_character = '')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#initialize_copy-instance_method">#initialize_copy</span><span class='args'>(arg)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
RedCloth calls clone of the GreenCloth object before extending the object
with the formatter.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#normalize_code_blocks-instance_method">#normalize_code_blocks</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
convert greencloth specific markup for code blocks into redcloth standard
markup.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#normalize_heading_blocks-instance_method">#normalize_heading_blocks</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#offtag_it-instance_method">#offtag_it</span><span class='args'>(text, original = '', symbol = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
why }{ instead of {}? so offtags will work with tables.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#offtag_obvious_code_blocks-instance_method">#offtag_obvious_code_blocks</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#quoted_block-instance_method">#quoted_block</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#revert_offtags-instance_method">#revert_offtags</span><span class='args'>(html)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
replace offtag with the original text.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#tables_with_tabs-instance_method">#tables_with_tabs</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_html-instance_method">#to_html</span><span class='args'>(*before_filters, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#wrap_long_words-instance_method">#wrap_long_words</span><span class='args'>(text)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h2>Public Instance Methods Included from <a href="GreenCloth/GreenclothOutline.html" title="GreenclothOutline">GreenclothOutline</a></h2>
    <p><span class='name'><a href="GreenclothOutline.html#get_text_for_heading-instance_method" title="get_text_for_heading">get_text_for_heading</a></span>, <span class='name'><a href="GreenclothOutline.html#heading_names-instance_method" title="heading_names">heading_names</a></span>, <span class='name'><a href="GreenclothOutline.html#heading_tree-instance_method" title="heading_tree">heading_tree</a></span>, <span class='name'><a href="GreenclothOutline.html#headings-instance_method" title="headings">headings</a></span>, <span class='name'><a href="GreenclothOutline.html#parent_heading_names-instance_method" title="parent_heading_names">parent_heading_names</a></span>, <span class='name'><a href="GreenclothOutline.html#set_text_for_heading-instance_method" title="set_text_for_heading">set_text_for_heading</a></span>, <span class='name'><a href="GreenclothOutline.html#subheading_names-instance_method" title="subheading_names">subheading_names</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>apply_inline_filters</h3>
</div><div id="apply_inline_filters-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>apply_inline_filters</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
what is this used for???
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 350</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L350">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">350
351
352
353
354</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='apply_inline_filters identifier id'>apply_inline_filters</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='bracket_links identifier id'>bracket_links</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='auto_links identifier id'>auto_links</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='text identifier id'>text</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>auto_links</h3>
</div><div id="auto_links-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>auto_links</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 531</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L531">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='auto_links identifier id'>auto_links</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='AUTO_LINK_RE constant id'>AUTO_LINK_RE</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='all identifier id'>all</span><span class='comma token'>,</span> <span class='a identifier id'>a</span><span class='comma token'>,</span> <span class='b identifier id'>b</span><span class='comma token'>,</span> <span class='c identifier id'>c</span><span class='comma token'>,</span> <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='$&amp; back_ref id'>$&amp;</span><span class='comma token'>,</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span><span class='comma token'>,</span> <span class='$4 nth_ref id'>$4</span>
    <span class='if if kw'>if</span> <span class='a identifier id'>a</span> <span class='match op'>=~</span> <span class='regexp val'>/&lt;a\s/i</span> <span class='comment val'># don't replace URL's that are already linked</span>
      <span class='all identifier id'>all</span>
    <span class='elsif elsif kw'>elsif</span> <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
      <span class='all identifier id'>all</span>
    <span class='else else kw'>else</span>
      <span class='first_char identifier id'>first_char</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
      <span class='if if kw'>if</span> <span class='first_char identifier id'>first_char</span> <span class='match op'>=~</span> <span class='BRACKET_FORMATTERS constant id'>BRACKET_FORMATTERS</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='first_char identifier id'>first_char</span> <span class='eq op'>==</span> <span class='c identifier id'>c</span><span class='lbrack token'>[</span><span class='float val'>-1</span><span class='dot2 op'>..</span><span class='integer val'>-1</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
        <span class='comment val'># match formatting characters and don't autolink them if the same one exists on both sides</span>
        <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='first_char identifier id'>first_char</span>
        <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='chop! fid id'>chop!</span> <span class='comment val'># remove last char from c.</span>
      <span class='end end kw'>end</span>
      <span class='label identifier id'>label</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span>
      <span class='url identifier id'>url</span> <span class='assign token'>=</span> <span class='dstring node'>%(#{b==&quot;www.&quot;?&quot;http://www.&quot;:b}#{c})</span>
      <span class='link identifier id'>link</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
      <span class='if if kw'>if</span> <span class='@block ivar id'>@block</span>
        <span class='link identifier id'>link</span> <span class='assign token'>=</span> <span class='@block ivar id'>@block</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='symbol val'>:auto</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='symbol val'>:url</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='url identifier id'>url</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='unless unless kw'>unless</span> <span class='link identifier id'>link</span>
        <span class='text identifier id'>text</span> <span class='assign token'>=</span> <span class='truncate identifier id'>truncate</span><span class='lparen token'>(</span><span class='label identifier id'>label</span><span class='comma token'>,</span> <span class='integer val'>42</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/\/$/</span><span class='comma token'>,</span><span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='link identifier id'>link</span> <span class='assign token'>=</span> <span class='string val'>'&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;'</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='url identifier id'>url</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='formatter identifier id'>formatter</span><span class='dot token'>.</span><span class='html_esc identifier id'>html_esc</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span><span class='rbrack token'>]</span>
      <span class='end end kw'>end</span>
      <span class='a identifier id'>a</span> <span class='plus op'>+</span> <span class='offtag_it identifier id'>offtag_it</span><span class='lparen token'>(</span><span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='b identifier id'>b</span><span class='plus op'>+</span><span class='c identifier id'>c</span> <span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='d identifier id'>d</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>bracket_links</h3>
</div><div id="bracket_links-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bracket_links</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 571</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L571">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='bracket_links identifier id'>bracket_links</span><span class='lparen token'>(</span> <span class='text identifier id'>text</span> <span class='rparen token'>)</span> 
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span> <span class='BRACKET_LINK_RE constant id'>BRACKET_LINK_RE</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='m identifier id'>m</span><span class='bitor op'>|</span>
    <span class='begin begin kw'>begin</span>
      <span class='all identifier id'>all</span><span class='comma token'>,</span> <span class='preceding_char identifier id'>preceding_char</span><span class='comma token'>,</span> <span class='first_char identifier id'>first_char</span><span class='comma token'>,</span> <span class='link_text identifier id'>link_text</span><span class='comma token'>,</span> <span class='last_char identifier id'>last_char</span> <span class='assign token'>=</span> <span class='$~ gvar id'>$~</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>4</span><span class='rbrack token'>]</span>
      <span class='if if kw'>if</span> <span class='preceding_char identifier id'>preceding_char</span> <span class='eq op'>==</span> <span class='string val'>'\\'</span>
        <span class='comment val'># the bracket is escaped and so we should ignore</span>
        <span class='all identifier id'>all</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='string val'>'\\['</span><span class='comma token'>,</span> <span class='string val'>'['</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='string val'>'\\]'</span><span class='comma token'>,</span> <span class='string val'>']'</span><span class='rparen token'>)</span>
      <span class='elsif elsif kw'>elsif</span> <span class='first_char identifier id'>first_char</span> <span class='eq op'>==</span> <span class='string val'>'#'</span> <span class='and and kw'>and</span> <span class='last_char identifier id'>last_char</span> <span class='eq op'>==</span> <span class='string val'>'#'</span>
        <span class='comment val'># make this a named anchor tag, instead of a link</span>
        <span class='label identifier id'>label</span><span class='comma token'>,</span> <span class='anchor identifier id'>anchor</span> <span class='assign token'>=</span> <span class='link_text identifier id'>link_text</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/\s*-&gt;\s*/</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
        <span class='anchor identifier id'>anchor</span> <span class='opasgn op'>||=</span> <span class='label identifier id'>label</span>
        <span class='a_tag identifier id'>a_tag</span> <span class='assign token'>=</span> <span class='string val'>'&lt;a name=&quot;%s&quot;&gt;%s&lt;/a&gt;'</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='anchor identifier id'>anchor</span><span class='dot token'>.</span><span class='nameize identifier id'>nameize</span><span class='comma token'>,</span> <span class='htmlesc identifier id'>htmlesc</span><span class='lparen token'>(</span><span class='label identifier id'>label</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span><span class='rparen token'>)</span><span class='rbrack token'>]</span>
        <span class='all identifier id'>all</span> <span class='assign token'>=</span> <span class='all identifier id'>all</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='dregexp node'>/^#{Regexp.escape(preceding_char)}/</span><span class='comma token'>,</span><span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='preceding_char identifier id'>preceding_char</span> <span class='plus op'>+</span> <span class='offtag_it identifier id'>offtag_it</span><span class='lparen token'>(</span><span class='a_tag identifier id'>a_tag</span><span class='comma token'>,</span> <span class='all identifier id'>all</span><span class='rparen token'>)</span>
      <span class='elsif elsif kw'>elsif</span> <span class='first_char identifier id'>first_char</span> <span class='eq op'>==</span> <span class='last_char identifier id'>last_char</span> <span class='and and kw'>and</span> <span class='first_char identifier id'>first_char</span> <span class='match op'>=~</span> <span class='BRACKET_FORMATTERS constant id'>BRACKET_FORMATTERS</span>
        <span class='comment val'># the brackets are for wiki formatting, not links</span>
        <span class='all identifier id'>all</span>
      <span class='else else kw'>else</span>
        <span class='comment val'># we got an actual bracket style link!</span>
        <span class='a_tag identifier id'>a_tag</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span> <span class='comment val'># the eventual &lt;a&gt; tag</span>
        <span class='link_text identifier id'>link_text</span> <span class='assign token'>=</span> <span class='first_char identifier id'>first_char</span> <span class='plus op'>+</span> <span class='link_text identifier id'>link_text</span> <span class='plus op'>+</span> <span class='last_char identifier id'>last_char</span>
        <span class='if if kw'>if</span> <span class='link_text identifier id'>link_text</span> <span class='match op'>=~</span> <span class='regexp val'>/^.+\s*-&gt;\s*.+$/</span>
          <span class='comment val'># link_text == &quot;from -&gt; to&quot;</span>
          <span class='from identifier id'>from</span><span class='comma token'>,</span> <span class='to identifier id'>to</span> <span class='assign token'>=</span> <span class='link_text identifier id'>link_text</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/\s*-&gt;\s*/</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
          <span class='from identifier id'>from</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='from identifier id'>from</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='comment val'># \ sanity check for </span>
          <span class='to identifier id'>to</span>   <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='from identifier id'>from</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='comment val'># / badly formed links</span>
        <span class='else else kw'>else</span>
          <span class='comment val'># link_text == &quot;to&quot; (ie, no link label)</span>
          <span class='from identifier id'>from</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
          <span class='to identifier id'>to</span> <span class='assign token'>=</span> <span class='link_text identifier id'>link_text</span>
        <span class='end end kw'>end</span>
        <span class='if if kw'>if</span> <span class='to identifier id'>to</span> <span class='match op'>=~</span> <span class='dregexp node'>/^(\/|#{PROTOCOL}:\/\/)/</span>
          <span class='comment val'># the link is a fully formed url or an absolute path, eg: </span>
          <span class='comment val'># to == https://riseup.net</span>
          <span class='comment val'># to == /an/absolute/path</span>
          <span class='from identifier id'>from</span> <span class='opasgn op'>||=</span> <span class='to identifier id'>to</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='dregexp node'>/(^#{PROTOCOL}:\/\/|^\/|\/$)/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
          <span class='comment val'># the link is a wiki style link, eg</span>
          <span class='comment val'># to == &quot;context_name / page_name&quot;</span>
          <span class='comment val'># to == &quot;page_name&quot;</span>
          <span class='context_name identifier id'>context_name</span><span class='comma token'>,</span> <span class='page_name identifier id'>page_name</span> <span class='assign token'>=</span> <span class='to identifier id'>to</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/[ ]*\/[ ]*/</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
          <span class='unless unless kw'>unless</span> <span class='page_name identifier id'>page_name</span>
            <span class='comment val'># there was no context indicated, so context_name is really the page_name</span>
            <span class='page_name identifier id'>page_name</span> <span class='assign token'>=</span> <span class='context_name identifier id'>context_name</span>
            <span class='context_name identifier id'>context_name</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
          <span class='end end kw'>end</span>
          <span class='if if kw'>if</span> <span class='page_name identifier id'>page_name</span> <span class='match op'>=~</span> <span class='regexp val'>/#/</span>
            <span class='comment val'># handle link to anchor</span>
            <span class='if if kw'>if</span> <span class='page_name identifier id'>page_name</span> <span class='match op'>=~</span> <span class='regexp val'>/^#/</span>
              <span class='comment val'># relative anchor on this page</span>
              <span class='page_name identifier id'>page_name</span> <span class='assign token'>=</span> <span class='page_name identifier id'>page_name</span><span class='lbrack token'>[</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='comment val'># chomp first char</span>
              <span class='from identifier id'>from</span> <span class='opasgn op'>||=</span> <span class='page_name identifier id'>page_name</span><span class='dot token'>.</span><span class='denameize identifier id'>denameize</span>
              <span class='a_tag identifier id'>a_tag</span> <span class='assign token'>=</span> <span class='string val'>'&lt;a href=&quot;#%s&quot;&gt;%s&lt;/a&gt;'</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='page_name identifier id'>page_name</span><span class='dot token'>.</span><span class='nameize identifier id'>nameize</span><span class='comma token'>,</span> <span class='htmlesc identifier id'>htmlesc</span><span class='lparen token'>(</span><span class='from identifier id'>from</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span><span class='rparen token'>)</span><span class='rbrack token'>]</span>
            <span class='else else kw'>else</span>
              <span class='page_name identifier id'>page_name</span> <span class='assign token'>=</span> <span class='page_name identifier id'>page_name</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/#(.*)$/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
              <span class='anchor identifier id'>anchor</span> <span class='assign token'>=</span> <span class='string val'>'#'</span> <span class='plus op'>+</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='nameize identifier id'>nameize</span> <span class='if if_mod kw'>if</span> <span class='$1 nth_ref id'>$1</span>  <span class='comment val'># everything after the # in the link.</span>
            <span class='end end kw'>end</span>
          <span class='else else kw'>else</span>
            <span class='anchor identifier id'>anchor</span> <span class='assign token'>=</span> <span class='string val'>''</span>
          <span class='end end kw'>end</span>
          <span class='if if kw'>if</span> <span class='@block ivar id'>@block</span> <span class='and and kw'>and</span> <span class='a_tag identifier id'>a_tag</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
            <span class='a_tag identifier id'>a_tag</span> <span class='assign token'>=</span> <span class='@block ivar id'>@block</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='symbol val'>:label</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='from identifier id'>from</span><span class='comma token'>,</span> <span class='symbol val'>:context</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='context_name identifier id'>context_name</span><span class='comma token'>,</span> <span class='symbol val'>:page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='page_name identifier id'>page_name</span><span class='comma token'>,</span> <span class='symbol val'>:anchor</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='anchor identifier id'>anchor</span><span class='rparen token'>)</span>
          <span class='end end kw'>end</span>
          <span class='unless unless kw'>unless</span> <span class='a_tag identifier id'>a_tag</span>
            <span class='from identifier id'>from</span> <span class='opasgn op'>||=</span> <span class='page_name identifier id'>page_name</span><span class='dot token'>.</span><span class='nameized? fid id'>nameized?</span> <span class='integer val'>? </span><span class='page_name identifier id'>page_name</span><span class='dot token'>.</span><span class='denameize identifier id'>denameize</span> <span class='colon op'>:</span> <span class='page_name identifier id'>page_name</span>
            <span class='context_name identifier id'>context_name</span> <span class='opasgn op'>||=</span> <span class='@default_owner ivar id'>@default_owner</span>
            <span class='to identifier id'>to</span> <span class='assign token'>=</span> <span class='string val'>'/%s/%s%s'</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='context_name identifier id'>context_name</span><span class='dot token'>.</span><span class='nameize identifier id'>nameize</span><span class='comma token'>,</span> <span class='page_name identifier id'>page_name</span><span class='dot token'>.</span><span class='nameize identifier id'>nameize</span><span class='comma token'>,</span> <span class='anchor identifier id'>anchor</span><span class='rbrack token'>]</span>
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
        <span class='a_tag identifier id'>a_tag</span> <span class='opasgn op'>||=</span> <span class='string val'>'&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;'</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='htmlesc identifier id'>htmlesc</span><span class='lparen token'>(</span><span class='to identifier id'>to</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='htmlesc identifier id'>htmlesc</span><span class='lparen token'>(</span><span class='from identifier id'>from</span><span class='rparen token'>)</span><span class='rbrack token'>]</span>
        <span class='all identifier id'>all</span> <span class='assign token'>=</span> <span class='all identifier id'>all</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='dregexp node'>/^#{Regexp.escape(preceding_char)}/</span><span class='comma token'>,</span><span class='string val'>''</span><span class='rparen token'>)</span>
        <span class='preceding_char identifier id'>preceding_char</span> <span class='plus op'>+</span> <span class='offtag_it identifier id'>offtag_it</span><span class='lparen token'>(</span><span class='a_tag identifier id'>a_tag</span><span class='comma token'>,</span> <span class='all identifier id'>all</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='exc identifier id'>exc</span>
      <span class='comment val'># something horribly wrong has happened</span>
      <span class='a_tag identifier id'>a_tag</span> <span class='assign token'>=</span> <span class='string val'>'&lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;'</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span><span class='string val'>&quot;#error&quot;</span><span class='comma token'>,</span><span class='from identifier id'>from</span><span class='rbrack token'>]</span>
      <span class='comment val'>#comment = '&lt;!-- %s --&gt;' % exc.to_s</span>
      <span class='preceding_char identifier id'>preceding_char</span> <span class='plus op'>+</span> <span class='offtag_it identifier id'>offtag_it</span><span class='lparen token'>(</span><span class='a_tag identifier id'>a_tag</span><span class='comma token'>,</span> <span class='all identifier id'>all</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>codetitle</h3>
</div><div id="codetitle-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>codetitle</span><span class='args'>(opts)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
this is called automatically when line starts with &quot;codetitle.&quot;
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 396</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L396">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">396
397
398</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='codetitle identifier id'>codetitle</span><span class='lparen token'>(</span><span class='opts identifier id'>opts</span><span class='rparen token'>)</span>
  <span class='string val'>%(&lt;div class=&quot;codetitle&quot;&gt;%s&lt;/div&gt;\n)</span> <span class='mod op'>%</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='symbol val'>:text</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_leading_whitespace</h3>
</div><div id="delete_leading_whitespace-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_leading_whitespace</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
why is this needed?
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 377</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L377">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">377
378
379</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_leading_whitespace identifier id'>delete_leading_whitespace</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A */</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>dynamic_symbols</h3>
</div><div id="dynamic_symbols-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>dynamic_symbols</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 685</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L685">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">685
686
687
688
689
690</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='dynamic_symbols identifier id'>dynamic_symbols</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='DYNAMIC_SYMBOLS_RE constant id'>DYNAMIC_SYMBOLS_RE</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='line identifier id'>line</span><span class='bitor op'>|</span>
    <span class='symbol identifier id'>symbol</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
    <span class='string val'>&quot;\n&quot;</span> <span class='plus op'>+</span> <span class='offtag_it identifier id'>offtag_it</span><span class='lparen token'>(</span><span class='string val'>'ignored'</span><span class='comma token'>,</span> <span class='line identifier id'>line</span><span class='comma token'>,</span> <span class='symbol identifier id'>symbol</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>extract_headings</h3>
</div><div id="extract_headings-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>extract_headings</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
populates @headings, and then restores the string to its original form.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 341</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L341">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">341
342
343
344
345
346
347</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='extract_headings identifier id'>extract_headings</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='extend identifier id'>extend</span><span class='lparen token'>(</span><span class='GreenClothFormatterHTML constant id'>GreenClothFormatterHTML</span><span class='rparen token'>)</span>
  <span class='original identifier id'>original</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='apply_rules identifier id'>apply_rules</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:normalize_heading_blocks</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='to identifier id'>to</span><span class='lparen token'>(</span><span class='GreenClothFormatterHTML constant id'>GreenClothFormatterHTML</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='replace identifier id'>replace</span><span class='lparen token'>(</span><span class='original identifier id'>original</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>extract_offtags</h3>
</div><div id="extract_offtags-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>extract_offtags</span><span class='args'>(html)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 479</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L479">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">479
480
481
482
483
484
485
486
487
488
489
490
491</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='extract_offtags identifier id'>extract_offtags</span><span class='lparen token'>(</span><span class='html identifier id'>html</span><span class='rparen token'>)</span>
  <span class='html identifier id'>html</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='OFFTAG_RE constant id'>OFFTAG_RE</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='m identifier id'>m</span><span class='bitor op'>|</span>
    <span class='offtag identifier id'>offtag</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='offtags identifier id'>offtags</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
    <span class='if if kw'>if</span> <span class='offtag identifier id'>offtag</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
      <span class='comment val'># there is a dynamic symbol for this offtag</span>
      <span class='method identifier id'>method</span> <span class='assign token'>=</span> <span class='string val'>'symbol_'</span><span class='plus op'>+</span><span class='offtag identifier id'>offtag</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span>
      <span class='self self kw'>self</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='method identifier id'>method</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='method identifier id'>method</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='offtag identifier id'>offtag</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='comment val'># replace offtag with the corresponding entry</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='html identifier id'>html</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>flush_left</h3>
</div><div id="flush_left-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>flush_left</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 441</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L441">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">441
442
443
444
445
446
447
448
449
450
451</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='flush_left identifier id'>flush_left</span><span class='lparen token'>(</span> <span class='text identifier id'>text</span> <span class='rparen token'>)</span>
  <span class='indt identifier id'>indt</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='if if kw'>if</span> <span class='text identifier id'>text</span> <span class='match op'>=~</span> <span class='regexp val'>/^ /</span>
     <span class='while while kw'>while</span> <span class='text identifier id'>text</span> <span class='nmatch op'>!~</span> <span class='dregexp node'>/^ {#{indt}}\S/</span>
        <span class='indt identifier id'>indt</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
     <span class='end end kw'>end</span> <span class='unless unless_mod kw'>unless</span> <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
     <span class='if if kw'>if</span> <span class='indt identifier id'>indt</span><span class='dot token'>.</span><span class='nonzero? fid id'>nonzero?</span>
       <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span> <span class='dregexp node'>/^ {#{indt}}/</span><span class='comma token'>,</span> <span class='string val'>''</span> <span class='rparen token'>)</span>
     <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>format_block_code</h3>
</div><div id="format_block_code-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>format_block_code</span><span class='args'>(tag, body, leading_character = '')</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 413</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L413">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">413
414
415
416
417
418
419
420
421
422
423
424</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='format_block_code identifier id'>format_block_code</span><span class='lparen token'>(</span><span class='tag identifier id'>tag</span><span class='comma token'>,</span> <span class='body identifier id'>body</span><span class='comma token'>,</span> <span class='leading_character identifier id'>leading_character</span><span class='assign token'>=</span><span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='body identifier id'>body</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='formatter identifier id'>formatter</span><span class='dot token'>.</span><span class='html_esc identifier id'>html_esc</span><span class='lparen token'>(</span><span class='body identifier id'>body</span><span class='comma token'>,</span> <span class='symbol val'>:html_escape_preformatted</span><span class='rparen token'>)</span>
  <span class='body identifier id'>body</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/\A\r?\n/</span><span class='comma token'>,</span><span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='comment val'># ^^^ get ride of leading returns. This makes it so the text in</span>
  <span class='comment val'># &lt;pre&gt; doesn't appear in the browser with an empty first line.</span>
  <span class='offtag identifier id'>offtag</span> <span class='assign token'>=</span> <span class='offtag_it identifier id'>offtag_it</span><span class='lparen token'>(</span><span class='body identifier id'>body</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='tag identifier id'>tag</span> <span class='eq op'>==</span> <span class='string val'>'&lt;pre&gt;'</span> <span class='or or kw'>or</span> <span class='lparen token'>(</span><span class='leading_character identifier id'>leading_character</span><span class='dot token'>.</span><span class='any? fid id'>any?</span> <span class='and and kw'>and</span> <span class='leading_character! fid id'>leading_character!</span><span class='assign token'>=</span><span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span>
    <span class='dstring node'>&quot;#{tag}#{offtag}#{tag.sub('&lt;','&lt;/')}&quot;</span>
  <span class='else else kw'>else</span>      
    <span class='dstring node'>&quot;&lt;pre&gt;&lt;code&gt;#{offtag}&lt;/code&gt;&lt;/pre&gt;&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>initialize_copy</h3>
</div><div id="initialize_copy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize_copy</span><span class='args'>(arg)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
RedCloth calls clone of the GreenCloth object before extending the object
with the formatter. We want to be able to reference the original object (so
we can keep an offtags list)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 316</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L316">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">316
317
318
319
320</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize_copy identifier id'>initialize_copy</span><span class='lparen token'>(</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='super super kw'>super</span><span class='lparen token'>(</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='original identifier id'>original</span> <span class='assign token'>=</span> <span class='arg identifier id'>arg</span>
  <span class='arg identifier id'>arg</span><span class='dot token'>.</span><span class='formatter identifier id'>formatter</span> <span class='assign token'>=</span> <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>normalize_code_blocks</h3>
</div><div id="normalize_code_blocks-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>normalize_code_blocks</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
convert greencloth specific markup for code blocks into redcloth standard
markup.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 383</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L383">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">383
384
385
386
387
388
389
390
391
392
393</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='normalize_code_blocks identifier id'>normalize_code_blocks</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='comment val'>## make funky code blocks behave like a normal code block.</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/^\/--( .*)?\s*$/</span><span class='comma token'>,</span> <span class='string val'>'&lt;code\1&gt;'</span><span class='rparen token'>)</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/^\\--\s*$/</span><span class='comma token'>,</span> <span class='string val'>'&lt;/code&gt;'</span><span class='rparen token'>)</span>

  <span class='comment val'>## convert &lt;code title&gt; to &quot;codetitle. title\n\n&lt;code&gt;&quot;</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/^&lt;code ([^&gt;]+)&gt;\s*$/</span><span class='comma token'>,</span> <span class='string val'>&quot;codetitle. \\1\n\n&lt;code&gt;&quot;</span><span class='rparen token'>)</span>

  <span class='comment val'>## make @@ be just like &quot;bc.&quot;</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/^@@\s/</span><span class='comma token'>,</span> <span class='string val'>'bc. '</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>normalize_heading_blocks</h3>
</div><div id="normalize_heading_blocks-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>normalize_heading_blocks</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 369</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L369">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">369
370
371
372
373
374</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='normalize_heading_blocks identifier id'>normalize_heading_blocks</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='HEADINGS_RE constant id'>HEADINGS_RE</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='tag identifier id'>tag</span> <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span><span class='eq op'>==</span><span class='string val'>&quot;=&quot;</span> <span class='question op'>?</span> <span class='string val'>&quot;h1&quot;</span> <span class='colon op'>:</span> <span class='string val'>&quot;h2&quot;</span>
    <span class='dstring node'>&quot;#{ tag }. #{$1}\n\n&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>offtag_it</h3>
</div><div id="offtag_it-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>offtag_it</span><span class='args'>(text, original = '', symbol = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
why }{ instead of {}? so offtags will work with tables. text: the text to
offtag original: the original raw text before transformation. we keep it in
case
</p>
<pre class="code">
          <span class='we identifier id'>we</span> <span class='need identifier id'>need</span> <span class='to identifier id'>to</span> <span class='undo identifier id'>undo</span> <span class='the identifier id'>the</span> <span class='offtagging identifier id'>offtagging</span> <span class='for for kw'>for</span> <span class='a identifier id'>a</span> <span class='particular identifier id'>particular</span> <span class='block identifier id'>block</span><span class='dot token'>.</span>
</pre>
<p>
symbol: if set, when extracting this offtag, we use a callback instead of
the text.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 472</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L472">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">472
473
474
475
476
477
478</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='offtag_it identifier id'>offtag_it</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='comma token'>,</span> <span class='original identifier id'>original</span><span class='assign token'>=</span><span class='string val'>''</span><span class='comma token'>,</span> <span class='symbol identifier id'>symbol</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='@count ivar id'>@count</span> <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
  <span class='@offtags ivar id'>@offtags</span> <span class='opasgn op'>||=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@count ivar id'>@count</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
  <span class='@offtags ivar id'>@offtags</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='text identifier id'>text</span><span class='comma token'>,</span> <span class='original identifier id'>original</span><span class='comma token'>,</span> <span class='symbol identifier id'>symbol</span><span class='rbrack token'>]</span>
  <span class='string val'>'}offtag#%s{'</span> <span class='mod op'>%</span> <span class='@count ivar id'>@count</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>offtag_obvious_code_blocks</h3>
</div><div id="offtag_obvious_code_blocks-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>offtag_obvious_code_blocks</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 403</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L403">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">403
404
405
406
407
408
409
410
411</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='offtag_obvious_code_blocks identifier id'>offtag_obvious_code_blocks</span><span class='lparen token'>(</span> <span class='text identifier id'>text</span> <span class='rparen token'>)</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span> <span class='CODE_TAG_RE constant id'>CODE_TAG_RE</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='line identifier id'>line</span><span class='bitor op'>|</span>
    <span class='leading_character identifier id'>leading_character</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span>
    <span class='tag identifier id'>tag</span>        <span class='assign token'>=</span> <span class='$2 nth_ref id'>$2</span>  <span class='comment val'># eg '&lt;code&gt;'</span>
    <span class='codebody identifier id'>codebody</span>   <span class='assign token'>=</span> <span class='$4 nth_ref id'>$4</span>  <span class='comment val'># what is between &lt;code&gt; and &lt;/code&gt;</span>
    <span class='tag identifier id'>tag</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/&lt;(.+)? (.*)&gt;/</span><span class='comma token'>,</span><span class='string val'>'&lt;\\1&gt;'</span><span class='rparen token'>)</span> <span class='comment val'># prevent &lt;code onmouseover='something nasty'&gt;</span>
    <span class='leading_character identifier id'>leading_character</span> <span class='plus op'>+</span> <span class='format_block_code identifier id'>format_block_code</span><span class='lparen token'>(</span><span class='tag identifier id'>tag</span><span class='comma token'>,</span> <span class='codebody identifier id'>codebody</span><span class='comma token'>,</span> <span class='leading_character identifier id'>leading_character</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>quoted_block</h3>
</div><div id="quoted_block-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>quoted_block</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 433</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L433">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">433
434
435
436
437
438
439</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='quoted_block identifier id'>quoted_block</span><span class='lparen token'>(</span> <span class='text identifier id'>text</span> <span class='rparen token'>)</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span> <span class='QUOTED_BLOCK_RE constant id'>QUOTED_BLOCK_RE</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='blk identifier id'>blk</span><span class='bitor op'>|</span>
    <span class='blk identifier id'>blk</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/^&gt; ?/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
    <span class='flush_left identifier id'>flush_left</span> <span class='blk identifier id'>blk</span>
    <span class='dstring node'>&quot;&lt;blockquote&gt;#{blk}&lt;/blockquote&gt;\n&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>revert_offtags</h3>
</div><div id="revert_offtags-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>revert_offtags</span><span class='args'>(html)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
replace offtag with the original text
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 494</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L494">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">494
495
496
497
498
499
500</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='revert_offtags identifier id'>revert_offtags</span><span class='lparen token'>(</span><span class='html identifier id'>html</span><span class='rparen token'>)</span>
  <span class='html identifier id'>html</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='OFFTAG_RE constant id'>OFFTAG_RE</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='m identifier id'>m</span><span class='bitor op'>|</span>
    <span class='comment val'>#puts m.inspect; puts self.offtags</span>
    <span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='offtags identifier id'>offtags</span><span class='lbrack token'>[</span><span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span> 
  <span class='end end kw'>end</span>
  <span class='html identifier id'>html</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>tables_with_tabs</h3>
</div><div id="tables_with_tabs-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>tables_with_tabs</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 454</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L454">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">454
455
456
457
458</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='tables_with_tabs identifier id'>tables_with_tabs</span><span class='lparen token'>(</span> <span class='text identifier id'>text</span> <span class='rparen token'>)</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span> <span class='TABLE_TABS_RE constant id'>TABLE_TABS_RE</span> <span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='row identifier id'>row</span><span class='bitor op'>|</span>
    <span class='row identifier id'>row</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span> <span class='regexp val'>/\t/</span><span class='comma token'>,</span> <span class='string val'>'|'</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_html</h3>
</div><div id="to_html-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_html</span><span class='args'>(*before_filters, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 322</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L322">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_html identifier id'>to_html</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='before_filters identifier id'>before_filters</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='@block ivar id'>@block</span> <span class='assign token'>=</span> <span class='block identifier id'>block</span>

  <span class='before_filters identifier id'>before_filters</span> <span class='opasgn op'>+=</span> <span class='lbrack token'>[</span><span class='symbol val'>:delete_leading_whitespace</span><span class='comma token'>,</span> <span class='symbol val'>:normalize_code_blocks</span><span class='comma token'>,</span>
    <span class='symbol val'>:offtag_obvious_code_blocks</span><span class='comma token'>,</span> <span class='symbol val'>:dynamic_symbols</span><span class='comma token'>,</span> <span class='symbol val'>:bracket_links</span><span class='comma token'>,</span> <span class='symbol val'>:auto_links</span><span class='comma token'>,</span>
    <span class='symbol val'>:normalize_heading_blocks</span><span class='comma token'>,</span> <span class='symbol val'>:quoted_block</span><span class='comma token'>,</span> <span class='symbol val'>:tables_with_tabs</span><span class='comma token'>,</span> <span class='symbol val'>:wrap_long_words</span><span class='rbrack token'>]</span>
 
  <span class='formatter identifier id'>formatter</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='clone identifier id'>clone</span><span class='lparen token'>(</span><span class='rparen token'>)</span>                   <span class='comment val'># \  in case one of the before filters</span>
  <span class='formatter identifier id'>formatter</span><span class='dot token'>.</span><span class='extend identifier id'>extend</span><span class='lparen token'>(</span><span class='GreenClothFormatterHTML constant id'>GreenClothFormatterHTML</span><span class='rparen token'>)</span>  <span class='comment val'># /  needs the formatter.</span>

  <span class='apply_rules identifier id'>apply_rules</span><span class='lparen token'>(</span><span class='before_filters identifier id'>before_filters</span><span class='rparen token'>)</span>
  <span class='html identifier id'>html</span> <span class='assign token'>=</span> <span class='to identifier id'>to</span><span class='lparen token'>(</span><span class='GreenClothFormatterHTML constant id'>GreenClothFormatterHTML</span><span class='rparen token'>)</span>

  <span class='extract_offtags identifier id'>extract_offtags</span><span class='lparen token'>(</span><span class='html identifier id'>html</span><span class='rparen token'>)</span>

  <span class='return return kw'>return</span> <span class='html identifier id'>html</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>wrap_long_words</h3>
</div><div id="wrap_long_words-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>wrap_long_words</span><span class='args'>(text)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/greencloth/greencloth.rb', line 665</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/collective/crabgrass/blob/d5ca62efc4e95fa5c92c788fb8b16d4f01717896/lib/greencloth/greencloth.rb#L665">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">665
666
667
668
669
670
671
672
673
674</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='wrap_long_words identifier id'>wrap_long_words</span><span class='lparen token'>(</span><span class='text identifier id'>text</span><span class='rparen token'>)</span>
  <span class='comment val'># &lt;wbr/&gt; is a soft wrap tag, noting where a break may occur.</span>
  <span class='comment val'># unfortunately, it is not supported in all browsers.</span>
  <span class='text identifier id'>text</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='LONG_WORDS_RE constant id'>LONG_WORDS_RE</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='word identifier id'>word</span><span class='bitor op'>|</span>
    <span class='chopped identifier id'>chopped</span> <span class='assign token'>=</span> <span class='word identifier id'>word</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='dregexp node'>/.{#{LONG_WORD_CHAR_MAX}}/</span><span class='rparen token'>)</span>
    <span class='offtag identifier id'>offtag</span> <span class='assign token'>=</span> <span class='offtag_it identifier id'>offtag_it</span><span class='lparen token'>(</span><span class='string val'>&quot;&lt;wbr/&gt;&lt;span class='break'&gt; &lt;/span&gt;&quot;</span><span class='rparen token'>)</span>
    <span class='remainder identifier id'>remainder</span> <span class='assign token'>=</span> <span class='word identifier id'>word</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='dregexp node'>/.{#{LONG_WORD_CHAR_MAX}}/</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='select identifier id'>select</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='str identifier id'>str</span><span class='bitor op'>|</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='any? fid id'>any?</span><span class='rbrace token'>}</span>
    <span class='lparen token'>(</span><span class='chopped identifier id'>chopped</span> <span class='plus op'>+</span> <span class='remainder identifier id'>remainder</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='offtag identifier id'>offtag</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>