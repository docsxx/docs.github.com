<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: CouchRest::Callbacks::Callback</title>
  </head>
  <body>
    <div id="content">
      <div class="section class CouchRest_Callbacks_Callback">
  <h1 class="title">Class: CouchRest::Callbacks::Callback</h1>
  <div class="section inheritance">
  <ul>
  <li><a href='../../Object.html' title='Object'>Object</a></li><ul><li>CouchRest::Callbacks::Callback</li>
  </ul></ul>
</div><div class="section attributes">
  <h1>Attributes</h1>

  
    <div class="instance">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">filter</td>
          <td class="readwrite">
            [<span id='filter-instance_method'>R</span><span id='filter%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>filter</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">kind</td>
          <td class="readwrite">
            [<span id='kind-instance_method'>R</span><span id='kind%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>kind</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">klass</td>
          <td class="readwrite">
            [<span id='klass-instance_method'>R</span><span id='klass%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>klass</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">name</td>
          <td class="readwrite">
            [<span id='name-instance_method'>R</span><span id='name%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>name</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">options</td>
          <td class="readwrite">
            [<span id='options-instance_method'>R</span><span id='options%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>options</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">per_key</td>
          <td class="readwrite">
            [<span id='per_key-instance_method'>R</span><span id='per_key%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>per_key</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div><div class="section constructor">
<h1>Constructor Summary</h1>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(filter, kind, options, klass, name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


97
98
99
100
101
102
103
104
105
106
107
108
109
110</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 97</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='filter identifier id'>filter</span><span class='comma token'>,</span> <span class='kind identifier id'>kind</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='klass identifier id'>klass</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='@kind ivar id'>@kind</span><span class='comma token'>,</span> <span class='@klass ivar id'>@klass</span> <span class='assign token'>=</span> <span class='kind identifier id'>kind</span><span class='comma token'>,</span> <span class='klass identifier id'>klass</span>
  <span class='@name ivar id'>@name</span>         <span class='assign token'>=</span> <span class='name identifier id'>name</span>
  
  <span class='normalize_options! fid id'>normalize_options!</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>

  <span class='@per_key ivar id'>@per_key</span>              <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:per_key</span><span class='rparen token'>)</span>
  <span class='@raw_filter ivar id'>@raw_filter</span><span class='comma token'>,</span> <span class='@options ivar id'>@options</span> <span class='assign token'>=</span> <span class='filter identifier id'>filter</span><span class='comma token'>,</span> <span class='options identifier id'>options</span>
  <span class='@filter ivar id'>@filter</span>               <span class='assign token'>=</span> <span class='_compile_filter identifier id'>_compile_filter</span><span class='lparen token'>(</span><span class='filter identifier id'>filter</span><span class='rparen token'>)</span>
  <span class='@compiled_options ivar id'>@compiled_options</span>     <span class='assign token'>=</span> <span class='_compile_options identifier id'>_compile_options</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='@callback_id ivar id'>@callback_id</span>          <span class='assign token'>=</span> <span class='next_id identifier id'>next_id</span>

  <span class='_compile_per_key_options identifier id'>_compile_per_key_options</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#_compile_per_key_options-instance_method' title='#_compile_per_key_options'>#_compile_per_key_options</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#_update_filter-instance_method' title='#_update_filter'>#_update_filter</a></span><span class='args'>(filter_options, new_options)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#clone-instance_method' title='#clone'>#clone</a></span><span class='args'>(klass)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#end-instance_method' title='#end'>#end</a></span><span class='args'>(key = nil, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
This will supply contents for around and after filters, but not before
filters (for the backward pass).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#matches%3F-instance_method' title='#matches?'>#matches?</a></span><span class='args'>(_kind, _name, _filter)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#next_id-instance_method' title='#next_id'>#next_id</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#normalize_options%21-instance_method' title='#normalize_options!'>#normalize_options!</a></span><span class='args'>(options)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#recompile%21-instance_method' title='#recompile!'>#recompile!</a></span><span class='args'>(_options, _per_key)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#start-instance_method' title='#start'>#start</a></span><span class='args'>(key = nil, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
This will supply contents for before and around filters, and no contents
for after filters (for the forward pass).
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h1>Public Instance Methods Inherited from <a href='../../Object.html' title='Object'>Object</a></h1>
    <p><span class='name'><a href='../../Object.html#blank%3F-instance_method' title='blank?'>blank?</a></span>, <span class='name'><a href='../../Object.html#validatable%3F-instance_method' title='validatable?'>validatable?</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>_compile_per_key_options</h3>
</div><div id="_compile_per_key_options-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_compile_per_key_options</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


158
159
160
161
162</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 158</span>

<span class='def def kw'>def</span> <span class='_compile_per_key_options identifier id'>_compile_per_key_options</span>
  <span class='key_options identifier id'>key_options</span>  <span class='assign token'>=</span> <span class='_compile_options identifier id'>_compile_options</span><span class='lparen token'>(</span><span class='@per_key ivar id'>@per_key</span><span class='rparen token'>)</span>

  <span class='@klass ivar id'>@klass</span><span class='dot token'>.</span><span class='class_eval identifier id'>class_eval</span> <span class='string val'>&quot;def _one_time_conditions_valid_\#{@callback_id}?\ntrue \#{key_options[0]}\nend\n&quot;</span><span class='comma token'>,</span> <span class='__FILE__ __file__ kw'>__FILE__</span><span class='comma token'>,</span> <span class='__LINE__ __line__ kw'>__LINE__</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_update_filter</h3>
</div><div id="_update_filter-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_update_filter</span><span class='args'>(filter_options, new_options)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


143
144
145
146</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 143</span>

<span class='def def kw'>def</span> <span class='_update_filter identifier id'>_update_filter</span><span class='lparen token'>(</span><span class='filter_options identifier id'>filter_options</span><span class='comma token'>,</span> <span class='new_options identifier id'>new_options</span><span class='rparen token'>)</span>
  <span class='filter_options identifier id'>filter_options</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span><span class='new_options identifier id'>new_options</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='new_options identifier id'>new_options</span><span class='dot token'>.</span><span class='key? fid id'>key?</span><span class='lparen token'>(</span><span class='symbol val'>:unless</span><span class='rparen token'>)</span>
  <span class='filter_options identifier id'>filter_options</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='push identifier id'>push</span><span class='lparen token'>(</span><span class='new_options identifier id'>new_options</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='new_options identifier id'>new_options</span><span class='dot token'>.</span><span class='key? fid id'>key?</span><span class='lparen token'>(</span><span class='symbol val'>:if</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>clone</h3>
</div><div id="clone-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>clone</span><span class='args'>(klass)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


112
113
114
115
116
117
118
119
120
121
122</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 112</span>

<span class='def def kw'>def</span> <span class='clone identifier id'>clone</span><span class='lparen token'>(</span><span class='klass identifier id'>klass</span><span class='rparen token'>)</span>
  <span class='obj identifier id'>obj</span>                  <span class='assign token'>=</span> <span class='super super kw'>super</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
  <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='klass identifier id'>klass</span>            <span class='assign token'>=</span> <span class='klass identifier id'>klass</span>
  <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='per_key identifier id'>per_key</span>          <span class='assign token'>=</span> <span class='@per_key ivar id'>@per_key</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='options identifier id'>options</span>          <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='per_key identifier id'>per_key</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span>     <span class='assign token'>=</span> <span class='@per_key ivar id'>@per_key</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='per_key identifier id'>per_key</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='@per_key ivar id'>@per_key</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span>     <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='obj identifier id'>obj</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>end</h3>
</div><div id="end-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>end</span><span class='args'>(key = nil, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
This will supply contents for around and after filters, but not before
filters (for the backward pass).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


231</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 231</span>

<span class='def def kw'>def</span> <span class='end end kw'>end</span><span class='lparen token'>(</span><span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>matches?</h3>
</div><div id="matches%3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>matches?</span><span class='args'>(_kind, _name, _filter)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


137
138
139
140
141</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 137</span>

<span class='def def kw'>def</span> <span class='matches? fid id'>matches?</span><span class='lparen token'>(</span><span class='_kind identifier id'>_kind</span><span class='comma token'>,</span> <span class='_name identifier id'>_name</span><span class='comma token'>,</span> <span class='_filter identifier id'>_filter</span><span class='rparen token'>)</span>
  <span class='@kind ivar id'>@kind</span>   <span class='eq op'>==</span> <span class='_kind identifier id'>_kind</span> <span class='andop op'>&amp;&amp;</span>
  <span class='@name ivar id'>@name</span>   <span class='eq op'>==</span> <span class='_name identifier id'>_name</span> <span class='andop op'>&amp;&amp;</span>
  <span class='@filter ivar id'>@filter</span> <span class='eq op'>==</span> <span class='_filter identifier id'>_filter</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>next_id</h3>
</div><div id="next_id-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>next_id</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


133
134
135</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 133</span>

<span class='def def kw'>def</span> <span class='next_id identifier id'>next_id</span>
  <span class='@@_callback_sequence ivar id'>@@_callback_sequence</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>normalize_options!</h3>
</div><div id="normalize_options%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>normalize_options!</span><span class='args'>(options)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


124
125
126
127
128
129
130
131</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 124</span>

<span class='def def kw'>def</span> <span class='normalize_options! fid id'>normalize_options!</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:per_key</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:per_key</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:per_key</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:if</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:per_key</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:per_key</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:unless</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>recompile!</h3>
</div><div id="recompile%21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>recompile!</span><span class='args'>(_options, _per_key)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


148
149
150
151
152
153
154
155
156</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 148</span>

<span class='def def kw'>def</span> <span class='recompile! fid id'>recompile!</span><span class='lparen token'>(</span><span class='_options identifier id'>_options</span><span class='comma token'>,</span> <span class='_per_key identifier id'>_per_key</span><span class='rparen token'>)</span>
  <span class='_update_filter identifier id'>_update_filter</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='_options identifier id'>_options</span><span class='rparen token'>)</span>
  <span class='_update_filter identifier id'>_update_filter</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='per_key identifier id'>per_key</span><span class='comma token'>,</span> <span class='_per_key identifier id'>_per_key</span><span class='rparen token'>)</span>
  
  <span class='@callback_id ivar id'>@callback_id</span>      <span class='assign token'>=</span> <span class='next_id identifier id'>next_id</span>
  <span class='@filter ivar id'>@filter</span>           <span class='assign token'>=</span> <span class='_compile_filter identifier id'>_compile_filter</span><span class='lparen token'>(</span><span class='@raw_filter ivar id'>@raw_filter</span><span class='rparen token'>)</span>
  <span class='@compiled_options ivar id'>@compiled_options</span> <span class='assign token'>=</span> <span class='_compile_options identifier id'>_compile_options</span><span class='lparen token'>(</span><span class='@options ivar id'>@options</span><span class='rparen token'>)</span>
                      <span class='_compile_per_key_options identifier id'>_compile_per_key_options</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>start</h3>
</div><div id="start-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>start</span><span class='args'>(key = nil, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
This will supply contents for before and around filters, and no contents
for after filters (for the forward pass).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/couchrest/mixins/callbacks.rb', line 171</span>

<span class='def def kw'>def</span> <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='object identifier id'>object</span><span class='comma token'>,</span> <span class='terminator identifier id'>terminator</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='values_at identifier id'>values_at</span><span class='lparen token'>(</span><span class='symbol val'>:object</span><span class='comma token'>,</span> <span class='symbol val'>:terminator</span><span class='rparen token'>)</span>
  
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='key identifier id'>key</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='object identifier id'>object</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='dstring node'>&quot;_one_time_conditions_valid_#{@callback_id}?&quot;</span><span class='rparen token'>)</span>
  
  <span class='terminator identifier id'>terminator</span> <span class='opasgn op'>||=</span> <span class='false false kw'>false</span>
  
  <span class='comment val'># options[0] is the compiled form of supplied conditions</span>
  <span class='comment val'># options[1] is the &quot;end&quot; for the conditional</span>
          
  <span class='if if kw'>if</span> <span class='@kind ivar id'>@kind</span> <span class='eq op'>==</span> <span class='colon op'>:</span><span class='before identifier id'>before</span> <span class='orop op'>||</span> <span class='@kind ivar id'>@kind</span> <span class='eq op'>==</span> <span class='colon op'>:</span><span class='around identifier id'>around</span>
    <span class='if if kw'>if</span> <span class='@kind ivar id'>@kind</span> <span class='eq op'>==</span> <span class='colon op'>:</span><span class='before identifier id'>before</span>
      <span class='comment val'># if condition    # before_save :filter_name, :if =&gt; :condition</span>
      <span class='comment val'>#   filter_name</span>
      <span class='comment val'># end</span>
      <span class='filter identifier id'>filter</span> <span class='assign token'>=</span> <span class='string val'>&quot;unless halted\nresult = \#{@filter}\nhalted ||= (\#{terminator})\nend\n&quot;</span>
      <span class='lbrack token'>[</span><span class='@compiled_options ivar id'>@compiled_options</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='filter identifier id'>filter</span><span class='comma token'>,</span> <span class='@compiled_options ivar id'>@compiled_options</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='comment val'># Compile around filters with conditions into proxy methods</span>
      <span class='comment val'># that contain the conditions.</span>
      <span class='comment val'>#</span>
      <span class='comment val'># For `around_save :filter_name, :if =&gt; :condition':</span>
      <span class='comment val'>#</span>
      <span class='comment val'># def _conditional_callback_save_17</span>
      <span class='comment val'>#   if condition</span>
      <span class='comment val'>#     filter_name do</span>
      <span class='comment val'>#       yield self</span>
      <span class='comment val'>#     end</span>
      <span class='comment val'>#   else</span>
      <span class='comment val'>#     yield self</span>
      <span class='comment val'>#   end</span>
      <span class='comment val'># end</span>
      
      <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;_conditional_callback_#{@kind}_#{next_id}&quot;</span>
      <span class='txt identifier id'>txt</span> <span class='assign token'>=</span> <span class='string val'>&quot;def \#{name}(halted)\n\#{@compiled_options[0] || \&quot;if true\&quot;} &amp;&amp; !halted\n\#{@filter} do\nyield self\nend\nelse\nyield self\nend\nend\n&quot;</span>
      <span class='@klass ivar id'>@klass</span><span class='dot token'>.</span><span class='class_eval identifier id'>class_eval</span><span class='lparen token'>(</span><span class='txt identifier id'>txt</span><span class='rparen token'>)</span>
      <span class='dstring node'>&quot;#{name}(halted) do&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>