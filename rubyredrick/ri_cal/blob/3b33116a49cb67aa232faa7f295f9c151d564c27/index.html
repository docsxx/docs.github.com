<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>rubyredrick's ri_cal - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/rubyredrick/commits/ri_cal/master" rel="alternate" title="Recent Commits to ri_cal:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("rubyredrick", "ri_cal", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='rubyredrick/ri_cal/blob/3b33116a49cb67aa232faa7f295f9c151d564c27' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='rubyredrick/ri_cal/blob/3b33116a49cb67aa232faa7f295f9c151d564c27' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("rubyredrick", "ri_cal", "3b33116a49cb67aa232faa7f295f9c151d564c27", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/rubyredrick/ri_cal/tree/">Source</a></li>
            <li class=""><a href="http://github.com/rubyredrick/ri_cal/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/rubyredrick/ri_cal/network">Network</a></li>            
            <li class=""><a href="http://github.com/rubyredrick/ri_cal/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/rubyredrick/ri_cal">Wiki</a></li>
            <li class=""><a href="http://github.com/rubyredrick/ri_cal/graphs">Graphs</a></li>                    
            <li class="active"><a href="/rubyredrick/ri_cal">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/rubyredrick">rubyredrick</a> / <b><a href="http://github.com/rubyredrick/ri_cal/tree">ri_cal</a></b>        
                <a id="namespaces_button" rel="rubyredrick/ri_cal/blob/3b33116a49cb67aa232faa7f295f9c151d564c27" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="rubyredrick/ri_cal/blob/3b33116a49cb67aa232faa7f295f9c151d564c27" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h2>RI_CAL &#8212; a new implementation of RFC2445 in Ruby</h2>
<p>
http://ri-cal.rubyforge.org/
</p>
<pre class="code">
    <span class='by identifier id'>by</span> <span class='Rick constant id'>Rick</span> <span class='DeNatale constant id'>DeNatale</span>
</pre>
<h2>DESCRIPTION:</h2>
<p>
A new Ruby implementation of RFC2445 iCalendar.
</p>
<p>
The existing Ruby iCalendar libraries (e.g. icalendar, vpim) provide for
parsing and generating icalendar files, but do not support important things
like enumerating occurrences of repeating events.
</p>
<p>
This is a clean-slate implementation of RFC2445.
</p>
<p>
A Google group for discussion of this library has been set up
http://groups.google.com/group/rical_gem
</p>
<h2>FEATURES/PROBLEMS:</h2>
<ul>
<li>All examples of recurring events in RFC 2445 are handled. RSpec examples
are provided for them.

</li>
</ul>
<h2>SYNOPSIS:</h2>
<h3>Components and properties</h3>
<p>
An iCalendar calendar comprises subcomponents like Events, Timezones and
Todos. Each component may have properties, for example an event has a
dtstart property which defines the time (and date) on which the event
starts.
</p>
<p>
RiCal components will provide reasonable ruby objects as the values of
these properties, and allow the properties to be set to ruby objects which
are reasonable for the particular property. For example time properties
like dtstart can be set to a ruby Time, DateTime or Date object, and will
return a DateTime or Date object when queried.
</p>
<p>
The methods for accessing the properties of each type of component are
defined in a module with the same name as the component class in the
RiCal::properties module. For example the property accessing methods for
RiCal::Component::Event are defined in RiCal::Properties::Event
</p>
<h3>Creating Calendars and Calendar Components</h3>
<p>
RiCal provides a builder DSL for creating calendars and calendar
components. An example
</p>
<pre class="code">
  <span class='RiCal constant id'>RiCal</span><span class='dot token'>.</span><span class='Calendar constant id'>Calendar</span> <span class='do do kw'>do</span>
    <span class='event identifier id'>event</span> <span class='do do kw'>do</span>
      <span class='description identifier id'>description</span> <span class='string val'>&quot;MA-6 First US Manned Spaceflight&quot;</span>
      <span class='dtstart identifier id'>dtstart</span>     <span class='DateTime constant id'>DateTime</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='string val'>&quot;2/20/1962 14:47:39&quot;</span><span class='rparen token'>)</span>
      <span class='dtend identifier id'>dtend</span>       <span class='DateTime constant id'>DateTime</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='string val'>&quot;2/20/1962 19:43:02&quot;</span><span class='rparen token'>)</span>
      <span class='location identifier id'>location</span>    <span class='string val'>&quot;Cape Canaveral&quot;</span>
      <span class='add_attendee identifier id'>add_attendee</span> <span class='string val'>&quot;john.glenn@nasa.gov&quot;</span>
      <span class='alarm identifier id'>alarm</span> <span class='do do kw'>do</span>
        <span class='description identifier id'>description</span> <span class='string val'>&quot;Segment 51&quot;</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
This style is for compatibility with the iCalendar and vpim to ease
migration. The downside is that the block is evaluated in the context of a
different object which can cause surprises if the block contains direct
instance variable references or implicit references to self. Note that, in
this style, one must use &#8216;declarative&#8217; method calls like
dtstart to set values rather than more natural attribute writer methods,
like dtstart=
</p>
<p>
Alternatively you can pass a block with a single argument, in this case the
component being built will be passed as that argument
</p>
<pre class="code">
  <span class='RiCal constant id'>RiCal</span><span class='dot token'>.</span><span class='Calendar constant id'>Calendar</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='cal identifier id'>cal</span><span class='bitor op'>|</span>
    <span class='cal identifier id'>cal</span><span class='dot token'>.</span><span class='event identifier id'>event</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='event identifier id'>event</span><span class='bitor op'>|</span>
      <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='description identifier id'>description</span> <span class='assign token'>=</span> <span class='string val'>&quot;MA-6 First US Manned Spaceflight&quot;</span>
      <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='dtstart identifier id'>dtstart</span> <span class='assign token'>=</span>  <span class='DateTime constant id'>DateTime</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='string val'>&quot;2/20/1962 14:47:39&quot;</span><span class='rparen token'>)</span>
      <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='dtend identifier id'>dtend</span> <span class='assign token'>=</span> <span class='DateTime constant id'>DateTime</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='string val'>&quot;2/20/1962 19:43:02&quot;</span><span class='rparen token'>)</span>
      <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='location identifier id'>location</span> <span class='assign token'>=</span> <span class='string val'>&quot;Cape Canaveral&quot;</span>
      <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='add_attendee identifier id'>add_attendee</span> <span class='string val'>&quot;john.glenn@nasa.gov&quot;</span>
      <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='alarm identifier id'>alarm</span> <span class='do do kw'>do</span>
        <span class='description identifier id'>description</span> <span class='string val'>&quot;Segment 51&quot;</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
As the example shows, the two styles can be mixed, the inner block which
builds the alarm uses the first style.
</p>
<p>
The blocks are evaluated in the context of an object which builds the
calendar or calendar component. method names starting with add_ or remove_
are sent to the component, method names which correspond to a property
value setter of the object being built will cause that setter to be sent to
the component with the provided value.
</p>
<p>
A method corresponding to the name of one of the components sub component
will create the sub component and evaluate a block if given in the context
of the new subcomponent.
</p>
<h4>Multiply occurring properties</h4>
<p>
Certain RFC Components have properties which may be specified multiple
times, for example, an Event may have zero or more comment properties, A
component will have a family of methods for building/manipulating such a
property, e.g.
</p>
<table>
<tr><td valign="top">Event#comment:</td><td>will return an array of comment strings.

</td></tr>
<tr><td valign="top">Event#comment=:</td><td>takes a single comment string and gives the event a single comment
property, replacing any existing comment property collection.

</td></tr>
<tr><td valign="top">Event#comments=:</td><td>takes multiple comment string arguments and gives the event a comment
property for each, replacing any existing comment property collection.

</td></tr>
<tr><td valign="top">Event#add_comment:</td><td>takes a single comment string argument and adds a comment property.

</td></tr>
<tr><td valign="top">Event#add_comments:</td><td>takes multiple comment string arguments and adds a comment property for
each.

</td></tr>
<tr><td valign="top">Event#remove_comment:</td><td>takes a single comment string argument and removes an existing comment
property with that value.

</td></tr>
<tr><td valign="top">Event#remove_comments:</td><td>takes multiple comment string argument and removes an existing comment
property with that value.

</td></tr>
</table>
<h4>Times, Time zones, and Floating Times</h4>
<p>
RFC2445 describes three different kinds of DATE-TIME values with respect to
time zones:
</p>
<pre class="code">
  <span class='float val'>1</span><span class='dot token'>.</span> <span class='date identifier id'>date</span><span class='minus op'>-</span><span class='times identifier id'>times</span> <span class='with identifier id'>with</span> <span class='a identifier id'>a</span> <span class='local identifier id'>local</span> <span class='time identifier id'>time</span><span class='dot token'>.</span> <span class='These constant id'>These</span> <span class='have identifier id'>have</span> <span class='no identifier id'>no</span> <span class='actual identifier id'>actual</span> <span class='time identifier id'>time</span> <span class='zone identifier id'>zone</span><span class='comma token'>,</span> <span class='instead identifier id'>instead</span> <span class='they identifier id'>they</span> <span class='are identifier id'>are</span> <span class='to identifier id'>to</span> <span class='be identifier id'>be</span>
     <span class='interpreted identifier id'>interpreted</span> <span class='in in kw'>in</span> <span class='the identifier id'>the</span> <span class='local identifier id'>local</span> <span class='time identifier id'>time</span> <span class='zone identifier id'>zone</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='viewer identifier id'>viewer</span><span class='dot token'>.</span>  <span class='These constant id'>These</span> <span class='floating identifier id'>floating</span> <span class='times identifier id'>times</span> <span class='are identifier id'>are</span> <span class='used identifier id'>used</span> <span class='for for kw'>for</span> <span class='things identifier id'>things</span>
     <span class='like identifier id'>like</span> <span class='the identifier id'>the</span> <span class='New constant id'>New</span> <span class='Years constant id'>Years</span> <span class='celebration identifier id'>celebration</span> <span class='which identifier id'>which</span> <span class='is identifier id'>is</span> <span class='observed identifier id'>observed</span> <span class='at identifier id'>at</span> <span class='local identifier id'>local</span> <span class='midnight identifier id'>midnight</span> <span class='whether identifier id'>whether</span> <span class='you identifier id'>you</span> <span class='happen identifier id'>happen</span> <span class='to identifier id'>to</span> <span class='be identifier id'>be</span>
     <span class='in in kw'>in</span> <span class='Paris constant id'>Paris</span><span class='comma token'>,</span> <span class='London constant id'>London</span><span class='comma token'>,</span> <span class='or or kw'>or</span> <span class='New constant id'>New</span> <span class='York constant id'>York</span><span class='dot token'>.</span>

  <span class='float val'>2</span><span class='dot token'>.</span> <span class='date identifier id'>date</span><span class='minus op'>-</span><span class='times identifier id'>times</span> <span class='with identifier id'>with</span> <span class='UTC constant id'>UTC</span> <span class='time identifier id'>time</span><span class='dot token'>.</span>  <span class='An constant id'>An</span> <span class='application identifier id'>application</span> <span class='would identifier id'>would</span> <span class='either identifier id'>either</span> <span class='display identifier id'>display</span> <span class='these identifier id'>these</span> <span class='with identifier id'>with</span> <span class='an identifier id'>an</span> <span class='indication identifier id'>indication</span> <span class='of identifier id'>of</span>
     <span class='the identifier id'>the</span> <span class='time identifier id'>time</span> <span class='zone identifier id'>zone</span><span class='comma token'>,</span> <span class='or or kw'>or</span> <span class='convert identifier id'>convert</span> <span class='them identifier id'>them</span> <span class='to identifier id'>to</span> <span class='the identifier id'>the</span> <span class='viewer identifier id'>viewer</span><span class='string val'>'s time zone, perhaps depending on user settings.

  3. date-times with a specified time zone.
</span></pre>
<p>
RiCal can be given ruby Time, DateTime, or Date objects for the value of
properties requiring an iCalendar DATE-TIME value. It can also be given a
string
</p>
<p>
Note that a date only DATE-TIME value has no time zone by definition,
effectively such values float and describe a date as viewed by the user in
his/her local time zone.
</p>
<p>
When a Ruby Time or DateTime instance is used to set properties with with a
DATE-TIME value, it needs to determine which of the three types it
represents. RiCal is designed to make use of the TimeWithZone support which
has been part of the ActiveSupport component of Ruby on Rails since Rails
2.2. However it&#8217;s been carefully designed not to require Rails or
ActiveSupport, but to dynamically detect the presence of the TimeWithZone
support.
</p>
<p>
RiCal adds accessor methods for a tzid attribute to the Ruby Time, and
DateTime classes as well as a set_tzid method which sets the tzid attribute
and returns the receiver for convenience in building calendars. If
ActiveSupport::TimeWithZone is defined, a tzid instance method is defined
which returns the identifier of the time zone.
</p>
<p>
When the value of a DATE-TIME property is set to a value, the following
processing occurs:
</p>
<pre class="code">
  <span class='mult op'>*</span> <span class='If constant id'>If</span> <span class='the identifier id'>the</span> <span class='value identifier id'>value</span> <span class='is identifier id'>is</span> <span class='a identifier id'>a</span> <span class='string identifier id'>string</span><span class='comma token'>,</span> <span class='then then kw'>then</span> <span class='it identifier id'>it</span> <span class='must identifier id'>must</span> <span class='be identifier id'>be</span> <span class='a identifier id'>a</span> <span class='valid identifier id'>valid</span> <span class='rfc identifier id'>rfc</span> <span class='integer val'>2445</span> <span class='date identifier id'>date</span> <span class='or or kw'>or</span> <span class='datetime identifier id'>datetime</span> <span class='string identifier id'>string</span> <span class='optionally identifier id'>optionally</span>
    <span class='preceded identifier id'>preceded</span> <span class='by identifier id'>by</span> <span class='a identifier id'>a</span> <span class='parameter identifier id'>parameter</span> <span class='specification identifier id'>specification</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='g identifier id'>g</span>

    <span class='string val'>&quot;20010911&quot;</span>  <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='interpreted identifier id'>interpreted</span> <span class='as identifier id'>as</span> <span class='a identifier id'>a</span> <span class='date identifier id'>date</span>

    <span class='string val'>&quot;20090530T123000Z&quot;</span>  <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='interpreted identifier id'>interpreted</span> <span class='as identifier id'>as</span> <span class='the identifier id'>the</span> <span class='time identifier id'>time</span> <span class='May constant id'>May</span> <span class='integer val'>30</span><span class='comma token'>,</span> <span class='integer val'>2009</span> <span class='at identifier id'>at</span> <span class='integer val'>12</span><span class='symbol val'>:30</span><span class='symbol val'>:00</span> <span class='UTC constant id'>UTC</span>

    <span class='string val'>&quot;20090530T123000&quot;</span>  <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='interpreted identifier id'>interpreted</span> <span class='as identifier id'>as</span> <span class='the identifier id'>the</span> <span class='time identifier id'>time</span> <span class='May constant id'>May</span> <span class='integer val'>30</span><span class='comma token'>,</span> <span class='integer val'>2009</span> <span class='with identifier id'>with</span> <span class='a identifier id'>a</span> <span class='floating identifier id'>floating</span> <span class='time identifier id'>time</span> <span class='zone identifier id'>zone</span>

    <span class='string val'>&quot;TZID=America/New_York:20090530T123000&quot;</span>  <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='interpreted identifier id'>interpreted</span> <span class='as identifier id'>as</span> <span class='the identifier id'>the</span> <span class='time identifier id'>time</span> <span class='May constant id'>May</span> <span class='integer val'>30</span><span class='comma token'>,</span> <span class='integer val'>2009</span> <span class='in in kw'>in</span> <span class='the identifier id'>the</span> <span class='time identifier id'>time</span> <span class='zone identifier id'>zone</span> <span class='identified identifier id'>identified</span> <span class='by identifier id'>by</span> <span class='string val'>&quot;America/New_York&quot;</span>

  <span class='mult op'>*</span> <span class='If constant id'>If</span> <span class='the identifier id'>the</span> <span class='value identifier id'>value</span> <span class='is identifier id'>is</span> <span class='a identifier id'>a</span> <span class='Date constant id'>Date</span> <span class='it identifier id'>it</span> <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='interpreted identifier id'>interpreted</span> <span class='as identifier id'>as</span> <span class='that identifier id'>that</span> <span class='date identifier id'>date</span>
  <span class='mult op'>*</span> <span class='If constant id'>If</span> <span class='the identifier id'>the</span> <span class='value identifier id'>value</span> <span class='is identifier id'>is</span> <span class='a identifier id'>a</span> <span class='Time constant id'>Time</span><span class='comma token'>,</span> <span class='DateTime constant id'>DateTime</span><span class='comma token'>,</span> <span class='or or kw'>or</span> <span class='TimeWithZone constant id'>TimeWithZone</span> <span class='then then kw'>then</span> <span class='the identifier id'>the</span> <span class='tzid identifier id'>tzid</span> <span class='attribute identifier id'>attribute</span> <span class='will identifier id'>will</span> <span class='determine identifier id'>determine</span> <span class='the identifier id'>the</span>
    <span class='time identifier id'>time</span> <span class='zone identifier id'>zone</span><span class='dot token'>.</span> <span class='If constant id'>If</span> <span class='tzid identifier id'>tzid</span> <span class='returns identifier id'>returns</span> <span class='nil nil kw'>nil</span> <span class='then then kw'>then</span> <span class='the identifier id'>the</span> <span class='default identifier id'>default</span> <span class='tzid identifier id'>tzid</span> <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='used identifier id'>used</span><span class='dot token'>.</span>
</pre>
<h4>Default TZID</h4>
<p>
The PropertyValue::DateTime class has a default_tzid attribute which is
initialized to &quot;UTC&quot;.
</p>
<p>
The Component::Calendar class also has a default_tzid attribute, which may
be set, but if it is not set the default_tzid of the
PropertyValue::DateTime class will be used.
</p>
<p>
To set the interpreting of Times and DateTimes which have no tzid as
floating times, set the default_tzid for Component::Calendar and/or
PropertyValue::DateTime to :floating.
</p>
<p>
Also note that time zone identifiers are not standardized by RFC 2445. For
an RiCal originated calendar time zone identifiers recognized by the TZInfo
gem, or the TZInfo implementation provided by ActiveSupport as the case may
be may be used. The valid time zone identifiers for a non-RiCal generated
calendar imported into RiCalendar are determined by the VTIMEZONE compoents
within the imported calendar.
</p>
<p>
If you use a timezone identifer within a calendar which is not defined
within the calendar it will detected at the time you try to convert a
timezone. In this case an InvalidTimezoneIdentifier error will be raised by
the conversion method.
</p>
<p>
To explicitly set a floating time you can use the method
#with_floating_timezone on Time or DateTime instances as in
</p>
<pre class="code">
   <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='dtstart identifier id'>dtstart</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='string val'>&quot;1/1/2010 00:00:00&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='with_floating_timezone identifier id'>with_floating_timezone</span>
</pre>
<p>
or the equivalent
</p>
<p>
event.dtstart = Time.parse(&quot;1/1/2010
00:00:00&quot;).set_tzid(:floating)
</p>
<h3>RiCal produced Calendars and Tzinfo</h3>
<p>
Calendars created by the RiCal Builder DSL use TZInfo as a source of time
zone definition information. RFC 2445 does not specify standard names for
time zones, so each time zone identifier (tzid) within an icalendar data
stream must correspond to a VTIMEZONE component in that data stream.
</p>
<p>
When an RiCal calendar is exported to an icalendar data stream, the needed
VTIMEZONE components will be generated. In addition a parameter is added to
the PRODID property of the calendar which identifies that the source of
tzids is tzinfo. For purposes of this documentation such a calendar is
called a tzinfo calendar.
</p>
<p>
When RiCal imports an icalendar data stream produced by another library or
application, such as Apple&#8217;s ical.app, or Google mail, it will be
recognized as not being a non-tzinfo calendar, and any tzids will be
resolved using the included VTIMEZONEs. Note that these calendars may well
use tzids which are not recognizable by the tzinfo gem or by the similar
code provided by ActiveSupport, so care is needed in using them.
</p>
<h3>Ruby values of DATETIME properties</h3>
<p>
The result of accessing the value of a DATETIME property (e.g.
event.dtstart) depends on several factors:
</p>
<pre class="code">
 <span class='mult op'>*</span> <span class='If constant id'>If</span> <span class='the identifier id'>the</span> <span class='property identifier id'>property</span> <span class='has identifier id'>has</span> <span class='a identifier id'>a</span> <span class='DATE constant id'>DATE</span> <span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='then then kw'>then</span> <span class='the identifier id'>the</span> <span class='result identifier id'>result</span> <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='a identifier id'>a</span> <span class='Ruby constant id'>Ruby</span> <span class='Date constant id'>Date</span> <span class='object identifier id'>object</span><span class='dot token'>.</span>

 <span class='mult op'>*</span> <span class='Otherwise constant id'>Otherwise</span><span class='comma token'>,</span> <span class='if if kw'>if</span> <span class='the identifier id'>the</span> <span class='property identifier id'>property</span> <span class='has identifier id'>has</span> <span class='a identifier id'>a</span> <span class='DATETIME constant id'>DATETIME</span> <span class='value identifier id'>value</span> <span class='with identifier id'>with</span> <span class='a identifier id'>a</span> <span class='floating identifier id'>floating</span> <span class='timezone identifier id'>timezone</span><span class='comma token'>,</span> <span class='then then kw'>then</span> <span class='the identifier id'>the</span> <span class='result identifier id'>result</span> <span class='will identifier id'>will</span>
   <span class='be identifier id'>be</span> <span class='a identifier id'>a</span> <span class='Ruby constant id'>Ruby</span> <span class='DateTime constant id'>DateTime</span> <span class='object identifier id'>object</span><span class='comma token'>,</span> <span class='the identifier id'>the</span> <span class='tzid identifier id'>tzid</span> <span class='attribute identifier id'>attribute</span> <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='set identifier id'>set</span> <span class='to identifier id'>to</span> <span class='symbol val'>:floating</span><span class='comma token'>,</span> <span class='and and kw'>and</span> <span class='will identifier id'>will</span> <span class='respond identifier id'>respond</span>
   <span class='truthily identifier id'>truthily</span> <span class='to identifier id'>to</span> <span class='has_floating_timezone? fid id'>has_floating_timezone?</span>

 <span class='mult op'>*</span> <span class='Otherwise constant id'>Otherwise</span> <span class='if if_mod kw'>if</span> <span class='the identifier id'>the</span> <span class='value identifier id'>value</span> <span class='is identifier id'>is</span> <span class='attached identifier id'>attached</span> <span class='to identifier id'>to</span> <span class='a identifier id'>a</span> <span class='property identifier id'>property</span> <span class='contained identifier id'>contained</span> <span class='in in kw'>in</span> <span class='a identifier id'>a</span> <span class='non identifier id'>non</span><span class='minus op'>-</span><span class='tzinfo identifier id'>tzinfo</span> <span class='calendar identifier id'>calendar</span><span class='comma token'>,</span> <span class='or or kw'>or</span> <span class='if if kw'>if</span> <span class='the identifier id'>the</span>
   <span class='ActiveSupport constant id'>ActiveSupport</span> <span class='gem identifier id'>gem</span> <span class='is identifier id'>is</span> <span class='not not kw'>not</span> <span class='loaded identifier id'>loaded</span><span class='comma token'>,</span> <span class='then then kw'>then</span> <span class='the identifier id'>the</span> <span class='result identifier id'>result</span> <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='a identifier id'>a</span> <span class='Ruby constant id'>Ruby</span> <span class='DateTime constant id'>DateTime</span> <span class='object identifier id'>object</span><span class='comma token'>,</span> <span class='with identifier id'>with</span> <span class='the identifier id'>the</span> <span class='proper identifier id'>proper</span>
   <span class='offset identifier id'>offset</span> <span class='from identifier id'>from</span> <span class='UTC constant id'>UTC</span><span class='comma token'>,</span> <span class='and and kw'>and</span> <span class='with identifier id'>with</span> <span class='the identifier id'>the</span> <span class='tzid identifier id'>tzid</span> <span class='property identifier id'>property</span> <span class='set identifier id'>set</span><span class='dot token'>.</span>

 <span class='mult op'>*</span> <span class='Finally constant id'>Finally</span><span class='comma token'>,</span> <span class='if if kw'>if</span> <span class='the identifier id'>the</span> <span class='value identifier id'>value</span> <span class='is identifier id'>is</span> <span class='attached identifier id'>attached</span> <span class='to identifier id'>to</span> <span class='a identifier id'>a</span> <span class='property identifier id'>property</span> <span class='contained identifier id'>contained</span> <span class='in in kw'>in</span> <span class='a identifier id'>a</span> <span class='tzinfo identifier id'>tzinfo</span> <span class='calendar identifier id'>calendar</span> <span class='and and kw'>and</span> <span class='the identifier id'>the</span>
   <span class='ActiveSupport constant id'>ActiveSupport</span> <span class='gem identifier id'>gem</span> <span class='is identifier id'>is</span> <span class='loaded identifier id'>loaded</span><span class='comma token'>,</span> <span class='then then kw'>then</span> <span class='the identifier id'>the</span> <span class='result identifier id'>result</span> <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='an identifier id'>an</span> <span class='ActiveSupport constant id'>ActiveSupport</span><span class='colon2 op'>::</span><span class='TimeWithZone constant id'>TimeWithZone</span> <span class='with identifier id'>with</span> <span class='the identifier id'>the</span>
   <span class='proper identifier id'>proper</span> <span class='tzid identifier id'>tzid</span><span class='dot token'>.</span>
</pre>
<h4>RDATE, and EXDATE properties (Occurrence Lists)</h4>
<p>
A calendar component which supports recurrence properties (e.g. Event) may
have zero or more RDATE and or EXDATE properties. Each RDATE/EXDATE
property in turn specifies one or more occurrences to be either added to or
removed from the component&#8217;s recurrence list. Each element of the
list may be either a DATE, a DATETIME, or a PERIOD, or the RFC 2445 string
representation of one of these:
</p>
<pre class="code">
  <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='rdate identifier id'>rdate</span> <span class='assign token'>=</span> <span class='string val'>&quot;20090305&quot;</span>
  <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='rdate identifier id'>rdate</span> <span class='assign token'>=</span> <span class='string val'>&quot;20090305T120000&quot;</span>
  <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='rdate identifier id'>rdate</span> <span class='assign token'>=</span> <span class='string val'>&quot;20090305T120000/P1H30M&quot;</span>
</pre>
<p>
It can also have multiple occurrences, specified as multiple parameters:
</p>
<pre class="code">
  <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='rdate identifier id'>rdate</span> <span class='assign token'>=</span> <span class='string val'>&quot;20090305T120000&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;20090405T120000&quot;</span>
  <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='rdate identifier id'>rdate</span> <span class='assign token'>=</span> <span class='DateTime constant id'>DateTime</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='string val'>&quot;12 December, 2005 3:00 pm&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='DateTime constant id'>DateTime</span><span class='dot token'>.</span><span class='civil identifier id'>civil</span><span class='lparen token'>(</span><span class='integer val'>2001</span><span class='comma token'>,</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>15</span><span class='comma token'>,</span> <span class='integer val'>30</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
</pre>
<p>
Multiple string values can be combined separated by commas:
</p>
<pre class="code">
   <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='rdate identifier id'>rdate</span> <span class='assign token'>=</span> <span class='string val'>&quot;20090305T120000,20090405T120000&quot;</span>
</pre>
<p>
An occurrence list has one set of parameters, so only one timezone can be
used, the timezone may be set explicitly via the first argument. If the
first argument is a string, it is first split on commas. Then if the first
segment (up to the first comma if any) is not a valid RFC 2445
representation of a DATE, DATETIME, or PERIOD, then it will be used as the
timezone for the occurrence list. Otherwise the arguments must have the
same time zone or an InvalidPropertyValue error will be raised.
</p>
<h3>Parsing</h3>
<p>
RiCal can parse icalendar data from either a string or a Ruby io object.
</p>
<p>
The data may consist of one or more icalendar calendars, or one or more
icalendar components (e.g. one or more VEVENT, or VTODO objects.)
</p>
<p>
In either case the result will be an array of components.
</p>
<h4>From a string</h4>
<pre class="code">
        <span class='RiCal constant id'>RiCal</span><span class='dot token'>.</span><span class='parse_string identifier id'>parse_string</span> <span class='string val'>&quot;        BEGIN:VCALENDAR\n        X-WR-TIMEZONE:America/New_York\n        PRODID:-//Apple Inc.//iCal 3.0//EN\n        CALSCALE:GREGORIAN\n        X-WR-CALNAME:test\n        VERSION:2.0\n        X-WR-RELCALID:1884C7F8-BC8E-457F-94AC-297871967D5E\n        X-APPLE-CALENDAR-COLOR:#2CA10B\n        BEGIN:VTIMEZONE\n        TZID:US/Eastern\n        BEGIN:DAYLIGHT\n        TZOFFSETFROM:-0500\n        TZOFFSETTO:-0400\n        DTSTART:20070311T020000\n        RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=2SU\n        TZNAME:EDT\n        END:DAYLIGHT\n        BEGIN:STANDARD\n        TZOFFSETFROM:-0400\n        TZOFFSETTO:-0500\n        DTSTART:20071104T020000\n        RRULE:FREQ=YEARLY;BYMONTH=11;BYDAY=1SU\n        TZNAME:EST\n        END:STANDARD\n        END:VTIMEZONE\n        BEGIN:VEVENT\n        SEQUENCE:5\n        TRANSP:OPAQUE\n        UID:00481E53-9258-4EA7-9F8D-947D3041A3F2\n        DTSTART;TZID=US/Eastern:20090224T090000\n        DTSTAMP:20090225T000908Z\n        SUMMARY:Test Event\n        CREATED:20090225T000839Z\n        DTEND;TZID=US/Eastern:20090224T100000\n        RRULE:FREQ=DAILY;INTERVAL=1;UNTIL=20090228T045959Z\n        END:VEVENT\n        END:VCALENDAR\n        ENDCAL\n&quot;</span>
</pre>
<p>
<b>Beware of the initial whitespace in the above example which is for rdoc
formatting.</b> The parser does not strip initial whitespace from lines in
the file and will fail.
</p>
<p>
As already stated the string argument may be a full icalendar format
calendar, or just one or more subcomponents, e.g.
</p>
<p>
RiCal.parse_string(&quot;BEGIN:VEVENT\nDTSTART;TZID=US/Eastern:20090224T090000\nSUMMARY:Test
Event\nDTEND;TZID=US/Eastern:20090224T100000\nRRULE:FREQ=DAILY;INTERVAL=1;UNTIL=20090228T045959Z\nEND:VEVENT&quot;)
</p>
<h4>From an Io</h4>
<pre class="code">
        <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>&quot;path/to/file&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;r&quot;</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='file identifier id'>file</span><span class='bitor op'>|</span>
            <span class='components identifier id'>components</span> <span class='assign token'>=</span> <span class='RiCal constant id'>RiCal</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
</pre>
<h3>Occurrence Enumeration</h3>
<p>
Event, Journal, and Todo components can have recurrences which are defined
following the RFC 2445 specification. A component with recurrences can
enumerate those occurrences.
</p>
<p>
These components have common methods for enumeration which are defined in
the RiCal::OccurrenceEnumerator module.
</p>
<h4>Obtaining an array of occurrences</h4>
<p>
To get an array of occurrences, Use the
RiCal::OccurrenceEnumerator#occurrences method:
</p>
<pre class="code">
        <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='occurrences identifier id'>occurrences</span>
</pre>
<p>
This method may fail with an argument error, if the component has an
unbounded recurrence definition. This happens when one or more of its
RRULES don&#8217;t have a COUNT, or UNTIL part. This may be tested by using
the RiCal::OccurrenceEnumerator#bounded? method.
</p>
<p>
In the case of unbounded components, you must either use the :count, or
:before options of the RiCal::OccurrenceEnumerator#occurrences method:
</p>
<pre class="code">
        <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='occurrences identifier id'>occurrences</span><span class='lparen token'>(</span><span class='symbol val'>:count</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>10</span><span class='rparen token'>)</span>
</pre>
<p>
or
</p>
<pre class="code">
  <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='occurrences identifier id'>occurrences</span><span class='lparen token'>(</span><span class='symbol val'>:before</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Date constant id'>Date</span><span class='dot token'>.</span><span class='today identifier id'>today</span> <span class='rshft op'>&gt;&gt;</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
</pre>
<p>
Alternately, you can use the RiCal::OccurrenceEnumerator#each method, or
another Enumerable method (RiCal::OccurrenceEnumerator includes
Enumerable), and terminate when you wish by breaking out of the block.
</p>
<pre class="code">
        <span class='event identifier id'>event</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='event identifier id'>event</span><span class='bitor op'>|</span>
           <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='some_termination_condition identifier id'>some_termination_condition</span>
           <span class='comment val'>#....</span>
        <span class='end end kw'>end</span>
</pre>
<h2>REQUIREMENTS:</h2>
<ul>
<li>RiCal requires that an implementation of TZInfo::Timezone. This requirement
may be satisfied by either the TzInfo gem,

</li>
</ul>
<p>
or by a recent(&gt;= 2.2) version of the ActiveSupport gem which is part of
Ruby on Rails.
</p>
<h2>INSTALL:</h2>
<h3>From RubyForge</h3>
<pre class="code">
    <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='ri_cal identifier id'>ri_cal</span>
</pre>
<h3>From github</h3>
<h4>As a Gem</h4>
<pre class="code">
    <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='rubyredrick identifier id'>rubyredrick</span><span class='minus op'>-</span><span class='ri_cal identifier id'>ri_cal</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='source identifier id'>source</span> <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/gems.github.com/</span>
</pre>
<h4>From source</h4>
<pre class="code">
    <span class='float val'>1</span><span class='dot token'>.</span> <span class='cd identifier id'>cd</span> <span class='to identifier id'>to</span> <span class='a identifier id'>a</span> <span class='directory identifier id'>directory</span> <span class='in in kw'>in</span> <span class='which identifier id'>which</span> <span class='you identifier id'>you</span> <span class='want identifier id'>want</span> <span class='to identifier id'>to</span> <span class='install identifier id'>install</span> <span class='ri_cal identifier id'>ri_cal</span> <span class='as identifier id'>as</span> <span class='a identifier id'>a</span> <span class='subdirectory identifier id'>subdirectory</span>
    <span class='float val'>2</span><span class='dot token'>.</span> <span class='git identifier id'>git</span> <span class='clone identifier id'>clone</span> <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/github.com/</span><span class='rubyredrick identifier id'>rubyredrick</span><span class='div op'>/</span><span class='ri_cal identifier id'>ri_cal</span>  <span class='your_install_subdirectory identifier id'>your_install_subdirectory</span>
    <span class='float val'>3</span><span class='dot token'>.</span> <span class='cd identifier id'>cd</span> <span class='your_install_directory identifier id'>your_install_directory</span>
    <span class='float val'>4</span><span class='dot token'>.</span> <span class='rake identifier id'>rake</span> <span class='spec identifier id'>spec</span>
    <span class='float val'>5</span><span class='dot token'>.</span> <span class='rake identifier id'>rake</span> <span class='install_gem identifier id'>install_gem</span>
</pre>
<h2>LICENSE:</h2>
<p>
(The MIT License)
</p>
<p>
Copyright &#169; 2009 Richard J. DeNatale
</p>
<p>
Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
&#8216;Software&#8217;), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to the
following conditions:
</p>
<p>
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
</p>
<p>
THE SOFTWARE IS PROVIDED &#8216;AS IS&#8217;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
USE OR OTHER DEALINGS IN THE SOFTWARE.
</p>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>