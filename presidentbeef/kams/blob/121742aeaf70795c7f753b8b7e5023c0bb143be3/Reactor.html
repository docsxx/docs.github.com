<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>presidentbeef's kams - Class: Reactor - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/presidentbeef/commits/kams/master" rel="alternate" title="Recent Commits to kams:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("presidentbeef", "kams", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("presidentbeef", "kams", "121742aeaf70795c7f753b8b7e5023c0bb143be3", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/presidentbeef/kams/tree/">Source</a></li>
            <li class=""><a href="http://github.com/presidentbeef/kams/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/presidentbeef/kams/network">Network</a></li>            
            <li class=""><a href="http://github.com/presidentbeef/kams/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/presidentbeef/kams">Wiki</a></li>
            <li class=""><a href="http://github.com/presidentbeef/kams/graphs">Graphs</a></li>                    
            <li class="active"><a href="/presidentbeef/kams">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/presidentbeef">presidentbeef</a> / <b><a href="http://github.com/presidentbeef/kams/tree">kams</a></b>        
                <a id="namespaces_button" rel="presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Reactor">
  <h1>Class: Reactor</h1>
  <div class="section docstring">
  <p>
The Reactor class is the mechanism by which Mobiles can be scripted. A
reaction is made up of three parts:
</p>
<ul>
<li>The action(s)/commands to which to react

</li>
<li>A test (converts to a Proc) which returns true if the reaction should
occur, false otherwise

</li>
<li>A reaction (converts to a Proc) which will be run if the test is true (and
the return value is run through CommandParser)

</li>
</ul>
<p>
The test and the reaction will be put in a lambda which will be passed the
event and then used with mob.instance_eval:
</p>
<p>
lambda { |event, mob| mob.instance_eval { /* Your code here */ } }
</p>
<p>
A reaction looks something like this: reaction = { :action =&gt; :say,
#action to match
</p>
<pre class="code">
             <span class='symbol val'>:test</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;event[:player].name == 'Bob'&quot;</span><span class='comma token'>,</span> <span class='comment val'>#this gets converted to a Proc and should return a boolean</span>
       <span class='symbol val'>:reaction</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'&quot;say I like Bob!&quot;'</span>  <span class='comment val'>#this gets converted to a Proc and run through a CommandParser as well</span>
  <span class='rbrace token'>}</span>
</pre>
<p>
Action can also be an Array, in which case it will match on any of them:
</p>
<p>
reaction = { :action =&gt; [:hug, :kiss],
</p>
<pre class="code">
       <span class='symbol val'>:test</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;object_is_me? event&quot;</span><span class='comma token'>,</span>
       <span class='symbol val'>:reaction</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'&quot;say Yuck! No snuggly stuff for me!&quot;'</span>
  <span class='rbrace token'>}</span>
</pre>
<p>
Reactions can also be loaded from a plain text file from
objects/reactions/[name].rx
</p>
<p>
The format is the following:
</p>
<p>
#This is a comment (must be at beginning of line) !action &lt;space
separated list of actions to trigger it&gt; !test &lt;test code&gt;
!reaction &lt;reaction code&gt;
</p>
<p>
Example:
</p>
<p>
#This is the same as the reaction above !action hug kiss !test
object_is_me? event !reaction &quot;say Yuck! No snuggly stuff for
me!&quot;
</p>
<p>
There can be multiple reactions per file. !action signals the start of a
new reaction and must be first. !test and !reaction can be in any order and
can be any number of lines.
</p>

</div><div class="section constants">
  
</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(mob)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
This initializes the Reactor, as you might expect
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/reactor.rb', line 53</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3/lib/reactor.rb#L53">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">53
54
55
56</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='mob identifier id'>mob</span><span class='rparen token'>)</span>
  <span class='@mob ivar id'>@mob</span> <span class='assign token'>=</span> <span class='mob identifier id'>mob</span>
  <span class='@reactions ivar id'>@reactions</span> <span class='assign token'>=</span> <span class='Hash constant id'>Hash</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#add-instance_method">#add</span><span class='args'>(reaction)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Adds a single reaction.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#add_all-instance_method">#add_all</span><span class='args'>(reactions)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Adds a bunch of reactions, in some kind of Enumerable.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#clear-instance_method">#clear</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Deletes all of the reactions.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#list_reactions-instance_method">#list_reactions</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns Array of reactions in this Reactor.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#load-instance_method">#load</span><span class='args'>(file)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Loads reaction file from the path objects/reactions/{file}.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#react_to-instance_method">#react_to</span><span class='args'>(event)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Reacts to an event.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_s-instance_method">#to_s</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>add</h3>
</div><div id="add-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add</span><span class='args'>(reaction)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Adds a single reaction
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/reactor.rb', line 117</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3/lib/reactor.rb#L117">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='reaction identifier id'>reaction</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span> <span class='and and kw'>and</span> <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:test</span><span class='rbrack token'>]</span> <span class='and and kw'>and</span> <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:reaction</span><span class='rbrack token'>]</span> <span class='comment val'>#validate</span>
    <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:test</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='RProc constant id'>RProc</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:test</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:reaction</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='RProc constant id'>RProc</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:reaction</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

    <span class='if if kw'>if</span> <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='Enumerable constant id'>Enumerable</span>
      <span class='actions identifier id'>actions</span> <span class='assign token'>=</span> <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span>
    <span class='else else kw'>else</span>
      <span class='actions identifier id'>actions</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
    <span class='end end kw'>end</span>

    <span class='actions identifier id'>actions</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='action identifier id'>action</span><span class='bitor op'>|</span>
      <span class='if if kw'>if</span> <span class='@reactions ivar id'>@reactions</span><span class='lbrack token'>[</span><span class='action identifier id'>action</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
        <span class='@reactions ivar id'>@reactions</span><span class='lbrack token'>[</span><span class='action identifier id'>action</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='reaction identifier id'>reaction</span><span class='rbrack token'>]</span>
      <span class='else else kw'>else</span>
        <span class='@reactions ivar id'>@reactions</span><span class='lbrack token'>[</span><span class='action identifier id'>action</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='reaction identifier id'>reaction</span>
      <span class='end end kw'>end</span>
    <span class='rbrace token'>}</span>
    <span class='log identifier id'>log</span> <span class='dstring node'>&quot;Added #{reaction.inspect}&quot;</span>
  <span class='else else kw'>else</span>
    <span class='log identifier id'>log</span> <span class='dstring node'>&quot;Not accepting reaction: #{reaction.inspect}&quot;</span> <span class='comma token'>,</span> <span class='Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='Ultimate constant id'>Ultimate</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>add_all</h3>
</div><div id="add_all-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_all</span><span class='args'>(reactions)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Adds a bunch of reactions, in some kind of Enumerable
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/reactor.rb', line 110</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3/lib/reactor.rb#L110">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">110
111
112
113
114</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='add_all identifier id'>add_all</span><span class='lparen token'>(</span><span class='reactions identifier id'>reactions</span><span class='rparen token'>)</span>
  <span class='reactions identifier id'>reactions</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='bitor op'>|</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='r identifier id'>r</span><span class='rparen token'>)</span>
  <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>clear</h3>
</div><div id="clear-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>clear</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Deletes all of the reactions.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/reactor.rb', line 200</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3/lib/reactor.rb#L200">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">200
201
202</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='clear identifier id'>clear</span>
  <span class='@reactions ivar id'>@reactions</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>list_reactions</h3>
</div><div id="list_reactions-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>list_reactions</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns Array of reactions in this Reactor.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/reactor.rb', line 185</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3/lib/reactor.rb#L185">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">185
186
187
188
189
190
191
192
193
194
195
196
197</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='list_reactions identifier id'>list_reactions</span>
  <span class='seen identifier id'>seen</span> <span class='assign token'>=</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@reactions ivar id'>@reactions</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span><span class='v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='bitor op'>|</span>
      <span class='if if kw'>if</span> <span class='seen identifier id'>seen</span><span class='dot token'>.</span><span class='include? fid id'>include?</span> <span class='r identifier id'>r</span><span class='dot token'>.</span><span class='object_id identifier id'>object_id</span>
      <span class='else else kw'>else</span>
        <span class='seen identifier id'>seen</span> <span class='lshft op'>&lt;&lt;</span> <span class='r identifier id'>r</span><span class='dot token'>.</span><span class='object_id identifier id'>object_id</span>
        <span class='dstring node'>&quot;Action: #{(r[:action].is_a? Array) ? r[:action].join(&quot;, &quot;) : r[:action] }\nTest: #{r[:test].source}Reaction:\n#{r[:reaction].source}&quot;</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span>
    <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='integer val'>? </span><span class='nil nil kw'>nil</span> <span class='colon op'>:</span> <span class='a identifier id'>a</span>
  <span class='end end kw'>end</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>load</h3>
</div><div id="load-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>load</span><span class='args'>(file)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Loads reaction file from the path objects/reactions/{file}.rx
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/reactor.rb', line 70</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3/lib/reactor.rb#L70">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='load identifier id'>load</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='current_item identifier id'>current_item</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='reaction identifier id'>reaction</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='input identifier id'>input</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='dstring node'>&quot;objects/reactions/#{file}.rx&quot;</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span>
    <span class='until until kw'>until</span> <span class='f identifier id'>f</span><span class='dot token'>.</span><span class='eof? fid id'>eof?</span>
      <span class='input identifier id'>input</span> <span class='assign token'>=</span> <span class='f identifier id'>f</span><span class='dot token'>.</span><span class='gets identifier id'>gets</span>

      <span class='case case kw'>case</span> <span class='input identifier id'>input</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span>
      <span class='when when kw'>when</span> <span class='string val'>&quot;!action&quot;</span>
        <span class='self self kw'>self</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='reaction identifier id'>reaction</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='reaction identifier id'>reaction</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
        <span class='reaction identifier id'>reaction</span> <span class='assign token'>=</span> <span class='blank_reaction identifier id'>blank_reaction</span>
        <span class='current_item identifier id'>current_item</span> <span class='assign token'>=</span> <span class='symbol val'>:action</span>
      <span class='when when kw'>when</span> <span class='string val'>&quot;!test&quot;</span>
        <span class='current_item identifier id'>current_item</span> <span class='assign token'>=</span> <span class='symbol val'>:test</span>
      <span class='when when kw'>when</span> <span class='string val'>&quot;!reaction&quot;</span>
        <span class='current_item identifier id'>current_item</span> <span class='assign token'>=</span> <span class='symbol val'>:reaction</span>
      <span class='when when kw'>when</span> <span class='regexp val'>/^#/</span>
      <span class='when when kw'>when</span> <span class='string val'>&quot;&quot;</span>
      <span class='else else kw'>else</span>
        <span class='if if kw'>if</span> <span class='current_item identifier id'>current_item</span> <span class='eq op'>==</span> <span class='symbol val'>:action</span>
          <span class='actions identifier id'>actions</span> <span class='assign token'>=</span> <span class='input identifier id'>input</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='item identifier id'>item</span><span class='bitor op'>|</span>
            <span class='item identifier id'>item</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span>
          <span class='end end kw'>end</span>
          <span class='if if kw'>if</span> <span class='actions identifier id'>actions</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
            <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='actions identifier id'>actions</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
          <span class='else else kw'>else</span>
            <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='actions identifier id'>actions</span>
          <span class='end end kw'>end</span>
        <span class='else else kw'>else</span>
          <span class='reaction identifier id'>reaction</span><span class='lbrack token'>[</span><span class='current_item identifier id'>current_item</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='input identifier id'>input</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='reaction identifier id'>reaction</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='reaction identifier id'>reaction</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>react_to</h3>
</div><div id="react_to-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>react_to</span><span class='args'>(event)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Reacts to an event
</p>
<p>
All matching reactions will fire. However, conditions are tested before any
actions are executed. Order of executions is nondeterministic.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/reactor.rb', line 145</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3/lib/reactor.rb#L145">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='react_to identifier id'>react_to</span><span class='lparen token'>(</span><span class='event identifier id'>event</span><span class='rparen token'>)</span>
  <span class='log identifier id'>log</span> <span class='dstring node'>&quot;Maybe reacting to #{event}&quot;</span> <span class='comma token'>,</span> <span class='Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='Ultimate constant id'>Ultimate</span>
  <span class='actions identifier id'>actions</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='commands identifier id'>commands</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='player identifier id'>player</span> <span class='assign token'>=</span> <span class='event identifier id'>event</span><span class='lbrack token'>[</span><span class='symbol val'>:player</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='@mob ivar id'>@mob</span>
  <span class='room identifier id'>room</span> <span class='assign token'>=</span> <span class='$manager gvar id'>$manager</span><span class='dot token'>.</span><span class='get_object identifier id'>get_object</span><span class='lparen token'>(</span><span class='@mob ivar id'>@mob</span><span class='dot token'>.</span><span class='room identifier id'>room</span><span class='rparen token'>)</span>
  <span class='begin begin kw'>begin</span>
    <span class='unless unless kw'>unless</span> <span class='@reactions ivar id'>@reactions</span><span class='lbrack token'>[</span><span class='event identifier id'>event</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
      <span class='@reactions ivar id'>@reactions</span><span class='lbrack token'>[</span><span class='event identifier id'>event</span><span class='lbrack token'>[</span><span class='symbol val'>:action</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='r identifier id'>r</span><span class='bitor op'>|</span>
        <span class='if if kw'>if</span> <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='symbol val'>:test</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='event identifier id'>event</span><span class='comma token'>,</span> <span class='player identifier id'>player</span><span class='comma token'>,</span> <span class='room identifier id'>room</span><span class='comma token'>,</span> <span class='@mob ivar id'>@mob</span><span class='rbrack token'>]</span>
          <span class='log identifier id'>log</span> <span class='string val'>&quot;Reacting&quot;</span> <span class='comma token'>,</span> <span class='Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='Ultimate constant id'>Ultimate</span>
          <span class='actions identifier id'>actions</span> <span class='lshft op'>&lt;&lt;</span> <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='symbol val'>:reaction</span><span class='rbrack token'>]</span>
          <span class='comment val'>#break #breaking would mean only one reaction fires, even if many match</span>
        <span class='end end kw'>end</span>
      <span class='rbrace token'>}</span>
      <span class='log identifier id'>log</span> <span class='string val'>&quot;No other tests passed for that action.&quot;</span> <span class='comma token'>,</span> <span class='Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='Ultimate constant id'>Ultimate</span>
    <span class='else else kw'>else</span>
      <span class='log identifier id'>log</span> <span class='string val'>&quot;No reaction for that action.&quot;</span> <span class='comma token'>,</span> <span class='Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='Ultimate constant id'>Ultimate</span>
    <span class='end end kw'>end</span>

    <span class='actions identifier id'>actions</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span>
      <span class='begin begin kw'>begin</span>
        <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='event identifier id'>event</span><span class='comma token'>,</span> <span class='player identifier id'>player</span><span class='comma token'>,</span> <span class='room identifier id'>room</span><span class='comma token'>,</span> <span class='@mob ivar id'>@mob</span><span class='rbrack token'>]</span>
      <span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
        <span class='log identifier id'>log</span> <span class='dstring node'>&quot;Reaction error. #{@mob.name} reacting to #{event[:action]}: #{e.message}&quot;</span>
      <span class='end end kw'>end</span>

      <span class='if if kw'>if</span> <span class='result identifier id'>result</span> <span class='and and kw'>and</span> <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='String constant id'>String</span> <span class='and and kw'>and</span> <span class='result identifier id'>result</span> <span class='neq op'>!=</span> <span class='string val'>&quot;&quot;</span>
        <span class='commands identifier id'>commands</span> <span class='lshft op'>&lt;&lt;</span> <span class='result identifier id'>result</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
    <span class='log identifier id'>log</span> <span class='dstring node'>&quot;#{e.inspect}\n#{e.backtrace.join(&quot;\n&quot;)}&quot;</span>
    <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>

  <span class='commands identifier id'>commands</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_s</h3>
</div><div id="to_s-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_s</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/reactor.rb', line 204</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/presidentbeef/kams/blob/121742aeaf70795c7f753b8b7e5023c0bb143be3/lib/reactor.rb#L204">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">204
205
206</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span>
  <span class='dstring node'>&quot;Reactor (#{@reactions.length} reactions)&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> Â©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>