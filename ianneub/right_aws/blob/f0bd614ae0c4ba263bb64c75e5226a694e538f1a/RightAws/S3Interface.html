<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>ianneub's right_aws - Class: RightAws::S3Interface - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/ianneub/commits/right_aws/master" rel="alternate" title="Recent Commits to right_aws:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("ianneub", "right_aws", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("ianneub", "right_aws", "f0bd614ae0c4ba263bb64c75e5226a694e538f1a", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/ianneub/right_aws/tree/">Source</a></li>
            <li class=""><a href="http://github.com/ianneub/right_aws/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/ianneub/right_aws/network">Network</a></li>            
            <li class=""><a href="http://github.com/ianneub/right_aws/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/ianneub/right_aws">Wiki</a></li>
            <li class=""><a href="http://github.com/ianneub/right_aws/graphs">Graphs</a></li>                    
            <li class="active"><a href="/ianneub/right_aws">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/ianneub">ianneub</a> / <b><a href="http://github.com/ianneub/right_aws/tree">right_aws</a></b>        
                <a id="namespaces_button" rel="ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class RightAws_S3Interface">
  <h1>Class: RightAws::S3Interface</h1>
  <div class="section inheritance">
  <ul>
  <li><a title="RightAws::RightAwsBase" href="RightAwsBase.html">RightAws::RightAwsBase</a></li><ul><li>RightAws::S3Interface</li>
  </ul></ul>
</div><div class="section mixins">
  <h2>Included Modules</h2>
  <p><a title="RightAws::RightAwsBaseInterface" href="S3Interface/RightAwsBaseInterface.html">RightAws::RightAwsBaseInterface</a></p>
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="AMAZON_HEADER_PREFIX-constant">AMAZON_HEADER_PREFIX</dt>
      <dd>'x-amz-'</dd>
    
      <dt id="AMAZON_METADATA_PREFIX-constant">AMAZON_METADATA_PREFIX</dt>
      <dd>'x-amz-meta-'</dd>
    
      <dt id="DEFAULT_EXPIRES_AFTER-constant">DEFAULT_EXPIRES_AFTER</dt>
      <dd>1 * 24 * 60 * 60 </dd>
    
      <dt id="DEFAULT_HOST-constant">DEFAULT_HOST</dt>
      <dd>'s3.amazonaws.com'</dd>
    
      <dt id="DEFAULT_PORT-constant">DEFAULT_PORT</dt>
      <dd>443</dd>
    
      <dt id="DEFAULT_PROTOCOL-constant">DEFAULT_PROTOCOL</dt>
      <dd>'https'</dd>
    
      <dt id="DEFAULT_SERVICE-constant">DEFAULT_SERVICE</dt>
      <dd>'/'</dd>
    
      <dt id="ONE_YEAR_IN_SECONDS-constant">ONE_YEAR_IN_SECONDS</dt>
      <dd>365 * 24 * 60 * 60</dd>
    
      <dt id="REQUEST_TTL-constant">REQUEST_TTL</dt>
      <dd>30</dd>
    
      <dt id="USE_100_CONTINUE_PUT_SIZE-constant">USE_100_CONTINUE_PUT_SIZE</dt>
      <dd>1_000_000</dd>
    
  </dl>
</div>
<div class="inherited">
  
  <div>
    <h2>Constants Inherited from <a title="RightAws::RightAwsBase" href="RightAwsBase.html">RightAws::RightAwsBase</a></h2>
    <p><span class='name'><a title="AMAZON_PROBLEMS" href="RightAwsBase.html#AMAZON_PROBLEMS-constant">AMAZON_PROBLEMS</a></span></p>
  </div>
  
</div>
<div class="clear"></div><div class="included">
  
  <div>
    <h2>Constants Included from <a title="RightAws::RightAwsBaseInterface" href="S3Interface/RightAwsBaseInterface.html">RightAws::RightAwsBaseInterface</a></h2>
    <p><span class='name'><a title="DEFAULT_SIGNATURE_VERSION" href="RightAwsBaseInterface.html#DEFAULT_SIGNATURE_VERSION-constant">DEFAULT_SIGNATURE_VERSION</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(aws_access_key_id = nil, aws_secret_access_key = nil, params = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Creates new RightS3 instance.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span> <span class='assign token'>=</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='S3Interface constant id'>S3Interface</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'1E3GDYEOGFJPIT7XXXXXX'</span><span class='comma token'>,</span><span class='string val'>'hgTHt68JY07JKUY08ftHYtERkjgtfERn57XXXXXX'</span><span class='comma token'>,</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='geq op'>&gt;=</span><span class='bitand op'>&amp;</span><span class='gt identifier id'>gt</span><span class='semicolon token'>;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='symbol val'>:logger</span> <span class='assign token'>=</span><span class='bitand op'>&amp;</span><span class='gt identifier id'>gt</span><span class='semicolon token'>;</span> <span class='Logger constant id'>Logger</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'/tmp/x.log'</span><span class='rparen token'>)</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;) #=&gt; #&lt;RightAws::S3Interface:0xb7b3c27c&gt;
</span></pre>
<p>
Params is a hash:
</p>
<pre class="code">
   <span class='lbrace token'>{</span><span class='symbol val'>:server</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'s3.amazonaws.com'</span>   <span class='comment val'># Amazon service host: 's3.amazonaws.com'(default)</span>
    <span class='symbol val'>:port</span>         <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>443</span>                  <span class='comment val'># Amazon service port: 80 or 443(default)</span>
    <span class='symbol val'>:protocol</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'https'</span>              <span class='comment val'># Amazon service protocol: 'http' or 'https'(default)</span>
    <span class='symbol val'>:multi_thread</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='bitor op'>|</span><span class='false false kw'>false</span>           <span class='comment val'># Multi-threaded (connection per each thread): true or false(default)</span>
    <span class='symbol val'>:logger</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Logger constant id'>Logger</span> <span class='Object constant id'>Object</span><span class='rbrace token'>}</span>       <span class='comment val'># Logger instance: logs to STDOUT if omitted }</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 63</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L63">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">63
64
65
66
67
68
69
70
71
72</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='aws_access_key_id identifier id'>aws_access_key_id</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='aws_secret_access_key identifier id'>aws_secret_access_key</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='init identifier id'>init</span><span class='lparen token'>(</span><span class='lbrace token'>{</span> <span class='symbol val'>:name</span>             <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'S3'</span><span class='comma token'>,</span> 
         <span class='symbol val'>:default_host</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'S3_URL'</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='URI constant id'>URI</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'S3_URL'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='host identifier id'>host</span>   <span class='colon op'>:</span> <span class='DEFAULT_HOST constant id'>DEFAULT_HOST</span><span class='comma token'>,</span> 
         <span class='symbol val'>:default_port</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'S3_URL'</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='URI constant id'>URI</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'S3_URL'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='port identifier id'>port</span>   <span class='colon op'>:</span> <span class='DEFAULT_PORT constant id'>DEFAULT_PORT</span><span class='comma token'>,</span>
         <span class='symbol val'>:default_service</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'S3_URL'</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='URI constant id'>URI</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'S3_URL'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='path identifier id'>path</span>   <span class='colon op'>:</span> <span class='DEFAULT_SERVICE constant id'>DEFAULT_SERVICE</span><span class='comma token'>,</span>
         <span class='symbol val'>:default_protocol</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'S3_URL'</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='URI constant id'>URI</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'S3_URL'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='scheme identifier id'>scheme</span> <span class='colon op'>:</span> <span class='DEFAULT_PROTOCOL constant id'>DEFAULT_PROTOCOL</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> 
       <span class='aws_access_key_id identifier id'>aws_access_key_id</span>     <span class='orop op'>||</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'AWS_ACCESS_KEY_ID'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> 
       <span class='aws_secret_access_key identifier id'>aws_secret_access_key</span> <span class='orop op'>||</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'AWS_SECRET_ACCESS_KEY'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> 
       <span class='params identifier id'>params</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bench_s3-class_method">bench_s3</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bench_xml-class_method">bench_xml</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Class Methods Inherited from <a title="RightAws::RightAwsBase" href="RightAwsBase.html">RightAws::RightAwsBase</a></h2>
    <p><span class='name'><a title="amazon_problems" href="RightAwsBase.html#amazon_problems-class_method">amazon_problems</a></span></p>
  </div>
  
</div>
<div class="clear"></div><div class="included">
  
  <div>
    <h2>Public Class Methods Included from <a title="RightAws::RightAwsBaseInterface" href="S3Interface/RightAwsBaseInterface.html">RightAws::RightAwsBaseInterface</a></h2>
    <p><span class='name'><a title="caching" href="RightAwsBaseInterface.html#caching-class_method">caching</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bucket_location-instance_method">#bucket_location</span><span class='args'>(bucket, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retrieve bucket location.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#canonical_string-instance_method">#canonical_string</span><span class='args'>(method, path, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <hr size="10"></hr><pre class="code">
     <span class='Requests constant id'>Requests</span>
</pre>
<hr size="10"></hr><p>
Produces canonical string for signing.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#clear_bucket-instance_method">#clear_bucket</span><span class='args'>(bucket)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Removes all keys from bucket.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#copy-instance_method">#copy</span><span class='args'>(src_bucket, src_key, dest_bucket, dest_key = nil, directive = :copy, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Copy an object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#create_bucket-instance_method">#create_bucket</span><span class='args'>(bucket, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Creates new bucket.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#create_bucket_link-instance_method">#create_bucket_link</span><span class='args'>(bucket, expires = nil, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;CreateBucket&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete-instance_method">#delete</span><span class='args'>(bucket, key = '', headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Deletes key.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_bucket-instance_method">#delete_bucket</span><span class='args'>(bucket, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Deletes new bucket.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_bucket_link-instance_method">#delete_bucket_link</span><span class='args'>(bucket, expires = nil, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;DeleteBucket&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_folder-instance_method">#delete_folder</span><span class='args'>(bucket, folder_key, separator = '/')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Deletes all keys where the &#8216;folder_key&#8217; may be assumed as
&#8216;folder&#8217; name.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_link-instance_method">#delete_link</span><span class='args'>(bucket, key, expires = nil, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;DeleteObject&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#fetch_request_params-instance_method">#fetch_request_params</span><span class='args'>(headers)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#force_delete_bucket-instance_method">#force_delete_bucket</span><span class='args'>(bucket)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Deletes all keys in bucket then deletes bucket.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#generate_link-instance_method">#generate_link</span><span class='args'>(method, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <hr size="10"></hr><pre class="code">
     <span class='Query constant id'>Query</span> <span class='API constant id'>API</span><span class='colon op'>:</span> <span class='Links constant id'>Links</span>
</pre>
<hr size="10"></hr><p>
Generates link for QUERY API.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#generate_rest_request-instance_method">#generate_rest_request</span><span class='args'>(method, headers)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates request hash for REST API.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get-instance_method">#get</span><span class='args'>(bucket, key, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retrieves object data from Amazon.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_acl-instance_method">#get_acl</span><span class='args'>(bucket, key = '', headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retieves the ACL (access control policy) for a bucket or object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_acl_link-instance_method">#get_acl_link</span><span class='args'>(bucket, key = '', headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;GetACL&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_acl_parse-instance_method">#get_acl_parse</span><span class='args'>(bucket, key = '', headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retieves the ACL (access control policy) for a bucket or object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_bucket_acl-instance_method">#get_bucket_acl</span><span class='args'>(bucket, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retieves the ACL (access control policy) for a bucket.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_bucket_acl_link-instance_method">#get_bucket_acl_link</span><span class='args'>(bucket, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;GetBucketACL&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_link-instance_method">#get_link</span><span class='args'>(bucket, key, expires = nil, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;GetObject&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_logging_parse-instance_method">#get_logging_parse</span><span class='args'>(params)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retrieves the logging configuration for a bucket.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_object-instance_method">#get_object</span><span class='args'>(bucket, key, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retrieves object data only (headers are omitted).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#head-instance_method">#head</span><span class='args'>(bucket, key, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retrieves object metadata.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#head_link-instance_method">#head_link</span><span class='args'>(bucket, key, expires = nil, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;HeadObject&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#incrementally_list_bucket-instance_method">#incrementally_list_bucket</span><span class='args'>(bucket, options = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Incrementally list the contents of a bucket.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#is_dns_bucket-3F-instance_method">#is_dns_bucket?</span><span class='args'>(bucket_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
http://docs.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#list_all_my_buckets-instance_method">#list_all_my_buckets</span><span class='args'>(headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array of customer&#8217;s buckets.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#list_all_my_buckets_link-instance_method">#list_all_my_buckets_link</span><span class='args'>(expires = nil, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;ListAllMyBuckets&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#list_bucket-instance_method">#list_bucket</span><span class='args'>(bucket, options = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array of bucket&#8217;s keys.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#list_bucket_link-instance_method">#list_bucket_link</span><span class='args'>(bucket, options = nil, expires = nil, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;ListBucket&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#move-instance_method">#move</span><span class='args'>(src_bucket, src_key, dest_bucket, dest_key = nil, directive = :copy, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Move an object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#put-instance_method">#put</span><span class='args'>(bucket, key, data = nil, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Saves object to Amazon.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#put_acl-instance_method">#put_acl</span><span class='args'>(bucket, key, acl_xml_doc, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sets the ACL on a bucket or object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#put_acl_link-instance_method">#put_acl_link</span><span class='args'>(bucket, key = '', headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;PutACL&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#put_bucket_acl-instance_method">#put_bucket_acl</span><span class='args'>(bucket, acl_xml_doc, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sets the ACL on a bucket only.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#put_bucket_acl_link-instance_method">#put_bucket_acl_link</span><span class='args'>(bucket, acl_xml_doc, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;PutBucketACL&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#put_link-instance_method">#put_link</span><span class='args'>(bucket, key, data = nil, expires = nil, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates link for &#8216;PutObject&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#put_logging-instance_method">#put_logging</span><span class='args'>(params)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sets logging configuration for a bucket from the XML configuration
document.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#rename-instance_method">#rename</span><span class='args'>(src_bucket, src_key, dest_key, headers = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Rename an object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#request_info-instance_method">#request_info</span><span class='args'>(request, parser, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sends request to Amazon and parses the response.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#retrieve_object-instance_method">#retrieve_object</span><span class='args'>(params, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
New experimental API for retrieving objects, introduced in RightAws 1.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#retrieve_object_and_verify-instance_method">#retrieve_object_and_verify</span><span class='args'>(params, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Identical in function to retrieve_object, but requires verification that
the returned ETag is identical to the checksum passed in by the user as the
&#8216;md5&#8217; argument.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#store_object-instance_method">#store_object</span><span class='args'>(params)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
New experimental API for uploading objects, introduced in RightAws 1.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#store_object_and_verify-instance_method">#store_object_and_verify</span><span class='args'>(params)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Identical in function to store_object, but requires verification that the
returned ETag is identical to the checksum passed in by the user as the
&#8216;md5&#8217; argument.
</p>

        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h2>Public Instance Methods Included from <a title="RightAws::RightAwsBaseInterface" href="S3Interface/RightAwsBaseInterface.html">RightAws::RightAwsBaseInterface</a></h2>
    <p><span class='name'><a title="cache_hits?" href="RightAwsBaseInterface.html#cache_hits%3F-instance_method">cache_hits?</a></span>, <span class='name'><a title="caching?" href="RightAwsBaseInterface.html#caching%3F-instance_method">caching?</a></span>, <span class='name'><a title="init" href="RightAwsBaseInterface.html#init-instance_method">init</a></span>, <span class='name'><a title="last_request_id" href="RightAwsBaseInterface.html#last_request_id-instance_method">last_request_id</a></span>, <span class='name'><a title="multi_thread" href="RightAwsBaseInterface.html#multi_thread-instance_method">multi_thread</a></span>, <span class='name'><a title="on_exception" href="RightAwsBaseInterface.html#on_exception-instance_method">on_exception</a></span>, <span class='name'><a title="request_cache_or_info" href="RightAwsBaseInterface.html#request_cache_or_info-instance_method">request_cache_or_info</a></span>, <span class='name'><a title="request_info_impl" href="RightAwsBaseInterface.html#request_info_impl-instance_method">request_info_impl</a></span>, <span class='name'><a title="signed_service_params" href="RightAwsBaseInterface.html#signed_service_params-instance_method">signed_service_params</a></span>, <span class='name'><a title="update_cache" href="RightAwsBaseInterface.html#update_cache-instance_method">update_cache</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>bench_s3</h3>
</div><div id="bench_s3-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bench_s3</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 46</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L46">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">46
47
48</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='bench_s3 identifier id'>bench_s3</span>
  <span class='@@bench ivar id'>@@bench</span><span class='dot token'>.</span><span class='service identifier id'>service</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>bench_xml</h3>
</div><div id="bench_xml-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bench_xml</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 43</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L43">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">43
44
45</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='bench_xml identifier id'>bench_xml</span>
  <span class='@@bench ivar id'>@@bench</span><span class='dot token'>.</span><span class='xml identifier id'>xml</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>bucket_location</h3>
</div><div id="bucket_location-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bucket_location</span><span class='args'>(bucket, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retrieve bucket location
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='create_bucket identifier id'>create_bucket</span><span class='lparen token'>(</span><span class='string val'>'my-awesome-bucket-us'</span><span class='rparen token'>)</span>        <span class='comment val'>#=&gt; true</span>
 <span class='puts identifier id'>puts</span> <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='bucket_location identifier id'>bucket_location</span><span class='lparen token'>(</span><span class='string val'>'my-awesome-bucket-us'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; '' (Amazon's default value assumed)</span>

 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='create_bucket identifier id'>create_bucket</span><span class='lparen token'>(</span><span class='string val'>'my-awesome-bucket-eu'</span><span class='comma token'>,</span> <span class='symbol val'>:location</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:eu</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; true</span>
 <span class='puts identifier id'>puts</span> <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='bucket_location identifier id'>bucket_location</span><span class='lparen token'>(</span><span class='string val'>'my-awesome-bucket-eu'</span><span class='rparen token'>)</span>            <span class='comment val'>#=&gt; 'EU'</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 207</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L207">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">207
208
209
210
211
212</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='bucket_location identifier id'>bucket_location</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}?location&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3BucketLocationParser constant id'>S3BucketLocationParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>canonical_string</h3>
</div><div id="canonical_string-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>canonical_string</span><span class='args'>(method, path, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <hr size="10"></hr><pre class="code">
     <span class='Requests constant id'>Requests</span>
</pre>
<hr size="10"></hr><p>
Produces canonical string for signing.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 79</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L79">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='canonical_string identifier id'>canonical_string</span><span class='lparen token'>(</span><span class='method identifier id'>method</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='s3_headers identifier id'>s3_headers</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='key identifier id'>key</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span>
    <span class='s3_headers identifier id'>s3_headers</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span> <span class='if if_mod kw'>if</span> <span class='key identifier id'>key</span><span class='lbrack token'>[</span><span class='dregexp node'>/^#{AMAZON_HEADER_PREFIX}|^content-md5$|^content-type$|^date$/o</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='s3_headers identifier id'>s3_headers</span><span class='lbrack token'>[</span><span class='string val'>'content-type'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>''</span>
  <span class='s3_headers identifier id'>s3_headers</span><span class='lbrack token'>[</span><span class='string val'>'content-md5'</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='string val'>''</span>
  <span class='s3_headers identifier id'>s3_headers</span><span class='lbrack token'>[</span><span class='string val'>'date'</span><span class='rbrack token'>]</span>           <span class='assign token'>=</span> <span class='string val'>''</span>      <span class='if if_mod kw'>if</span> <span class='s3_headers identifier id'>s3_headers</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span> <span class='string val'>'x-amz-date'</span>
  <span class='s3_headers identifier id'>s3_headers</span><span class='lbrack token'>[</span><span class='string val'>'date'</span><span class='rbrack token'>]</span>           <span class='assign token'>=</span> <span class='expires identifier id'>expires</span> <span class='if if_mod kw'>if</span> <span class='expires identifier id'>expires</span>
    <span class='comment val'># prepare output string</span>
  <span class='out_string identifier id'>out_string</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{method}\n&quot;</span>
  <span class='s3_headers identifier id'>s3_headers</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='comma token'>,</span> <span class='b identifier id'>b</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='cmp op'>&lt;=&gt;</span> <span class='b identifier id'>b</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='out_string identifier id'>out_string</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='lbrack token'>[</span><span class='dregexp node'>/^#{AMAZON_HEADER_PREFIX}/o</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='dstring node'>&quot;#{key}:#{value}\n&quot;</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;#{value}\n&quot;</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
    <span class='comment val'># ignore everything after the question mark...</span>
  <span class='out_string identifier id'>out_string</span> <span class='lshft op'>&lt;&lt;</span> <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/\?.*$/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
   <span class='comment val'># ...unless there is an acl or torrent parameter</span>
  <span class='out_string identifier id'>out_string</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'?acl'</span>      <span class='if if_mod kw'>if</span> <span class='path identifier id'>path</span><span class='lbrack token'>[</span><span class='regexp val'>/[&amp;?]acl($|&amp;|=)/</span><span class='rbrack token'>]</span>
  <span class='out_string identifier id'>out_string</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'?torrent'</span>  <span class='if if_mod kw'>if</span> <span class='path identifier id'>path</span><span class='lbrack token'>[</span><span class='regexp val'>/[&amp;?]torrent($|&amp;|=)/</span><span class='rbrack token'>]</span>
  <span class='out_string identifier id'>out_string</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'?location'</span> <span class='if if_mod kw'>if</span> <span class='path identifier id'>path</span><span class='lbrack token'>[</span><span class='regexp val'>/[&amp;?]location($|&amp;|=)/</span><span class='rbrack token'>]</span>
  <span class='out_string identifier id'>out_string</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'?logging'</span>  <span class='if if_mod kw'>if</span> <span class='path identifier id'>path</span><span class='lbrack token'>[</span><span class='regexp val'>/[&amp;?]logging($|&amp;|=)/</span><span class='rbrack token'>]</span>  <span class='comment val'># this one is beta, no support for now</span>
  <span class='out_string identifier id'>out_string</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>clear_bucket</h3>
</div><div id="clear_bucket-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>clear_bucket</span><span class='args'>(bucket)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Removes all keys from bucket. Returns <tt>true</tt> or an exception.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='clear_bucket identifier id'>clear_bucket</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; true</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 756</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L756">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">756
757
758
759
760
761
762
763</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='clear_bucket identifier id'>clear_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span>
  <span class='incrementally_list_bucket identifier id'>incrementally_list_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='results identifier id'>results</span><span class='bitor op'>|</span>
    <span class='results identifier id'>results</span><span class='lbrack token'>[</span><span class='symbol val'>:contents</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='bitor op'>|</span> <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='lbrack token'>[</span><span class='symbol val'>:key</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='true true kw'>true</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>copy</h3>
</div><div id="copy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>copy</span><span class='args'>(src_bucket, src_key, dest_bucket, dest_key = nil, directive = :copy, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Copy an object.
</p>
<pre class="code">
 <span class='directive identifier id'>directive</span><span class='colon op'>:</span> <span class='symbol val'>:copy</span>    <span class='minus op'>-</span> <span class='copy identifier id'>copy</span> <span class='meta identifier id'>meta</span><span class='minus op'>-</span><span class='headers identifier id'>headers</span> <span class='from identifier id'>from</span> <span class='source identifier id'>source</span> <span class='lparen token'>(</span><span class='default identifier id'>default</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>
            <span class='symbol val'>:replace</span> <span class='minus op'>-</span> <span class='replace identifier id'>replace</span> <span class='meta identifier id'>meta</span><span class='minus op'>-</span><span class='headers identifier id'>headers</span> <span class='by identifier id'>by</span> <span class='passed identifier id'>passed</span> <span class='ones identifier id'>ones</span>

 <span class='comment val'># copy a key with meta-headers</span>
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='copy identifier id'>copy</span><span class='lparen token'>(</span><span class='string val'>'b1'</span><span class='comma token'>,</span> <span class='string val'>'key1'</span><span class='comma token'>,</span> <span class='string val'>'b1'</span><span class='comma token'>,</span> <span class='string val'>'key1_copy'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; &lt;tt&gt;:last_modified=&amp;gt;&amp;quot;2008-05-11T10:25:22.000Z&amp;quot;&lt;/tt&gt;</span>

 <span class='comment val'># copy a key, overwrite meta-headers</span>
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='copy identifier id'>copy</span><span class='lparen token'>(</span><span class='string val'>'b1'</span><span class='comma token'>,</span> <span class='string val'>'key2'</span><span class='comma token'>,</span> <span class='string val'>'b1'</span><span class='comma token'>,</span> <span class='string val'>'key2_copy'</span><span class='comma token'>,</span> <span class='symbol val'>:replace</span><span class='comma token'>,</span> <span class='string val'>'x-amz-meta-family'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>'Woho555!'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; &lt;tt&gt;:last_modified=&amp;gt;&amp;quot;2008-05-11T10:26:22.000Z&amp;quot;&lt;/tt&gt;</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonS3/2006-03-01/UsingCopyingObjects.html
</p>
<pre class="code">
     <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/docs.amazonwebservices.com/</span><span class='AmazonS3 constant id'>AmazonS3</span><span class='div op'>/</span><span class='integer val'>2006</span><span class='minus op'>-</span><span class='integer val'>03</span><span class='minus op'>-</span><span class='integer val'>01</span><span class='div op'>/</span><span class='RESTObjectCOPY constant id'>RESTObjectCOPY</span><span class='dot token'>.</span><span class='html identifier id'>html</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 624</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L624">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">624
625
626
627
628
629
630
631
632</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='copy identifier id'>copy</span><span class='lparen token'>(</span><span class='src_bucket identifier id'>src_bucket</span><span class='comma token'>,</span> <span class='src_key identifier id'>src_key</span><span class='comma token'>,</span> <span class='dest_bucket identifier id'>dest_bucket</span><span class='comma token'>,</span> <span class='dest_key identifier id'>dest_key</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='directive identifier id'>directive</span><span class='assign token'>=</span><span class='symbol val'>:copy</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='dest_key identifier id'>dest_key</span> <span class='opasgn op'>||=</span> <span class='src_key identifier id'>src_key</span>
  <span class='headers identifier id'>headers</span><span class='lbrack token'>[</span><span class='string val'>'x-amz-metadata-directive'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='directive identifier id'>directive</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='upcase identifier id'>upcase</span>
  <span class='headers identifier id'>headers</span><span class='lbrack token'>[</span><span class='string val'>'x-amz-copy-source'</span><span class='rbrack token'>]</span>        <span class='assign token'>=</span> <span class='dstring node'>&quot;#{src_bucket}/#{CGI::escape src_key}&quot;</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'PUT'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{dest_bucket}/#{CGI::escape dest_key}&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3CopyParser constant id'>S3CopyParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>create_bucket</h3>
</div><div id="create_bucket-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create_bucket</span><span class='args'>(bucket, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Creates new bucket. Returns <tt>true</tt> or an exception.
</p>
<pre class="code">
 <span class='comment val'># create a bucket at American server</span>
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='create_bucket identifier id'>create_bucket</span><span class='lparen token'>(</span><span class='string val'>'my-awesome-bucket-us'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; true</span>
 <span class='comment val'># create a bucket at European server</span>
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='create_bucket identifier id'>create_bucket</span><span class='lparen token'>(</span><span class='string val'>'my-awesome-bucket-eu'</span><span class='comma token'>,</span> <span class='symbol val'>:location</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:eu</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; true</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 187</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L187">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">187
188
189
190
191
192
193
194
195
196
197</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='create_bucket identifier id'>create_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='unless unless kw'>unless</span> <span class='headers identifier id'>headers</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='location identifier id'>location</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
    <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;&lt;CreateBucketConfiguration&gt;&lt;LocationConstraint&gt;#{headers[:location].to_s.upcase}&lt;/LocationConstraint&gt;&lt;/CreateBucketConfiguration&gt;&quot;</span>
  <span class='end end kw'>end</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'PUT'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='symbol val'>:data</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='data identifier id'>data</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='RightHttp2xxParser constant id'>RightHttp2xxParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
    <span class='comment val'># if the bucket exists AWS returns an error for the location constraint interface. Drop it</span>
  <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='AwsError constant id'>AwsError</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='message identifier id'>message</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>'BucketAlreadyOwnedByYou'</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='true true kw'>true</span>  <span class='colon op'>:</span> <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>create_bucket_link</h3>
</div><div id="create_bucket_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create_bucket_link</span><span class='args'>(bucket, expires = nil, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;CreateBucket&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='create_bucket_link identifier id'>create_bucket_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 843</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L843">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">843
844
845
846
847</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='create_bucket_link identifier id'>create_bucket_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'PUT'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete</h3>
</div><div id="delete-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete</span><span class='args'>(bucket, key = '', headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Deletes key. Returns <tt>true</tt> or an exception.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span> <span class='string val'>'log/curent/1.log'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; true</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 604</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L604">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">604
605
606
607
608
609</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='assign token'>=</span><span class='string val'>''</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'DELETE'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{CGI::escape key}&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='RightHttp2xxParser constant id'>RightHttp2xxParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_bucket</h3>
</div><div id="delete_bucket-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_bucket</span><span class='args'>(bucket, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Deletes new bucket. Bucket must be empty! Returns <tt>true</tt> or an
exception.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='delete_bucket identifier id'>delete_bucket</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='rparen token'>)</span>  <span class='comment val'>#=&gt; true</span>
</pre>
<p>
See also: force_delete_bucket method
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 251</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L251">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">251
252
253
254
255
256</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_bucket identifier id'>delete_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'DELETE'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='RightHttp2xxParser constant id'>RightHttp2xxParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_bucket_link</h3>
</div><div id="delete_bucket_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_bucket_link</span><span class='args'>(bucket, expires = nil, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;DeleteBucket&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='delete_bucket_link identifier id'>delete_bucket_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 853</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L853">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">853
854
855
856
857</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_bucket_link identifier id'>delete_bucket_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span>  <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'DELETE'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_folder</h3>
</div><div id="delete_folder-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_folder</span><span class='args'>(bucket, folder_key, separator = '/')</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Deletes all keys where the &#8216;folder_key&#8217; may be assumed as
&#8216;folder&#8217; name. Returns an array of string keys that have been
deleted.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='list_bucket identifier id'>list_bucket</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='key_data identifier id'>key_data</span><span class='bitor op'>|</span> <span class='key_data identifier id'>key_data</span><span class='lbrack token'>[</span><span class='symbol val'>:key</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span> <span class='comment val'>#=&gt; ['test','test/2/34','test/3','test1','test1/logs']</span>
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='delete_folder identifier id'>delete_folder</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span><span class='string val'>'test'</span><span class='rparen token'>)</span>                       <span class='comment val'>#=&gt; ['test','test/2/34','test/3']</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 781</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L781">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">781
782
783
784
785
786
787
788
789
790
791
792</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_folder identifier id'>delete_folder</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='folder_key identifier id'>folder_key</span><span class='comma token'>,</span> <span class='separator identifier id'>separator</span><span class='assign token'>=</span><span class='string val'>'/'</span><span class='rparen token'>)</span>
  <span class='folder_key identifier id'>folder_key</span><span class='dot token'>.</span><span class='chomp! fid id'>chomp!</span><span class='lparen token'>(</span><span class='separator identifier id'>separator</span><span class='rparen token'>)</span>
  <span class='allkeys identifier id'>allkeys</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='incrementally_list_bucket identifier id'>incrementally_list_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='string val'>'prefix'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='folder_key identifier id'>folder_key</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='results identifier id'>results</span><span class='bitor op'>|</span>
    <span class='keys identifier id'>keys</span> <span class='assign token'>=</span> <span class='results identifier id'>results</span><span class='lbrack token'>[</span><span class='symbol val'>:contents</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s3_key identifier id'>s3_key</span><span class='bitor op'>|</span> <span class='s3_key identifier id'>s3_key</span><span class='lbrack token'>[</span><span class='symbol val'>:key</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='dregexp node'>/^#{folder_key}($|#{separator}.*)/</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='s3_key identifier id'>s3_key</span><span class='lbrack token'>[</span><span class='symbol val'>:key</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span>
    <span class='keys identifier id'>keys</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='bitor op'>|</span> <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='allkeys identifier id'>allkeys</span> <span class='lshft op'>&lt;&lt;</span> <span class='keys identifier id'>keys</span>
  <span class='end end kw'>end</span>
  <span class='allkeys identifier id'>allkeys</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_link</h3>
</div><div id="delete_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_link</span><span class='args'>(bucket, key, expires = nil, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;DeleteObject&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='delete_link identifier id'>delete_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 912</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L912">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">912
913
914
915
916</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_link identifier id'>delete_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'DELETE'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{AwsUtils::URLencode key}&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>fetch_request_params</h3>
</div><div id="fetch_request_params-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>fetch_request_params</span><span class='args'>(headers)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 114</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L114">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">114
115
116
117
118
119
120
121
122
123
124
125
126</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='fetch_request_params identifier id'>fetch_request_params</span><span class='lparen token'>(</span><span class='headers identifier id'>headers</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='comment val'># default server to use</span>
  <span class='server identifier id'>server</span>  <span class='assign token'>=</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:server</span><span class='rbrack token'>]</span>
  <span class='service identifier id'>service</span> <span class='assign token'>=</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:service</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='service identifier id'>service</span><span class='dot token'>.</span><span class='chop! fid id'>chop!</span> <span class='if if_mod kw'>if</span> <span class='service identifier id'>service</span><span class='lbrack token'>[</span><span class='regexp val'>%r{/$}</span><span class='rbrack token'>]</span> <span class='comment val'># remove trailing '/' from service</span>
  <span class='comment val'># extract bucket name and check it's dns compartibility</span>
  <span class='headers identifier id'>headers</span><span class='lbrack token'>[</span><span class='symbol val'>:url</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='lbrack token'>[</span><span class='regexp val'>%r{^([a-z0-9._-]*)(/[^?]*)?(\?.+)?}i</span><span class='rbrack token'>]</span>
  <span class='bucket_name identifier id'>bucket_name</span><span class='comma token'>,</span> <span class='key_path identifier id'>key_path</span><span class='comma token'>,</span> <span class='params_list identifier id'>params_list</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='comma token'>,</span> <span class='$2 nth_ref id'>$2</span><span class='comma token'>,</span> <span class='$3 nth_ref id'>$3</span>
  <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{service}/#{bucket_name}#{key_path}#{params_list}&quot;</span>
  <span class='path_to_sign identifier id'>path_to_sign</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{service}/#{bucket_name}#{key_path}#{params_list}&quot;</span>
<span class='comment val'>#      path_to_sign = &quot;/#{bucket_name}#{key_path}#{params_list}&quot;</span>
  <span class='lbrack token'>[</span> <span class='server identifier id'>server</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='path_to_sign identifier id'>path_to_sign</span> <span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>force_delete_bucket</h3>
</div><div id="force_delete_bucket-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>force_delete_bucket</span><span class='args'>(bucket)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Deletes all keys in bucket then deletes bucket. Returns <tt>true</tt> or an
exception.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='force_delete_bucket identifier id'>force_delete_bucket</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 769</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L769">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">769
770
771
772
773
774</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='force_delete_bucket identifier id'>force_delete_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span>
  <span class='clear_bucket identifier id'>clear_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span>
  <span class='delete_bucket identifier id'>delete_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>generate_link</h3>
</div><div id="generate_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>generate_link</span><span class='args'>(method, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <hr size="10"></hr><pre class="code">
     <span class='Query constant id'>Query</span> <span class='API constant id'>API</span><span class='colon op'>:</span> <span class='Links constant id'>Links</span>
</pre>
<hr size="10"></hr><p>
Generates link for QUERY API
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 809</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L809">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='method identifier id'>method</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
    <span class='comment val'># calculate request data</span>
  <span class='server identifier id'>server</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='path_to_sign identifier id'>path_to_sign</span> <span class='assign token'>=</span> <span class='fetch_request_params identifier id'>fetch_request_params</span><span class='lparen token'>(</span><span class='headers identifier id'>headers</span><span class='rparen token'>)</span>
    <span class='comment val'># expiration time</span>
  <span class='expires identifier id'>expires</span> <span class='opasgn op'>||=</span> <span class='DEFAULT_EXPIRES_AFTER constant id'>DEFAULT_EXPIRES_AFTER</span>
  <span class='expires identifier id'>expires</span>   <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='dot token'>.</span><span class='utc identifier id'>utc</span> <span class='plus op'>+</span> <span class='expires identifier id'>expires</span> <span class='if if_mod kw'>if</span> <span class='expires identifier id'>expires</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Fixnum constant id'>Fixnum</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='expires identifier id'>expires</span> <span class='lt op'>&lt;</span> <span class='ONE_YEAR_IN_SECONDS constant id'>ONE_YEAR_IN_SECONDS</span><span class='rparen token'>)</span>
  <span class='expires identifier id'>expires</span>   <span class='assign token'>=</span> <span class='expires identifier id'>expires</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='comment val'># remove unset(==optional) and symbolyc keys</span>
  <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='orop op'>||</span> <span class='key identifier id'>key</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Symbol constant id'>Symbol</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='comment val'>#generate auth strings</span>
  <span class='auth_string identifier id'>auth_string</span> <span class='assign token'>=</span> <span class='canonical_string identifier id'>canonical_string</span><span class='lparen token'>(</span><span class='method identifier id'>method</span><span class='comma token'>,</span> <span class='path_to_sign identifier id'>path_to_sign</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='rparen token'>)</span>
  <span class='signature identifier id'>signature</span>   <span class='assign token'>=</span> <span class='CGI constant id'>CGI</span><span class='colon2 op'>::</span><span class='escape identifier id'>escape</span><span class='lparen token'>(</span><span class='Base64 constant id'>Base64</span><span class='dot token'>.</span><span class='encode64 identifier id'>encode64</span><span class='lparen token'>(</span><span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='HMAC constant id'>HMAC</span><span class='dot token'>.</span><span class='digest identifier id'>digest</span><span class='lparen token'>(</span><span class='OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='Digest constant id'>Digest</span><span class='colon2 op'>::</span><span class='Digest constant id'>Digest</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;sha1&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='@aws_secret_access_key ivar id'>@aws_secret_access_key</span><span class='comma token'>,</span> <span class='auth_string identifier id'>auth_string</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span><span class='rparen token'>)</span>
    <span class='comment val'># path building</span>
  <span class='addon identifier id'>addon</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;Signature=#{signature}&amp;Expires=#{expires}&amp;AWSAccessKeyId=#{@aws_access_key_id}&quot;</span>
  <span class='path identifier id'>path</span> <span class='opasgn op'>+=</span> <span class='path identifier id'>path</span><span class='lbrack token'>[</span><span class='regexp val'>/\?/</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='dstring node'>&quot;&amp;#{addon}&quot;</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;?#{addon}&quot;</span>
  <span class='dstring node'>&quot;#{@params[:protocol]}://#{server}:#{@params[:port]}#{path}&quot;</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>generate_rest_request</h3>
</div><div id="generate_rest_request-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>generate_rest_request</span><span class='args'>(method, headers)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates request hash for REST API. Assumes that headers[:url] is URL
encoded (use CGI::escape)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 130</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L130">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='method identifier id'>method</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='rparen token'>)</span>  <span class='comment val'># :nodoc:</span>
  <span class='comment val'># calculate request data</span>
<span class='server identifier id'>server</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='path_to_sign identifier id'>path_to_sign</span> <span class='assign token'>=</span> <span class='fetch_request_params identifier id'>fetch_request_params</span><span class='lparen token'>(</span><span class='headers identifier id'>headers</span><span class='rparen token'>)</span>
<span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='headers identifier id'>headers</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span>
  <span class='comment val'># remove unset(==optional) and symbolyc keys</span>
<span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='orop op'>||</span> <span class='key identifier id'>key</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Symbol constant id'>Symbol</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='comment val'>#</span>
<span class='headers identifier id'>headers</span><span class='lbrack token'>[</span><span class='string val'>'content-type'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>''</span>
<span class='headers identifier id'>headers</span><span class='lbrack token'>[</span><span class='string val'>'date'</span><span class='rbrack token'>]</span>           <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='dot token'>.</span><span class='httpdate identifier id'>httpdate</span>
  <span class='comment val'># create request</span>
<span class='request identifier id'>request</span>      <span class='assign token'>=</span> <span class='dstring node'>&quot;Net::HTTP::#{method.capitalize}&quot;</span><span class='dot token'>.</span><span class='constantize identifier id'>constantize</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='rparen token'>)</span>
<span class='request identifier id'>request</span><span class='dot token'>.</span><span class='body identifier id'>body</span> <span class='assign token'>=</span> <span class='data identifier id'>data</span> <span class='if if_mod kw'>if</span> <span class='data identifier id'>data</span>
  <span class='comment val'># set request headers and meta headers</span>
<span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='each identifier id'>each</span>      <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span> <span class='request identifier id'>request</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='value identifier id'>value</span> <span class='rbrace token'>}</span>
  <span class='comment val'>#generate auth strings</span>
<span class='auth_string identifier id'>auth_string</span> <span class='assign token'>=</span> <span class='canonical_string identifier id'>canonical_string</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='dot token'>.</span><span class='method identifier id'>method</span><span class='comma token'>,</span> <span class='path_to_sign identifier id'>path_to_sign</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='to_hash identifier id'>to_hash</span><span class='rparen token'>)</span>
<span class='signature identifier id'>signature</span>   <span class='assign token'>=</span> <span class='AwsUtils constant id'>AwsUtils</span><span class='colon2 op'>::</span><span class='sign identifier id'>sign</span><span class='lparen token'>(</span><span class='@aws_secret_access_key ivar id'>@aws_secret_access_key</span><span class='comma token'>,</span> <span class='auth_string identifier id'>auth_string</span><span class='rparen token'>)</span>
  <span class='comment val'># set other headers</span>
<span class='request identifier id'>request</span><span class='lbrack token'>[</span><span class='string val'>'Authorization'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;AWS #{@aws_access_key_id}:#{signature}&quot;</span>
  <span class='comment val'># prepare output hash</span>
<span class='lbrace token'>{</span> <span class='symbol val'>:request</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='comma token'>,</span> 
  <span class='symbol val'>:server</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='server identifier id'>server</span><span class='comma token'>,</span>
  <span class='symbol val'>:port</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:port</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
  <span class='symbol val'>:protocol</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:protocol</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get</h3>
</div><div id="get-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get</span><span class='args'>(bucket, key, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retrieves object data from Amazon. Returns a <tt>hash</tt> or an exception.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='get identifier id'>get</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span> <span class='string val'>'log/curent/1.log'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt;</span>

     <span class='lbrace token'>{</span><span class='symbol val'>:object</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Ola-la!&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;last-modified&quot;</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Wed, 23 May 2007 09:08:04 GMT&quot;</span><span class='comma token'>,</span>
                   <span class='string val'>&quot;content-type&quot;</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;&quot;</span><span class='comma token'>,</span>
                   <span class='string val'>&quot;etag&quot;</span>              <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;\&quot;000000000096f4ee74bc4596443ef2a4\&quot;&quot;</span><span class='comma token'>,</span>
                   <span class='string val'>&quot;date&quot;</span>              <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Wed, 23 May 2007 09:08:03 GMT&quot;</span><span class='comma token'>,</span>
                   <span class='string val'>&quot;x-amz-id-2&quot;</span>        <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;ZZZZZZZZZZZZZZZZZZZZ1HJXZoehfrS4QxcxTdNGldR7w/FVqblP50fU8cuIMLiu&quot;</span><span class='comma token'>,</span>
                   <span class='string val'>&quot;x-amz-meta-family&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Woho556!&quot;</span><span class='comma token'>,</span>
                   <span class='string val'>&quot;x-amz-request-id&quot;</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;0000000C246D770C&quot;</span><span class='comma token'>,</span>
                   <span class='string val'>&quot;server&quot;</span>            <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;AmazonS3&quot;</span><span class='comma token'>,</span>
                   <span class='string val'>&quot;content-length&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;7&quot;</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span>
</pre>
<p>
If a block is provided, yields incrementally to the block as the response
is read. For large responses, this function is ideal as the response can be
&#8216;streamed&#8217;. The hash containing header fields is still
returned. Example: foo = File.new(&#8217;./chunder.txt&#8217;,
File::CREAT|File::RDWR) rhdr = s3.get(&#8216;aws-test&#8217;,
&#8216;Cent5V1_7_1.img.part.00&#8217;) do |chunk|
</p>
<pre class="code">
  <span class='foo identifier id'>foo</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='chunk identifier id'>chunk</span><span class='rparen token'>)</span>
</pre>
<p>
end foo.close
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 507</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L507">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">507
508
509
510
511
512</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get identifier id'>get</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{CGI::escape key}&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3HttpResponseBodyParser constant id'>S3HttpResponseBodyParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_acl</h3>
</div><div id="get_acl-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_acl</span><span class='args'>(bucket, key = '', headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retieves the ACL (access control policy) for a bucket or object. Returns a
hash of headers and xml doc with ACL data. See:
http://docs.amazonwebservices.com/AmazonS3/2006-03-01/RESTAccessPolicy.html.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='get_acl identifier id'>get_acl</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span> <span class='string val'>'log/curent/1.log'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt;</span>
   <span class='lbrace token'>{</span><span class='symbol val'>:headers</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;x-amz-id-2&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;B3BdDMDUz&lt;tt&gt;phFF2mGBH04E46ZD4Qb9HF5PoPHqDRWBv&lt;/tt&gt;NVGeA3TOQ3BkVvPBjgxX&quot;</span><span class='comma token'>,</span>
                 <span class='string val'>&quot;content-type&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;application/xml;charset=ISO-8859-1&quot;</span><span class='comma token'>,</span>
                 <span class='string val'>&quot;date&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Wed, 23 May 2007 09:40:16 GMT&quot;</span><span class='comma token'>,</span>
                 <span class='string val'>&quot;x-amz-request-id&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;B183FA7AB5FBB4DD&quot;</span><span class='comma token'>,</span>
                 <span class='string val'>&quot;server&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;AmazonS3&quot;</span><span class='comma token'>,</span>
                 <span class='string val'>&quot;transfer-encoding&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;chunked&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='symbol val'>:object</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&lt;AccessControlPolicy xmlns=\&quot;http://s3.amazonaws.com/doc/2006-03-01/\&quot;&gt;&lt;Owner&gt;
                 &lt;ID&gt;16144ab2929314cc309ffe736daa2b264357476c7fea6efb2c3347ac3ab2792a&lt;/ID&gt;&lt;DisplayName&gt;root&lt;/DisplayName&gt;&lt;/Owner&gt;
                 &lt;AccessControlList&gt;&lt;Grant&gt;&lt;Grantee xmlns:xsi=\&quot;http://www.w3.org/2001/XMLSchema-instance\&quot; xsi:type=\&quot;CanonicalUser\&quot;&gt;&lt;ID&gt;
                 16144ab2929314cc309ffe736daa2b264357476c7fea6efb2c3347ac3ab2792a&lt;/ID&gt;&lt;DisplayName&gt;root&lt;/DisplayName&gt;&lt;/Grantee&gt;
                 &lt;Permission&gt;FULL_CONTROL&lt;/Permission&gt;&lt;/Grant&gt;&lt;/AccessControlList&gt;&lt;/AccessControlPolicy&gt;&quot;</span> <span class='rbrace token'>}</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 675</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L675">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">675
676
677
678
679
680
681</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_acl identifier id'>get_acl</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='assign token'>=</span><span class='string val'>''</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='key identifier id'>key</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span> <span class='integer val'>? </span><span class='string val'>''</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;/#{CGI::escape key}&quot;</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}#{key}?acl&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3HttpResponseBodyParser constant id'>S3HttpResponseBodyParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span> 
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_acl_link</h3>
</div><div id="get_acl_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_acl_link</span><span class='args'>(bucket, key = '', headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;GetACL&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='get_acl_link identifier id'>get_acl_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 923</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L923">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">923
924
925
926
927</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_acl_link identifier id'>get_acl_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='assign token'>=</span><span class='string val'>''</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{AwsUtils::URLencode key}?acl&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_acl_parse</h3>
</div><div id="get_acl_parse-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_acl_parse</span><span class='args'>(bucket, key = '', headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retieves the ACL (access control policy) for a bucket or object. Returns a
hash of <tt>:grantees</tt>
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='get_acl_parse identifier id'>get_acl_parse</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span> <span class='string val'>'log/curent/1.log'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt;</span>

 <span class='lbrace token'>{</span> <span class='symbol val'>:grantees=</span><span class='gt op'>&gt;</span>
   <span class='lbrace token'>{</span> <span class='string val'>&quot;16...2a&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span>
     <span class='lbrace token'>{</span> <span class='symbol val'>:display_name=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;root&quot;</span><span class='comma token'>,</span>
       <span class='symbol val'>:permissions=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;FULL_CONTROL&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='symbol val'>:attributes=</span><span class='gt op'>&gt;</span>
        <span class='lbrace token'>{</span> <span class='string val'>&quot;xsi:type&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;CanonicalUser&quot;</span><span class='comma token'>,</span>
          <span class='string val'>&quot;xmlns:xsi&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='string val'>&quot;http://acs.amazonaws.com/groups/global/AllUsers&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span>
      <span class='lbrace token'>{</span> <span class='symbol val'>:display_name=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;AllUsers&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:permissions=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;READ&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
        <span class='symbol val'>:attributes=</span><span class='gt op'>&gt;</span>
         <span class='lbrace token'>{</span> <span class='string val'>&quot;xsi:type&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Group&quot;</span><span class='comma token'>,</span>
           <span class='string val'>&quot;xmlns:xsi&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
  <span class='symbol val'>:owner=</span><span class='gt op'>&gt;</span>
    <span class='lbrace token'>{</span> <span class='symbol val'>:id=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;16..2a&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:display_name=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;root&quot;</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 705</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L705">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_acl_parse identifier id'>get_acl_parse</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='assign token'>=</span><span class='string val'>''</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='key identifier id'>key</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span> <span class='integer val'>? </span><span class='string val'>''</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;/#{CGI::escape key}&quot;</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}#{key}?acl&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='acl identifier id'>acl</span> <span class='assign token'>=</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3AclParser constant id'>S3AclParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:logger</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@logger ivar id'>@logger</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:owner</span><span class='rbrack token'>]</span>    <span class='assign token'>=</span> <span class='acl identifier id'>acl</span><span class='lbrack token'>[</span><span class='symbol val'>:owner</span><span class='rbrack token'>]</span>
  <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:grantees</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='acl identifier id'>acl</span><span class='lbrack token'>[</span><span class='symbol val'>:grantees</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='grantee identifier id'>grantee</span><span class='bitor op'>|</span>
    <span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='grantee identifier id'>grantee</span><span class='lbrack token'>[</span><span class='symbol val'>:id</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='grantee identifier id'>grantee</span><span class='lbrack token'>[</span><span class='symbol val'>:uri</span><span class='rbrack token'>]</span>
    <span class='if if kw'>if</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='grantees identifier id'>grantees</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='key? fid id'>key?</span><span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='rparen token'>)</span>
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:grantees</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:permissions</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='grantee identifier id'>grantee</span><span class='lbrack token'>[</span><span class='symbol val'>:permissions</span><span class='rbrack token'>]</span>
    <span class='else else kw'>else</span>
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:grantees</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> 
        <span class='lbrace token'>{</span> <span class='symbol val'>:display_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='grantee identifier id'>grantee</span><span class='lbrack token'>[</span><span class='symbol val'>:display_name</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='grantee identifier id'>grantee</span><span class='lbrack token'>[</span><span class='symbol val'>:uri</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='lbrack token'>[</span><span class='regexp val'>/[^\/]*$/</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='symbol val'>:permissions</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='grantee identifier id'>grantee</span><span class='lbrack token'>[</span><span class='symbol val'>:permissions</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='comma token'>,</span>
          <span class='symbol val'>:attributes</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='grantee identifier id'>grantee</span><span class='lbrack token'>[</span><span class='symbol val'>:attributes</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='result identifier id'>result</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_bucket_acl</h3>
</div><div id="get_bucket_acl-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_bucket_acl</span><span class='args'>(bucket, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retieves the ACL (access control policy) for a bucket. Returns a hash of
headers and xml doc with ACL data.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 738</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L738">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">738
739
740
741
742</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_bucket_acl identifier id'>get_bucket_acl</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='get_acl identifier id'>get_acl</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_bucket_acl_link</h3>
</div><div id="get_bucket_acl_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_bucket_acl_link</span><span class='args'>(bucket, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;GetBucketACL&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='get_acl_link identifier id'>get_acl_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 943</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L943">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">943
944
945
946
947</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_bucket_acl_link identifier id'>get_bucket_acl_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='get_acl_link identifier id'>get_acl_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_link</h3>
</div><div id="get_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_link</span><span class='args'>(bucket, key, expires = nil, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;GetObject&#8217;.
</p>
<p>
if a bucket comply with virtual hosting naming then retuns a link with the
bucket as a part of host name:
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='get_link identifier id'>get_link</span><span class='lparen token'>(</span><span class='string val'>'my-awesome-bucket'</span><span class='comma token'>,</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; https://my-awesome-bucket.s3.amazonaws.com:443/asia%2Fcustomers?Signature=nh7...</span>
</pre>
<p>
otherwise returns an old style link (the bucket is a part of path):
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='get_link identifier id'>get_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; https://s3.amazonaws.com:443/my_awesome_bucket/asia%2Fcustomers?Signature=QAO...</span>
</pre>
<p>
see
http://docs.amazonwebservices.com/AmazonS3/2006-03-01/VirtualHosting.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 892</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L892">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">892
893
894
895
896</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_link identifier id'>get_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{AwsUtils::URLencode key}&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_logging_parse</h3>
</div><div id="get_logging_parse-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_logging_parse</span><span class='args'>(params)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retrieves the logging configuration for a bucket. Returns a hash of
<tt>:targetbucket, :targetprefix</tt>
</p>
<p>
s3.interface.get_logging_parse(:bucket =&gt; &quot;asset_bucket&quot;)
</p>
<pre class="code">
  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='symbol val'>:targetbucket=</span><span class='bitand op'>&amp;</span><span class='gt identifier id'>gt</span><span class='semicolon token'>;</span><span class='bitand op'>&amp;</span><span class='quot identifier id'>quot</span><span class='semicolon token'>;</span><span class='mylogbucket identifier id'>mylogbucket</span><span class='bitand op'>&amp;</span><span class='quot identifier id'>quot</span><span class='semicolon token'>;</span><span class='comma token'>,</span> <span class='symbol val'>:targetprefix=</span><span class='bitand op'>&amp;</span><span class='gt identifier id'>gt</span><span class='semicolon token'>;</span><span class='bitand op'>&amp;</span><span class='quot identifier id'>quot</span><span class='semicolon token'>;</span><span class='loggylogs identifier id'>loggylogs</span><span class='div op'>/</span><span class='bitand op'>&amp;</span><span class='quot identifier id'>quot</span><span class='semicolon token'>;</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;
</span></pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 221</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L221">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">221
222
223
224
225
226
227
228
229</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_logging_parse identifier id'>get_logging_parse</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='mandatory_arguments identifier id'>mandatory_arguments</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='allow_only identifier id'>allow_only</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='comma token'>,</span> <span class='symbol val'>:headers</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='unless unless_mod kw'>unless</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{params[:bucket]}?logging&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3LoggingParser constant id'>S3LoggingParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_object</h3>
</div><div id="get_object-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_object</span><span class='args'>(bucket, key, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retrieves object data only (headers are omitted). Returns <tt>string</tt>
or an exception.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='get identifier id'>get</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span> <span class='string val'>'log/curent/1.log'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; 'Ola-la!'</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 798</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L798">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">798
799
800
801
802</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_object identifier id'>get_object</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='get identifier id'>get</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='symbol val'>:object</span><span class='rbrack token'>]</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>head</h3>
</div><div id="head-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>head</span><span class='args'>(bucket, key, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retrieves object metadata. Returns a <tt>hash</tt> of
http_response_headers.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='head identifier id'>head</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span> <span class='string val'>'log/curent/1.log'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt;</span>
   <span class='lbrace token'>{</span><span class='string val'>&quot;last-modified&quot;</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Wed, 23 May 2007 09:08:04 GMT&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;content-type&quot;</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;etag&quot;</span>              <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;\&quot;000000000096f4ee74bc4596443ef2a4\&quot;&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;date&quot;</span>              <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Wed, 23 May 2007 09:08:03 GMT&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;x-amz-id-2&quot;</span>        <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;ZZZZZZZZZZZZZZZZZZZZ1HJXZoehfrS4QxcxTdNGldR7w/FVqblP50fU8cuIMLiu&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;x-amz-meta-family&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Woho556!&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;x-amz-request-id&quot;</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;0000000C246D770C&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;server&quot;</span>            <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;AmazonS3&quot;</span><span class='comma token'>,</span>
    <span class='string val'>&quot;content-length&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;7&quot;</span><span class='rbrace token'>}</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 593</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L593">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">593
594
595
596
597
598</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='head identifier id'>head</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'HEAD'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{CGI::escape key}&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3HttpResponseHeadParser constant id'>S3HttpResponseHeadParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>head_link</h3>
</div><div id="head_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>head_link</span><span class='args'>(bucket, key, expires = nil, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;HeadObject&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='head_link identifier id'>head_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 902</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L902">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">902
903
904
905
906</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='head_link identifier id'>head_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span>  <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'HEAD'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{AwsUtils::URLencode key}&quot;</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>incrementally_list_bucket</h3>
</div><div id="incrementally_list_bucket-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>incrementally_list_bucket</span><span class='args'>(bucket, options = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Incrementally list the contents of a bucket. Yields the following hash to a
block:
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='incrementally_list_bucket identifier id'>incrementally_list_bucket</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='string val'>'prefix'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>'t'</span><span class='comma token'>,</span> <span class='string val'>'marker'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>''</span><span class='comma token'>,</span> <span class='string val'>'max-keys'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>5</span><span class='comma token'>,</span> <span class='delimiter identifier id'>delimiter</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>''</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='yields identifier id'>yields</span>
  <span class='lbrace token'>{</span>
    <span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'bucketname'</span><span class='comma token'>,</span>
    <span class='symbol val'>:prefix</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'subfolder/'</span><span class='comma token'>,</span>
    <span class='symbol val'>:marker</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'fileN.jpg'</span><span class='comma token'>,</span>
    <span class='symbol val'>:max_keys</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>234</span><span class='comma token'>,</span>
    <span class='symbol val'>:delimiter</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'/'</span><span class='comma token'>,</span>
    <span class='symbol val'>:is_truncated</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span>
    <span class='symbol val'>:next_marker</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'fileX.jpg'</span><span class='comma token'>,</span>
    <span class='symbol val'>:contents</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span>
      <span class='lbrace token'>{</span> <span class='symbol val'>:key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;file1&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:last_modified</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;2007-05-18T07:00:59.000Z&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:e_tag</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;000000000059075b964b07152d234b70&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:size</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>3</span><span class='comma token'>,</span>
        <span class='symbol val'>:storage_class</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;STANDARD&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:owner_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;00000000009314cc309ffe736daa2b264357476c7fea6efb2c3347ac3ab2792a&quot;</span><span class='comma token'>,</span>
        <span class='symbol val'>:owner_display_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;root&quot;</span>
      <span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='symbol val'>:key</span><span class='comma token'>,</span> <span class='dot3 op'>...</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='dot3 op'>...</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='dot3 op'>...</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;
    ]
    :common_prefixes =&gt; [
      &quot;prefix1&quot;,
      &quot;prefix2&quot;,
      ...,
      &quot;prefixN&quot;
    ]
  }
</span></pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 309</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L309">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='incrementally_list_bucket identifier id'>incrementally_list_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='internal_options identifier id'>internal_options</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='symbolize_keys identifier id'>symbolize_keys</span>
  <span class='begin begin kw'>begin</span> 
    <span class='internal_bucket identifier id'>internal_bucket</span> <span class='assign token'>=</span> <span class='bucket identifier id'>bucket</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='internal_bucket identifier id'>internal_bucket</span>  <span class='opasgn op'>+=</span> <span class='string val'>'?'</span><span class='plus op'>+</span><span class='internal_options identifier id'>internal_options</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;#{k.to_s}=#{CGI::escape v.to_s}&quot;</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'&amp;'</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='internal_options identifier id'>internal_options</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
    <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='internal_bucket identifier id'>internal_bucket</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3ImprovedListBucketParser constant id'>S3ImprovedListBucketParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:logger</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@logger ivar id'>@logger</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='there_are_more_keys identifier id'>there_are_more_keys</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='lbrack token'>[</span><span class='symbol val'>:is_truncated</span><span class='rbrack token'>]</span>
    <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='there_are_more_keys identifier id'>there_are_more_keys</span><span class='rparen token'>)</span>
      <span class='internal_options identifier id'>internal_options</span><span class='lbrack token'>[</span><span class='symbol val'>:marker</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='decide_marker identifier id'>decide_marker</span><span class='lparen token'>(</span><span class='response identifier id'>response</span><span class='rparen token'>)</span>
      <span class='total_results identifier id'>total_results</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='lbrack token'>[</span><span class='symbol val'>:contents</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='plus op'>+</span> <span class='response identifier id'>response</span><span class='lbrack token'>[</span><span class='symbol val'>:common_prefixes</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
      <span class='internal_options identifier id'>internal_options</span><span class='lbrack token'>[</span><span class='symbol val'>:'max-keys'</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='lparen token'>(</span><span class='internal_options identifier id'>internal_options</span><span class='lbrack token'>[</span><span class='symbol val'>:'max-keys'</span><span class='rbrack token'>]</span> <span class='opasgn op'>-=</span> <span class='total_results identifier id'>total_results</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span> 
    <span class='end end kw'>end</span>
    <span class='yield yield kw'>yield</span> <span class='response identifier id'>response</span>
  <span class='end end kw'>end</span> <span class='while while_mod kw'>while</span> <span class='there_are_more_keys identifier id'>there_are_more_keys</span> <span class='andop op'>&amp;&amp;</span> <span class='under_max_keys identifier id'>under_max_keys</span><span class='lparen token'>(</span><span class='internal_options identifier id'>internal_options</span><span class='rparen token'>)</span>
  <span class='true true kw'>true</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>is_dns_bucket?</h3>
</div><div id="is_dns_bucket-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>is_dns_bucket?</span><span class='args'>(bucket_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
http://docs.amazonwebservices.com/AmazonS3/2006-03-01/index.html?BucketRestrictions.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 105</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L105">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">105
106
107
108
109
110
111
112</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='is_dns_bucket? fid id'>is_dns_bucket?</span><span class='lparen token'>(</span><span class='bucket_name identifier id'>bucket_name</span><span class='rparen token'>)</span>
  <span class='bucket_name identifier id'>bucket_name</span> <span class='assign token'>=</span> <span class='bucket_name identifier id'>bucket_name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='float val'>3</span><span class='dot2 op'>..</span><span class='integer val'>63</span><span class='rparen token'>)</span> <span class='eqq op'>===</span> <span class='bucket_name identifier id'>bucket_name</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
  <span class='bucket_name identifier id'>bucket_name</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'.'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='component identifier id'>component</span><span class='bitor op'>|</span>
    <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span> <span class='unless unless_mod kw'>unless</span> <span class='component identifier id'>component</span><span class='lbrack token'>[</span><span class='regexp val'>/^[a-z0-9]([a-z0-9-]*[a-z0-9])?$/</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>list_all_my_buckets</h3>
</div><div id="list_all_my_buckets-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>list_all_my_buckets</span><span class='args'>(headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array of customer&#8217;s buckets. Each item is a <tt>hash</tt>.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='list_all_my_buckets identifier id'>list_all_my_buckets</span> <span class='comment val'>#=&gt;</span>
   <span class='lbrack token'>[</span><span class='lbrace token'>{</span><span class='symbol val'>:owner_id</span>           <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;00000000009314cc309ffe736daa2b264357476c7fea6efb2c3347ac3ab2792a&quot;</span><span class='comma token'>,</span>
     <span class='symbol val'>:owner_display_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;root&quot;</span><span class='comma token'>,</span>
     <span class='symbol val'>:name</span>               <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;bucket_name&quot;</span><span class='comma token'>,</span>
     <span class='symbol val'>:creation_date</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;2007-04-19T18:47:43.000Z&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='dot3 op'>...</span><span class='comma token'>,</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='dot3 op'>...</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;]
</span></pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 173</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L173">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">173
174
175
176
177
178</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='list_all_my_buckets identifier id'>list_all_my_buckets</span><span class='lparen token'>(</span><span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='string val'>''</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3ListAllMyBucketsParser constant id'>S3ListAllMyBucketsParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:logger</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@logger ivar id'>@logger</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>list_all_my_buckets_link</h3>
</div><div id="list_all_my_buckets_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>list_all_my_buckets_link</span><span class='args'>(expires = nil, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;ListAllMyBuckets&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='list_all_my_buckets_link identifier id'>list_all_my_buckets_link</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 833</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L833">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">833
834
835
836
837</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='list_all_my_buckets_link identifier id'>list_all_my_buckets_link</span><span class='lparen token'>(</span><span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='string val'>''</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>list_bucket</h3>
</div><div id="list_bucket-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>list_bucket</span><span class='args'>(bucket, options = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array of bucket&#8217;s keys. Each array item (key data) is a
<tt>hash</tt>.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='list_bucket identifier id'>list_bucket</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='string val'>'prefix'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>'t'</span><span class='comma token'>,</span> <span class='string val'>'marker'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>''</span><span class='comma token'>,</span> <span class='string val'>'max-keys'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='integer val'>5</span><span class='comma token'>,</span> <span class='delimiter identifier id'>delimiter</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>''</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt;</span>
   <span class='lbrack token'>[</span><span class='lbrace token'>{</span><span class='symbol val'>:key</span>                <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;test1&quot;</span><span class='comma token'>,</span>
     <span class='symbol val'>:last_modified</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;2007-05-18T07:00:59.000Z&quot;</span><span class='comma token'>,</span>
     <span class='symbol val'>:owner_id</span>           <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;00000000009314cc309ffe736daa2b264357476c7fea6efb2c3347ac3ab2792a&quot;</span><span class='comma token'>,</span>
     <span class='symbol val'>:owner_display_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;root&quot;</span><span class='comma token'>,</span>
     <span class='symbol val'>:e_tag</span>              <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;000000000059075b964b07152d234b70&quot;</span><span class='comma token'>,</span>
     <span class='symbol val'>:storage_class</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;STANDARD&quot;</span><span class='comma token'>,</span>
     <span class='symbol val'>:size</span>               <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>3</span><span class='comma token'>,</span>
     <span class='symbol val'>:service=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>'is_truncated'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span><span class='comma token'>,</span>
                 <span class='string val'>'prefix'</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;t&quot;</span><span class='comma token'>,</span>
                 <span class='string val'>'marker'</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;&quot;</span><span class='comma token'>,</span>
                 <span class='string val'>'name'</span>         <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;my_awesome_bucket&quot;</span><span class='comma token'>,</span>
                 <span class='string val'>'max-keys'</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;5&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='dot3 op'>...</span><span class='comma token'>,</span> <span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='dot3 op'>...</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;]
</span></pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 274</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L274">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">274
275
276
277
278
279
280</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='list_bucket identifier id'>list_bucket</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='bucket identifier id'>bucket</span>  <span class='opasgn op'>+=</span> <span class='string val'>'?'</span><span class='plus op'>+</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;#{k.to_s}=#{CGI::escape v.to_s}&quot;</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'&amp;'</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3ListBucketParser constant id'>S3ListBucketParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:logger</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@logger ivar id'>@logger</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>list_bucket_link</h3>
</div><div id="list_bucket_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>list_bucket_link</span><span class='args'>(bucket, options = nil, expires = nil, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;ListBucket&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='list_bucket_link identifier id'>list_bucket_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 863</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L863">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">863
864
865
866
867
868</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='list_bucket_link identifier id'>list_bucket_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='bucket identifier id'>bucket</span> <span class='opasgn op'>+=</span> <span class='string val'>'?'</span> <span class='plus op'>+</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;#{k.to_s}=#{CGI::escape v.to_s}&quot;</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'&amp;'</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
  <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='bucket identifier id'>bucket</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>move</h3>
</div><div id="move-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>move</span><span class='args'>(src_bucket, src_key, dest_bucket, dest_key = nil, directive = :copy, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Move an object.
</p>
<pre class="code">
 <span class='directive identifier id'>directive</span><span class='colon op'>:</span> <span class='symbol val'>:copy</span>    <span class='minus op'>-</span> <span class='copy identifier id'>copy</span> <span class='meta identifier id'>meta</span><span class='minus op'>-</span><span class='headers identifier id'>headers</span> <span class='from identifier id'>from</span> <span class='source identifier id'>source</span> <span class='lparen token'>(</span><span class='default identifier id'>default</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>
            <span class='symbol val'>:replace</span> <span class='minus op'>-</span> <span class='replace identifier id'>replace</span> <span class='meta identifier id'>meta</span><span class='minus op'>-</span><span class='headers identifier id'>headers</span> <span class='by identifier id'>by</span> <span class='passed identifier id'>passed</span> <span class='ones identifier id'>ones</span>

 <span class='comment val'># move bucket1/key1 to bucket1/key2</span>
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='move identifier id'>move</span><span class='lparen token'>(</span><span class='string val'>'bucket1'</span><span class='comma token'>,</span> <span class='string val'>'key1'</span><span class='comma token'>,</span> <span class='string val'>'bucket1'</span><span class='comma token'>,</span> <span class='string val'>'key2'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; &lt;tt&gt;:last_modified=&amp;gt;&amp;quot;2008-05-11T10:27:22.000Z&amp;quot;&lt;/tt&gt;</span>

 <span class='comment val'># move bucket1/key1 to bucket2/key2 with new meta-headers assignment</span>
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='copy identifier id'>copy</span><span class='lparen token'>(</span><span class='string val'>'bucket1'</span><span class='comma token'>,</span> <span class='string val'>'key1'</span><span class='comma token'>,</span> <span class='string val'>'bucket2'</span><span class='comma token'>,</span> <span class='string val'>'key2'</span><span class='comma token'>,</span> <span class='symbol val'>:replace</span><span class='comma token'>,</span> <span class='string val'>'x-amz-meta-family'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>'Woho555!'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; &lt;tt&gt;:last_modified=&amp;gt;&amp;quot;2008-05-11T10:28:22.000Z&amp;quot;&lt;/tt&gt;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 644</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L644">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">644
645
646
647
648
649</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='move identifier id'>move</span><span class='lparen token'>(</span><span class='src_bucket identifier id'>src_bucket</span><span class='comma token'>,</span> <span class='src_key identifier id'>src_key</span><span class='comma token'>,</span> <span class='dest_bucket identifier id'>dest_bucket</span><span class='comma token'>,</span> <span class='dest_key identifier id'>dest_key</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='directive identifier id'>directive</span><span class='assign token'>=</span><span class='symbol val'>:copy</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='copy_result identifier id'>copy_result</span> <span class='assign token'>=</span> <span class='copy identifier id'>copy</span><span class='lparen token'>(</span><span class='src_bucket identifier id'>src_bucket</span><span class='comma token'>,</span> <span class='src_key identifier id'>src_key</span><span class='comma token'>,</span> <span class='dest_bucket identifier id'>dest_bucket</span><span class='comma token'>,</span> <span class='dest_key identifier id'>dest_key</span><span class='comma token'>,</span> <span class='directive identifier id'>directive</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='rparen token'>)</span>
  <span class='comment val'># delete an original key if it differs from a destination one</span>
  <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='src_bucket identifier id'>src_bucket</span><span class='comma token'>,</span> <span class='src_key identifier id'>src_key</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='src_bucket identifier id'>src_bucket</span> <span class='eq op'>==</span> <span class='dest_bucket identifier id'>dest_bucket</span> <span class='andop op'>&amp;&amp;</span> <span class='src_key identifier id'>src_key</span> <span class='eq op'>==</span> <span class='dest_key identifier id'>dest_key</span>
  <span class='copy_result identifier id'>copy_result</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>put</h3>
</div><div id="put-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>put</span><span class='args'>(bucket, key, data = nil, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Saves object to Amazon. Returns <tt>true</tt> or an exception. Any header
starting with AMAZON_METADATA_PREFIX is considered user metadata. It will
be stored with the object and returned when you retrieve the object. The
total size of the HTTP request, not including the body, must be less than 4
KB.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='put identifier id'>put</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span> <span class='string val'>'log/current/1.log'</span><span class='comma token'>,</span> <span class='string val'>'Ola-la!'</span><span class='comma token'>,</span> <span class='string val'>'x-amz-meta-family'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>'Woho556!'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; true</span>
</pre>
<p>
This method is capable of &#8216;streaming&#8217; uploads; that is, it can
upload data from a file or other IO object without first reading all the
data into memory. This is most useful for large PUTs - it is difficult to
read a 2 GB file entirely into memory before sending it to S3. To stream an
upload, pass an object that responds to &#8216;read&#8217; (like the read
method of IO) and to either &#8216;lstat&#8217; or &#8216;size&#8217;. For
files, this means streaming is enabled by simply making the call:
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='put identifier id'>put</span><span class='lparen token'>(</span><span class='bucket_name identifier id'>bucket_name</span><span class='comma token'>,</span> <span class='string val'>'S3keyname.forthisfile'</span><span class='comma token'>,</span>  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>'localfilename.dat'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
</pre>
<p>
If the IO object you wish to stream from responds to the read method but
doesn&#8217;t implement lstat or size, you can extend the object
dynamically to implement these methods, or define your own class which
defines these methods. Be sure that your class returns &#8216;nil&#8217;
from read() after having read &#8216;size&#8217; bytes. Otherwise S3 will
drop the socket after &#8216;Content-Length&#8217; bytes have been
uploaded, and HttpConnection will interpret this as an error.
</p>
<p>
This method now supports very large PUTs, where very large is &gt; 2 GB.
</p>
<p>
For Win32 users: Files and IO objects should be opened in binary mode. If a
text mode IO object is passed to PUT, it will be converted to binary mode.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 384</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L384">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">384
385
386
387
388
389
390
391
392
393
394
395
396
397
398</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='put identifier id'>put</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='data identifier id'>data</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='comment val'># On Windows, if someone opens a file in text mode, we must reset it so</span>
  <span class='comment val'># to binary mode for streaming to work properly</span>
  <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='binmode identifier id'>binmode</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='binmode identifier id'>binmode</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='lstat identifier id'>lstat</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='lstat identifier id'>lstat</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='USE_100_CONTINUE_PUT_SIZE constant id'>USE_100_CONTINUE_PUT_SIZE</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
     <span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:size</span><span class='rparen token'>)</span>  <span class='andop op'>&amp;&amp;</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='size identifier id'>size</span>       <span class='geq op'>&gt;=</span> <span class='USE_100_CONTINUE_PUT_SIZE constant id'>USE_100_CONTINUE_PUT_SIZE</span><span class='rparen token'>)</span>
    <span class='headers identifier id'>headers</span><span class='lbrack token'>[</span><span class='string val'>'expect'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>'100-continue'</span>
  <span class='end end kw'>end</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'PUT'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{CGI::escape key}&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:data=</span><span class='gt op'>&gt;</span><span class='data identifier id'>data</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='RightHttp2xxParser constant id'>RightHttp2xxParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>put_acl</h3>
</div><div id="put_acl-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>put_acl</span><span class='args'>(bucket, key, acl_xml_doc, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sets the ACL on a bucket or object.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 729</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L729">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">729
730
731
732
733
734
735</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='put_acl identifier id'>put_acl</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='acl_xml_doc identifier id'>acl_xml_doc</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='key identifier id'>key</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span> <span class='integer val'>? </span><span class='string val'>''</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;/#{CGI::escape key}&quot;</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'PUT'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}#{key}?acl&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:data=</span><span class='gt op'>&gt;</span><span class='acl_xml_doc identifier id'>acl_xml_doc</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3HttpResponseBodyParser constant id'>S3HttpResponseBodyParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>put_acl_link</h3>
</div><div id="put_acl_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>put_acl_link</span><span class='args'>(bucket, key = '', headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;PutACL&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='put_acl_link identifier id'>put_acl_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 933</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L933">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">933
934
935
936
937</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='put_acl_link identifier id'>put_acl_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='assign token'>=</span><span class='string val'>''</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'PUT'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{AwsUtils::URLencode key}?acl&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>put_bucket_acl</h3>
</div><div id="put_bucket_acl-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>put_bucket_acl</span><span class='args'>(bucket, acl_xml_doc, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sets the ACL on a bucket only.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 745</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L745">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">745
746
747
748
749</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='put_bucket_acl identifier id'>put_bucket_acl</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='acl_xml_doc identifier id'>acl_xml_doc</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='put_acl identifier id'>put_acl</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='comma token'>,</span> <span class='acl_xml_doc identifier id'>acl_xml_doc</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>put_bucket_acl_link</h3>
</div><div id="put_bucket_acl_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>put_bucket_acl_link</span><span class='args'>(bucket, acl_xml_doc, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;PutBucketACL&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='put_acl_link identifier id'>put_acl_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 953</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L953">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">953
954
955
956
957</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='put_bucket_acl_link identifier id'>put_bucket_acl_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='acl_xml_doc identifier id'>acl_xml_doc</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='put_acl_link identifier id'>put_acl_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='comma token'>,</span> <span class='acl_xml_doc identifier id'>acl_xml_doc</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>put_link</h3>
</div><div id="put_link-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>put_link</span><span class='args'>(bucket, key, data = nil, expires = nil, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates link for &#8216;PutObject&#8217;.
</p>
<pre class="code">
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='put_link identifier id'>put_link</span><span class='lparen token'>(</span><span class='string val'>'my_awesome_bucket'</span><span class='comma token'>,</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='object identifier id'>object</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; url string</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 874</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L874">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">874
875
876
877
878</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='put_link identifier id'>put_link</span><span class='lparen token'>(</span><span class='bucket identifier id'>bucket</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='data identifier id'>data</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='generate_link identifier id'>generate_link</span><span class='lparen token'>(</span><span class='string val'>'PUT'</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{bucket}/#{AwsUtils::URLencode key}&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:data=</span><span class='gt op'>&gt;</span><span class='data identifier id'>data</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='expires identifier id'>expires</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>put_logging</h3>
</div><div id="put_logging-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>put_logging</span><span class='args'>(params)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sets logging configuration for a bucket from the XML configuration
document.
</p>
<pre class="code">
  <span class='params identifier id'>params</span><span class='colon op'>:</span>
   <span class='symbol val'>:bucket</span>
   <span class='symbol val'>:xmldoc</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 235</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L235">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">235
236
237
238
239
240
241
242
243</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='put_logging identifier id'>put_logging</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span>  
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='mandatory_arguments identifier id'>mandatory_arguments</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='comma token'>,</span><span class='symbol val'>:xmldoc</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='allow_only identifier id'>allow_only</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='comma token'>,</span><span class='symbol val'>:xmldoc</span><span class='comma token'>,</span> <span class='symbol val'>:headers</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='unless unless_mod kw'>unless</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'PUT'</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{params[:bucket]}?logging&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:data</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:xmldoc</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3TrueParser constant id'>S3TrueParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>rename</h3>
</div><div id="rename-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>rename</span><span class='args'>(src_bucket, src_key, dest_key, headers = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Rename an object.
</p>
<pre class="code">
 <span class='comment val'># rename bucket1/key1 to bucket1/key2</span>
 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='rename identifier id'>rename</span><span class='lparen token'>(</span><span class='string val'>'bucket1'</span><span class='comma token'>,</span> <span class='string val'>'key1'</span><span class='comma token'>,</span> <span class='string val'>'key2'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; &lt;tt&gt;:last_modified=&amp;gt;&amp;quot;2008-05-11T10:29:22.000Z&amp;quot;&lt;/tt&gt;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 656</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L656">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">656
657
658</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='rename identifier id'>rename</span><span class='lparen token'>(</span><span class='src_bucket identifier id'>src_bucket</span><span class='comma token'>,</span> <span class='src_key identifier id'>src_key</span><span class='comma token'>,</span> <span class='dest_key identifier id'>dest_key</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='assign token'>=</span><span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='move identifier id'>move</span><span class='lparen token'>(</span><span class='src_bucket identifier id'>src_bucket</span><span class='comma token'>,</span> <span class='src_key identifier id'>src_key</span><span class='comma token'>,</span> <span class='src_bucket identifier id'>src_bucket</span><span class='comma token'>,</span> <span class='dest_key identifier id'>dest_key</span><span class='comma token'>,</span> <span class='symbol val'>:copy</span><span class='comma token'>,</span> <span class='headers identifier id'>headers</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>request_info</h3>
</div><div id="request_info-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>request_info</span><span class='args'>(request, parser, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sends request to Amazon and parses the response. Raises AwsError if any
banana happened.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 158</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L158">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">158
159
160
161
162</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='thread identifier id'>thread</span> <span class='assign token'>=</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:multi_thread</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='Thread constant id'>Thread</span><span class='dot token'>.</span><span class='current identifier id'>current</span> <span class='colon op'>:</span> <span class='Thread constant id'>Thread</span><span class='dot token'>.</span><span class='main identifier id'>main</span>
  <span class='thread identifier id'>thread</span><span class='lbrack token'>[</span><span class='symbol val'>:s3_connection</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='Rightscale constant id'>Rightscale</span><span class='colon2 op'>::</span><span class='HttpConnection constant id'>HttpConnection</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='AwsError constant id'>AwsError</span><span class='comma token'>,</span> <span class='symbol val'>:logger</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@logger ivar id'>@logger</span><span class='rparen token'>)</span>
  <span class='request_info_impl identifier id'>request_info_impl</span><span class='lparen token'>(</span><span class='thread identifier id'>thread</span><span class='lbrack token'>[</span><span class='symbol val'>:s3_connection</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='@@bench ivar id'>@@bench</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>retrieve_object</h3>
</div><div id="retrieve_object-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>retrieve_object</span><span class='args'>(params, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
New experimental API for retrieving objects, introduced in RightAws 1.8.1.
retrieve_object is similar in function to the older function get. It allows
for optional verification of object md5 checksums on retrieval. Parameters
are passed as hash entries and are checked for completeness as well as for
spurious arguments.
</p>
<p>
If the optional :md5 argument is provided, retrieve_object verifies that
the given md5 matches the md5 returned by S3. The :verified_md5 field in
the response hash is set true or false depending on the outcome of this
check. If no :md5 argument is given, :verified_md5 will be false in the
response.
</p>
<p>
The optional argument of :headers allows the caller to specify arbitrary
request header values. Mandatory arguments:
</p>
<pre class="code">
  <span class='symbol val'>:bucket</span> <span class='minus op'>-</span> <span class='the identifier id'>the</span> <span class='bucket identifier id'>bucket</span> <span class='in in kw'>in</span> <span class='which identifier id'>which</span> <span class='the identifier id'>the</span> <span class='object identifier id'>object</span> <span class='is identifier id'>is</span> <span class='stored identifier id'>stored</span>
  <span class='symbol val'>:key</span>    <span class='minus op'>-</span> <span class='the identifier id'>the</span> <span class='object identifier id'>object</span> <span class='address identifier id'>address</span> <span class='lparen token'>(</span><span class='or or kw'>or</span> <span class='path identifier id'>path</span><span class='rparen token'>)</span> <span class='within identifier id'>within</span> <span class='the identifier id'>the</span> <span class='bucket identifier id'>bucket</span>
</pre>
<p>
Optional arguments:
</p>
<pre class="code">
  <span class='symbol val'>:headers</span> <span class='minus op'>-</span> <span class='hash identifier id'>hash</span> <span class='of identifier id'>of</span> <span class='additional identifier id'>additional</span> <span class='HTTP constant id'>HTTP</span> <span class='headers identifier id'>headers</span> <span class='to identifier id'>to</span> <span class='include identifier id'>include</span> <span class='with identifier id'>with</span> <span class='the identifier id'>the</span> <span class='request identifier id'>request</span>
  <span class='symbol val'>:md5</span>     <span class='minus op'>-</span> <span class='MD5 constant id'>MD5</span> <span class='checksum identifier id'>checksum</span> <span class='against identifier id'>against</span> <span class='which identifier id'>which</span> <span class='to identifier id'>to</span> <span class='verify identifier id'>verify</span> <span class='the identifier id'>the</span> <span class='retrieved identifier id'>retrieved</span> <span class='object identifier id'>object</span>

 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='retrieve_object identifier id'>retrieve_object</span><span class='lparen token'>(</span><span class='symbol val'>:bucket</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;foobucket&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;foo&quot;</span><span class='rparen token'>)</span>
   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:verified_md5=</span><span class='gt op'>&gt;</span><span class='false false kw'>false</span><span class='comma token'>,</span>
       <span class='symbol val'>:headers=</span><span class='gt op'>&gt;</span><span class='lbrace token'>{</span><span class='string val'>&quot;last-modified&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Mon, 29 Sep 2008 18:58:56 GMT&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;x-amz-id-2&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;2Aj3TDz6HP5109qly//18uHZ2a1TNHGLns9hyAtq2ved7wmzEXDOPGRHOYEa3Qnp&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;content-type&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;etag&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;\&quot;a507841b1bc8115094b00bbe8c1b2954\&quot;&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;date&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Tue, 30 Sep 2008 00:52:44 GMT&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;x-amz-request-id&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;EE4855DE27A2688C&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;server&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;AmazonS3&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;content-length&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;10&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
       <span class='symbol val'>:object=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;polemonium&quot;</span><span class='rbrace token'>}</span>

 <span class='s3 identifier id'>s3</span><span class='dot token'>.</span><span class='retrieve_object identifier id'>retrieve_object</span><span class='lparen token'>(</span><span class='symbol val'>:bucket</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;foobucket&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;foo&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:md5=</span><span class='gt op'>&gt;</span><span class='string val'>'a507841b1bc8115094b00bbe8c1b2954'</span><span class='rparen token'>)</span>
   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:verified_md5=</span><span class='gt op'>&gt;</span><span class='true true kw'>true</span><span class='comma token'>,</span>
       <span class='symbol val'>:headers=</span><span class='gt op'>&gt;</span><span class='lbrace token'>{</span><span class='string val'>&quot;last-modified&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Mon, 29 Sep 2008 18:58:56 GMT&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;x-amz-id-2&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;mLWQcI&lt;tt&gt;VuKVIdpTaPXEo84g0cz&lt;/tt&gt;vzmRLbj79TS8eFPfw19cGFOPxuLy4uGYVCvdH&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;content-type&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;etag&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;\&quot;a507841b1bc8115094b00bbe8c1b2954\&quot;&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;date&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Tue, 30 Sep 2008 00:53:08 GMT&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;x-amz-request-id&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;6E7F317356580599&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;server&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;AmazonS3&quot;</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;content-length&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;10&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
       <span class='symbol val'>:object=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;polemonium&quot;</span><span class='rbrace token'>}</span>
</pre>
<p>
If a block is provided, yields incrementally to the block as the response
is read. For large responses, this function is ideal as the response can be
&#8216;streamed&#8217;. The hash containing header fields is still
returned.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 555</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L555">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">555
556
557
558
559
560
561
562
563
564
565
566
567
568</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='retrieve_object identifier id'>retrieve_object</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='mandatory_arguments identifier id'>mandatory_arguments</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='comma token'>,</span> <span class='symbol val'>:key</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='allow_only identifier id'>allow_only</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='comma token'>,</span> <span class='symbol val'>:key</span><span class='comma token'>,</span> <span class='symbol val'>:headers</span><span class='comma token'>,</span> <span class='symbol val'>:md5</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='unless unless_mod kw'>unless</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span>
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'GET'</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{params[:bucket]}/#{CGI::escape params[:key]}&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='resp identifier id'>resp</span> <span class='assign token'>=</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3HttpResponseBodyParser constant id'>S3HttpResponseBodyParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='resp identifier id'>resp</span><span class='lbrack token'>[</span><span class='symbol val'>:verified_md5</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='md5 identifier id'>md5</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='resp identifier id'>resp</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='headers identifier id'>headers</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'etag'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/\&quot;/</span><span class='comma token'>,</span><span class='string val'>''</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:md5</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='resp identifier id'>resp</span><span class='lbrack token'>[</span><span class='symbol val'>:verified_md5</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
  <span class='resp identifier id'>resp</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>retrieve_object_and_verify</h3>
</div><div id="retrieve_object_and_verify-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>retrieve_object_and_verify</span><span class='args'>(params, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Identical in function to retrieve_object, but requires verification that
the returned ETag is identical to the checksum passed in by the user as the
&#8216;md5&#8217; argument. If the check passes, returns the response
metadata with the &quot;verified_md5&quot; field set true. Raises an
exception if the checksums conflict. This call is implemented as a wrapper
around retrieve_object and the user may gain different semantics by
creating a custom wrapper.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="param">
  <h3>Parameters:</h3>
  <dl>
  
  </dl>
</div><div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt><a title="AwsError" href="AwsError.html">AwsError</a></tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 573</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L573">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">573
574
575
576
577
578</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='retrieve_object_and_verify identifier id'>retrieve_object_and_verify</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='mandatory_arguments identifier id'>mandatory_arguments</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:md5</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='resp identifier id'>resp</span> <span class='assign token'>=</span> <span class='retrieve_object identifier id'>retrieve_object</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='resp identifier id'>resp</span> <span class='if if_mod kw'>if</span> <span class='resp identifier id'>resp</span><span class='lbrack token'>[</span><span class='symbol val'>:verified_md5</span><span class='rbrack token'>]</span>
  <span class='raise identifier id'>raise</span> <span class='AwsError constant id'>AwsError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Retrieved object failed MD5 checksum verification: #{resp.inspect}&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>store_object</h3>
</div><div id="store_object-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>store_object</span><span class='args'>(params)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
New experimental API for uploading objects, introduced in RightAws 1.8.1.
store_object is similar in function to the older function put, but returns
the full response metadata. It also allows for optional verification of
object md5 checksums on upload. Parameters are passed as hash entries and
are checked for completeness as well as for spurious arguments. The hash of
the response headers contains useful information like the Amazon request ID
and the object ETag (MD5 checksum).
</p>
<p>
If the optional :md5 argument is provided, store_object verifies that the
given md5 matches the md5 returned by S3. The :verified_md5 field in the
response hash is set true or false depending on the outcome of this check.
If no :md5 argument is given, :verified_md5 will be false in the response.
</p>
<p>
The optional argument of :headers allows the caller to specify arbitrary
request header values.
</p>
<p>
s3.store_object(:bucket =&gt; &quot;foobucket&quot;, :key =&gt;
&quot;foo&quot;, :md5 =&gt; &quot;a507841b1bc8115094b00bbe8c1b2954&quot;,
:data =&gt; &quot;polemonium&quot; )
</p>
<pre class="code">
  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;x-amz-id-2&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;SVsnS2nfDaR&lt;tt&gt;ixyJUlRKM8GndRyEMS16&lt;/tt&gt;oZRieamuL61pPxPaTuWrWtlYaEhYrI/&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;etag&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;\&quot;a507841b1bc8115094b00bbe8c1b2954\&quot;&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;date&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Mon, 29 Sep 2008 18:57:46 GMT&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:verified_md5=</span><span class='gt op'>&gt;</span><span class='true true kw'>true</span><span class='comma token'>,</span>
      <span class='string val'>&quot;x-amz-request-id&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;63916465939995BA&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;server&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;AmazonS3&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;content-length&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0&quot;</span><span class='rbrace token'>}</span>
</pre>
<p>
s3.store_object(:bucket =&gt; &quot;foobucket&quot;, :key =&gt;
&quot;foo&quot;, :data =&gt; &quot;polemonium&quot; )
</p>
<pre class="code">
  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;x-amz-id-2&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;MAt9PLjgLX9UYJ5tV2fI/5dBZdpFjlzRVpWgBDpvZpl&lt;tt&gt;V&lt;/tt&gt;gJFcBMW2L+LBstYpbR&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;etag&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;\&quot;a507841b1bc8115094b00bbe8c1b2954\&quot;&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;date&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Mon, 29 Sep 2008 18:58:56 GMT&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:verified_md5=</span><span class='gt op'>&gt;</span><span class='false false kw'>false</span><span class='comma token'>,</span>
      <span class='string val'>&quot;x-amz-request-id&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;3B25A996BC2CDD3B&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;server&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;AmazonS3&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;content-length&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0&quot;</span><span class='rbrace token'>}</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 430</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L430">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='store_object identifier id'>store_object</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='allow_only identifier id'>allow_only</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='comma token'>,</span> <span class='symbol val'>:key</span><span class='comma token'>,</span> <span class='symbol val'>:data</span><span class='comma token'>,</span> <span class='symbol val'>:headers</span><span class='comma token'>,</span> <span class='symbol val'>:md5</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='mandatory_arguments identifier id'>mandatory_arguments</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:bucket</span><span class='comma token'>,</span> <span class='symbol val'>:key</span><span class='comma token'>,</span> <span class='symbol val'>:data</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='unless unless_mod kw'>unless</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span>
      
  <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='binmode identifier id'>binmode</span> <span class='if if_mod kw'>if</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:binmode</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='comment val'># On Windows, if someone opens a file in text mode, we must reset it to binary mode for streaming to work properly</span>
  <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='data identifier id'>data</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='colon op'>:</span><span class='lstat identifier id'>lstat</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='data identifier id'>data</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='lstat identifier id'>lstat</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='geq op'>&gt;=</span> <span class='USE_100_CONTINUE_PUT_SIZE constant id'>USE_100_CONTINUE_PUT_SIZE</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
     <span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:size</span><span class='rparen token'>)</span>  <span class='andop op'>&amp;&amp;</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='size identifier id'>size</span>       <span class='geq op'>&gt;=</span> <span class='USE_100_CONTINUE_PUT_SIZE constant id'>USE_100_CONTINUE_PUT_SIZE</span><span class='rparen token'>)</span>
    <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'expect'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>'100-continue'</span>
  <span class='end end kw'>end</span>
  
  <span class='req_hash identifier id'>req_hash</span> <span class='assign token'>=</span> <span class='generate_rest_request identifier id'>generate_rest_request</span><span class='lparen token'>(</span><span class='string val'>'PUT'</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:headers</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:url=</span><span class='gt op'>&gt;</span><span class='dstring node'>&quot;#{params[:bucket]}/#{CGI::escape params[:key]}&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:data=</span><span class='gt op'>&gt;</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:data</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='resp identifier id'>resp</span> <span class='assign token'>=</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='req_hash identifier id'>req_hash</span><span class='comma token'>,</span> <span class='S3HttpResponseHeadParser constant id'>S3HttpResponseHeadParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='md5 identifier id'>md5</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='resp identifier id'>resp</span><span class='lbrack token'>[</span><span class='symbol val'>:verified_md5</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='resp identifier id'>resp</span><span class='lbrack token'>[</span><span class='string val'>'etag'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/\&quot;/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:md5</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='true true kw'>true</span> <span class='colon op'>:</span> <span class='false false kw'>false</span>
  <span class='else else kw'>else</span>
    <span class='resp identifier id'>resp</span><span class='lbrack token'>[</span><span class='symbol val'>:verified_md5</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>
  <span class='resp identifier id'>resp</span>
<span class='rescue rescue kw'>rescue</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>store_object_and_verify</h3>
</div><div id="store_object_and_verify-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>store_object_and_verify</span><span class='args'>(params)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Identical in function to store_object, but requires verification that the
returned ETag is identical to the checksum passed in by the user as the
&#8216;md5&#8217; argument. If the check passes, returns the response
metadata with the &quot;verified_md5&quot; field set true. Raises an
exception if the checksums conflict. This call is implemented as a wrapper
around store_object and the user may gain different semantics by creating a
custom wrapper.
</p>
<p>
s3.store_object_and_verify(:bucket =&gt; &quot;foobucket&quot;, :key =&gt;
&quot;foo&quot;, :md5 =&gt; &quot;a507841b1bc8115094b00bbe8c1b2954&quot;,
:data =&gt; &quot;polemonium&quot; )
</p>
<pre class="code">
  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;x-amz-id-2&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;IZN3XsH4FlBU0&lt;tt&gt;XYkFTfHwaiF1tNzrm6dIW2EM/cthKvl71nldfVC0oVQyydzWpb&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;etag&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;\&quot;a507841b1bc8115094b00bbe8c1b2954\&quot;&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;date&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Mon, 29 Sep 2008 18:38:32 GMT&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:verified_md5=</span><span class='gt op'>&gt;</span><span class='true true kw'>true</span><span class='comma token'>,</span>
      <span class='string val'>&quot;x-amz-request-id&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;E8D7EA4FE00F5DF7&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;server&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;AmazonS3&quot;</span><span class='comma token'>,</span>
      <span class='string val'>&quot;content-length&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0&quot;</span><span class='rbrace token'>}</span>
</pre>
<p>
s3.store_object_and_verify(:bucket =&gt; &quot;foobucket&quot;, :key =&gt;
&quot;foo&quot;, :md5 =&gt; &quot;a507841b1bc8115094b00bbe8c1b2953&quot;,
:data =&gt; &quot;polemonium&quot; )
</p>
<pre class="code">
  <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='AwsError constant id'>AwsError</span><span class='colon op'>:</span> <span class='Uploaded constant id'>Uploaded</span> <span class='object identifier id'>object</span> <span class='failed identifier id'>failed</span> <span class='MD5 constant id'>MD5</span> <span class='checksum identifier id'>checksum</span> <span class='verification identifier id'>verification</span><span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='string val'>&quot;x-amz-id-2&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;HTxVtd2bf7UHHDn&lt;/tt&gt;WzEH43MkEjFZ26xuYvUzbstkV6nrWvECRWQWFSx91z/bl03n&quot;</span><span class='comma token'>,</span>
                                                                         <span class='string val'>&quot;etag&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;\&quot;a507841b1bc8115094b00bbe8c1b2954\&quot;&quot;</span><span class='comma token'>,</span>
                                                                         <span class='string val'>&quot;date&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;Mon, 29 Sep 2008 18:38:41 GMT&quot;</span><span class='comma token'>,</span>
                                                                         <span class='symbol val'>:verified_md5=</span><span class='gt op'>&gt;</span><span class='false false kw'>false</span><span class='comma token'>,</span>
                                                                         <span class='string val'>&quot;x-amz-request-id&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0D7ADE09F42606F2&quot;</span><span class='comma token'>,</span>
                                                                         <span class='string val'>&quot;server&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;AmazonS3&quot;</span><span class='comma token'>,</span>
                                                                         <span class='string val'>&quot;content-length&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0&quot;</span><span class='rbrace token'>}</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/s3/right_s3_interface.rb', line 474</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ianneub/right_aws/blob/f0bd614ae0c4ba263bb64c75e5226a694e538f1a/lib/s3/right_s3_interface.rb#L474">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">474
475
476
477
478</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='store_object_and_verify identifier id'>store_object_and_verify</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='AwsUtils constant id'>AwsUtils</span><span class='dot token'>.</span><span class='mandatory_arguments identifier id'>mandatory_arguments</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='symbol val'>:md5</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='r identifier id'>r</span> <span class='assign token'>=</span> <span class='store_object identifier id'>store_object</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='symbol val'>:verified_md5</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='lparen token'>(</span><span class='return return kw'>return</span> <span class='r identifier id'>r</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='lparen token'>(</span><span class='raise identifier id'>raise</span> <span class='AwsError constant id'>AwsError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Uploaded object failed MD5 checksum verification: #{r.inspect}&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>