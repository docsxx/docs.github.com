<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>davetron5000's gli - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/davetron5000/commits/gli/master" rel="alternate" title="Recent Commits to gli:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("davetron5000", "gli", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='davetron5000/gli/blob/ce8d3008d5978624a81d646af81e14f034544e61' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='davetron5000/gli/blob/ce8d3008d5978624a81d646af81e14f034544e61' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("davetron5000", "gli", "ce8d3008d5978624a81d646af81e14f034544e61", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/davetron5000/gli/tree/">Source</a></li>
            <li class=""><a href="http://github.com/davetron5000/gli/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/davetron5000/gli/network">Network</a></li>            
            <li class=""><a href="http://github.com/davetron5000/gli/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/davetron5000/gli">Wiki</a></li>
            <li class=""><a href="http://github.com/davetron5000/gli/graphs">Graphs</a></li>                    
            <li class="active"><a href="/davetron5000/gli">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/davetron5000">davetron5000</a> / <b><a href="http://github.com/davetron5000/gli/tree">gli</a></b>        
                <a id="namespaces_button" rel="davetron5000/gli/blob/ce8d3008d5978624a81d646af81e14f034544e61" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="davetron5000/gli/blob/ce8d3008d5978624a81d646af81e14f034544e61" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>Git-Like Interface Command Line Parser</h1>
<table>
<tr><td valign="top">Author:</td><td>Dave Copeland (mailto:davetron5000 at g mail dot com)

</td></tr>
<tr><td valign="top">Copyright:</td><td>Copyright &#169; 2009 by Dave Copeland

</td></tr>
<tr><td valign="top">License:</td><td>Distributes under the Apache License, see LICENSE.txt in the source distro

</td></tr>
</table>
<p>
This is a DSL you can use to create a command line interface like git, gem
or svn, in that the first argument is a command, and there are global and
command specific flags.
</p>
<h2>Use</h2>
<p>
Install if you need to:
</p>
<pre class="code">
    <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='gli identifier id'>gli</span>
</pre>
<p>
The simplest way to get started is to create a scaffold project
</p>
<pre class="code">
    <span class='gli identifier id'>gli</span> <span class='init identifier id'>init</span> <span class='my_proj identifier id'>my_proj</span> <span class='command_name identifier id'>command_name</span> <span class='other_command_name identifier id'>other_command_name</span>
</pre>
<p>
This will create a (very) basic scaffold project in <tt>./my_proj</tt>,
with a bare-bones main file in <tt>./my_proj/bin/my_proj</tt>. This file
demonstrates most of what you need to describe your command line interface.
</p>
<h3>More Detail</h3>
<pre class="code">
    <span class='comment val'>#!/usr/bin/ruby</span>
    <span class='$: gvar id'>$:</span> <span class='lshft op'>&lt;&lt;</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='__FILE__ __file__ kw'>__FILE__</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>'/../lib'</span><span class='rparen token'>)</span>

    <span class='require identifier id'>require</span> <span class='string val'>'gli'</span>

    <span class='include identifier id'>include</span> <span class='GLI constant id'>GLI</span>
</pre>
<p>
This sets you up to use the DSL that GLI defines:
</p>
<pre class="code">
    <span class='program_description identifier id'>program_description</span> <span class='string val'>'Support program for bootstrapping GLI-based programs'</span>
</pre>
<p>
This sets a description of your program. This can be as long as you want.
</p>
<pre class="code">
    <span class='desc identifier id'>desc</span> <span class='string val'>'Dry run; don\'t change the disk'</span>
    <span class='switch identifier id'>switch</span> <span class='symbol val'>:n</span>
</pre>
<p>
This describes a command line switch &quot;-n&quot; that is global to all
commands and specified before the command name on the command line.
</p>
<pre class="code">
    <span class='desc identifier id'>desc</span> <span class='string val'>'Root dir in which to create project'</span>
    <span class='default_value identifier id'>default_value</span> <span class='string val'>'.'</span>
    <span class='arg_name identifier id'>arg_name</span> <span class='string val'>'root_dir'</span>
    <span class='flag identifier id'>flag</span> <span class='lbrack token'>[</span><span class='symbol val'>:r</span><span class='comma token'>,</span><span class='symbol val'>:root</span><span class='rbrack token'>]</span>
</pre>
<p>
The following describes a command line flag that is global and has a
default value of &#8216;<tt>.</tt>&#8217;. It also specifies a short
description of its argument. This is used to print command line help. Note
that we have specified two different aliases for this flag. <tt>-r</tt>
(because it is listed first) is the default one and <tt>--root</tt>
(note two-dash syntax) is also supported. This means that <tt>-r
some_dir</tt> and <tt>--root=some_dir</tt> mean the same thing to the
application.
</p>
<pre class="code">
    <span class='desc identifier id'>desc</span> <span class='string val'>'Create a new GLI-based project'</span>
    <span class='arg_name identifier id'>arg_name</span> <span class='string val'>'project_name [command[ command]*]'</span>
    <span class='command identifier id'>command</span> <span class='lbrack token'>[</span><span class='symbol val'>:init</span><span class='comma token'>,</span><span class='symbol val'>:scaffold</span><span class='rbrack token'>]</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='c identifier id'>c</span><span class='bitor op'>|</span>

      <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='desc identifier id'>desc</span> <span class='string val'>'Create an ext dir'</span>
      <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='switch identifier id'>switch</span> <span class='lbrack token'>[</span><span class='symbol val'>:e</span><span class='comma token'>,</span><span class='symbol val'>:ext</span><span class='rbrack token'>]</span>

      <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='desc identifier id'>desc</span> <span class='string val'>'Overwrite/ignore existing files and directories'</span>
      <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='switch identifier id'>switch</span> <span class='lbrack token'>[</span><span class='symbol val'>:force</span><span class='rbrack token'>]</span>
</pre>
<p>
Here we specify a command. Inside the block we can use the same sorts of
things as we did above to define flags and switches specific to the
command. These must come after the command name. Also note that we use
<tt>arg_name</tt> here to describe the arguments this command accepts.
</p>
<pre class="code">
      <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='action identifier id'>action</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='global_options identifier id'>global_options</span><span class='comma token'>,</span><span class='options identifier id'>options</span><span class='comma token'>,</span><span class='args identifier id'>args</span><span class='bitor op'>|</span>
        <span class='if if kw'>if</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='lt op'>&lt;</span> <span class='integer val'>1</span>
          <span class='raise identifier id'>raise</span> <span class='string val'>'You must specify the name of your project'</span>
        <span class='end end kw'>end</span>
        <span class='Scaffold constant id'>Scaffold</span><span class='dot token'>.</span><span class='create_scaffold identifier id'>create_scaffold</span><span class='lparen token'>(</span><span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='symbol val'>:r</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='notop op'>!</span><span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:notest</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:e</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>-1</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='o identifier id'>o</span><span class='lbrack token'>[</span><span class='symbol val'>:force</span><span class='rbrack token'>]</span><span class='comma token'>,</span><span class='g identifier id'>g</span><span class='lbrack token'>[</span><span class='symbol val'>:n</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
</pre>
<p>
Here we specify the actual actions to take when the command is executed. We
define a block that will be given the global options (as a Hash), the
command-specific options (as a hash) and the command line arguments
</p>
<p>
You can also specify some global code to run before, after and on errors:
</p>
<pre class="code">
    <span class='pre identifier id'>pre</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='global_options identifier id'>global_options</span><span class='comma token'>,</span><span class='command identifier id'>command</span><span class='comma token'>,</span><span class='options identifier id'>options</span><span class='comma token'>,</span><span class='args identifier id'>args</span><span class='bitor op'>|</span>
      <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;After parsing, but before #{command.name} is run&quot;</span>
      <span class='return return kw'>return</span> <span class='true true kw'>true</span>
      <span class='comment val'># return false if we want to skip command execution for some reason</span>
    <span class='end end kw'>end</span>

    <span class='post identifier id'>post</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='global_options identifier id'>global_options</span><span class='comma token'>,</span><span class='command identifier id'>command</span><span class='comma token'>,</span><span class='options identifier id'>options</span><span class='comma token'>,</span><span class='args identifier id'>args</span><span class='bitor op'>|</span>
      <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;After successful execution of #{command.name}&quot;</span>
    <span class='end end kw'>end</span>

    <span class='on_error identifier id'>on_error</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='global_options identifier id'>global_options</span><span class='comma token'>,</span><span class='command identifier id'>command</span><span class='comma token'>,</span><span class='options identifier id'>options</span><span class='comma token'>,</span><span class='args identifier id'>args</span><span class='bitor op'>|</span>
      <span class='puts identifier id'>puts</span> <span class='string val'>&quot;We go an error&quot;</span>
      <span class='return return kw'>return</span> <span class='true true kw'>true</span>    <span class='comment val'># does the standard error handling code</span>
      <span class='comment val'># return false # this would skip standard error handling code</span>
    <span class='end end kw'>end</span>
</pre>
<p>
Now, we run the program using the arguments the user provided on the
command line
</p>
<pre class="code">
    <span class='run identifier id'>run</span><span class='lparen token'>(</span><span class='ARGV constant id'>ARGV</span><span class='rparen token'>)</span>
</pre>
<p>
Note that by using <tt>gli init</tt> you can create a shell with all of
this already there.
</p>
<p>
What this gives you:
</p>
<ul>
<li>A reasonably useful help system. <tt>your_program help</tt> will list all
the global options and commands (along with command aliases) and
<tt>your_program help command_name</tt> will list help for that given
command.

</li>
<li>Error handling when flags do not receive arguments or unknown flags or
switches are given

</li>
<li>Error handling when an unknown command is specified

</li>
<li>Default values for flags if they are not specified by the user (switches
all default to false)

</li>
</ul>
<p>
What this doesn&#8217;t give you:
</p>
<ul>
<li>A way to indicate required flags

</li>
<li>A way to indicate a require argument or required number of arguments

</li>
<li>A way to do default switches to &#8216;true&#8217; and therefore accept
things like <tt>--no-force</tt>

</li>
</ul>
<h2>Interface Generated</h2>
<p>
The command line interface that is created with the GLI DSL is:
</p>
<p>
<b>executable</b> <em>global options and flags</em> <b>command</b>
<em>command specific options and flags</em> `arguments`
</p>
<dl>
<dt>switch</dt><dd>a command line control string that takes no argument. The <tt>-l</tt> in
<tt>ls -l</tt>

</dd>
<dt>flag</dt><dd>a switch that takes an argument. The <tt>-d&#8217; &#8216;</tt> in <tt>cut
-d&#8217; &#8217; file</tt>

</dd>
<dt>command</dt><dd>the command to execute. The <tt>rebase</tt> in <tt>git rebase</tt>

</dd>
<dt>arguments</dt><dd>Anything that&#8217;s not a switch, flag, or command. The <tt>main.c</tt>
in <tt>git add main.c</tt>

</dd>
</dl>
<h3>Switches</h3>
<p>
Switches can be specified one at a time in either a long or short format:
</p>
<pre class="code">
    <span class='git identifier id'>git</span> <span class='add identifier id'>add</span> <span class='minus op'>-</span><span class='i identifier id'>i</span>
    <span class='git identifier id'>git</span> <span class='add identifier id'>add</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='interactive identifier id'>interactive</span>
</pre>
<p>
Switches can also be combined in their short form:
</p>
<pre class="code">
    <span class='ls identifier id'>ls</span> <span class='minus op'>-</span><span class='l identifier id'>l</span> <span class='minus op'>-</span><span class='a identifier id'>a</span>
    <span class='ls identifier id'>ls</span> <span class='minus op'>-</span><span class='la identifier id'>la</span>
</pre>
<h3>Flags</h3>
<p>
Flags can be specified in long or short form, and with or without an
equals:
</p>
<pre class="code">
    <span class='git identifier id'>git</span> <span class='merge identifier id'>merge</span> <span class='minus op'>-</span><span class='s identifier id'>s</span> <span class='resolve identifier id'>resolve</span>
    <span class='git identifier id'>git</span> <span class='merge identifier id'>merge</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='strategy identifier id'>strategy</span><span class='assign token'>=</span><span class='resolve identifier id'>resolve</span>
</pre>
<h3>Stop Switch</h3>
<p>
A <tt>--</tt> at any time stops processing and sends the rest of the
argument to the command as arguments, even if they start with a
&quot;--&quot;
</p>
<p>
:include:gli.rdoc
</p>
<h2>Links</h2>
<ul>
<li>[http://davetron5000.github.com/gli] - RubyDoc

</li>
<li>[http://www.github.com/davetron5000/gli] - Source on GitHub

</li>
</ul>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>