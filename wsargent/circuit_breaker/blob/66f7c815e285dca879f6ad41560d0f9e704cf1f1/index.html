<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>wsargent's circuit_breaker - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/wsargent/commits/circuit_breaker/master" rel="alternate" title="Recent Commits to circuit_breaker:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("wsargent", "circuit_breaker", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='wsargent/circuit_breaker/blob/66f7c815e285dca879f6ad41560d0f9e704cf1f1' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='wsargent/circuit_breaker/blob/66f7c815e285dca879f6ad41560d0f9e704cf1f1' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("wsargent", "circuit_breaker", "66f7c815e285dca879f6ad41560d0f9e704cf1f1", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/wsargent/circuit_breaker/tree/">Source</a></li>
            <li class=""><a href="http://github.com/wsargent/circuit_breaker/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/wsargent/circuit_breaker/network">Network</a></li>            
            <li class=""><a href="http://github.com/wsargent/circuit_breaker/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/wsargent/circuit_breaker">Wiki</a></li>
            <li class=""><a href="http://github.com/wsargent/circuit_breaker/graphs">Graphs</a></li>                    
            <li class="active"><a href="/wsargent/circuit_breaker">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/wsargent">wsargent</a> / <b><a href="http://github.com/wsargent/circuit_breaker/tree">circuit_breaker</a></b>        
                <a id="namespaces_button" rel="wsargent/circuit_breaker/blob/66f7c815e285dca879f6ad41560d0f9e704cf1f1" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="wsargent/circuit_breaker/blob/66f7c815e285dca879f6ad41560d0f9e704cf1f1" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>circuit_breaker</h1>
<ul>
<li>http://github.com/wsargent/circuit_breaker

</li>
<li>http://rdoc.info/projects/wsargent/circuit_breaker

</li>
<li>Will Sargent &lt;will.sargent@gmail.com&gt;

</li>
</ul>
<h2>DESCRIPTION:</h2>
<pre class="code">
 <span class='CircuitBreaker constant id'>CircuitBreaker</span> <span class='is identifier id'>is</span> <span class='a identifier id'>a</span> <span class='relatively identifier id'>relatively</span> <span class='simple identifier id'>simple</span> <span class='Ruby constant id'>Ruby</span> <span class='mixin identifier id'>mixin</span> <span class='that identifier id'>that</span> <span class='will identifier id'>will</span> <span class='wrap identifier id'>wrap</span>
 <span class='a identifier id'>a</span> <span class='call identifier id'>call</span> <span class='to identifier id'>to</span> <span class='a identifier id'>a</span> <span class='given identifier id'>given</span> <span class='service identifier id'>service</span> <span class='in in kw'>in</span> <span class='a identifier id'>a</span> <span class='circuit identifier id'>circuit</span> <span class='breaker identifier id'>breaker</span> <span class='pattern identifier id'>pattern</span><span class='dot token'>.</span>

 <span class='The constant id'>The</span> <span class='circuit identifier id'>circuit</span> <span class='starts identifier id'>starts</span> <span class='off identifier id'>off</span> <span class='string val'>&quot;closed&quot;</span> <span class='meaning identifier id'>meaning</span> <span class='that identifier id'>that</span> <span class='all identifier id'>all</span> <span class='calls identifier id'>calls</span> <span class='will identifier id'>will</span> <span class='go identifier id'>go</span> <span class='through identifier id'>through</span><span class='dot token'>.</span>
 <span class='However constant id'>However</span><span class='comma token'>,</span> <span class='consecutive identifier id'>consecutive</span> <span class='failures identifier id'>failures</span> <span class='are identifier id'>are</span> <span class='recorded identifier id'>recorded</span> <span class='and and kw'>and</span> <span class='after identifier id'>after</span> <span class='a identifier id'>a</span> <span class='threshold identifier id'>threshold</span> <span class='is identifier id'>is</span> <span class='reached identifier id'>reached</span><span class='comma token'>,</span>
 <span class='the identifier id'>the</span> <span class='circuit identifier id'>circuit</span> <span class='will identifier id'>will</span> <span class='string val'>&quot;trip&quot;</span><span class='comma token'>,</span> <span class='setting identifier id'>setting</span> <span class='the identifier id'>the</span> <span class='circuit identifier id'>circuit</span> <span class='into identifier id'>into</span> <span class='an identifier id'>an</span> <span class='string val'>&quot;open&quot;</span> <span class='state identifier id'>state</span><span class='dot token'>.</span>

 <span class='In constant id'>In</span> <span class='an identifier id'>an</span> <span class='string val'>&quot;open&quot;</span> <span class='state identifier id'>state</span><span class='comma token'>,</span> <span class='every identifier id'>every</span> <span class='call identifier id'>call</span> <span class='to identifier id'>to</span> <span class='the identifier id'>the</span> <span class='service identifier id'>service</span> <span class='will identifier id'>will</span> <span class='fail identifier id'>fail</span> <span class='by identifier id'>by</span> <span class='raising identifier id'>raising</span>
 <span class='CircuitBrokenException constant id'>CircuitBrokenException</span><span class='dot token'>.</span>

 <span class='The constant id'>The</span> <span class='circuit identifier id'>circuit</span> <span class='will identifier id'>will</span> <span class='remain identifier id'>remain</span> <span class='in in kw'>in</span> <span class='an identifier id'>an</span> <span class='string val'>&quot;open&quot;</span> <span class='state identifier id'>state</span> <span class='until until_mod kw'>until</span> <span class='the identifier id'>the</span> <span class='failure identifier id'>failure</span> <span class='timeout identifier id'>timeout</span> <span class='has identifier id'>has</span>
 <span class='elapsed identifier id'>elapsed</span><span class='dot token'>.</span>

 <span class='After constant id'>After</span> <span class='the identifier id'>the</span> <span class='failure_timeout identifier id'>failure_timeout</span> <span class='has identifier id'>has</span> <span class='elapsed identifier id'>elapsed</span><span class='comma token'>,</span> <span class='the identifier id'>the</span> <span class='circuit identifier id'>circuit</span> <span class='will identifier id'>will</span> <span class='go identifier id'>go</span> <span class='into identifier id'>into</span>
 <span class='a identifier id'>a</span> <span class='string val'>&quot;half open&quot;</span> <span class='state identifier id'>state</span> <span class='and and kw'>and</span> <span class='the identifier id'>the</span> <span class='call identifier id'>call</span> <span class='will identifier id'>will</span> <span class='go identifier id'>go</span> <span class='through identifier id'>through</span><span class='dot token'>.</span>  <span class='A constant id'>A</span> <span class='failure identifier id'>failure</span> <span class='will identifier id'>will</span>
 <span class='immediately identifier id'>immediately</span> <span class='pop identifier id'>pop</span> <span class='the identifier id'>the</span> <span class='circuit identifier id'>circuit</span> <span class='open identifier id'>open</span> <span class='again identifier id'>again</span><span class='comma token'>,</span> <span class='and and kw'>and</span> <span class='a identifier id'>a</span> <span class='success identifier id'>success</span> <span class='will identifier id'>will</span> <span class='close identifier id'>close</span> <span class='the identifier id'>the</span>
 <span class='circuit identifier id'>circuit</span> <span class='and and kw'>and</span> <span class='reset identifier id'>reset</span> <span class='the identifier id'>the</span> <span class='failure identifier id'>failure</span> <span class='count identifier id'>count</span><span class='dot token'>.</span>

     <span class='require identifier id'>require</span> <span class='string val'>'circuit_breaker'</span>
     <span class='class class kw'>class</span> <span class='TestService constant id'>TestService</span>

       <span class='include identifier id'>include</span> <span class='CircuitBreaker constant id'>CircuitBreaker</span>

       <span class='def def kw'>def</span> <span class='call_remote_service identifier id'>call_remote_service</span><span class='lparen token'>(</span><span class='rparen token'>)</span> <span class='dot3 op'>...</span>

       <span class='circuit_method identifier id'>circuit_method</span> <span class='symbol val'>:call_remote_service</span>

       <span class='comment val'># Optional</span>
       <span class='circuit_handler identifier id'>circuit_handler</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='handler identifier id'>handler</span><span class='bitor op'>|</span>
         <span class='handler identifier id'>handler</span><span class='dot token'>.</span><span class='logger identifier id'>logger</span> <span class='assign token'>=</span> <span class='Logger constant id'>Logger</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='STDOUT constant id'>STDOUT</span><span class='rparen token'>)</span>
         <span class='handler identifier id'>handler</span><span class='dot token'>.</span><span class='failure_threshold identifier id'>failure_threshold</span> <span class='assign token'>=</span> <span class='integer val'>5</span>
         <span class='handler identifier id'>handler</span><span class='dot token'>.</span><span class='failure_timeout identifier id'>failure_timeout</span> <span class='assign token'>=</span> <span class='integer val'>5</span>
       <span class='end end kw'>end</span>

       <span class='comment val'># Optional</span>
       <span class='circuit_handler_class identifier id'>circuit_handler_class</span> <span class='MyCustomCircuitHandler constant id'>MyCustomCircuitHandler</span>
     <span class='end end kw'>end</span>
</pre>
<h2>FEATURES/PROBLEMS:</h2>
<ul>
<li>Can run out of the box with minimal dependencies and a couple of lines of
code.

</li>
<li>Easy to extend: add your own circuit breakers or states or extend the
existing ones.

</li>
<li>Does not currently handle static class methods.

</li>
</ul>
<h2>SYNOPSIS:</h2>
<pre class="code">
  <span class='An constant id'>An</span> <span class='implementation identifier id'>implementation</span> <span class='of identifier id'>of</span> <span class='Michael constant id'>Michael</span> <span class='Nygard constant id'>Nygard</span><span class='string val'>'s Circuit Breaker pattern.
</span></pre>
<h2>REQUIREMENTS:</h2>
<pre class="code">
  <span class='circuit_breaker identifier id'>circuit_breaker</span> <span class='has identifier id'>has</span> <span class='a identifier id'>a</span> <span class='dependency identifier id'>dependency</span> <span class='on identifier id'>on</span> <span class='AASM constant id'>AASM</span> @ <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/github.com/</span><span class='rubyist identifier id'>rubyist</span><span class='div op'>/</span><span class='aasm identifier id'>aasm</span><span class='div op'>/</span><span class='tree identifier id'>tree</span><span class='div op'>/</span><span class='master identifier id'>master</span>
</pre>
<h2>INSTALL:</h2>
<ul>
<li>gem sources -a http://gems.github.com

</li>
<li>gem install rubyist-aasm

</li>
<li>gem install wsargent_circuit-breaker

</li>
</ul>
<h2>LICENSE:</h2>
<p>
Copyright &#169; 2009, Will Sargent All rights reserved.
</p>
<p>
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
</p>
<pre class="code">
  <span class='mult op'>*</span> <span class='Redistributions constant id'>Redistributions</span> <span class='of identifier id'>of</span> <span class='source identifier id'>source</span> <span class='code identifier id'>code</span> <span class='must identifier id'>must</span> <span class='retain identifier id'>retain</span> <span class='the identifier id'>the</span> <span class='above identifier id'>above</span> <span class='copyright identifier id'>copyright</span> <span class='notice identifier id'>notice</span><span class='comma token'>,</span> <span class='this identifier id'>this</span> <span class='list identifier id'>list</span> <span class='of identifier id'>of</span> <span class='conditions identifier id'>conditions</span> <span class='and and kw'>and</span> <span class='the identifier id'>the</span> <span class='following identifier id'>following</span>
    <span class='disclaimer identifier id'>disclaimer</span><span class='dot token'>.</span>
  <span class='mult op'>*</span> <span class='Redistributions constant id'>Redistributions</span> <span class='in in kw'>in</span> <span class='binary identifier id'>binary</span> <span class='form identifier id'>form</span> <span class='must identifier id'>must</span> <span class='reproduce identifier id'>reproduce</span> <span class='the identifier id'>the</span> <span class='above identifier id'>above</span> <span class='copyright identifier id'>copyright</span> <span class='notice identifier id'>notice</span><span class='comma token'>,</span> <span class='this identifier id'>this</span> <span class='list identifier id'>list</span> <span class='of identifier id'>of</span> <span class='conditions identifier id'>conditions</span> <span class='and and kw'>and</span> <span class='the identifier id'>the</span> <span class='following identifier id'>following</span>
    <span class='disclaimer identifier id'>disclaimer</span> <span class='in in kw'>in</span> <span class='the identifier id'>the</span> <span class='documentation identifier id'>documentation</span> <span class='and and kw'>and</span><span class='regexp val'>/or other materials provided with the distribution.
  * The names of its contributors may not be used to endorse or promote products derived from this software without
    specific prior written permission.
</span></pre>
<p>
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER
OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
</p>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> Â©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>