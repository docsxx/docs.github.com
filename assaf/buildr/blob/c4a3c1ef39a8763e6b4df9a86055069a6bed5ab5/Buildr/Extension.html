<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>assaf's buildr - Module: Buildr::Extension - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/assaf/commits/buildr/master" rel="alternate" title="Recent Commits to buildr:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("assaf", "buildr", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='assaf/buildr/blob/c4a3c1ef39a8763e6b4df9a86055069a6bed5ab5' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='assaf/buildr/blob/c4a3c1ef39a8763e6b4df9a86055069a6bed5ab5' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("assaf", "buildr", "c4a3c1ef39a8763e6b4df9a86055069a6bed5ab5", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/assaf/buildr/tree/">Source</a></li>
            <li class=""><a href="http://github.com/assaf/buildr/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/assaf/buildr/network">Network</a></li>            
            <li class=""><a href="http://github.com/assaf/buildr/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/assaf/buildr">Wiki</a></li>
            <li class=""><a href="http://github.com/assaf/buildr/graphs">Graphs</a></li>                    
            <li class="active"><a href="/assaf/buildr">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/assaf">assaf</a> / <b><a href="http://github.com/assaf/buildr/tree">buildr</a></b>        
                <a id="namespaces_button" rel="assaf/buildr/blob/c4a3c1ef39a8763e6b4df9a86055069a6bed5ab5" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="assaf/buildr/blob/c4a3c1ef39a8763e6b4df9a86055069a6bed5ab5" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Buildr_Extension">
  <h1>Module: Buildr::Extension</h1>
  <div class="section docstring">
  <p>
The basic mechanism for extending projects in Buildr are Ruby modules. In
fact, base features like compiling and testing are all developed in the
form of modules, and then added to the core Project class.
</p>
<p>
A module defines instance methods that are then mixed into the project and
become instance methods of the project. There are two general ways for
extending projects. You can extend all projects by including the module in
Project:
</p>
<pre class="code">
   <span class='class class kw'>class</span> <span class='Project constant id'>Project</span>
     <span class='include identifier id'>include</span> <span class='MyExtension constant id'>MyExtension</span>
   <span class='end end kw'>end</span>
</pre>
<p>
You can also extend a given project instance and only that instance by
extending it with the module:
</p>
<pre class="code">
  <span class='define identifier id'>define</span> <span class='string val'>'foo'</span> <span class='do do kw'>do</span>
    <span class='extend identifier id'>extend</span> <span class='MyExtension constant id'>MyExtension</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Some extensions require tighter integration with the project, specifically
for setting up tasks and properties, or for configuring tasks based on the
project definition. You can do that by adding callbacks to the process.
</p>
<p>
The easiest way to add callbacks is by incorporating the Extension module
in your own extension, and using the various class methods to define
callback behavior:
</p>
<ul>
<li>first_time &#8212; This block will be called once for any particular
extension.

<pre class="code">
  <span class='You constant id'>You</span> <span class='can identifier id'>can</span> <span class='use identifier id'>use</span> <span class='this identifier id'>this</span> <span class='to identifier id'>to</span> <span class='setup identifier id'>setup</span> <span class='top identifier id'>top</span><span class='minus op'>-</span><span class='level identifier id'>level</span> <span class='and and kw'>and</span> <span class='local identifier id'>local</span> <span class='tasks identifier id'>tasks</span><span class='dot token'>.</span>
</pre>
</li>
<li>before_define &#8212; This block is called once for the project with the
project

<pre class="code">
  <span class='instance identifier id'>instance</span><span class='comma token'>,</span> <span class='right identifier id'>right</span> <span class='before identifier id'>before</span> <span class='running identifier id'>running</span> <span class='the identifier id'>the</span> <span class='project identifier id'>project</span> <span class='definition identifier id'>definition</span><span class='dot token'>.</span>  <span class='You constant id'>You</span> <span class='can identifier id'>can</span> <span class='use identifier id'>use</span> <span class='this identifier id'>this</span>
  <span class='to identifier id'>to</span> <span class='add identifier id'>add</span> <span class='tasks identifier id'>tasks</span> <span class='and and kw'>and</span> <span class='set identifier id'>set</span> <span class='properties identifier id'>properties</span> <span class='that identifier id'>that</span> <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='used identifier id'>used</span> <span class='in in kw'>in</span> <span class='the identifier id'>the</span> <span class='project identifier id'>project</span> <span class='definition identifier id'>definition</span><span class='dot token'>.</span>
</pre>
</li>
<li>after_define &#8212; This block is called once for the project with the
project

<pre class="code">
  <span class='instance identifier id'>instance</span><span class='comma token'>,</span> <span class='right identifier id'>right</span> <span class='after identifier id'>after</span> <span class='running identifier id'>running</span> <span class='the identifier id'>the</span> <span class='project identifier id'>project</span> <span class='definition identifier id'>definition</span><span class='dot token'>.</span>  <span class='You constant id'>You</span> <span class='can identifier id'>can</span> <span class='use identifier id'>use</span> <span class='this identifier id'>this</span> <span class='to identifier id'>to</span>
  <span class='do do kw'>do</span> <span class='any identifier id'>any</span> <span class='post identifier id'>post</span><span class='minus op'>-</span><span class='processing identifier id'>processing</span> <span class='that identifier id'>that</span> <span class='depends identifier id'>depends</span> <span class='on identifier id'>on</span> <span class='the identifier id'>the</span> <span class='project identifier id'>project</span> <span class='definition identifier id'>definition</span><span class='dot token'>.</span>
</pre>
</li>
</ul>
<p>
This example illustrates how to write a simple extension:
</p>
<pre class="code">
  <span class='module module kw'>module</span> <span class='LinesOfCode constant id'>LinesOfCode</span>
    <span class='include identifier id'>include</span> <span class='Extension constant id'>Extension</span>

    <span class='first_time identifier id'>first_time</span> <span class='do do kw'>do</span>
      <span class='comment val'># Define task not specific to any projet.</span>
      <span class='desc identifier id'>desc</span> <span class='string val'>'Count lines of code in current project'</span>
      <span class='Project constant id'>Project</span><span class='dot token'>.</span><span class='local_task identifier id'>local_task</span><span class='lparen token'>(</span><span class='string val'>'loc'</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='before_define identifier id'>before_define</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='project identifier id'>project</span><span class='bitor op'>|</span>
      <span class='comment val'># Define the loc task for this particular project.</span>
      <span class='Rake constant id'>Rake</span><span class='colon2 op'>::</span><span class='Task constant id'>Task</span><span class='dot token'>.</span><span class='define_task identifier id'>define_task</span> <span class='string val'>'loc'</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='task identifier id'>task</span><span class='bitor op'>|</span>
        <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='task identifier id'>task</span><span class='dot token'>.</span><span class='prerequisites identifier id'>prerequisites</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='path identifier id'>path</span><span class='bitor op'>|</span> <span class='Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='string val'>'#{path}/**/*'</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='flatten identifier id'>flatten</span><span class='dot token'>.</span><span class='uniq identifier id'>uniq</span><span class='dot token'>.</span>
          <span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='total identifier id'>total</span><span class='comma token'>,</span> <span class='file identifier id'>file</span><span class='bitor op'>|</span> <span class='total identifier id'>total</span> <span class='plus op'>+</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='readlines identifier id'>readlines</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='count identifier id'>count</span> <span class='rbrace token'>}</span>
        <span class='puts identifier id'>puts</span> <span class='dstring node'>&quot;Project #{project.name} has #{lines} lines of code&quot;</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='after_define identifier id'>after_define</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='project identifier id'>project</span><span class='bitor op'>|</span>
      <span class='comment val'># Now that we know all the source directories, add them.</span>
      <span class='task identifier id'>task</span><span class='lparen token'>(</span><span class='string val'>'loc'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='compile identifier id'>compile</span><span class='dot token'>.</span><span class='sources identifier id'>sources</span> <span class='plus op'>+</span> <span class='compile identifier id'>compile</span><span class='dot token'>.</span><span class='test identifier id'>test</span><span class='dot token'>.</span><span class='sources identifier id'>sources</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># To use this method in your project:</span>
    <span class='comment val'>#   loc path_1, path_2</span>
    <span class='def def kw'>def</span> <span class='loc identifier id'>loc</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='paths identifier id'>paths</span><span class='rparen token'>)</span>
      <span class='task identifier id'>task</span><span class='lparen token'>(</span><span class='string val'>'loc'</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='paths identifier id'>paths</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

  <span class='end end kw'>end</span>

  <span class='class class kw'>class</span> <span class='Buildr constant id'>Buildr</span><span class='colon2 op'>::</span><span class='Project constant id'>Project</span>
    <span class='include identifier id'>include</span> <span class='LinesOfCode constant id'>LinesOfCode</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#included-class_method">included</span><span class='args'>(base)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>included</h3>
</div><div id="included-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>included</span><span class='args'>(base)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/buildr/core/project.rb', line 709</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/assaf/buildr/blob/c4a3c1ef39a8763e6b4df9a86055069a6bed5ab5/lib/buildr/core/project.rb#L709">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">709
710
711</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='included identifier id'>included</span><span class='lparen token'>(</span><span class='base identifier id'>base</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='base identifier id'>base</span><span class='dot token'>.</span><span class='extend identifier id'>extend</span> <span class='ClassMethods constant id'>ClassMethods</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>