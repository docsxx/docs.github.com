<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>assaf's uuid - Class: UUID - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/assaf/commits/uuid/master" rel="alternate" title="Recent Commits to uuid:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("assaf", "uuid", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("assaf", "uuid", "9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/assaf/uuid/tree/">Source</a></li>
            <li class=""><a href="http://github.com/assaf/uuid/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/assaf/uuid/network">Network</a></li>            
            <li class=""><a href="http://github.com/assaf/uuid/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/assaf/uuid">Wiki</a></li>
            <li class=""><a href="http://github.com/assaf/uuid/graphs">Graphs</a></li>                    
            <li class="active"><a href="/assaf/uuid">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/assaf">assaf</a> / <b><a href="http://github.com/assaf/uuid/tree">uuid</a></b>        
                <a id="namespaces_button" rel="assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class UUID">
  <h1>Class: UUID</h1>
  <div class="section docstring">
  <h1>Generating UUIDs</h1>
<p>
Call #generate to generate a new UUID. The method returns a string in one
of three formats. The default format is 36 characters long, and contains
the 32 hexadecimal octets and hyphens separating the various value parts.
The <tt>:compact</tt> format omits the hyphens, while the <tt>:urn</tt>
format adds the <tt>:urn:uuid</tt> prefix.
</p>
<p>
For example:
</p>
<pre class="code">
  <span class='uuid identifier id'>uuid</span> <span class='assign token'>=</span> <span class='UUID constant id'>UUID</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

  <span class='float val'>10</span><span class='dot token'>.</span><span class='times identifier id'>times</span> <span class='do do kw'>do</span>
    <span class='p identifier id'>p</span> <span class='uuid identifier id'>uuid</span><span class='dot token'>.</span><span class='generate identifier id'>generate</span>
  <span class='end end kw'>end</span>
</pre>
<h1>UUIDs in Brief</h1>
<p>
UUID (universally unique identifier) are guaranteed to be unique across
time and space.
</p>
<p>
A UUID is 128 bit long, and consists of a 60-bit time value, a 16-bit
sequence number and a 48-bit node identifier.
</p>
<p>
The time value is taken from the system clock, and is monotonically
incrementing. However, since it is possible to set the system clock
backward, a sequence number is added. The sequence number is incremented
each time the UUID generator is started. The combination guarantees that
identifiers created on the same machine are unique with a high degree of
probability.
</p>
<p>
Note that due to the structure of the UUID and the use of sequence number,
there is no guarantee that UUID values themselves are monotonically
incrementing. The UUID value cannot itself be used to sort based on order
of creation.
</p>
<p>
To guarantee that UUIDs are unique across all machines in the network, the
IEEE 802 MAC address of the machine&#8217;s network interface card is used
as the node identifier.
</p>
<p>
For more information see <tt>4122</tt>[http://www.ietf.org/rfc/rfc4122.txt].
</p>

</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="CLOCK_GAPS-constant">CLOCK_GAPS</dt>
      <dd>100000</dd>
    
      <dt id="CLOCK_MULTIPLIER-constant">CLOCK_MULTIPLIER</dt>
      <dd>10000000</dd>
    
      <dt id="FORMATS-constant">FORMATS</dt>
      <dd>{
  :compact =&gt; '%08x%04x%04x%04x%012x',
  :default =&gt; '%08x-%04x-%04x-%04x-%012x',
  :urn     =&gt; 'urn:uuid:%08x-%04x-%04x-%04x-%012x',
}</dd>
    
      <dt id="STATE_FILE_FORMAT-constant">STATE_FILE_FORMAT</dt>
      <dd>'SLLQ'</dd>
    
      <dt id="VERSION-constant">VERSION</dt>
      <dd>'2.0.1'</dd>
    
      <dt id="VERSION_CLOCK-constant">VERSION_CLOCK</dt>
      <dd>0x0100</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new UUID generator. You really only need to do this once.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/uuid.rb', line 154</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73/lib/uuid.rb#L154">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span>
  <span class='@drift ivar id'>@drift</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@last_clock ivar id'>@last_clock</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span> <span class='mult op'>*</span> <span class='CLOCK_MULTIPLIER constant id'>CLOCK_MULTIPLIER</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  <span class='@mutex ivar id'>@mutex</span> <span class='assign token'>=</span> <span class='Mutex constant id'>Mutex</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

  <span class='if if kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='state_file identifier id'>state_file</span><span class='rparen token'>)</span> <span class='then then kw'>then</span>
    <span class='next_sequence identifier id'>next_sequence</span>
  <span class='else else kw'>else</span>
    <span class='@mac ivar id'>@mac</span> <span class='assign token'>=</span> <span class='Mac constant id'>Mac</span><span class='dot token'>.</span><span class='addr identifier id'>addr</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/:|-/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='hex identifier id'>hex</span> <span class='bitand op'>&amp;</span> <span class='integer val'>0x7</span><span class='FFFFFFFFFFF constant id'>FFFFFFFFFFF</span>
    <span class='fail identifier id'>fail</span> <span class='dstring node'>&quot;Cannot determine MAC address from any available interface, tried with #{Mac.addr}&quot;</span> <span class='if if_mod kw'>if</span> <span class='@mac ivar id'>@mac</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
    <span class='@sequence ivar id'>@sequence</span> <span class='assign token'>=</span> <span class='rand identifier id'>rand</span> <span class='integer val'>0x10000</span>

    <span class='open_lock identifier id'>open_lock</span> <span class='string val'>'w'</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span>
      <span class='write_state identifier id'>write_state</span> <span class='io identifier id'>io</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#generate-class_method">generate</span><span class='args'>(format = :default)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates a new UUID string using <tt>format</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#mode-class_method">mode</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
The access mode of the state file.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#state_file-class_method">state_file</span><span class='args'>(mode = 0644)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Creates an empty state file in /var/tmp/ruby-uuid or the windows common
application data directory using mode 0644.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#generate-instance_method">#generate</span><span class='args'>(format = :default)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates a new UUID string using <tt>format</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#inspect-instance_method">#inspect</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#next_sequence-instance_method">#next_sequence</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Updates the state file with a new sequence number.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>generate</h3>
</div><div id="generate-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>generate</span><span class='args'>(format = :default)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates a new UUID string using <tt>format</tt>. See FORMATS for a list
of supported formats.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/uuid.rb', line 111</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73/lib/uuid.rb#L111">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">111
112
113
114</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='generate identifier id'>generate</span><span class='lparen token'>(</span><span class='format identifier id'>format</span> <span class='assign token'>=</span> <span class='symbol val'>:default</span><span class='rparen token'>)</span>
  <span class='@uuid ivar id'>@uuid</span> <span class='opasgn op'>||=</span> <span class='new identifier id'>new</span>
  <span class='@uuid ivar id'>@uuid</span><span class='dot token'>.</span><span class='generate identifier id'>generate</span> <span class='format identifier id'>format</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>mode</h3>
</div><div id="mode-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>mode</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
The access mode of the state file. Set it with state_file.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/uuid.rb', line 103</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73/lib/uuid.rb#L103">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">103
104
105</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='mode identifier id'>mode</span>
  <span class='@mode ivar id'>@mode</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>state_file</h3>
</div><div id="state_file-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>state_file</span><span class='args'>(mode = 0644)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Creates an empty state file in /var/tmp/ruby-uuid or the windows common
application data directory using mode 0644. Call with a different mode
before creating a UUID generator if you want to open access beyond your
user by default.
</p>
<p>
If the default state dir is not writable, UUID falls back to ~/.ruby-uuid.
</p>
<p>
State files are not portable across machines.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/uuid.rb', line 125</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73/lib/uuid.rb#L125">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='state_file identifier id'>state_file</span><span class='lparen token'>(</span><span class='mode identifier id'>mode</span> <span class='assign token'>=</span> <span class='integer val'>0644</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='@state_file ivar id'>@state_file</span> <span class='if if_mod kw'>if</span> <span class='@state_file ivar id'>@state_file</span>

  <span class='@mode ivar id'>@mode</span> <span class='assign token'>=</span> <span class='mode identifier id'>mode</span>

  <span class='begin begin kw'>begin</span>
    <span class='require identifier id'>require</span> <span class='string val'>'Win32API'</span>

    <span class='csidl_common_appdata identifier id'>csidl_common_appdata</span> <span class='assign token'>=</span> <span class='integer val'>0x0023</span>
    <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='dot token'>.</span><span class='chr identifier id'>chr</span> <span class='mult op'>*</span> <span class='integer val'>260</span>
    <span class='get_folder_path identifier id'>get_folder_path</span> <span class='assign token'>=</span> <span class='Win32API constant id'>Win32API</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'shell32'</span><span class='comma token'>,</span> <span class='string val'>'SHGetFolderPath'</span><span class='comma token'>,</span> <span class='string val'>'LLLLP'</span><span class='comma token'>,</span> <span class='string val'>'L'</span><span class='rparen token'>)</span>
    <span class='get_folder_path identifier id'>get_folder_path</span><span class='dot token'>.</span><span class='call identifier id'>call</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='csidl_common_appdata identifier id'>csidl_common_appdata</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='path identifier id'>path</span>

    <span class='state_dir identifier id'>state_dir</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span><span class='rparen token'>)</span>
  <span class='rescue rescue kw'>rescue</span> <span class='LoadError constant id'>LoadError</span>
    <span class='state_dir identifier id'>state_dir</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='comma token'>,</span> <span class='string val'>'var'</span><span class='comma token'>,</span> <span class='string val'>'tmp'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='writable? fid id'>writable?</span><span class='lparen token'>(</span><span class='state_dir identifier id'>state_dir</span><span class='rparen token'>)</span> <span class='then then kw'>then</span>
    <span class='@state_file ivar id'>@state_file</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='state_dir identifier id'>state_dir</span><span class='comma token'>,</span> <span class='string val'>'ruby-uuid'</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='@state_file ivar id'>@state_file</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'~'</span><span class='comma token'>,</span> <span class='string val'>'.ruby-uuid'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='@state_file ivar id'>@state_file</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>generate</h3>
</div><div id="generate-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>generate</span><span class='args'>(format = :default)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates a new UUID string using <tt>format</tt>. See FORMATS for a list
of supported formats.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>ArgumentError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/uuid.rb', line 175</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73/lib/uuid.rb#L175">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='generate identifier id'>generate</span><span class='lparen token'>(</span><span class='format identifier id'>format</span> <span class='assign token'>=</span> <span class='symbol val'>:default</span><span class='rparen token'>)</span>
  <span class='template identifier id'>template</span> <span class='assign token'>=</span> <span class='FORMATS constant id'>FORMATS</span><span class='lbrack token'>[</span><span class='format identifier id'>format</span><span class='rbrack token'>]</span>

  <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;invalid UUID format #{format.inspect}&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='template identifier id'>template</span>

  <span class='comment val'># The clock must be monotonically increasing. The clock resolution is at</span>
  <span class='comment val'># best 100 ns (UUID spec), but practically may be lower (on my setup,</span>
  <span class='comment val'># around 1ms). If this method is called too fast, we don't have a</span>
  <span class='comment val'># monotonically increasing clock, so the solution is to just wait.</span>
  <span class='comment val'>#</span>
  <span class='comment val'># It is possible for the clock to be adjusted backwards, in which case we</span>
  <span class='comment val'># would end up blocking for a long time. When backward clock is detected,</span>
  <span class='comment val'># we prevent duplicates by asking for a new sequence number and continue</span>
  <span class='comment val'># with the new clock.</span>

  <span class='clock identifier id'>clock</span> <span class='assign token'>=</span> <span class='@mutex ivar id'>@mutex</span><span class='dot token'>.</span><span class='synchronize identifier id'>synchronize</span> <span class='do do kw'>do</span>
    <span class='clock identifier id'>clock</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span> <span class='mult op'>*</span> <span class='CLOCK_MULTIPLIER constant id'>CLOCK_MULTIPLIER</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='bitand op'>&amp;</span> <span class='integer val'>0x</span><span class='FFFFFFFFFFFFFFF0 constant id'>FFFFFFFFFFFFFFF0</span>

    <span class='if if kw'>if</span> <span class='clock identifier id'>clock</span> <span class='gt op'>&gt;</span> <span class='@last_clock ivar id'>@last_clock</span> <span class='then then kw'>then</span>
      <span class='@drift ivar id'>@drift</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='@last_clock ivar id'>@last_clock</span> <span class='assign token'>=</span> <span class='clock identifier id'>clock</span>
    <span class='elsif elsif kw'>elsif</span> <span class='clock identifier id'>clock</span> <span class='eq op'>==</span> <span class='@last_clock ivar id'>@last_clock</span> <span class='then then kw'>then</span>
      <span class='drift identifier id'>drift</span> <span class='assign token'>=</span> <span class='@drift ivar id'>@drift</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>

      <span class='if if kw'>if</span> <span class='drift identifier id'>drift</span> <span class='lt op'>&lt;</span> <span class='integer val'>10000</span> <span class='then then kw'>then</span>
        <span class='@last_clock ivar id'>@last_clock</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
      <span class='else else kw'>else</span>
        <span class='Thread constant id'>Thread</span><span class='dot token'>.</span><span class='pass identifier id'>pass</span>
        <span class='nil nil kw'>nil</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='next_sequence identifier id'>next_sequence</span>
      <span class='@last_clock ivar id'>@last_clock</span> <span class='assign token'>=</span> <span class='clock identifier id'>clock</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span> <span class='until until_mod kw'>until</span> <span class='clock identifier id'>clock</span>

  <span class='template identifier id'>template</span> <span class='mod op'>%</span> <span class='lbrack token'>[</span>
      <span class='clock identifier id'>clock</span>        <span class='bitand op'>&amp;</span> <span class='integer val'>0x</span><span class='FFFFFFFF constant id'>FFFFFFFF</span><span class='comma token'>,</span>
     <span class='lparen token'>(</span><span class='clock identifier id'>clock</span> <span class='rshft op'>&gt;&gt;</span> <span class='integer val'>32</span><span class='rparen token'>)</span> <span class='bitand op'>&amp;</span> <span class='integer val'>0x</span><span class='FFFF constant id'>FFFF</span><span class='comma token'>,</span>
    <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='clock identifier id'>clock</span> <span class='rshft op'>&gt;&gt;</span> <span class='integer val'>48</span><span class='rparen token'>)</span> <span class='bitand op'>&amp;</span> <span class='integer val'>0x</span><span class='FFFF constant id'>FFFF</span> <span class='bitor op'>|</span> <span class='VERSION_CLOCK constant id'>VERSION_CLOCK</span><span class='rparen token'>)</span><span class='comma token'>,</span>
    <span class='@sequence ivar id'>@sequence</span>      <span class='bitand op'>&amp;</span> <span class='integer val'>0x</span><span class='FFFF constant id'>FFFF</span><span class='comma token'>,</span>
    <span class='@mac ivar id'>@mac</span>           <span class='bitand op'>&amp;</span> <span class='integer val'>0x</span><span class='FFFFFFFFFFFF constant id'>FFFFFFFFFFFF</span>
  <span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>inspect</h3>
</div><div id="inspect-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>inspect</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/uuid.rb', line 242</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73/lib/uuid.rb#L242">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">242
243
244
245</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span>
  <span class='mac identifier id'>mac</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='string val'>&quot;%012x&quot;</span> <span class='mod op'>%</span> <span class='@mac ivar id'>@mac</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='scan identifier id'>scan</span><span class='lparen token'>(</span><span class='regexp val'>/[0-9a-f]{2}/</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>':'</span><span class='rparen token'>)</span>
  <span class='dstring node'>&quot;MAC: #{mac}  Sequence: #{@sequence}&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>next_sequence</h3>
</div><div id="next_sequence-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>next_sequence</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Updates the state file with a new sequence number.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/uuid.rb', line 222</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/assaf/uuid/blob/9fa1fd429dbc1fba6a5c87e51ee0eee21d2a7b73/lib/uuid.rb#L222">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='next_sequence identifier id'>next_sequence</span>
  <span class='open_lock identifier id'>open_lock</span> <span class='string val'>'r+'</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span>
    <span class='@mac ivar id'>@mac</span><span class='comma token'>,</span> <span class='@sequence ivar id'>@sequence</span><span class='comma token'>,</span> <span class='@last_clock ivar id'>@last_clock</span> <span class='assign token'>=</span> <span class='read_state identifier id'>read_state</span><span class='lparen token'>(</span><span class='io identifier id'>io</span><span class='rparen token'>)</span>

    <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='rewind identifier id'>rewind</span>
    <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='truncate identifier id'>truncate</span> <span class='integer val'>0</span>

    <span class='@sequence ivar id'>@sequence</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>

    <span class='write_state identifier id'>write_state</span> <span class='io identifier id'>io</span>
  <span class='end end kw'>end</span>
<span class='rescue rescue kw'>rescue</span> <span class='Errno constant id'>Errno</span><span class='colon2 op'>::</span><span class='ENOENT constant id'>ENOENT</span>
  <span class='open_lock identifier id'>open_lock</span> <span class='string val'>'w'</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span>
    <span class='write_state identifier id'>write_state</span> <span class='io identifier id'>io</span>
  <span class='end end kw'>end</span>
<span class='ensure ensure kw'>ensure</span>
  <span class='@last_clock ivar id'>@last_clock</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span> <span class='mult op'>*</span> <span class='CLOCK_MULTIPLIER constant id'>CLOCK_MULTIPLIER</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  <span class='@drift ivar id'>@drift</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>