<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>snusnu's dm-accepts_nested_attributes - Module: DataMapper::NestedAttributes::ClassMethods - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/snusnu/commits/dm-accepts_nested_attributes/master" rel="alternate" title="Recent Commits to dm-accepts_nested_attributes:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("snusnu", "dm-accepts_nested_attributes", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("snusnu", "dm-accepts_nested_attributes", "b7048495159fd375edb691191778ec36685f48e7", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/snusnu/dm-accepts_nested_attributes/tree/">Source</a></li>
            <li class=""><a href="http://github.com/snusnu/dm-accepts_nested_attributes/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/snusnu/dm-accepts_nested_attributes/network">Network</a></li>            
            <li class=""><a href="http://github.com/snusnu/dm-accepts_nested_attributes/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/snusnu/dm-accepts_nested_attributes">Wiki</a></li>
            <li class=""><a href="http://github.com/snusnu/dm-accepts_nested_attributes/graphs">Graphs</a></li>                    
            <li class="active"><a href="/snusnu/dm-accepts_nested_attributes">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/snusnu">snusnu</a> / <b><a href="http://github.com/snusnu/dm-accepts_nested_attributes/tree">dm-accepts_nested_attributes</a></b>        
                <a id="namespaces_button" rel="snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module DataMapper_NestedAttributes_ClassMethods">
  <h1>Module: DataMapper::NestedAttributes::ClassMethods</h1>
  <div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#accepts_nested_attributes_for-instance_method">#accepts_nested_attributes_for</span><span class='args'>(association_name, options = )</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Defines an attributes reader and writer for the specified association(s).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#associated_model_for_name-instance_method">#associated_model_for_name</span><span class='args'>(association_name, repository = :default)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
i have the feeling this should be refactored.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#association_for_name-instance_method">#association_for_name</span><span class='args'>(name, repository = :default)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
avoid nil access by always going through this this method raises if the
association named name is not established in this model.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#association_type-instance_method">#association_type</span><span class='args'>(association_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
maybe this should be provided by dm-core somehow
DataMapper::Association::Relationship would be a place maybe?.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#autosave_associations-instance_method">#autosave_associations</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#nr_of_possible_child_instances-instance_method">#nr_of_possible_child_instances</span><span class='args'>(association_name, repository = :default)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
utility methods.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reject_new_nested_attributes_proc_for-instance_method">#reject_new_nested_attributes_proc_for</span><span class='args'>(association_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>accepts_nested_attributes_for</h3>
</div><div id="accepts_nested_attributes_for-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>accepts_nested_attributes_for</span><span class='args'>(association_name, options = )</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Defines an attributes reader and writer for the specified association(s).
If you are using <tt>attr_protected</tt> or <tt>attr_accessible</tt>, then
you will need to add the attribute writer to the allowed list.
</p>
<p>
After any params are passed to the attributes writer they are available via
the attributes reader (they are stored in an instance variable of the same
name). The attributes reader returns nil if the attributes writer has not
been called.
</p>
<p>
Supported options: [:allow_destroy] If true, destroys any members from the
attributes hash with a <tt>_delete</tt> key and a value that evaluates to
<tt>true</tt> (eg. 1, &#8216;1&#8217;, true, or &#8216;true&#8217;). This
option is off by default. [:reject_if] Allows you to specify a Proc that
checks whether a record should be built for a certain attribute hash. The
hash is passed to the Proc and the Proc should return either <tt>true</tt>
or <tt>false</tt>. When no Proc is specified a record will be built for all
attribute hashes that do not have a <tt>_delete</tt> that evaluates to
true.
</p>
<p>
Examples: # creates avatar_attributes # creates avatar_attributes=
accepts_nested_attributes_for :avatar, :reject_if =&gt; proc { |attributes|
attributes[&#8216;name&#8217;].blank? } # creates avatar_attributes and
posts_attributes # creates avatar_attributes= and posts_attributes=
accepts_nested_attributes_for :avatar, :posts, :allow_destroy =&gt; true
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/dm-accepts_nested_attributes/nested_attributes.rb', line 38</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7/lib/dm-accepts_nested_attributes/nested_attributes.rb#L38">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='accepts_nested_attributes_for identifier id'>accepts_nested_attributes_for</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='semicolon token'>;</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  
  <span class='assert_kind_of identifier id'>assert_kind_of</span> <span class='string val'>'association_name'</span><span class='comma token'>,</span> <span class='association_name identifier id'>association_name</span><span class='comma token'>,</span> <span class='Symbol constant id'>Symbol</span><span class='comma token'>,</span> <span class='String constant id'>String</span>
  <span class='assert_kind_of identifier id'>assert_kind_of</span> <span class='string val'>'options'</span><span class='comma token'>,</span>          <span class='options identifier id'>options</span><span class='comma token'>,</span>          <span class='Hash constant id'>Hash</span>
  
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='symbol val'>:allow_destroy</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='update identifier id'>update</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  
  <span class='comment val'># raises if the specified option keys aren't valid</span>
  <span class='assert_valid_autosave_options identifier id'>assert_valid_autosave_options</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  
  <span class='comment val'># raises if the specified association doesn't exist</span>
  <span class='comment val'># we don't need the return value here, just the check</span>
  <span class='comment val'># ------------------------------------------------------</span>
  <span class='comment val'># also, when using the return value from this call to</span>
  <span class='comment val'># replace association_name with association.name,</span>
  <span class='comment val'># has(1, :through) are broken, because they seem to have</span>
  <span class='comment val'># a different name</span>
  
  <span class='association_for_name identifier id'>association_for_name</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='rparen token'>)</span>
  
  
  <span class='comment val'># should be safe to go on</span>
  
  <span class='include identifier id'>include</span> <span class='InstanceMethods constant id'>InstanceMethods</span>
  
  <span class='if if kw'>if</span> <span class='colon3 op'>::</span><span class='DataMapper constant id'>DataMapper</span><span class='dot token'>.</span><span class='const_defined? fid id'>const_defined?</span><span class='lparen token'>(</span><span class='string val'>'Validate'</span><span class='rparen token'>)</span>

    <span class='require identifier id'>require</span> <span class='Pathname constant id'>Pathname</span><span class='lparen token'>(</span><span class='__FILE__ __file__ kw'>__FILE__</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='dot token'>.</span><span class='expand_path identifier id'>expand_path</span> <span class='plus op'>+</span> <span class='string val'>'association_validation'</span>

    <span class='include identifier id'>include</span> <span class='AssociationValidation constant id'>AssociationValidation</span>

  <span class='end end kw'>end</span>
  
  <span class='autosave_associations identifier id'>autosave_associations</span><span class='lbrack token'>[</span><span class='association_name identifier id'>association_name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span>
  
  <span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='nr_of_possible_child_instances identifier id'>nr_of_possible_child_instances</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='rparen token'>)</span> <span class='gt op'>&gt;</span> <span class='integer val'>1</span> <span class='question op'>?</span> <span class='symbol val'>:collection</span> <span class='colon op'>:</span> <span class='symbol val'>:one_to_one</span>
  
  <span class='class_eval identifier id'>class_eval</span> <span class='dstring node'>%{
    
    def save(context = :default)
      saved = false # preserve Resource#save api contract
      transaction { |t| t.rollback unless saved = super }
      saved
    end
    
    def #{association_name}_attributes
      @#{association_name}_attributes
    end
    
    def #{association_name}_attributes=(attributes)
      attributes = sanitize_nested_attributes(attributes)
      @#{association_name}_attributes = attributes
      assign_nested_attributes_for_#{type}_association(:#{association_name}, attributes, #{options[:allow_destroy]})
    end
    
    if association_type(:#{association_name}) == :many_to_one || association_type(:#{association_name}) == :one_to_one
    
      def get_#{association_name}
        #{association_name.to_s} || self.class.associated_model_for_name(:#{association_name}).new
      end
    
    end
    
  }</span><span class='comma token'>,</span> <span class='__FILE__ __file__ kw'>__FILE__</span><span class='comma token'>,</span> <span class='__LINE__ __line__ kw'>__LINE__</span> <span class='plus op'>+</span> <span class='integer val'>1</span>
  
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>associated_model_for_name</h3>
</div><div id="associated_model_for_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>associated_model_for_name</span><span class='args'>(association_name, repository = :default)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
i have the feeling this should be refactored
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/dm-accepts_nested_attributes/nested_attributes.rb', line 118</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7/lib/dm-accepts_nested_attributes/nested_attributes.rb#L118">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">118
119
120
121
122
123
124
125
126
127
128
129
130
131
132</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='associated_model_for_name identifier id'>associated_model_for_name</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='comma token'>,</span> <span class='repository identifier id'>repository</span> <span class='assign token'>=</span> <span class='symbol val'>:default</span><span class='rparen token'>)</span>
  <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='association_for_name identifier id'>association_for_name</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='comma token'>,</span> <span class='repository identifier id'>repository</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='association_type identifier id'>association_type</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:many_to_one</span>
    <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='parent_model identifier id'>parent_model</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:one_to_one</span>
    <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='child_model identifier id'>child_model</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:one_to_many</span>
    <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='child_model identifier id'>child_model</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:many_to_many</span>
    <span class='Object constant id'>Object</span><span class='dot token'>.</span><span class='full_const_get identifier id'>full_const_get</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:child_model</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Unknown association type #{a.inspect}&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>association_for_name</h3>
</div><div id="association_for_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>association_for_name</span><span class='args'>(name, repository = :default)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
avoid nil access by always going through this this method raises if the
association named name is not established in this model
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="param">
  <h3>Parameters:</h3>
  <dl>
  
  </dl>
</div><div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>ArgumentError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/dm-accepts_nested_attributes/nested_attributes.rb', line 153</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7/lib/dm-accepts_nested_attributes/nested_attributes.rb#L153">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">153
154
155
156
157
158</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='association_for_name identifier id'>association_for_name</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='repository identifier id'>repository</span> <span class='assign token'>=</span> <span class='symbol val'>:default</span><span class='rparen token'>)</span>
  <span class='association identifier id'>association</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='relationships identifier id'>relationships</span><span class='lparen token'>(</span><span class='repository identifier id'>repository</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span>
  <span class='comment val'># TODO think about using a specific Error class like UnknownAssociationError</span>
  <span class='raise identifier id'>raise</span><span class='lparen token'>(</span><span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Relationship #{name.inspect} does not exist in \#{model}&quot;</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='association identifier id'>association</span>
  <span class='association identifier id'>association</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>association_type</h3>
</div><div id="association_type-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>association_type</span><span class='args'>(association_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
maybe this should be provided by dm-core somehow
DataMapper::Association::Relationship would be a place maybe?
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/dm-accepts_nested_attributes/nested_attributes.rb', line 136</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7/lib/dm-accepts_nested_attributes/nested_attributes.rb#L136">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">136
137
138
139
140
141
142
143
144
145
146
147
148
149</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='association_type identifier id'>association_type</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='rparen token'>)</span>
  <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='association_for_name identifier id'>association_for_name</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='max identifier id'>max</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='comment val'># belongs_to</span>
    <span class='symbol val'>:many_to_one</span>
  <span class='elsif elsif kw'>elsif</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:max</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>1</span> <span class='comment val'># has(1)</span>
    <span class='symbol val'>:one_to_one</span>
  <span class='elsif elsif kw'>elsif</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:max</span><span class='rbrack token'>]</span> <span class='gt op'>&gt;</span> <span class='integer val'>1</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='a identifier id'>a</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='DataMapper constant id'>DataMapper</span><span class='colon2 op'>::</span><span class='Associations constant id'>Associations</span><span class='colon2 op'>::</span><span class='RelationshipChain constant id'>RelationshipChain</span><span class='rparen token'>)</span> <span class='comment val'># has(n)</span>
    <span class='symbol val'>:one_to_many</span>
  <span class='elsif elsif kw'>elsif</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='DataMapper constant id'>DataMapper</span><span class='colon2 op'>::</span><span class='Associations constant id'>Associations</span><span class='colon2 op'>::</span><span class='RelationshipChain constant id'>RelationshipChain</span><span class='rparen token'>)</span> <span class='comment val'># has(n, :through) MUST be checked after has(n) here</span>
    <span class='symbol val'>:many_to_many</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Unknown association type #{a.inspect}&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>autosave_associations</h3>
</div><div id="autosave_associations-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>autosave_associations</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/dm-accepts_nested_attributes/nested_attributes.rb', line 6</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7/lib/dm-accepts_nested_attributes/nested_attributes.rb#L6">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">6
7
8</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='autosave_associations identifier id'>autosave_associations</span>
  <span class='@autosave_associations ivar id'>@autosave_associations</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>nr_of_possible_child_instances</h3>
</div><div id="nr_of_possible_child_instances-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>nr_of_possible_child_instances</span><span class='args'>(association_name, repository = :default)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
utility methods
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/dm-accepts_nested_attributes/nested_attributes.rb', line 112</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7/lib/dm-accepts_nested_attributes/nested_attributes.rb#L112">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">112
113
114
115</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='nr_of_possible_child_instances identifier id'>nr_of_possible_child_instances</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='comma token'>,</span> <span class='repository identifier id'>repository</span> <span class='assign token'>=</span> <span class='symbol val'>:default</span><span class='rparen token'>)</span>
  <span class='comment val'># belongs_to seems to generate no options[:max]</span>
  <span class='association_for_name identifier id'>association_for_name</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='comma token'>,</span> <span class='repository identifier id'>repository</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:max</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='integer val'>1</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reject_new_nested_attributes_proc_for</h3>
</div><div id="reject_new_nested_attributes_proc_for-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reject_new_nested_attributes_proc_for</span><span class='args'>(association_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/dm-accepts_nested_attributes/nested_attributes.rb', line 105</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/snusnu/dm-accepts_nested_attributes/blob/b7048495159fd375edb691191778ec36685f48e7/lib/dm-accepts_nested_attributes/nested_attributes.rb#L105">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">105
106
107</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reject_new_nested_attributes_proc_for identifier id'>reject_new_nested_attributes_proc_for</span><span class='lparen token'>(</span><span class='association_name identifier id'>association_name</span><span class='rparen token'>)</span>
  <span class='autosave_associations identifier id'>autosave_associations</span><span class='lbrack token'>[</span><span class='association_name identifier id'>association_name</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='autosave_associations identifier id'>autosave_associations</span><span class='lbrack token'>[</span><span class='association_name identifier id'>association_name</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='symbol val'>:reject_if</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>