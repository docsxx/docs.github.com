<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>why's shoes - Module: Archive::Tar::Minitar - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/why/commits/shoes/master" rel="alternate" title="Recent Commits to shoes:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("why", "shoes", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("why", "shoes", "cea39a8bf9a5b7057b1824a9fab868d1f8609d69", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/why/shoes/tree/">Source</a></li>
            <li class=""><a href="http://github.com/why/shoes/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/why/shoes/network">Network</a></li>            
            <li class=""><a href="http://github.com/why/shoes/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/why/shoes">Wiki</a></li>
            <li class=""><a href="http://github.com/why/shoes/graphs">Graphs</a></li>                    
            <li class="active"><a href="/why/shoes">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/why">why</a> / <b><a href="http://github.com/why/shoes/tree">shoes</a></b>        
                <a id="namespaces_button" rel="why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Archive_Tar_Minitar">
  <h1>Module: Archive::Tar::Minitar</h1>
  <div class="section docstring">
  <h1>Archive::Tar::Minitar 0.5.1</h1>
<p>
Archive::Tar::Minitar is a pure-Ruby library and command-line utility that
provides the ability to deal with POSIX tar(1) archive files. The
implementation is based heavily on Mauricio Fernández&#8217;s
implementation in rpa-base, but has been reorganised to promote reuse in
other projects.
</p>
<p>
This tar class performs a subset of all tar (POSIX tape archive)
operations. We can only deal with typeflags 0, 1, 2, and 5 (see
Archive::Tar::PosixHeader). All other typeflags will be treated as normal
files.
</p>
<table>
<tr><td valign="top">NOTE::</td><td>support for typeflags 1 and 2 is not yet implemented in this version.

</td></tr>
</table>
<p>
This release is version 0.5.1. The library can only handle files and
directories at this point. A future version will be expanded to handle
symbolic links and hard links in a portable manner. The command line
utility, minitar, can only create archives, extract from archives, and list
archive contents.
</p>
<h2>Synopsis</h2>
<p>
Using this library is easy. The simplest case is:
</p>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>'zlib'</span>
  <span class='require identifier id'>require</span> <span class='string val'>'archive/tar/minitar'</span>
  <span class='include identifier id'>include</span> <span class='Archive constant id'>Archive</span><span class='colon2 op'>::</span><span class='Tar constant id'>Tar</span>

    <span class='comment val'># Packs everything that matches Find.find('tests')</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>'test.tar'</span><span class='comma token'>,</span> <span class='string val'>'wb'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='tar identifier id'>tar</span><span class='bitor op'>|</span> <span class='Minitar constant id'>Minitar</span><span class='dot token'>.</span><span class='pack identifier id'>pack</span><span class='lparen token'>(</span><span class='string val'>'tests'</span><span class='comma token'>,</span> <span class='tar identifier id'>tar</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='comment val'># Unpacks 'test.tar' to 'x', creating 'x' if necessary.</span>
  <span class='Minitar constant id'>Minitar</span><span class='dot token'>.</span><span class='unpack identifier id'>unpack</span><span class='lparen token'>(</span><span class='string val'>'test.tar'</span><span class='comma token'>,</span> <span class='string val'>'x'</span><span class='rparen token'>)</span>
</pre>
<p>
A gzipped tar can be written with:
</p>
<pre class="code">
  <span class='tgz identifier id'>tgz</span> <span class='assign token'>=</span> <span class='Zlib constant id'>Zlib</span><span class='colon2 op'>::</span><span class='GzipWriter constant id'>GzipWriter</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>'test.tgz'</span><span class='comma token'>,</span> <span class='string val'>'wb'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='comment val'># Warning: tgz will be closed!</span>
  <span class='Minitar constant id'>Minitar</span><span class='dot token'>.</span><span class='pack identifier id'>pack</span><span class='lparen token'>(</span><span class='string val'>'tests'</span><span class='comma token'>,</span> <span class='tgz identifier id'>tgz</span><span class='rparen token'>)</span>

  <span class='tgz identifier id'>tgz</span> <span class='assign token'>=</span> <span class='Zlib constant id'>Zlib</span><span class='colon2 op'>::</span><span class='GzipReader constant id'>GzipReader</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>'test.tgz'</span><span class='comma token'>,</span> <span class='string val'>'rb'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='comment val'># Warning: tgz will be closed!</span>
  <span class='Minitar constant id'>Minitar</span><span class='dot token'>.</span><span class='unpack identifier id'>unpack</span><span class='lparen token'>(</span><span class='tgz identifier id'>tgz</span><span class='comma token'>,</span> <span class='string val'>'x'</span><span class='rparen token'>)</span>
</pre>
<p>
As the case above shows, one need not write to a file. However, it will
sometimes require that one dive a little deeper into the API, as in the
case of StringIO objects. Note that I&#8217;m not providing a block with
Minitar::Output, as Minitar::Output#close automatically closes both the
Output object and the wrapped data stream object.
</p>
<pre class="code">
  <span class='begin begin kw'>begin</span>
    <span class='sgz identifier id'>sgz</span> <span class='assign token'>=</span> <span class='Zlib constant id'>Zlib</span><span class='colon2 op'>::</span><span class='GzipWriter constant id'>GzipWriter</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='StringIO constant id'>StringIO</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='tar identifier id'>tar</span> <span class='assign token'>=</span> <span class='Output constant id'>Output</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='sgz identifier id'>sgz</span><span class='rparen token'>)</span>
    <span class='Find constant id'>Find</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='string val'>'tests'</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
      <span class='Minitar constant id'>Minitar</span><span class='dot token'>.</span><span class='pack_file identifier id'>pack_file</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='comma token'>,</span> <span class='tar identifier id'>tar</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='ensure ensure kw'>ensure</span>
      <span class='comment val'># Closes both tar and sgz.</span>
    <span class='tar identifier id'>tar</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
  <span class='end end kw'>end</span>
</pre>
<h2>Copyright</h2>
<p>
Copyright 2004 Mauricio Julio Fernández Pradier and Austin Ziegler
</p>
<p>
This program is based on and incorporates parts of RPA::Package from
rpa-base (lib/rpa/package.rb and lib/rpa/util.rb) by Mauricio and has been
adapted to be more generic by Austin.
</p>
<p>
&#8216;minitar&#8217; contains an adaptation of Ruby/ProgressBar by Satoru
Takabayashi &lt;satoru@namazu.org&gt;, copyright © 2001 - 2004.
</p>
<p>
This program is free software. It may be redistributed and/or modified
under the terms of the GPL version 2 (or later) or Ruby&#8217;s licence.
</p>

</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="VERSION-constant">VERSION</dt>
      <dd>&quot;0.5.1&quot;</dd>
    
  </dl>
</div>

</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#dir-3F-class_method">dir?</span><span class='args'>(path)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Tests if <tt>path</tt> refers to a directory.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#open-class_method">open</span><span class='args'>(dest, mode = &quot;r&quot;, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A convenience method for wrapping Archive::Tar::Minitar::Input.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pack-class_method">pack</span><span class='args'>(src, dest, recurse_dirs = true, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A convenience method to pack files specified by <tt>src</tt> into
<tt>dest</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pack_file-class_method">pack_file</span><span class='args'>(entry, outputter)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A convenience method to packs the file provided.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#unpack-class_method">unpack</span><span class='args'>(src, dest, files = [], &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A convenience method to unpack files from <tt>src</tt> into the directory
specified by <tt>dest</tt>.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>dir?</h3>
</div><div id="dir-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>dir?</span><span class='args'>(path)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Tests if <tt>path</tt> refers to a directory. Fixes an apparently corrupted
<tt>stat()</tt> call on Windows.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/shoes/minitar.rb', line 836</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69/lib/shoes/minitar.rb#L836">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">836
837
838</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='dir? fid id'>dir?</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='rparen token'>)</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='directory? fid id'>directory?</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>?/</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='path identifier id'>path</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;#{path}/&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>open</h3>
</div><div id="open-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>open</span><span class='args'>(dest, mode = &quot;r&quot;, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A convenience method for wrapping Archive::Tar::Minitar::Input.open (mode
<tt>r</tt>) and Archive::Tar::Minitar::Output.open (mode <tt>w</tt>). No
other modes are currently supported.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/shoes/minitar.rb', line 843</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69/lib/shoes/minitar.rb#L843">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">843
844
845
846
847
848
849
850
851
852</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='dest identifier id'>dest</span><span class='comma token'>,</span> <span class='mode identifier id'>mode</span> <span class='assign token'>=</span> <span class='string val'>&quot;r&quot;</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='mode identifier id'>mode</span>
  <span class='when when kw'>when</span> <span class='string val'>&quot;r&quot;</span>
    <span class='Input constant id'>Input</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='dest identifier id'>dest</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='string val'>&quot;w&quot;</span>
    <span class='Output constant id'>Output</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='dest identifier id'>dest</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='string val'>&quot;Unknown open mode for Archive::Tar::Minitar.open.&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pack</h3>
</div><div id="pack-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pack</span><span class='args'>(src, dest, recurse_dirs = true, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A convenience method to pack files specified by <tt>src</tt> into
<tt>dest</tt>. If <tt>src</tt> is an Array, then each file detailed therein
will be packed into the resulting Archive::Tar::Minitar::Output stream; if
<tt>recurse_dirs</tt> is true, then directories will be recursed.
</p>
<p>
If <tt>src</tt> is an Array, it will be treated as the argument to
Find.find; all files matching will be packed.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/shoes/minitar.rb', line 948</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69/lib/shoes/minitar.rb#L948">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pack identifier id'>pack</span><span class='lparen token'>(</span><span class='src identifier id'>src</span><span class='comma token'>,</span> <span class='dest identifier id'>dest</span><span class='comma token'>,</span> <span class='recurse_dirs identifier id'>recurse_dirs</span> <span class='assign token'>=</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='Output constant id'>Output</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='dest identifier id'>dest</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='outp identifier id'>outp</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='src identifier id'>src</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
      <span class='src identifier id'>src</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
        <span class='pack_file identifier id'>pack_file</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='comma token'>,</span> <span class='outp identifier id'>outp</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
        <span class='if if kw'>if</span> <span class='dir? fid id'>dir?</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='recurse_dirs identifier id'>recurse_dirs</span>
          <span class='Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;#{entry}/**/**&quot;</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='ee identifier id'>ee</span><span class='bitor op'>|</span>
            <span class='pack_file identifier id'>pack_file</span><span class='lparen token'>(</span><span class='ee identifier id'>ee</span><span class='comma token'>,</span> <span class='outp identifier id'>outp</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='Find constant id'>Find</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='src identifier id'>src</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
        <span class='pack_file identifier id'>pack_file</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='comma token'>,</span> <span class='outp identifier id'>outp</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pack_file</h3>
</div><div id="pack_file-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pack_file</span><span class='args'>(entry, outputter)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A convenience method to packs the file provided. <tt>entry</tt> may either
be a filename (in which case various values for the file (see below) will
be obtained from <tt>File#stat(entry)</tt> or a Hash with the fields:
</p>
<table>
<tr><td valign="top"><tt>:name</tt>:</td><td>The filename to be packed into the tarchive. <b>REQUIRED</b>.

</td></tr>
<tr><td valign="top"><tt>:mode</tt>:</td><td>The mode to be applied.

</td></tr>
<tr><td valign="top"><tt>:uid</tt>:</td><td>The user owner of the file. (Ignored on Windows.)

</td></tr>
<tr><td valign="top"><tt>:gid</tt>:</td><td>The group owner of the file. (Ignored on Windows.)

</td></tr>
<tr><td valign="top"><tt>:mtime</tt>:</td><td>The modification Time of the file.

</td></tr>
</table>
<p>
During packing, if a block is provided, #pack_file yields an
<tt>action</tt> Symol, the full name of the file being packed, and a Hash
of statistical information, just as with
Archive::Tar::Minitar::Input#extract_entry.
</p>
<p>
The <tt>action</tt> will be one of:
</p>
<table>
<tr><td valign="top"><tt>:dir</tt>:</td><td>The <tt>entry</tt> is a directory.

</td></tr>
<tr><td valign="top"><tt>:file_start</tt>:</td><td>The <tt>entry</tt> is a file; the extract of the file is just beginning.

</td></tr>
<tr><td valign="top"><tt>:file_progress</tt>:</td><td>Yielded every 4096 bytes during the extract of the <tt>entry</tt>.

</td></tr>
<tr><td valign="top"><tt>:file_done</tt>:</td><td>Yielded when the <tt>entry</tt> is completed.

</td></tr>
</table>
<p>
The <tt>stats</tt> hash contains the following keys:
</p>
<table>
<tr><td valign="top"><tt>:current</tt>:</td><td>The current total number of bytes read in the <tt>entry</tt>.

</td></tr>
<tr><td valign="top"><tt>:currinc</tt>:</td><td>The current number of bytes read in this read cycle.

</td></tr>
<tr><td valign="top"><tt>:name</tt>:</td><td>The filename to be packed into the tarchive. <b>REQUIRED</b>.

</td></tr>
<tr><td valign="top"><tt>:mode</tt>:</td><td>The mode to be applied.

</td></tr>
<tr><td valign="top"><tt>:uid</tt>:</td><td>The user owner of the file. (<tt>nil</tt> on Windows.)

</td></tr>
<tr><td valign="top"><tt>:gid</tt>:</td><td>The group owner of the file. (<tt>nil</tt> on Windows.)

</td></tr>
<tr><td valign="top"><tt>:mtime</tt>:</td><td>The modification Time of the file.

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/shoes/minitar.rb', line 889</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69/lib/shoes/minitar.rb#L889">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pack_file identifier id'>pack_file</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='comma token'>,</span> <span class='outputter identifier id'>outputter</span><span class='rparen token'>)</span> <span class='comment val'>#:yields action, name, stats:</span>
  <span class='outputter identifier id'>outputter</span> <span class='assign token'>=</span> <span class='outputter identifier id'>outputter</span><span class='dot token'>.</span><span class='tar identifier id'>tar</span> <span class='if if_mod kw'>if</span> <span class='outputter identifier id'>outputter</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Archive constant id'>Archive</span><span class='colon2 op'>::</span><span class='Tar constant id'>Tar</span><span class='colon2 op'>::</span><span class='Minitar constant id'>Minitar</span><span class='colon2 op'>::</span><span class='Output constant id'>Output</span><span class='rparen token'>)</span>

  <span class='stats identifier id'>stats</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

  <span class='if if kw'>if</span> <span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='kind_of? fid id'>kind_of?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span>
    <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='rbrack token'>]</span>

    <span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='kk identifier id'>kk</span><span class='comma token'>,</span> <span class='vv identifier id'>vv</span><span class='bitor op'>|</span> <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='kk identifier id'>kk</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='vv identifier id'>vv</span> <span class='unless unless_mod kw'>unless</span> <span class='vv identifier id'>vv</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='entry identifier id'>entry</span>
  <span class='end end kw'>end</span>
  
  <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='name identifier id'>name</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>%r{\./}</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='stat identifier id'>stat</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:mode</span><span class='rbrack token'>]</span>   <span class='opasgn op'>||=</span> <span class='stat identifier id'>stat</span><span class='dot token'>.</span><span class='mode identifier id'>mode</span>
  <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:mtime</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='stat identifier id'>stat</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>
  <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:size</span><span class='rbrack token'>]</span>   <span class='assign token'>=</span> <span class='stat identifier id'>stat</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
  <span class='if if kw'>if</span> <span class='name identifier id'>name</span> <span class='eq op'>==</span> <span class='string val'>&quot;sh-install&quot;</span> <span class='comment val'># an ugly shoes-specific hack, to</span>
    <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:mode</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='integer val'>0755</span>   <span class='comment val'># get the file to be 0755 on windows</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='RUBY_PLATFORM constant id'>RUBY_PLATFORM</span> <span class='match op'>=~</span> <span class='regexp val'>/win32/</span>
    <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:uid</span><span class='rbrack token'>]</span>  <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
    <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:gid</span><span class='rbrack token'>]</span>  <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='else else kw'>else</span>
    <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:uid</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='stat identifier id'>stat</span><span class='dot token'>.</span><span class='uid identifier id'>uid</span>
    <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:gid</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='stat identifier id'>stat</span><span class='dot token'>.</span><span class='gid identifier id'>gid</span>
  <span class='end end kw'>end</span>

  <span class='case case kw'>case</span>
  <span class='when when kw'>when</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
    <span class='outputter identifier id'>outputter</span><span class='dot token'>.</span><span class='add_file_simple identifier id'>add_file_simple</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='stats identifier id'>stats</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='os identifier id'>os</span><span class='bitor op'>|</span>
      <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:current</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='yield yield kw'>yield</span> <span class='symbol val'>:file_start</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='stats identifier id'>stats</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
      <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='string val'>&quot;rb&quot;</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='ff identifier id'>ff</span><span class='bitor op'>|</span>
        <span class='until until kw'>until</span> <span class='ff identifier id'>ff</span><span class='dot token'>.</span><span class='eof? fid id'>eof?</span>
          <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:currinc</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='os identifier id'>os</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='ff identifier id'>ff</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='integer val'>4096</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
          <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:current</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='stats identifier id'>stats</span><span class='lbrack token'>[</span><span class='symbol val'>:currinc</span><span class='rbrack token'>]</span>
          <span class='yield yield kw'>yield</span> <span class='symbol val'>:file_progress</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='stats identifier id'>stats</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
      <span class='yield yield kw'>yield</span> <span class='symbol val'>:file_done</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='stats identifier id'>stats</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
    <span class='end end kw'>end</span>
  <span class='when when kw'>when</span> <span class='dir? fid id'>dir?</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
    <span class='yield yield kw'>yield</span> <span class='symbol val'>:dir</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='stats identifier id'>stats</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
    <span class='outputter identifier id'>outputter</span><span class='dot token'>.</span><span class='mkdir identifier id'>mkdir</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='stats identifier id'>stats</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='string val'>&quot;Don't yet know how to pack this type of file.&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>unpack</h3>
</div><div id="unpack-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>unpack</span><span class='args'>(src, dest, files = [], &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A convenience method to unpack files from <tt>src</tt> into the directory
specified by <tt>dest</tt>. Only those files named explicitly in
<tt>files</tt> will be extracted.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/shoes/minitar.rb', line 970</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/why/shoes/blob/cea39a8bf9a5b7057b1824a9fab868d1f8609d69/lib/shoes/minitar.rb#L970">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">970
971
972
973
974
975
976
977
978
979
980
981
982
983
984</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='unpack identifier id'>unpack</span><span class='lparen token'>(</span><span class='src identifier id'>src</span><span class='comma token'>,</span> <span class='dest identifier id'>dest</span><span class='comma token'>,</span> <span class='files identifier id'>files</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='Input constant id'>Input</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='src identifier id'>src</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='inp identifier id'>inp</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='dest identifier id'>dest</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='lparen token'>(</span><span class='not not kw'>not</span> <span class='dir? fid id'>dir?</span><span class='lparen token'>(</span><span class='dest identifier id'>dest</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='raise identifier id'>raise</span> <span class='string val'>&quot;Can't unpack to a non-directory.&quot;</span>
    <span class='elsif elsif kw'>elsif</span> <span class='not not kw'>not</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='dest identifier id'>dest</span><span class='rparen token'>)</span>
      <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mkdir_p identifier id'>mkdir_p</span><span class='lparen token'>(</span><span class='dest identifier id'>dest</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='inp identifier id'>inp</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
      <span class='if if kw'>if</span> <span class='files identifier id'>files</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='or or kw'>or</span> <span class='files identifier id'>files</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='full_name identifier id'>full_name</span><span class='rparen token'>)</span>
        <span class='inp identifier id'>inp</span><span class='dot token'>.</span><span class='extract_entry identifier id'>extract_entry</span><span class='lparen token'>(</span><span class='dest identifier id'>dest</span><span class='comma token'>,</span> <span class='entry identifier id'>entry</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> Â©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>