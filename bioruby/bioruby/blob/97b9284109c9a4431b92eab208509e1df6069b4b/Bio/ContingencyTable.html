<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>bioruby's bioruby - Class: Bio::ContingencyTable - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/bioruby/commits/bioruby/master" rel="alternate" title="Recent Commits to bioruby:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("bioruby", "bioruby", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("bioruby", "bioruby", "97b9284109c9a4431b92eab208509e1df6069b4b", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/bioruby/bioruby/tree/">Source</a></li>
            <li class=""><a href="http://github.com/bioruby/bioruby/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/bioruby/bioruby/network">Network</a></li>            
            <li class=""><a href="http://github.com/bioruby/bioruby/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/bioruby/bioruby">Wiki</a></li>
            <li class=""><a href="http://github.com/bioruby/bioruby/graphs">Graphs</a></li>                    
            <li class="active"><a href="/bioruby/bioruby">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/bioruby">bioruby</a> / <b><a href="http://github.com/bioruby/bioruby/tree">bioruby</a></b>        
                <a id="namespaces_button" rel="bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Bio_ContingencyTable">
  <h1>Class: Bio::ContingencyTable</h1>
  <div class="section docstring">
  <p>
bio/util/contingency_table.rb - Statistical contingency table analysis for
aligned sequences
</p>
<table>
<tr><td valign="top">Author:</td><td>Trevor Wennblom &lt;mailto:trevor@corevx.com&gt;

</td></tr>
<tr><td valign="top">Copyright:</td><td>Copyright &#169; 2005-2007 Midwinter Laboratories, LLC
(http://midwinterlabs.com)

</td></tr>
<tr><td valign="top">License:</td><td>The Ruby License

</td></tr>
</table>
<h1>Description</h1>
<p>
The Bio::ContingencyTable class provides basic statistical contingency
table analysis for two positions within aligned sequences.
</p>
<p>
When ContingencyTable is instantiated the set of characters in the aligned
sequences may be passed to it as an array. This is important since it uses
these characters to create the table&#8217;s rows and columns. If this
array is not passed it will use it&#8217;s default of an amino acid and
nucleotide alphabet in lowercase along with the clustal spacer
&#8217;-&#8217;.
</p>
<p>
To get data from the table the most used functions will be chi_square and
contingency_coefficient:
</p>
<pre class="code">
  <span class='ctable identifier id'>ctable</span> <span class='assign token'>=</span> <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='ContingencyTable constant id'>ContingencyTable</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
  <span class='ctable identifier id'>ctable</span><span class='lbrack token'>[</span><span class='string val'>'a'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'t'</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
  <span class='comment val'># .. put more values into the table</span>
  <span class='puts identifier id'>puts</span> <span class='ctable identifier id'>ctable</span><span class='dot token'>.</span><span class='chi_square identifier id'>chi_square</span>
  <span class='puts identifier id'>puts</span> <span class='ctable identifier id'>ctable</span><span class='dot token'>.</span><span class='contingency_coefficient identifier id'>contingency_coefficient</span>  <span class='comment val'># between 0.0 and 1.0</span>
</pre>
<p>
The contingency_coefficient represents the degree of correlation of change
between two sequence positions in a multiple-sequence alignment. 0.0
indicates no correlation, 1.0 is the maximum correlation.
</p>
<h1>Further Reading</h1>
<ul>
<li>http://en.wikipedia.org/wiki/Contingency_table

</li>
<li>http://www.physics.csbsju.edu/stats/exact.details.html

</li>
<li>Numerical Recipes in C by Press, Flannery, Teukolsky, and Vetterling

</li>
</ul>
<h1>Usage</h1>
<p>
What follows is an example of ContingencyTable in typical usage analyzing
results from a clustal alignment.
</p>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>'bio'</span>

  <span class='seqs identifier id'>seqs</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='max_length identifier id'>max_length</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='ClustalW constant id'>ClustalW</span><span class='colon2 op'>::</span><span class='Report constant id'>Report</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span> <span class='IO constant id'>IO</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='string val'>'sample.aln'</span><span class='rparen token'>)</span> <span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
    <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='data identifier id'>data</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span>
    <span class='seqs identifier id'>seqs</span><span class='lbrack token'>[</span><span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='definition identifier id'>definition</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span>
    <span class='max_length identifier id'>max_length</span> <span class='assign token'>=</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='if if_mod kw'>if</span> <span class='max_length identifier id'>max_length</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
    <span class='raise identifier id'>raise</span> <span class='string val'>&quot;Aligned sequences must be the same length!&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='data identifier id'>data</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='max_length identifier id'>max_length</span>
  <span class='end end kw'>end</span>

  <span class='VERBOSE constant id'>VERBOSE</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='puts identifier id'>puts</span> <span class='string val'>&quot;i\tj\tchi_square\tcontingency_coefficient&quot;</span> <span class='if if_mod kw'>if</span> <span class='VERBOSE constant id'>VERBOSE</span>
  <span class='correlations identifier id'>correlations</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

  <span class='integer val'>0</span><span class='dot token'>.</span><span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max_length identifier id'>max_length</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
    <span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='lt op'>&lt;</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max_length identifier id'>max_length</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='j identifier id'>j</span><span class='bitor op'>|</span>
      <span class='ctable identifier id'>ctable</span> <span class='assign token'>=</span> <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='ContingencyTable constant id'>ContingencyTable</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
      <span class='seqs identifier id'>seqs</span><span class='dot token'>.</span><span class='each_value identifier id'>each_value</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='seq identifier id'>seq</span><span class='bitor op'>|</span> <span class='ctable identifier id'>ctable</span><span class='dot token'>.</span><span class='table identifier id'>table</span><span class='lbrack token'>[</span> <span class='seq identifier id'>seq</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='chr identifier id'>chr</span> <span class='rbrack token'>]</span><span class='lbrack token'>[</span> <span class='seq identifier id'>seq</span><span class='lbrack token'>[</span><span class='j identifier id'>j</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='chr identifier id'>chr</span> <span class='rbrack token'>]</span> <span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;= 1 }

      chi_square = ctable.chi_square
      contingency_coefficient = ctable.contingency_coefficient
      puts [(i&lt;tt&gt;1), (j&lt;/</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='chi_square identifier id'>chi_square</span><span class='comma token'>,</span> <span class='contingency_coefficient identifier id'>contingency_coefficient</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;\t&quot;</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='VERBOSE constant id'>VERBOSE</span>

      <span class='correlations identifier id'>correlations</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;#{i&lt;tt&gt;1},#{j&lt;/tt&gt;1}&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='contingency_coefficient identifier id'>contingency_coefficient</span>
      <span class='correlations identifier id'>correlations</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;#{j&lt;tt&gt;1},#{i&lt;/tt&gt;1}&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='contingency_coefficient identifier id'>contingency_coefficient</span>  <span class='comment val'># Both ways are accurate</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='require identifier id'>require</span> <span class='string val'>'yaml'</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'results.yml'</span><span class='comma token'>,</span> <span class='string val'>'a&lt;tt&gt;'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span> <span class='f identifier id'>f</span><span class='dot token'>.</span><span class='puts identifier id'>puts</span> <span class='correlations identifier id'>correlations</span><span class='dot token'>.</span><span class='to_yaml identifier id'>to_yaml</span> <span class='rbrace token'>}</span>
</pre>
<h1>Tutorial</h1>
<p>
ContingencyTable returns the statistical significance of change between two
positions in an alignment. If you would like to see how every possible
combination of positions in your alignment compares to one another you must
set this up yourself. Hopefully the provided examples will help you get
started without too much trouble.
</p>
<pre class="code">
  <span class='def def kw'>def</span> <span class='lite_example identifier id'>lite_example</span><span class='lparen token'>(</span><span class='sequences identifier id'>sequences</span><span class='comma token'>,</span> <span class='max_length identifier id'>max_length</span><span class='comma token'>,</span> <span class='characters identifier id'>characters</span><span class='rparen token'>)</span>

    <span class='dstring node'>%w{i j chi_square contingency_coefficient}</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='print identifier id'>print</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='ljust identifier id'>ljust</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='puts identifier id'>puts</span>

    <span class='integer val'>0</span><span class='dot token'>.</span><span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='max_length identifier id'>max_length</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
      <span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='lt op'>&lt;</span><span class='regexp val'>/tt&gt;1).upto(max_length - 1) do |j|
        ctable = Bio::ContingencyTable.new( characters )
        sequences.each do |seq|
          i_char = seq[i].chr
          j_char = seq[j].chr
          ctable.table[i_char][j_char] &lt;tt&gt;= 1
        end
        chi_square = ctable.chi_square
        contingency_coefficient = ctable.contingency_coefficient
        [(i&lt;/</span><span class='tt identifier id'>tt</span><span class='gt op'>&gt;</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='j identifier id'>j</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='chi_square identifier id'>chi_square</span><span class='comma token'>,</span> <span class='contingency_coefficient identifier id'>contingency_coefficient</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='print identifier id'>print</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='ljust identifier id'>ljust</span><span class='lparen token'>(</span><span class='integer val'>12</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
        <span class='puts identifier id'>puts</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

  <span class='end end kw'>end</span>

  <span class='allowed_letters identifier id'>allowed_letters</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='allowed_letters identifier id'>allowed_letters</span> <span class='assign token'>=</span> <span class='string val'>'abcdefghijk'</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>

  <span class='seqs identifier id'>seqs</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'abcde'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'abcde'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'aacje'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'aacae'</span>

  <span class='length_of_every_sequence identifier id'>length_of_every_sequence</span> <span class='assign token'>=</span> <span class='seqs identifier id'>seqs</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='size identifier id'>size</span>  <span class='comment val'># 5 letters long</span>

  <span class='lite_example identifier id'>lite_example</span><span class='lparen token'>(</span><span class='seqs identifier id'>seqs</span><span class='comma token'>,</span> <span class='length_of_every_sequence identifier id'>length_of_every_sequence</span><span class='comma token'>,</span> <span class='allowed_letters identifier id'>allowed_letters</span><span class='rparen token'>)</span>
</pre>
<p>
Producing the following results:
</p>
<pre class="code">
  <span class='i identifier id'>i</span>           <span class='j identifier id'>j</span>           <span class='chi_square identifier id'>chi_square</span>  <span class='contingency_coefficient identifier id'>contingency_coefficient</span>
  <span class='integer val'>1</span>           <span class='integer val'>2</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>1</span>           <span class='integer val'>3</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>1</span>           <span class='integer val'>4</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>1</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>2</span>           <span class='integer val'>3</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>2</span>           <span class='integer val'>4</span>           <span class='float val'>4.0</span>         <span class='integer val'>0</span><span class='integer val'>.707106781186548</span>
  <span class='integer val'>2</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>3</span>           <span class='integer val'>4</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>3</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>4</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
</pre>
<p>
The position i=2 and j=4 has a high contingency coefficient indicating that
the changes at these positions are related. Note that i and j are
arbitrary, this could be represented as i=4 and j=2 since they both refer
to position two and position four in the alignment. Here are some more
examples:
</p>
<pre class="code">
  <span class='seqs identifier id'>seqs</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'abcde'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'abcde'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'aacje'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'aacae'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'akcfe'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'akcfe'</span>

  <span class='length_of_every_sequence identifier id'>length_of_every_sequence</span> <span class='assign token'>=</span> <span class='seqs identifier id'>seqs</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='size identifier id'>size</span>  <span class='comment val'># 5 letters long</span>

  <span class='lite_example identifier id'>lite_example</span><span class='lparen token'>(</span><span class='seqs identifier id'>seqs</span><span class='comma token'>,</span> <span class='length_of_every_sequence identifier id'>length_of_every_sequence</span><span class='comma token'>,</span> <span class='allowed_letters identifier id'>allowed_letters</span><span class='rparen token'>)</span>
</pre>
<p>
Results:
</p>
<pre class="code">
  <span class='i identifier id'>i</span>           <span class='j identifier id'>j</span>           <span class='chi_square identifier id'>chi_square</span>  <span class='contingency_coefficient identifier id'>contingency_coefficient</span>
  <span class='integer val'>1</span>           <span class='integer val'>2</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>1</span>           <span class='integer val'>3</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>1</span>           <span class='integer val'>4</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>1</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>2</span>           <span class='integer val'>3</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>2</span>           <span class='integer val'>4</span>           <span class='float val'>12.0</span>        <span class='integer val'>0</span><span class='integer val'>.816496580927726</span>
  <span class='integer val'>2</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>3</span>           <span class='integer val'>4</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>3</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>4</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
</pre>
<p>
Here we can see that the strength of the correlation of change has
increased when more data is added with correlated changes at the same
positions.
</p>
<pre class="code">
  <span class='seqs identifier id'>seqs</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'abcde'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'abcde'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'kacje'</span>  <span class='comment val'># changed first letter</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'aacae'</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'akcfa'</span>  <span class='comment val'># changed last letter</span>
  <span class='seqs identifier id'>seqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>'akcfe'</span>

  <span class='length_of_every_sequence identifier id'>length_of_every_sequence</span> <span class='assign token'>=</span> <span class='seqs identifier id'>seqs</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='size identifier id'>size</span>  <span class='comment val'># 5 letters long</span>

  <span class='lite_example identifier id'>lite_example</span><span class='lparen token'>(</span><span class='seqs identifier id'>seqs</span><span class='comma token'>,</span> <span class='length_of_every_sequence identifier id'>length_of_every_sequence</span><span class='comma token'>,</span> <span class='allowed_letters identifier id'>allowed_letters</span><span class='rparen token'>)</span>
</pre>
<p>
Results:
</p>
<pre class="code">
  <span class='i identifier id'>i</span>           <span class='j identifier id'>j</span>           <span class='chi_square identifier id'>chi_square</span>  <span class='contingency_coefficient identifier id'>contingency_coefficient</span>
  <span class='integer val'>1</span>           <span class='integer val'>2</span>           <span class='float val'>2.4</span>         <span class='integer val'>0</span><span class='integer val'>.534522483824849</span>
  <span class='integer val'>1</span>           <span class='integer val'>3</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>1</span>           <span class='integer val'>4</span>           <span class='float val'>6.0</span>         <span class='integer val'>0</span><span class='integer val'>.707106781186548</span>
  <span class='integer val'>1</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.24</span>        <span class='integer val'>0</span><span class='integer val'>.196116135138184</span>
  <span class='integer val'>2</span>           <span class='integer val'>3</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>2</span>           <span class='integer val'>4</span>           <span class='float val'>12.0</span>        <span class='integer val'>0</span><span class='integer val'>.816496580927726</span>
  <span class='integer val'>2</span>           <span class='integer val'>5</span>           <span class='float val'>2.4</span>         <span class='integer val'>0</span><span class='integer val'>.534522483824849</span>
  <span class='integer val'>3</span>           <span class='integer val'>4</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>3</span>           <span class='integer val'>5</span>           <span class='integer val'>0</span><span class='integer val'>.0</span>         <span class='integer val'>0</span><span class='integer val'>.0</span>
  <span class='integer val'>4</span>           <span class='integer val'>5</span>           <span class='float val'>2.4</span>         <span class='integer val'>0</span><span class='integer val'>.534522483824849</span>
</pre>
<p>
With random changes it becomes more difficult to identify correlated
changes, yet positions two and four still have the highest correlation as
indicated by the contingency coefficient. The best way to improve the
accuracy of your results, as is often the case with statistics, is to
increase the sample size.
</p>
<h1>A Note on Efficiency</h1>
<p>
ContingencyTable is slow. It involves many calculations for even a
seemingly small five-string data set. Even worse, it&#8217;s very dependent
on matrix traversal, and this is done with two dimensional hashes which
dashes any hope of decent speed.
</p>
<p>
Finally, half of the matrix is redundant and positions could be summed with
their companion position to reduce calculations. For example the positions
(5,2) and (2,5) could both have their values added together and just stored
in (2,5) while (5,2) could be an illegal position. Also, positions (1,1),
(2,2), (3,3), etc. will never be used.
</p>
<p>
The purpose of this package is flexibility and education. The code is short
and to the point in aims of achieving that purpose. If the BioRuby project
moves towards C extensions in the future a professional caliber version
will likely be created.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">characters</td>
          <td class="readwrite">
            [<span id='characters-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>characters</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">table</td>
          <td class="readwrite">
            [<span id='table-instance_method'>R</span><span id='table=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Since we&#8217;re making this math-notation friendly here is the layout of
@table:
</p>
<ul>
<li>@table[row][column]

</li>
<li>@table[i][j]

</li>
<li>@table[y][x].

</li>
</ul>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(characters_in_sequences = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a ContingencyTable that has characters_in_sequence.size rows and
characters_in_sequence.size columns for each row
</p>
<hr size="1"></hr><p>
<b>Arguments</b>
</p>
<ul>
<li><tt>characters_in_sequences</tt>: (<em>optional</em>) The allowable
characters that will be present in the aligned sequences.

</li>
</ul>
<table>
<tr><td valign="top"><b>Returns</b>:</td><td><tt>ContingencyTable</tt> object to be filled with values and calculated
upon

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/util/contingency_table.rb', line 256</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/util/contingency_table.rb#L256">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">256
257
258
259
260</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='characters_in_sequences identifier id'>characters_in_sequences</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='@characters ivar id'>@characters</span> <span class='assign token'>=</span> <span class='lparen token'>(</span> <span class='characters_in_sequences identifier id'>characters_in_sequences</span> <span class='or or kw'>or</span> <span class='dstring node'>%w{a c d e f g h i k l m n p q r s t v w y - x u}</span> <span class='rparen token'>)</span>
  <span class='tmp identifier id'>tmp</span> <span class='assign token'>=</span> <span class='Hash constant id'>Hash</span><span class='lbrack token'>[</span><span class='mult op'>*</span><span class='@characters ivar id'>@characters</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span><span class='v identifier id'>v</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='flatten identifier id'>flatten</span><span class='rbrack token'>]</span>
  <span class='@table ivar id'>@table</span> <span class='assign token'>=</span> <span class='Hash constant id'>Hash</span><span class='lbrack token'>[</span><span class='mult op'>*</span><span class='@characters ivar id'>@characters</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span><span class='v identifier id'>v</span><span class='comma token'>,</span> <span class='tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='flatten identifier id'>flatten</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#chi_square-instance_method">#chi_square</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Report the chi square of the entire table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#chi_square_element-instance_method">#chi_square_element</span><span class='args'>(i, j)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Report the chi-square relation of two elements in the table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#column_sum-instance_method">#column_sum</span><span class='args'>(j)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Report the sum of all values in a given column.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#column_sum_all-instance_method">#column_sum_all</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Report the sum of all values in all columns.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#contingency_coefficient-instance_method">#contingency_coefficient</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Report the contingency coefficient of the table.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#expected-instance_method">#expected</span><span class='args'>(i, j)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Calculate <em>e</em>, the <em>expected</em> value.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#row_sum-instance_method">#row_sum</span><span class='args'>(i)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Report the sum of all values in a given row.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#row_sum_all-instance_method">#row_sum_all</span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#table_sum_all</span>
        
      </th>
      <td class="docstring">
        <p>
Report the sum of all values in all rows.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>chi_square</h3>
</div><div id="chi_square-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>chi_square</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Report the chi square of the entire table
</p>
<hr size="1"></hr><p>
<b>Arguments</b>
</p>
<ul>
<li><em>none</em>

</li>
</ul>
<table>
<tr><td valign="top"><b>Returns</b>:</td><td><tt>Float</tt> chi square value

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/util/contingency_table.rb', line 332</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/util/contingency_table.rb#L332">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">332
333
334
335
336
337
338
339
340
341
342</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='chi_square identifier id'>chi_square</span>
  <span class='total identifier id'>total</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='@characters ivar id'>@characters</span>
  <span class='max identifier id'>max</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='minus op'>-</span> <span class='integer val'>1</span>
  <span class='@characters ivar id'>@characters</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>    <span class='comment val'># Loop through every row in the ContingencyTable</span>
    <span class='@characters ivar id'>@characters</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='j identifier id'>j</span><span class='bitor op'>|</span>  <span class='comment val'># Loop through every column in the ContingencyTable</span>
      <span class='total identifier id'>total</span> <span class='opasgn op'>+=</span> <span class='chi_square_element identifier id'>chi_square_element</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='comma token'>,</span> <span class='j identifier id'>j</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='total identifier id'>total</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>chi_square_element</h3>
</div><div id="chi_square_element-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>chi_square_element</span><span class='args'>(i, j)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Report the chi-square relation of two elements in the table
</p>
<hr size="1"></hr><p>
<b>Arguments</b>
</p>
<ul>
<li><tt>i</tt>: row

</li>
<li><tt>j</tt>: column

</li>
</ul>
<table>
<tr><td valign="top"><b>Returns</b>:</td><td><tt>Float</tt> chi-square of an intersection

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/util/contingency_table.rb', line 351</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/util/contingency_table.rb#L351">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">351
352
353
354
355</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='chi_square_element identifier id'>chi_square_element</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='comma token'>,</span> <span class='j identifier id'>j</span><span class='rparen token'>)</span>
  <span class='eij identifier id'>eij</span> <span class='assign token'>=</span> <span class='expected identifier id'>expected</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='comma token'>,</span> <span class='j identifier id'>j</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='integer val'>0</span> <span class='if if_mod kw'>if</span> <span class='eij identifier id'>eij</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
  <span class='lparen token'>(</span> <span class='@table ivar id'>@table</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='j identifier id'>j</span><span class='rbrack token'>]</span> <span class='minus op'>-</span> <span class='eij identifier id'>eij</span> <span class='rparen token'>)</span><span class='pow op'>**</span><span class='integer val'>2</span> <span class='div op'>/</span> <span class='eij identifier id'>eij</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>column_sum</h3>
</div><div id="column_sum-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>column_sum</span><span class='args'>(j)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Report the sum of all values in a given column
</p>
<hr size="1"></hr><p>
<b>Arguments</b>
</p>
<ul>
<li><tt>j</tt>: Column to sum

</li>
</ul>
<table>
<tr><td valign="top"><b>Returns</b>:</td><td><tt>Integer</tt> sum of column

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/util/contingency_table.rb', line 280</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/util/contingency_table.rb#L280">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">280
281
282
283
284</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='column_sum identifier id'>column_sum</span><span class='lparen token'>(</span><span class='j identifier id'>j</span><span class='rparen token'>)</span>
  <span class='total identifier id'>total</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@table ivar id'>@table</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='row_key identifier id'>row_key</span><span class='comma token'>,</span> <span class='column identifier id'>column</span><span class='bitor op'>|</span> <span class='total identifier id'>total</span> <span class='opasgn op'>+=</span> <span class='column identifier id'>column</span><span class='lbrack token'>[</span><span class='j identifier id'>j</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='total identifier id'>total</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>column_sum_all</h3>
</div><div id="column_sum_all-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>column_sum_all</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Report the sum of all values in all columns.
</p>
<ul>
<li>This is the same thing as asking for the sum of all values in the table.

</li>
</ul>
<hr size="1"></hr><p>
<b>Arguments</b>
</p>
<ul>
<li><em>none</em>

</li>
</ul>
<table>
<tr><td valign="top"><b>Returns</b>:</td><td><tt>Integer</tt> sum of all columns

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/util/contingency_table.rb', line 294</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/util/contingency_table.rb#L294">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">294
295
296
297
298</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='column_sum_all identifier id'>column_sum_all</span>
  <span class='total identifier id'>total</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@characters ivar id'>@characters</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='j identifier id'>j</span><span class='bitor op'>|</span> <span class='total identifier id'>total</span> <span class='opasgn op'>+=</span> <span class='column_sum identifier id'>column_sum</span><span class='lparen token'>(</span><span class='j identifier id'>j</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='total identifier id'>total</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>contingency_coefficient</h3>
</div><div id="contingency_coefficient-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>contingency_coefficient</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Report the contingency coefficient of the table
</p>
<hr size="1"></hr><p>
<b>Arguments</b>
</p>
<ul>
<li><em>none</em>

</li>
</ul>
<table>
<tr><td valign="top"><b>Returns</b>:</td><td><tt>Float</tt> contingency_coefficient of the table

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/util/contingency_table.rb', line 363</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/util/contingency_table.rb#L363">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">363
364
365
366</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='contingency_coefficient identifier id'>contingency_coefficient</span>
  <span class='c_s identifier id'>c_s</span> <span class='assign token'>=</span> <span class='chi_square identifier id'>chi_square</span>
  <span class='Math constant id'>Math</span><span class='dot token'>.</span><span class='sqrt identifier id'>sqrt</span><span class='lparen token'>(</span><span class='c_s identifier id'>c_s</span> <span class='div op'>/</span> <span class='lparen token'>(</span><span class='table_sum_all identifier id'>table_sum_all</span> <span class='plus op'>+</span> <span class='c_s identifier id'>c_s</span><span class='rparen token'>)</span> <span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>expected</h3>
</div><div id="expected-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>expected</span><span class='args'>(i, j)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Calculate <em>e</em>, the <em>expected</em> value.
</p>
<hr size="1"></hr><p>
<b>Arguments</b>
</p>
<ul>
<li><tt>i</tt>: row

</li>
<li><tt>j</tt>: column

</li>
</ul>
<table>
<tr><td valign="top"><b>Returns</b>:</td><td><tt>Float</tt> e(sub:ij) = (r(sub:i)/N) * (c(sub:j))

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/util/contingency_table.rb', line 322</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/util/contingency_table.rb#L322">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">322
323
324</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='expected identifier id'>expected</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='comma token'>,</span> <span class='j identifier id'>j</span><span class='rparen token'>)</span>
  <span class='lparen token'>(</span><span class='row_sum identifier id'>row_sum</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_f identifier id'>to_f</span> <span class='div op'>/</span> <span class='table_sum_all identifier id'>table_sum_all</span><span class='rparen token'>)</span> <span class='mult op'>*</span> <span class='column_sum identifier id'>column_sum</span><span class='lparen token'>(</span><span class='j identifier id'>j</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>row_sum</h3>
</div><div id="row_sum-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>row_sum</span><span class='args'>(i)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Report the sum of all values in a given row
</p>
<hr size="1"></hr><p>
<b>Arguments</b>
</p>
<ul>
<li><tt>i</tt>: Row to sum

</li>
</ul>
<table>
<tr><td valign="top"><b>Returns</b>:</td><td><tt>Integer</tt> sum of row

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/util/contingency_table.rb', line 268</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/util/contingency_table.rb#L268">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">268
269
270
271
272</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='row_sum identifier id'>row_sum</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='rparen token'>)</span>
  <span class='total identifier id'>total</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@table ivar id'>@table</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='total identifier id'>total</span> <span class='opasgn op'>+=</span> <span class='v identifier id'>v</span> <span class='rbrace token'>}</span>
  <span class='total identifier id'>total</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>row_sum_all</h3>
</div><div id="row_sum_all-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>row_sum_all</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="table_sum_all-instance_method">table_sum_all</tt>
  
</p>
</div><div class="section docstring">
  <p>
Report the sum of all values in all rows.
</p>
<ul>
<li>This is the same thing as asking for the sum of all values in the table.

</li>
</ul>
<hr size="1"></hr><p>
<b>Arguments</b>
</p>
<ul>
<li><em>none</em>

</li>
</ul>
<table>
<tr><td valign="top"><b>Returns</b>:</td><td><tt>Integer</tt> sum of all rows

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/util/contingency_table.rb', line 308</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/util/contingency_table.rb#L308">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">308
309
310
311
312</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='row_sum_all identifier id'>row_sum_all</span>
  <span class='total identifier id'>total</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@characters ivar id'>@characters</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span> <span class='total identifier id'>total</span> <span class='opasgn op'>+=</span> <span class='row_sum identifier id'>row_sum</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='total identifier id'>total</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>