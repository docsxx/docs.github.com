<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>bioruby's bioruby - Module: Bio::FlatFileIndex::Indexer - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/bioruby/commits/bioruby/master" rel="alternate" title="Recent Commits to bioruby:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("bioruby", "bioruby", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("bioruby", "bioruby", "97b9284109c9a4431b92eab208509e1df6069b4b", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/bioruby/bioruby/tree/">Source</a></li>
            <li class=""><a href="http://github.com/bioruby/bioruby/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/bioruby/bioruby/network">Network</a></li>            
            <li class=""><a href="http://github.com/bioruby/bioruby/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/bioruby/bioruby">Wiki</a></li>
            <li class=""><a href="http://github.com/bioruby/bioruby/graphs">Graphs</a></li>                    
            <li class="active"><a href="/bioruby/bioruby">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/bioruby">bioruby</a> / <b><a href="http://github.com/bioruby/bioruby/tree">bioruby</a></b>        
                <a id="namespaces_button" rel="bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Bio_FlatFileIndex_Indexer">
  <h1>Module: Bio::FlatFileIndex::Indexer</h1>
  <div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="DEFAULT_ENV-constant">DEFAULT_ENV</dt>
      <dd>'/usr/bin/env'</dd>
    
      <dt id="DEFAULT_ENV_ARGS-constant">DEFAULT_ENV_ARGS</dt>
      <dd>[ 'LC_ALL=C' ]</dd>
    
      <dt id="DEFAULT_SORT-constant">DEFAULT_SORT</dt>
      <dd>'/usr/bin/sort'</dd>
    
  </dl>
</div>

</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#addindex_bdb-class_method">addindex_bdb</span><span class='args'>(db, flag, need_update, parser, options)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#addindex_flat-class_method">addindex_flat</span><span class='args'>(db, mode, need_update, parser, options)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#chose_sort_proc-class_method">chose_sort_proc</span><span class='args'>(prog, mode = :new, env = nil, env_args = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#makeindexBDB-class_method">makeindexBDB</span><span class='args'>(name, parser, options, *files)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#makeindexFlat-class_method">makeindexFlat</span><span class='args'>(name, parser, options, *files)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#update_index-class_method">update_index</span><span class='args'>(name, parser, options, *files)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>addindex_bdb</h3>
</div><div id="addindex_bdb-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>addindex_bdb</span><span class='args'>(db, flag, need_update, parser, options)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/io/flatfile/indexer.rb', line 476</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/io/flatfile/indexer.rb#L476">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='addindex_bdb identifier id'>addindex_bdb</span><span class='lparen token'>(</span><span class='db identifier id'>db</span><span class='comma token'>,</span> <span class='flag identifier id'>flag</span><span class='comma token'>,</span> <span class='need_update identifier id'>need_update</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;reading files...\n&quot;</span>

  <span class='pn identifier id'>pn</span> <span class='assign token'>=</span> <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='primary identifier id'>primary</span>
  <span class='pn identifier id'>pn</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
  <span class='pn identifier id'>pn</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='flag identifier id'>flag</span> <span class='assign token'>=</span> <span class='flag identifier id'>flag</span>

  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span><span class='dot token'>.</span><span class='each_files identifier id'>each_files</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
    <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
    <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='flag identifier id'>flag</span> <span class='assign token'>=</span> <span class='flag identifier id'>flag</span>
    <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='open identifier id'>open</span>
    <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
  <span class='end end kw'>end</span>

  <span class='need_update identifier id'>need_update</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='fileid identifier id'>fileid</span><span class='bitor op'>|</span>
    <span class='filename identifier id'>filename</span> <span class='assign token'>=</span> <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='lbrack token'>[</span><span class='fileid identifier id'>fileid</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='filename identifier id'>filename</span>
    <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='open_flatfile identifier id'>open_flatfile</span><span class='lparen token'>(</span><span class='fileid identifier id'>fileid</span><span class='comma token'>,</span> <span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
    <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pos identifier id'>pos</span><span class='comma token'>,</span> <span class='len identifier id'>len</span><span class='bitor op'>|</span>
      <span class='p identifier id'>p</span> <span class='assign token'>=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='parse_primary identifier id'>parse_primary</span>
      <span class='comment val'>#pn.file.add_exclusive(p, [ fileid, pos, len ])</span>
      <span class='pn identifier id'>pn</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='add_overwrite identifier id'>add_overwrite</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='comma token'>,</span> <span class='lbrack token'>[</span> <span class='fileid identifier id'>fileid</span><span class='comma token'>,</span> <span class='pos identifier id'>pos</span><span class='comma token'>,</span> <span class='len identifier id'>len</span> <span class='rbrack token'>]</span><span class='rparen token'>)</span>
      <span class='comment val'>#DEBUG.print &quot;#{p} #{fileid} #{pos} #{len}\n&quot;</span>
      <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='parse_secondary identifier id'>parse_secondary</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='sn identifier id'>sn</span><span class='comma token'>,</span> <span class='sp identifier id'>sp</span><span class='bitor op'>|</span>
        <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span><span class='lbrack token'>[</span><span class='sn identifier id'>sn</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='add_nr identifier id'>add_nr</span><span class='lparen token'>(</span><span class='sp identifier id'>sp</span><span class='comma token'>,</span> <span class='p identifier id'>p</span><span class='rparen token'>)</span>
        <span class='comment val'>#DEBUG.print &quot;#{sp} #{p}\n&quot;</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='close_flatfile identifier id'>close_flatfile</span>
  <span class='end end kw'>end</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span> <span class='comment val'>#def</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>addindex_flat</h3>
</div><div id="addindex_flat-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>addindex_flat</span><span class='args'>(db, mode, need_update, parser, options)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/io/flatfile/indexer.rb', line 525</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/io/flatfile/indexer.rb#L525">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='addindex_flat identifier id'>addindex_flat</span><span class='lparen token'>(</span><span class='db identifier id'>db</span><span class='comma token'>,</span> <span class='mode identifier id'>mode</span><span class='comma token'>,</span> <span class='need_update identifier id'>need_update</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='require identifier id'>require</span> <span class='string val'>'tempfile'</span>
  <span class='prog identifier id'>prog</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>'sort_program'</span><span class='rbrack token'>]</span>
  <span class='env identifier id'>env</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>'env_program'</span><span class='rbrack token'>]</span>
  <span class='env_args identifier id'>env_args</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>'env_program_arguments'</span><span class='rbrack token'>]</span>

  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='need_update identifier id'>need_update</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>0</span>

  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;prepare temporary files...\n&quot;</span>
  <span class='tempbase identifier id'>tempbase</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;bioflat#{rand(10000)}-&quot;</span>
  <span class='pfile identifier id'>pfile</span> <span class='assign token'>=</span> <span class='Tempfile constant id'>Tempfile</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='tempbase identifier id'>tempbase</span> <span class='plus op'>+</span> <span class='string val'>'primary-'</span><span class='rparen token'>)</span>
  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='dstring node'>&quot;open temporary file #{pfile.path.inspect}\n&quot;</span>
  <span class='sfiles identifier id'>sfiles</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span><span class='dot token'>.</span><span class='names identifier id'>names</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
    <span class='sfiles identifier id'>sfiles</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span> <span class='assign token'>=</span>  <span class='Tempfile constant id'>Tempfile</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='tempbase identifier id'>tempbase</span> <span class='plus op'>+</span> <span class='string val'>'secondary-'</span><span class='rparen token'>)</span>
    <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='dstring node'>&quot;open temporary file #{sfiles[x].path.inspect}\n&quot;</span>
  <span class='end end kw'>end</span>

  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;reading files...\n&quot;</span>
  <span class='need_update identifier id'>need_update</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='fileid identifier id'>fileid</span><span class='bitor op'>|</span>
    <span class='filename identifier id'>filename</span> <span class='assign token'>=</span> <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='lbrack token'>[</span><span class='fileid identifier id'>fileid</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='filename identifier id'>filename</span>
    <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='open_flatfile identifier id'>open_flatfile</span><span class='lparen token'>(</span><span class='fileid identifier id'>fileid</span><span class='comma token'>,</span> <span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
    <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='pos identifier id'>pos</span><span class='comma token'>,</span> <span class='len identifier id'>len</span><span class='bitor op'>|</span>
      <span class='p identifier id'>p</span> <span class='assign token'>=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='parse_primary identifier id'>parse_primary</span>
      <span class='pfile identifier id'>pfile</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;#{p}\t#{fileid}\t#{pos}\t#{len}\n&quot;</span>
      <span class='comment val'>#DEBUG.print &quot;#{p} #{fileid} #{pos} #{len}\n&quot;</span>
      <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='parse_secondary identifier id'>parse_secondary</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='sn identifier id'>sn</span><span class='comma token'>,</span> <span class='sp identifier id'>sp</span><span class='bitor op'>|</span>
        <span class='sfiles identifier id'>sfiles</span><span class='lbrack token'>[</span><span class='sn identifier id'>sn</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;#{sp}\t#{p}\n&quot;</span>
        <span class='comment val'>#DEBUG.print &quot;#{sp} #{p}\n&quot;</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='close_flatfile identifier id'>close_flatfile</span>
    <span class='fileid identifier id'>fileid</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
  <span class='end end kw'>end</span>

  <span class='sort_proc identifier id'>sort_proc</span> <span class='assign token'>=</span> <span class='chose_sort_proc identifier id'>chose_sort_proc</span><span class='lparen token'>(</span><span class='prog identifier id'>prog</span><span class='comma token'>,</span> <span class='mode identifier id'>mode</span><span class='comma token'>,</span> <span class='env identifier id'>env</span><span class='comma token'>,</span> <span class='env_args identifier id'>env_args</span><span class='rparen token'>)</span>
  <span class='pfile identifier id'>pfile</span><span class='dot token'>.</span><span class='close identifier id'>close</span><span class='lparen token'>(</span><span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='dstring node'>&quot;sorting primary (#{parser.primary.name})...\n&quot;</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='primary identifier id'>primary</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='import_tsv_files identifier id'>import_tsv_files</span><span class='lparen token'>(</span><span class='true true kw'>true</span><span class='comma token'>,</span> <span class='mode identifier id'>mode</span><span class='comma token'>,</span> <span class='sort_proc identifier id'>sort_proc</span><span class='comma token'>,</span> <span class='pfile identifier id'>pfile</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='rparen token'>)</span>
  <span class='pfile identifier id'>pfile</span><span class='dot token'>.</span><span class='close identifier id'>close</span><span class='lparen token'>(</span><span class='true true kw'>true</span><span class='rparen token'>)</span>

  <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span><span class='dot token'>.</span><span class='names identifier id'>names</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
    <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='dstring node'>&quot;sorting secondary (#{x})...\n&quot;</span>
    <span class='sfiles identifier id'>sfiles</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='close identifier id'>close</span><span class='lparen token'>(</span><span class='false false kw'>false</span><span class='rparen token'>)</span>
    <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='import_tsv_files identifier id'>import_tsv_files</span><span class='lparen token'>(</span><span class='false false kw'>false</span><span class='comma token'>,</span> <span class='mode identifier id'>mode</span><span class='comma token'>,</span> <span class='sort_proc identifier id'>sort_proc</span><span class='comma token'>,</span>
                                          <span class='sfiles identifier id'>sfiles</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='rparen token'>)</span>
    <span class='sfiles identifier id'>sfiles</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='close identifier id'>close</span><span class='lparen token'>(</span><span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span> <span class='comment val'>#def</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>chose_sort_proc</h3>
</div><div id="chose_sort_proc-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>chose_sort_proc</span><span class='args'>(prog, mode = :new, env = nil, env_args = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/io/flatfile/indexer.rb', line 585</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/io/flatfile/indexer.rb#L585">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='chose_sort_proc identifier id'>chose_sort_proc</span><span class='lparen token'>(</span><span class='prog identifier id'>prog</span><span class='comma token'>,</span> <span class='mode identifier id'>mode</span> <span class='assign token'>=</span> <span class='symbol val'>:new</span><span class='comma token'>,</span>
                         <span class='env identifier id'>env</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='env_args identifier id'>env_args</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='prog identifier id'>prog</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/^builtin$/i</span><span class='comma token'>,</span> <span class='regexp val'>/^hs$/i</span><span class='comma token'>,</span> <span class='regexp val'>/^lm$/i</span>
    <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;sort: internal sort routine\n&quot;</span>
    <span class='sort_proc identifier id'>sort_proc</span> <span class='assign token'>=</span> <span class='Flat_1 constant id'>Flat_1</span><span class='colon2 op'>::</span><span class='FlatMappingFile constant id'>FlatMappingFile</span><span class='colon2 op'>::</span><span class='internal_sort_proc identifier id'>internal_sort_proc</span>
  <span class='when when kw'>when</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='string val'>''</span>
    <span class='if if kw'>if</span> <span class='FileTest constant id'>FileTest</span><span class='dot token'>.</span><span class='executable? fid id'>executable?</span><span class='lparen token'>(</span><span class='DEFAULT_SORT constant id'>DEFAULT_SORT</span><span class='rparen token'>)</span>
      <span class='return return kw'>return</span> <span class='chose_sort_proc identifier id'>chose_sort_proc</span><span class='lparen token'>(</span><span class='DEFAULT_SORT constant id'>DEFAULT_SORT</span><span class='comma token'>,</span> <span class='mode identifier id'>mode</span><span class='comma token'>,</span> <span class='env identifier id'>env</span><span class='comma token'>,</span> <span class='env_args identifier id'>env_args</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;sort: internal sort routine\n&quot;</span>
      <span class='sort_proc identifier id'>sort_proc</span> <span class='assign token'>=</span> <span class='Flat_1 constant id'>Flat_1</span><span class='colon2 op'>::</span><span class='FlatMappingFile constant id'>FlatMappingFile</span><span class='colon2 op'>::</span><span class='internal_sort_proc identifier id'>internal_sort_proc</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='env_args identifier id'>env_args</span> <span class='opasgn op'>||=</span> <span class='DEFAULT_ENV_ARGS constant id'>DEFAULT_ENV_ARGS</span>
    <span class='if if kw'>if</span> <span class='env identifier id'>env</span> <span class='eq op'>==</span> <span class='string val'>''</span> <span class='or or kw'>or</span> <span class='env identifier id'>env</span> <span class='eq op'>==</span> <span class='false false kw'>false</span> <span class='then then kw'>then</span> <span class='comment val'># inhibit to use env program</span>
      <span class='prefixes identifier id'>prefixes</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='prog identifier id'>prog</span> <span class='rbrack token'>]</span>
    <span class='elsif elsif kw'>elsif</span> <span class='env identifier id'>env</span> <span class='then then kw'>then</span> <span class='comment val'># uses given env program</span>
      <span class='prefixes identifier id'>prefixes</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='env identifier id'>env</span> <span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='env_args identifier id'>env_args</span> <span class='plus op'>+</span> <span class='lbrack token'>[</span> <span class='prog identifier id'>prog</span> <span class='rbrack token'>]</span>
    <span class='else else kw'>else</span> <span class='comment val'># env == nil; uses default env program if possible</span>
      <span class='if if kw'>if</span> <span class='FileTest constant id'>FileTest</span><span class='dot token'>.</span><span class='executable? fid id'>executable?</span><span class='lparen token'>(</span><span class='DEFAULT_ENV constant id'>DEFAULT_ENV</span><span class='rparen token'>)</span>
        <span class='prefixes identifier id'>prefixes</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='DEFAULT_ENV constant id'>DEFAULT_ENV</span> <span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='env_args identifier id'>env_args</span> <span class='plus op'>+</span> <span class='lbrack token'>[</span> <span class='prog identifier id'>prog</span> <span class='rbrack token'>]</span>
      <span class='else else kw'>else</span>
        <span class='prefixes identifier id'>prefixes</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='prog identifier id'>prog</span> <span class='rbrack token'>]</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
    <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='dstring node'>&quot;sort: #{prefixes.join(' ')}\n&quot;</span>
    <span class='if if kw'>if</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='symbol val'>:new</span> <span class='then then kw'>then</span>
      <span class='sort_proc identifier id'>sort_proc</span> <span class='assign token'>=</span> <span class='Flat_1 constant id'>Flat_1</span><span class='colon2 op'>::</span><span class='FlatMappingFile constant id'>FlatMappingFile</span><span class='colon2 op'>::</span><span class='external_sort_proc identifier id'>external_sort_proc</span><span class='lparen token'>(</span><span class='prefixes identifier id'>prefixes</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='sort_proc identifier id'>sort_proc</span> <span class='assign token'>=</span> <span class='Flat_1 constant id'>Flat_1</span><span class='colon2 op'>::</span><span class='FlatMappingFile constant id'>FlatMappingFile</span><span class='colon2 op'>::</span><span class='external_merge_sort_proc identifier id'>external_merge_sort_proc</span><span class='lparen token'>(</span><span class='prefixes identifier id'>prefixes</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='sort_proc identifier id'>sort_proc</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>makeindexBDB</h3>
</div><div id="makeindexBDB-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>makeindexBDB</span><span class='args'>(name, parser, options, *files)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/io/flatfile/indexer.rb', line 451</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/io/flatfile/indexer.rb#L451">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='makeindexBDB identifier id'>makeindexBDB</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='files identifier id'>files</span><span class='rparen token'>)</span>
  <span class='comment val'># options are not used in this method</span>
  <span class='unless unless kw'>unless</span> <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='BDB constant id'>BDB</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='RuntimeError constant id'>RuntimeError</span><span class='comma token'>,</span> <span class='string val'>&quot;Berkeley DB support not found&quot;</span>
  <span class='end end kw'>end</span>
  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;makeing BDB DataBank...\n&quot;</span>
  <span class='db identifier id'>db</span> <span class='assign token'>=</span> <span class='DataBank constant id'>DataBank</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='MAGIC_BDB constant id'>MAGIC_BDB</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='format identifier id'>format</span> <span class='assign token'>=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='format identifier id'>format</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='files identifier id'>files</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='recalc identifier id'>recalc</span>

  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='primary identifier id'>primary</span> <span class='assign token'>=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='primary identifier id'>primary</span><span class='dot token'>.</span><span class='name identifier id'>name</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span> <span class='assign token'>=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span><span class='dot token'>.</span><span class='names identifier id'>names</span>

  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;writing config.dat, config, fileids ...\n&quot;</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='string val'>'wb'</span><span class='comma token'>,</span> <span class='BDBdefault constant id'>BDBdefault</span><span class='colon2 op'>::</span><span class='flag_write identifier id'>flag_write</span><span class='rparen token'>)</span>

  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;reading files...\n&quot;</span>

  <span class='addindex_bdb identifier id'>addindex_bdb</span><span class='lparen token'>(</span><span class='db identifier id'>db</span><span class='comma token'>,</span> <span class='BDBdefault constant id'>BDBdefault</span><span class='colon2 op'>::</span><span class='flag_write identifier id'>flag_write</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='lparen token'>(</span><span class='files identifier id'>files</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span>
               <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span> <span class='comment val'>#def</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>makeindexFlat</h3>
</div><div id="makeindexFlat-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>makeindexFlat</span><span class='args'>(name, parser, options, *files)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/io/flatfile/indexer.rb', line 508</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/io/flatfile/indexer.rb#L508">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='makeindexFlat identifier id'>makeindexFlat</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='files identifier id'>files</span><span class='rparen token'>)</span>
  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;makeing flat/1 DataBank using temporary files...\n&quot;</span>

  <span class='db identifier id'>db</span> <span class='assign token'>=</span> <span class='DataBank constant id'>DataBank</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='format identifier id'>format</span> <span class='assign token'>=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='format identifier id'>format</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='files identifier id'>files</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='primary identifier id'>primary</span> <span class='assign token'>=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='primary identifier id'>primary</span><span class='dot token'>.</span><span class='name identifier id'>name</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span> <span class='assign token'>=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span><span class='dot token'>.</span><span class='names identifier id'>names</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='recalc identifier id'>recalc</span>
  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;writing DabaBank...\n&quot;</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='string val'>'wb'</span><span class='rparen token'>)</span>

  <span class='addindex_flat identifier id'>addindex_flat</span><span class='lparen token'>(</span><span class='db identifier id'>db</span><span class='comma token'>,</span> <span class='symbol val'>:new</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='lparen token'>(</span><span class='files identifier id'>files</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span> <span class='comment val'>#def</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_index</h3>
</div><div id="update_index-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_index</span><span class='args'>(name, parser, options, *files)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/io/flatfile/indexer.rb', line 621</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/io/flatfile/indexer.rb#L621">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='update_index identifier id'>update_index</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='files identifier id'>files</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span> <span class='assign token'>=</span> <span class='DataBank constant id'>DataBank</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='parser identifier id'>parser</span> <span class='then then kw'>then</span>
    <span class='raise identifier id'>raise</span> <span class='string val'>'file format mismatch'</span> <span class='if if_mod kw'>if</span> <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='format identifier id'>format</span> <span class='neq op'>!=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='format identifier id'>format</span>
  <span class='else else kw'>else</span>

    <span class='begin begin kw'>begin</span>
      <span class='dbclass_orig identifier id'>dbclass_orig</span> <span class='assign token'>=</span>
        <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='FlatFile constant id'>FlatFile</span><span class='dot token'>.</span><span class='autodetect_file identifier id'>autodetect_file</span><span class='lparen token'>(</span><span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
    <span class='rescue rescue kw'>rescue</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='Errno constant id'>Errno</span><span class='colon2 op'>::</span><span class='ENOENT constant id'>ENOENT</span>
    <span class='end end kw'>end</span>
    <span class='begin begin kw'>begin</span>
      <span class='dbclass_new identifier id'>dbclass_new</span> <span class='assign token'>=</span>
        <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='FlatFile constant id'>FlatFile</span><span class='dot token'>.</span><span class='autodetect_file identifier id'>autodetect_file</span><span class='lparen token'>(</span><span class='files identifier id'>files</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='rescue rescue kw'>rescue</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='Errno constant id'>Errno</span><span class='colon2 op'>::</span><span class='ENOENT constant id'>ENOENT</span>
    <span class='end end kw'>end</span>

    <span class='case case kw'>case</span> <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='format identifier id'>format</span>
    <span class='when when kw'>when</span> <span class='string val'>'swiss'</span><span class='comma token'>,</span> <span class='string val'>'embl'</span>
      <span class='parser identifier id'>parser</span> <span class='assign token'>=</span> <span class='Parser constant id'>Parser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='db identifier id'>db</span><span class='dot token'>.</span><span class='format identifier id'>format</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='dbclass_new identifier id'>dbclass_new</span> <span class='and and kw'>and</span> <span class='dbclass_new identifier id'>dbclass_new</span> <span class='neq op'>!=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='dbclass identifier id'>dbclass</span>
        <span class='raise identifier id'>raise</span> <span class='string val'>'file format mismatch'</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='string val'>'genbank'</span>
      <span class='dbclass identifier id'>dbclass</span> <span class='assign token'>=</span> <span class='dbclass_orig identifier id'>dbclass_orig</span> <span class='or or kw'>or</span> <span class='dbclass_new identifier id'>dbclass_new</span>
      <span class='if if kw'>if</span> <span class='dbclass identifier id'>dbclass</span> <span class='eq op'>==</span> <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='GenBank constant id'>GenBank</span> <span class='or or kw'>or</span> <span class='dbclass identifier id'>dbclass</span> <span class='eq op'>==</span> <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='GenPept constant id'>GenPept</span>
        <span class='parser identifier id'>parser</span> <span class='assign token'>=</span> <span class='Parser constant id'>Parser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dbclass_orig identifier id'>dbclass_orig</span><span class='rparen token'>)</span>
      <span class='elsif elsif kw'>elsif</span> <span class='notop op'>!</span><span class='dbclass identifier id'>dbclass</span> <span class='then then kw'>then</span>
        <span class='raise identifier id'>raise</span> <span class='string val'>'cannnot determine format. please specify manually.'</span>
      <span class='else else kw'>else</span>
        <span class='raise identifier id'>raise</span> <span class='string val'>'file format mismatch'</span>
      <span class='end end kw'>end</span>
      <span class='if if kw'>if</span> <span class='dbclass_new identifier id'>dbclass_new</span> <span class='and and kw'>and</span> <span class='dbclass_new identifier id'>dbclass_new</span> <span class='neq op'>!=</span> <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='dbclass identifier id'>dbclass</span>
        <span class='raise identifier id'>raise</span> <span class='string val'>'file format mismatch'</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='raise identifier id'>raise</span> <span class='string val'>'unsupported format'</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='set_primary_namespace identifier id'>set_primary_namespace</span><span class='lparen token'>(</span><span class='db identifier id'>db</span><span class='dot token'>.</span><span class='primary identifier id'>primary</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='parser identifier id'>parser</span><span class='dot token'>.</span><span class='add_secondary_namespaces identifier id'>add_secondary_namespaces</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='db identifier id'>db</span><span class='dot token'>.</span><span class='secondary identifier id'>secondary</span><span class='dot token'>.</span><span class='names identifier id'>names</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>'renew'</span><span class='rbrack token'>]</span> <span class='then then kw'>then</span>
    <span class='newfiles identifier id'>newfiles</span> <span class='assign token'>=</span> <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='filenames identifier id'>filenames</span><span class='dot token'>.</span><span class='find_all identifier id'>find_all</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
      <span class='FileTest constant id'>FileTest</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='newfiles identifier id'>newfiles</span><span class='dot token'>.</span><span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='files identifier id'>files</span><span class='rparen token'>)</span>
    <span class='newfiles2 identifier id'>newfiles2</span> <span class='assign token'>=</span> <span class='newfiles identifier id'>newfiles</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span>
    <span class='newfiles2 identifier id'>newfiles2</span><span class='dot token'>.</span><span class='uniq! fid id'>uniq!</span>
    <span class='newfiles3 identifier id'>newfiles3</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='newfiles identifier id'>newfiles</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
      <span class='newfiles3 identifier id'>newfiles3</span> <span class='lshft op'>&lt;&lt;</span> <span class='x identifier id'>x</span> <span class='if if_mod kw'>if</span> <span class='newfiles2 identifier id'>newfiles2</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='index_type identifier id'>index_type</span>
    <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
    <span class='case case kw'>case</span> <span class='t identifier id'>t</span>
    <span class='when when kw'>when</span> <span class='MAGIC_BDB constant id'>MAGIC_BDB</span>
      <span class='Indexer constant id'>Indexer</span><span class='colon2 op'>::</span><span class='makeindexBDB identifier id'>makeindexBDB</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='newfiles3 identifier id'>newfiles3</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='MAGIC_FLAT constant id'>MAGIC_FLAT</span>
      <span class='Indexer constant id'>Indexer</span><span class='colon2 op'>::</span><span class='makeindexFlat identifier id'>makeindexFlat</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='newfiles3 identifier id'>newfiles3</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='raise identifier id'>raise</span> <span class='string val'>'Unsupported index type'</span>
    <span class='end end kw'>end</span>
    <span class='return return kw'>return</span> <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>

  <span class='need_update identifier id'>need_update</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='newfiles identifier id'>newfiles</span> <span class='assign token'>=</span> <span class='files identifier id'>files</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='cache_all identifier id'>cache_all</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='comma token'>,</span> <span class='i identifier id'>i</span><span class='bitor op'>|</span>
    <span class='need_update identifier id'>need_update</span> <span class='lshft op'>&lt;&lt;</span> <span class='i identifier id'>i</span> <span class='unless unless_mod kw'>unless</span> <span class='f identifier id'>f</span><span class='dot token'>.</span><span class='check identifier id'>check</span>
    <span class='newfiles identifier id'>newfiles</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='f identifier id'>f</span><span class='dot token'>.</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='b identifier id'>b</span> <span class='assign token'>=</span> <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
  <span class='begin begin kw'>begin</span>
    <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='recalc identifier id'>recalc</span>
  <span class='rescue rescue kw'>rescue</span> <span class='Errno constant id'>Errno</span><span class='colon2 op'>::</span><span class='ENOENT constant id'>ENOENT</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='evar identifier id'>evar</span>
    <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='dstring node'>&quot;Error: #{evar}\n&quot;</span>
    <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;assumed --renew option\n&quot;</span>
    <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
    <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='dup identifier id'>dup</span>
    <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='string val'>'renew'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
    <span class='update_index identifier id'>update_index</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='files identifier id'>files</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
  <span class='comment val'># add new files</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='newfiles identifier id'>newfiles</span><span class='rparen token'>)</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='fileids identifier id'>fileids</span><span class='dot token'>.</span><span class='recalc identifier id'>recalc</span>

  <span class='need_update identifier id'>need_update</span><span class='dot token'>.</span><span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='b identifier id'>b</span><span class='dot3 op'>...</span><span class='lparen token'>(</span><span class='b identifier id'>b</span> <span class='plus op'>+</span> <span class='newfiles identifier id'>newfiles</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='rparen token'>)</span>

  <span class='DEBUG constant id'>DEBUG</span><span class='dot token'>.</span><span class='print identifier id'>print</span> <span class='string val'>&quot;writing DabaBank...\n&quot;</span>
  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='string val'>'wb'</span><span class='comma token'>,</span> <span class='BDBdefault constant id'>BDBdefault</span><span class='colon2 op'>::</span><span class='flag_append identifier id'>flag_append</span><span class='rparen token'>)</span>

  <span class='case case kw'>case</span> <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='index_type identifier id'>index_type</span>
  <span class='when when kw'>when</span> <span class='MAGIC_BDB constant id'>MAGIC_BDB</span>
    <span class='addindex_bdb identifier id'>addindex_bdb</span><span class='lparen token'>(</span><span class='db identifier id'>db</span><span class='comma token'>,</span> <span class='BDBdefault constant id'>BDBdefault</span><span class='colon2 op'>::</span><span class='flag_append identifier id'>flag_append</span><span class='comma token'>,</span>
                 <span class='need_update identifier id'>need_update</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='MAGIC_FLAT constant id'>MAGIC_FLAT</span>
    <span class='addindex_flat identifier id'>addindex_flat</span><span class='lparen token'>(</span><span class='db identifier id'>db</span><span class='comma token'>,</span> <span class='symbol val'>:add</span><span class='comma token'>,</span> <span class='need_update identifier id'>need_update</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='string val'>'Unsupported index type'</span>
  <span class='end end kw'>end</span>

  <span class='db identifier id'>db</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span> <span class='comment val'>#def</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>