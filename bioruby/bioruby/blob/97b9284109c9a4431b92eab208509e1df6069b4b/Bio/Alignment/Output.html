<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>bioruby's bioruby - Module: Bio::Alignment::Output - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/bioruby/commits/bioruby/master" rel="alternate" title="Recent Commits to bioruby:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("bioruby", "bioruby", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("bioruby", "bioruby", "97b9284109c9a4431b92eab208509e1df6069b4b", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/bioruby/bioruby/tree/">Source</a></li>
            <li class=""><a href="http://github.com/bioruby/bioruby/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/bioruby/bioruby/network">Network</a></li>            
            <li class=""><a href="http://github.com/bioruby/bioruby/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/bioruby/bioruby">Wiki</a></li>
            <li class=""><a href="http://github.com/bioruby/bioruby/graphs">Graphs</a></li>                    
            <li class="active"><a href="/bioruby/bioruby">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/bioruby">bioruby</a> / <b><a href="http://github.com/bioruby/bioruby/tree">bioruby</a></b>        
                <a id="namespaces_button" rel="bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Bio_Alignment_Output">
  <h1>Module: Bio::Alignment::Output</h1>
  <div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#__output_phylip_common-instance_method">#__output_phylip_common</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
common routine for interleaved/non-interleaved phylip format.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output-instance_method">#output</span><span class='args'>(format, *arg)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output_clustal-instance_method">#output_clustal</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates ClustalW-formatted text
</p>
<table>
<tr><td valign="top">seqs:</td><td>sequences (must be an alignment object)

</td></tr>
<tr><td valign="top">names:</td><td>names of the sequences

</td></tr>
<tr><td valign="top">options:</td><td>options.

</td></tr>
</table>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output_fasta-instance_method">#output_fasta</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates fasta format text and returns a string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output_molphy-instance_method">#output_molphy</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates Molphy alignment format text as a string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output_msf-instance_method">#output_msf</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates msf formatted text as a string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output_phylip-instance_method">#output_phylip</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
generates phylip interleaved alignment format as a string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output_phylipnon-instance_method">#output_phylipnon</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
generates Phylip3.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_clustal-instance_method">#to_clustal</span><span class='args'>(*arg)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
to_clustal is deprecated.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>__output_phylip_common</h3>
</div><div id="__output_phylip_common-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>__output_phylip_common</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
common routine for interleaved/non-interleaved phylip format
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/alignment.rb', line 1099</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/alignment.rb#L1099">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1099
1100
1101
1102
1103
1104
1105
1106
1107
1108
1109
1110
1111
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1124
1125
1126
1127
1128
1129
1130
1131
1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='__output_phylip_common identifier id'>__output_phylip_common</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='len identifier id'>len</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='alignment_length identifier id'>alignment_length</span>
  <span class='aln identifier id'>aln</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='dstring node'>&quot; #{self.number_of_sequences} #{len}\n&quot;</span> <span class='rbrack token'>]</span>
  <span class='sn identifier id'>sn</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='sequence_names identifier id'>sequence_names</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/[\r\n\x00]/</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:replace_space</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/\s/</span><span class='comma token'>,</span> <span class='string val'>'_'</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:escape</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:escape</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/[\:\;\,\(\)]/</span><span class='comma token'>,</span> <span class='string val'>'_'</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:split</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:split</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/\s/</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:avoid_same_name</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:avoid_same_name</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span> <span class='assign token'>=</span> <span class='__clustal_avoid_same_name identifier id'>__clustal_avoid_same_name</span><span class='lparen token'>(</span><span class='sn identifier id'>sn</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='namewidth identifier id'>namewidth</span> <span class='assign token'>=</span> <span class='integer val'>10</span>
  <span class='seqwidth identifier id'>seqwidth</span>  <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:width</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='integer val'>60</span><span class='rparen token'>)</span>
  <span class='seqwidth identifier id'>seqwidth</span> <span class='assign token'>=</span> <span class='seqwidth identifier id'>seqwidth</span><span class='dot token'>.</span><span class='div identifier id'>div</span><span class='lparen token'>(</span><span class='integer val'>10</span><span class='rparen token'>)</span> <span class='mult op'>*</span> <span class='integer val'>10</span>
  <span class='seqregexp identifier id'>seqregexp</span> <span class='assign token'>=</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;(.{1,#{seqwidth.div(10) * 11}})&quot;</span><span class='rparen token'>)</span>
  <span class='gchar identifier id'>gchar</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:gap_char</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='string val'>'-'</span><span class='rparen token'>)</span>

  <span class='aseqs identifier id'>aseqs</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='number_of_sequences identifier id'>number_of_sequences</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_seq identifier id'>each_seq</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
    <span class='aseqs identifier id'>aseqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='gap_regexp identifier id'>gap_regexp</span><span class='comma token'>,</span> <span class='gchar identifier id'>gchar</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='case case kw'>case</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:case</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/lower/i</span>
    <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='downcase! fid id'>downcase!</span> <span class='rbrace token'>}</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/upper/i</span>
    <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='upcase! fid id'>upcase!</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  
  <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
    <span class='snx identifier id'>snx</span> <span class='assign token'>=</span> <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span>
    <span class='head identifier id'>head</span> <span class='assign token'>=</span> <span class='sprintf identifier id'>sprintf</span><span class='lparen token'>(</span><span class='string val'>&quot;%*s&quot;</span><span class='comma token'>,</span> <span class='minus op'>-</span><span class='namewidth identifier id'>namewidth</span><span class='comma token'>,</span> <span class='snx identifier id'>snx</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='namewidth identifier id'>namewidth</span><span class='rbrack token'>]</span>
    <span class='head2 identifier id'>head2</span> <span class='assign token'>=</span> <span class='string val'>' '</span> <span class='mult op'>*</span> <span class='namewidth identifier id'>namewidth</span>
    <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='gchar identifier id'>gchar</span> <span class='mult op'>*</span> <span class='lparen token'>(</span><span class='len identifier id'>len</span> <span class='minus op'>-</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/(.{1,10})/n</span><span class='comma token'>,</span> <span class='string val'>&quot; \\1&quot;</span><span class='rparen token'>)</span>
    <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='seqregexp identifier id'>seqregexp</span><span class='comma token'>,</span> <span class='string val'>&quot;\\1\n&quot;</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/^/</span><span class='rparen token'>)</span>
    <span class='head identifier id'>head</span> <span class='opasgn op'>+=</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span>
    <span class='ret identifier id'>ret</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='head2 identifier id'>head2</span> <span class='plus op'>+</span> <span class='x identifier id'>x</span> <span class='rbrace token'>}</span>
    <span class='ret identifier id'>ret</span><span class='dot token'>.</span><span class='unshift identifier id'>unshift</span><span class='lparen token'>(</span><span class='head identifier id'>head</span><span class='rparen token'>)</span>
    <span class='ret identifier id'>ret</span>
  <span class='end end kw'>end</span>
  <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='len identifier id'>len</span> <span class='plus op'>+</span> <span class='seqwidth identifier id'>seqwidth</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='div identifier id'>div</span><span class='lparen token'>(</span><span class='seqwidth identifier id'>seqwidth</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span> <span class='aln identifier id'>aln</span><span class='comma token'>,</span> <span class='aseqs identifier id'>aseqs</span><span class='comma token'>,</span> <span class='lines identifier id'>lines</span> <span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output</h3>
</div><div id="output-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output</span><span class='args'>(format, *arg)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/alignment.rb', line 873</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/alignment.rb#L873">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output identifier id'>output</span><span class='lparen token'>(</span><span class='format identifier id'>format</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='format identifier id'>format</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:clustal</span>
    <span class='output_clustal identifier id'>output_clustal</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:fasta</span>
    <span class='output_fasta identifier id'>output_fasta</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:phylip</span>
    <span class='output_phylip identifier id'>output_phylip</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:phylipnon</span>
    <span class='output_phylipnon identifier id'>output_phylipnon</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:msf</span>
    <span class='output_msf identifier id'>output_msf</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:molphy</span>
    <span class='output_molphy identifier id'>output_molphy</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='dstring node'>&quot;Unknown format: #{format.inspect}&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output_clustal</h3>
</div><div id="output_clustal-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output_clustal</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates ClustalW-formatted text
</p>
<table>
<tr><td valign="top">seqs:</td><td>sequences (must be an alignment object)

</td></tr>
<tr><td valign="top">names:</td><td>names of the sequences

</td></tr>
<tr><td valign="top">options:</td><td>options

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/alignment.rb', line 1045</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/alignment.rb#L1045">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1045
1046
1047</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output_clustal identifier id'>output_clustal</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='__clustal_formatter identifier id'>__clustal_formatter</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='sequence_names identifier id'>sequence_names</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output_fasta</h3>
</div><div id="output_fasta-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output_fasta</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates fasta format text and returns a string.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/alignment.rb', line 1059</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/alignment.rb#L1059">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070
1071
1072
1073
1074
1075
1076
1077
1078
1079</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output_fasta identifier id'>output_fasta</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='comment val'>#(original)</span>
  <span class='width identifier id'>width</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:width</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='integer val'>70</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:avoid_same_name</span><span class='rbrack token'>]</span> <span class='then then kw'>then</span>
    <span class='na identifier id'>na</span> <span class='assign token'>=</span> <span class='__clustal_avoid_same_name identifier id'>__clustal_avoid_same_name</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='sequence_names identifier id'>sequence_names</span><span class='comma token'>,</span> <span class='integer val'>30</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='na identifier id'>na</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='sequence_names identifier id'>sequence_names</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='bitor op'>|</span>
      <span class='k identifier id'>k</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/[\r\n\x00]/</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='width identifier id'>width</span> <span class='and and kw'>and</span> <span class='width identifier id'>width</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span> <span class='then then kw'>then</span>
    <span class='w_reg identifier id'>w_reg</span> <span class='assign token'>=</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;.{1,#{width}}&quot;</span><span class='rparen token'>)</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
      <span class='dstring node'>&quot;&gt;#{na.shift}\n&quot;</span> <span class='plus op'>+</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='w_reg identifier id'>w_reg</span><span class='comma token'>,</span> <span class='string val'>&quot;\\0\n&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
      <span class='dstring node'>&quot;&gt;#{na.shift}\n&quot;</span> <span class='plus op'>+</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span>
    <span class='end end kw'>end</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output_molphy</h3>
</div><div id="output_molphy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output_molphy</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates Molphy alignment format text as a string
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/alignment.rb', line 1151</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/alignment.rb#L1151">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1151
1152
1153
1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173
1174
1175
1176
1177
1178
1179
1180
1181
1182
1183
1184
1185
1186
1187
1188
1189
1190</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output_molphy identifier id'>output_molphy</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='len identifier id'>len</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='alignment_length identifier id'>alignment_length</span>
  <span class='header identifier id'>header</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{self.number_of_sequences} #{len}\n&quot;</span>
  <span class='sn identifier id'>sn</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='sequence_names identifier id'>sequence_names</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/[\r\n\x00]/</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='if if kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:replace_space</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/\s/</span><span class='comma token'>,</span> <span class='string val'>'_'</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:escape</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:escape</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/[\:\;\,\(\)]/</span><span class='comma token'>,</span> <span class='string val'>'_'</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:split</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:split</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/\s/</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:avoid_same_name</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:avoid_same_name</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span> <span class='assign token'>=</span> <span class='__clustal_avoid_same_name identifier id'>__clustal_avoid_same_name</span><span class='lparen token'>(</span><span class='sn identifier id'>sn</span><span class='comma token'>,</span> <span class='integer val'>30</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='seqwidth identifier id'>seqwidth</span>  <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:width</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='integer val'>60</span><span class='rparen token'>)</span>
  <span class='seqregexp identifier id'>seqregexp</span> <span class='assign token'>=</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;(.{1,#{seqwidth}})&quot;</span><span class='rparen token'>)</span>
  <span class='gchar identifier id'>gchar</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:gap_char</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='string val'>'-'</span><span class='rparen token'>)</span>

  <span class='aseqs identifier id'>aseqs</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='len identifier id'>len</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_seq identifier id'>each_seq</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
    <span class='aseqs identifier id'>aseqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='gap_regexp identifier id'>gap_regexp</span><span class='comma token'>,</span> <span class='gchar identifier id'>gchar</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='case case kw'>case</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:case</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/lower/i</span>
    <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='downcase! fid id'>downcase!</span> <span class='rbrace token'>}</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/upper/i</span>
    <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='upcase! fid id'>upcase!</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  
  <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
    <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='gchar identifier id'>gchar</span> <span class='mult op'>*</span> <span class='lparen token'>(</span><span class='len identifier id'>len</span> <span class='minus op'>-</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='seqregexp identifier id'>seqregexp</span><span class='comma token'>,</span> <span class='string val'>&quot;\\1\n&quot;</span><span class='rparen token'>)</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span> <span class='plus op'>+</span> <span class='s identifier id'>s</span>
  <span class='end end kw'>end</span>
  <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='unshift identifier id'>unshift</span><span class='lparen token'>(</span><span class='header identifier id'>header</span><span class='rparen token'>)</span>
  <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output_msf</h3>
</div><div id="output_msf-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output_msf</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates msf formatted text as a string
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/alignment.rb', line 1193</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/alignment.rb#L1193">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1193
1194
1195
1196
1197
1198
1199
1200
1201
1202
1203
1204
1205
1206
1207
1208
1209
1210
1211
1212
1213
1214
1215
1216
1217
1218
1219
1220
1221
1222
1223
1224
1225
1226
1227
1228
1229
1230
1231
1232
1233
1234
1235
1236
1237
1238
1239
1240
1241
1242
1243
1244
1245
1246
1247
1248
1249
1250
1251
1252
1253
1254
1255
1256
1257
1258
1259
1260
1261
1262
1263
1264
1265
1266
1267
1268
1269
1270
1271
1272
1273
1274
1275
1276
1277
1278
1279
1280
1281
1282
1283
1284
1285
1286
1287
1288
1289
1290
1291
1292
1293
1294
1295
1296
1297
1298
1299
1300
1301
1302
1303
1304
1305
1306
1307</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output_msf identifier id'>output_msf</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='len identifier id'>len</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='seq_length identifier id'>seq_length</span>

  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:avoid_same_name</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:avoid_same_name</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span> <span class='assign token'>=</span> <span class='__clustal_avoid_same_name identifier id'>__clustal_avoid_same_name</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='sequence_names identifier id'>sequence_names</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='sn identifier id'>sn</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='sequence_names identifier id'>sequence_names</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
      <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/[\r\n\x00]/</span><span class='comma token'>,</span> <span class='string val'>' '</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:replace_space</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:replace_space</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/\s/</span><span class='comma token'>,</span> <span class='string val'>'_'</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:escape</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:escape</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/[\:\;\,\(\)]/</span><span class='comma token'>,</span> <span class='string val'>'_'</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='if if kw'>if</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='symbol val'>:split</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:split</span><span class='rbrack token'>]</span>
    <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/\s/</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>

  <span class='seqwidth identifier id'>seqwidth</span> <span class='assign token'>=</span> <span class='integer val'>50</span>
  <span class='namewidth identifier id'>namewidth</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='integer val'>31</span><span class='comma token'>,</span> <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='max identifier id'>max</span> <span class='rbrack token'>]</span><span class='dot token'>.</span><span class='min identifier id'>min</span>
  <span class='sep identifier id'>sep</span> <span class='assign token'>=</span> <span class='string val'>' '</span> <span class='mult op'>*</span> <span class='integer val'>2</span>

  <span class='seqregexp identifier id'>seqregexp</span> <span class='assign token'>=</span> <span class='Regexp constant id'>Regexp</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;(.{1,#{seqwidth}})&quot;</span><span class='rparen token'>)</span>
  <span class='gchar identifier id'>gchar</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:gap_char</span><span class='rbrack token'>]</span>  <span class='or or kw'>or</span> <span class='string val'>'.'</span><span class='rparen token'>)</span>
  <span class='pchar identifier id'>pchar</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:padding_char</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='string val'>'~'</span><span class='rparen token'>)</span>

  <span class='aseqs identifier id'>aseqs</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='number_of_sequences identifier id'>number_of_sequences</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_seq identifier id'>each_seq</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
    <span class='aseqs identifier id'>aseqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='gap_regexp identifier id'>gap_regexp</span><span class='comma token'>,</span> <span class='gchar identifier id'>gchar</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
    <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/\A#{Regexp.escape(gchar)}+/</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='pchar identifier id'>pchar</span> <span class='mult op'>*</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='rbrace token'>}</span>
    <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='sub! fid id'>sub!</span><span class='lparen token'>(</span><span class='dregexp node'>/#{Regexp.escape(gchar)}+\z/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>
    <span class='s identifier id'>s</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='pchar identifier id'>pchar</span> <span class='mult op'>*</span> <span class='lparen token'>(</span><span class='len identifier id'>len</span> <span class='minus op'>-</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='case case kw'>case</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:case</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/lower/i</span>
    <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='downcase! fid id'>downcase!</span> <span class='rbrace token'>}</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/upper/i</span>
    <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='upcase! fid id'>upcase!</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span> <span class='comment val'>#default upcase</span>
    <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='upcase! fid id'>upcase!</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>

  <span class='case case kw'>case</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:type</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/protein/i</span><span class='comma token'>,</span> <span class='regexp val'>/aa/i</span>
    <span class='amino identifier id'>amino</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='when when kw'>when</span> <span class='regexp val'>/na/i</span>
    <span class='amino identifier id'>amino</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='else else kw'>else</span>
    <span class='if if kw'>if</span> <span class='seqclass identifier id'>seqclass</span> <span class='eq op'>==</span> <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='Sequence constant id'>Sequence</span><span class='colon2 op'>::</span><span class='AA constant id'>AA</span> <span class='then then kw'>then</span>
      <span class='amino identifier id'>amino</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
    <span class='elsif elsif kw'>elsif</span> <span class='seqclass identifier id'>seqclass</span> <span class='eq op'>==</span> <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='Sequence constant id'>Sequence</span><span class='colon2 op'>::</span><span class='NA constant id'>NA</span> <span class='then then kw'>then</span>
      <span class='amino identifier id'>amino</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
    <span class='else else kw'>else</span>
      <span class='comment val'># if we can't determine, we asuume as protein.</span>
      <span class='amino identifier id'>amino</span> <span class='assign token'>=</span> <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
      <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='amino identifier id'>amino</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span> <span class='if if_mod kw'>if</span> <span class='regexp val'>/\A[acgt]\z/i</span> <span class='match op'>=~</span> <span class='x identifier id'>x</span> <span class='rbrace token'>}</span>
      <span class='amino identifier id'>amino</span> <span class='assign token'>=</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='amino identifier id'>amino</span> <span class='leq op'>&lt;=</span> <span class='integer val'>0</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='seq_type identifier id'>seq_type</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='amino identifier id'>amino</span> <span class='integer val'>? </span><span class='string val'>'P'</span> <span class='colon op'>:</span> <span class='string val'>'N'</span><span class='rparen token'>)</span>

  <span class='fn identifier id'>fn</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:entry_id</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='__id__ identifier id'>__id__</span><span class='dot token'>.</span><span class='abs identifier id'>abs</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='string val'>'.msf'</span><span class='rparen token'>)</span>
  <span class='dt identifier id'>dt</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:time</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%B %d, %Y %H:%M'</span><span class='rparen token'>)</span>

  <span class='sums identifier id'>sums</span> <span class='assign token'>=</span> <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span> <span class='GCG constant id'>GCG</span><span class='colon2 op'>::</span><span class='Seq constant id'>Seq</span><span class='dot token'>.</span><span class='calc_checksum identifier id'>calc_checksum</span><span class='lparen token'>(</span><span class='s identifier id'>s</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='comment val'>#sums = aseqs.collect { |s| 0 }</span>
  <span class='sum identifier id'>sum</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='semicolon token'>;</span> <span class='sums identifier id'>sums</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='sum identifier id'>sum</span> <span class='opasgn op'>+=</span> <span class='x identifier id'>x</span> <span class='rbrace token'>}</span><span class='semicolon token'>;</span> <span class='sum identifier id'>sum</span> <span class='opasgn op'>%=</span> <span class='integer val'>10000</span>
  <span class='msf identifier id'>msf</span> <span class='assign token'>=</span>
    <span class='lbrack token'>[</span>
     <span class='dstring node'>&quot;#{seq_type == 'N' ? 'N' : 'A' }A_MULTIPLE_ALIGNMENT 1.0\n&quot;</span><span class='comma token'>,</span>
     <span class='string val'>&quot;\n&quot;</span><span class='comma token'>,</span>
     <span class='string val'>&quot;\n&quot;</span><span class='comma token'>,</span>
     <span class='dstring node'>&quot; #{fn}  MSF: #{len}  Type: #{seq_type}  #{dt}  Check: #{sum} ..\n&quot;</span><span class='comma token'>,</span>
     <span class='string val'>&quot;\n&quot;</span>
    <span class='rbrack token'>]</span>

  <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='snx identifier id'>snx</span><span class='bitor op'>|</span>
    <span class='msf identifier id'>msf</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>' Name: '</span> <span class='plus op'>+</span>
      <span class='sprintf identifier id'>sprintf</span><span class='lparen token'>(</span><span class='string val'>'%*s'</span><span class='comma token'>,</span> <span class='minus op'>-</span><span class='namewidth identifier id'>namewidth</span><span class='comma token'>,</span> <span class='snx identifier id'>snx</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='namewidth identifier id'>namewidth</span><span class='rbrack token'>]</span> <span class='plus op'>+</span>
      <span class='dstring node'>&quot;  Len: #{len}  Check: #{sums.shift}  Weight: 1.00\n&quot;</span>
  <span class='end end kw'>end</span>
  <span class='msf identifier id'>msf</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;\n//\n&quot;</span>

  <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
    <span class='snx identifier id'>snx</span> <span class='assign token'>=</span> <span class='sn identifier id'>sn</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span>
    <span class='head identifier id'>head</span> <span class='assign token'>=</span> <span class='sprintf identifier id'>sprintf</span><span class='lparen token'>(</span><span class='string val'>&quot;%*s&quot;</span><span class='comma token'>,</span> <span class='namewidth identifier id'>namewidth</span><span class='comma token'>,</span> <span class='snx identifier id'>snx</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='namewidth identifier id'>namewidth</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> <span class='sep identifier id'>sep</span>
    <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='seqregexp identifier id'>seqregexp</span><span class='comma token'>,</span> <span class='string val'>&quot;\\1\n&quot;</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='regexp val'>/^/</span><span class='rparen token'>)</span>
    <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='head identifier id'>head</span> <span class='plus op'>+</span> <span class='x identifier id'>x</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='len identifier id'>len</span> <span class='plus op'>+</span> <span class='seqwidth identifier id'>seqwidth</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='div identifier id'>div</span><span class='lparen token'>(</span><span class='seqwidth identifier id'>seqwidth</span><span class='rparen token'>)</span>
  <span class='i identifier id'>i</span> <span class='assign token'>=</span> <span class='integer val'>1</span>
  <span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='times identifier id'>times</span> <span class='do do kw'>do</span>
    <span class='msf identifier id'>msf</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;\n&quot;</span>
    <span class='n_l identifier id'>n_l</span> <span class='assign token'>=</span> <span class='i identifier id'>i</span>
    <span class='n_r identifier id'>n_r</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='i identifier id'>i</span> <span class='plus op'>+</span> <span class='seqwidth identifier id'>seqwidth</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='len identifier id'>len</span> <span class='rbrack token'>]</span><span class='dot token'>.</span><span class='min identifier id'>min</span>
    <span class='if if kw'>if</span> <span class='n_l identifier id'>n_l</span> <span class='neq op'>!=</span> <span class='n_r identifier id'>n_r</span> <span class='then then kw'>then</span>
      <span class='w identifier id'>w</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='n_r identifier id'>n_r</span> <span class='minus op'>-</span> <span class='n_l identifier id'>n_l</span> <span class='plus op'>+</span> <span class='integer val'>1</span> <span class='minus op'>-</span> <span class='n_l identifier id'>n_l</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='minus op'>-</span> <span class='n_r identifier id'>n_r</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='length identifier id'>length</span><span class='comma token'>,</span> <span class='integer val'>1</span> <span class='rbrack token'>]</span><span class='dot token'>.</span><span class='max identifier id'>max</span>
      <span class='msf identifier id'>msf</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='string val'>' '</span> <span class='mult op'>*</span> <span class='namewidth identifier id'>namewidth</span> <span class='plus op'>+</span> <span class='sep identifier id'>sep</span> <span class='plus op'>+</span> <span class='n_l identifier id'>n_l</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> 
              <span class='string val'>' '</span> <span class='mult op'>*</span> <span class='w identifier id'>w</span> <span class='plus op'>+</span> <span class='n_r identifier id'>n_r</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='msf identifier id'>msf</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='string val'>' '</span> <span class='mult op'>*</span> <span class='namewidth identifier id'>namewidth</span> <span class='plus op'>+</span> <span class='sep identifier id'>sep</span> <span class='plus op'>+</span> <span class='n_l identifier id'>n_l</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='msf identifier id'>msf</span> <span class='lshft op'>&lt;&lt;</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span> <span class='rbrace token'>}</span>
    <span class='i identifier id'>i</span> <span class='opasgn op'>+=</span> <span class='seqwidth identifier id'>seqwidth</span>
  <span class='end end kw'>end</span>
  <span class='msf identifier id'>msf</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;\n&quot;</span>
  <span class='msf identifier id'>msf</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output_phylip</h3>
</div><div id="output_phylip-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output_phylip</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
generates phylip interleaved alignment format as a string
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/alignment.rb', line 1082</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/alignment.rb#L1082">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1082
1083
1084
1085
1086
1087
1088
1089
1090</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output_phylip identifier id'>output_phylip</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='aln identifier id'>aln</span><span class='comma token'>,</span> <span class='aseqs identifier id'>aseqs</span><span class='comma token'>,</span> <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='__output_phylip_common identifier id'>__output_phylip_common</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='lines identifier id'>lines</span><span class='dot token'>.</span><span class='times identifier id'>times</span> <span class='do do kw'>do</span>
    <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='aln identifier id'>aln</span> <span class='lshft op'>&lt;&lt;</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span> <span class='rbrace token'>}</span>
    <span class='aln identifier id'>aln</span> <span class='lshft op'>&lt;&lt;</span> <span class='string val'>&quot;\n&quot;</span>
  <span class='end end kw'>end</span>
  <span class='aln identifier id'>aln</span><span class='dot token'>.</span><span class='pop identifier id'>pop</span> <span class='if if_mod kw'>if</span> <span class='aln identifier id'>aln</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='string val'>&quot;\n&quot;</span>
  <span class='aln identifier id'>aln</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output_phylipnon</h3>
</div><div id="output_phylipnon-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output_phylipnon</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
generates Phylip3.2 (old) non-interleaved format as a string
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/alignment.rb', line 1093</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/alignment.rb#L1093">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1093
1094
1095
1096</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output_phylipnon identifier id'>output_phylipnon</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='aln identifier id'>aln</span><span class='comma token'>,</span> <span class='aseqs identifier id'>aseqs</span><span class='comma token'>,</span> <span class='lines identifier id'>lines</span> <span class='assign token'>=</span> <span class='__output_phylip_common identifier id'>__output_phylip_common</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='aln identifier id'>aln</span><span class='dot token'>.</span><span class='first identifier id'>first</span> <span class='plus op'>+</span> <span class='aseqs identifier id'>aseqs</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_clustal</h3>
</div><div id="to_clustal-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_clustal</span><span class='args'>(*arg)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
to_clustal is deprecated. Instead, please use output_clustal.
</p>
<hr size="1"></hr><p>
alias to_clustal output_clustal +++
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/alignment.rb', line 1053</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/alignment.rb#L1053">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1053
1054
1055
1056</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_clustal identifier id'>to_clustal</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
  <span class='warn identifier id'>warn</span> <span class='string val'>&quot;to_clustal is deprecated. Please use output_clustal.&quot;</span>
  <span class='output_clustal identifier id'>output_clustal</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>