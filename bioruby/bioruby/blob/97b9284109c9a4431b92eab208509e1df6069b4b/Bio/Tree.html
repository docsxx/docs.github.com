<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>bioruby's bioruby - Class: Bio::Tree - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/bioruby/commits/bioruby/master" rel="alternate" title="Recent Commits to bioruby:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("bioruby", "bioruby", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("bioruby", "bioruby", "97b9284109c9a4431b92eab208509e1df6069b4b", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/bioruby/bioruby/tree/">Source</a></li>
            <li class=""><a href="http://github.com/bioruby/bioruby/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/bioruby/bioruby/network">Network</a></li>            
            <li class=""><a href="http://github.com/bioruby/bioruby/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/bioruby/bioruby">Wiki</a></li>
            <li class=""><a href="http://github.com/bioruby/bioruby/graphs">Graphs</a></li>                    
            <li class="active"><a href="/bioruby/bioruby">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/bioruby">bioruby</a> / <b><a href="http://github.com/bioruby/bioruby/tree">bioruby</a></b>        
                <a id="namespaces_button" rel="bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Bio_Tree">
  <h1>Class: Bio::Tree</h1>
  <div class="section docstring">
  <p>
This is the class for phylogenetic tree. It stores a phylogenetic tree.
</p>
<p>
Internally, it is based on Bio::Pathway class. However, users cannot handle
Bio::Pathway object directly.
</p>
<p>
This is alpha version. Incompatible changes may be made frequently.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">options</td>
          <td class="readwrite">
            [<span id='options-instance_method'>R</span><span id='options=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
tree options; mainly used for tree output.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">root</td>
          <td class="readwrite">
            [<span id='root-instance_method'>R</span><span id='root=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
root node of this tree (even if unrooted tree, it is used by some methods).
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="DEFAULT_OPTIONS-constant">DEFAULT_OPTIONS</dt>
      <dd>{ :indent =&gt; '  ' }</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(tree = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Creates a new phylogenetic tree. When no arguments are given, it creates a
new empty tree. When a Tree object is given, it copies the tree. Note that
the new tree shares Node and Edge objects with the given tree.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 259</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L259">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">259
260
261
262
263
264
265</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='tree identifier id'>tree</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='comment val'># creates an undirected adjacency list graph</span>
  <span class='@pathway ivar id'>@pathway</span> <span class='assign token'>=</span> <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='Pathway constant id'>Pathway</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='@root ivar id'>@root</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='@options ivar id'>@options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='tree identifier id'>tree</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='tree identifier id'>tree</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#add_edge-instance_method">#add_edge</span><span class='args'>(source, target, edge = Edge.new)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Adds a new edge to the tree.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#add_node-instance_method">#add_node</span><span class='args'>(node)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Adds a node to the tree.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#adjacency_matrix-instance_method">#adjacency_matrix</span><span class='args'>(nodes = nil, default_value = nil, diagonal_value = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Shows the adjacency matrix representation of the tree.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#adjacent_nodes-instance_method">#adjacent_nodes</span><span class='args'>(node)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array of adjacent nodes of the given node.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ancestors-instance_method">#ancestors</span><span class='args'>(node, root = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets all ancestral nodes of the <em>node</em>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#children-instance_method">#children</span><span class='args'>(node, root = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets the adjacent children nodes of the <em>node</em>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#clear-instance_method">#clear</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Clears all nodes and edges.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#clear_node-instance_method">#clear_node</span><span class='args'>(node)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Removes all edges connected with the node.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#collect_edge-21-instance_method">#collect_edge!</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Replaces each edge by each block&#8217;s return value.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#collect_node-21-instance_method">#collect_node!</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Replaces each node by each block&#8217;s return value.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#concat-instance_method">#concat</span><span class='args'>(other)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Concatenates the other tree.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#descendents-instance_method">#descendents</span><span class='args'>(node, root = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets all descendent nodes of the <em>node</em>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#distance-instance_method">#distance</span><span class='args'>(node1, node2)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns distance between node1 and node2.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#distance_matrix-instance_method">#distance_matrix</span><span class='args'>(nodes = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Calculates distance matrix of given nodes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#each_edge-instance_method">#each_edge</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Iterates over each edges of this tree.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#each_edge_in_path-instance_method">#each_edge_in_path</span><span class='args'>(node1, node2)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Iterates over each edge from node1 to node2.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#each_node-instance_method">#each_node</span><span class='args'>(&amp;x)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Iterates over each node of this tree.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#each_out_edge-instance_method">#each_out_edge</span><span class='args'>(source)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Iterates over each connected edges of the given node.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#edges-instance_method">#edges</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns all edges an array of [ node0, node1, edge ].
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_edge-instance_method">#get_edge</span><span class='args'>(source, target)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an edge from source to target.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_edge_distance-instance_method">#get_edge_distance</span><span class='args'>(edge)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets distance value from the given edge.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_edge_distance_string-instance_method">#get_edge_distance_string</span><span class='args'>(edge)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets distance string from the given edge.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_edge_merged-instance_method">#get_edge_merged</span><span class='args'>(edge1, edge2)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns edge1 + edge2.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_node_bootstrap-instance_method">#get_node_bootstrap</span><span class='args'>(node)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_node_bootstrap_string-instance_method">#get_node_bootstrap_string</span><span class='args'>(node)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_node_by_name-instance_method">#get_node_by_name</span><span class='args'>(str)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Finds a node in the tree by given name and returns the node.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_node_name-instance_method">#get_node_name</span><span class='args'>(node)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets node name.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#include-3F-instance_method">#include?</span><span class='args'>(node)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
If the node exists, returns true.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#insert_node-instance_method">#insert_node</span><span class='args'>(node1, node2, new_node, new_distance = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Insert a new node between adjacent nodes node1 and node2.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#leaves-instance_method">#leaves</span><span class='args'>(node = nil, root = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
If <em>node</em> is nil, returns an array of all leaves (nodes connected
with one edge).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#lowest_common_ancestor-instance_method">#lowest_common_ancestor</span><span class='args'>(node1, node2, root = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets the lowest common ancestor of the two nodes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#nodes-instance_method">#nodes</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns all nodes as an array.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#number_of_edges-instance_method">#number_of_edges</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns number of edges in the tree.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#number_of_nodes-instance_method">#number_of_nodes</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Number of nodes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#out_degree-instance_method">#out_degree</span><span class='args'>(source)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns number of edges in the given node.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#out_edges-instance_method">#out_edges</span><span class='args'>(source)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns all connected edges with adjacent nodes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output-instance_method">#output</span><span class='args'>(format, *arg, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns formatted text (or something) of the tree Currently supported
format is: :newick, :nhx.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output_newick-instance_method">#output_newick</span><span class='args'>(options = {}, &amp;block)</span>
        <span class='block'></span>
        
          <span class='alias'>#newick</span>
        
      </th>
      <td class="docstring">
        <p>
Returns a newick formatted string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output_nhx-instance_method">#output_nhx</span><span class='args'>(options = {}, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a NHX (New Hampshire eXtended) formatted string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#output_phylip_distance_matrix-instance_method">#output_phylip_distance_matrix</span><span class='args'>(nodes = nil, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <hr size="1"></hr><p>
This method isn&#8217;t suitable to written in this file? +++ Generates
phylip-style distance matrix as a string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#parent-instance_method">#parent</span><span class='args'>(node, root = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets the parent node of the <em>node</em>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#path-instance_method">#path</span><span class='args'>(node1, node2)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets path from node1 to node2.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_edge-instance_method">#remove_edge</span><span class='args'>(source, target)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Removes an edge between source and target.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_edge_if-instance_method">#remove_edge_if</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Removes each edge if the block returns not nil.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_node-instance_method">#remove_node</span><span class='args'>(node)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Removes the given node from the tree.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_node_if-instance_method">#remove_node_if</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Removes each node if the block returns not nil.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_nonsense_nodes-instance_method">#remove_nonsense_nodes</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Removes all nodes that are not branches nor leaves.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#subtree-instance_method">#subtree</span><span class='args'>(nodes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets the sub-tree consisted of given nodes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#subtree_with_all_paths-instance_method">#subtree_with_all_paths</span><span class='args'>(nodes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Gets the sub-tree consisted of given nodes and all internal nodes connected
between given nodes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#total_distance-instance_method">#total_distance</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns total distance of all edges.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>add_edge</h3>
</div><div id="add_edge-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_edge</span><span class='args'>(source, target, edge = Edge.new)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Adds a new edge to the tree. Returns the newly added edge. If the edge
already exists, it is overwritten with new one.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 368</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L368">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">368
369
370
371</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='add_edge identifier id'>add_edge</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span> <span class='assign token'>=</span> <span class='Edge constant id'>Edge</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='append identifier id'>append</span><span class='lparen token'>(</span><span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='Relation constant id'>Relation</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='edge identifier id'>edge</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>add_node</h3>
</div><div id="add_node-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>add_node</span><span class='args'>(node)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Adds a node to the tree. Returns self. If the node already exists, it does
nothing.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 389</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L389">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">389
390
391
392</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='add_node identifier id'>add_node</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>adjacency_matrix</h3>
</div><div id="adjacency_matrix-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>adjacency_matrix</span><span class='args'>(nodes = nil, default_value = nil, diagonal_value = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Shows the adjacency matrix representation of the tree. It shows matrix only
for given nodes. If <em>nodes</em> is nil or is ommitted, it acts the same
as tree.adjacency_matrix(tree.nodes). If a block is given, for each edge,
it yields <em>source</em>, <em>target</em>, and <em>edge</em>, and uses the
returned value of the block. Without blocks, it uses edge. Returns a matrix
object.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 760</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L760">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='adjacency_matrix identifier id'>adjacency_matrix</span><span class='lparen token'>(</span><span class='nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span>
                     <span class='default_value identifier id'>default_value</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span>
                     <span class='diagonal_value identifier id'>diagonal_value</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span><span class='semicolon token'>;</span> <span class='comment val'>#:yields: source, target, edge</span>
  <span class='nodes identifier id'>nodes</span> <span class='opasgn op'>||=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='nodes identifier id'>nodes</span>
  <span class='size identifier id'>size</span> <span class='assign token'>=</span> <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='i identifier id'>i</span><span class='bitor op'>|</span> <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='i identifier id'>i</span> <span class='rbrace token'>}</span>
  <span class='comment val'># prepares an matrix</span>
  <span class='matrix identifier id'>matrix</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='size identifier id'>size</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='matrix identifier id'>matrix</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='Array constant id'>Array</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='size identifier id'>size</span><span class='comma token'>,</span> <span class='default_value identifier id'>default_value</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='size identifier id'>size</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span> <span class='matrix identifier id'>matrix</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='diagonal_value identifier id'>diagonal_value</span> <span class='rbrace token'>}</span>
  <span class='comment val'># fills the matrix from each edge</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_edge identifier id'>each_edge</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='bitor op'>|</span>
    <span class='i_source identifier id'>i_source</span> <span class='assign token'>=</span> <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='source identifier id'>source</span><span class='rbrack token'>]</span>
    <span class='i_target identifier id'>i_target</span> <span class='assign token'>=</span> <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='target identifier id'>target</span><span class='rbrack token'>]</span>
    <span class='if if kw'>if</span> <span class='i_source identifier id'>i_source</span> <span class='and and kw'>and</span> <span class='i_target identifier id'>i_target</span> <span class='then then kw'>then</span>
      <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='block_given? fid id'>block_given?</span> <span class='integer val'>? </span><span class='lparen token'>(</span><span class='yield yield kw'>yield</span> <span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='edge identifier id'>edge</span>
      <span class='matrix identifier id'>matrix</span><span class='lbrack token'>[</span><span class='i_source identifier id'>i_source</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='i_target identifier id'>i_target</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='matrix identifier id'>matrix</span><span class='lbrack token'>[</span><span class='i_target identifier id'>i_target</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='i_source identifier id'>i_source</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='Matrix constant id'>Matrix</span><span class='dot token'>.</span><span class='rows identifier id'>rows</span><span class='lparen token'>(</span><span class='matrix identifier id'>matrix</span><span class='comma token'>,</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>adjacent_nodes</h3>
</div><div id="adjacent_nodes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>adjacent_nodes</span><span class='args'>(node)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array of adjacent nodes of the given node.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 319</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L319">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">319
320
321
322</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='adjacent_nodes identifier id'>adjacent_nodes</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span>
  <span class='h identifier id'>h</span> <span class='integer val'>? </span><span class='h identifier id'>h</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span> <span class='colon op'>:</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ancestors</h3>
</div><div id="ancestors-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ancestors</span><span class='args'>(node, root = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets all ancestral nodes of the <em>node</em>. If <em>root</em> isn&#8217;t
specified or <em>root</em> is <tt>nil</tt>, @root is used. Returns an array
of <tt>Node</tt>s. The result is unspecified for cyclic trees.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 695</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L695">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">695
696
697
698</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='ancestors identifier id'>ancestors</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='comma token'>,</span> <span class='root identifier id'>root</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='root identifier id'>root</span> <span class='opasgn op'>||=</span> <span class='@root ivar id'>@root</span>
  <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='lparen token'>(</span><span class='root identifier id'>root</span><span class='comma token'>,</span> <span class='node identifier id'>node</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='lbrack token'>[</span> <span class='node identifier id'>node</span> <span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='reverse identifier id'>reverse</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>children</h3>
</div><div id="children-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>children</span><span class='args'>(node, root = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets the adjacent children nodes of the <em>node</em>. If <em>root</em>
isn&#8217;t specified or <em>root</em> is <tt>nil</tt>, @root is used.
Returns an array of <tt>Node</tt>s. The result is unspecified for cyclic
trees.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 638</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L638">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">638
639
640
641
642
643
644</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='children identifier id'>children</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='comma token'>,</span> <span class='root identifier id'>root</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='root identifier id'>root</span> <span class='opasgn op'>||=</span> <span class='@root ivar id'>@root</span>
  <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='lparen token'>(</span><span class='root identifier id'>root</span><span class='comma token'>,</span> <span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='adjacent_nodes identifier id'>adjacent_nodes</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='opasgn op'>-=</span> <span class='path identifier id'>path</span>
  <span class='result identifier id'>result</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>clear</h3>
</div><div id="clear-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>clear</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Clears all nodes and edges. Returns self. Note that options and root are
also cleared.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 277</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L277">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">277
278
279
280</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='clear identifier id'>clear</span>
  <span class='initialize identifier id'>initialize</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>clear_node</h3>
</div><div id="clear_node-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>clear_node</span><span class='args'>(node)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Removes all edges connected with the node. Returns self. If the node does
not exist, raises IndexError.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 403</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L403">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">403
404
405
406
407
408
409
410
411
412
413
414
415</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='clear_node identifier id'>clear_node</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='IndexError constant id'>IndexError</span><span class='comma token'>,</span> <span class='string val'>'the node does not exist'</span>
  <span class='end end kw'>end</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='relations identifier id'>relations</span><span class='dot token'>.</span><span class='delete_if identifier id'>delete_if</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rel identifier id'>rel</span><span class='bitor op'>|</span>
    <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each_key identifier id'>each_key</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='bitor op'>|</span>
    <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='k identifier id'>k</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='clear identifier id'>clear</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>collect_edge!</h3>
</div><div id="collect_edge-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>collect_edge!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Replaces each edge by each block&#8217;s return value. Returns self.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 507</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L507">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">507
508
509
510
511
512
513
514</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='collect_edge! fid id'>collect_edge!</span> 
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='relations identifier id'>relations</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rel identifier id'>rel</span><span class='bitor op'>|</span>
    <span class='newedge identifier id'>newedge</span> <span class='assign token'>=</span> <span class='yield yield kw'>yield</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='relation identifier id'>relation</span>
    <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='relation identifier id'>relation</span> <span class='assign token'>=</span> <span class='newedge identifier id'>newedge</span>
    <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='append identifier id'>append</span><span class='lparen token'>(</span><span class='rel identifier id'>rel</span><span class='comma token'>,</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>collect_node!</h3>
</div><div id="collect_node-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>collect_node!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Replaces each node by each block&#8217;s return value. Returns self.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 487</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L487">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='collect_node! fid id'>collect_node!</span> 
  <span class='tr identifier id'>tr</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_node identifier id'>each_node</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='node identifier id'>node</span><span class='bitor op'>|</span>
    <span class='tr identifier id'>tr</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='yield yield kw'>yield</span> <span class='node identifier id'>node</span>
  <span class='end end kw'>end</span>
  <span class='comment val'># replaces nodes in @pathway.relations</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='relations identifier id'>relations</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rel identifier id'>rel</span><span class='bitor op'>|</span>
    <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='node identifier id'>node</span><span class='bitor op'>|</span> <span class='tr identifier id'>tr</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='comment val'># re-generates @pathway from relations</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='to_list identifier id'>to_list</span>
  <span class='comment val'># adds orphan nodes</span>
  <span class='tr identifier id'>tr</span><span class='dot token'>.</span><span class='each_value identifier id'>each_value</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='newnode identifier id'>newnode</span><span class='bitor op'>|</span>
    <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='newnode identifier id'>newnode</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>concat</h3>
</div><div id="concat-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>concat</span><span class='args'>(other)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Concatenates the other tree. If the same edge exists, the edge in
<em>other</em> is used. Returns self. The result is unspecified if
<em>other</em> isn&#8217;t a Tree object. Note that the Node and Edge
objects in the <em>other</em> tree are shared in the concatinated tree.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 574</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L574">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">574
575
576
577
578
579
580
581
582
583</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='other identifier id'>other</span><span class='rparen token'>)</span>
  <span class='comment val'>#raise TypeError unless other.kind_of?(self.class)</span>
  <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='each_node identifier id'>each_node</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='node identifier id'>node</span><span class='bitor op'>|</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='add_node identifier id'>add_node</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='each_edge identifier id'>each_edge</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='bitor op'>|</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='add_edge identifier id'>add_edge</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>descendents</h3>
</div><div id="descendents-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>descendents</span><span class='args'>(node, root = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets all descendent nodes of the <em>node</em>. If <em>root</em>
isn&#8217;t specified or <em>root</em> is <tt>nil</tt>, @root is used.
Returns an array of <tt>Node</tt>s. The result is unspecified for cyclic
trees.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 650</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L650">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='descendents identifier id'>descendents</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='comma token'>,</span> <span class='root identifier id'>root</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='root identifier id'>root</span> <span class='opasgn op'>||=</span> <span class='@root ivar id'>@root</span>
  <span class='distance identifier id'>distance</span><span class='comma token'>,</span> <span class='route identifier id'>route</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='breadth_first_search identifier id'>breadth_first_search</span><span class='lparen token'>(</span><span class='root identifier id'>root</span><span class='rparen token'>)</span>
  <span class='d identifier id'>d</span> <span class='assign token'>=</span> <span class='distance identifier id'>distance</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='distance identifier id'>distance</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='val identifier id'>val</span> <span class='gt op'>&gt;</span> <span class='d identifier id'>d</span> <span class='then then kw'>then</span>
      <span class='x identifier id'>x</span> <span class='assign token'>=</span> <span class='key identifier id'>key</span>
      <span class='while while kw'>while</span> <span class='x identifier id'>x</span> <span class='assign token'>=</span> <span class='route identifier id'>route</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span>
        <span class='if if kw'>if</span> <span class='x identifier id'>x</span> <span class='eq op'>==</span> <span class='node identifier id'>node</span> <span class='then then kw'>then</span>
          <span class='result identifier id'>result</span> <span class='lshft op'>&lt;&lt;</span> <span class='key identifier id'>key</span>
          <span class='break break kw'>break</span>
        <span class='end end kw'>end</span>
        <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='distance identifier id'>distance</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span> <span class='leq op'>&lt;=</span> <span class='d identifier id'>d</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='result identifier id'>result</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>distance</h3>
</div><div id="distance-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>distance</span><span class='args'>(node1, node2)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns distance between node1 and node2. It would raise error if the edges
didn&#8217;t contain distance values. The result is unspecified for cyclic
trees.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 617</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L617">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">617
618
619
620
621
622
623</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='distance identifier id'>distance</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='rparen token'>)</span>
  <span class='distance identifier id'>distance</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_edge_in_path identifier id'>each_edge_in_path</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='bitor op'>|</span>
    <span class='distance identifier id'>distance</span> <span class='opasgn op'>+=</span> <span class='get_edge_distance identifier id'>get_edge_distance</span><span class='lparen token'>(</span><span class='edge identifier id'>edge</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='distance identifier id'>distance</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>distance_matrix</h3>
</div><div id="distance_matrix-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>distance_matrix</span><span class='args'>(nodes = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Calculates distance matrix of given nodes. If <em>nodes</em> is nil, or is
ommited, it acts the same as tree.distance_matrix(tree.leaves). Returns a
matrix object. The result is unspecified for cyclic trees. Note 1: The
diagonal values of the matrix are 0. Note 2: If the distance cannot be
calculated, nil will be set.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 731</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L731">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='distance_matrix identifier id'>distance_matrix</span><span class='lparen token'>(</span><span class='nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='nodes identifier id'>nodes</span> <span class='opasgn op'>||=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='leaves identifier id'>leaves</span>
  <span class='matrix identifier id'>matrix</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='each_index identifier id'>each_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
    <span class='row identifier id'>row</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='each_index identifier id'>each_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='j identifier id'>j</span><span class='bitor op'>|</span>
      <span class='if if kw'>if</span> <span class='i identifier id'>i</span> <span class='eq op'>==</span> <span class='j identifier id'>j</span> <span class='then then kw'>then</span>
        <span class='distance identifier id'>distance</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
      <span class='elsif elsif kw'>elsif</span> <span class='r identifier id'>r</span> <span class='assign token'>=</span> <span class='matrix identifier id'>matrix</span><span class='lbrack token'>[</span><span class='j identifier id'>j</span><span class='rbrack token'>]</span> <span class='and and kw'>and</span> <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span> <span class='then then kw'>then</span>
        <span class='distance identifier id'>distance</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
      <span class='else else kw'>else</span>
        <span class='distance identifier id'>distance</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='distance identifier id'>distance</span><span class='lparen token'>(</span><span class='nodes identifier id'>nodes</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='nodes identifier id'>nodes</span><span class='lbrack token'>[</span><span class='j identifier id'>j</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rescue rescue kw'>rescue</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='row identifier id'>row</span> <span class='lshft op'>&lt;&lt;</span> <span class='distance identifier id'>distance</span>
    <span class='end end kw'>end</span>
    <span class='matrix identifier id'>matrix</span> <span class='lshft op'>&lt;&lt;</span> <span class='row identifier id'>row</span>
  <span class='end end kw'>end</span>
  <span class='Matrix constant id'>Matrix</span><span class='dot token'>.</span><span class='rows identifier id'>rows</span><span class='lparen token'>(</span><span class='matrix identifier id'>matrix</span><span class='comma token'>,</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>each_edge</h3>
</div><div id="each_edge-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>each_edge</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Iterates over each edges of this tree.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 299</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L299">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">299
300
301
302
303
304</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='each_edge identifier id'>each_edge</span> 
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='relations identifier id'>relations</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rel identifier id'>rel</span><span class='bitor op'>|</span>
    <span class='yield yield kw'>yield</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='relation identifier id'>relation</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>each_edge_in_path</h3>
</div><div id="each_edge_in_path-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>each_edge_in_path</span><span class='args'>(node1, node2)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Iterates over each edge from node1 to node2. The result is unspecified for
cyclic trees.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 603</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L603">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">603
604
605
606
607
608
609
610
611
612</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='each_edge_in_path identifier id'>each_edge_in_path</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='rparen token'>)</span>
  <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='rparen token'>)</span>
  <span class='source identifier id'>source</span> <span class='assign token'>=</span> <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span>
  <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='target identifier id'>target</span><span class='bitor op'>|</span>
    <span class='edge identifier id'>edge</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='get_edge identifier id'>get_edge</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='rparen token'>)</span>
    <span class='yield yield kw'>yield</span> <span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span>
    <span class='source identifier id'>source</span> <span class='assign token'>=</span> <span class='target identifier id'>target</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>each_node</h3>
</div><div id="each_node-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>each_node</span><span class='args'>(&amp;x)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Iterates over each node of this tree.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 293</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L293">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">293
294
295
296</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='each_node identifier id'>each_node</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='x identifier id'>x</span><span class='rparen token'>)</span> <span class='comment val'>#:yields: node</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='dot token'>.</span><span class='each_key identifier id'>each_key</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>each_out_edge</h3>
</div><div id="each_out_edge-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>each_out_edge</span><span class='args'>(source)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Iterates over each connected edges of the given node. Returns self.
</p>
<p>
The reason why the method name is &quot;each_out_edge&quot; is that it
comes from the Boost Graph Library.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 343</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L343">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">343
344
345
346
347</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='each_out_edge identifier id'>each_out_edge</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='rparen token'>)</span> <span class='comment val'>#:yields: source, target, edge</span>
  <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='source identifier id'>source</span><span class='rbrack token'>]</span>
  <span class='h identifier id'>h</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='bitor op'>|</span> <span class='yield yield kw'>yield</span> <span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='val identifier id'>val</span> <span class='rbrace token'>}</span> <span class='if if_mod kw'>if</span> <span class='h identifier id'>h</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>edges</h3>
</div><div id="edges-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>edges</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns all edges an array of [ node0, node1, edge ]
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 307</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L307">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">307
308
309
310
311</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='edges identifier id'>edges</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='relations identifier id'>relations</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rel identifier id'>rel</span><span class='bitor op'>|</span>
    <span class='lbrack token'>[</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='relation identifier id'>relation</span> <span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_edge</h3>
</div><div id="get_edge-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_edge</span><span class='args'>(source, target)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an edge from source to target. If source and target are not
adjacent nodes, returns nil.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 360</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L360">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">360
361
362
363</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_edge identifier id'>get_edge</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='rparen token'>)</span>
  <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='source identifier id'>source</span><span class='rbrack token'>]</span>
  <span class='h identifier id'>h</span> <span class='integer val'>? </span><span class='h identifier id'>h</span><span class='lbrack token'>[</span><span class='target identifier id'>target</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_edge_distance</h3>
</div><div id="get_edge_distance-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_edge_distance</span><span class='args'>(edge)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets distance value from the given edge. Returns float or any other numeric
value or nil.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 101</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L101">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">101
102
103
104
105
106
107
108</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_edge_distance identifier id'>get_edge_distance</span><span class='lparen token'>(</span><span class='edge identifier id'>edge</span><span class='rparen token'>)</span>
  <span class='begin begin kw'>begin</span>
    <span class='dist identifier id'>dist</span> <span class='assign token'>=</span> <span class='edge identifier id'>edge</span><span class='dot token'>.</span><span class='distance identifier id'>distance</span>
  <span class='rescue rescue kw'>rescue</span> <span class='NoMethodError constant id'>NoMethodError</span>
    <span class='dist identifier id'>dist</span> <span class='assign token'>=</span> <span class='edge identifier id'>edge</span>
  <span class='end end kw'>end</span>
  <span class='dist identifier id'>dist</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_edge_distance_string</h3>
</div><div id="get_edge_distance_string-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_edge_distance_string</span><span class='args'>(edge)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets distance string from the given edge. Returns a string or nil.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 112</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L112">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">112
113
114
115
116
117
118
119</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_edge_distance_string identifier id'>get_edge_distance_string</span><span class='lparen token'>(</span><span class='edge identifier id'>edge</span><span class='rparen token'>)</span>
  <span class='begin begin kw'>begin</span>
    <span class='dist identifier id'>dist</span> <span class='assign token'>=</span> <span class='edge identifier id'>edge</span><span class='dot token'>.</span><span class='distance_string identifier id'>distance_string</span>
  <span class='rescue rescue kw'>rescue</span> <span class='NoMethodError constant id'>NoMethodError</span>
    <span class='dist identifier id'>dist</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='edge identifier id'>edge</span> <span class='integer val'>? </span><span class='edge identifier id'>edge</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='dist identifier id'>dist</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_edge_merged</h3>
</div><div id="get_edge_merged-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_edge_merged</span><span class='args'>(edge1, edge2)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns edge1 + edge2
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 122</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L122">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">122
123
124
125
126
127
128
129
130
131
132
133
134</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_edge_merged identifier id'>get_edge_merged</span><span class='lparen token'>(</span><span class='edge1 identifier id'>edge1</span><span class='comma token'>,</span> <span class='edge2 identifier id'>edge2</span><span class='rparen token'>)</span>
  <span class='dist1 identifier id'>dist1</span> <span class='assign token'>=</span> <span class='get_edge_distance identifier id'>get_edge_distance</span><span class='lparen token'>(</span><span class='edge1 identifier id'>edge1</span><span class='rparen token'>)</span>
  <span class='dist2 identifier id'>dist2</span> <span class='assign token'>=</span> <span class='get_edge_distance identifier id'>get_edge_distance</span><span class='lparen token'>(</span><span class='edge2 identifier id'>edge2</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='dist1 identifier id'>dist1</span> <span class='and and kw'>and</span> <span class='dist2 identifier id'>dist2</span> <span class='then then kw'>then</span>
    <span class='Edge constant id'>Edge</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dist1 identifier id'>dist1</span> <span class='plus op'>+</span> <span class='dist2 identifier id'>dist2</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='dist1 identifier id'>dist1</span> <span class='then then kw'>then</span>
    <span class='Edge constant id'>Edge</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dist1 identifier id'>dist1</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='dist2 identifier id'>dist2</span> <span class='then then kw'>then</span>
    <span class='Edge constant id'>Edge</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dist2 identifier id'>dist2</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='Edge constant id'>Edge</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_node_bootstrap</h3>
</div><div id="get_node_bootstrap-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_node_bootstrap</span><span class='args'>(node)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 238</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L238">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">238
239
240
241
242
243
244</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_node_bootstrap identifier id'>get_node_bootstrap</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='begin begin kw'>begin</span>
    <span class='node identifier id'>node</span><span class='dot token'>.</span><span class='bootstrap identifier id'>bootstrap</span>
  <span class='rescue rescue kw'>rescue</span> <span class='NoMethodError constant id'>NoMethodError</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_node_bootstrap_string</h3>
</div><div id="get_node_bootstrap_string-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_node_bootstrap_string</span><span class='args'>(node)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 246</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L246">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">246
247
248
249
250
251
252</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_node_bootstrap_string identifier id'>get_node_bootstrap_string</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='begin begin kw'>begin</span>
    <span class='node identifier id'>node</span><span class='dot token'>.</span><span class='bootstrap_string identifier id'>bootstrap_string</span>
  <span class='rescue rescue kw'>rescue</span> <span class='NoMethodError constant id'>NoMethodError</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_node_by_name</h3>
</div><div id="get_node_by_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_node_by_name</span><span class='args'>(str)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Finds a node in the tree by given name and returns the node. If the node
does not found, returns nil. If multiple nodes with the same name exist,
the result would be one of those (unspecified).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 377</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L377">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">377
378
379
380
381
382
383
384</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_node_by_name identifier id'>get_node_by_name</span><span class='lparen token'>(</span><span class='str identifier id'>str</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_node identifier id'>each_node</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='node identifier id'>node</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='get_node_name identifier id'>get_node_name</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='str identifier id'>str</span>
      <span class='return return kw'>return</span> <span class='node identifier id'>node</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_node_name</h3>
</div><div id="get_node_name-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_node_name</span><span class='args'>(node)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets node name
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 230</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L230">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">230
231
232
233
234
235
236</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_node_name identifier id'>get_node_name</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='begin begin kw'>begin</span>
    <span class='node identifier id'>node</span><span class='dot token'>.</span><span class='name identifier id'>name</span>
  <span class='rescue rescue kw'>rescue</span> <span class='NoMethodError constant id'>NoMethodError</span>
    <span class='node identifier id'>node</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>include?</h3>
</div><div id="include-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>include?</span><span class='args'>(node)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
If the node exists, returns true. Otherwise, returns false.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 396</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L396">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">396
397
398</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='true true kw'>true</span> <span class='colon op'>:</span> <span class='false false kw'>false</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>insert_node</h3>
</div><div id="insert_node-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>insert_node</span><span class='args'>(node1, node2, new_node, new_distance = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Insert a new node between adjacent nodes node1 and node2. The old edge
between node1 and node2 are changed to the edge between new_node and node2.
The edge between node1 and new_node is newly created.
</p>
<p>
If new_distance is specified, the distance between node1 and new_node is
set to new_distance, and distance between new_node and node2 is set to
<tt>tree.get_edge(node1, node2).distance - new_distance</tt>.
</p>
<p>
Returns self. If node1 and node2 are not adjacent, raises IndexError.
</p>
<p>
If new_node already exists in the tree, the tree would become circular. In
addition, if the edge between new_node and node1 (or node2) already exists,
it will be erased.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 827</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L827">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='insert_node identifier id'>insert_node</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='comma token'>,</span> <span class='new_node identifier id'>new_node</span><span class='comma token'>,</span> <span class='new_distance identifier id'>new_distance</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='edge identifier id'>edge</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='get_edge identifier id'>get_edge</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='rparen token'>)</span> <span class='then then kw'>then</span>
    <span class='raise identifier id'>raise</span> <span class='IndexError constant id'>IndexError</span><span class='comma token'>,</span> <span class='string val'>'nodes not found or two nodes are not adjacent'</span>
  <span class='end end kw'>end</span>
  <span class='new_edge identifier id'>new_edge</span> <span class='assign token'>=</span> <span class='Edge constant id'>Edge</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='new_distance identifier id'>new_distance</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='remove_edge identifier id'>remove_edge</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='add_edge identifier id'>add_edge</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='new_node identifier id'>new_node</span><span class='comma token'>,</span> <span class='new_edge identifier id'>new_edge</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='new_distance identifier id'>new_distance</span> <span class='and and kw'>and</span> <span class='old_distance identifier id'>old_distance</span> <span class='assign token'>=</span> <span class='get_edge_distance identifier id'>get_edge_distance</span><span class='lparen token'>(</span><span class='edge identifier id'>edge</span><span class='rparen token'>)</span> <span class='then then kw'>then</span>
    <span class='old_distance identifier id'>old_distance</span> <span class='opasgn op'>-=</span> <span class='new_distance identifier id'>new_distance</span>
    <span class='begin begin kw'>begin</span>
      <span class='edge identifier id'>edge</span><span class='dot token'>.</span><span class='distance identifier id'>distance</span> <span class='assign token'>=</span> <span class='old_distance identifier id'>old_distance</span>
    <span class='rescue rescue kw'>rescue</span> <span class='NoMethodError constant id'>NoMethodError</span>
      <span class='edge identifier id'>edge</span> <span class='assign token'>=</span> <span class='old_distance identifier id'>old_distance</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='add_edge identifier id'>add_edge</span><span class='lparen token'>(</span><span class='new_node identifier id'>new_node</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>leaves</h3>
</div><div id="leaves-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>leaves</span><span class='args'>(node = nil, root = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
If <em>node</em> is nil, returns an array of all leaves (nodes connected
with one edge). Otherwise, gets all descendent leaf nodes of the
<em>node</em>. If <em>root</em> isn&#8217;t specified or <em>root</em> is
<tt>nil</tt>, @root is used. Returns an array of <tt>Node</tt>s. The result
is unspecified for cyclic trees.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 676</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L676">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">676
677
678
679
680
681
682
683
684
685
686
687
688
689</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='leaves identifier id'>leaves</span><span class='lparen token'>(</span><span class='node identifier id'>node</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='root identifier id'>root</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='node identifier id'>node</span> <span class='then then kw'>then</span>
    <span class='nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_node identifier id'>each_node</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
      <span class='nodes identifier id'>nodes</span> <span class='lshft op'>&lt;&lt;</span> <span class='x identifier id'>x</span> <span class='if if_mod kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='out_degree identifier id'>out_degree</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
    <span class='end end kw'>end</span>
    <span class='return return kw'>return</span> <span class='nodes identifier id'>nodes</span>
  <span class='else else kw'>else</span>
    <span class='root identifier id'>root</span> <span class='opasgn op'>||=</span> <span class='@root ivar id'>@root</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='descendents identifier id'>descendents</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='comma token'>,</span> <span class='root identifier id'>root</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='find_all identifier id'>find_all</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
      <span class='self self kw'>self</span><span class='dot token'>.</span><span class='adjacent_nodes identifier id'>adjacent_nodes</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>1</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>lowest_common_ancestor</h3>
</div><div id="lowest_common_ancestor-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>lowest_common_ancestor</span><span class='args'>(node1, node2, root = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets the lowest common ancestor of the two nodes. If <em>root</em>
isn&#8217;t specified or <em>root</em> is <tt>nil</tt>, @root is used.
Returns a <tt>Node</tt> object or nil. The result is unspecified for cyclic
trees.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 704</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L704">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">704
705
706
707
708
709
710
711
712</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='lowest_common_ancestor identifier id'>lowest_common_ancestor</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='comma token'>,</span> <span class='root identifier id'>root</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='root identifier id'>root</span> <span class='opasgn op'>||=</span> <span class='@root ivar id'>@root</span>
  <span class='distance identifier id'>distance</span><span class='comma token'>,</span> <span class='route identifier id'>route</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='breadth_first_search identifier id'>breadth_first_search</span><span class='lparen token'>(</span><span class='root identifier id'>root</span><span class='rparen token'>)</span>
  <span class='x identifier id'>x</span> <span class='assign token'>=</span> <span class='node1 identifier id'>node1</span><span class='semicolon token'>;</span> <span class='r1 identifier id'>r1</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='begin begin kw'>begin</span><span class='semicolon token'>;</span> <span class='r1 identifier id'>r1</span> <span class='lshft op'>&lt;&lt;</span> <span class='x identifier id'>x</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span> <span class='while while_mod kw'>while</span> <span class='x identifier id'>x</span> <span class='assign token'>=</span> <span class='route identifier id'>route</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span>
  <span class='x identifier id'>x</span> <span class='assign token'>=</span> <span class='node2 identifier id'>node2</span><span class='semicolon token'>;</span> <span class='r2 identifier id'>r2</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='begin begin kw'>begin</span><span class='semicolon token'>;</span> <span class='r2 identifier id'>r2</span> <span class='lshft op'>&lt;&lt;</span> <span class='x identifier id'>x</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span> <span class='while while_mod kw'>while</span> <span class='x identifier id'>x</span> <span class='assign token'>=</span> <span class='route identifier id'>route</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span>
  <span class='return return kw'>return</span> <span class='lparen token'>(</span><span class='r1 identifier id'>r1</span> <span class='bitand op'>&amp;</span> <span class='r2 identifier id'>r2</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>nodes</h3>
</div><div id="nodes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>nodes</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns all nodes as an array.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 283</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L283">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">283
284
285</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='nodes identifier id'>nodes</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>number_of_edges</h3>
</div><div id="number_of_edges-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>number_of_edges</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns number of edges in the tree.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 314</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L314">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">314
315
316</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='number_of_edges identifier id'>number_of_edges</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='relations identifier id'>relations</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>number_of_nodes</h3>
</div><div id="number_of_nodes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>number_of_nodes</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Number of nodes.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 288</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L288">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">288
289
290</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='number_of_nodes identifier id'>number_of_nodes</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='nodes identifier id'>nodes</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>out_degree</h3>
</div><div id="out_degree-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>out_degree</span><span class='args'>(source)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns number of edges in the given node.
</p>
<p>
The reason why the method name is &quot;out_degree&quot; is that it comes
from the Boost Graph Library.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 353</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L353">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">353
354
355
356</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='out_degree identifier id'>out_degree</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='rparen token'>)</span>
  <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='source identifier id'>source</span><span class='rbrack token'>]</span>
  <span class='h identifier id'>h</span> <span class='integer val'>? </span><span class='h identifier id'>h</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='colon op'>:</span> <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>out_edges</h3>
</div><div id="out_edges-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>out_edges</span><span class='args'>(source)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns all connected edges with adjacent nodes. Returns an array of the
array [ source, target, edge ].
</p>
<p>
The reason why the method name is &quot;out_edges&quot; is that it comes
from the Boost Graph Library.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 329</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L329">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">329
330
331
332
333
334
335
336</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='out_edges identifier id'>out_edges</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='rparen token'>)</span>
  <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='source identifier id'>source</span><span class='rbrack token'>]</span>
  <span class='if if kw'>if</span> <span class='h identifier id'>h</span>
    <span class='h identifier id'>h</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='bitor op'>|</span> <span class='lbrack token'>[</span> <span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='val identifier id'>val</span> <span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output</h3>
</div><div id="output-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output</span><span class='args'>(format, *arg, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns formatted text (or something) of the tree Currently supported
format is: :newick, :nhx
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/db/newick.rb', line 235</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/db/newick.rb#L235">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">235
236
237
238
239
240
241
242
243
244
245
246</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output identifier id'>output</span><span class='lparen token'>(</span><span class='format identifier id'>format</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='format identifier id'>format</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:newick</span>
    <span class='output_newick identifier id'>output_newick</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:nhx</span>
    <span class='output_nhx identifier id'>output_nhx</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:phylip_distance_matrix</span>
    <span class='output_phylip_distance_matrix identifier id'>output_phylip_distance_matrix</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='arg identifier id'>arg</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='string val'>'Unknown format'</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output_newick</h3>
</div><div id="output_newick-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output_newick</span><span class='args'>(options = {}, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="newick-instance_method">newick</tt>
  
</p>
</div><div class="section docstring">
  <p>
Returns a newick formatted string. If block is given, the order of the node
is sorted (as the same manner as Enumerable#sort).
</p>
<p>
Available options:
</p>
<table>
<tr><td valign="top"><tt>:indent</tt>:</td><td>indent string; set false to disable (default: &#8217; &#8217;)

</td></tr>
<tr><td valign="top"><tt>:bootstrap_style</tt>:</td><td><tt>:disabled</tt> disables bootstrap representations.
<tt>:traditional</tt> for traditional style. <tt>:molphy</tt> for Molphy
style (default).

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/db/newick.rb', line 203</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/db/newick.rb#L203">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">203
204
205
206
207
208
209
210</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output_newick identifier id'>output_newick</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'>#:yields: node1, node2</span>
  <span class='root identifier id'>root</span> <span class='assign token'>=</span> <span class='@root ivar id'>@root</span>
  <span class='root identifier id'>root</span> <span class='opasgn op'>||=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
  <span class='return return kw'>return</span> <span class='string val'>'();'</span> <span class='unless unless_mod kw'>unless</span> <span class='root identifier id'>root</span>
  <span class='__to_newick identifier id'>__to_newick</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='root identifier id'>root</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='symbol val'>:__to_newick_format_leaf</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='plus op'>+</span>
    <span class='__to_newick_format_leaf identifier id'>__to_newick_format_leaf</span><span class='lparen token'>(</span><span class='root identifier id'>root</span><span class='comma token'>,</span> <span class='Edge constant id'>Edge</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span> <span class='plus op'>+</span>
    <span class='string val'>&quot;;\n&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output_nhx</h3>
</div><div id="output_nhx-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output_nhx</span><span class='args'>(options = {}, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a NHX (New Hampshire eXtended) formatted string. If block is given,
the order of the node is sorted (as the same manner as Enumerable#sort).
</p>
<p>
Available options:
</p>
<table>
<tr><td valign="top"><tt>:indent</tt>:</td><td>indent string; set false to disable (default: &#8217; &#8217;)

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/db/newick.rb', line 223</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/db/newick.rb#L223">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">223
224
225
226
227
228
229
230
231</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output_nhx identifier id'>output_nhx</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='comment val'>#:yields: node1, node2</span>
  <span class='root identifier id'>root</span> <span class='assign token'>=</span> <span class='@root ivar id'>@root</span>
  <span class='root identifier id'>root</span> <span class='opasgn op'>||=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
  <span class='return return kw'>return</span> <span class='string val'>'();'</span> <span class='unless unless_mod kw'>unless</span> <span class='root identifier id'>root</span>
  <span class='__to_newick identifier id'>__to_newick</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='root identifier id'>root</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span>
              <span class='symbol val'>:__to_newick_format_leaf_NHX</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='plus op'>+</span>
    <span class='__to_newick_format_leaf_NHX identifier id'>__to_newick_format_leaf_NHX</span><span class='lparen token'>(</span><span class='root identifier id'>root</span><span class='comma token'>,</span> <span class='Edge constant id'>Edge</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span> <span class='plus op'>+</span>
    <span class='string val'>&quot;;\n&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>output_phylip_distance_matrix</h3>
</div><div id="output_phylip_distance_matrix-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>output_phylip_distance_matrix</span><span class='args'>(nodes = nil, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <hr size="1"></hr><p>
This method isn&#8217;t suitable to written in this file? +++ Generates
phylip-style distance matrix as a string. if nodes is not given, all leaves
in the tree are used. If the names of some of the given (or default) nodes
are not defined or are empty, the names are automatically generated.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/db/newick.rb', line 256</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/db/newick.rb#L256">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">256
257
258
259
260
261
262
263
264
265</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='output_phylip_distance_matrix identifier id'>output_phylip_distance_matrix</span><span class='lparen token'>(</span><span class='nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='leaves identifier id'>leaves</span> <span class='unless unless_mod kw'>unless</span> <span class='nodes identifier id'>nodes</span>
  <span class='names identifier id'>names</span> <span class='assign token'>=</span> <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
    <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='get_node_name identifier id'>get_node_name</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
    <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='sprintf identifier id'>sprintf</span><span class='lparen token'>(</span><span class='string val'>&quot;%x&quot;</span><span class='comma token'>,</span> <span class='x identifier id'>x</span><span class='dot token'>.</span><span class='__id__ identifier id'>__id__</span><span class='dot token'>.</span><span class='abs identifier id'>abs</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='y identifier id'>y</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='y identifier id'>y</span>
  <span class='end end kw'>end</span>
  <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='distance_matrix identifier id'>distance_matrix</span><span class='lparen token'>(</span><span class='nodes identifier id'>nodes</span><span class='rparen token'>)</span>
  <span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='Phylip constant id'>Phylip</span><span class='colon2 op'>::</span><span class='DistanceMatrix constant id'>DistanceMatrix</span><span class='dot token'>.</span><span class='generate identifier id'>generate</span><span class='lparen token'>(</span><span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='names identifier id'>names</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>parent</h3>
</div><div id="parent-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>parent</span><span class='args'>(node, root = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets the parent node of the <em>node</em>. If <em>root</em> isn&#8217;t
specified or <em>root</em> is <tt>nil</tt>, @root is used. Returns an
<tt>Node</tt> object or nil. The result is unspecified for cyclic trees.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 629</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L629">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">629
630
631
632</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='parent identifier id'>parent</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='comma token'>,</span> <span class='root identifier id'>root</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='root identifier id'>root</span> <span class='opasgn op'>||=</span> <span class='@root ivar id'>@root</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='lparen token'>(</span><span class='root identifier id'>root</span><span class='comma token'>,</span> <span class='node identifier id'>node</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-2</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>path</h3>
</div><div id="path-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>path</span><span class='args'>(node1, node2)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets path from node1 to node2. Retruns an array of nodes, including node1
and node2. If node1 and/or node2 do not exist, IndexError is raised. If
node1 and node2 are not connected, NoPathError is raised. The result is
unspecified for cyclic trees.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>IndexError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 590</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L590">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">590
591
592
593
594
595
596
597
598
599</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='path identifier id'>path</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='IndexError constant id'>IndexError</span><span class='comma token'>,</span> <span class='string val'>'node1 not found'</span> <span class='unless unless_mod kw'>unless</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node1 identifier id'>node1</span><span class='rbrack token'>]</span>
  <span class='raise identifier id'>raise</span> <span class='IndexError constant id'>IndexError</span><span class='comma token'>,</span> <span class='string val'>'node2 not found'</span> <span class='unless unless_mod kw'>unless</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node2 identifier id'>node2</span><span class='rbrack token'>]</span>
  <span class='return return kw'>return</span> <span class='lbrack token'>[</span> <span class='node1 identifier id'>node1</span> <span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='node1 identifier id'>node1</span> <span class='eq op'>==</span> <span class='node2 identifier id'>node2</span>
  <span class='step identifier id'>step</span><span class='comma token'>,</span> <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='bfs_shortest_path identifier id'>bfs_shortest_path</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='path identifier id'>path</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='node1 identifier id'>node1</span> <span class='and and kw'>and</span> <span class='path identifier id'>path</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='node2 identifier id'>node2</span> <span class='then then kw'>then</span>
    <span class='raise identifier id'>raise</span> <span class='NoPathError constant id'>NoPathError</span><span class='comma token'>,</span> <span class='string val'>'node1 and node2 are not connected'</span>
  <span class='end end kw'>end</span>
  <span class='path identifier id'>path</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_edge</h3>
</div><div id="remove_edge-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_edge</span><span class='args'>(source, target)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Removes an edge between source and target. Returns self. If the edge does
not exist, raises IndexError.
</p>
<hr size="1"></hr><p>
If two or more edges exists between source and target, all of them are
removed. +++
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 448</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L448">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">448
449
450
451
452
453
454
455
456
457
458
459
460
461
462</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_edge identifier id'>remove_edge</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='get_edge identifier id'>get_edge</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='rparen token'>)</span> <span class='then then kw'>then</span>
    <span class='raise identifier id'>raise</span> <span class='IndexError constant id'>IndexError</span><span class='comma token'>,</span> <span class='string val'>'edge not found'</span>
  <span class='end end kw'>end</span>
  <span class='fwd identifier id'>fwd</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span> <span class='rbrack token'>]</span>
  <span class='rev identifier id'>rev</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='source identifier id'>source</span> <span class='rbrack token'>]</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='relations identifier id'>relations</span><span class='dot token'>.</span><span class='delete_if identifier id'>delete_if</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rel identifier id'>rel</span><span class='bitor op'>|</span>
    <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span> <span class='eq op'>==</span> <span class='fwd identifier id'>fwd</span> <span class='or or kw'>or</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span> <span class='eq op'>==</span> <span class='rev identifier id'>rev</span>
  <span class='end end kw'>end</span>
  <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='source identifier id'>source</span><span class='rbrack token'>]</span>
  <span class='h identifier id'>h</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='target identifier id'>target</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='h identifier id'>h</span>
  <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='target identifier id'>target</span><span class='rbrack token'>]</span>
  <span class='h identifier id'>h</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='h identifier id'>h</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_edge_if</h3>
</div><div id="remove_edge_if-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_edge_if</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Removes each edge if the block returns not nil. Returns self.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 466</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L466">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_edge_if identifier id'>remove_edge_if</span> 
  <span class='removed_rel identifier id'>removed_rel</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='relations identifier id'>relations</span><span class='dot token'>.</span><span class='delete_if identifier id'>delete_if</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rel identifier id'>rel</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='yield yield kw'>yield</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span> <span class='then then kw'>then</span>
      <span class='removed_rel identifier id'>removed_rel</span> <span class='lshft op'>&lt;&lt;</span> <span class='rel identifier id'>rel</span>
      <span class='true true kw'>true</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='removed_rel identifier id'>removed_rel</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rel identifier id'>rel</span><span class='bitor op'>|</span>
    <span class='source identifier id'>source</span> <span class='assign token'>=</span> <span class='rel identifier id'>rel</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
    <span class='target identifier id'>target</span> <span class='assign token'>=</span> <span class='rel identifier id'>rel</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span>
    <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='source identifier id'>source</span><span class='rbrack token'>]</span>
    <span class='h identifier id'>h</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='target identifier id'>target</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='h identifier id'>h</span>
    <span class='h identifier id'>h</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='target identifier id'>target</span><span class='rbrack token'>]</span>
    <span class='h identifier id'>h</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='source identifier id'>source</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='h identifier id'>h</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_node</h3>
</div><div id="remove_node-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_node</span><span class='args'>(node)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Removes the given node from the tree. All edges connected with the node are
also removed. Returns self. If the node does not exist, raises IndexError.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 421</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L421">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">421
422
423
424
425</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_node identifier id'>remove_node</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='clear_node identifier id'>clear_node</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_node_if</h3>
</div><div id="remove_node_if-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_node_if</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Removes each node if the block returns not nil. All edges connected with
the removed nodes are also removed. Returns self.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 430</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L430">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">430
431
432
433
434
435
436
437
438
439</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_node_if identifier id'>remove_node_if</span>
  <span class='all identifier id'>all</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='nodes identifier id'>nodes</span>
  <span class='all identifier id'>all</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='node identifier id'>node</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='yield yield kw'>yield</span> <span class='node identifier id'>node</span> <span class='then then kw'>then</span>
      <span class='self self kw'>self</span><span class='dot token'>.</span><span class='clear_node identifier id'>clear_node</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
      <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_nonsense_nodes</h3>
</div><div id="remove_nonsense_nodes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_nonsense_nodes</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Removes all nodes that are not branches nor leaves. That is, removes nodes
connected with exactly two edges. For each removed node, two adjacent edges
are merged and a new edge are created. Returns removed nodes. Note that
orphan nodes are still kept unchanged.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 790</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L790">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_nonsense_nodes identifier id'>remove_nonsense_nodes</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_node identifier id'>each_node</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='node identifier id'>node</span><span class='bitor op'>|</span>
    <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='true true kw'>true</span> <span class='if if_mod kw'>if</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='eq op'>==</span> <span class='integer val'>2</span>
  <span class='end end kw'>end</span>
  <span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='each_key identifier id'>each_key</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='node identifier id'>node</span><span class='bitor op'>|</span>
    <span class='adjs identifier id'>adjs</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span>
    <span class='edges identifier id'>edges</span> <span class='assign token'>=</span> <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='node identifier id'>node</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='values identifier id'>values</span>
    <span class='new_edge identifier id'>new_edge</span> <span class='assign token'>=</span> <span class='get_edge_merged identifier id'>get_edge_merged</span><span class='lparen token'>(</span><span class='edges identifier id'>edges</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='edges identifier id'>edges</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='adjs identifier id'>adjs</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
    <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='adjs identifier id'>adjs</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
    <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='node identifier id'>node</span><span class='rparen token'>)</span>
    <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='append identifier id'>append</span><span class='lparen token'>(</span><span class='Bio constant id'>Bio</span><span class='colon2 op'>::</span><span class='Relation constant id'>Relation</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='adjs identifier id'>adjs</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='adjs identifier id'>adjs</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='new_edge identifier id'>new_edge</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='comment val'>#@pathway.to_relations</span>
  <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='relations identifier id'>relations</span><span class='dot token'>.</span><span class='reject! fid id'>reject!</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rel identifier id'>rel</span><span class='bitor op'>|</span>
    <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span> <span class='or or kw'>or</span> <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='rel identifier id'>rel</span><span class='dot token'>.</span><span class='node identifier id'>node</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='return return kw'>return</span> <span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>subtree</h3>
</div><div id="subtree-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>subtree</span><span class='args'>(nodes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets the sub-tree consisted of given nodes. <em>nodes</em> must be an array
of nodes. Nodes that do not exist in the original tree are ignored. Returns
a Tree object. Note that the sub-tree shares Node and Edge objects with the
original tree.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 522</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L522">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='subtree identifier id'>subtree</span><span class='lparen token'>(</span><span class='nodes identifier id'>nodes</span><span class='rparen token'>)</span>
  <span class='nodes identifier id'>nodes</span> <span class='assign token'>=</span> <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='find_all identifier id'>find_all</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
    <span class='@pathway ivar id'>@pathway</span><span class='dot token'>.</span><span class='graph identifier id'>graph</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='return return kw'>return</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='if if_mod kw'>if</span> <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
  <span class='comment val'># creates subtree</span>
  <span class='new_tree identifier id'>new_tree</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span>
    <span class='new_tree identifier id'>new_tree</span><span class='dot token'>.</span><span class='add_node identifier id'>add_node</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_edge identifier id'>each_edge</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='bitor op'>|</span>
    <span class='if if kw'>if</span> <span class='new_tree identifier id'>new_tree</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='rparen token'>)</span> <span class='and and kw'>and</span> <span class='new_tree identifier id'>new_tree</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='node2 identifier id'>node2</span><span class='rparen token'>)</span> <span class='then then kw'>then</span>
      <span class='new_tree identifier id'>new_tree</span><span class='dot token'>.</span><span class='add_edge identifier id'>add_edge</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='return return kw'>return</span> <span class='new_tree identifier id'>new_tree</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>subtree_with_all_paths</h3>
</div><div id="subtree_with_all_paths-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>subtree_with_all_paths</span><span class='args'>(nodes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Gets the sub-tree consisted of given nodes and all internal nodes connected
between given nodes. <em>nodes</em> must be an array of nodes. Nodes that
do not exist in the original tree are ignored. Returns a Tree object. The
result is unspecified for cyclic trees. Note that the sub-tree shares Node
and Edge objects with the original tree.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 548</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L548">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='subtree_with_all_paths identifier id'>subtree_with_all_paths</span><span class='lparen token'>(</span><span class='nodes identifier id'>nodes</span><span class='rparen token'>)</span>
  <span class='hash identifier id'>hash</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='true true kw'>true</span> <span class='rbrace token'>}</span>
  <span class='nodes identifier id'>nodes</span><span class='dot token'>.</span><span class='each_index identifier id'>each_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
    <span class='node1 identifier id'>node1</span> <span class='assign token'>=</span> <span class='nodes identifier id'>nodes</span><span class='lbrack token'>[</span><span class='i identifier id'>i</span><span class='rbrack token'>]</span>
    <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='i identifier id'>i</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='j identifier id'>j</span><span class='bitor op'>|</span>
      <span class='node2 identifier id'>node2</span> <span class='assign token'>=</span> <span class='nodes identifier id'>nodes</span><span class='lbrack token'>[</span><span class='j identifier id'>j</span><span class='rbrack token'>]</span>
      <span class='unless unless kw'>unless</span> <span class='node1 identifier id'>node1</span> <span class='eq op'>==</span> <span class='node2 identifier id'>node2</span> <span class='then then kw'>then</span>
        <span class='begin begin kw'>begin</span>
          <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='lparen token'>(</span><span class='node1 identifier id'>node1</span><span class='comma token'>,</span> <span class='node2 identifier id'>node2</span><span class='rparen token'>)</span>
        <span class='rescue rescue kw'>rescue</span> <span class='IndexError constant id'>IndexError</span><span class='comma token'>,</span> <span class='NoPathError constant id'>NoPathError</span>
          <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
        <span class='end end kw'>end</span>
        <span class='path identifier id'>path</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='true true kw'>true</span> <span class='rbrace token'>}</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='subtree identifier id'>subtree</span><span class='lparen token'>(</span><span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>total_distance</h3>
</div><div id="total_distance-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>total_distance</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns total distance of all edges. It would raise error if some edges
didn&#8217;t contain distance values.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/bio/tree.rb', line 716</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/bioruby/bioruby/blob/97b9284109c9a4431b92eab208509e1df6069b4b/lib/bio/tree.rb#L716">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">716
717
718
719
720
721
722</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='total_distance identifier id'>total_distance</span>
  <span class='distance identifier id'>distance</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='each_edge identifier id'>each_edge</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='source identifier id'>source</span><span class='comma token'>,</span> <span class='target identifier id'>target</span><span class='comma token'>,</span> <span class='edge identifier id'>edge</span><span class='bitor op'>|</span>
    <span class='distance identifier id'>distance</span> <span class='opasgn op'>+=</span> <span class='get_edge_distance identifier id'>get_edge_distance</span><span class='lparen token'>(</span><span class='edge identifier id'>edge</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='distance identifier id'>distance</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>