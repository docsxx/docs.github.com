<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: Xapit::FacetOption</title>
  </head>
  <body>
    <div id="content">
      <div class="section class Xapit_FacetOption">
  <h1 class="title">Class: Xapit::FacetOption</h1>
  <div class="section docstring">
  <p>
A facet option is a specific value or choice for a facet. See Xapit::Facet
for details on how to use it.
</p>

</div><div class="section attributes">
  <h1>Attributes</h1>

  
    <div class="instance">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">count</td>
          <td class="readwrite">
            [<span id='count-instance_method'>R</span><span id='count%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>count</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">existing_facet_identifiers</td>
          <td class="readwrite">
            [<span id='existing_facet_identifiers-instance_method'>R</span><span id='existing_facet_identifiers%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>existing_facet_identifiers</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">facet</td>
          <td class="readwrite">
            [<span id='facet-instance_method'>R</span><span id='facet%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>facet</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">name</td>
          <td class="readwrite">
            [<span id='name-instance_method'>R</span><span id='name%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>name</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div><div class="section constructor">
<h1>Constructor Summary</h1>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(class_name, facet_attribute, name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


22
23
24
25</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/xapit/facet_option.rb', line 22</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='class_name identifier id'>class_name</span><span class='comma token'>,</span> <span class='facet_attribute identifier id'>facet_attribute</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='@facet ivar id'>@facet</span> <span class='assign token'>=</span> <span class='class_name identifier id'>class_name</span><span class='dot token'>.</span><span class='constantize identifier id'>constantize</span><span class='dot token'>.</span><span class='xapit_facet_blueprint identifier id'>xapit_facet_blueprint</span><span class='lparen token'>(</span><span class='facet_attribute identifier id'>facet_attribute</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='class_name identifier id'>class_name</span> <span class='andop op'>&amp;&amp;</span> <span class='facet_attribute identifier id'>facet_attribute</span>
  <span class='@name ivar id'>@name</span> <span class='assign token'>=</span> <span class='name identifier id'>name</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary class public">
    <h1>Public Class Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#exist%3F-class_method' title='exist?'>exist?</a></span><span class='args'>(id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
See if the given facet option exists with this id.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#find-class_method' title='find'>find</a></span><span class='args'>(id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Fetch a facet option given an id.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#identifier-instance_method' title='#identifier'>#identifier</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#save-instance_method' title='#save'>#save</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Saves the given facet option to the database if it hasn&#8217;t been
already.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#to_param-instance_method' title='#to_param'>#to_param</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Converts the facet to be used in a URL.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails class public">
  <h1>Public Class Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>exist?</h3>
</div><div id="exist%3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>exist?</span><span class='args'>(id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
See if the given facet option exists with this id.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


18
19
20</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/xapit/facet_option.rb', line 18</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='Query constant id'>Query</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Q#{name}-#{id}&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='count identifier id'>count</span> <span class='geq op'>&gt;=</span> <span class='integer val'>1</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>find</h3>
</div><div id="find-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>find</span><span class='args'>(id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Fetch a facet option given an id.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


7
8
9
10
11
12
13
14
15</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/xapit/facet_option.rb', line 7</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='match identifier id'>match</span> <span class='assign token'>=</span> <span class='Query constant id'>Query</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Q#{name}-#{id}&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='matches identifier id'>matches</span><span class='lparen token'>(</span><span class='symbol val'>:offset</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='symbol val'>:limit</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
  <span class='if if kw'>if</span> <span class='match identifier id'>match</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='raise identifier id'>raise</span> <span class='dstring node'>&quot;Unable to find facet option for #{id}.&quot;</span>
  <span class='else else kw'>else</span>
    <span class='class_name identifier id'>class_name</span><span class='comma token'>,</span> <span class='facet_attribute identifier id'>facet_attribute</span><span class='comma token'>,</span> <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='match identifier id'>match</span><span class='dot token'>.</span><span class='document identifier id'>document</span><span class='dot token'>.</span><span class='data identifier id'>data</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'|||'</span><span class='rparen token'>)</span>
    <span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='class_name identifier id'>class_name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='comma token'>,</span> <span class='facet_attribute identifier id'>facet_attribute</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div><div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>identifier</h3>
</div><div id="identifier-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>identifier</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


27
28
29</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/xapit/facet_option.rb', line 27</span>

<span class='def def kw'>def</span> <span class='identifier identifier id'>identifier</span>
  <span class='Digest constant id'>Digest</span><span class='colon2 op'>::</span><span class='SHA1 constant id'>SHA1</span><span class='dot token'>.</span><span class='hexdigest identifier id'>hexdigest</span><span class='lparen token'>(</span><span class='facet identifier id'>facet</span><span class='dot token'>.</span><span class='attribute identifier id'>attribute</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='name identifier id'>name</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='integer val'>6</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save</h3>
</div><div id="save-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Saves the given facet option to the database if it hasn&#8217;t been
already.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


32
33
34
35
36
37
38
39</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/xapit/facet_option.rb', line 32</span>

<span class='def def kw'>def</span> <span class='save identifier id'>save</span>
  <span class='unless unless kw'>unless</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='identifier identifier id'>identifier</span><span class='rparen token'>)</span>
    <span class='doc identifier id'>doc</span> <span class='assign token'>=</span> <span class='Xapian constant id'>Xapian</span><span class='colon2 op'>::</span><span class='Document constant id'>Document</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='facet identifier id'>facet</span><span class='dot token'>.</span><span class='member_class identifier id'>member_class</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='facet identifier id'>facet</span><span class='dot token'>.</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;|||&quot;</span><span class='rparen token'>)</span>
    <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='add_term identifier id'>add_term</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Q#{self.class.name}-#{identifier}&quot;</span><span class='rparen token'>)</span>
    <span class='Xapit constant id'>Xapit</span><span class='colon2 op'>::</span><span class='Config constant id'>Config</span><span class='dot token'>.</span><span class='writable_database identifier id'>writable_database</span><span class='dot token'>.</span><span class='add_document identifier id'>add_document</span><span class='lparen token'>(</span><span class='doc identifier id'>doc</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_param</h3>
</div><div id="to_param-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_param</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Converts the facet to be used in a URL. It adds to the existing ones for
convenience. If this facet option is currently selected, then this will
return all selected facets except this one. This conveniently allows you to
use this as both an &quot;add this facet&quot; and &quot;remove this
facet&quot; link.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


44
45
46
47
48
49
50</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/xapit/facet_option.rb', line 44</span>

<span class='def def kw'>def</span> <span class='to_param identifier id'>to_param</span>
  <span class='if if kw'>if</span> <span class='existing_facet_identifiers identifier id'>existing_facet_identifiers</span><span class='dot token'>.</span><span class='include? fid id'>include?</span> <span class='identifier identifier id'>identifier</span>
    <span class='lparen token'>(</span><span class='existing_facet_identifiers identifier id'>existing_facet_identifiers</span> <span class='minus op'>-</span> <span class='lbrack token'>[</span><span class='identifier identifier id'>identifier</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'-'</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='lparen token'>(</span><span class='existing_facet_identifiers identifier id'>existing_facet_identifiers</span> <span class='plus op'>+</span> <span class='lbrack token'>[</span><span class='identifier identifier id'>identifier</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'-'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>