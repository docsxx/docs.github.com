<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>georgepalmer's couch_foo - Class: CouchFoo::Base - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/georgepalmer/commits/couch_foo/master" rel="alternate" title="Recent Commits to couch_foo:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("georgepalmer", "couch_foo", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("georgepalmer", "couch_foo", "13a37f5c452f8ebacb4a9caf0e225911cface3a6", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/georgepalmer/couch_foo/tree/">Source</a></li>
            <li class=""><a href="http://github.com/georgepalmer/couch_foo/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/georgepalmer/couch_foo/network">Network</a></li>            
            <li class=""><a href="http://github.com/georgepalmer/couch_foo/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/georgepalmer/couch_foo">Wiki</a></li>
            <li class=""><a href="http://github.com/georgepalmer/couch_foo/graphs">Graphs</a></li>                    
            <li class="active"><a href="/georgepalmer/couch_foo">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/georgepalmer">georgepalmer</a> / <b><a href="http://github.com/georgepalmer/couch_foo/tree">couch_foo</a></b>        
                <a id="namespaces_button" rel="georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class CouchFoo_Base">
  <h1>Class: CouchFoo::Base</h1>
  <div class="section docstring">
  <h2>Introduction</h2>
<p>
CouchDB (http://couchdb.apache.org/) works slightly differently to
relational databases. First, and foremost, it is a document-orientated
database. That is, data is stored in documents each of which have a unique
id that is used to access and modify it. The contents of the documents are
free from structure (or schema free) and bare no relation to one another
(unless you encode that within the documents themselves). So in many ways
documents are like records within a relational database except there are no
tables to keep documents of the same type in.
</p>
<p>
CouchDB interfaces with the external world via a RESTful interface. This
allows document creation, updating, deletion etc. The contents of a
document are specified in JSON so its possible to serialise objects within
the database record efficiently as well as store all the normal types
natively.
</p>
<p>
As a consequence of its free form structure there is no SQL to query the
database. Instead you define (table-oriented) views that emit certain bits
of data from the record and apply conditions, sorting etc to those views.
For example if you were to emit the colour attribute you could find all
documents with a certain colour. This is similar to indexed lookups on a
relational table (both in terms of concept and performance).
</p>
<p>
CouchDB has been designed from the ground up to operate in a distributed
way. It provides robust, incremental replication with bi-directional
conflict detection and resolution. It&#8217;s an excellent choice for
unstructed data, large datasets that need sharding efficiently and
situations where you wish to run local copies of the database (for example
in satellite offices).
</p>
<p>
If using CouchDB in a more traditional database sense, it is common to
specify a class attribute in the document so that a view can be defined to
find all documents of that class. This is similar to a relational database
table. CouchFoo defines a ruby_class property that holds the class name of
the model that it&#8217;s representing. It is then possible to do User.all
for example. As such it has been possible, with a few minor exceptions, to
take the interface to ActiveRecord and re-implement it for CouchDB. This
should allow for easy migration from MySQL and friends to CouchDB. Further,
CouchFoo, has been designed to take advantages of some features that
CouchDB offers that are not available in relational databases. For example
- multiple updates and efficient sharding of data
</p>
<p>
In terms of performance CouchDB operates differently in some areas when
compared to relationsal databases. That&#8217;s not to say it&#8217;s
better or worse, just different - you pay the price for certain operations
at different points. As such there&#8217;s a performance section below that
details which areas are better performing and which worse. This is
something to be aware when writing or migrating applications and using
CouchDB.
</p>
<h2>Quick start guide - what&#8217;s different?</h2>
<p>
This section outlines differences between ActiveRecord and CouchFoo and a
few specific CouchDB points to be aware of
</p>
<p>
As CouchDB is schema-free there are no migrations and no schemas to worry
about. You simply specify properties inside the model (a bit like in
DataMapper) and add/subtract from them as you need. Adding new properties
initializes that attribute to nil when using a document that doesn&#8217;t
have the corresponding data and removing a field makes that attribute no
longer available (and removes it from the record on next save). You can
optionally specify a type with a property although it makes sense to do so
if you can (it&#8217;ll convert to that type). For example:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Address constant id'>Address</span> <span class='lt op'>&lt;</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='property identifier id'>property</span> <span class='symbol val'>:number</span><span class='comma token'>,</span> <span class='Integer constant id'>Integer</span>
    <span class='property identifier id'>property</span> <span class='symbol val'>:street</span><span class='comma token'>,</span> <span class='String constant id'>String</span>
    <span class='property identifier id'>property</span> <span class='symbol val'>:postcode</span> <span class='comment val'># Any generic type is fine as long as .to_json and class.from_json(json) can be called on it</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Documents have three more properties that get added automatically. _id and
_rev are CouchDB internal properties. The _id is the document UUID and
never changes. This is created by the gem to be unique accross mulitple
computers so should never result in a conflict. It is also aliased to id to
ensure compatability with ActiveRecord. The _rev attribute is changed by
CouchDB each time an update is made. It is used internally by CouchDB to
detect conflicts. The final property is ruby_class that is used by CouchFoo
to determine which documents map to which models.
</p>
<p>
CouchDB has a concept called bulk saving where mutliple operations can be
built up and commited at once. This has the added advantage of being in a
transaction so all or none of the operations will complete. By default bulk
saving is switched off but you can set the CouchFoo::Base.bulk_save_default
setting to true to achieve good performance gains when updating large
amounts of documents. Beware it is the developers responsability to commit
the work though. For example:
</p>
<pre class="code">
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='all identifier id'>all</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='comment val'># =&gt; 27</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;george&quot;</span><span class='rparen token'>)</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='all identifier id'>all</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='comment val'># =&gt; 27</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='database identifier id'>database</span><span class='dot token'>.</span><span class='commit identifier id'>commit</span> <span class='comment val'># or you can use self.class.database.commit if just using 1 database</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='all identifier id'>all</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='comment val'># =&gt; 28</span>
</pre>
<p>
If using this option in rails it would be a good idea to specify an
after_filter so that any changes are commited at the end of an action. If
you are sharding database across several databases you will need to deal
with this in the after_filter logic as well.
</p>
<p>
Conflicts occur when a copy of the document is altered under CouchFoo. That
is since loading the document into memory another person or program has
altered its contents. CouchDB detects this through the _rev attribute. If a
conflict occurs a DocumentConflict error is raised. This is effectively the
same as ActiveRecord Optimistic locking mechanism. Exceptions should be
dealt with in application logic if using save! - save will just return
false
</p>
<p>
On the finders and associations there are a few options that are no longer
relevant - :select, :joins, :having, :group, :from and :lock Everything
else is available although :conditions and :order work slightly differently
and :include hasn&#8217;t been implemented yet. :conditions is now only a
hash, eg :conditions =&gt; <tt>=&amp;gt; user_name</tt> and doesn&#8217;t
accept an array or SQL. :offset or :skip is quite inefficient so should be
used sparingly :order isn&#8217;t a SQL fragement but a field to sort the
results on - eg :order =&gt; :created_at At the moment this can only be one
field so it&#8217;s best to sort the results yourself once you&#8217;ve got
them back if you require complex ordering. As the order is applied once the
results are retrieved from the database it cannot be used with :limit. The
reason :order is applied after the results are retrieved is CouchDB can
only order on items exposed in the key. Thus if you wanted to sort User.all
5 different ways throughout your application you would need 5 indexes
rather than one. This is quite inefficient so ordering is performed once
the data is retrieved from the database with the cost that using :order
with :limit has to be performed an alternate way.
</p>
<p>
When using finders views are automatically built by CouchFoo for the model.
For example, with the class House, the first House.find(:id) will create a
House design document with a view that exposes the id of the house as the
key - any house can then be selected on this. If you then do a query for a
certain colour house, ie House.find_all_by_colour(&quot;red&quot;) then a
view that exposes the house colour as the key will be added to the design
document. This works well when using conditions (as we can generate the key
from the conditions used) but means it&#8217;s not possible to find the
oldest 5 users in the system if :created_at isn&#8217;t exposed in the key.
As such it is possible to set the key to use with a view directly. For
example:
</p>
<pre class="code">
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='symbol val'>:use_key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='comma token'>,</span> <span class='symbol val'>:category</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:category</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Article&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:limit</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>50</span><span class='rparen token'>)</span> <span class='comment val'># Finds 50 people with a category of &quot;Article&quot; sorted by name</span>
</pre>
<p>
We must use the condition keys in the :use_key array as we want to restrict
the results on this. It should be noted that the query will get the desired
results but at the expense of creating a new index so shouldn&#8217;t be
used excessively. For more complex queries it is also possible to specify
your own map and reduce functions using the CouchFoo#view call. See the
CouchDB view documentation and the CouchFoo#view documentation for more on
this.
</p>
<p>
Using relational databases with incrementing keys we have become accustom
to adding a new record and then using find(:last) to retrieve it. As each
document in CouchDB has a unique identifier this may no longer the case.
This is particularly important when creating user interfaces as it is
normal to add items to the bottom of lists and expect on reload for the
order to be maintained. In couch_foo items are sorted by the :created_at
property if it is available and there are no conditions on the query - eg
User.all, User.first As this is a minor use case it is recommended to use
the CouchFoo#default_sort macro that applies a default sort order to the
model each time it&#8217;s retrieved from the database. This way you can
set default_sort :created_at and not worry about hitting the problem again.
</p>
<p>
With CouchDB the price to pay for inserting data into an indexed view
isn&#8217;t paid at insertion time like MySQL and friends, but at the point
of next retrieving that view (although it&#8217;s possible to override this
in order to sacrifice performance for accuracy). As such you can either pay
the performance cost when accessing the view (which might be ok if the view
gets used a lot but not if a million applicable documents have been added
since the last view) or add an external process which gets called everytime
a document is created in CouchDB. More of this is outlined in the
CouchFoo#find documentation
</p>
<p>
Connecting to the database is done in a way similar to ActiveRecord where
the database is inherited by each subclass unless overridden. In CouchFoo
you use the call set_database method with a host and database name. As
there&#8217;s no database connection to be maintained sharding data is very
efficient and some applications even use one database per user.
</p>
<p>
If using rails, for now you need to specify your own initializer to make
the default database connection. This will be brought inline with rails in
the future, using a couchdb.yml configuration file or similar. But for now
an initializer file in config/initializers like the following will do the
trick:
</p>
<pre class="code">
  <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='set_database identifier id'>set_database</span><span class='lparen token'>(</span><span class='symbol val'>:host</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;http://localhost:5984&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:database</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;mydatabase&quot;</span><span class='rparen token'>)</span>
  <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='logger identifier id'>logger</span> <span class='assign token'>=</span> <span class='Rails constant id'>Rails</span><span class='dot token'>.</span><span class='logger identifier id'>logger</span>
</pre>
<p>
A few tidbits:
</p>
<ul>
<li>When specifying associations you still need to specify the object_id and
object_type (if using polymorphic association) properties. We have this
automated as part of the association macro soon

</li>
<li>validates_uniqueness_of has had the :case_sensitive option dropped

</li>
<li>Because there&#8217;s no SQL there&#8217;s no SQL finder methods but
equally there&#8217;s no SQL injection to worry about. You should still
sanitize output when displaying back to the user though because you will
still be vunerable to JS attacks etc.

</li>
<li>Some operations are more efficient than relational databases, others less
so. See the performance section for more details on this

</li>
<li>Every so often the database will need compacting to recover space lost to
old document revisions. More importantly initial indications show
un-compacted databases can effect performance. See
http://wiki.apache.org/couchdb/Compaction for more details on this.

</li>
</ul>
<p>
The following things are not in this implementation (but are in
ActiveRecord):
</p>
<ul>
<li>:include - Although the finders and associations allow this option the
actual implementation is yet to be written

</li>
<li>Timezones

</li>
<li>Aggregations

</li>
<li>Fixtures and general testing support

</li>
<li>Query cache

</li>
</ul>
<h2>Properties</h2>
<p>
Couch Foo objects specify their properties through the use of property
definitions inside the model itself. This is unlike ActiveRecord (but
similar to DataMapper). As the underlying database document is stored in
JSON (String, Integer, Float, Time, DateTime, Date and Boolean/TrueClass
are the available types) there are a few differences between CouchFoo and
ActiveRecord. The following table highlights any changes that will need to
be made to model types:
</p>
<pre class="code">
 <span class='ActiveRecord constant id'>ActiveRecord</span> <span class='type identifier id'>type</span> <span class='bitor op'>|</span> <span class='CouchFoo constant id'>CouchFoo</span> <span class='type identifier id'>type</span>
 <span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='plus op'>+</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='minus op'>-</span>
 <span class='comment val'>#Text             | String</span>
 <span class='comment val'>#Decimal          | Float</span>
 <span class='comment val'>#Timestamp        | Time</span>
 <span class='comment val'>#Binary           | Attachment (not yet implemented)</span>
</pre>
<p>
An example of a model is as follows:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Address constant id'>Address</span> <span class='lt op'>&lt;</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='property identifier id'>property</span> <span class='symbol val'>:number</span><span class='comma token'>,</span> <span class='Integer constant id'>Integer</span>
    <span class='property identifier id'>property</span> <span class='symbol val'>:street</span><span class='comma token'>,</span> <span class='String constant id'>String</span>
    <span class='property identifier id'>property</span> <span class='symbol val'>:postcode</span> <span class='comment val'># Any generic type is fine as long as .to_json can be called on it</span>
  <span class='end end kw'>end</span>
</pre>
<h2>Creation</h2>
<p>
Couch Foo accept constructor parameters either in a hash or as a block. The
hash method is especially useful when you&#8217;re receiving the data from
somewhere else, like an HTTP request. It works like this:
</p>
<pre class="code">
  <span class='user identifier id'>user</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;David&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:occupation</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Code Artist&quot;</span><span class='rparen token'>)</span>
  <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='comment val'># =&gt; &quot;David&quot;</span>
</pre>
<p>
You can also use block initialization:
</p>
<pre class="code">
  <span class='user identifier id'>user</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='u identifier id'>u</span><span class='bitor op'>|</span>
    <span class='u identifier id'>u</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='string val'>&quot;David&quot;</span>
    <span class='u identifier id'>u</span><span class='dot token'>.</span><span class='occupation identifier id'>occupation</span> <span class='assign token'>=</span> <span class='string val'>&quot;Code Artist&quot;</span>
  <span class='end end kw'>end</span>
</pre>
<p>
And of course you can just create a bare object and specify the attributes
after the fact:
</p>
<pre class="code">
  <span class='user identifier id'>user</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='string val'>&quot;David&quot;</span>
  <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='occupation identifier id'>occupation</span> <span class='assign token'>=</span> <span class='string val'>&quot;Code Artist&quot;</span>
</pre>
<h2>Conditions</h2>
<p>
Conditions are specified as a Hash. This is different from ActiveRecord
where they can be specified as a String, Array or Hash. Example:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='User constant id'>User</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='authenticate_safely_simply identifier id'>authenticate_safely_simply</span><span class='lparen token'>(</span><span class='user_name identifier id'>user_name</span><span class='comma token'>,</span> <span class='password identifier id'>password</span><span class='rparen token'>)</span>
      <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:first</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:user_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='user_name identifier id'>user_name</span><span class='comma token'>,</span> <span class='symbol val'>:password</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='password identifier id'>password</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
A range may be used in the hash to find documents between two values:
</p>
<pre class="code">
  <span class='Student constant id'>Student</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:grade</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='float val'>9</span><span class='dot2 op'>..</span><span class='integer val'>12</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>
<p>
A startkey or endkey can be used to find documents where the documents
exceed or preceed the value. A key is needed here so CouchFoo knows which
property to apply the startkey to:
</p>
<pre class="code">
  <span class='Student constant id'>Student</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='symbol val'>:use_key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:grade</span><span class='comma token'>,</span> <span class='symbol val'>:startkey</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>80</span><span class='rparen token'>)</span>
</pre>
<p>
Finally an array may be used in the hash to use find records just matching
those values. This operation requires CouchDB &gt; 0.8 though:
</p>
<pre class="code">
  <span class='Student constant id'>Student</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:grade</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='integer val'>9</span><span class='comma token'>,</span><span class='integer val'>11</span><span class='comma token'>,</span><span class='integer val'>12</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>
<h2>Overwriting default accessors</h2>
<p>
All column values are automatically available through basic accessors on
the Active Record object, but sometimes you want to specialize this
behavior. This can be done by overwriting the default accessors (using the
same name as the attribute) and calling <tt>read_attribute(attr_name)</tt>
and <tt>write_attribute(attr_name, value)</tt> to actually change things.
Example:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Song constant id'>Song</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='comment val'># Uses an integer of seconds to hold the length of the song</span>

    <span class='def def kw'>def</span> <span class='length= identifier id'>length=</span><span class='lparen token'>(</span><span class='minutes identifier id'>minutes</span><span class='rparen token'>)</span>
      <span class='write_attribute identifier id'>write_attribute</span><span class='lparen token'>(</span><span class='symbol val'>:length</span><span class='comma token'>,</span> <span class='minutes identifier id'>minutes</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='mult op'>*</span> <span class='integer val'>60</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='def def kw'>def</span> <span class='length identifier id'>length</span>
      <span class='read_attribute identifier id'>read_attribute</span><span class='lparen token'>(</span><span class='symbol val'>:length</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='integer val'>60</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
You can alternatively use <tt>self[:attribute]=(value)</tt> and
<tt>self[:attribute]</tt> instead of <tt>write_attribute(:attribute,
value)</tt> and <tt>read_attribute(:attribute)</tt> as a shorter form.
</p>
<h2>Attribute query methods</h2>
<p>
In addition to the basic accessors, query methods are also automatically
available on the Active Record object. Query methods allow you to test
whether an attribute value is present.
</p>
<p>
For example, an Active Record User with the <tt>name</tt> attribute has a
<tt>name?</tt> method that you can call to determine whether the user has a
name:
</p>
<pre class="code">
  <span class='user identifier id'>user</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;David&quot;</span><span class='rparen token'>)</span>
  <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='name? fid id'>name?</span> <span class='comment val'># =&gt; true</span>

  <span class='anonymous identifier id'>anonymous</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span>
  <span class='anonymous identifier id'>anonymous</span><span class='dot token'>.</span><span class='name? fid id'>name?</span> <span class='comment val'># =&gt; false</span>
</pre>
<h2>Accessing attributes before they have been typecasted</h2>
<p>
Sometimes you want to be able to read the raw attribute data without having
the property typecast run its course first. That can be done by using the
<tt>&lt;attribute&gt;_before_type_cast</tt> accessors that all attributes
have. For example, if your Account model has a <tt>balance</tt> attribute,
you can call <tt>account.balance_before_type_cast</tt> or
<tt>account.id_before_type_cast</tt>.
</p>
<p>
This is especially useful in validation situations where the user might
supply a string for an integer field and you want to display the original
string back in an error message. Accessing the attribute normally would
typecast the string to 0, which isn&#8217;t what you want.
</p>
<h2>Dynamic attribute-based finders</h2>
<p>
Dynamic attribute-based finders are a cleaner way of getting (and/or
creating) objects by simple queries. They work by appending the name of an
attribute to <tt>find_by_</tt> or <tt>find_all_by_</tt>, so you get finders
like <tt>Person.find_by_user_name</tt>,
<tt>Person.find_all_by_last_name</tt>, and
<tt>Payment.find_by_transaction_id</tt>. So instead of writing
<tt>Person.find(:first, :conditions =&gt; {:user_name =&gt;
user_name})</tt>, you just do <tt>Person.find_by_user_name(user_name)</tt>.
And instead of writing <tt>Person.find(:all, :conditions =&gt; <tt>=&amp;gt; last_name</tt>)</tt>, you just do
<tt>Person.find_all_by_last_name(last_name)</tt>.
</p>
<p>
It&#8217;s also possible to use multiple attributes in the same find by
separating them with &quot;<em>and</em>&quot;, so you get finders like
<tt>Person.find_by_user_name_and_password</tt> or even
<tt>Payment.find_by_purchaser_and_state_and_country</tt>. So instead of
writing <tt>Person.find(:first, :conditions =&gt; {:user_name =&gt;
user_name, :password =&gt; password})</tt>, you just do
<tt>Person.find_by_user_name_and_password(user_name, password)</tt>.
</p>
<p>
It&#8217;s even possible to use all the additional parameters to find. For
example, the full interface for <tt>Payment.find_all_by_amount</tt> is
actually <tt>Payment.find_all_by_amount(amount, options)</tt>. And the full
interface to <tt>Person.find_by_user_name</tt> is actually
<tt>Person.find_by_user_name(user_name, options)</tt>. So you could call
<tt>Payment.find_all_by_amount(50, :order =&gt; :created_at)</tt>.
</p>
<p>
The same dynamic finder style can be used to create the object if it
doesn&#8217;t already exist. This dynamic finder is called with
<tt>find_or_create_by_</tt> and will return the object if it already exists
and otherwise creates it, then returns it. Protected attributes won&#8217;t
be set unless they are given in a block. For example:
</p>
<pre class="code">
  <span class='comment val'># No 'Summer' tag exists</span>
  <span class='Tag constant id'>Tag</span><span class='dot token'>.</span><span class='find_or_create_by_name identifier id'>find_or_create_by_name</span><span class='lparen token'>(</span><span class='string val'>&quot;Summer&quot;</span><span class='rparen token'>)</span> <span class='comment val'># equal to Tag.create(:name =&gt; &quot;Summer&quot;)</span>

  <span class='comment val'># Now the 'Summer' tag does exist</span>
  <span class='Tag constant id'>Tag</span><span class='dot token'>.</span><span class='find_or_create_by_name identifier id'>find_or_create_by_name</span><span class='lparen token'>(</span><span class='string val'>&quot;Summer&quot;</span><span class='rparen token'>)</span> <span class='comment val'># equal to Tag.find_by_name(&quot;Summer&quot;)</span>

  <span class='comment val'># Now 'Bob' exist and is an 'admin'</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='find_or_create_by_name identifier id'>find_or_create_by_name</span><span class='lparen token'>(</span><span class='string val'>'Bob'</span><span class='comma token'>,</span> <span class='symbol val'>:age</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>40</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='u identifier id'>u</span><span class='bitor op'>|</span> <span class='u identifier id'>u</span><span class='dot token'>.</span><span class='admin identifier id'>admin</span> <span class='assign token'>=</span> <span class='true true kw'>true</span> <span class='rbrace token'>}</span>
</pre>
<p>
Use the <tt>find_or_initialize_by_</tt> finder if you want to return a new
record without saving it first. Protected attributes won&#8217;t be setted
unless they are given in a block. For example:
</p>
<pre class="code">
  <span class='comment val'># No 'Winter' tag exists</span>
  <span class='winter identifier id'>winter</span> <span class='assign token'>=</span> <span class='Tag constant id'>Tag</span><span class='dot token'>.</span><span class='find_or_initialize_by_name identifier id'>find_or_initialize_by_name</span><span class='lparen token'>(</span><span class='string val'>&quot;Winter&quot;</span><span class='rparen token'>)</span>
  <span class='winter identifier id'>winter</span><span class='dot token'>.</span><span class='new_record? fid id'>new_record?</span> <span class='comment val'># true</span>
</pre>
<p>
To find by a subset of the attributes to be used for instantiating a new
object, pass a hash instead of a list of parameters. For example:
</p>
<pre class="code">
  <span class='Tag constant id'>Tag</span><span class='dot token'>.</span><span class='find_or_create_by_name identifier id'>find_or_create_by_name</span><span class='lparen token'>(</span><span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;rails&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:creator</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='current_user identifier id'>current_user</span><span class='rparen token'>)</span>
</pre>
<p>
That will either find an existing tag named &quot;rails&quot;, or create a
new one while setting the user that created it.
</p>
<h2>Saving arrays, hashes, and other non-mappable objects in text columns</h2>
<p>
CouchFoo will try and serialize any types that are not specified in
properties by calling .to_json on the object This means its not only
possible to store arrays and hashes (with no extra work required) but also
any generic type you care to define, so long as it has a .to_json method
defined. Example:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='User constant id'>User</span> <span class='lt op'>&lt;</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='property identifier id'>property</span> <span class='symbol val'>:name</span><span class='comma token'>,</span> <span class='String constant id'>String</span>
    <span class='property identifier id'>property</span> <span class='symbol val'>:house</span> <span class='comment val'># Can be any object so long as it responds to .to_json</span>
  <span class='end end kw'>end</span>
</pre>
<h2>Inheritance</h2>
<p>
Couch Foo allows inheritance by storing the name of the class in a column
that by default is named &quot;type&quot; (can be changed by overwriting
<tt>Base.inheritance_column</tt>). This means that an inheritance looking
like this:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Company constant id'>Company</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span>
  <span class='class class kw'>class</span> <span class='Firm constant id'>Firm</span> <span class='lt op'>&lt;</span> <span class='Company constant id'>Company</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span>
  <span class='class class kw'>class</span> <span class='Client constant id'>Client</span> <span class='lt op'>&lt;</span> <span class='Company constant id'>Company</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span>
  <span class='class class kw'>class</span> <span class='PriorityClient constant id'>PriorityClient</span> <span class='lt op'>&lt;</span> <span class='Client constant id'>Client</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span>
</pre>
<p>
When you do <tt>Firm.create(:name =&gt; &quot;37signals&quot;)</tt>, this
record will be saved in the companies table with type = &quot;Firm&quot;.
You can then fetch this row again using <tt>Company.find(:first, <tt>=&amp;gt; &amp;quot;37signals&amp;quot;</tt>)</tt> and it will return a Firm object.
</p>
<p>
If you don&#8217;t have a type column defined in your table, inheritance
won&#8217;t be triggered. In that case, it&#8217;ll work just like normal
subclasses with no special magic for differentiating between them or
reloading the right type with find.
</p>
<h2>Connection to multiple databases in different models</h2>
<p>
Connections are usually created through CouchFoo::Base.set_database and
retrieved by CouchFoo::Base.database All classes inheriting from
CouchFoo::Base will use this connection. But you can also set a
class-specific connection. For example, if Course is an CouchFoo::Base, but
resides in a different database, you can just say <tt>Course.set_database
url</tt> and Course and all of its subclasses will use this connection
instead.
</p>
<h2>Performance</h2>
<p>
CouchDB operates via a RESTful interface and so isn&#8217;t as efficient as
a local database when running over a local socket. This is due to the
TCP/IP overhead. But given any serious application runs a separate database
and application server then it is unfair to judge CouchDB on this alone.
</p>
<p>
Generally speaking CouchDB performs as well as or better than relational
databases when it already has the document in memory. If it doesn&#8217;t
it performs worse as it must first find the document and submit the new
version (as there&#8217;s no structure to documents it can&#8217;t update
fields on an add-hoc basis, it must have the whole document). This makes
class operations such as update_all less efficient. If your application is
high load and uses these excessively you may wish to consider other
databases. On the flip side if you have lots of documents in memory and
wish to update them all, using bulk_save is an excellent way to make
performance gains.
</p>
<p>
Below is a list of operations where the performance differs from
ActiveRecord. More notes are available in the functions themselves:
</p>
<ul>
<li>class.find - when using list of ids is O(n) rather than O(1) if not on
CouchDB 0.9

</li>
<li>class.create - O(1) rather than O(n) if using bulk_save

</li>
<li>class.delete - O(n) rather than O(1) so less efficient for &gt; 1 document

</li>
<li>class.update_all - O(n+1) rather than O(1)

</li>
<li>class.delete_all - O(2n) rather than O(1)

</li>
<li>class.update_counters - O(2) rather than O(1)

</li>
<li>class.increment_counter - O(2) rather than O(1)

</li>
<li>class.decrement_counter - O(2) rather than O(1)

</li>
<li>save, save!, update_attribute, update_attributes, update_attributes!,
increment!, decrement!,

</li>
</ul>
<p>
toggle! - if using bulk_save then O(1) rather than O(n)
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Class Attributes</h2>
      <table>
      
        <tr>
          <th class="name">abstract_class</td>
          <td class="readwrite">
            [<span id='abstract_class-class_method'>R</span><span id='abstract_class=-class_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Set this to true if this is an abstract class (see
<tt>abstract_class?</tt>).
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="VALID_FIND_OPTIONS-constant">VALID_FIND_OPTIONS</dt>
      <dd>[ :conditions, :include, :limit, :count, :order, :readonly, :offset, :use_key,
:view_type, :startkey, :endkey, :return_json, :descending, :group, :group_level, 
:include_docs, :skip, :startkey_docid, :endkey_docid, :keys]</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(attributes = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
New objects can be instantiated as either empty (pass no construction
parameter) or pre-set with attributes but not yet saved (pass a hash with
key names matching the associated property names). In both instances, valid
attribute keys are determined by the property names of the model &#8212;
hence you can&#8217;t have attributes that aren&#8217;t part of the model.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1632</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1632">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1632
1633
1634
1635
1636
1637
1638
1639
1640
1641
1642</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='@attributes ivar id'>@attributes</span> <span class='assign token'>=</span> <span class='attributes_from_property_definitions identifier id'>attributes_from_property_definitions</span>
  <span class='@attributes_cache ivar id'>@attributes_cache</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@new_record ivar id'>@new_record</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='ensure_proper_type identifier id'>ensure_proper_type</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='attributes identifier id'>attributes</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='symbol val'>:scope</span><span class='comma token'>,</span> <span class='symbol val'>:create</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='att identifier id'>att</span><span class='comma token'>,</span><span class='value identifier id'>value</span><span class='bitor op'>|</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{att}=&quot;</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span> <span class='if if_mod kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='symbol val'>:scoped?</span><span class='comma token'>,</span> <span class='symbol val'>:create</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='yield yield kw'>yield</span> <span class='self self kw'>self</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
  <span class='callback identifier id'>callback</span><span class='lparen token'>(</span><span class='symbol val'>:after_initialize</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='respond_to_without_attributes? fid id'>respond_to_without_attributes?</span><span class='lparen token'>(</span><span class='symbol val'>:after_initialize</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#-3D-3D-3D-class_method">===</span><span class='args'>(object)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Overwrite the default class equality method to provide support for
association proxies.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#abstract_class-3F-class_method">abstract_class?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns whether this class is a base CouchFoo class.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#accessible_attributes-class_method">accessible_attributes</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array of all the attributes that have been made accessible to
mass-assignment.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#all-class_method">all</span><span class='args'>(*args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
This is an alias for find(:all).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attr_accessible-class_method">attr_accessible</span><span class='args'>(*attributes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Specifies a white list of model attributes that can be set via
mass-assignment, such as <tt>new(attributes)</tt>,
<tt>update_attributes(attributes)</tt>, or
<tt>attributes=(attributes)</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attr_protected-class_method">attr_protected</span><span class='args'>(*attributes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Attributes named in this macro are protected from mass-assignment, such as
<tt>new(attributes)</tt>, <tt>update_attributes(attributes)</tt>, or
<tt>attributes=(attributes)</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attr_readonly-class_method">attr_readonly</span><span class='args'>(*attributes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Attributes listed as readonly can be set for a new record, but will be
ignored in database updates afterwards.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#base_class-class_method">base_class</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the base subclass that this class descends from.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#benchmark-class_method">benchmark</span><span class='args'>(title, log_level = Logger::DEBUG, use_silence = true)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Log and benchmark multiple statements in a single block.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#create-class_method">create</span><span class='args'>(attributes = nil, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Creates an object (or multiple objects) and saves it to the database, if
validations pass.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#decrement_counter-class_method">decrement_counter</span><span class='args'>(counter_name, id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Decrement a number field by one, usually representing a count.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#default_sort-class_method">default_sort</span><span class='args'>(property)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sets an order which all queries to this model will be sorted by unless
overriden in the finder This is useful for setting a created_at sort field
by default so results are automatically sorted in the order they were added
to the database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#default_sort_order-class_method">default_sort_order</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete-class_method">delete</span><span class='args'>(id, rev)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Delete an object (or multiple objects) where the _id and _rev given match
the record.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_all-class_method">delete_all</span><span class='args'>(conditions = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Currently there is no way to do selective delete in CouchDB so this simply
defers to CouchFoo#destroy_all for API compatability with ActiveRecord.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#descends_from_couch_foo-3F-class_method">descends_from_couch_foo?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
True if this isn&#8217;t a concrete subclass needing a inheritence type
condition.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#destroy-class_method">destroy</span><span class='args'>(id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Destroy an object (or multiple objects) that has the given id.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#destroy_all-class_method">destroy_all</span><span class='args'>(conditions = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Destroys the records matching <tt>conditions</tt> by instantiating each
record and calling the destroy method.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#document_class_name-class_method">document_class_name</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Guesses the document name (in forced lower-case) based on the name of the
class in the inheritance hierarchy descending directly from CouchFoo::Base.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#exists-3F-class_method">exists?</span><span class='args'>(id_or_conditions)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Checks whether a document exists in the database that matches conditions
given.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#find-class_method">find</span><span class='args'>(*args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
CouchDB has a concept called views which show a subset of documents in the
database subject to criteria.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#first-class_method">first</span><span class='args'>(*args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A convenience wrapper for <tt>find(:first, *args)</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_uuid-class_method">get_uuid</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a unique UUID even across multiple machines.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#increment_counter-class_method">increment_counter</span><span class='args'>(counter_name, id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Increment a number field by one, usually representing a count.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#inheritance_column-class_method">inheritance_column</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Defines the propety name for use with single table inheritance &#8212; can
be set in subclasses like so: self.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#inspect-class_method">inspect</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#last-class_method">last</span><span class='args'>(*args)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A convenience wrapper for <tt>find(:last, *args)</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#properties-class_method">properties</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns all properties defined on this class.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#property-class_method">property</span><span class='args'>(name, type = Object, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set a property for the document.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#property_names-class_method">property_names</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array of property names.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#property_types-class_method">property_types</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a hash of property name to types.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#protected_attributes-class_method">protected_attributes</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array of all the attributes that have been protected from
mass-assignment.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#readonly_attributes-class_method">readonly_attributes</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array of all the attributes that have been specified as
readonly.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reset_document_class_name-class_method">reset_document_class_name</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reset_property_information-class_method">reset_property_information</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Resets all the cached information about properties, which will cause them
to be reloaded on the next request.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#respond_to-3F-class_method">respond_to?</span><span class='args'>(method_id, include_private = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#set_document_class_name-class_method">set_document_class_name</span><span class='args'>(value = nil, &amp;block)</span>
        <span class='block'></span>
        
          <span class='alias'>document_class_name=</span>
        
      </th>
      <td class="docstring">
        <p>
Sets the document class name to use to the given value, or (if the value is
nil or false) to the value returned by the given block.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#set_inheritance_column-class_method">set_inheritance_column</span><span class='args'>(value = nil, &amp;block)</span>
        <span class='block'></span>
        
          <span class='alias'>inheritance_column=</span>
        
      </th>
      <td class="docstring">
        <p>
Sets the name of the inheritance column to use to the given value, or (if
the value # is nil or false) to the value returned by the given block.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#silence-class_method">silence</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Silences the logger for the duration of the block.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#update-class_method">update</span><span class='args'>(id, attributes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Updates an object (or multiple objects) and saves it to the database, if
validations pass.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#update_all-class_method">update_all</span><span class='args'>(updates, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Updates all records with details given if they match a set of conditions
supplied.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#update_counters-class_method">update_counters</span><span class='args'>(id, counters)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
A generic &quot;counter updater&quot; implementation, intended primarily to
be used by increment_counter and decrement_counter, but which may also be
useful on its own.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#view-class_method">view</span><span class='args'>(name, map_function, reduce_function = nil, standard_options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a view and return the documents associated with that view.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#view_names-class_method">view_names</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#views-class_method">views</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#-3D-3D-instance_method">#==</span><span class='args'>(comparison_object)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if the <tt>comparison_object</tt> is the same object, or is of
the same type and has the same id.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#-5B-5D-instance_method">#[]</span><span class='args'>(attr_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the value of the attribute identified by <tt>attr_name</tt> after
it has been typecast (for example, &quot;2004-12-12&quot; in a data
property is cast to a date object, like Date.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#-5B-5D-3D-instance_method">#[]=</span><span class='args'>(attr_name, value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Updates the attribute identified by <tt>attr_name</tt> with the specified
<tt>value</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_id-instance_method">#_id</span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#id</span>
        
      </th>
      <td class="docstring">
        <p>
Returns the unqiue id of the document.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_rev-instance_method">#_rev</span><span class='args'></span>
        <span class='block'></span>
        
          <span class='alias'>#rev</span>
        
      </th>
      <td class="docstring">
        <p>
Returns the revision id of the document.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attribute_for_inspect-instance_method">#attribute_for_inspect</span><span class='args'>(attr_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Format attributes nicely for inspect.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attribute_names-instance_method">#attribute_names</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an array of names for the attributes available on this object
sorted alphabetically.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attribute_present-3F-instance_method">#attribute_present?</span><span class='args'>(attribute)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if the specified <tt>attribute</tt> has been set by the user
or by a database load and is neither nil nor empty? (the latter only
applies to objects that respond to empty?, most notably Strings).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attributes-instance_method">#attributes</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a hash of all the attributes with their names as keys and the
values of the attributes as values.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attributes-3D-instance_method">#attributes=</span><span class='args'>(new_attributes, guard_protected_attributes = true)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Allows you to set all the attributes at once by passing in a hash with keys
matching the attribute names (which again matches the property names).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attributes_before_type_cast-instance_method">#attributes_before_type_cast</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns a hash of attributes before typecasting and deserialization.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#becomes-instance_method">#becomes</span><span class='args'>(klass)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns an instance of the specified <tt>klass</tt> with the attributes of
the current record.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#clone-instance_method">#clone</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#decrement-instance_method">#decrement</span><span class='args'>(attribute, by = 1)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Initializes <tt>attribute</tt> to zero if <tt>nil</tt> and subtracts the
value passed as <tt>by</tt> (default is 1).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#decrement-21-instance_method">#decrement!</span><span class='args'>(attribute, by = 1)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Wrapper around <tt>decrement</tt> that saves the record.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#destroy-instance_method">#destroy</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#eql-3F-instance_method">#eql?</span><span class='args'>(comparison_object)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Delegates to ==.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#freeze-instance_method">#freeze</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Freeze the attributes hash such that associations are still accessible,
even on destroyed records.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#frozen-3F-instance_method">#frozen?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns <tt>true</tt> if the attributes hash has been frozen.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_attribute-3F-instance_method">#has_attribute?</span><span class='args'>(attr_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if the given attribute is in the attributes hash.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#hash-instance_method">#hash</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Delegates to id in order to allow two records of the same type and id to
work with something like:
</p>
<pre class="code">
  <span class='lbrack token'>[</span> <span class='Person constant id'>Person</span><span class='dot token'>.</span>
</pre>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#increment-instance_method">#increment</span><span class='args'>(attribute, by = 1)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Initializes <tt>attribute</tt> to zero if <tt>nil</tt> and adds the value
passed as <tt>by</tt> (default is 1).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#increment-21-instance_method">#increment!</span><span class='args'>(attribute, by = 1)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Wrapper around <tt>increment</tt> that saves the record.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#inspect-instance_method">#inspect</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the contents of the record as a nicely formatted string.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#new_record-3F-instance_method">#new_record?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns true if this object hasn&#8217;t been saved yet &#8212; that is, a
record for the object doesn&#8217;t exist yet.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#readonly-21-instance_method">#readonly!</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Marks this record as read only.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#readonly-3F-instance_method">#readonly?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns <tt>true</tt> if the record is read only.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reload-instance_method">#reload</span><span class='args'>(options = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Reloads the attributes of this object from the database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ruby_class-instance_method">#ruby_class</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the ruby_class of the document, as stored in the document to know
which ruby object to map back to.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#save-instance_method">#save</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <ul>
<li>No record exists: Creates a new record with values matching those of the
object attributes.

</li>
</ul>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#save-21-instance_method">#save!</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Attempts to save the record, but instead of just returning false if it
couldn&#8217;t happen, it raises a DocumentNotSaved exception.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_param-instance_method">#to_param</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Enables Couch Foo objects to be used as URL parameters in Action Pack
automatically.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#toggle-instance_method">#toggle</span><span class='args'>(attribute)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Assigns to <tt>attribute</tt> the boolean opposite of <tt>attribute?</tt>.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#toggle-21-instance_method">#toggle!</span><span class='args'>(attribute)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Wrapper around <tt>toggle</tt> that saves the record.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#update_attribute-instance_method">#update_attribute</span><span class='args'>(name, value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Updates a single attribute and saves the record.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#update_attributes-instance_method">#update_attributes</span><span class='args'>(attributes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Updates all the attributes from the passed-in Hash and saves the record.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#update_attributes-21-instance_method">#update_attributes!</span><span class='args'>(attributes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Updates an object just like Base.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>===</h3>
</div><div id="-3D-3D-3D-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>===</span><span class='args'>(object)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Overwrite the default class equality method to provide support for
association proxies.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1203</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1203">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1203
1204
1205</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='eqq op'>===</span><span class='lparen token'>(</span><span class='object identifier id'>object</span><span class='rparen token'>)</span>
  <span class='object identifier id'>object</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>abstract_class?</h3>
</div><div id="abstract_class-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>abstract_class?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns whether this class is a base CouchFoo class. If A is a base class
and B descends from A, then B.base_class will return B.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1219</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1219">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1219
1220
1221</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='abstract_class? fid id'>abstract_class?</span>
  <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='@abstract_class ivar id'>@abstract_class</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='@abstract_class ivar id'>@abstract_class</span> <span class='eq op'>==</span> <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>accessible_attributes</h3>
</div><div id="accessible_attributes-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>accessible_attributes</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array of all the attributes that have been made accessible to
mass-assignment.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 951</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L951">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">951
952
953</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='accessible_attributes identifier id'>accessible_attributes</span> 
  <span class='read_inheritable_attribute identifier id'>read_inheritable_attribute</span><span class='lparen token'>(</span><span class='string val'>&quot;attr_accessible&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>all</h3>
</div><div id="all-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>all</span><span class='args'>(*args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
This is an alias for find(:all). You can pass in all the same arguments to
this method as you can to find(:all)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 647</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L647">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">647
648
649</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='all identifier id'>all</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attr_accessible</h3>
</div><div id="attr_accessible-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attr_accessible</span><span class='args'>(*attributes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Specifies a white list of model attributes that can be set via
mass-assignment, such as <tt>new(attributes)</tt>,
<tt>update_attributes(attributes)</tt>, or <tt>attributes=(attributes)</tt>
</p>
<p>
This is the opposite of the <tt>attr_protected</tt> macro: Mass-assignment
will only set attributes in this list, to assign to the rest of attributes
you can use direct writer methods. This is meant to protect sensitive
attributes from being overwritten by malicious users tampering with URLs or
forms. If you&#8217;d rather start from an all-open default and restrict
attributes as needed, have a look at <tt>attr_protected</tt>.
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Customer constant id'>Customer</span> <span class='lt op'>&lt;</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='attr_accessible identifier id'>attr_accessible</span> <span class='symbol val'>:name</span><span class='comma token'>,</span> <span class='symbol val'>:nickname</span>
  <span class='end end kw'>end</span>

  <span class='customer identifier id'>customer</span> <span class='assign token'>=</span> <span class='Customer constant id'>Customer</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;David&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:nickname</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Dave&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:credit_rating</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Excellent&quot;</span><span class='rparen token'>)</span>
  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='credit_rating identifier id'>credit_rating</span> <span class='comment val'># =&gt; nil</span>
  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Jolly fellow&quot;</span><span class='comma token'>,</span> <span class='symbol val'>:credit_rating</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Superb&quot;</span> <span class='rbrace token'>}</span>
  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='credit_rating identifier id'>credit_rating</span> <span class='comment val'># =&gt; nil</span>

  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='credit_rating identifier id'>credit_rating</span> <span class='assign token'>=</span> <span class='string val'>&quot;Average&quot;</span>
  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='credit_rating identifier id'>credit_rating</span> <span class='comment val'># =&gt; &quot;Average&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 946</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L946">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">946
947
948</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attr_accessible identifier id'>attr_accessible</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
  <span class='write_inheritable_attribute identifier id'>write_inheritable_attribute</span><span class='lparen token'>(</span><span class='string val'>&quot;attr_accessible&quot;</span><span class='comma token'>,</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='symbol val'>:to_s</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='accessible_attributes identifier id'>accessible_attributes</span> <span class='orop op'>||</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attr_protected</h3>
</div><div id="attr_protected-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attr_protected</span><span class='args'>(*attributes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Attributes named in this macro are protected from mass-assignment, such as
<tt>new(attributes)</tt>, <tt>update_attributes(attributes)</tt>, or
<tt>attributes=(attributes)</tt>.
</p>
<p>
Mass-assignment to these attributes will simply be ignored, to assign to
them you can use direct writer methods. This is meant to protect sensitive
attributes from being overwritten by malicious users tampering with URLs or
forms.
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Customer constant id'>Customer</span> <span class='lt op'>&lt;</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='attr_protected identifier id'>attr_protected</span> <span class='symbol val'>:credit_rating</span>
  <span class='end end kw'>end</span>

  <span class='customer identifier id'>customer</span> <span class='assign token'>=</span> <span class='Customer constant id'>Customer</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;name&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='David constant id'>David</span><span class='comma token'>,</span> <span class='string val'>&quot;credit_rating&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Excellent&quot;</span><span class='rparen token'>)</span>
  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='credit_rating identifier id'>credit_rating</span> <span class='comment val'># =&gt; nil</span>
  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;description&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Jolly fellow&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;credit_rating&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Superb&quot;</span> <span class='rbrace token'>}</span>
  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='credit_rating identifier id'>credit_rating</span> <span class='comment val'># =&gt; nil</span>

  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='credit_rating identifier id'>credit_rating</span> <span class='assign token'>=</span> <span class='string val'>&quot;Average&quot;</span>
  <span class='customer identifier id'>customer</span><span class='dot token'>.</span><span class='credit_rating identifier id'>credit_rating</span> <span class='comment val'># =&gt; &quot;Average&quot;</span>
</pre>
<p>
To start from an all-closed default and enable attributes as needed, have a
look at <tt>attr_accessible</tt>.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 913</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L913">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">913
914
915</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attr_protected identifier id'>attr_protected</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
  <span class='write_inheritable_attribute identifier id'>write_inheritable_attribute</span><span class='lparen token'>(</span><span class='string val'>&quot;attr_protected&quot;</span><span class='comma token'>,</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='symbol val'>:to_s</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='protected_attributes identifier id'>protected_attributes</span> <span class='orop op'>||</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attr_readonly</h3>
</div><div id="attr_readonly-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attr_readonly</span><span class='args'>(*attributes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Attributes listed as readonly can be set for a new record, but will be
ignored in database updates afterwards
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 957</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L957">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">957
958
959</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attr_readonly identifier id'>attr_readonly</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
  <span class='write_inheritable_attribute identifier id'>write_inheritable_attribute</span><span class='lparen token'>(</span><span class='string val'>&quot;attr_readonly&quot;</span><span class='comma token'>,</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='symbol val'>:to_s</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='readonly_attributes identifier id'>readonly_attributes</span> <span class='orop op'>||</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>base_class</h3>
</div><div id="base_class-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>base_class</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the base subclass that this class descends from. If A extends
CouchFoo::Base, A.base_class will return A. If B descends from A through
some arbitrarily deep hierarchy, B.base_class will return A.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1210</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1210">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1210
1211
1212</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='base_class identifier id'>base_class</span>
  <span class='class_of_active_record_descendant identifier id'>class_of_active_record_descendant</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>benchmark</h3>
</div><div id="benchmark-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>benchmark</span><span class='args'>(title, log_level = Logger::DEBUG, use_silence = true)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Log and benchmark multiple statements in a single block. Example:
</p>
<pre class="code">
  <span class='Project constant id'>Project</span><span class='dot token'>.</span><span class='benchmark identifier id'>benchmark</span><span class='lparen token'>(</span><span class='string val'>&quot;Creating project&quot;</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='project identifier id'>project</span> <span class='assign token'>=</span> <span class='Project constant id'>Project</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='string val'>&quot;name&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;stuff&quot;</span><span class='rparen token'>)</span>
    <span class='project identifier id'>project</span><span class='dot token'>.</span><span class='create_manager identifier id'>create_manager</span><span class='lparen token'>(</span><span class='string val'>&quot;name&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;David&quot;</span><span class='rparen token'>)</span>
    <span class='project identifier id'>project</span><span class='dot token'>.</span><span class='milestones identifier id'>milestones</span> <span class='lshft op'>&lt;&lt;</span> <span class='Milestone constant id'>Milestone</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
</pre>
<p>
The benchmark is only recorded if the current level of the logger is less
than or equal to the <tt>log_level</tt>, which makes it easy to include
benchmarking statements in production software that will remain inexpensive
because the benchmark will only be conducted if the log level is low
enough.
</p>
<p>
The logging of the multiple statements is turned off unless
<tt>use_silence</tt> is set to false.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1183</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1183">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1183
1184
1185
1186
1187
1188
1189
1190
1191
1192</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='benchmark identifier id'>benchmark</span><span class='lparen token'>(</span><span class='title identifier id'>title</span><span class='comma token'>,</span> <span class='log_level identifier id'>log_level</span> <span class='assign token'>=</span> <span class='Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='DEBUG constant id'>DEBUG</span><span class='comma token'>,</span> <span class='use_silence identifier id'>use_silence</span> <span class='assign token'>=</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='logger identifier id'>logger</span> <span class='andop op'>&amp;&amp;</span> <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='level identifier id'>level</span> <span class='leq op'>&lt;=</span> <span class='log_level identifier id'>log_level</span>
    <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
    <span class='seconds identifier id'>seconds</span> <span class='assign token'>=</span> <span class='Benchmark constant id'>Benchmark</span><span class='dot token'>.</span><span class='realtime identifier id'>realtime</span> <span class='lbrace token'>{</span> <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='use_silence identifier id'>use_silence</span> <span class='integer val'>? </span><span class='silence identifier id'>silence</span> <span class='lbrace token'>{</span> <span class='yield yield kw'>yield</span> <span class='rbrace token'>}</span> <span class='colon op'>:</span> <span class='yield yield kw'>yield</span> <span class='rbrace token'>}</span>
    <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='log_level identifier id'>log_level</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{title} (#{'%.5f' % seconds})&quot;</span><span class='rparen token'>)</span>
    <span class='result identifier id'>result</span>
  <span class='else else kw'>else</span>
    <span class='yield yield kw'>yield</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>create</h3>
</div><div id="create-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create</span><span class='args'>(attributes = nil, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Creates an object (or multiple objects) and saves it to the database, if
validations pass. The resulting object is returned whether the object was
saved successfully to the database or not.
</p>
<p>
The <tt>attributes</tt> parameter can be either be a Hash or an Array of
Hashes. These Hashes describe the attributes on the objects that are to be
created.
</p>
<p>
If using bulk save this operation is O(1) rather than O(n) so much more
efficient
</p>
<h4>Examples</h4>
<pre class="code">
  <span class='comment val'># Create a single new object</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='symbol val'>:first_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Jamie'</span><span class='rparen token'>)</span>

  <span class='comment val'># Create an Array of new objects</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='lbrace token'>{</span> <span class='symbol val'>:first_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Jamie'</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='symbol val'>:first_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Jeremy'</span> <span class='rbrace token'>}</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='comment val'># Create a single object and pass it into a block to set other attributes.</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='symbol val'>:first_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Jamie'</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='u identifier id'>u</span><span class='bitor op'>|</span>
    <span class='u identifier id'>u</span><span class='dot token'>.</span><span class='is_admin identifier id'>is_admin</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Creating an Array of new objects using a block, where the block is executed for each object:</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='lbrace token'>{</span> <span class='symbol val'>:first_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Jamie'</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='symbol val'>:first_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Jeremy'</span> <span class='rbrace token'>}</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='u identifier id'>u</span><span class='bitor op'>|</span>
    <span class='u identifier id'>u</span><span class='dot token'>.</span><span class='is_admin identifier id'>is_admin</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 689</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L689">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">689
690
691
692
693
694
695
696
697
698</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='attr identifier id'>attr</span><span class='bitor op'>|</span> <span class='create identifier id'>create</span><span class='lparen token'>(</span><span class='attr identifier id'>attr</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='object identifier id'>object</span> <span class='assign token'>=</span> <span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
    <span class='yield yield kw'>yield</span><span class='lparen token'>(</span><span class='object identifier id'>object</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
    <span class='object identifier id'>object</span><span class='dot token'>.</span><span class='save identifier id'>save</span>
    <span class='object identifier id'>object</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>decrement_counter</h3>
</div><div id="decrement_counter-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>decrement_counter</span><span class='args'>(counter_name, id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Decrement a number field by one, usually representing a count. This works
the same as increment_counter but reduces the property value by 1 instead
of increasing it. Unlike ActiveRecord this does not update the database
directly but has to first find the record. Therefore updates are O(2)
rather than O(1)
</p>
<h4>Attributes</h4>
<ul>
<li><tt>counter_name</tt> - The name of the field that should be decremented.

</li>
<li><tt>id</tt> - The id of the object that should be decremented.

</li>
</ul>
<h4>Examples</h4>
<pre class="code">
  <span class='comment val'># Decrement the post_count property for the record with an id of 'aef343ab2'</span>
  <span class='DiscussionBoard constant id'>DiscussionBoard</span><span class='dot token'>.</span><span class='decrement_counter identifier id'>decrement_counter</span><span class='lparen token'>(</span><span class='symbol val'>:post_count</span><span class='comma token'>,</span> <span class='string val'>'aef343ab2'</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 885</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L885">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">885
886
887</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='decrement_counter identifier id'>decrement_counter</span><span class='lparen token'>(</span><span class='counter_name identifier id'>counter_name</span><span class='comma token'>,</span> <span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='update_counters identifier id'>update_counters</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='lbrace token'>{</span><span class='counter_name identifier id'>counter_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>-1</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>default_sort</h3>
</div><div id="default_sort-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>default_sort</span><span class='args'>(property)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sets an order which all queries to this model will be sorted by unless
overriden in the finder This is useful for setting a created_at sort field
by default so results are automatically sorted in the order they were added
to the database. NOTE - this sorts after the results are returned so will
not give expected behaviour when using limits or find(:first), find(:last)
For example, class User &lt; CouchFoo::Base
</p>
<pre class="code">
  <span class='property identifier id'>property</span> <span class='symbol val'>:name</span><span class='comma token'>,</span> <span class='String constant id'>String</span>
  <span class='property identifier id'>property</span> <span class='symbol val'>:created_at</span><span class='comma token'>,</span> <span class='DateTime constant id'>DateTime</span>
  <span class='default_sort identifier id'>default_sort</span> <span class='symbol val'>:created_at</span>
</pre>
<p>
end
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1117</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1117">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1117
1118
1119</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='default_sort identifier id'>default_sort</span><span class='lparen token'>(</span><span class='property identifier id'>property</span><span class='rparen token'>)</span>
  <span class='@default_sort_order ivar id'>@default_sort_order</span> <span class='assign token'>=</span> <span class='property identifier id'>property</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>default_sort_order</h3>
</div><div id="default_sort_order-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>default_sort_order</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1121</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1121">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1121
1122
1123</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='default_sort_order identifier id'>default_sort_order</span>
  <span class='@default_sort_order ivar id'>@default_sort_order</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete</h3>
</div><div id="delete-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete</span><span class='args'>(id, rev)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Delete an object (or multiple objects) where the _id and _rev given match
the record. No callbacks are fired off executing so this is an efficient
method of deleting documents that don&#8217;t need cleaning up after or
other actions to be taken.
</p>
<p>
This operations is O(n) compared to O(1) so is less efficient than
ActiveRecord when deleting more than one document
</p>
<p>
Objects are <em>not</em> instantiated with this method.
</p>
<h4>Attributes</h4>
<ul>
<li><tt>id</tt> - Can be either a String or an Array of Strings.

</li>
</ul>
<h4>Examples</h4>
<pre class="code">
  <span class='comment val'># Delete a single object</span>
  <span class='Todo constant id'>Todo</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>'6180e9a0-cdca-012b-14a5-001a921a2bec'</span><span class='comma token'>,</span> <span class='string val'>'12345678'</span><span class='rparen token'>)</span>

  <span class='comment val'># Delete multiple objects</span>
  <span class='ids identifier id'>ids</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>'6180e9a0-cdca-012b-14a5-001a921a2bec'</span><span class='comma token'>,</span> <span class='string val'>'e6f6a870-cdc9-012b-14a3-001a921a2bec'</span><span class='rbrack token'>]</span>
  <span class='revs identifier id'>revs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='string val'>'12345678'</span><span class='comma token'>,</span> <span class='string val'>'12345679'</span><span class='rbrack token'>]</span>
  <span class='Todo constant id'>Todo</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='ids identifier id'>ids</span><span class='comma token'>,</span> <span class='revs identifier id'>revs</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 749</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L749">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">749
750
751
752
753
754
755
756
757</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='rev identifier id'>rev</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='idx identifier id'>idx</span> <span class='assign token'>=</span> <span class='integer val'>-1</span>
    <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span> <span class='idx identifier id'>idx</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span><span class='semicolon token'>;</span> <span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='i identifier id'>i</span><span class='comma token'>,</span> <span class='rev identifier id'>rev</span><span class='lbrack token'>[</span><span class='idx identifier id'>idx</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='database identifier id'>database</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='string val'>&quot;_id&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='string val'>&quot;_rev&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rev identifier id'>rev</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_all</h3>
</div><div id="delete_all-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_all</span><span class='args'>(conditions = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Currently there is no way to do selective delete in CouchDB so this simply
defers to CouchFoo#destroy_all for API compatability with ActiveRecord
</p>
<p>
This operations is O(2n) compared to O(1) so much less efficient than
ActiveRecord
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 825</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L825">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">825
826
827</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_all identifier id'>delete_all</span><span class='lparen token'>(</span><span class='conditions identifier id'>conditions</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='destroy_all identifier id'>destroy_all</span><span class='lparen token'>(</span><span class='conditions identifier id'>conditions</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>descends_from_couch_foo?</h3>
</div><div id="descends_from_couch_foo-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>descends_from_couch_foo?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
True if this isn&#8217;t a concrete subclass needing a inheritence type
condition.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1099</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1099">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1099
1100
1101
1102
1103
1104
1105</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='descends_from_couch_foo? fid id'>descends_from_couch_foo?</span>
  <span class='if if kw'>if</span> <span class='superclass identifier id'>superclass</span><span class='dot token'>.</span><span class='abstract_class? fid id'>abstract_class?</span>
    <span class='superclass identifier id'>superclass</span><span class='dot token'>.</span><span class='descends_from_couch_foo? fid id'>descends_from_couch_foo?</span>
  <span class='else else kw'>else</span>
    <span class='superclass identifier id'>superclass</span> <span class='eq op'>==</span> <span class='Base constant id'>Base</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>destroy</h3>
</div><div id="destroy-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>destroy</span><span class='args'>(id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Destroy an object (or multiple objects) that has the given id. Unlike
delete this doesn&#8217;t require a _rev as the object if found, created
from the attributes and then destroyed. As such all callbacks and filters
are fired off before the object is deleted. This method is the same in
efficiency terms as CouchFoo#delete unlike in ActiveRecord where delete is
more efficient
</p>
<h4>Examples</h4>
<pre class="code">
  <span class='comment val'># Destroy a single object</span>
  <span class='Todo constant id'>Todo</span><span class='dot token'>.</span><span class='destroy identifier id'>destroy</span><span class='lparen token'>(</span><span class='string val'>'6180e9a0-cdca-012b-14a5-001a921a2bec'</span><span class='rparen token'>)</span>

  <span class='comment val'># Destroy multiple objects</span>
  <span class='Todo constant id'>Todo</span><span class='dot token'>.</span><span class='destroy identifier id'>destroy</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='string val'>'6180e9a0-cdca-012b-14a5-001a921a2bec'</span><span class='comma token'>,</span> <span class='string val'>'e6f6a870-cdc9-012b-14a3-001a921a2bec'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 772</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L772">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">772
773
774
775
776
777
778</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='destroy identifier id'>destroy</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='one_id identifier id'>one_id</span><span class='bitor op'>|</span> <span class='destroy identifier id'>destroy</span><span class='lparen token'>(</span><span class='one_id identifier id'>one_id</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='destroy identifier id'>destroy</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>destroy_all</h3>
</div><div id="destroy_all-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>destroy_all</span><span class='args'>(conditions = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Destroys the records matching <tt>conditions</tt> by instantiating each
record and calling the destroy method. This means at least 2*N database
queries to destroy N records, so avoid destroy_all if you are deleting many
records. If you want to simply delete records without worrying about
dependent associations or callbacks, use the much faster
<tt>delete_all</tt> method instead.
</p>
<h4>Attributes</h4>
<ul>
<li><tt>conditions</tt> - Conditions are specified the same way as with
<tt>find</tt> method.

</li>
</ul>
<h4>Example</h4>
<pre class="code">
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='destroy_all identifier id'>destroy_all</span> <span class='string val'>&quot;last_login &lt; '2004-04-04'&quot;</span>
</pre>
<p>
This loads and destroys each person one by one, including its dependent
associations and before_ and after_destroy callbacks.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 817</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L817">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">817
818
819</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='destroy_all identifier id'>destroy_all</span><span class='lparen token'>(</span><span class='conditions identifier id'>conditions</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='conditions identifier id'>conditions</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='object identifier id'>object</span><span class='bitor op'>|</span> <span class='object identifier id'>object</span><span class='dot token'>.</span><span class='destroy identifier id'>destroy</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>document_class_name</h3>
</div><div id="document_class_name-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>document_class_name</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Guesses the document name (in forced lower-case) based on the name of the
class in the inheritance hierarchy descending directly from CouchFoo::Base.
So if the hierarchy looks like: Reply &lt; Message &lt; CouchFoo::Base,
then Reply is used as the document name. The rules used to do the guess are
handled by the Inflector class in Active Support, which knows almost all
common English inflections. You can add new inflections in
config/initializers/inflections.rb.
</p>
<p>
Nested classes and enclosing modules are not considered.
</p>
<h4>Example</h4>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Invoice constant id'>Invoice</span> <span class='lt op'>&lt;</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span><span class='semicolon token'>;</span>
  <span class='file identifier id'>file</span>                  <span class='class class kw'>class</span>               <span class='document_name identifier id'>document_name</span>
  <span class='invoice identifier id'>invoice</span><span class='dot token'>.</span><span class='rb identifier id'>rb</span>            <span class='Invoice constant id'>Invoice</span>             <span class='invoice identifier id'>invoice</span>
</pre>
<p>
Additionally, the class-level <tt>document_name_prefix</tt> is prepended
and the <tt>document_name_suffix</tt> is appended. So if you have
&quot;myapp_&quot; as a prefix, the document name guess for an Invoice
class becomes &quot;myapp_invoices&quot;.
</p>
<p>
You can also overwrite this class method to allow for unguessable links,
such as a Mouse class with a link to a &quot;mice&quot; document. Example:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Mouse constant id'>Mouse</span> <span class='lt op'>&lt;</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='set_document_name identifier id'>set_document_name</span> <span class='string val'>&quot;mice&quot;</span>
  <span class='end end kw'>end</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 991</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L991">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">991
992
993</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='document_class_name identifier id'>document_class_name</span>
  <span class='reset_document_class_name identifier id'>reset_document_class_name</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>exists?</h3>
</div><div id="exists-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>exists?</span><span class='args'>(id_or_conditions)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Checks whether a document exists in the database that matches conditions
given. These conditions can either be a key to be found, or a condition to
be matched like using CouchFoo#find.
</p>
<h4>Examples</h4>
<pre class="code">
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='exists? fid id'>exists?</span><span class='lparen token'>(</span><span class='string val'>'5a1278b3c4e'</span><span class='rparen token'>)</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='exists? fid id'>exists?</span><span class='lparen token'>(</span><span class='symbol val'>:name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;David&quot;</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 657</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L657">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">657
658
659
660
661
662
663</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='exists? fid id'>exists?</span><span class='lparen token'>(</span><span class='id_or_conditions identifier id'>id_or_conditions</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='id_or_conditions identifier id'>id_or_conditions</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='notop op'>!</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:first</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:ruby_class</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='document_class_name identifier id'>document_class_name</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='id_or_conditions identifier id'>id_or_conditions</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='else else kw'>else</span>
    <span class='notop op'>!</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='id_or_conditions identifier id'>id_or_conditions</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:ruby_class</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='document_class_name identifier id'>document_class_name</span><span class='rbrace token'>}</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='rescue rescue kw'>rescue</span> <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>find</h3>
</div><div id="find-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>find</span><span class='args'>(*args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
CouchDB has a concept called views which show a subset of documents in the
database subject to criteria. The documents selected are chosen according
to a map function and an optional reduce function. The later is useful for
example, to count all the documents that have been matched by the initial
map function. CouchFoo automatically creates views for each of the data
models you use as you require them. For example take the class House. The
first House.find(:id) will create a House design document with a view that
exposes the id of the house as a key - any house can then be selected on
this. If you then do a query for a certain colour house, ie
House.find_all_by_colour(&quot;red&quot;) then a view that exposes the
house colour as a key will be added to the design document. So as you
perform new queries the design document for a model is updated so you are
always accessing via an &#8216;indexed&#8217; approach. This should be
transparent to the developer but the resulting views can be seen by looking
up the design document in the database.
</p>
<p>
CouchFoo cannot handle automatic view generation for the case where both an
:order and :limit should be applied to a result set. This is because the
ordering is performed after retrieving data from CouchDB whereas the limit
is applied at the database level. As such if you were limiting to 5 results
and ordering on a property you would get the same 5 results in a different
order rather than the first 5 and last 5 results for that data type. To
overcome this restriction either define the property you wish to order on
in the :use_key option (make sure you add conditions you&#8217;re using in
here as well) or create your own views using CouchFoo#view. You can then
use the :descending =&gt; true to reverse the results order.
</p>
<p>
There is a slight caveat to the way views work in CouchDB. The index is
only updated each time a view is accessed (although this can be overridden
using :update). This is both good and bad. Good in the sense you
don&#8217;t pay the price at insertion time, bad in the sense you pay when
accessing the view the next time (although this can be more efficient). The
simple solution is to write a script that periodically calls the view to
update the index as described on the CouchDB site in this FAQ:
http://wiki.apache.org/couchdb/Frequently_asked_questions#update_views_more_often
Needless to say creating a new view on a large dataset is expensive but
this is no different from creating an index on a large MySQL table
(although in general it&#8217;s a bit slower as all the documents are in
one place rather than split into tables)
</p>
<p>
It is possible to perform unindexed queries by using slow views, although
this is not recommended for production use. Like MySQL performing unindexed
lookups is very inefficient on large datasets.
</p>
<p>
One final point to note is we&#8217;re used to using relational databases
that have auto-incrementing keys. Therefore the newest rows added to the
database have the highest key value (some databases go back and fill in the
missing/deleted keys after a restart but generally speaking&#8230;) and are
therefore shown last in lists on the front end. When using CouchDB each
item is allocated a UUID which varies massively depending on time, computer
IP etc. Therefore it is likely that adding a new item to a page via AJAX
will add the item to the bottom of the list but when the page is reloaded
it occurs in the middle somewhere. This is very confusing for users so it
is therefore recommended that you sort items on a :created_at field by
default (see CouchFoo#default_sort).
</p>
<p>
More information can be found on CouchDB views at:
http://wiki.apache.org/couchdb/Introduction_to_CouchDB_views
</p>
<p>
CouchFoo operates with four different retrieval approaches:
</p>
<ul>
<li>Find by id - This can either be a specific id (1), a list of ids (1, 5, 6),
or an array of ids ([5, 6, 10]). If no record can be found for all of the
listed ids, then DocumentNotFound will be raised. This only accepts the
:conditions and :readonly options. Note when using a list/array of ids the
lookup is O(n) efficiency rather than O(1) (as with ActiveRecord) if using
CouchDB&lt;0.9

</li>
<li>Find first - This will return the first record matched by the options used.
These options can either be specific conditions or merely an order. If no
record can be matched, <tt>nil</tt> is returned. Use <tt>Model.find(:first,
*args)</tt> or its shortcut <tt>Model.first(*args)</tt>. It is recommended
you use CouchFoo#default_sort on the model if you wish to use this with
ordering.

</li>
<li>Find last - This will return the last record matched by the options used.
These options can either be specific conditions or merely an order. If no
record can be matched, <tt>nil</tt> is returned. Use <tt>Model.find(:last,
*args)</tt> or its shortcut <tt>Model.last(*args)</tt>. It is recommended
you use CouchFoo#default_sort on the model if you wish to use this with
ordering.

</li>
<li>Find all - This will return all the records matched by the options used. If
no records are found, an empty array is returned. Use <tt>Model.find(:all,
*args)</tt> or its shortcut <tt>Model.all(*args)</tt>.

</li>
</ul>
<p>
All approaches accept an options hash as their last parameter.
</p>
<h4>Attributes</h4>
<p>
NOTE: Only :conditions and :readonly are available on find by id lookups
</p>
<ul>
<li><tt>:conditions</tt> - This can only take a Hash of options to match, not
SQL fragments like ActiveRecord. For example :conditions =&gt; {:size = 6,
:price =&gt; 30..80} or :conditions =&gt; <tt>=&amp;gt; [6, 8, 10]</tt>
<b>Note</b> when using the later approach and specifying a discrete list
CouchDB doesn&#8217;t support ranges in the same query

</li>
<li><tt>:order</tt> - With a field name sorts on that field. This is applied
after the results are returned from the database so should not be used with
:limit and is fairly pointless with find(:first) and find(:last) types. See
CouchFoo#view for how to create views that can be sorted ActiveRecord style

</li>
<li><tt>:include</tt> - not implemented yet

</li>
<li><tt>:limit</tt> - an integer determining the limit on the number of rows
that should be returned. Take caution if using with :order (read notes in
:order and section header)

</li>
<li><tt>:offset</tt> - An integer determining the offset from where the rows
should be fetched. So at 5, it would skip rows 0 through 4. This is the
same as :skip listed below in the further options. Note: This is not
particulary efficient in CouchDB

</li>
<li><tt>:update</tt> - If set to false will not update the view so although the
access will be faster some of the data may be out of date. Recommended if
you are managing view updation independently

</li>
<li><tt>:readonly</tt> - Mark the returned documents read-only so they cannot
be saved or updated.

</li>
<li><tt>:view_type</tt> - by default views are created for queries where there
is no view (this is equivalent to no index on the column in MySQL) to keep
lookups efficient. However by passing :view_type =&gt; :slow a CouchDB slow
query will be performed. As the name suggests these are slow and should
only be used in development not production. Be sure to read the note above
on how CouchDB indexing works and responsabilites of the developer.

</li>
<li><tt>:use_key</tt> - The key to emit in the view. The key is used for
selection and ordering so is a good way to order results and limit to a
certain quantity, or to find results that are greater or less than a
certain value (in combination with :startkey, :endkey). Normally this value
is automatically determined when using :conditions. As such when using in
combination with :conditions option this must contain both the items you
would like in the key and the items you&#8217;re using in the conditions.
For example: User.find(:all, :use_key =&gt; [:name, :administrator],
:conditions =&gt; <tt>=&amp;gt; true</tt>)

</li>
<li><tt>:startkey</tt> - Used to find all documents from this value up, for
example User.find(:all, :startkey =&gt; 20) This needs to be used with a
custom map function where the user has chosen the exposing key for it to be
meaningful.

</li>
<li><tt>:endkey</tt> - As :startkey but documents upto that key rather than
from it

</li>
<li><tt>:return_json</tt> - If you are emitting something other than the
document as the value on a custom map function you may wish to return the
raw JSON as instantiating objects may not be possible. Using this option
will ignore any :order or :readonly settings

</li>
<li><tt>Further options</tt> - The CouchDB view options :descending, :group,
:group_level, :skip, :keys, :startkey_docid and :endkey_docid are supported
on views but they are unlikely to be required unless the developer is
specifying their own map or reduce function. Note some of these require
CouchDB 0.9 (see CouchDB wiki for list)

</li>
</ul>
<h4>Examples</h4>
<pre class="code">
  <span class='comment val'># find by id</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span>       <span class='comment val'># returns the object for ID = 1</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>6</span><span class='rparen token'>)</span> <span class='comment val'># returns an array for objects with IDs in (1, 2, 6)</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='integer val'>7</span><span class='comma token'>,</span> <span class='integer val'>17</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='comment val'># returns an array for objects with IDs in (7, 17)</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>     <span class='comment val'># returns an array for the object with ID = 1</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:administrator</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='Unlike constant id'>Unlike</span> <span class='ActiveRecord constant id'>ActiveRecord</span> <span class='order identifier id'>order</span> <span class='will identifier id'>will</span> <span class='be identifier id'>be</span> <span class='maintained identifier id'>maintained</span> <span class='on identifier id'>on</span> <span class='multiple identifier id'>multiple</span> <span class='id identifier id'>id</span> <span class='selection identifier id'>selection</span> <span class='but identifier id'>but</span> <span class='the identifier id'>the</span> <span class='operation identifier id'>operation</span>
  <span class='is identifier id'>is</span> <span class='not not kw'>not</span> <span class='as identifier id'>as</span> <span class='efficient identifier id'>efficient</span> <span class='as identifier id'>as</span> <span class='there identifier id'>there</span> <span class='is identifier id'>is</span> <span class='no identifier id'>no</span> <span class='multiple identifier id'>multiple</span> <span class='get identifier id'>get</span> <span class='from identifier id'>from</span> <span class='the identifier id'>the</span> <span class='database identifier id'>database</span>

  <span class='comment val'># find first</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:first</span><span class='rparen token'>)</span> <span class='comment val'># returns the first object fetched by key (so this is unlikely to be</span>
  <span class='the identifier id'>the</span> <span class='oldest identifier id'>oldest</span> <span class='person identifier id'>person</span> <span class='document identifier id'>document</span> <span class='in in kw'>in</span> <span class='the identifier id'>the</span> <span class='database identifier id'>database</span><span class='rparen token'>)</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:first</span><span class='comma token'>,</span> <span class='symbol val'>:use_key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:created_at</span><span class='rparen token'>)</span> <span class='comment val'># Finds earliest person but at the expense of</span>
  <span class='creating identifier id'>creating</span> <span class='a identifier id'>a</span> <span class='new identifier id'>new</span> <span class='view identifier id'>view</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:first</span><span class='comma token'>,</span> <span class='symbol val'>:use_key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:created_at</span><span class='comma token'>,</span> <span class='symbol val'>:startkey</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;2009/09/01&quot;</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='comment val'># Finds 1st person</span>
  <span class='since identifier id'>since</span> <span class='integer val'>1</span><span class='st identifier id'>st</span> <span class='September constant id'>September</span> <span class='integer val'>2009</span> <span class='but identifier id'>but</span> <span class='uses identifier id'>uses</span> <span class='the identifier id'>the</span> <span class='same identifier id'>same</span> <span class='index identifier id'>index</span> <span class='as identifier id'>as</span> <span class='above identifier id'>above</span>

  <span class='comment val'># find last</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:last</span><span class='rparen token'>)</span> <span class='comment val'># returns the last object, again may not be what's expected</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:last</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='symbol val'>:user_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='user_name identifier id'>user_name</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='comment val'># find all</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='rparen token'>)</span> <span class='comment val'># returns an array of objects</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:category</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Article&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:limit</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>50</span><span class='rparen token'>)</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='symbol val'>:use_key</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='symbol val'>:name</span><span class='comma token'>,</span> <span class='symbol val'>:category</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:category</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Article&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:limit</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>50</span><span class='rparen token'>)</span>
  <span class='comment val'># Creates a name, category index and finds the first 50 people ordered by name with a category of &quot;Article&quot;</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 620</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L620">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">620
621
622
623
624
625
626
627
628
629
630
631</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='extract_options! fid id'>extract_options!</span>
  <span class='validate_find_options identifier id'>validate_find_options</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='set_readonly_option! fid id'>set_readonly_option!</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>

  <span class='case case kw'>case</span> <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:first</span> <span class='then then kw'>then</span> <span class='find_initial identifier id'>find_initial</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:last</span>  <span class='then then kw'>then</span> <span class='find_last identifier id'>find_last</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:all</span>   <span class='then then kw'>then</span> <span class='find_every identifier id'>find_every</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>             <span class='find_from_ids identifier id'>find_from_ids</span><span class='lparen token'>(</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>first</h3>
</div><div id="first-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>first</span><span class='args'>(*args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A convenience wrapper for <tt>find(:first, *args)</tt>. You can pass in all
the same arguments to this method as you can to <tt>find(:first)</tt>.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 635</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L635">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">635
636
637</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='first identifier id'>first</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:first</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_uuid</h3>
</div><div id="get_uuid-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_uuid</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a unique UUID even across multiple machines
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1231</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1231">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1231
1232
1233
1234</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_uuid identifier id'>get_uuid</span>
  <span class='@uuid ivar id'>@uuid</span> <span class='opasgn op'>||=</span> <span class='UUID constant id'>UUID</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@uuid ivar id'>@uuid</span><span class='dot token'>.</span><span class='generate identifier id'>generate</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>increment_counter</h3>
</div><div id="increment_counter-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>increment_counter</span><span class='args'>(counter_name, id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Increment a number field by one, usually representing a count. Unlike
ActiveRecord this does not update the database directly but has to first
find the record. Therefore updates are O(2) rather than O(1)
</p>
<h4>Attributes</h4>
<ul>
<li><tt>counter_name</tt> - The name of the field that should be incremented.

</li>
<li><tt>id</tt> - The id of the object that should be incremented.

</li>
</ul>
<h4>Examples</h4>
<pre class="code">
  <span class='comment val'># Increment the post_count property for the record with an id of 'aef343ab2'</span>
  <span class='DiscussionBoard constant id'>DiscussionBoard</span><span class='dot token'>.</span><span class='increment_counter identifier id'>increment_counter</span><span class='lparen token'>(</span><span class='symbol val'>:post_count</span><span class='comma token'>,</span> <span class='string val'>'aef343ab2'</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 867</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L867">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">867
868
869</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='increment_counter identifier id'>increment_counter</span><span class='lparen token'>(</span><span class='counter_name identifier id'>counter_name</span><span class='comma token'>,</span> <span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='update_counters identifier id'>update_counters</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='lbrace token'>{</span><span class='counter_name identifier id'>counter_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>inheritance_column</h3>
</div><div id="inheritance_column-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>inheritance_column</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Defines the propety name for use with single table inheritance &#8212; can
be set in subclasses like so: self.inheritance_column = &quot;type_id&quot;
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1019</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1019">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1019
1020
1021</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='inheritance_column identifier id'>inheritance_column</span>
  <span class='@inheritance_column ivar id'>@inheritance_column</span> <span class='opasgn op'>||=</span> <span class='string val'>&quot;type&quot;</span><span class='dot token'>.</span><span class='freeze identifier id'>freeze</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>inspect</h3>
</div><div id="inspect-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>inspect</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1157</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1157">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1157
1158
1159
1160
1161
1162
1163
1164
1165
1166</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span>
  <span class='if if kw'>if</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='Base constant id'>Base</span>
    <span class='super super kw'>super</span>
  <span class='elsif elsif kw'>elsif</span> <span class='abstract_class? fid id'>abstract_class?</span>
    <span class='dstring node'>&quot;#{super}(abstract)&quot;</span>
  <span class='else else kw'>else</span>
    <span class='attr_list identifier id'>attr_list</span> <span class='assign token'>=</span> <span class='properties identifier id'>properties</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='p identifier id'>p</span><span class='bitor op'>|</span> <span class='dstring node'>&quot;#{p.name}: #{p.type || 'JSON'}&quot;</span> <span class='rbrace token'>}</span> <span class='mult op'>*</span> <span class='string val'>', '</span>
    <span class='dstring node'>&quot;#{super}(#{attr_list})&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>last</h3>
</div><div id="last-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>last</span><span class='args'>(*args)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A convenience wrapper for <tt>find(:last, *args)</tt>. You can pass in all
the same arguments to this method as you can to <tt>find(:last)</tt>.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 641</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L641">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">641
642
643</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='last identifier id'>last</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
  <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:last</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='args identifier id'>args</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>properties</h3>
</div><div id="properties-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>properties</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns all properties defined on this class
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1068</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1068">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1068
1069
1070
1071
1072
1073
1074
1075
1076</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='properties identifier id'>properties</span>
  <span class='if if kw'>if</span> <span class='@properties ivar id'>@properties</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='@properties ivar id'>@properties</span> <span class='assign token'>=</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='@properties ivar id'>@properties</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='superclass identifier id'>superclass</span><span class='dot token'>.</span><span class='properties identifier id'>properties</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='base_class identifier id'>base_class</span>
    <span class='@properties ivar id'>@properties</span>
  <span class='else else kw'>else</span>
    <span class='@properties ivar id'>@properties</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>property</h3>
</div><div id="property-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>property</span><span class='args'>(name, type = Object, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set a property for the document. These can be passed a type and options
hash. If no type is passed a #to_json method is called on the ruby object
and the result stored in the database. When it is retrieved from the
database a class.from_json(json) method is called on it or if that
doesn&#8217;t exist it just uses the value (more on this at
http://www.rowtheboat.com/archives/35). If a type is passed then the object
is cast before storing in the database. This does not guarantee that the
object is the correct type (use the validaters for that), it merely tries
to convert the current type to the desired one
</p>
<ul>
<li>for example:

</li>
</ul>
<p>
&#8216;123&#8217; =&gt; 123 # useful &#8216;a&#8217; =&gt; 0 # probably not
desired behaviour The later would fail with a validator
</p>
<p>
The options hash supports: default - the default value for the attribute to
be initalized to
</p>
<h4>Example:</h4>
<p>
class Invoice &lt; CouchFoo::Base
</p>
<pre class="code">
  <span class='property identifier id'>property</span> <span class='symbol val'>:number</span><span class='comma token'>,</span> <span class='Integer constant id'>Integer</span>
  <span class='property identifier id'>property</span> <span class='symbol val'>:paid</span><span class='comma token'>,</span> <span class='TrueClass constant id'>TrueClass</span><span class='comma token'>,</span> <span class='symbol val'>:default</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='false false kw'>false</span>
  <span class='property identifier id'>property</span> <span class='symbol val'>:notes</span><span class='comma token'>,</span> <span class='String constant id'>String</span>
  <span class='property identifier id'>property</span> <span class='symbol val'>:acl</span> <span class='comment val'># or acl, Object is equivalent</span>
  <span class='property identifier id'>property</span> <span class='symbol val'>:price</span><span class='comma token'>,</span> <span class='Price constant id'>Price</span>
</pre>
<p>
end
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1061</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1061">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1061
1062
1063
1064
1065</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='property identifier id'>property</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='Object constant id'>Object</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='warn identifier id'>warn</span><span class='lparen token'>(</span><span class='string val'>&quot;Using type as a property name may issue unexpected behaviour&quot;</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='name identifier id'>name</span> <span class='eq op'>==</span> <span class='symbol val'>:type</span>
  <span class='properties identifier id'>properties</span><span class='dot token'>.</span><span class='delete_if identifier id'>delete_if</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='eq op'>==</span> <span class='name identifier id'>name</span><span class='rbrace token'>}</span> <span class='comment val'># Subset properties override</span>
  <span class='properties identifier id'>properties</span> <span class='lshft op'>&lt;&lt;</span> <span class='Property constant id'>Property</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='type identifier id'>type</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:default</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>property_names</h3>
</div><div id="property_names-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>property_names</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array of property names
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1087</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1087">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1087
1088
1089</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='property_names identifier id'>property_names</span>
  <span class='@property_names ivar id'>@property_names</span> <span class='opasgn op'>||=</span> <span class='properties identifier id'>properties</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='property identifier id'>property</span><span class='bitor op'>|</span> <span class='property identifier id'>property</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>property_types</h3>
</div><div id="property_types-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>property_types</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a hash of property name to types
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1079</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1079">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1079
1080
1081
1082
1083
1084</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='property_types identifier id'>property_types</span>
  <span class='@properties_type ivar id'>@properties_type</span> <span class='opasgn op'>||=</span> <span class='properties identifier id'>properties</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='types identifier id'>types</span><span class='comma token'>,</span> <span class='property identifier id'>property</span><span class='bitor op'>|</span>
    <span class='types identifier id'>types</span><span class='lbrack token'>[</span><span class='property identifier id'>property</span><span class='dot token'>.</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='property identifier id'>property</span><span class='dot token'>.</span><span class='type identifier id'>type</span>
    <span class='types identifier id'>types</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>protected_attributes</h3>
</div><div id="protected_attributes-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>protected_attributes</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array of all the attributes that have been protected from
mass-assignment.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 918</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L918">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">918
919
920</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='protected_attributes identifier id'>protected_attributes</span> 
  <span class='read_inheritable_attribute identifier id'>read_inheritable_attribute</span><span class='lparen token'>(</span><span class='string val'>&quot;attr_protected&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>readonly_attributes</h3>
</div><div id="readonly_attributes-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>readonly_attributes</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array of all the attributes that have been specified as readonly
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 962</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L962">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">962
963
964</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='readonly_attributes identifier id'>readonly_attributes</span>
  <span class='read_inheritable_attribute identifier id'>read_inheritable_attribute</span><span class='lparen token'>(</span><span class='string val'>&quot;attr_readonly&quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reset_document_class_name</h3>
</div><div id="reset_document_class_name-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reset_document_class_name</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 995</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L995">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">995
996
997
998
999
1000
1001
1002
1003
1004</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reset_document_class_name identifier id'>reset_document_class_name</span>
  <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='name identifier id'>name</span>
  <span class='unless unless kw'>unless</span> <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='base_class identifier id'>base_class</span>
    <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='superclass identifier id'>superclass</span><span class='dot token'>.</span><span class='document_class_name identifier id'>document_class_name</span>
  <span class='end end kw'>end</span>
  
  <span class='doc_class_name identifier id'>doc_class_name</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;#{document_name_prefix}#{name}#{document_name_suffix}&quot;</span>
  <span class='set_document_class_name identifier id'>set_document_class_name</span><span class='lparen token'>(</span><span class='doc_class_name identifier id'>doc_class_name</span><span class='rparen token'>)</span>
  <span class='doc_class_name identifier id'>doc_class_name</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reset_property_information</h3>
</div><div id="reset_property_information-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reset_property_information</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Resets all the cached information about properties, which will cause them
to be reloaded on the next request.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1093</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1093">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1093
1094
1095
1096</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reset_property_information identifier id'>reset_property_information</span>
  <span class='generated_methods identifier id'>generated_methods</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='bitor op'>|</span> <span class='undef_method identifier id'>undef_method</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='@property_names ivar id'>@property_names</span> <span class='assign token'>=</span> <span class='@properties ivar id'>@properties</span> <span class='assign token'>=</span> <span class='@property_types ivar id'>@property_types</span> <span class='assign token'>=</span> <span class='@generated_methods ivar id'>@generated_methods</span> <span class='assign token'>=</span> <span class='@inheritance_column ivar id'>@inheritance_column</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>respond_to?</h3>
</div><div id="respond_to-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>respond_to?</span><span class='args'>(method_id, include_private = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1223</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1223">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1223
1224
1225
1226
1227
1228</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='method_id identifier id'>method_id</span><span class='comma token'>,</span> <span class='include_private identifier id'>include_private</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='match identifier id'>match</span> <span class='assign token'>=</span> <span class='matches_dynamic_finder? fid id'>matches_dynamic_finder?</span><span class='lparen token'>(</span><span class='method_id identifier id'>method_id</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='matches_dynamic_finder_with_initialize_or_create? fid id'>matches_dynamic_finder_with_initialize_or_create?</span><span class='lparen token'>(</span><span class='method_id identifier id'>method_id</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='true true kw'>true</span> <span class='if if_mod kw'>if</span> <span class='all_attributes_exists? fid id'>all_attributes_exists?</span><span class='lparen token'>(</span><span class='extract_attribute_names_from_match identifier id'>extract_attribute_names_from_match</span><span class='lparen token'>(</span><span class='match identifier id'>match</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='super super kw'>super</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>set_document_class_name</h3>
</div><div id="set_document_class_name-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>set_document_class_name</span><span class='args'>(value = nil, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="document_class_name=-class_method">document_class_name=</tt>
  
</p>
</div><div class="section docstring">
  <p>
Sets the document class name to use to the given value, or (if the value is
nil or false) to the value returned by the given block.
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Project constant id'>Project</span> <span class='lt op'>&lt;</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='set_document_class_name identifier id'>set_document_class_name</span> <span class='string val'>&quot;project&quot;</span>
  <span class='end end kw'>end</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1012</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1012">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1012
1013
1014</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='set_document_class_name identifier id'>set_document_class_name</span><span class='lparen token'>(</span><span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='define_attr_method identifier id'>define_attr_method</span> <span class='symbol val'>:document_class_name</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>set_inheritance_column</h3>
</div><div id="set_inheritance_column-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>set_inheritance_column</span><span class='args'>(value = nil, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="inheritance_column=-class_method">inheritance_column=</tt>
  
</p>
</div><div class="section docstring">
  <p>
Sets the name of the inheritance column to use to the given value, or (if
the value # is nil or false) to the value returned by the given block.
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Project constant id'>Project</span> <span class='lt op'>&lt;</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='set_inheritance_column identifier id'>set_inheritance_column</span> <span class='do do kw'>do</span>
      <span class='original_inheritance_column identifier id'>original_inheritance_column</span> <span class='plus op'>+</span> <span class='string val'>&quot;_id&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1032</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1032">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1032
1033
1034</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='set_inheritance_column identifier id'>set_inheritance_column</span><span class='lparen token'>(</span><span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='define_attr_method identifier id'>define_attr_method</span> <span class='symbol val'>:inheritance_column</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>silence</h3>
</div><div id="silence-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>silence</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Silences the logger for the duration of the block.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  
</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1195</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1195">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1195
1196
1197
1198
1199
1200</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='silence identifier id'>silence</span>
  <span class='old_logger_level identifier id'>old_logger_level</span><span class='comma token'>,</span> <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='level identifier id'>level</span> <span class='assign token'>=</span> <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='level identifier id'>level</span><span class='comma token'>,</span> <span class='Logger constant id'>Logger</span><span class='colon2 op'>::</span><span class='ERROR constant id'>ERROR</span> <span class='if if_mod kw'>if</span> <span class='logger identifier id'>logger</span>
  <span class='yield yield kw'>yield</span>
<span class='ensure ensure kw'>ensure</span>
  <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='level identifier id'>level</span> <span class='assign token'>=</span> <span class='old_logger_level identifier id'>old_logger_level</span> <span class='if if_mod kw'>if</span> <span class='logger identifier id'>logger</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update</h3>
</div><div id="update-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update</span><span class='args'>(id, attributes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Updates an object (or multiple objects) and saves it to the database, if
validations pass. The resulting object is returned whether the object was
saved successfully to the database or not.
</p>
<h4>Attributes</h4>
<ul>
<li><tt>id</tt> - This should be the id or an array of ids to be updated.

</li>
<li><tt>attributes</tt> - This should be a Hash of attributes to be set on the
object, or an array of Hashes.

</li>
</ul>
<h4>Examples</h4>
<pre class="code">
  <span class='comment val'># Updating one record:</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='update identifier id'>update</span><span class='lparen token'>(</span><span class='string val'>'6180e9a0-cdca-012b-14a5-001a921a2bec'</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='symbol val'>:user_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Samuel'</span><span class='comma token'>,</span> <span class='symbol val'>:group</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'expert'</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>

  <span class='comment val'># Updating multiple records:</span>
  <span class='people identifier id'>people</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'6180e9a0-cdca-012b-14a5-001a921a2bec'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;first_name&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;David&quot;</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='string val'>'e6f6a870-cdc9-012b-14a3-001a921a2bec'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;first_name&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Jeremy&quot;</span> <span class='rbrace token'>}</span> <span class='rbrace token'>}</span>
  <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='update identifier id'>update</span><span class='lparen token'>(</span><span class='people identifier id'>people</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span><span class='comma token'>,</span> <span class='people identifier id'>people</span><span class='dot token'>.</span><span class='values identifier id'>values</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 716</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L716">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">716
717
718
719
720
721
722
723
724
725</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='update identifier id'>update</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='idx identifier id'>idx</span> <span class='assign token'>=</span> <span class='integer val'>-1</span>
    <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='one_id identifier id'>one_id</span><span class='bitor op'>|</span> <span class='idx identifier id'>idx</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span><span class='semicolon token'>;</span> <span class='update identifier id'>update</span><span class='lparen token'>(</span><span class='one_id identifier id'>one_id</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='idx identifier id'>idx</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='else else kw'>else</span>
    <span class='object identifier id'>object</span> <span class='assign token'>=</span> <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
    <span class='object identifier id'>object</span><span class='dot token'>.</span><span class='update_attributes identifier id'>update_attributes</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
    <span class='object identifier id'>object</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_all</h3>
</div><div id="update_all-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_all</span><span class='args'>(updates, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Updates all records with details given if they match a set of conditions
supplied. Even though this uses a bulk save and immediately commits it must
first find the relevant documents so is O(n+1) rather than O(1)
</p>
<h4>Attributes</h4>
<ul>
<li><tt>updates</tt> - A hash of attributes to update

</li>
<li><tt>options</tt> - As CouchFoo#find. Unlike ActiveRecord :order and :limit
cannot be used togther

<pre class="code">
            <span class='unless unless kw'>unless</span> <span class='via identifier id'>via</span> <span class='a identifier id'>a</span> <span class='custom identifier id'>custom</span> <span class='view identifier id'>view</span> <span class='lparen token'>(</span><span class='see identifier id'>see</span> <span class='notes identifier id'>notes</span> <span class='in in kw'>in</span> <span class='CouchFoo constant id'>CouchFoo</span><span class='comment val'>#find)</span>
</pre>
</li>
</ul>
<h4>Examples</h4>
<pre class="code">
  <span class='comment val'># Update all billing objects with the 3 different attributes given</span>
  <span class='Billing constant id'>Billing</span><span class='dot token'>.</span><span class='update_all identifier id'>update_all</span><span class='lparen token'>(</span> <span class='symbol val'>:category</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'authorized'</span><span class='comma token'>,</span> <span class='symbol val'>:approved</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='symbol val'>:author</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'David'</span> <span class='rparen token'>)</span>

  <span class='comment val'># Update records that match our conditions</span>
  <span class='Billing constant id'>Billing</span><span class='dot token'>.</span><span class='update_all identifier id'>update_all</span><span class='lparen token'>(</span> <span class='lbrace token'>{</span><span class='symbol val'>:author</span> <span class='assign token'>=</span> <span class='string val'>'David'</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:title</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'Rails'</span><span class='rbrace token'>}</span> <span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 797</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L797">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">797
798
799
800</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='update_all identifier id'>update_all</span><span class='lparen token'>(</span><span class='updates identifier id'>updates</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='d identifier id'>d</span><span class='bitor op'>|</span> <span class='d identifier id'>d</span><span class='dot token'>.</span><span class='update_attributes identifier id'>update_attributes</span><span class='lparen token'>(</span><span class='updates identifier id'>updates</span><span class='comma token'>,</span> <span class='true true kw'>true</span><span class='rparen token'>)</span><span class='rbrace token'>}</span>
  <span class='database identifier id'>database</span><span class='dot token'>.</span><span class='commit identifier id'>commit</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_counters</h3>
</div><div id="update_counters-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_counters</span><span class='args'>(id, counters)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
A generic &quot;counter updater&quot; implementation, intended primarily to
be used by increment_counter and decrement_counter, but which may also be
useful on its own. Unlike ActiveRecord this does not update the database
directly but has to first find the record. Therefore updates require 2
database requests.
</p>
<h4>Attributes</h4>
<ul>
<li><tt>id</tt> - The id of the object you wish to update a counter on.

</li>
<li><tt>counters</tt> - An Array of Hashes containing the names of the fields
to update as keys and the amount to update the field by as values.

</li>
</ul>
<h4>Examples</h4>
<pre class="code">
  <span class='comment val'># For the Post with id of '5aef343ab2', decrement the comment_count by 1, and</span>
  <span class='comment val'># increment the action_count by 1</span>
  <span class='Post constant id'>Post</span><span class='dot token'>.</span><span class='update_counters identifier id'>update_counters</span> <span class='string val'>'aef343ab2'</span><span class='comma token'>,</span> <span class='symbol val'>:comment_count</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>-1</span><span class='comma token'>,</span> <span class='symbol val'>:action_count</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 846</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L846">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">846
847
848
849
850
851
852</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='update_counters identifier id'>update_counters</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='counters identifier id'>counters</span><span class='rparen token'>)</span>
  <span class='record identifier id'>record</span> <span class='assign token'>=</span> <span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='counters identifier id'>counters</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='increment identifier id'>increment</span><span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='save identifier id'>save</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>view</h3>
</div><div id="view-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>view</span><span class='args'>(name, map_function, reduce_function = nil, standard_options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a view and return the documents associated with that view. It
requires a name, find_function and optional reduce function (see
http://wiki.apache.org/couchdb/HTTP_view_API). At the moment this function
assumes you&#8217;re going to emit a doc as the value (required to rebuild
the model after running the query)
</p>
<p>
For example:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Note constant id'>Note</span>
    <span class='view identifier id'>view</span> <span class='symbol val'>:latest_submissions</span><span class='comma token'>,</span> <span class='string val'>&quot;function(doc) {if(doc.ruby_class == 'Note') {emit([doc.created_at , doc.note], doc); } }&quot;</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='symbol val'>:descending</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span>
  <span class='dot3 op'>...</span>
  <span class='end end kw'>end</span>
</pre>
<p>
This example would be an effective way to get the latest notes sorted by
create date and note contents. The above view could then be called:
Note.latest_submissions(:limit =&gt; 5)
</p>
<p>
NOTE: We use descending =&gt; true and not order as order is applied after
the results are retrieved from CouchDB whereas descending is a CouchDB view
option. More on this can be found in the #find documentation NOTE: Custom
views do not worked with named scopes, any desired scopes should be coded
into the map function
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1145</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1145">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1145
1146
1147</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='view identifier id'>view</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='map_function identifier id'>map_function</span><span class='comma token'>,</span> <span class='reduce_function identifier id'>reduce_function</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='standard_options identifier id'>standard_options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='views identifier id'>views</span> <span class='lshft op'>&lt;&lt;</span> <span class='View constant id'>View</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='map_function identifier id'>map_function</span><span class='comma token'>,</span> <span class='reduce_function identifier id'>reduce_function</span><span class='comma token'>,</span> <span class='standard_options identifier id'>standard_options</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>view_names</h3>
</div><div id="view_names-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>view_names</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1153</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1153">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1153
1154
1155</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='view_names identifier id'>view_names</span>
  <span class='@view_names ivar id'>@view_names</span> <span class='opasgn op'>||=</span> <span class='views identifier id'>views</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='view identifier id'>view</span><span class='bitor op'>|</span> <span class='view identifier id'>view</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>views</h3>
</div><div id="views-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>views</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1149</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1149">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1149
1150
1151</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='views identifier id'>views</span>
  <span class='@views ivar id'>@views</span> <span class='opasgn op'>||=</span> <span class='Set constant id'>Set</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>==</h3>
</div><div id="-3D-3D-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>==</span><span class='args'>(comparison_object)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if the <tt>comparison_object</tt> is the same object, or is of
the same type and has the same id.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1889</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1889">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1889
1890
1891
1892
1893
1894</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='eq op'>==</span><span class='lparen token'>(</span><span class='comparison_object identifier id'>comparison_object</span><span class='rparen token'>)</span>
  <span class='comparison_object identifier id'>comparison_object</span><span class='dot token'>.</span><span class='equal? fid id'>equal?</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
    <span class='lparen token'>(</span><span class='comparison_object identifier id'>comparison_object</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span>
      <span class='comparison_object identifier id'>comparison_object</span><span class='dot token'>.</span><span class='id identifier id'>id</span> <span class='eq op'>==</span> <span class='id identifier id'>id</span> <span class='andop op'>&amp;&amp;</span>
      <span class='notop op'>!</span><span class='comparison_object identifier id'>comparison_object</span><span class='dot token'>.</span><span class='new_record? fid id'>new_record?</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>[]</h3>
</div><div id="-5B-5D-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>[]</span><span class='args'>(attr_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the value of the attribute identified by <tt>attr_name</tt> after
it has been typecast (for example, &quot;2004-12-12&quot; in a data
property is cast to a date object, like Date.new(2004, 12, 12)). (Alias for
the protected read_attribute method).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1812</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1812">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1812
1813
1814</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='aref op'>[]</span><span class='lparen token'>(</span><span class='attr_name identifier id'>attr_name</span><span class='rparen token'>)</span>
  <span class='read_attribute identifier id'>read_attribute</span><span class='lparen token'>(</span><span class='attr_name identifier id'>attr_name</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>[]=</h3>
</div><div id="-5B-5D-3D-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>[]=</span><span class='args'>(attr_name, value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Updates the attribute identified by <tt>attr_name</tt> with the specified
<tt>value</tt>. (Alias for the protected write_attribute method).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1818</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1818">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1818
1819
1820</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='aset op'>[]=</span><span class='lparen token'>(</span><span class='attr_name identifier id'>attr_name</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='write_attribute identifier id'>write_attribute</span><span class='lparen token'>(</span><span class='attr_name identifier id'>attr_name</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_id</h3>
</div><div id="_id-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_id</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="id-instance_method">id</tt>
  
</p>
</div><div class="section docstring">
  <p>
Returns the unqiue id of the document
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1645</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1645">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1645
1646
1647</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_id identifier id'>_id</span>
  <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>&quot;_id&quot;</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_rev</h3>
</div><div id="_rev-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_rev</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>
<p class="aliases">
  <span class="aka">Also known as:</span>
  
    <tt id="rev-instance_method">rev</tt>
  
</p>
</div><div class="section docstring">
  <p>
Returns the revision id of the document
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1651</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1651">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1651
1652
1653</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_rev identifier id'>_rev</span>
  <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>&quot;_rev&quot;</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attribute_for_inspect</h3>
</div><div id="attribute_for_inspect-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attribute_for_inspect</span><span class='args'>(attr_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Format attributes nicely for inspect.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1859</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1859">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1859
1860
1861
1862
1863
1864
1865
1866
1867
1868
1869</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attribute_for_inspect identifier id'>attribute_for_inspect</span><span class='lparen token'>(</span><span class='attr_name identifier id'>attr_name</span><span class='rparen token'>)</span>
  <span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='read_attribute identifier id'>read_attribute</span><span class='lparen token'>(</span><span class='attr_name identifier id'>attr_name</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='String constant id'>String</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='gt op'>&gt;</span> <span class='integer val'>50</span>
    <span class='dstring node'>&quot;#{value[0..50]}...&quot;</span><span class='dot token'>.</span><span class='inspect identifier id'>inspect</span>
  <span class='elsif elsif kw'>elsif</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Date constant id'>Date</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='rparen token'>)</span>
    <span class='dstring node'>%(&quot;#{value.to_s(:db)}&quot;)</span>
  <span class='else else kw'>else</span>
    <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='inspect identifier id'>inspect</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attribute_names</h3>
</div><div id="attribute_names-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attribute_names</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an array of names for the attributes available on this object
sorted alphabetically.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1884</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1884">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1884
1885
1886</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attribute_names identifier id'>attribute_names</span>
  <span class='@attributes ivar id'>@attributes</span><span class='dot token'>.</span><span class='keys identifier id'>keys</span><span class='dot token'>.</span><span class='map identifier id'>map</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attribute_present?</h3>
</div><div id="attribute_present-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attribute_present?</span><span class='args'>(attribute)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if the specified <tt>attribute</tt> has been set by the user
or by a database load and is neither nil nor empty? (the latter only
applies to objects that respond to empty?, most notably Strings).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1873</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1873">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1873
1874
1875
1876</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attribute_present? fid id'>attribute_present?</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='rparen token'>)</span>
  <span class='value identifier id'>value</span> <span class='assign token'>=</span> <span class='read_attribute identifier id'>read_attribute</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='rparen token'>)</span>
  <span class='notop op'>!</span><span class='value identifier id'>value</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attributes</h3>
</div><div id="attributes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attributes</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a hash of all the attributes with their names as keys and the
values of the attributes as values.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1843</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1843">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1843
1844
1845
1846
1847
1848</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attributes identifier id'>attributes</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='attribute_names identifier id'>attribute_names</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='bitor op'>|</span>
    <span class='attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='read_attribute identifier id'>read_attribute</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
    <span class='attrs identifier id'>attrs</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attributes=</h3>
</div><div id="attributes-3D-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attributes=</span><span class='args'>(new_attributes, guard_protected_attributes = true)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Allows you to set all the attributes at once by passing in a hash with keys
matching the attribute names (which again matches the property names).
Sensitive attributes can be protected from this form of mass-assignment by
using the <tt>attr_protected</tt> macro. Or you can alternatively specify
which attributes <b>can</b> be accessed with the <tt>attr_accessible</tt>
macro. Then all the attributes not included in that won&#8217;t be allowed
to be mass-assigned.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1827</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1827">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1827
1828
1829
1830
1831
1832
1833
1834
1835
1836
1837
1838
1839</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attributes= identifier id'>attributes=</span><span class='lparen token'>(</span><span class='new_attributes identifier id'>new_attributes</span><span class='comma token'>,</span> <span class='guard_protected_attributes identifier id'>guard_protected_attributes</span> <span class='assign token'>=</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='new_attributes identifier id'>new_attributes</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='normalize_attrs identifier id'>normalize_attrs</span><span class='lparen token'>(</span><span class='new_attributes identifier id'>new_attributes</span><span class='rparen token'>)</span>

  <span class='multi_parameter_attributes identifier id'>multi_parameter_attributes</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='remove_attributes_protected_from_mass_assignment identifier id'>remove_attributes_protected_from_mass_assignment</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='guard_protected_attributes identifier id'>guard_protected_attributes</span>

  <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='bitor op'>|</span>
    <span class='k identifier id'>k</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>&quot;(&quot;</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='multi_parameter_attributes identifier id'>multi_parameter_attributes</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span> <span class='k identifier id'>k</span><span class='comma token'>,</span> <span class='v identifier id'>v</span> <span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='k identifier id'>k</span> <span class='plus op'>+</span> <span class='string val'>&quot;=&quot;</span><span class='comma token'>,</span> <span class='v identifier id'>v</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='assign_multiparameter_attributes identifier id'>assign_multiparameter_attributes</span><span class='lparen token'>(</span><span class='multi_parameter_attributes identifier id'>multi_parameter_attributes</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attributes_before_type_cast</h3>
</div><div id="attributes_before_type_cast-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attributes_before_type_cast</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns a hash of attributes before typecasting and deserialization.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1851</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1851">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1851
1852
1853
1854
1855
1856</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attributes_before_type_cast identifier id'>attributes_before_type_cast</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='attribute_names identifier id'>attribute_names</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='bitor op'>|</span>
    <span class='attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='read_attribute_before_type_cast identifier id'>read_attribute_before_type_cast</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
    <span class='attrs identifier id'>attrs</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>becomes</h3>
</div><div id="becomes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>becomes</span><span class='args'>(klass)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns an instance of the specified <tt>klass</tt> with the attributes of
the current record. This is mostly useful in relation to inheritance
structures where you want a subclass to appear as the superclass. This can
be used along with record identification in Action Pack to allow, say,
<tt>Client &lt; Company</tt> to do something like render <tt>:partial =&gt;
@client.becomes(Company)</tt> to render that instance using the
companies/company partial instead of clients/client.
</p>
<p>
Note: The new instance will share a link to the same attributes as the
original class. So any change to the attributes in either instance will
affect the other.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1714</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1714">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1714
1715
1716
1717
1718
1719
1720</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='becomes identifier id'>becomes</span><span class='lparen token'>(</span><span class='klass identifier id'>klass</span><span class='rparen token'>)</span>
  <span class='returning identifier id'>returning</span> <span class='klass identifier id'>klass</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='became identifier id'>became</span><span class='bitor op'>|</span>
    <span class='became identifier id'>became</span><span class='dot token'>.</span><span class='instance_variable_set identifier id'>instance_variable_set</span><span class='lparen token'>(</span><span class='string val'>&quot;@attributes&quot;</span><span class='comma token'>,</span> <span class='@attributes ivar id'>@attributes</span><span class='rparen token'>)</span>
    <span class='became identifier id'>became</span><span class='dot token'>.</span><span class='instance_variable_set identifier id'>instance_variable_set</span><span class='lparen token'>(</span><span class='string val'>&quot;@attributes_cache&quot;</span><span class='comma token'>,</span> <span class='@attributes_cache ivar id'>@attributes_cache</span><span class='rparen token'>)</span>
    <span class='became identifier id'>became</span><span class='dot token'>.</span><span class='instance_variable_set identifier id'>instance_variable_set</span><span class='lparen token'>(</span><span class='string val'>&quot;@new_record&quot;</span><span class='comma token'>,</span> <span class='new_record? fid id'>new_record?</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>clone</h3>
</div><div id="clone-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>clone</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1697</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1697">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1697
1698
1699
1700
1701
1702
1703</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='clone identifier id'>clone</span>
  <span class='attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='clone_attributes identifier id'>clone_attributes</span><span class='lparen token'>(</span><span class='symbol val'>:read_attribute_before_type_cast</span><span class='rparen token'>)</span>
  <span class='attributes_protected_by_default identifier id'>attributes_protected_by_default</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span> <span class='attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='a identifier id'>a</span> <span class='eq op'>==</span> <span class='string val'>&quot;ruby_class&quot;</span><span class='rbrace token'>}</span>
  <span class='record identifier id'>record</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='record identifier id'>record</span><span class='dot token'>.</span><span class='send identifier id'>send</span> <span class='symbol val'>:instance_variable_set</span><span class='comma token'>,</span> <span class='string val'>'@attributes'</span><span class='comma token'>,</span> <span class='attrs identifier id'>attrs</span>
  <span class='record identifier id'>record</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>decrement</h3>
</div><div id="decrement-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>decrement</span><span class='args'>(attribute, by = 1)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Initializes <tt>attribute</tt> to zero if <tt>nil</tt> and subtracts the
value passed as <tt>by</tt> (default is 1). The decrement is performed
directly on the underlying attribute, no setter is invoked. Only makes
sense for number-based attributes. Returns <tt>self</tt>.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1766</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1766">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1766
1767
1768
1769
1770</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='decrement identifier id'>decrement</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='by identifier id'>by</span> <span class='assign token'>=</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='lbrack token'>[</span><span class='attribute identifier id'>attribute</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
  <span class='self self kw'>self</span><span class='lbrack token'>[</span><span class='attribute identifier id'>attribute</span><span class='rbrack token'>]</span> <span class='opasgn op'>-=</span> <span class='by identifier id'>by</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>decrement!</h3>
</div><div id="decrement-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>decrement!</span><span class='args'>(attribute, by = 1)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Wrapper around <tt>decrement</tt> that saves the record. This method
differs from its non-bang version in that it passes through the attribute
setter. Saving is not subjected to validation checks. Returns <tt>true</tt>
if the record could be saved.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1776</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1776">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1776
1777
1778</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='decrement! fid id'>decrement!</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='by identifier id'>by</span> <span class='assign token'>=</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
  <span class='decrement identifier id'>decrement</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='by identifier id'>by</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='update_attribute identifier id'>update_attribute</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='lbrack token'>[</span><span class='attribute identifier id'>attribute</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>destroy</h3>
</div><div id="destroy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>destroy</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1690</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1690">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1690
1691
1692
1693
1694
1695</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='destroy identifier id'>destroy</span>
  <span class='unless unless kw'>unless</span> <span class='new_record? fid id'>new_record?</span>
    <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='database identifier id'>database</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='@attributes ivar id'>@attributes</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='freeze identifier id'>freeze</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>eql?</h3>
</div><div id="eql-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>eql?</span><span class='args'>(comparison_object)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Delegates to ==
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1897</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1897">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1897
1898
1899</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='eql? fid id'>eql?</span><span class='lparen token'>(</span><span class='comparison_object identifier id'>comparison_object</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span> <span class='eq op'>==</span> <span class='lparen token'>(</span><span class='comparison_object identifier id'>comparison_object</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>freeze</h3>
</div><div id="freeze-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>freeze</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Freeze the attributes hash such that associations are still accessible,
even on destroyed records.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1908</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1908">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1908
1909
1910</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='freeze identifier id'>freeze</span>
  <span class='@attributes ivar id'>@attributes</span><span class='dot token'>.</span><span class='freeze identifier id'>freeze</span><span class='semicolon token'>;</span> <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>frozen?</h3>
</div><div id="frozen-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>frozen?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns <tt>true</tt> if the attributes hash has been frozen.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1913</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1913">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1913
1914
1915</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='frozen? fid id'>frozen?</span>
  <span class='@attributes ivar id'>@attributes</span><span class='dot token'>.</span><span class='frozen? fid id'>frozen?</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_attribute?</h3>
</div><div id="has_attribute-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_attribute?</span><span class='args'>(attr_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if the given attribute is in the attributes hash
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1879</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1879">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1879
1880
1881</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='has_attribute? fid id'>has_attribute?</span><span class='lparen token'>(</span><span class='attr_name identifier id'>attr_name</span><span class='rparen token'>)</span>
  <span class='@attributes ivar id'>@attributes</span><span class='dot token'>.</span><span class='has_key? fid id'>has_key?</span><span class='lparen token'>(</span><span class='attr_name identifier id'>attr_name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>hash</h3>
</div><div id="hash-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>hash</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Delegates to id in order to allow two records of the same type and id to
work with something like:
</p>
<pre class="code">
  <span class='lbrack token'>[</span> <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='integer val'>2</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='integer val'>3</span><span class='rparen token'>)</span> <span class='rbrack token'>]</span> <span class='bitand op'>&amp;</span> <span class='lbrack token'>[</span> <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='Person constant id'>Person</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='integer val'>4</span><span class='rparen token'>)</span> <span class='rbrack token'>]</span> <span class='comment val'># =&gt; [ Person.find(1) ]</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1903</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1903">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1903
1904
1905</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='hash identifier id'>hash</span>
  <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='hash identifier id'>hash</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>increment</h3>
</div><div id="increment-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>increment</span><span class='args'>(attribute, by = 1)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Initializes <tt>attribute</tt> to zero if <tt>nil</tt> and adds the value
passed as <tt>by</tt> (default is 1). The increment is performed directly
on the underlying attribute, no setter is invoked. Only makes sense for
number-based attributes. Returns <tt>self</tt>.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1749</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1749">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1749
1750
1751
1752
1753</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='increment identifier id'>increment</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='by identifier id'>by</span> <span class='assign token'>=</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='lbrack token'>[</span><span class='attribute identifier id'>attribute</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>0</span>
  <span class='self self kw'>self</span><span class='lbrack token'>[</span><span class='attribute identifier id'>attribute</span><span class='rbrack token'>]</span> <span class='opasgn op'>+=</span> <span class='by identifier id'>by</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>increment!</h3>
</div><div id="increment-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>increment!</span><span class='args'>(attribute, by = 1)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Wrapper around <tt>increment</tt> that saves the record. This method
differs from its non-bang version in that it passes through the attribute
setter. Saving is not subjected to validation checks. Returns <tt>true</tt>
if the record could be saved.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1759</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1759">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1759
1760
1761</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='increment! fid id'>increment!</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='by identifier id'>by</span> <span class='assign token'>=</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
  <span class='increment identifier id'>increment</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='by identifier id'>by</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='update_attribute identifier id'>update_attribute</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='lbrack token'>[</span><span class='attribute identifier id'>attribute</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>inspect</h3>
</div><div id="inspect-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>inspect</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the contents of the record as a nicely formatted string.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1929</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1929">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1929
1930
1931
1932
1933
1934</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='inspect identifier id'>inspect</span>
  <span class='attributes_as_nice_string identifier id'>attributes_as_nice_string</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='property_names identifier id'>property_names</span> <span class='plus op'>+</span> <span class='unchangeable_property_names identifier id'>unchangeable_property_names</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='bitor op'>|</span>
    <span class='dstring node'>&quot;#{name}: #{attribute_for_inspect(name)}&quot;</span>
  <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;, &quot;</span><span class='rparen token'>)</span>
  <span class='dstring node'>&quot;#&lt;#{self.class} #{attributes_as_nice_string}&gt;&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>new_record?</h3>
</div><div id="new_record-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>new_record?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns true if this object hasn&#8217;t been saved yet &#8212; that is, a
record for the object doesn&#8217;t exist yet.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1668</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1668">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1668
1669
1670</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='new_record? fid id'>new_record?</span>
  <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='@new_record ivar id'>@new_record</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='@new_record ivar id'>@new_record</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>readonly!</h3>
</div><div id="readonly-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>readonly!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Marks this record as read only.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1924</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1924">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1924
1925
1926</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='readonly! fid id'>readonly!</span>
  <span class='@readonly ivar id'>@readonly</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>readonly?</h3>
</div><div id="readonly-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>readonly?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns <tt>true</tt> if the record is read only. Records loaded through
joins with piggy-back attributes will be marked as read only since they
cannot be saved.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1919</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1919">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1919
1920
1921</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='readonly? fid id'>readonly?</span>
  <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='@readonly ivar id'>@readonly</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='@readonly ivar id'>@readonly</span> <span class='eq op'>==</span> <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reload</h3>
</div><div id="reload-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reload</span><span class='args'>(options = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Reloads the attributes of this object from the database. The optional
options argument is passed to find when reloading so you may do e.g.
record.reload(:lock =&gt; true) to reload the same record with an exclusive
row lock.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1800</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1800">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1800
1801
1802
1803
1804
1805
1806</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reload identifier id'>reload</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='comment val'>#clear_aggregation_cache</span>
  <span class='clear_association_cache identifier id'>clear_association_cache</span>
  <span class='@attributes ivar id'>@attributes</span><span class='dot token'>.</span><span class='update identifier id'>update</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='dot token'>.</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='instance_variable_get identifier id'>instance_variable_get</span><span class='lparen token'>(</span><span class='string val'>'@attributes'</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='@attributes_cache ivar id'>@attributes_cache</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ruby_class</h3>
</div><div id="ruby_class-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ruby_class</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the ruby_class of the document, as stored in the document to know
which ruby object to map back to
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1658</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1658">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1658
1659
1660</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='ruby_class identifier id'>ruby_class</span>
  <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>&quot;ruby_class&quot;</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save</h3>
</div><div id="save-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <ul>
<li>No record exists: Creates a new record with values matching those of the
object attributes.

</li>
<li>A record does exist: Updates the record with values matching those of the
object attributes.

</li>
</ul>
<p>
Note: If your model specifies any validations then the method declaration
dynamically changes to:
</p>
<pre class="code">
  <span class='save identifier id'>save</span><span class='lparen token'>(</span><span class='perform_validation identifier id'>perform_validation</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='comma token'>,</span> <span class='bulk_save identifier id'>bulk_save</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='class identifier id'>class</span><span class='dot token'>.</span><span class='database identifier id'>database</span><span class='dot token'>.</span><span class='bulk_save? fid id'>bulk_save?</span><span class='rparen token'>)</span>
</pre>
<p>
Calling save(false) saves the model without running validations. See
CouchFoo::Validations for more information.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1680</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1680">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1680
1681
1682</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='save identifier id'>save</span>
  <span class='create_or_update identifier id'>create_or_update</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save!</h3>
</div><div id="save-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Attempts to save the record, but instead of just returning false if it
couldn&#8217;t happen, it raises a DocumentNotSaved exception.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1686</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1686">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1686
1687
1688</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='save! fid id'>save!</span>
  <span class='create_or_update identifier id'>create_or_update</span> <span class='orop op'>||</span> <span class='raise identifier id'>raise</span><span class='lparen token'>(</span><span class='DocumentNotSaved constant id'>DocumentNotSaved</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_param</h3>
</div><div id="to_param-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_param</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Enables Couch Foo objects to be used as URL parameters in Action Pack
automatically.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1663</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1663">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1663
1664
1665</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_param identifier id'>to_param</span>
  <span class='lparen token'>(</span><span class='id identifier id'>id</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='id identifier id'>id</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='colon op'>:</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>toggle</h3>
</div><div id="toggle-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>toggle</span><span class='args'>(attribute)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Assigns to <tt>attribute</tt> the boolean opposite of <tt>attribute?</tt>.
So if the predicate returns <tt>true</tt> the attribute will become
<tt>false</tt>. This method toggles directly the underlying value without
calling any setter. Returns <tt>self</tt>.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1784</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1784">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1784
1785
1786
1787</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='toggle identifier id'>toggle</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='lbrack token'>[</span><span class='attribute identifier id'>attribute</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='notop op'>!</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{attribute}?&quot;</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>toggle!</h3>
</div><div id="toggle-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>toggle!</span><span class='args'>(attribute)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Wrapper around <tt>toggle</tt> that saves the record. This method differs
from its non-bang version in that it passes through the attribute setter.
Saving is not subjected to validation checks. Returns <tt>true</tt> if the
record could be saved.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1793</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1793">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1793
1794
1795</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='toggle! fid id'>toggle!</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='rparen token'>)</span>
  <span class='toggle identifier id'>toggle</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='update_attribute identifier id'>update_attribute</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='self self kw'>self</span><span class='lbrack token'>[</span><span class='attribute identifier id'>attribute</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_attribute</h3>
</div><div id="update_attribute-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_attribute</span><span class='args'>(name, value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Updates a single attribute and saves the record. This is especially useful
for boolean flags on existing records. Note: This method is overwritten by
the Validation module that&#8217;ll make sure that updates made with this
method aren&#8217;t subjected to validation checks. Hence, attributes can
be updated even if the full object isn&#8217;t valid.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1727</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1727">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1727
1728
1729
1730</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='update_attribute identifier id'>update_attribute</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span> <span class='plus op'>+</span> <span class='string val'>'='</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='save identifier id'>save</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_attributes</h3>
</div><div id="update_attributes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_attributes</span><span class='args'>(attributes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Updates all the attributes from the passed-in Hash and saves the record. If
the object is invalid, the saving will fail and false will be returned.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1734</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1734">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1734
1735
1736
1737</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='update_attributes identifier id'>update_attributes</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='attributes identifier id'>attributes</span>
  <span class='save identifier id'>save</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update_attributes!</h3>
</div><div id="update_attributes-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update_attributes!</span><span class='args'>(attributes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Updates an object just like Base.update_attributes but calls save! instead
of save so an exception is raised if the record is invalid.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/couch_foo/base.rb', line 1741</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/georgepalmer/couch_foo/blob/13a37f5c452f8ebacb4a9caf0e225911cface3a6/lib/couch_foo/base.rb#L1741">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">1741
1742
1743
1744</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='update_attributes! fid id'>update_attributes!</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='attributes identifier id'>attributes</span>
  <span class='save! fid id'>save!</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>