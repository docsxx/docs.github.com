<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: EventMachine::HttpClient</title>
  </head>
  <body>
    <div id="content">
      <div class="section class EventMachine_HttpClient">
  <h1 class="title">Class: EventMachine::HttpClient</h1>
  <div class="section inheritance">
  <ul>
  <li>Connection</li><ul><li>EventMachine::HttpClient</li>
  </ul></ul>
</div><div class="section mixins">
  <h1>Included Modules</h1>
  <p>EventMachine::Deferrable, <a href='HttpClient/HttpEncoding.html' title='EventMachine::HttpEncoding'>EventMachine::HttpEncoding</a></p>
</div><div class="section attributes">
  <h1>Attributes</h1>

  
    <div class="instance">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">errors</td>
          <td class="readwrite">
            [<span id='errors-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>errors</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">method</td>
          <td class="readwrite">
            [<span id='method-instance_method'>R</span><span id='method%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>method</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">options</td>
          <td class="readwrite">
            [<span id='options-instance_method'>R</span><span id='options%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>options</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">response_header</td>
          <td class="readwrite">
            [<span id='response_header-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>response_header</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">response</td>
          <td class="readwrite">
            [<span id='response-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>response</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">uri</td>
          <td class="readwrite">
            [<span id='uri-instance_method'>R</span><span id='uri%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>uri</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h1>Constants</h1>
  <dl>
    
      <dt id="CONTENT_ENCODING-constant">CONTENT_ENCODING</dt>
      <dd>&quot;CONTENT_ENCODING&quot;</dd>
    
      <dt id="CONTENT_LENGTH-constant">CONTENT_LENGTH</dt>
      <dd>&quot;CONTENT_LENGTH&quot;</dd>
    
      <dt id="CRLF-constant">CRLF</dt>
      <dd>&quot;\r\n&quot;</dd>
    
      <dt id="HOST-constant">HOST</dt>
      <dd>&quot;HOST&quot;</dd>
    
      <dt id="KEEP_ALIVE-constant">KEEP_ALIVE</dt>
      <dd>&quot;CONNECTION&quot;</dd>
    
      <dt id="LOCATION-constant">LOCATION</dt>
      <dd>&quot;LOCATION&quot;</dd>
    
      <dt id="SET_COOKIE-constant">SET_COOKIE</dt>
      <dd>&quot;SET_COOKIE&quot;</dd>
    
      <dt id="TRANSFER_ENCODING-constant">TRANSFER_ENCODING</dt>
      <dd>&quot;TRANSFER_ENCODING&quot;</dd>
    
  </dl>
</div>
<div class="included">
  
  <div>
    <h1>Constants Included from <a href='HttpClient/HttpEncoding.html' title='EventMachine::HttpEncoding'>EventMachine::HttpEncoding</a></h1>
    <p><span class='name'><a href='HttpEncoding.html#BASIC_AUTH_ENCODING-constant' title='BASIC_AUTH_ENCODING'>BASIC_AUTH_ENCODING</a></span>, <span class='name'><a href='HttpEncoding.html#FIELD_ENCODING-constant' title='FIELD_ENCODING'>FIELD_ENCODING</a></span>, <span class='name'><a href='HttpEncoding.html#HTTP_REQUEST_HEADER-constant' title='HTTP_REQUEST_HEADER'>HTTP_REQUEST_HEADER</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#connection_completed-instance_method' title='#connection_completed'>#connection_completed</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
start HTTP request once we establish connection to host.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#dispatch-instance_method' title='#dispatch'>#dispatch</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Response processing.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#on_body_data-instance_method' title='#on_body_data'>#on_body_data</a></span><span class='args'>(data)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Called when part of the body has been read.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#on_decoded_body_data-instance_method' title='#on_decoded_body_data'>#on_decoded_body_data</a></span><span class='args'>(data)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#on_error-instance_method' title='#on_error'>#on_error</a></span><span class='args'>(msg)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
request failed, invoke errback.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#on_request_complete-instance_method' title='#on_request_complete'>#on_request_complete</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
request is done, invoke the callback.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#post_init-instance_method' title='#post_init'>#post_init</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#receive_data-instance_method' title='#receive_data'>#receive_data</a></span><span class='args'>(data)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#send_request_body-instance_method' title='#send_request_body'>#send_request_body</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#send_request_header-instance_method' title='#send_request_header'>#send_request_header</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#unbind-instance_method' title='#unbind'>#unbind</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h1>Public Instance Methods Included from <a href='HttpClient/HttpEncoding.html' title='EventMachine::HttpEncoding'>EventMachine::HttpEncoding</a></h1>
    <p><span class='name'><a href='HttpEncoding.html#encode_basic_auth-instance_method' title='encode_basic_auth'>encode_basic_auth</a></span>, <span class='name'><a href='HttpEncoding.html#encode_cookies-instance_method' title='encode_cookies'>encode_cookies</a></span>, <span class='name'><a href='HttpEncoding.html#encode_field-instance_method' title='encode_field'>encode_field</a></span>, <span class='name'><a href='HttpEncoding.html#encode_headers-instance_method' title='encode_headers'>encode_headers</a></span>, <span class='name'><a href='HttpEncoding.html#encode_host-instance_method' title='encode_host'>encode_host</a></span>, <span class='name'><a href='HttpEncoding.html#encode_param-instance_method' title='encode_param'>encode_param</a></span>, <span class='name'><a href='HttpEncoding.html#encode_query-instance_method' title='encode_query'>encode_query</a></span>, <span class='name'><a href='HttpEncoding.html#encode_request-instance_method' title='encode_request'>encode_request</a></span>, <span class='name'><a href='HttpEncoding.html#escape-instance_method' title='escape'>escape</a></span>, <span class='name'><a href='HttpEncoding.html#munge_header_keys-instance_method' title='munge_header_keys'>munge_header_keys</a></span>, <span class='name'><a href='HttpEncoding.html#unescape-instance_method' title='unescape'>unescape</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>connection_completed</h3>
</div><div id="connection_completed-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>connection_completed</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
start HTTP request once we establish connection to host
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


173
174
175
176</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 173</span>

<span class='def def kw'>def</span> <span class='connection_completed identifier id'>connection_completed</span>
  <span class='send_request_header identifier id'>send_request_header</span>
  <span class='send_request_body identifier id'>send_request_body</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>dispatch</h3>
</div><div id="dispatch-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>dispatch</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Response processing
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 266</span>

<span class='def def kw'>def</span> <span class='dispatch identifier id'>dispatch</span>
<span class='while while kw'>while</span> <span class='case case kw'>case</span> <span class='@state ivar id'>@state</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:response_header</span>
    <span class='parse_response_header identifier id'>parse_response_header</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:chunk_header</span>
    <span class='parse_chunk_header identifier id'>parse_chunk_header</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:chunk_body</span>
    <span class='process_chunk_body identifier id'>process_chunk_body</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:chunk_footer</span>
    <span class='process_chunk_footer identifier id'>process_chunk_footer</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:response_footer</span>
    <span class='process_response_footer identifier id'>process_response_footer</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:body</span>
    <span class='process_body identifier id'>process_body</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:finished</span><span class='comma token'>,</span> <span class='symbol val'>:invalid</span>
    <span class='break break kw'>break</span>
  <span class='else else kw'>else</span> <span class='raise identifier id'>raise</span> <span class='RuntimeError constant id'>RuntimeError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;invalid state: #{@state}&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>on_body_data</h3>
</div><div id="on_body_data-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>on_body_data</span><span class='args'>(data)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Called when part of the body has been read
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


237
238
239
240
241
242
243
244
245
246
247</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 237</span>

<span class='def def kw'>def</span> <span class='on_body_data identifier id'>on_body_data</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='@content_decoder ivar id'>@content_decoder</span>
    <span class='begin begin kw'>begin</span>
      <span class='@content_decoder ivar id'>@content_decoder</span> <span class='lshft op'>&lt;&lt;</span> <span class='data identifier id'>data</span>
    <span class='rescue rescue kw'>rescue</span> <span class='HttpDecoders constant id'>HttpDecoders</span><span class='colon2 op'>::</span><span class='DecoderError constant id'>DecoderError</span>
      <span class='on_error identifier id'>on_error</span> <span class='string val'>&quot;Content-decoder error&quot;</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='on_decoded_body_data identifier id'>on_decoded_body_data</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>on_decoded_body_data</h3>
</div><div id="on_decoded_body_data-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>on_decoded_body_data</span><span class='args'>(data)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


249
250
251
252
253
254
255</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 249</span>

<span class='def def kw'>def</span> <span class='on_decoded_body_data identifier id'>on_decoded_body_data</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='on_response identifier id'>on_response</span> <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='on_response identifier id'>on_response</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='on_response identifier id'>on_response</span><span class='dot token'>.</span><span class='call identifier id'>call</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='@response ivar id'>@response</span> <span class='lshft op'>&lt;&lt;</span> <span class='data identifier id'>data</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>on_error</h3>
</div><div id="on_error-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>on_error</span><span class='args'>(msg)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
request failed, invoke errback
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


189
190
191
192</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 189</span>

<span class='def def kw'>def</span> <span class='on_error identifier id'>on_error</span><span class='lparen token'>(</span><span class='msg identifier id'>msg</span><span class='rparen token'>)</span>
  <span class='@errors ivar id'>@errors</span> <span class='assign token'>=</span> <span class='msg identifier id'>msg</span>
  <span class='unbind identifier id'>unbind</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>on_request_complete</h3>
</div><div id="on_request_complete-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>on_request_complete</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
request is done, invoke the callback
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


179
180
181
182
183
184
185
186</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 179</span>

<span class='def def kw'>def</span> <span class='on_request_complete identifier id'>on_request_complete</span>
  <span class='begin begin kw'>begin</span>
    <span class='@content_decoder ivar id'>@content_decoder</span><span class='dot token'>.</span><span class='finalize! fid id'>finalize!</span> <span class='if if_mod kw'>if</span> <span class='@content_decoder ivar id'>@content_decoder</span>
  <span class='rescue rescue kw'>rescue</span> <span class='HttpDecoders constant id'>HttpDecoders</span><span class='colon2 op'>::</span><span class='DecoderError constant id'>DecoderError</span>
    <span class='on_error identifier id'>on_error</span> <span class='string val'>&quot;Content-decoder error&quot;</span>
  <span class='end end kw'>end</span>
  <span class='unbind identifier id'>unbind</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>post_init</h3>
</div><div id="post_init-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>post_init</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


158
159
160
161
162
163
164
165
166
167
168
169
170</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 158</span>

<span class='def def kw'>def</span> <span class='post_init identifier id'>post_init</span>
  <span class='@parser ivar id'>@parser</span> <span class='assign token'>=</span> <span class='HttpClientParser constant id'>HttpClientParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@data ivar id'>@data</span> <span class='assign token'>=</span> <span class='EventMachine constant id'>EventMachine</span><span class='colon2 op'>::</span><span class='Buffer constant id'>Buffer</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@response_header ivar id'>@response_header</span> <span class='assign token'>=</span> <span class='HttpResponseHeader constant id'>HttpResponseHeader</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='@chunk_header ivar id'>@chunk_header</span> <span class='assign token'>=</span> <span class='HttpChunkHeader constant id'>HttpChunkHeader</span><span class='dot token'>.</span><span class='new identifier id'>new</span>

  <span class='@state ivar id'>@state</span> <span class='assign token'>=</span> <span class='symbol val'>:response_header</span>
  <span class='@parser_nbytes ivar id'>@parser_nbytes</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='@response ivar id'>@response</span> <span class='assign token'>=</span> <span class='string val'>''</span>
  <span class='@inflate ivar id'>@inflate</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@errors ivar id'>@errors</span> <span class='assign token'>=</span> <span class='string val'>''</span>
  <span class='@content_decoder ivar id'>@content_decoder</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>receive_data</h3>
</div><div id="receive_data-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>receive_data</span><span class='args'>(data)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


231
232
233
234</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 231</span>

<span class='def def kw'>def</span> <span class='receive_data identifier id'>receive_data</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='rparen token'>)</span>
  <span class='@data ivar id'>@data</span> <span class='lshft op'>&lt;&lt;</span> <span class='data identifier id'>data</span>
  <span class='dispatch identifier id'>dispatch</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>send_request_body</h3>
</div><div id="send_request_body-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>send_request_body</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


221
222
223
224
225
226
227
228
229</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 221</span>

<span class='def def kw'>def</span> <span class='send_request_body identifier id'>send_request_body</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:body</span><span class='rbrack token'>]</span>
  <span class='if if kw'>if</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='colon op'>:</span><span class='body identifier id'>body</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span> <span class='Hash constant id'>Hash</span>
    <span class='body identifier id'>body</span> <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:body</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_params identifier id'>to_params</span>
  <span class='else else kw'>else</span>
    <span class='body identifier id'>body</span> <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:body</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='send_data identifier id'>send_data</span> <span class='body identifier id'>body</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>send_request_header</h3>
</div><div id="send_request_header-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>send_request_header</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 194</span>

<span class='def def kw'>def</span> <span class='send_request_header identifier id'>send_request_header</span>
  <span class='query identifier id'>query</span>   <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:query</span><span class='rbrack token'>]</span>
  <span class='head identifier id'>head</span>    <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:head</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='munge_header_keys identifier id'>munge_header_keys</span><span class='lparen token'>(</span><span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:head</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='body identifier id'>body</span>    <span class='assign token'>=</span> <span class='@options ivar id'>@options</span><span class='lbrack token'>[</span><span class='symbol val'>:body</span><span class='rbrack token'>]</span>

  <span class='comment val'># Set the Host header if it hasn't been specified already</span>
  <span class='head identifier id'>head</span><span class='lbrack token'>[</span><span class='string val'>'host'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='encode_host identifier id'>encode_host</span>

  <span class='comment val'># Set the Content-Length if body is given</span>
  <span class='head identifier id'>head</span><span class='lbrack token'>[</span><span class='string val'>'content-length'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span>  <span class='body identifier id'>body</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='if if_mod kw'>if</span> <span class='body identifier id'>body</span>

  <span class='comment val'># Set the User-Agent if it hasn't been specified</span>
  <span class='head identifier id'>head</span><span class='lbrack token'>[</span><span class='string val'>'user-agent'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>&quot;EventMachine HttpClient&quot;</span>

  <span class='comment val'># Set auto-inflate flags</span>
  <span class='if if kw'>if</span> <span class='head identifier id'>head</span><span class='lbrack token'>[</span><span class='string val'>'accept-encoding'</span><span class='rbrack token'>]</span>
    <span class='@inflate ivar id'>@inflate</span> <span class='assign token'>=</span> <span class='head identifier id'>head</span><span class='lbrack token'>[</span><span class='string val'>'accept-encoding'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='t identifier id'>t</span><span class='bitor op'>|</span> <span class='t identifier id'>t</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span><span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Build the request</span>
  <span class='request_header identifier id'>request_header</span> <span class='assign token'>=</span> <span class='encode_request identifier id'>encode_request</span><span class='lparen token'>(</span><span class='@method ivar id'>@method</span><span class='comma token'>,</span> <span class='@uri ivar id'>@uri</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='query identifier id'>query</span><span class='rparen token'>)</span>
  <span class='request_header identifier id'>request_header</span> <span class='lshft op'>&lt;&lt;</span> <span class='encode_headers identifier id'>encode_headers</span><span class='lparen token'>(</span><span class='head identifier id'>head</span><span class='rparen token'>)</span>
  <span class='request_header identifier id'>request_header</span> <span class='lshft op'>&lt;&lt;</span> <span class='CRLF constant id'>CRLF</span>

  <span class='send_data identifier id'>send_data</span> <span class='request_header identifier id'>request_header</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>unbind</h3>
</div><div id="unbind-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>unbind</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


257
258
259
260</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/em-http/client.rb', line 257</span>

<span class='def def kw'>def</span> <span class='unbind identifier id'>unbind</span>
  <span class='lparen token'>(</span><span class='@state ivar id'>@state</span> <span class='eq op'>==</span> <span class='symbol val'>:finished</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='succeed identifier id'>succeed</span><span class='lparen token'>(</span><span class='self self kw'>self</span><span class='rparen token'>)</span> <span class='colon op'>:</span> <span class='fail identifier id'>fail</span>
  <span class='close_connection identifier id'>close_connection</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>