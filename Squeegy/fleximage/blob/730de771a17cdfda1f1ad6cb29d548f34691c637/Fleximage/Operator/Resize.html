<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>Squeegy's fleximage - Class: Fleximage::Operator::Resize - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/Squeegy/commits/fleximage/master" rel="alternate" title="Recent Commits to fleximage:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("Squeegy", "fleximage", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("Squeegy", "fleximage", "730de771a17cdfda1f1ad6cb29d548f34691c637", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/Squeegy/fleximage/tree/">Source</a></li>
            <li class=""><a href="http://github.com/Squeegy/fleximage/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/Squeegy/fleximage/network">Network</a></li>            
            <li class=""><a href="http://github.com/Squeegy/fleximage/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/Squeegy/fleximage">Wiki</a></li>
            <li class=""><a href="http://github.com/Squeegy/fleximage/graphs">Graphs</a></li>                    
            <li class="active"><a href="/Squeegy/fleximage">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/Squeegy">Squeegy</a> / <b><a href="http://github.com/Squeegy/fleximage/tree">fleximage</a></b>        
                <a id="namespaces_button" rel="Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Fleximage_Operator_Resize">
  <h1>Class: Fleximage::Operator::Resize</h1>
  <div class="section inheritance">
  <ul>
  <li><a href="Base.html" title="Fleximage::Operator::Base">Fleximage::Operator::Base</a></li><ul><li>Fleximage::Operator::Resize</li>
  </ul></ul>
</div><div class="section docstring">
  <p>
Resize this image, constraining proportions. Options allow cropping,
stretching, upsampling and padding.
</p>
<pre class="code">
  <span class='image identifier id'>image</span><span class='dot token'>.</span><span class='resize identifier id'>resize</span><span class='lparen token'>(</span><span class='size identifier id'>size</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>
<p>
<tt>size</tt> is size of the output image after the resize operation.
Accepts either <tt>&#8216;123x456&#8217;</tt> format or <tt>[123, 456]</tt>
format.
</p>
<p>
Use the following keys in the <tt>options</tt> hash:
</p>
<ul>
<li><tt>crop</tt>: pass true to this option to make the ouput image exactly the
same dimensions as <tt>size</tt>. The default behaviour will resize the
image without cropping any part meaning the image will be no bigger than
the <tt>size</tt>. When <tt>:crop</tt> is true the final image is resized
to fit as much as possible in the frame, and then crops it to make it
exactly the dimensions declared by the <tt>size</tt> argument.

</li>
<li><tt>upsample</tt>: By default the image will never display larger than its
original dimensions, no matter how large the <tt>size</tt> argument is.
Pass <tt>true</tt> to use this option to allow upsampling, disabling the
default behaviour.

</li>
<li><tt>padding</tt>: This option will pad the space around your image with a
solid color to make it exactly the requested size. Pass <tt>true</tt>, for
the default of <tt>white</tt>, or give it a text or pixel color like
<tt>&quot;red&quot;</tt> or <tt>color(255, 127, 0)</tt>. This is like the
opposite of the <tt>crop</tt> option. Instead of trimming the image to make
it exactly the requested size, it will make sure the entire image is
visible, but adds space around the edges to make it the right dimensions.

</li>
<li><tt>stretch</tt>: Set this option to true and the image will not preserve
its aspect ratio. The final image will stretch to fit the requested
<tt>size</tt>. The resulting image is exactly the size you ask for.

</li>
</ul>
<p>
Example:
</p>
<pre class="code">
  <span class='@photo ivar id'>@photo</span><span class='dot token'>.</span><span class='operate identifier id'>operate</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='image identifier id'>image</span><span class='bitor op'>|</span>
    <span class='image identifier id'>image</span><span class='dot token'>.</span><span class='resize identifier id'>resize</span> <span class='string val'>'200x200'</span><span class='comma token'>,</span> <span class='symbol val'>:crop</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section constants">
  
</div><div class="section constructor">
<h2>Constructor</h2>
  <p class="inherited_msg">
    This class inherits a constructor from <a href="Base.html#initialize-instance_method" title="Fleximage::Operator::Base">Fleximage::Operator::Base</a>.
  </p>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <div class="inherited">
  
  <div>
    <h2>Public Class Methods Inherited from <a href="Base.html" title="Fleximage::Operator::Base">Fleximage::Operator::Base</a></h2>
    <p><span class='name'><a href="Base.html#color-class_method" title="color">color</a></span>, <span class='name'><a href="Base.html#size_to_xy-class_method" title="size_to_xy">size_to_xy</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#operate-instance_method">#operate</span><span class='args'>(size, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Instance Methods Inherited from <a href="Base.html" title="Fleximage::Operator::Base">Fleximage::Operator::Base</a></h2>
    <p><span class='name'><a href="Base.html#color-instance_method" title="color">color</a></span>, <span class='name'><a href="Base.html#execute-instance_method" title="execute">execute</a></span>, <span class='name'><a href="Base.html#scale-instance_method" title="scale">scale</a></span>, <span class='name'><a href="Base.html#scale_and_crop-instance_method" title="scale_and_crop">scale_and_crop</a></span>, <span class='name'><a href="Base.html#size_to_xy-instance_method" title="size_to_xy">size_to_xy</a></span>, <span class='name'><a href="Base.html#stretch-instance_method" title="stretch">stretch</a></span>, <span class='name'><a href="Base.html#symbol_to_blending_mode-instance_method" title="symbol_to_blending_mode">symbol_to_blending_mode</a></span>, <span class='name'><a href="Base.html#symbol_to_gravity-instance_method" title="symbol_to_gravity">symbol_to_gravity</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>operate</h3>
</div><div id="operate-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>operate</span><span class='args'>(size, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/operator/resize.rb', line 39</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/operator/resize.rb#L39">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='operate identifier id'>operate</span><span class='lparen token'>(</span><span class='size identifier id'>size</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='symbolize_keys identifier id'>symbolize_keys</span>
  
  <span class='comment val'># Find dimensions</span>
  <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='size_to_xy identifier id'>size_to_xy</span><span class='lparen token'>(</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>

  <span class='comment val'># prevent upscaling unless :usample param exists.</span>
  <span class='unless unless kw'>unless</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:upsample</span><span class='rbrack token'>]</span>
    <span class='x identifier id'>x</span> <span class='assign token'>=</span> <span class='@image ivar id'>@image</span><span class='dot token'>.</span><span class='columns identifier id'>columns</span> <span class='if if_mod kw'>if</span> <span class='x identifier id'>x</span> <span class='gt op'>&gt;</span> <span class='@image ivar id'>@image</span><span class='dot token'>.</span><span class='columns identifier id'>columns</span>
    <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='@image ivar id'>@image</span><span class='dot token'>.</span><span class='rows identifier id'>rows</span>    <span class='if if_mod kw'>if</span> <span class='y identifier id'>y</span> <span class='gt op'>&gt;</span> <span class='@image ivar id'>@image</span><span class='dot token'>.</span><span class='rows identifier id'>rows</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Perform image resize</span>
  <span class='case case kw'>case</span>
  <span class='when when kw'>when</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:crop</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:crop</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Hash constant id'>Hash</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='@image ivar id'>@image</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:crop_resized!</span><span class='rparen token'>)</span>
    <span class='comment val'># perform resize and crop</span>
    <span class='scale_and_crop identifier id'>scale_and_crop</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='when when kw'>when</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:stretch</span><span class='rbrack token'>]</span>
    <span class='comment val'># stretch the image, ignoring aspect ratio</span>
    <span class='stretch identifier id'>stretch</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='else else kw'>else</span>
    <span class='comment val'># perform the resize without crop</span>
    <span class='scale identifier id'>scale</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

  <span class='end end kw'>end</span>

  <span class='comment val'># apply padding if necesary</span>
  <span class='if if kw'>if</span> <span class='padding_color identifier id'>padding_color</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:padding</span><span class='rbrack token'>]</span>
    <span class='comment val'># get color</span>
    <span class='padding_color identifier id'>padding_color</span> <span class='assign token'>=</span> <span class='string val'>'white'</span> <span class='if if_mod kw'>if</span> <span class='padding_color identifier id'>padding_color</span> <span class='eq op'>==</span> <span class='true true kw'>true</span>

    <span class='comment val'># get original x and y.  This makes it play nice if the requested size is larger </span>
    <span class='comment val'># than the image and upsampling is not allowed.</span>
    <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='size_to_xy identifier id'>size_to_xy</span><span class='lparen token'>(</span><span class='size identifier id'>size</span><span class='rparen token'>)</span>

    <span class='comment val'># get proper border sizes</span>
    <span class='x_border identifier id'>x_border</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span> <span class='minus op'>-</span> <span class='@image ivar id'>@image</span><span class='dot token'>.</span><span class='columns identifier id'>columns</span> <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='max identifier id'>max</span>
    <span class='y_border identifier id'>y_border</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='y identifier id'>y</span> <span class='minus op'>-</span> <span class='@image ivar id'>@image</span><span class='dot token'>.</span><span class='rows identifier id'>rows</span>    <span class='plus op'>+</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='div op'>/</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='max identifier id'>max</span>

    <span class='comment val'># apply padding</span>
    <span class='@image ivar id'>@image</span><span class='dot token'>.</span><span class='border! fid id'>border!</span><span class='lparen token'>(</span><span class='x_border identifier id'>x_border</span><span class='comma token'>,</span> <span class='y_border identifier id'>y_border</span><span class='comma token'>,</span> <span class='padding_color identifier id'>padding_color</span><span class='rparen token'>)</span>

    <span class='comment val'># crop to remove possible extra pixel</span>
    <span class='@image ivar id'>@image</span><span class='dot token'>.</span><span class='crop! fid id'>crop!</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  
  <span class='return return kw'>return</span> <span class='@image ivar id'>@image</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>