<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>Squeegy's fleximage - Module: Fleximage::Model::ClassMethods - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/Squeegy/commits/fleximage/master" rel="alternate" title="Recent Commits to fleximage:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("Squeegy", "fleximage", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("Squeegy", "fleximage", "730de771a17cdfda1f1ad6cb29d548f34691c637", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/Squeegy/fleximage/tree/">Source</a></li>
            <li class=""><a href="http://github.com/Squeegy/fleximage/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/Squeegy/fleximage/network">Network</a></li>            
            <li class=""><a href="http://github.com/Squeegy/fleximage/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/Squeegy/fleximage">Wiki</a></li>
            <li class=""><a href="http://github.com/Squeegy/fleximage/graphs">Graphs</a></li>                    
            <li class="active"><a href="/Squeegy/fleximage">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/Squeegy">Squeegy</a> / <b><a href="http://github.com/Squeegy/fleximage/tree">fleximage</a></b>        
                <a id="namespaces_button" rel="Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Fleximage_Model_ClassMethods">
  <h1>Module: Fleximage::Model::ClassMethods</h1>
  <div class="section mixins">
  <h2>Included Modules</h2>
  <p><a href="InstanceMethods.html" title="Fleximage::Model::InstanceMethods">Fleximage::Model::InstanceMethods</a></p>
</div><div class="section docstring">
  <p>
Provides class methods for Fleximage for use in model classes. The only
class method is acts_as_fleximage which integrates Fleximage functionality
into a model class.
</p>
<p>
The following class level accessors also get inserted.
</p>
<ul>
<li><tt>image_directory</tt>: (String, no default) Where the master images are
stored, directory path relative to your app root.

</li>
<li><tt>use_creation_date_based_directories</tt>: (Boolean, default
<tt>true</tt>) If true, master images will be stored in directories based
on creation date. For example:
<tt>&quot;#{image_directory}/2007/11/24/123.png&quot;</tt> for an image
with an id of 123 and a creation date of November 24, 2007. Turing this off
would cause the path to be &quot;#{image_directory}/123.png&quot; instead.
This helps keep the OS from having directories that are too full.

</li>
<li><tt>image_storage_format</tt>: (:png or :jpg, default :png) The format of
your master images. Using :png will give you the best quality, since the
master images as stored as lossless version of the original upload. :jpg
will apply lossy compression, but the master image file sizes will be much
smaller. If storage space is a concern, us :jpg.

</li>
<li><tt>require_image</tt>: (Boolean, default <tt>true</tt>) The model will
raise a validation error if no image is uploaded with the record. Setting
to false allows record to be saved with no images.

</li>
<li><tt>missing_image_message</tt>: (String, default &quot;is required&quot;)
Validation message to display when no image was uploaded for a record.

</li>
<li><tt>invalid_image_message</tt>: (String default &quot;was not a readable
image&quot;) Validation message when an image is uploaded, but is not an
image format that can be read by RMagick.

</li>
<li><tt>output_image_jpg_quality</tt>: (Integer, default 85) When rendering
JPGs, this represents the amount of compression. Valid values are 0-100,
where 0 is very small and very ugly, and 100 is near lossless but very
large in filesize.

</li>
<li><tt>default_image_path</tt>: (String, nil default) If no image is present
for this record, the image at this path will be used instead. Useful for a
placeholder graphic for new content that may not have an image just yet.

</li>
<li><tt>default_image</tt>: A hash which defines an empty starting image. This
hash look like: <tt>:size =&gt; &#8216;123x456&#8217;, :color =&gt;
:transparent</tt>, where <tt>:size</tt> defines the dimensions of the
default image, and <tt>:color</tt> defines the fill. <tt>:color</tt> can be
a named color as a string (&#8216;red&#8217;), :transparent, or a
Magick::Pixel object.

</li>
<li><tt>preprocess_image</tt>: (Block, no default) Call this class method just
like you would call <tt>operate</tt> in a view. The image transoformation
in the provided block will be run on every uploaded image before its saved
as the master image.

</li>
</ul>
<p>
Example:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Photo constant id'>Photo</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='acts_as_fleximage identifier id'>acts_as_fleximage</span> <span class='do do kw'>do</span>
      <span class='image_directory identifier id'>image_directory</span> <span class='string val'>'public/images/uploaded'</span>
      <span class='use_creation_date_based_directories identifier id'>use_creation_date_based_directories</span> <span class='true true kw'>true</span>
      <span class='image_storage_format identifier id'>image_storage_format</span>      <span class='symbol val'>:png</span>
      <span class='require_image identifier id'>require_image</span>             <span class='true true kw'>true</span>
      <span class='missing_image_message identifier id'>missing_image_message</span>     <span class='string val'>'is required'</span>
      <span class='invalid_image_message identifier id'>invalid_image_message</span>     <span class='string val'>'was not a readable image'</span>     <span class='comment val'>#       default_image_path        'public/images/no_photo_yet.png'</span>
      <span class='default_image identifier id'>default_image</span>             <span class='nil nil kw'>nil</span>
      <span class='output_image_jpg_quality identifier id'>output_image_jpg_quality</span>  <span class='integer val'>85</span>

      <span class='preprocess_image identifier id'>preprocess_image</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='image identifier id'>image</span><span class='bitor op'>|</span>
        <span class='image identifier id'>image</span><span class='dot token'>.</span><span class='resize identifier id'>resize</span> <span class='string val'>'1024x768'</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># normal model methods...</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">image_file_temp</td>
          <td class="readwrite">
            [<span id='image_file_temp-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The filename of the temp image.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">jpg_compression_quality</td>
          <td class="readwrite">
            [<span id='jpg_compression_quality-instance_method'>R</span><span id='jpg_compression_quality=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Setter for jpg compression quality at the instance level.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#db_store-3F-class_method">db_store?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Internal method to ask this class if it stores image in the DB.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#has_store-3F-class_method">has_store?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#image_too_small_message-class_method">image_too_small_message</span><span class='args'>(str = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Image too small message Should include <tt>{minimum</tt>}.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#invalid_image_message-class_method">invalid_image_message</span><span class='args'>(str = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Invalid image message dsl_accessor :invalid_image_message, :default =&gt;
&#8216;was not a readable image&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#missing_image_message-class_method">missing_image_message</span><span class='args'>(str = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Missing image message dsl_accessor :missing_image_message, :default =&gt;
&#8216;is required&#8217;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#preprocess_image-class_method">preprocess_image</span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Call this class method just like you would call <tt>operate</tt> in a view.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#translate_error_message-class_method">translate_error_message</span><span class='args'>(name, fallback, options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#acts_as_fleximage-instance_method">#acts_as_fleximage</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Use this method to include Fleximage functionality in your model.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#image_file_exists-instance_method">#image_file_exists</span><span class='args'>(file)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h2>Public Instance Methods Included from <a href="InstanceMethods.html" title="Fleximage::Model::InstanceMethods">Fleximage::Model::InstanceMethods</a></h2>
    <p><span class='name'><a href="InstanceMethods.html#delete_image_file-instance_method" title="delete_image_file">delete_image_file</a></span>, <span class='name'><a href="InstanceMethods.html#directory_path-instance_method" title="directory_path">directory_path</a></span>, <span class='name'><a href="InstanceMethods.html#file_path-instance_method" title="file_path">file_path</a></span>, <span class='name'><a href="InstanceMethods.html#has_image%3F-instance_method" title="has_image?">has_image?</a></span>, <span class='name'><a href="InstanceMethods.html#has_saved_image%3F-instance_method" title="has_saved_image?">has_saved_image?</a></span>, <span class='name'><a href="InstanceMethods.html#image_file%3D-instance_method" title="image_file=">image_file=</a></span>, <span class='name'><a href="InstanceMethods.html#image_file_base64%3D-instance_method" title="image_file_base64=">image_file_base64=</a></span>, <span class='name'><a href="InstanceMethods.html#image_file_string%3D-instance_method" title="image_file_string=">image_file_string=</a></span>, <span class='name'><a href="InstanceMethods.html#image_file_temp%3D-instance_method" title="image_file_temp=">image_file_temp=</a></span>, <span class='name'><a href="InstanceMethods.html#image_file_url-instance_method" title="image_file_url">image_file_url</a></span>, <span class='name'><a href="InstanceMethods.html#image_file_url%3D-instance_method" title="image_file_url=">image_file_url=</a></span>, <span class='name'><a href="InstanceMethods.html#load_image-instance_method" title="load_image">load_image</a></span>, <span class='name'><a href="InstanceMethods.html#operate-instance_method" title="operate">operate</a></span>, <span class='name'><a href="InstanceMethods.html#output_image-instance_method" title="output_image">output_image</a></span>, <span class='name'><a href="InstanceMethods.html#validate_image-instance_method" title="validate_image">validate_image</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>db_store?</h3>
</div><div id="db_store-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>db_store?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Internal method to ask this class if it stores image in the DB.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/model.rb', line 88</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/model.rb#L88">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">88
89
90
91
92
93
94
95
96</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='db_store? fid id'>db_store?</span>
  <span class='if if kw'>if</span> <span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:columns</span><span class='rparen token'>)</span>
    <span class='columns identifier id'>columns</span><span class='dot token'>.</span><span class='find identifier id'>find</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='col identifier id'>col</span><span class='bitor op'>|</span>
      <span class='col identifier id'>col</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='eq op'>==</span> <span class='string val'>'image_file_data'</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>has_store?</h3>
</div><div id="has_store-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>has_store?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/model.rb', line 98</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/model.rb#L98">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">98
99
100</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='has_store? fid id'>has_store?</span>
  <span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:columns</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='db_store? fid id'>db_store?</span> <span class='orop op'>||</span> <span class='image_directory identifier id'>image_directory</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>image_too_small_message</h3>
</div><div id="image_too_small_message-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>image_too_small_message</span><span class='args'>(str = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Image too small message Should include <tt>{minimum</tt>}
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/model.rb', line 164</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/model.rb#L164">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">164
165
166
167
168
169
170
171
172
173
174
175
176</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='image_too_small_message identifier id'>image_too_small_message</span><span class='lparen token'>(</span><span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='fb identifier id'>fb</span> <span class='assign token'>=</span> <span class='string val'>&quot;is too small (Minimum: {{minimum}})&quot;</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='minimum_size identifier id'>minimum_size</span> <span class='assign token'>=</span> <span class='Fleximage constant id'>Fleximage</span><span class='colon2 op'>::</span><span class='Operator constant id'>Operator</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='size_to_xy identifier id'>size_to_xy</span><span class='lparen token'>(</span><span class='validates_image_size identifier id'>validates_image_size</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'x'</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='@image_too_small_message ivar id'>@image_too_small_message</span>
      <span class='@image_too_small_message ivar id'>@image_too_small_message</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='string val'>&quot;{{minimum}}&quot;</span><span class='comma token'>,</span> <span class='minimum_size identifier id'>minimum_size</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
      <span class='translate_error_message identifier id'>translate_error_message</span><span class='lparen token'>(</span><span class='string val'>&quot;image_too_small&quot;</span><span class='comma token'>,</span> <span class='fb identifier id'>fb</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='string val'>&quot;{{minimum}}&quot;</span><span class='comma token'>,</span> <span class='minimum_size identifier id'>minimum_size</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:minimum</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='minimum_size identifier id'>minimum_size</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='@image_too_small_message ivar id'>@image_too_small_message</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>invalid_image_message</h3>
</div><div id="invalid_image_message-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>invalid_image_message</span><span class='args'>(str = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Invalid image message dsl_accessor :invalid_image_message, :default =&gt;
&#8216;was not a readable image&#8217;
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/model.rb', line 150</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/model.rb#L150">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">150
151
152
153
154
155
156
157
158
159
160</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='invalid_image_message identifier id'>invalid_image_message</span><span class='lparen token'>(</span><span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='if if kw'>if</span> <span class='@invalid_image_message ivar id'>@invalid_image_message</span>
      <span class='@invalid_image_message ivar id'>@invalid_image_message</span>
    <span class='else else kw'>else</span>
      <span class='translate_error_message identifier id'>translate_error_message</span><span class='lparen token'>(</span><span class='string val'>&quot;invalid_image&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;was not a readable image&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='@invalid_image_message ivar id'>@invalid_image_message</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>missing_image_message</h3>
</div><div id="missing_image_message-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>missing_image_message</span><span class='args'>(str = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Missing image message dsl_accessor :missing_image_message, :default =&gt;
&#8216;is required&#8217;
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/model.rb', line 134</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/model.rb#L134">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">134
135
136
137
138
139
140
141
142
143
144
145</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='missing_image_message identifier id'>missing_image_message</span><span class='lparen token'>(</span><span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='if if kw'>if</span> <span class='@missing_image_message ivar id'>@missing_image_message</span>
      <span class='@missing_image_message ivar id'>@missing_image_message</span>
    <span class='else else kw'>else</span>
      <span class='translate_error_message identifier id'>translate_error_message</span><span class='lparen token'>(</span><span class='string val'>&quot;missing_image&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;is required&quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    
  <span class='else else kw'>else</span>
    <span class='@missing_image_message ivar id'>@missing_image_message</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>preprocess_image</h3>
</div><div id="preprocess_image-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>preprocess_image</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Call this class method just like you would call <tt>operate</tt> in a view.
The image transoformation in the provided block will be run on every
uploaded image before its saved as the master image.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/model.rb', line 83</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/model.rb#L83">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">83
84
85</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='preprocess_image identifier id'>preprocess_image</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='preprocess_image_operation identifier id'>preprocess_image_operation</span><span class='lparen token'>(</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>translate_error_message</h3>
</div><div id="translate_error_message-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>translate_error_message</span><span class='args'>(name, fallback, options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/model.rb', line 125</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/model.rb#L125">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">125
126
127
128
129
130</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='translate_error_message identifier id'>translate_error_message</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='fallback identifier id'>fallback</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='translation identifier id'>translation</span> <span class='assign token'>=</span> <span class='I18n constant id'>I18n</span><span class='dot token'>.</span><span class='translate identifier id'>translate</span> <span class='dstring node'>&quot;activerecord.errors.models.#{self.model_name.underscore}.#{name}&quot;</span><span class='comma token'>,</span> <span class='options identifier id'>options</span>
  <span class='if if kw'>if</span> <span class='translation identifier id'>translation</span><span class='dot token'>.</span><span class='match identifier id'>match</span> <span class='regexp val'>/translation missing:/</span>
    <span class='I18n constant id'>I18n</span><span class='dot token'>.</span><span class='translate identifier id'>translate</span> <span class='dstring node'>&quot;activerecord.errors.messages.#{name}&quot;</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='lbrace token'>{</span> <span class='symbol val'>:default</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='fallback identifier id'>fallback</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>acts_as_fleximage</h3>
</div><div id="acts_as_fleximage-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>acts_as_fleximage</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Use this method to include Fleximage functionality in your model. It takes
an options hash with a single required key, :<tt>image_directory</tt>. This
key should point to the directory you want your images stored on your
server. Or configure with a nice looking block.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  
</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/model.rb', line 75</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/model.rb#L75">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='acts_as_fleximage identifier id'>acts_as_fleximage</span><span class='lparen token'>(</span><span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  
  <span class='comment val'># Include the necesary instance methods</span>
  <span class='include identifier id'>include</span> <span class='Fleximage constant id'>Fleximage</span><span class='colon2 op'>::</span><span class='Model constant id'>Model</span><span class='colon2 op'>::</span><span class='InstanceMethods constant id'>InstanceMethods</span>
  
  <span class='comment val'># Call this class method just like you would call +operate+ in a view.</span>
  <span class='comment val'># The image transoformation in the provided block will be run on every uploaded image before its saved as the </span>
  <span class='comment val'># master image.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='preprocess_image identifier id'>preprocess_image</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
    <span class='preprocess_image_operation identifier id'>preprocess_image_operation</span><span class='lparen token'>(</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># Internal method to ask this class if it stores image in the DB.</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='db_store? fid id'>db_store?</span>
    <span class='if if kw'>if</span> <span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:columns</span><span class='rparen token'>)</span>
      <span class='columns identifier id'>columns</span><span class='dot token'>.</span><span class='find identifier id'>find</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='col identifier id'>col</span><span class='bitor op'>|</span>
        <span class='col identifier id'>col</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='eq op'>==</span> <span class='string val'>'image_file_data'</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='false false kw'>false</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='has_store? fid id'>has_store?</span>
    <span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:columns</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='db_store? fid id'>db_store?</span> <span class='orop op'>||</span> <span class='image_directory identifier id'>image_directory</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># validation callback</span>
  <span class='validate identifier id'>validate</span> <span class='symbol val'>:validate_image</span> <span class='if if_mod kw'>if</span> <span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:validate</span><span class='rparen token'>)</span>
  
  <span class='comment val'># The filename of the temp image.  Used for storing of good images when validation fails</span>
  <span class='comment val'># and the form needs to be redisplayed.</span>
  <span class='attr_reader identifier id'>attr_reader</span> <span class='symbol val'>:image_file_temp</span>
  
  <span class='comment val'># Setter for jpg compression quality at the instance level</span>
  <span class='attr_accessor identifier id'>attr_accessor</span> <span class='symbol val'>:jpg_compression_quality</span>
  
  <span class='comment val'># Where images get stored</span>
  <span class='dsl_accessor identifier id'>dsl_accessor</span> <span class='symbol val'>:image_directory</span>
  
  <span class='comment val'># Put uploads from different days into different subdirectories</span>
  <span class='dsl_accessor identifier id'>dsl_accessor</span> <span class='symbol val'>:use_creation_date_based_directories</span><span class='comma token'>,</span> <span class='symbol val'>:default</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span>
  
  <span class='comment val'># The format are master images are stored in</span>
  <span class='dsl_accessor identifier id'>dsl_accessor</span> <span class='symbol val'>:image_storage_format</span><span class='comma token'>,</span> <span class='symbol val'>:default</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Proc constant id'>Proc</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='lbrace token'>{</span> <span class='symbol val'>:png</span> <span class='rbrace token'>}</span>
  
  <span class='comment val'># Require a valid image.  Defaults to true.  Set to false if its ok to have no image for</span>
  <span class='dsl_accessor identifier id'>dsl_accessor</span> <span class='symbol val'>:require_image</span><span class='comma token'>,</span> <span class='symbol val'>:default</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span>
  
  
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='translate_error_message identifier id'>translate_error_message</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='fallback identifier id'>fallback</span><span class='comma token'>,</span> <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='translation identifier id'>translation</span> <span class='assign token'>=</span> <span class='I18n constant id'>I18n</span><span class='dot token'>.</span><span class='translate identifier id'>translate</span> <span class='dstring node'>&quot;activerecord.errors.models.#{self.model_name.underscore}.#{name}&quot;</span><span class='comma token'>,</span> <span class='options identifier id'>options</span>
    <span class='if if kw'>if</span> <span class='translation identifier id'>translation</span><span class='dot token'>.</span><span class='match identifier id'>match</span> <span class='regexp val'>/translation missing:/</span>
      <span class='I18n constant id'>I18n</span><span class='dot token'>.</span><span class='translate identifier id'>translate</span> <span class='dstring node'>&quot;activerecord.errors.messages.#{name}&quot;</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='lbrace token'>{</span> <span class='symbol val'>:default</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='fallback identifier id'>fallback</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># Missing image message</span>
  <span class='comment val'>#dsl_accessor :missing_image_message, :default =&gt; 'is required'</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='missing_image_message identifier id'>missing_image_message</span><span class='lparen token'>(</span><span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
      <span class='if if kw'>if</span> <span class='@missing_image_message ivar id'>@missing_image_message</span>
        <span class='@missing_image_message ivar id'>@missing_image_message</span>
      <span class='else else kw'>else</span>
        <span class='translate_error_message identifier id'>translate_error_message</span><span class='lparen token'>(</span><span class='string val'>&quot;missing_image&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;is required&quot;</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      
    <span class='else else kw'>else</span>
      <span class='@missing_image_message ivar id'>@missing_image_message</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  
  <span class='comment val'># Invalid image message</span>
  <span class='comment val'>#dsl_accessor :invalid_image_message, :default =&gt; 'was not a readable image'</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='invalid_image_message identifier id'>invalid_image_message</span><span class='lparen token'>(</span><span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
      <span class='if if kw'>if</span> <span class='@invalid_image_message ivar id'>@invalid_image_message</span>
        <span class='@invalid_image_message ivar id'>@invalid_image_message</span>
      <span class='else else kw'>else</span>
        <span class='translate_error_message identifier id'>translate_error_message</span><span class='lparen token'>(</span><span class='string val'>&quot;invalid_image&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;was not a readable image&quot;</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='@invalid_image_message ivar id'>@invalid_image_message</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># Image too small message</span>
  <span class='comment val'># Should include {{minimum}}</span>
  <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='image_too_small_message identifier id'>image_too_small_message</span><span class='lparen token'>(</span><span class='str identifier id'>str</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='fb identifier id'>fb</span> <span class='assign token'>=</span> <span class='string val'>&quot;is too small (Minimum: {{minimum}})&quot;</span>
    <span class='if if kw'>if</span> <span class='str identifier id'>str</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
      <span class='minimum_size identifier id'>minimum_size</span> <span class='assign token'>=</span> <span class='Fleximage constant id'>Fleximage</span><span class='colon2 op'>::</span><span class='Operator constant id'>Operator</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span><span class='dot token'>.</span><span class='size_to_xy identifier id'>size_to_xy</span><span class='lparen token'>(</span><span class='validates_image_size identifier id'>validates_image_size</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'x'</span><span class='rparen token'>)</span>
      <span class='if if kw'>if</span> <span class='@image_too_small_message ivar id'>@image_too_small_message</span>
        <span class='@image_too_small_message ivar id'>@image_too_small_message</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='string val'>&quot;{{minimum}}&quot;</span><span class='comma token'>,</span> <span class='minimum_size identifier id'>minimum_size</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='translate_error_message identifier id'>translate_error_message</span><span class='lparen token'>(</span><span class='string val'>&quot;image_too_small&quot;</span><span class='comma token'>,</span> <span class='fb identifier id'>fb</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='string val'>&quot;{{minimum}}&quot;</span><span class='comma token'>,</span> <span class='minimum_size identifier id'>minimum_size</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='symbol val'>:minimum</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='minimum_size identifier id'>minimum_size</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
      <span class='@image_too_small_message ivar id'>@image_too_small_message</span> <span class='assign token'>=</span> <span class='str identifier id'>str</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># Sets the quality of rendered JPGs</span>
  <span class='dsl_accessor identifier id'>dsl_accessor</span> <span class='symbol val'>:output_image_jpg_quality</span><span class='comma token'>,</span> <span class='symbol val'>:default</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>85</span>
  
  <span class='comment val'># Set a default image to use when no image has been assigned to this record</span>
  <span class='dsl_accessor identifier id'>dsl_accessor</span> <span class='symbol val'>:default_image_path</span>
  
  <span class='comment val'># Set a default image based on a a size and fill</span>
  <span class='dsl_accessor identifier id'>dsl_accessor</span> <span class='symbol val'>:default_image</span>
  
  <span class='comment val'># A block that processes an image before it gets saved as the master image of a record.</span>
  <span class='comment val'># Can be helpful to resize potentially huge images to something more manageable. Set via</span>
  <span class='comment val'># the &quot;preprocess_image { |image| ... }&quot; class method.</span>
  <span class='dsl_accessor identifier id'>dsl_accessor</span> <span class='symbol val'>:preprocess_image_operation</span>
  
  <span class='comment val'># Set a minimum size ([x, y] e.g. 200, '800x600', [800, 600])</span>
  <span class='comment val'># Set '0x600' to just enforce y size or</span>
  <span class='comment val'># '800x0' to just validate x size.</span>
  <span class='dsl_accessor identifier id'>dsl_accessor</span> <span class='symbol val'>:validates_image_size</span>
  
  <span class='comment val'># Image related save and destroy callbacks</span>
  <span class='if if kw'>if</span> <span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:before_save</span><span class='rparen token'>)</span>
    <span class='after_destroy identifier id'>after_destroy</span> <span class='symbol val'>:delete_image_file</span>
    <span class='before_save identifier id'>before_save</span>   <span class='symbol val'>:pre_save</span>
    <span class='after_save identifier id'>after_save</span>    <span class='symbol val'>:post_save</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># execute configuration block</span>
  <span class='yield yield kw'>yield</span> <span class='if if_mod kw'>if</span> <span class='block_given? fid id'>block_given?</span>
  
  <span class='comment val'># set the image directory from passed options</span>
  <span class='image_directory identifier id'>image_directory</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:image_directory</span><span class='rbrack token'>]</span> <span class='if if_mod kw'>if</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:image_directory</span><span class='rbrack token'>]</span>
  
  <span class='comment val'># Require the declaration of a master image storage directory</span>
  <span class='if if kw'>if</span> <span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:validate</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='image_directory identifier id'>image_directory</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='db_store? fid id'>db_store?</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='default_image identifier id'>default_image</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='default_image_path identifier id'>default_image_path</span>
    <span class='raise identifier id'>raise</span> <span class='string val'>&quot;No place to put images!  Declare this via the :image_directory =&gt; 'path/to/directory' option\n&quot;</span><span class='plus op'>+</span>
          <span class='string val'>&quot;Or add a database column named image_file_data for DB storage\n&quot;</span><span class='plus op'>+</span>
          <span class='string val'>&quot;Or set :virtual to true if this class has no image store at all\n&quot;</span><span class='plus op'>+</span>
          <span class='string val'>&quot;Or set a default image to show with :default_image or :default_image_path&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>image_file_exists</h3>
</div><div id="image_file_exists-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>image_file_exists</span><span class='args'>(file)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/fleximage/model.rb', line 219</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/Squeegy/fleximage/blob/730de771a17cdfda1f1ad6cb29d548f34691c637/lib/fleximage/model.rb#L219">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">219
220
221
222
223
224
225
226
227
228
229
230
231
232</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='image_file_exists identifier id'>image_file_exists</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span>
  <span class='comment val'># File must be a valid object</span>
  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  
  <span class='comment val'># Get the size of the file.  file.size works for form-uploaded images, file.stat.size works</span>
  <span class='comment val'># for file object created by File.open('foo.jpg', 'rb').  It must have a size &gt; 0.</span>
  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:size</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='colon op'>:</span> <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='dot token'>.</span><span class='size identifier id'>size</span><span class='rparen token'>)</span> <span class='leq op'>&lt;=</span> <span class='integer val'>0</span>
  
  <span class='comment val'># object must respond to the read method to fetch its contents.</span>
  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='notop op'>!</span><span class='file identifier id'>file</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span><span class='lparen token'>(</span><span class='symbol val'>:read</span><span class='rparen token'>)</span>
  
  <span class='comment val'># file validation passed, return true</span>
  <span class='true true kw'>true</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>