<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>ahoward's helene - Class: Rightscale::HttpConnection - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/ahoward/commits/helene/master" rel="alternate" title="Recent Commits to helene:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("ahoward", "helene", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("ahoward", "helene", "ae407b60b0d282acdacd024861f002a58ab5d446", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/ahoward/helene/tree/">Source</a></li>
            <li class=""><a href="http://github.com/ahoward/helene/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/ahoward/helene/network">Network</a></li>            
            <li class=""><a href="http://github.com/ahoward/helene/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/ahoward/helene">Wiki</a></li>
            <li class=""><a href="http://github.com/ahoward/helene/graphs">Graphs</a></li>                    
            <li class="active"><a href="/ahoward/helene">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/ahoward">ahoward</a> / <b><a href="http://github.com/ahoward/helene/tree">helene</a></b>        
                <a id="namespaces_button" rel="ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Rightscale_HttpConnection">
  <h1>Class: Rightscale::HttpConnection</h1>
  <div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">eof</td>
          <td class="readwrite">
            [<span id='eof-instance_method'>R</span><span id='eof=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>eof</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">http</td>
          <td class="readwrite">
            [<span id='http-instance_method'>R</span><span id='http=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <hr size="10"></hr><p>
instance methods ------------.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">logger</td>
          <td class="readwrite">
            [<span id='logger-instance_method'>R</span><span id='logger=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>logger</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">params</td>
          <td class="readwrite">
            [<span id='params-instance_method'>R</span><span id='params=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
see @@params.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">server</td>
          <td class="readwrite">
            [<span id='server-instance_method'>R</span><span id='server=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>server</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">state</td>
          <td class="readwrite">
            [<span id='state-instance_method'>R</span><span id='state=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>state</tt>.
</p>

            
          </td>
        </tr>
      
        <tr>
          <th class="name">thread</td>
          <td class="readwrite">
            [<span id='thread-instance_method'>R</span><span id='thread=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>thread</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  
</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(params = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Params hash:
</p>
<pre class="code">
 <span class='symbol val'>:user_agent</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'www.HostName.com'</span>    <span class='comment val'># String to report as HTTP User agent</span>
 <span class='symbol val'>:ca_file</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'path_to_file'</span>        <span class='comment val'># A path of a CA certification file in PEM format. The file can contain several CA certificates.</span>
 <span class='symbol val'>:logger</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Logger constant id'>Logger</span> <span class='object identifier id'>object</span>         <span class='comment val'># If omitted, HttpConnection logs to STDOUT</span>
 <span class='symbol val'>:exception</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Exception constant id'>Exception</span> <span class='to identifier id'>to</span> <span class='raise identifier id'>raise</span>    <span class='comment val'># The type of exception to raise if a request repeatedly fails. RuntimeError is raised if this parameter is omitted.</span>
 <span class='symbol val'>:http_connection_retry_count</span>         <span class='comment val'># by default == Rightscale::HttpConnection.params[:http_connection_retry_count]</span>
 <span class='symbol val'>:http_connection_open_timeout</span>        <span class='comment val'># by default == Rightscale::HttpConnection.params[:http_connection_open_timeout]</span>
 <span class='symbol val'>:http_connection_read_timeout</span>        <span class='comment val'># by default == Rightscale::HttpConnection.params[:http_connection_read_timeout]</span>
 <span class='symbol val'>:http_connection_retry_delay</span>         <span class='comment val'># by default == Rightscale::HttpConnection.params[:http_connection_retry_delay]</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 156</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L156">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@thread ivar id'>@thread</span> <span class='assign token'>=</span> <span class='Thread constant id'>Thread</span><span class='dot token'>.</span><span class='current identifier id'>current</span>
  <span class='@caller ivar id'>@caller</span> <span class='assign token'>=</span> <span class='caller identifier id'>caller</span>
  <span class='@params ivar id'>@params</span> <span class='assign token'>=</span> <span class='params identifier id'>params</span>
  <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_retry_count</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='@@params ivar id'>@@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_retry_count</span><span class='rbrack token'>]</span>
  <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_open_timeout</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='@@params ivar id'>@@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_open_timeout</span><span class='rbrack token'>]</span>
  <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_read_timeout</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='@@params ivar id'>@@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_read_timeout</span><span class='rbrack token'>]</span>
  <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_retry_delay</span><span class='rbrack token'>]</span>  <span class='opasgn op'>||=</span> <span class='@@params ivar id'>@@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_retry_delay</span><span class='rbrack token'>]</span>
  <span class='@http ivar id'>@http</span>   <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='@server ivar id'>@server</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='@logger ivar id'>@logger</span> <span class='assign token'>=</span> <span class='get_param identifier id'>get_param</span><span class='lparen token'>(</span><span class='symbol val'>:logger</span><span class='rparen token'>)</span>
  <span class='@logger ivar id'>@logger</span> <span class='opasgn op'>||=</span> <span class='RAILS_DEFAULT_LOGGER constant id'>RAILS_DEFAULT_LOGGER</span> <span class='if if_mod kw'>if</span> <span class='defined? defined kw'>defined?</span><span class='lparen token'>(</span><span class='RAILS_DEFAULT_LOGGER constant id'>RAILS_DEFAULT_LOGGER</span><span class='rparen token'>)</span>
  <span class='@logger ivar id'>@logger</span> <span class='opasgn op'>||=</span> <span class='NullLogger constant id'>NullLogger</span>
  <span class='@ca_file ivar id'>@ca_file</span> <span class='assign token'>=</span> <span class='get_param identifier id'>get_param</span><span class='lparen token'>(</span><span class='symbol val'>:ca_file</span><span class='rparen token'>)</span>
  <span class='@state ivar id'>@state</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@eof ivar id'>@eof</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#params-class_method">params</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Query the global (class-level) parameters:.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#params-3D-class_method">params=</span><span class='args'>(params)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set the global (class-level) parameters.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#finish-instance_method">#finish</span><span class='args'>(reason = '')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_param-instance_method">#get_param</span><span class='args'>(name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#local_read_size-3D-instance_method">#local_read_size=</span><span class='args'>(newsize)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set the maximum size (in bytes) of a single read from local data sources
like files.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#local_read_size-3F-instance_method">#local_read_size?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Query for the maximum size (in bytes) of a single read from local data
sources like files.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#log-instance_method">#log</span><span class='args'>(*args, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#log_request-instance_method">#log_request</span><span class='args'>(request_params)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#log_response-instance_method">#log_response</span><span class='args'>(response)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#prevent_mt_use-21-instance_method">#prevent_mt_use!</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#request-instance_method">#request</span><span class='args'>(request_params, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#socket_read_size-3D-instance_method">#socket_read_size=</span><span class='args'>(newsize)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set the maximum size (in bytes) of a single read from the underlying
socket.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#socket_read_size-3F-instance_method">#socket_read_size?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Query for the maximum size (in bytes) of a single read from the underlying
socket.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>params</h3>
</div><div id="params-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>params</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Query the global (class-level) parameters:
</p>
<pre class="code">
 <span class='symbol val'>:user_agent</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'www.HostName.com'</span>    <span class='comment val'># String to report as HTTP User agent</span>
 <span class='symbol val'>:ca_file</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'path_to_file'</span>        <span class='comment val'># Path to a CA certification file in PEM format. The file can contain several CA certificates.  If this parameter isn't set, HTTPS certs won't be verified.</span>
 <span class='symbol val'>:logger</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Logger constant id'>Logger</span> <span class='object identifier id'>object</span>         <span class='comment val'># If omitted, HttpConnection logs to STDOUT</span>
 <span class='symbol val'>:exception</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Exception constant id'>Exception</span> <span class='to identifier id'>to</span> <span class='raise identifier id'>raise</span>    <span class='comment val'># The type of exception to raise</span>
                                      <span class='comment val'># if a request repeatedly fails. RuntimeError is raised if this parameter is omitted.</span>
 <span class='symbol val'>:http_connection_retry_count</span>         <span class='comment val'># by default == Rightscale::HttpConnection::HTTP_CONNECTION_RETRY_COUNT</span>
 <span class='symbol val'>:http_connection_open_timeout</span>        <span class='comment val'># by default == Rightscale::HttpConnection::HTTP_CONNECTION_OPEN_TIMEOUT</span>
 <span class='symbol val'>:http_connection_read_timeout</span>        <span class='comment val'># by default == Rightscale::HttpConnection::HTTP_CONNECTION_READ_TIMEOUT</span>
 <span class='symbol val'>:http_connection_retry_delay</span>         <span class='comment val'># by default == Rightscale::HttpConnection::HTTP_CONNECTION_RETRY_DELAY</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 120</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L120">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">120
121
122</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='params identifier id'>params</span>
  <span class='@@params ivar id'>@@params</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>params=</h3>
</div><div id="params-3D-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>params=</span><span class='args'>(params)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set the global (class-level) parameters
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 125</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L125">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">125
126
127</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='params identifier id'>params</span><span class='assign token'>=</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='@@params ivar id'>@@params</span> <span class='assign token'>=</span> <span class='params identifier id'>params</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>finish</h3>
</div><div id="finish-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>finish</span><span class='args'>(reason = '')</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 487</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L487">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">487
488
489
490
491
492
493
494</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='finish identifier id'>finish</span><span class='lparen token'>(</span><span class='reason identifier id'>reason</span> <span class='assign token'>=</span> <span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='comment val'># prevent_mt_use!</span>
  <span class='if if kw'>if</span> <span class='@http ivar id'>@http</span> <span class='andop op'>&amp;&amp;</span> <span class='@http ivar id'>@http</span><span class='dot token'>.</span><span class='started? fid id'>started?</span>
    <span class='reason identifier id'>reason</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;, reason: '#{reason}'&quot;</span> <span class='unless unless_mod kw'>unless</span> <span class='reason identifier id'>reason</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
    <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='symbol val'>:info</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Closing #{@http.use_ssl? ? 'HTTPS' : 'HTTP'} connection to #{@http.address}:#{@http.port}#{reason}&quot;</span><span class='rparen token'>)</span>
    <span class='@http ivar id'>@http</span><span class='dot token'>.</span><span class='finish identifier id'>finish</span> <span class='rescue rescue kw'>rescue</span> <span class='nil nil kw'>nil</span>  <span class='comment val'># it's possible for a Thread to reset this before we can finish it (so it wouldn't be started)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_param</h3>
</div><div id="get_param-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_param</span><span class='args'>(name)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 195</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L195">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">195
196
197</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_param identifier id'>get_param</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='@@params ivar id'>@@params</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>local_read_size=</h3>
</div><div id="local_read_size-3D-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>local_read_size=</span><span class='args'>(newsize)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set the maximum size (in bytes) of a single read from local data sources
like files. This can be used to tune the performance of, for example, a
streaming PUT of a large buffer.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 223</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L223">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">223
224
225</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='local_read_size= identifier id'>local_read_size=</span><span class='lparen token'>(</span><span class='newsize identifier id'>newsize</span><span class='rparen token'>)</span>
  <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='HTTPGenericRequest constant id'>HTTPGenericRequest</span><span class='dot token'>.</span><span class='local_read_size identifier id'>local_read_size</span><span class='assign token'>=</span><span class='lparen token'>(</span><span class='newsize identifier id'>newsize</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>local_read_size?</h3>
</div><div id="local_read_size-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>local_read_size?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Query for the maximum size (in bytes) of a single read from local data
sources like files. This is important, for example, in a streaming PUT of a
large buffer.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 216</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L216">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">216
217
218</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='local_read_size? fid id'>local_read_size?</span>
  <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='HTTPGenericRequest constant id'>HTTPGenericRequest</span><span class='dot token'>.</span><span class='local_read_size? fid id'>local_read_size?</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>log</h3>
</div><div id="log-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>log</span><span class='args'>(*args, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 174</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L174">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">174
175
176</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='@logger ivar id'>@logger</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='args identifier id'>args</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='@logger ivar id'>@logger</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>log_request</h3>
</div><div id="log_request-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>log_request</span><span class='args'>(request_params)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 458</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L458">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">458
459
460
461
462
463
464
465
466
467
468
469
470
471</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='log_request identifier id'>log_request</span><span class='lparen token'>(</span><span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='debug? fid id'>debug?</span>
  <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='debug identifier id'>debug</span><span class='lbrace token'>{</span> <span class='dstring node'>&quot;HttpConnection - request_params=#{ request_params.inspect }&quot;</span> <span class='rbrace token'>}</span>
  <span class='if if kw'>if</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='symbol val'>:request</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='method identifier id'>method</span> <span class='assign token'>=</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='method identifier id'>method</span>
    <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='path identifier id'>path</span>
    <span class='comment val'>#body = (request.body.size &gt; 42 ? (request.body[0,42] + '...') : request.body) if request.body</span>
    <span class='body identifier id'>body</span> <span class='assign token'>=</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='body identifier id'>body</span>
    <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='debug identifier id'>debug</span><span class='lbrace token'>{</span> <span class='dstring node'>&quot;HttpConnection - request.method=#{ method.inspect }&quot;</span> <span class='rbrace token'>}</span>
    <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='debug identifier id'>debug</span><span class='lbrace token'>{</span> <span class='dstring node'>&quot;HttpConnection - request.path=#{ path.inspect }&quot;</span> <span class='rbrace token'>}</span>
    <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='debug identifier id'>debug</span><span class='lbrace token'>{</span> <span class='dstring node'>&quot;HttpConnection - request.body=#{ body.inspect }&quot;</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>log_response</h3>
</div><div id="log_response-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>log_response</span><span class='args'>(response)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 473</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L473">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">473
474
475
476
477
478
479
480
481
482
483
484
485</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='log_response identifier id'>log_response</span><span class='lparen token'>(</span><span class='response identifier id'>response</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='debug? fid id'>debug?</span>
  <span class='if if kw'>if</span> <span class='response identifier id'>response</span>
    <span class='code identifier id'>code</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='code identifier id'>code</span>
    <span class='message identifier id'>message</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='message identifier id'>message</span>
    <span class='comment val'>#body = (response.body.size &gt; 42 ? (response.body[0,42] + '...') : response.body) if response.body</span>
    <span class='body identifier id'>body</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='body identifier id'>body</span>
    <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='debug identifier id'>debug</span><span class='lbrace token'>{</span> <span class='dstring node'>&quot;HttpConnection - response.code=#{ code.inspect }&quot;</span> <span class='rbrace token'>}</span>
    <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='debug identifier id'>debug</span><span class='lbrace token'>{</span> <span class='dstring node'>&quot;HttpConnection - response.message=#{ message.inspect }&quot;</span> <span class='rbrace token'>}</span>
    <span class='logger identifier id'>logger</span><span class='dot token'>.</span><span class='debug identifier id'>debug</span><span class='lbrace token'>{</span> <span class='dstring node'>&quot;HttpConnection - response.body=#{ body.inspect }&quot;</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>prevent_mt_use!</h3>
</div><div id="prevent_mt_use-21-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>prevent_mt_use!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 178</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L178">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">178
179
180
181
182
183
184</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='prevent_mt_use! fid id'>prevent_mt_use!</span>
  <span class='unless unless kw'>unless</span> <span class='Thread constant id'>Thread</span><span class='dot token'>.</span><span class='current identifier id'>current</span><span class='eq op'>==</span><span class='@thread ivar id'>@thread</span>
    <span class='msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='string val'>&quot;@thread : \#{ @thread.inspect }\n\n@caller : \#{ @caller.inspect }\n\nthread  : \#{ Thread.current.inspect }\n\ncaller  : \#{ caller.inspect }\n&quot;</span>
    
    <span class='raise identifier id'>raise</span> <span class='ThreadError constant id'>ThreadError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='comma token'>,</span> <span class='msg identifier id'>msg</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>request</h3>
</div><div id="request-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>request</span><span class='args'>(request_params, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 367</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L367">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='request identifier id'>request</span><span class='lparen token'>(</span><span class='request_params identifier id'>request_params</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='comment val'># prevent_mt_use!</span>
  <span class='log_request identifier id'>log_request</span><span class='lparen token'>(</span><span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span> <span class='rescue rescue kw'>rescue</span> <span class='nil nil kw'>nil</span>
  <span class='comment val'># We save the offset here so that if we need to retry, we can return the file pointer to its initial position</span>
  <span class='mypos identifier id'>mypos</span> <span class='assign token'>=</span> <span class='get_fileptr_offset identifier id'>get_fileptr_offset</span><span class='lparen token'>(</span><span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
  <span class='loop identifier id'>loop</span> <span class='do do kw'>do</span>
    <span class='comment val'># if we are inside a delay between retries: no requests this time!</span>
    <span class='if if kw'>if</span> <span class='error_count identifier id'>error_count</span> <span class='gt op'>&gt;</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_retry_count</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span>
       <span class='error_time identifier id'>error_time</span> <span class='plus op'>+</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:http_connection_retry_delay</span><span class='rbrack token'>]</span> <span class='gt op'>&gt;</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span>
      <span class='comment val'># store the message (otherwise it will be lost after error_reset and</span>
      <span class='comment val'># we will raise an exception with an empty text)</span>
      <span class='banana_message_text identifier id'>banana_message_text</span> <span class='assign token'>=</span> <span class='banana_message identifier id'>banana_message</span>
      <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='symbol val'>:warn</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{err_header} re-raising same error: #{banana_message_text} &quot;</span> <span class='plus op'>+</span>
                  <span class='dstring node'>&quot;-- error count: #{error_count}, error age: #{Time.now.to_i - error_time.to_i}&quot;</span><span class='rparen token'>)</span>
      <span class='exception identifier id'>exception</span> <span class='assign token'>=</span> <span class='get_param identifier id'>get_param</span><span class='lparen token'>(</span><span class='symbol val'>:exception</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='RuntimeError constant id'>RuntimeError</span>
      <span class='raise identifier id'>raise</span> <span class='exception identifier id'>exception</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='banana_message_text identifier id'>banana_message_text</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># try to connect server(if connection does not exist) and get response data</span>
    <span class='begin begin kw'>begin</span>
      <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='symbol val'>:protocol</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lparen token'>(</span><span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='symbol val'>:port</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='integer val'>443</span> <span class='question op'>?</span> <span class='string val'>'https'</span> <span class='colon op'>:</span> <span class='string val'>'http'</span><span class='rparen token'>)</span>

      <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='symbol val'>:request</span><span class='rbrack token'>]</span>
      <span class='request identifier id'>request</span><span class='lbrack token'>[</span><span class='string val'>'User-Agent'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='get_param identifier id'>get_param</span><span class='lparen token'>(</span><span class='symbol val'>:user_agent</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='string val'>''</span>

      <span class='comment val'># (re)open connection to server if none exists or params has changed</span>
      <span class='unless unless kw'>unless</span> <span class='@http ivar id'>@http</span>          <span class='andop op'>&amp;&amp;</span>
             <span class='@http ivar id'>@http</span><span class='dot token'>.</span><span class='started? fid id'>started?</span> <span class='andop op'>&amp;&amp;</span>
             <span class='@server ivar id'>@server</span>   <span class='eq op'>==</span> <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='symbol val'>:server</span><span class='rbrack token'>]</span> <span class='andop op'>&amp;&amp;</span>
             <span class='@port ivar id'>@port</span>     <span class='eq op'>==</span> <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='symbol val'>:port</span><span class='rbrack token'>]</span>   <span class='andop op'>&amp;&amp;</span>
             <span class='@protocol ivar id'>@protocol</span> <span class='eq op'>==</span> <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='symbol val'>:protocol</span><span class='rbrack token'>]</span>
        <span class='start identifier id'>start</span><span class='lparen token'>(</span><span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>

      <span class='comment val'># Detect if the body is a streamable object like a file or socket.  If so, stream that</span>
      <span class='comment val'># bad boy.</span>
      <span class='setup_streaming identifier id'>setup_streaming</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='rparen token'>)</span>
      <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='@http ivar id'>@http</span><span class='dot token'>.</span><span class='request identifier id'>request</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
      <span class='log_response identifier id'>log_response</span><span class='lparen token'>(</span><span class='response identifier id'>response</span><span class='rparen token'>)</span> <span class='rescue rescue kw'>rescue</span> <span class='nil nil kw'>nil</span>

      <span class='error_reset identifier id'>error_reset</span>
      <span class='eof_reset identifier id'>eof_reset</span>
      <span class='return return kw'>return</span> <span class='response identifier id'>response</span>

    <span class='comment val'># We treat EOF errors and the timeout/network errors differently.  Both</span>
    <span class='comment val'># are tracked in different statistics blocks.  Note below that EOF</span>
    <span class='comment val'># errors will sleep for a certain (exponentially increasing) period.</span>
    <span class='comment val'># Other errors don't sleep because there is already an inherent delay</span>
    <span class='comment val'># in them; connect and read timeouts (for example) have already</span>
    <span class='comment val'># 'slept'.  It is still not clear which way we should treat errors</span>
    <span class='comment val'># like RST and resolution failures.  For now, there is no additional</span>
    <span class='comment val'># delay for these errors although this may change in the future.</span>

    <span class='comment val'># EOFError means the server closed the connection on us.</span>
    <span class='rescue rescue kw'>rescue</span> <span class='EOFError constant id'>EOFError</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
      <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='symbol val'>:debug</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{err_header} server #{@server} closed connection&quot;</span><span class='rparen token'>)</span>
      <span class='@http ivar id'>@http</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>

        <span class='comment val'># if we have waited long enough - raise an exception...</span>
      <span class='if if kw'>if</span> <span class='raise_on_eof_exception? fid id'>raise_on_eof_exception?</span>
        <span class='exception identifier id'>exception</span> <span class='assign token'>=</span> <span class='get_param identifier id'>get_param</span><span class='lparen token'>(</span><span class='symbol val'>:exception</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='RuntimeError constant id'>RuntimeError</span>
        <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='symbol val'>:warn</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{err_header} raising #{exception} due to permanent EOF being received from #{@server}, error age: #{Time.now.to_i - eof_time.to_i}&quot;</span><span class='rparen token'>)</span>
        <span class='raise identifier id'>raise</span> <span class='exception identifier id'>exception</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;Permanent EOF is being received from #{@server}.&quot;</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
          <span class='comment val'># ... else just sleep a bit before new retry</span>
        <span class='sleep identifier id'>sleep</span><span class='lparen token'>(</span><span class='add_eof identifier id'>add_eof</span><span class='rparen token'>)</span>
        <span class='comment val'># We will be retrying the request, so reset the file pointer</span>
        <span class='reset_fileptr_offset identifier id'>reset_fileptr_offset</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='comma token'>,</span> <span class='mypos identifier id'>mypos</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
    <span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>  <span class='comment val'># See comment at bottom for the list of errors seen...</span>
      <span class='@http ivar id'>@http</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
      <span class='comment val'># if ctrl+c is pressed - we have to reraise exception to terminate proggy</span>
      <span class='if if kw'>if</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Interrupt constant id'>Interrupt</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='lparen token'>(</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Errno constant id'>Errno</span><span class='colon2 op'>::</span><span class='ETIMEDOUT constant id'>ETIMEDOUT</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Timeout constant id'>Timeout</span><span class='colon2 op'>::</span><span class='Error constant id'>Error</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='symbol val'>:debug</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{err_header} request to server #{@server} interrupted by ctrl-c&quot;</span><span class='rparen token'>)</span>
        <span class='raise identifier id'>raise</span>
      <span class='elsif elsif kw'>elsif</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='ArgumentError constant id'>ArgumentError</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='e identifier id'>e</span><span class='dot token'>.</span><span class='message identifier id'>message</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='string val'>'wrong number of arguments (5 for 4)'</span><span class='rparen token'>)</span>
        <span class='comment val'># seems our net_fix patch was overriden...</span>
        <span class='exception identifier id'>exception</span> <span class='assign token'>=</span> <span class='get_param identifier id'>get_param</span><span class='lparen token'>(</span><span class='symbol val'>:exception</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='RuntimeError constant id'>RuntimeError</span>
        <span class='raise identifier id'>raise</span> <span class='exception identifier id'>exception</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'incompatible Net::HTTP monkey-patch'</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>
      <span class='comment val'># oops - we got a banana: log it</span>
      <span class='error_add identifier id'>error_add</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='dot token'>.</span><span class='message identifier id'>message</span><span class='rparen token'>)</span>
      <span class='log identifier id'>log</span><span class='lparen token'>(</span><span class='symbol val'>:warn</span><span class='comma token'>,</span> <span class='dstring node'>&quot;#{err_header} request failure count: #{error_count}, exception: #{e.inspect}&quot;</span><span class='rparen token'>)</span>

      <span class='comment val'># We will be retrying the request, so reset the file pointer</span>
      <span class='reset_fileptr_offset identifier id'>reset_fileptr_offset</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='comma token'>,</span> <span class='mypos identifier id'>mypos</span><span class='rparen token'>)</span>

    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>socket_read_size=</h3>
</div><div id="socket_read_size-3D-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>socket_read_size=</span><span class='args'>(newsize)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set the maximum size (in bytes) of a single read from the underlying
socket. For bulk transfer, especially over fast links, this is value is
critical to performance.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 209</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L209">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">209
210
211</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='socket_read_size= identifier id'>socket_read_size=</span><span class='lparen token'>(</span><span class='newsize identifier id'>newsize</span><span class='rparen token'>)</span>
  <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='BufferedIO constant id'>BufferedIO</span><span class='dot token'>.</span><span class='socket_read_size identifier id'>socket_read_size</span><span class='assign token'>=</span><span class='lparen token'>(</span><span class='newsize identifier id'>newsize</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>socket_read_size?</h3>
</div><div id="socket_read_size-3F-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>socket_read_size?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Query for the maximum size (in bytes) of a single read from the underlying
socket. For bulk transfer, especially over fast links, this is value is
critical to performance.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/right_http_connection.rb', line 202</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/right_http_connection.rb#L202">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">202
203
204</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='socket_read_size? fid id'>socket_read_size?</span>
  <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='BufferedIO constant id'>BufferedIO</span><span class='dot token'>.</span><span class='socket_read_size? fid id'>socket_read_size?</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>