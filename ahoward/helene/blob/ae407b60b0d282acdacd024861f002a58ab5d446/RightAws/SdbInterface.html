<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>ahoward's helene - Class: RightAws::SdbInterface - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/ahoward/commits/helene/master" rel="alternate" title="Recent Commits to helene:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("ahoward", "helene", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("ahoward", "helene", "ae407b60b0d282acdacd024861f002a58ab5d446", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/ahoward/helene/tree/">Source</a></li>
            <li class=""><a href="http://github.com/ahoward/helene/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/ahoward/helene/network">Network</a></li>            
            <li class=""><a href="http://github.com/ahoward/helene/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/ahoward/helene">Wiki</a></li>
            <li class=""><a href="http://github.com/ahoward/helene/graphs">Graphs</a></li>                    
            <li class="active"><a href="/ahoward/helene">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/ahoward">ahoward</a> / <b><a href="http://github.com/ahoward/helene/tree">helene</a></b>        
                <a id="namespaces_button" rel="ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class RightAws_SdbInterface">
  <h1>Class: RightAws::SdbInterface</h1>
  <div class="section inheritance">
  <ul>
  <li><a title="RightAws::RightAwsBase" href="RightAwsBase.html">RightAws::RightAwsBase</a></li><ul><li>RightAws::SdbInterface</li>
  </ul></ul>
</div><div class="section mixins">
  <h2>Included Modules</h2>
  <p><a title="RightAws::RightAwsBaseInterface" href="SdbInterface/RightAwsBaseInterface.html">RightAws::RightAwsBaseInterface</a>, <a title="RightAws::RightAwsBase" href="RightAwsBase.html">RightAws::RightAwsBase</a></p>
</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">last_query_expression</td>
          <td class="readwrite">
            [<span id='last_query_expression-instance_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>last_query_expression</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="API_VERSION-constant">API_VERSION</dt>
      <dd>'2007-11-07'</dd>
    
      <dt id="DEFAULT_HOST-constant">DEFAULT_HOST</dt>
      <dd>'sdb.amazonaws.com'</dd>
    
      <dt id="DEFAULT_NIL_REPRESENTATION-constant">DEFAULT_NIL_REPRESENTATION</dt>
      <dd>'nil'</dd>
    
      <dt id="DEFAULT_PORT-constant">DEFAULT_PORT</dt>
      <dd>443</dd>
    
      <dt id="DEFAULT_PROTOCOL-constant">DEFAULT_PROTOCOL</dt>
      <dd>'https'</dd>
    
  </dl>
</div>
<div class="inherited">
  
  <div>
    <h2>Constants Inherited from <a title="RightAws::RightAwsBase" href="RightAwsBase.html">RightAws::RightAwsBase</a></h2>
    <p><span class='name'><a title="AMAZON_PROBLEMS" href="RightAwsBase.html#AMAZON_PROBLEMS-constant">AMAZON_PROBLEMS</a></span></p>
  </div>
  
</div>
<div class="clear"></div><div class="included">
  
  <div>
    <h2>Constants Included from <a title="RightAws::RightAwsBaseInterface" href="SdbInterface/RightAwsBaseInterface.html">RightAws::RightAwsBaseInterface</a></h2>
    <p><span class='name'><a title="DEFAULT_SIGNATURE_VERSION" href="RightAwsBaseInterface.html#DEFAULT_SIGNATURE_VERSION-constant">DEFAULT_SIGNATURE_VERSION</a></span></p>
  </div>
  
  <div>
    <h2>Constants Included from <a title="RightAws::RightAwsBase" href="RightAwsBase.html">RightAws::RightAwsBase</a></h2>
    <p><span class='name'><a title="AMAZON_PROBLEMS" href="RightAwsBase.html#AMAZON_PROBLEMS-constant">AMAZON_PROBLEMS</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(aws_access_key_id = nil, aws_secret_access_key = nil, params = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Creates new RightSdb instance.
</p>
<p>
Params:
</p>
<pre class="code">
   <span class='lbrace token'>{</span> <span class='symbol val'>:server</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'sdb.amazonaws.com'</span>  <span class='comment val'># Amazon service host: 'sdb.amazonaws.com'(default)</span>
     <span class='symbol val'>:port</span>         <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>443</span>                  <span class='comment val'># Amazon service port: 80 or 443(default)</span>
     <span class='symbol val'>:protocol</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'https'</span>              <span class='comment val'># Amazon service protocol: 'http' or 'https'(default)</span>
     <span class='symbol val'>:signature_version</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'0'</span>             <span class='comment val'># The signature version : '0' or '1'(default)</span>
     <span class='symbol val'>:multi_thread</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='bitor op'>|</span><span class='false false kw'>false</span>           <span class='comment val'># Multi-threaded (connection per each thread): true or false(default)</span>
     <span class='symbol val'>:logger</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Logger constant id'>Logger</span> <span class='Object constant id'>Object</span>        <span class='comment val'># Logger instance: logs to STDOUT if omitted</span>
     <span class='symbol val'>:nil_representation</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'mynil'</span><span class='rbrace token'>}</span>       <span class='comment val'># interpret Ruby nil as this string value; i.e. use this string in SDB to represent Ruby nils (default is the string 'nil')</span>
</pre>
<p>
Example:
</p>
<pre class="code">
 <span class='sdb identifier id'>sdb</span> <span class='assign token'>=</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='SdbInterface constant id'>SdbInterface</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'1E3GDYEOGFJPIT7XXXXXX'</span><span class='comma token'>,</span><span class='string val'>'hgTHt68JY07JKUY08ftHYtERkjgtfERn57XXXXXX'</span><span class='comma token'>,</span> <span class='lbrace token'>{</span><span class='symbol val'>:multi_thread</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='comma token'>,</span> <span class='symbol val'>:logger</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Logger constant id'>Logger</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'/tmp/x.log'</span><span class='rparen token'>)</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; #&lt;RightSdb:0xa6b8c27c&gt;</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 59</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L59">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">59
60
61
62
63
64
65
66
67
68
69</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='aws_access_key_id identifier id'>aws_access_key_id</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='aws_secret_access_key identifier id'>aws_secret_access_key</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@nil_rep ivar id'>@nil_rep</span> <span class='assign token'>=</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:nil_representation</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:nil_representation</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='DEFAULT_NIL_REPRESENTATION constant id'>DEFAULT_NIL_REPRESENTATION</span>
  <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='symbol val'>:nil_representation</span><span class='rparen token'>)</span>
  <span class='init identifier id'>init</span><span class='lparen token'>(</span><span class='lbrace token'>{</span> <span class='symbol val'>:name</span>             <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'SDB'</span><span class='comma token'>,</span> 
         <span class='symbol val'>:default_host</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'SDB_URL'</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='URI constant id'>URI</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'SDB_URL'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='host identifier id'>host</span>   <span class='colon op'>:</span> <span class='DEFAULT_HOST constant id'>DEFAULT_HOST</span><span class='comma token'>,</span> 
         <span class='symbol val'>:default_port</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'SDB_URL'</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='URI constant id'>URI</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'SDB_URL'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='port identifier id'>port</span>   <span class='colon op'>:</span> <span class='DEFAULT_PORT constant id'>DEFAULT_PORT</span><span class='comma token'>,</span> 
         <span class='symbol val'>:default_protocol</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'SDB_URL'</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='URI constant id'>URI</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'SDB_URL'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='scheme identifier id'>scheme</span> <span class='colon op'>:</span> <span class='DEFAULT_PROTOCOL constant id'>DEFAULT_PROTOCOL</span> <span class='rbrace token'>}</span><span class='comma token'>,</span> 
       <span class='aws_access_key_id identifier id'>aws_access_key_id</span>     <span class='orop op'>||</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'AWS_ACCESS_KEY_ID'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> 
       <span class='aws_secret_access_key identifier id'>aws_secret_access_key</span> <span class='orop op'>||</span> <span class='ENV constant id'>ENV</span><span class='lbrack token'>[</span><span class='string val'>'AWS_SECRET_ACCESS_KEY'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> 
       <span class='params identifier id'>params</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bench_sdb-class_method">bench_sdb</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#bench_xml-class_method">bench_xml</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Class Methods Inherited from <a title="RightAws::RightAwsBase" href="RightAwsBase.html">RightAws::RightAwsBase</a></h2>
    <p><span class='name'><a title="amazon_problems" href="RightAwsBase.html#amazon_problems-class_method">amazon_problems</a></span>, <span class='name'><a title="amazon_problems=" href="RightAwsBase.html#amazon_problems%3D-class_method">amazon_problems=</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#create_domain-instance_method">#create_domain</span><span class='args'>(domain_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create new SDB domain at Amazon.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_attributes-instance_method">#delete_attributes</span><span class='args'>(domain_name, item_name, attributes = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Delete value, attribute or item.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_domain-instance_method">#delete_domain</span><span class='args'>(domain_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Delete SDB domain at Amazon.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#escape-instance_method">#escape</span><span class='args'>(value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Use this helper to manually escape the fields in the query expressions.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#generate_request-instance_method">#generate_request</span><span class='args'>(action, params = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <hr size="10"></hr><pre class="code">
     <span class='Requests constant id'>Requests</span>
</pre>
<p>
--------------------------------------------.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get_attributes-instance_method">#get_attributes</span><span class='args'>(domain_name, item_name, attribute_name = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retrieve SDB item&#8217;s attribute(s).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#list_domains-instance_method">#list_domains</span><span class='args'>(max_number_of_domains = nil, next_token = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Retrieve a list of SDB domains from Amazon.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pack_attributes-instance_method">#pack_attributes</span><span class='args'>(attributes, replace = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Prepare attributes for putting.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#put_attributes-instance_method">#put_attributes</span><span class='args'>(domain_name, item_name, attributes, replace = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Add/Replace item attributes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#query-instance_method">#query</span><span class='args'>(domain_name, query_expression = nil, max_number_of_items = nil, next_token = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
QUERY: Perform a query on SDB.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#query_expression_from_array-instance_method">#query_expression_from_array</span><span class='args'>(params)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create query expression from an array.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#query_expression_from_hash-instance_method">#query_expression_from_hash</span><span class='args'>(hash)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#query_with_attributes-instance_method">#query_with_attributes</span><span class='args'>(domain_name, attributes = [], query_expression = nil, max_number_of_items = nil, next_token = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Perform a query and fetch specified attributes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#request_info-instance_method">#request_info</span><span class='args'>(request, parser)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sends request to Amazon and parses the response Raises AwsError if any
banana happened.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#ruby_to_sdb-instance_method">#ruby_to_sdb</span><span class='args'>(value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a Ruby language value to a SDB value by replacing Ruby nil with the
user&#8217;s chosen string representation of nil.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#sdb_to_ruby-instance_method">#sdb_to_ruby</span><span class='args'>(value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a SDB value to a Ruby language value by replacing the user&#8217;s
chosen string representation of nil with Ruby nil.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#select-instance_method">#select</span><span class='args'>(select_expression, next_token = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Perform SQL-like select and fetch attributes.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#select_response_to_ruby-instance_method">#select_response_to_ruby</span><span class='args'>(response)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert select and query_with_attributes responses to a Ruby language
values by replacing the user&#8217;s chosen string representation of nil
with Ruby nil.
</p>

        
      </td>
    </tr>
  
</table><div class="included">
  
  <div>
    <h2>Public Instance Methods Included from <a title="RightAws::RightAwsBaseInterface" href="SdbInterface/RightAwsBaseInterface.html">RightAws::RightAwsBaseInterface</a></h2>
    <p><span class='name'><a title="cache_hits?" href="RightAwsBaseInterface.html#cache_hits%3F-instance_method">cache_hits?</a></span>, <span class='name'><a title="caching?" href="RightAwsBaseInterface.html#caching%3F-instance_method">caching?</a></span>, <span class='name'><a title="init" href="RightAwsBaseInterface.html#init-instance_method">init</a></span>, <span class='name'><a title="last_request_id" href="RightAwsBaseInterface.html#last_request_id-instance_method">last_request_id</a></span>, <span class='name'><a title="multi_thread" href="RightAwsBaseInterface.html#multi_thread-instance_method">multi_thread</a></span>, <span class='name'><a title="on_exception" href="RightAwsBaseInterface.html#on_exception-instance_method">on_exception</a></span>, <span class='name'><a title="request_cache_or_info" href="RightAwsBaseInterface.html#request_cache_or_info-instance_method">request_cache_or_info</a></span>, <span class='name'><a title="request_info_impl" href="RightAwsBaseInterface.html#request_info_impl-instance_method">request_info_impl</a></span>, <span class='name'><a title="signed_service_params" href="RightAwsBaseInterface.html#signed_service_params-instance_method">signed_service_params</a></span>, <span class='name'><a title="update_cache" href="RightAwsBaseInterface.html#update_cache-instance_method">update_cache</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>bench_sdb</h3>
</div><div id="bench_sdb-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bench_sdb</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 38</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L38">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">38</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='bench_sdb identifier id'>bench_sdb</span><span class='semicolon token'>;</span> <span class='@@bench ivar id'>@@bench</span><span class='dot token'>.</span><span class='service identifier id'>service</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>bench_xml</h3>
</div><div id="bench_xml-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>bench_xml</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 37</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L37">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">37</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='bench_xml identifier id'>bench_xml</span><span class='semicolon token'>;</span> <span class='@@bench ivar id'>@@bench</span><span class='dot token'>.</span><span class='xml identifier id'>xml</span><span class='semicolon token'>;</span>     <span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div><div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>create_domain</h3>
</div><div id="create_domain-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>create_domain</span><span class='args'>(domain_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create new SDB domain at Amazon.
</p>
<p>
Returns a hash: { :box_usage, :request_id } on success or an exception on
error. (Amazon raises no errors if the domain already exists).
</p>
<p>
Example:
</p>
<pre class="code">
 <span class='sdb identifier id'>sdb</span> <span class='assign token'>=</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='SdbInterface constant id'>SdbInterface</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='create_domain identifier id'>create_domain</span><span class='lparen token'>(</span><span class='string val'>'toys'</span><span class='rparen token'>)</span> <span class='comment val'># =&gt; { :box_usage  =&gt; &quot;0.0000071759&quot;,</span>
                                  <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;976709f9-0111-2345-92cb-9ce90acd0982&quot;</span> <span class='rbrace token'>}</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API_CreateDomain.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 256</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L256">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">256
257
258
259
260
261
262</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='create_domain identifier id'>create_domain</span><span class='lparen token'>(</span><span class='domain_name identifier id'>domain_name</span><span class='rparen token'>)</span>
  <span class='link identifier id'>link</span> <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;CreateDomain&quot;</span><span class='comma token'>,</span>
                          <span class='string val'>'DomainName'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='domain_name identifier id'>domain_name</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbSimpleParser constant id'>QSdbSimpleParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_attributes</h3>
</div><div id="delete_attributes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_attributes</span><span class='args'>(domain_name, item_name, attributes = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Delete value, attribute or item.
</p>
<p>
Example:
</p>
<pre class="code">
 <span class='comment val'># delete 'vodka' and 'girls' from 'Jon' and 'mice' from 'cat'.</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='delete_attributes identifier id'>delete_attributes</span> <span class='string val'>'family'</span><span class='comma token'>,</span> <span class='string val'>'toys'</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='string val'>'Jon'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>'vodka'</span><span class='comma token'>,</span> <span class='string val'>'girls'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>'cat'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>'mice'</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>

 <span class='comment val'># delete the all the values from attributes (i.e. delete the attributes)</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='delete_attributes identifier id'>delete_attributes</span> <span class='string val'>'family'</span><span class='comma token'>,</span> <span class='string val'>'toys'</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='string val'>'Jon'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>'cat'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
 <span class='comment val'># or</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='delete_attributes identifier id'>delete_attributes</span> <span class='string val'>'family'</span><span class='comma token'>,</span> <span class='string val'>'toys'</span><span class='comma token'>,</span> <span class='lbrack token'>[</span> <span class='string val'>'Jon'</span><span class='comma token'>,</span> <span class='string val'>'cat'</span> <span class='rbrack token'>]</span>

 <span class='comment val'># delete all the attributes from item 'toys' (i.e. delete the item)</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='delete_attributes identifier id'>delete_attributes</span> <span class='string val'>'family'</span><span class='comma token'>,</span> <span class='string val'>'toys'</span>
</pre>
<p>
see
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API_DeleteAttributes.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 388</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L388">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">388
389
390
391
392
393
394
395</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_attributes identifier id'>delete_attributes</span><span class='lparen token'>(</span><span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span> <span class='item_name identifier id'>item_name</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'DomainName'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span>
             <span class='string val'>'ItemName'</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='item_name identifier id'>item_name</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='pack_attributes identifier id'>pack_attributes</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='link identifier id'>link</span> <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;DeleteAttributes&quot;</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span> <span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbSimpleParser constant id'>QSdbSimpleParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_domain</h3>
</div><div id="delete_domain-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_domain</span><span class='args'>(domain_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Delete SDB domain at Amazon.
</p>
<p>
Returns a hash: { :box_usage, :request_id } on success or an exception on
error. (Amazon raises no errors if the domain does not exist).
</p>
<p>
Example:
</p>
<pre class="code">
 <span class='sdb identifier id'>sdb</span> <span class='assign token'>=</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='SdbInterface constant id'>SdbInterface</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='delete_domain identifier id'>delete_domain</span><span class='lparen token'>(</span><span class='string val'>'toys'</span><span class='rparen token'>)</span> <span class='comment val'># =&gt; { :box_usage  =&gt; &quot;0.0000071759&quot;,</span>
                                  <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;976709f9-0111-2345-92cb-9ce90acd0982&quot;</span> <span class='rbrace token'>}</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API_DeleteDomain.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 277</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L277">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">277
278
279
280
281
282
283</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_domain identifier id'>delete_domain</span><span class='lparen token'>(</span><span class='domain_name identifier id'>domain_name</span><span class='rparen token'>)</span>
  <span class='link identifier id'>link</span> <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;DeleteDomain&quot;</span><span class='comma token'>,</span>
                          <span class='string val'>'DomainName'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='domain_name identifier id'>domain_name</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbSimpleParser constant id'>QSdbSimpleParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>escape</h3>
</div><div id="escape-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>escape</span><span class='args'>(value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Use this helper to manually escape the fields in the query expressions. To
escape the single quotes and backslashes and to wrap the string into the
single quotes.
</p>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 146</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L146">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">146
147
148</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='escape identifier id'>escape</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='dstring node'>%Q{'#{value.to_s.gsub(/(['\\])/){ &quot;\\#{$1}&quot; }}'}</span> <span class='if if_mod kw'>if</span> <span class='value identifier id'>value</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>generate_request</h3>
</div><div id="generate_request-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>generate_request</span><span class='args'>(action, params = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <hr size="10"></hr><pre class="code">
     <span class='Requests constant id'>Requests</span>
</pre>
<hr size="10"></hr>
</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 74</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L74">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='action identifier id'>action</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='comment val'># remove empty params from request</span>
  <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='delete_if identifier id'>delete_if</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span><span class='value identifier id'>value</span><span class='bitor op'>|</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='rbrace token'>}</span>
  <span class='comment val'>#params_string  = params.to_a.collect{|key,val| key + &quot;=#{CGI::escape(val.to_s)}&quot; }.join(&quot;&amp;&quot;)</span>
  <span class='comment val'># prepare service data</span>
  <span class='service identifier id'>service</span> <span class='assign token'>=</span> <span class='string val'>'/'</span>
  <span class='service_hash identifier id'>service_hash</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='string val'>&quot;Action&quot;</span>         <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='action identifier id'>action</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;AWSAccessKeyId&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@aws_access_key_id ivar id'>@aws_access_key_id</span><span class='comma token'>,</span>
                  <span class='string val'>&quot;Version&quot;</span>        <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='API_VERSION constant id'>API_VERSION</span> <span class='rbrace token'>}</span>
  <span class='service_hash identifier id'>service_hash</span><span class='dot token'>.</span><span class='update identifier id'>update</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='service_params identifier id'>service_params</span> <span class='assign token'>=</span> <span class='signed_service_params identifier id'>signed_service_params</span><span class='lparen token'>(</span><span class='@aws_secret_access_key ivar id'>@aws_secret_access_key</span><span class='comma token'>,</span> <span class='service_hash identifier id'>service_hash</span><span class='comma token'>,</span> <span class='symbol val'>:get</span><span class='comma token'>,</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:server</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='service identifier id'>service</span><span class='rparen token'>)</span>
  <span class='comment val'>#</span>
  <span class='comment val'># use POST method if the length of the query string is too large</span>
  <span class='comment val'># see http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/MakingRESTRequests.html</span>
  <span class='if if kw'>if</span> <span class='service_params identifier id'>service_params</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>2000</span>
    <span class='if if kw'>if</span> <span class='signature_version identifier id'>signature_version</span> <span class='eq op'>==</span> <span class='string val'>'2'</span>
      <span class='comment val'># resign the request because HTTP verb is included into signature</span>
      <span class='service_params identifier id'>service_params</span> <span class='assign token'>=</span> <span class='signed_service_params identifier id'>signed_service_params</span><span class='lparen token'>(</span><span class='@aws_secret_access_key ivar id'>@aws_secret_access_key</span><span class='comma token'>,</span> <span class='service_hash identifier id'>service_hash</span><span class='comma token'>,</span> <span class='symbol val'>:post</span><span class='comma token'>,</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:server</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='service identifier id'>service</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='request identifier id'>request</span>      <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='HTTP constant id'>HTTP</span><span class='colon2 op'>::</span><span class='Post constant id'>Post</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='service identifier id'>service</span><span class='rparen token'>)</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='body identifier id'>body</span> <span class='assign token'>=</span> <span class='service_params identifier id'>service_params</span>
    <span class='request identifier id'>request</span><span class='lbrack token'>[</span><span class='string val'>'Content-Type'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>'application/x-www-form-urlencoded'</span>
  <span class='else else kw'>else</span>
    <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='Net constant id'>Net</span><span class='colon2 op'>::</span><span class='HTTP constant id'>HTTP</span><span class='colon2 op'>::</span><span class='Get constant id'>Get</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{service}?#{service_params}&quot;</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='comment val'># prepare output hash</span>
  <span class='lbrace token'>{</span> <span class='symbol val'>:request</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='request identifier id'>request</span><span class='comma token'>,</span> 
    <span class='symbol val'>:server</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:server</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
    <span class='symbol val'>:port</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:port</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
    <span class='symbol val'>:protocol</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:protocol</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get_attributes</h3>
</div><div id="get_attributes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get_attributes</span><span class='args'>(domain_name, item_name, attribute_name = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retrieve SDB item&#8217;s attribute(s).
</p>
<p>
Returns a hash:
</p>
<pre class="code">
 <span class='lbrace token'>{</span> <span class='symbol val'>:box_usage</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span><span class='comma token'>,</span>
   <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span><span class='comma token'>,</span>
   <span class='symbol val'>:attributes</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='string val'>'nameA'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='valueA1 identifier id'>valueA1</span><span class='comma token'>,</span><span class='dot3 op'>...</span><span class='comma token'>,</span> <span class='valueAN identifier id'>valueAN</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                    <span class='dot3 op'>...</span> <span class='comma token'>,</span>
                    <span class='string val'>'nameZ'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='valueZ1 identifier id'>valueZ1</span><span class='comma token'>,</span><span class='dot3 op'>...</span><span class='comma token'>,</span> <span class='valueZN identifier id'>valueZN</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span> <span class='rbrace token'>}</span>
</pre>
<p>
Example:
</p>
<pre class="code">
 <span class='comment val'># request all attributes</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='get_attributes identifier id'>get_attributes</span><span class='lparen token'>(</span><span class='string val'>'family'</span><span class='comma token'>,</span> <span class='string val'>'toys'</span><span class='rparen token'>)</span> <span class='comment val'># =&gt; { :attributes =&gt; {&quot;cat&quot;    =&gt; [&quot;clew&quot;, &quot;Jons_socks&quot;, &quot;mouse&quot;] },</span>
                                                             <span class='string val'>&quot;Silvia&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;beetle&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;rolling_pin&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;kids&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                                             <span class='string val'>&quot;Jon&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;vacuum_cleaner&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;hammer&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;spade&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
                                             <span class='symbol val'>:box_usage</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;0.0000093222&quot;</span><span class='comma token'>,</span>
                                             <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;81273d21-000-1111-b3f9-512d91d29ac8&quot;</span> <span class='rbrace token'>}</span>

 <span class='comment val'># request cat's attributes only</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='get_attributes identifier id'>get_attributes</span><span class='lparen token'>(</span><span class='string val'>'family'</span><span class='comma token'>,</span> <span class='string val'>'toys'</span><span class='comma token'>,</span> <span class='string val'>'cat'</span><span class='rparen token'>)</span> <span class='comment val'># =&gt; { :attributes =&gt; {&quot;cat&quot; =&gt; [&quot;clew&quot;, &quot;Jons_socks&quot;, &quot;mouse&quot;] },</span>
                                                    <span class='symbol val'>:box_usage</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;0.0000093222&quot;</span><span class='comma token'>,</span>
                                                    <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;81273d21-001-1111-b3f9-512d91d29ac8&quot;</span> <span class='rbrace token'>}</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API_GetAttributes.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 359</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L359">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">359
360
361
362
363
364
365
366
367
368
369
370</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='get_attributes identifier id'>get_attributes</span><span class='lparen token'>(</span><span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span> <span class='item_name identifier id'>item_name</span><span class='comma token'>,</span> <span class='attribute_name identifier id'>attribute_name</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='link identifier id'>link</span> <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;GetAttributes&quot;</span><span class='comma token'>,</span> <span class='string val'>'DomainName'</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span>
                                           <span class='string val'>'ItemName'</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='item_name identifier id'>item_name</span><span class='comma token'>,</span>
                                           <span class='string val'>'AttributeName'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attribute_name identifier id'>attribute_name</span> <span class='rparen token'>)</span>
  <span class='res identifier id'>res</span> <span class='assign token'>=</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbGetAttributesParser constant id'>QSdbGetAttributesParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
  <span class='res identifier id'>res</span><span class='lbrack token'>[</span><span class='symbol val'>:attributes</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each_value identifier id'>each_value</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='values identifier id'>values</span><span class='bitor op'>|</span>
    <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span> <span class='sdb_to_ruby identifier id'>sdb_to_ruby</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  <span class='res identifier id'>res</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>list_domains</h3>
</div><div id="list_domains-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>list_domains</span><span class='args'>(max_number_of_domains = nil, next_token = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Retrieve a list of SDB domains from Amazon.
</p>
<p>
Returns a hash:
</p>
<pre class="code">
  <span class='lbrace token'>{</span> <span class='symbol val'>:domains</span>     <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='domain1 identifier id'>domain1</span><span class='comma token'>,</span> <span class='dot3 op'>...</span><span class='comma token'>,</span> <span class='domainN identifier id'>domainN</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
    <span class='symbol val'>:next_token</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span> <span class='orop op'>||</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span>
    <span class='symbol val'>:box_usage</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span><span class='comma token'>,</span>
    <span class='symbol val'>:request_id</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span> <span class='rbrace token'>}</span>
</pre>
<p>
Example:
</p>
<pre class="code">
 <span class='sdb identifier id'>sdb</span> <span class='assign token'>=</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='SdbInterface constant id'>SdbInterface</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='list_domains identifier id'>list_domains</span>  <span class='comment val'>#=&gt; { :box_usage  =&gt; &quot;0.0000071759&quot;,</span>
                         <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;976709f9-0111-2345-92cb-9ce90acd0982&quot;</span><span class='comma token'>,</span>
                         <span class='symbol val'>:domains</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;toys&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;dolls&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span>
</pre>
<p>
If a block is given, this method yields to it. If the block returns true,
list_domains will continue looping the request. If the block returns false,
list_domains will end.
</p>
<pre class="code">
  <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='list_domains identifier id'>list_domains</span><span class='lparen token'>(</span><span class='integer val'>10</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='result identifier id'>result</span><span class='bitor op'>|</span>   <span class='comment val'># list by 10 domains per iteration</span>
    <span class='puts identifier id'>puts</span> <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='inspect identifier id'>inspect</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API_ListDomains.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 224</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L224">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='list_domains identifier id'>list_domains</span><span class='lparen token'>(</span><span class='max_number_of_domains identifier id'>max_number_of_domains</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='next_token identifier id'>next_token</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span> <span class='rparen token'>)</span>
  <span class='request_params identifier id'>request_params</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'MaxNumberOfDomains'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='max_number_of_domains identifier id'>max_number_of_domains</span><span class='comma token'>,</span>
                     <span class='string val'>'NextToken'</span>          <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='next_token identifier id'>next_token</span> <span class='rbrace token'>}</span>
  <span class='link identifier id'>link</span>   <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;ListDomains&quot;</span><span class='comma token'>,</span> <span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbListDomainParser constant id'>QSdbListDomainParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
  <span class='comment val'># return result if no block given</span>
  <span class='return return kw'>return</span> <span class='result identifier id'>result</span> <span class='unless unless_mod kw'>unless</span> <span class='block_given? fid id'>block_given?</span>
  <span class='comment val'># loop if block if given</span>
  <span class='begin begin kw'>begin</span>
    <span class='comment val'># the block must return true if it wanna continue </span>
    <span class='break break kw'>break</span> <span class='unless unless_mod kw'>unless</span> <span class='yield yield kw'>yield</span><span class='lparen token'>(</span><span class='result identifier id'>result</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:next_token</span><span class='rbrack token'>]</span>
    <span class='comment val'># make new request</span>
    <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='string val'>'NextToken'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:next_token</span><span class='rbrack token'>]</span>
    <span class='link identifier id'>link</span>   <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;ListDomains&quot;</span><span class='comma token'>,</span> <span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
    <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbListDomainParser constant id'>QSdbListDomainParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span> <span class='while while_mod kw'>while</span> <span class='true true kw'>true</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pack_attributes</h3>
</div><div id="pack_attributes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pack_attributes</span><span class='args'>(attributes, replace = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Prepare attributes for putting. (used by put_attributes)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 116</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L116">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pack_attributes identifier id'>pack_attributes</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='replace identifier id'>replace</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='if if kw'>if</span> <span class='attributes identifier id'>attributes</span>
    <span class='idx identifier id'>idx</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='skip_values identifier id'>skip_values</span> <span class='assign token'>=</span> <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
    <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='bitor op'>|</span>
      <span class='comment val'># set replacement attribute</span>
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;Attribute.#{idx}.Replace&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>'true'</span> <span class='if if_mod kw'>if</span> <span class='replace identifier id'>replace</span>
      <span class='comment val'># pack Name/Value</span>
      <span class='unless unless kw'>unless</span> <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
        <span class='Array constant id'>Array</span><span class='lparen token'>(</span><span class='values identifier id'>values</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
          <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;Attribute.#{idx}.Name&quot;</span><span class='rbrack token'>]</span>  <span class='assign token'>=</span> <span class='attribute identifier id'>attribute</span>
          <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;Attribute.#{idx}.Value&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='ruby_to_sdb identifier id'>ruby_to_sdb</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='skip_values identifier id'>skip_values</span>
          <span class='idx identifier id'>idx</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
        <span class='end end kw'>end</span>
      <span class='else else kw'>else</span>
        <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;Attribute.#{idx}.Name&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='attribute identifier id'>attribute</span>
        <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;Attribute.#{idx}.Value&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='ruby_to_sdb identifier id'>ruby_to_sdb</span><span class='lparen token'>(</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='skip_values identifier id'>skip_values</span>
        <span class='idx identifier id'>idx</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='result identifier id'>result</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>put_attributes</h3>
</div><div id="put_attributes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>put_attributes</span><span class='args'>(domain_name, item_name, attributes, replace = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Add/Replace item attributes.
</p>
<p>
Params:
</p>
<pre class="code">
 <span class='domain_name identifier id'>domain_name</span> <span class='assign token'>=</span> <span class='DomainName constant id'>DomainName</span>
 <span class='item_name identifier id'>item_name</span>   <span class='assign token'>=</span> <span class='ItemName constant id'>ItemName</span>
 <span class='attributes identifier id'>attributes</span>  <span class='assign token'>=</span> <span class='lbrace token'>{</span>
   <span class='string val'>'nameA'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='valueA1 identifier id'>valueA1</span><span class='comma token'>,</span><span class='dot3 op'>...</span><span class='comma token'>,</span> <span class='valueAN identifier id'>valueAN</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
   <span class='dot3 op'>...</span>
   <span class='string val'>'nameZ'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='valueZ1 identifier id'>valueZ1</span><span class='comma token'>,</span><span class='dot3 op'>...</span><span class='comma token'>,</span> <span class='valueZN identifier id'>valueZN</span><span class='rbrack token'>]</span>
 <span class='rbrace token'>}</span>
 <span class='replace identifier id'>replace</span> <span class='assign token'>=</span> <span class='symbol val'>:replace</span> <span class='bitor op'>|</span> <span class='any identifier id'>any</span> <span class='other identifier id'>other</span> <span class='value identifier id'>value</span> <span class='to identifier id'>to</span> <span class='skip identifier id'>skip</span> <span class='replacement identifier id'>replacement</span>
</pre>
<p>
Returns a hash: { :box_usage, :request_id } on success or an exception on
error. (Amazon raises no errors if the attribute was not overridden, as
when the :replace param is unset).
</p>
<p>
Example:
</p>
<pre class="code">
 <span class='sdb identifier id'>sdb</span> <span class='assign token'>=</span> <span class='RightAws constant id'>RightAws</span><span class='colon2 op'>::</span><span class='SdbInterface constant id'>SdbInterface</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='create_domain identifier id'>create_domain</span> <span class='string val'>'family'</span>

 <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
 <span class='comment val'># create attributes for Jon and Silvia</span>
 <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>'Jon'</span><span class='rbrack token'>]</span>    <span class='assign token'>=</span> <span class='dstring node'>%w{ car beer }</span>
 <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>'Silvia'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='dstring node'>%w{ beetle rolling_pin kids }</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='put_attributes identifier id'>put_attributes</span> <span class='string val'>'family'</span><span class='comma token'>,</span> <span class='string val'>'toys'</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span>   <span class='comment val'>#=&gt; ok</span>
 <span class='comment val'># now: Jon=&gt;[car, beer], Silvia=&gt;[beetle, rolling_pin, kids]</span>

 <span class='comment val'># add attributes to Jon</span>
 <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='delete identifier id'>delete</span><span class='lparen token'>(</span><span class='string val'>'Silvia'</span><span class='rparen token'>)</span>
 <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>'Jon'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='dstring node'>%w{ girls pub }</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='put_attributes identifier id'>put_attributes</span> <span class='string val'>'family'</span><span class='comma token'>,</span> <span class='string val'>'toys'</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span>   <span class='comment val'>#=&gt; ok</span>
 <span class='comment val'># now: Jon=&gt;[car, beer, girls, pub], Silvia=&gt;[beetle, rolling_pin, kids]</span>

 <span class='comment val'># replace attributes for Jon and add to a cat (the cat had no attributes before)</span>
 <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>'Jon'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='dstring node'>%w{ vacuum_cleaner hammer spade }</span>
 <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='string val'>'cat'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='dstring node'>%w{ mouse clew Jons_socks }</span>
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='put_attributes identifier id'>put_attributes</span> <span class='string val'>'family'</span><span class='comma token'>,</span> <span class='string val'>'toys'</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='symbol val'>:replace</span> <span class='comment val'>#=&gt; ok</span>
 <span class='comment val'># now: Jon=&gt;[vacuum_cleaner, hammer, spade], Silvia=&gt;[beetle, rolling_pin, kids], cat=&gt;[mouse, clew, Jons_socks]</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API_PutAttributes.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 326</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L326">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">326
327
328
329
330
331
332
333</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='put_attributes identifier id'>put_attributes</span><span class='lparen token'>(</span><span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span> <span class='item_name identifier id'>item_name</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='replace identifier id'>replace</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='params identifier id'>params</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'DomainName'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span>
             <span class='string val'>'ItemName'</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='item_name identifier id'>item_name</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='pack_attributes identifier id'>pack_attributes</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='replace identifier id'>replace</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='link identifier id'>link</span> <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;PutAttributes&quot;</span><span class='comma token'>,</span> <span class='params identifier id'>params</span><span class='rparen token'>)</span>
  <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span> <span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbSimpleParser constant id'>QSdbSimpleParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='rparen token'>)</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>query</h3>
</div><div id="query-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>query</span><span class='args'>(domain_name, query_expression = nil, max_number_of_items = nil, next_token = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
QUERY: Perform a query on SDB.
</p>
<p>
Returns a hash:
</p>
<pre class="code">
  <span class='lbrace token'>{</span> <span class='symbol val'>:box_usage</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span><span class='comma token'>,</span>
    <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span><span class='comma token'>,</span>
    <span class='symbol val'>:next_token</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span><span class='comma token'>,</span>
    <span class='symbol val'>:items</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='ItemName1 constant id'>ItemName1</span><span class='comma token'>,</span><span class='dot3 op'>...</span><span class='comma token'>,</span> <span class='ItemNameN constant id'>ItemNameN</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span>
</pre>
<p>
Example:
</p>
<pre class="code">
  <span class='query identifier id'>query</span> <span class='assign token'>=</span> <span class='string val'>&quot;['cat' = 'clew']&quot;</span>
  <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>'family'</span><span class='comma token'>,</span> <span class='query identifier id'>query</span><span class='rparen token'>)</span>     <span class='comment val'>#=&gt; hash of data</span>
  <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>'family'</span><span class='comma token'>,</span> <span class='query identifier id'>query</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; hash of data with max of 10 items</span>
</pre>
<p>
If a block is given, query will iteratively yield results to it as long as
the block continues to return true.
</p>
<pre class="code">
  <span class='comment val'># List 10 items per iteration. Don't</span>
  <span class='comment val'># forget to escape single quotes and backslashes and wrap all the items in single quotes.</span>
  <span class='query identifier id'>query</span> <span class='assign token'>=</span> <span class='string val'>&quot;['cat'='clew'] union ['dog'='Jon\\'s boot']&quot;</span>
  <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>'family'</span><span class='comma token'>,</span> <span class='query identifier id'>query</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='result identifier id'>result</span><span class='bitor op'>|</span>
    <span class='puts identifier id'>puts</span> <span class='result identifier id'>result</span><span class='dot token'>.</span><span class='inspect identifier id'>inspect</span>
    <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Same query using automatic escaping...to use the auto escape, pass the query and its params as an array:</span>
  <span class='query identifier id'>query</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='string val'>&quot;['cat'=?] union ['dog'=?]&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;clew&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;Jon's boot&quot;</span> <span class='rbrack token'>]</span>
  <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>'family'</span><span class='comma token'>,</span> <span class='query identifier id'>query</span><span class='rparen token'>)</span>

  <span class='query identifier id'>query</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span> <span class='string val'>&quot;['cat'=?] union ['dog'=?] sort 'cat' desc&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;clew&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;Jon's boot&quot;</span> <span class='rbrack token'>]</span>
  <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='string val'>'family'</span><span class='comma token'>,</span> <span class='query identifier id'>query</span><span class='rparen token'>)</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/SDB_API_Query.html
</p>
<pre class="code">
     <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/docs.amazonwebservices.com/</span><span class='AmazonSimpleDB constant id'>AmazonSimpleDB</span><span class='div op'>/</span><span class='integer val'>2007</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>07</span><span class='div op'>/</span><span class='DeveloperGuide constant id'>DeveloperGuide</span><span class='div op'>/</span><span class='index identifier id'>index</span><span class='dot token'>.</span><span class='html? fid id'>html?</span><span class='SortingData constant id'>SortingData</span><span class='dot token'>.</span><span class='html identifier id'>html</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 434</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L434">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='query identifier id'>query</span><span class='lparen token'>(</span><span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span> <span class='query_expression identifier id'>query_expression</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='max_number_of_items identifier id'>max_number_of_items</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='next_token identifier id'>next_token</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='query_expression identifier id'>query_expression</span> <span class='assign token'>=</span> <span class='query_expression_from_array identifier id'>query_expression_from_array</span><span class='lparen token'>(</span><span class='query_expression identifier id'>query_expression</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='query_expression identifier id'>query_expression</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
  <span class='@last_query_expression ivar id'>@last_query_expression</span> <span class='assign token'>=</span> <span class='query_expression identifier id'>query_expression</span>
  <span class='comment val'>#</span>
  <span class='request_params identifier id'>request_params</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'DomainName'</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span>
                     <span class='string val'>'QueryExpression'</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='query_expression identifier id'>query_expression</span><span class='comma token'>,</span>
                     <span class='string val'>'MaxNumberOfItems'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='max_number_of_items identifier id'>max_number_of_items</span><span class='comma token'>,</span>
                     <span class='string val'>'NextToken'</span>        <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='next_token identifier id'>next_token</span> <span class='rbrace token'>}</span>
  <span class='link identifier id'>link</span>   <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;Query&quot;</span><span class='comma token'>,</span> <span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span> <span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbQueryParser constant id'>QSdbQueryParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='rparen token'>)</span>
  <span class='comment val'># return result if no block given</span>
  <span class='return return kw'>return</span> <span class='result identifier id'>result</span> <span class='unless unless_mod kw'>unless</span> <span class='block_given? fid id'>block_given?</span>
  <span class='comment val'># loop if block if given</span>
  <span class='begin begin kw'>begin</span>
    <span class='comment val'># the block must return true if it wanna continue </span>
    <span class='break break kw'>break</span> <span class='unless unless_mod kw'>unless</span> <span class='yield yield kw'>yield</span><span class='lparen token'>(</span><span class='result identifier id'>result</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:next_token</span><span class='rbrack token'>]</span>
    <span class='comment val'># make new request</span>
    <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='string val'>'NextToken'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:next_token</span><span class='rbrack token'>]</span>
    <span class='link identifier id'>link</span>   <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;Query&quot;</span><span class='comma token'>,</span> <span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
    <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span> <span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbQueryParser constant id'>QSdbQueryParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='rparen token'>)</span>
  <span class='end end kw'>end</span> <span class='while while_mod kw'>while</span> <span class='true true kw'>true</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>query_expression_from_array</h3>
</div><div id="query_expression_from_array-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>query_expression_from_array</span><span class='args'>(params)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create query expression from an array. (similar to ActiveRecord::Base#find
using :conditions =&gt; [&#8216;query&#8217;, param1, .., paramN])
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 178</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L178">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">178
179
180
181
182
183
184
185
186
187
188</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='query_expression_from_array identifier id'>query_expression_from_array</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='return return kw'>return</span> <span class='string val'>''</span> <span class='if if_mod kw'>if</span> <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
  <span class='query identifier id'>query</span> <span class='assign token'>=</span> <span class='params identifier id'>params</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='query identifier id'>query</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='regexp val'>/(\\)?(\?)/</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='if if kw'>if</span> <span class='$1 nth_ref id'>$1</span> <span class='comment val'># if escaped '\?' is found - replace it by '?' without backslash</span>
      <span class='string val'>&quot;?&quot;</span>
    <span class='else else kw'>else</span>  <span class='comment val'># well, if no backslash precedes '?' then replace it by next param from the list</span>
      <span class='escape identifier id'>escape</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='dot token'>.</span><span class='shift identifier id'>shift</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>query_expression_from_hash</h3>
</div><div id="query_expression_from_hash-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>query_expression_from_hash</span><span class='args'>(hash)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 190</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L190">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">190
191
192
193
194
195
196
197</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='query_expression_from_hash identifier id'>query_expression_from_hash</span><span class='lparen token'>(</span><span class='hash identifier id'>hash</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='string val'>''</span> <span class='if if_mod kw'>if</span> <span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
  <span class='expression identifier id'>expression</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='hash identifier id'>hash</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='expression identifier id'>expression</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;#{key}=#{escape(value)}&quot;</span>
  <span class='end end kw'>end</span>
  <span class='expression identifier id'>expression</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>' AND '</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>query_with_attributes</h3>
</div><div id="query_with_attributes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>query_with_attributes</span><span class='args'>(domain_name, attributes = [], query_expression = nil, max_number_of_items = nil, next_token = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Perform a query and fetch specified attributes. If attributes are not
specified then fetches the whole list of attributes.
</p>
<p>
Returns a hash:
</p>
<pre class="code">
  <span class='lbrace token'>{</span> <span class='symbol val'>:box_usage</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span><span class='comma token'>,</span>
    <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span><span class='comma token'>,</span>
    <span class='symbol val'>:next_token</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string identifier id'>string</span><span class='comma token'>,</span>
    <span class='symbol val'>:items</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span> <span class='lbrace token'>{</span> <span class='ItemName1 constant id'>ItemName1</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span> <span class='attribute1 identifier id'>attribute1</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='value1 identifier id'>value1</span><span class='comma token'>,</span> <span class='dot3 op'>...</span>  <span class='attributeM identifier id'>attributeM</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='valueM identifier id'>valueM</span> <span class='rbrace token'>}</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
                     <span class='lbrace token'>{</span> <span class='ItemName2 constant id'>ItemName2</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='dot3 op'>...</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='dot3 op'>...</span> <span class='rbrack token'>]</span>
</pre>
<p>
Example:
</p>
<pre class="code">
  <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='query_with_attributes identifier id'>query_with_attributes</span><span class='lparen token'>(</span><span class='domain identifier id'>domain</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>'hobby'</span><span class='comma token'>,</span> <span class='string val'>'country'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>&quot;['gender'='female'] intersection ['name' starts-with ''] sort 'name'&quot;</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt;</span>
    <span class='lbrace token'>{</span> <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;06057228-70d0-4487-89fb-fd9c028580d3&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:items</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span>
        <span class='lbrack token'>[</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;035f1ba8-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span>
            <span class='lbrace token'>{</span> <span class='string val'>&quot;hobby&quot;</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;cooking&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;flowers&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;cats&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
              <span class='string val'>&quot;country&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;Russia&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
          <span class='lbrace token'>{</span> <span class='string val'>&quot;0327614a-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span>
            <span class='lbrace token'>{</span> <span class='string val'>&quot;hobby&quot;</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;patchwork&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;bundle jumping&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
              <span class='string val'>&quot;country&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;USA&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='dot3 op'>...</span> <span class='rbrack token'>]</span><span class='comma token'>,</span>
       <span class='symbol val'>:box_usage=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0.0000504786&quot;</span><span class='rbrace token'>}</span>

  <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='query_with_attributes identifier id'>query_with_attributes</span><span class='lparen token'>(</span><span class='domain identifier id'>domain</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>&quot;['gender'='female'] intersection ['name' starts-with ''] sort 'name'&quot;</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt;</span>
    <span class='lbrace token'>{</span> <span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;75bb19db-a529-4f69-b86f-5e3800f79a45&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:items</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span>
      <span class='lbrack token'>[</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;035f1ba8-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span>
          <span class='lbrace token'>{</span> <span class='string val'>&quot;hobby&quot;</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;cooking&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;flowers&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;cats&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='string val'>&quot;name&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;Mary&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='string val'>&quot;country&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;Russia&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='string val'>&quot;gender&quot;</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;female&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='string val'>&quot;id&quot;</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;035f1ba8-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
        <span class='lbrace token'>{</span> <span class='string val'>&quot;0327614a-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span>
          <span class='lbrace token'>{</span> <span class='string val'>&quot;hobby&quot;</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;patchwork&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;bundle jumping&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='string val'>&quot;name&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;Mary&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='string val'>&quot;country&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;USA&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='string val'>&quot;gender&quot;</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;female&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
            <span class='string val'>&quot;id&quot;</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;0327614a-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='dot3 op'>...</span> <span class='rbrack token'>]</span><span class='comma token'>,</span>
     <span class='symbol val'>:box_usage=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0.0000506668&quot;</span><span class='rbrace token'>}</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/index.html?SDB_API_QueryWithAttributes.html
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 502</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L502">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='query_with_attributes identifier id'>query_with_attributes</span><span class='lparen token'>(</span><span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='assign token'>=</span><span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='query_expression identifier id'>query_expression</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='max_number_of_items identifier id'>max_number_of_items</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='next_token identifier id'>next_token</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span>
  <span class='query_expression identifier id'>query_expression</span> <span class='assign token'>=</span> <span class='query_expression_from_array identifier id'>query_expression_from_array</span><span class='lparen token'>(</span><span class='query_expression identifier id'>query_expression</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='query_expression identifier id'>query_expression</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
  <span class='@last_query_expression ivar id'>@last_query_expression</span> <span class='assign token'>=</span> <span class='query_expression identifier id'>query_expression</span>
  <span class='comment val'>#</span>
  <span class='request_params identifier id'>request_params</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'DomainName'</span>       <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='domain_name identifier id'>domain_name</span><span class='comma token'>,</span>
                     <span class='string val'>'QueryExpression'</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='query_expression identifier id'>query_expression</span><span class='comma token'>,</span>
                     <span class='string val'>'MaxNumberOfItems'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='max_number_of_items identifier id'>max_number_of_items</span><span class='comma token'>,</span>
                     <span class='string val'>'NextToken'</span>        <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='next_token identifier id'>next_token</span> <span class='rbrace token'>}</span>
  <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='idx identifier id'>idx</span><span class='bitor op'>|</span>
    <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='dstring node'>&quot;AttributeName.#{idx+1}&quot;</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='attribute identifier id'>attribute</span>
  <span class='end end kw'>end</span>
  <span class='link identifier id'>link</span>   <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;QueryWithAttributes&quot;</span><span class='comma token'>,</span> <span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='select_response_to_ruby identifier id'>select_response_to_ruby</span><span class='lparen token'>(</span><span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span> <span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbQueryWithAttributesParser constant id'>QSdbQueryWithAttributesParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='comment val'># return result if no block given</span>
  <span class='return return kw'>return</span> <span class='result identifier id'>result</span> <span class='unless unless_mod kw'>unless</span> <span class='block_given? fid id'>block_given?</span>
  <span class='comment val'># loop if block if given</span>
  <span class='begin begin kw'>begin</span>
    <span class='comment val'># the block must return true if it wanna continue</span>
    <span class='break break kw'>break</span> <span class='unless unless_mod kw'>unless</span> <span class='yield yield kw'>yield</span><span class='lparen token'>(</span><span class='result identifier id'>result</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:next_token</span><span class='rbrack token'>]</span>
    <span class='comment val'># make new request</span>
    <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='string val'>'NextToken'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:next_token</span><span class='rbrack token'>]</span>
    <span class='link identifier id'>link</span>   <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;QueryWithAttributes&quot;</span><span class='comma token'>,</span> <span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
    <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='select_response_to_ruby identifier id'>select_response_to_ruby</span><span class='lparen token'>(</span><span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span> <span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbQueryWithAttributesParser constant id'>QSdbQueryWithAttributesParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span> <span class='while while_mod kw'>while</span> <span class='true true kw'>true</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>request_info</h3>
</div><div id="request_info-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>request_info</span><span class='args'>(request, parser)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sends request to Amazon and parses the response Raises AwsError if any
banana happened
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 108</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L108">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">108
109
110
111
112</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span><span class='request identifier id'>request</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='rparen token'>)</span>  <span class='comment val'>#:nodoc:</span>
  <span class='thread identifier id'>thread</span> <span class='assign token'>=</span> <span class='@params ivar id'>@params</span><span class='lbrack token'>[</span><span class='symbol val'>:multi_thread</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='Thread constant id'>Thread</span><span class='dot token'>.</span><span class='current identifier id'>current</span> <span class='colon op'>:</span> <span class='Thread constant id'>Thread</span><span class='dot token'>.</span><span class='main identifier id'>main</span>
  <span class='thread identifier id'>thread</span><span class='lbrack token'>[</span><span class='symbol val'>:sdb_connection</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='Rightscale constant id'>Rightscale</span><span class='colon2 op'>::</span><span class='HttpConnection constant id'>HttpConnection</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='AwsError constant id'>AwsError</span><span class='comma token'>,</span> <span class='symbol val'>:logger</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='@logger ivar id'>@logger</span><span class='rparen token'>)</span>
  <span class='request_info_impl identifier id'>request_info_impl</span><span class='lparen token'>(</span><span class='thread identifier id'>thread</span><span class='lbrack token'>[</span><span class='symbol val'>:sdb_connection</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='@@bench ivar id'>@@bench</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='comma token'>,</span> <span class='parser identifier id'>parser</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ruby_to_sdb</h3>
</div><div id="ruby_to_sdb-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ruby_to_sdb</span><span class='args'>(value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a Ruby language value to a SDB value by replacing Ruby nil with the
user&#8217;s chosen string representation of nil. Non-nil values are
unaffected by this filter.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 152</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L152">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">152
153
154</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='ruby_to_sdb identifier id'>ruby_to_sdb</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span> <span class='integer val'>? </span><span class='@nil_rep ivar id'>@nil_rep</span> <span class='colon op'>:</span> <span class='value identifier id'>value</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>sdb_to_ruby</h3>
</div><div id="sdb_to_ruby-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>sdb_to_ruby</span><span class='args'>(value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a SDB value to a Ruby language value by replacing the user&#8217;s
chosen string representation of nil with Ruby nil. Values are unaffected by
this filter unless they match the nil representation exactly.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 158</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L158">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">158
159
160</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='sdb_to_ruby identifier id'>sdb_to_ruby</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='eql? fid id'>eql?</span><span class='lparen token'>(</span><span class='@nil_rep ivar id'>@nil_rep</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='nil nil kw'>nil</span> <span class='colon op'>:</span> <span class='value identifier id'>value</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>select</h3>
</div><div id="select-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>select</span><span class='args'>(select_expression, next_token = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Perform SQL-like select and fetch attributes. Attribute values must be
quoted with a single or double quote. If a quote appears within the
attribute value, it must be escaped with the same quote symbol as shown in
the following example. (Use array to pass select_expression params to avoid
manual escaping).
</p>
<pre class="code">
 <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='select identifier id'>select</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='string val'>&quot;select * from my_domain where gender=?&quot;</span><span class='comma token'>,</span> <span class='string val'>'female'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt;</span>
   <span class='lbrace token'>{</span><span class='symbol val'>:request_id</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;8241b843-0fb9-4d66-9100-effae12249ec&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:items</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span>
     <span class='lbrack token'>[</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;035f1ba8-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span>
         <span class='lbrace token'>{</span><span class='string val'>&quot;hobby&quot;</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;cooking&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;flowers&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;cats&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;name&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;Mary&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;country&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;Russia&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;gender&quot;</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;female&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;id&quot;</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;035f1ba8-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
       <span class='lbrace token'>{</span> <span class='string val'>&quot;0327614a-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span>
         <span class='lbrace token'>{</span><span class='string val'>&quot;hobby&quot;</span>   <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;patchwork&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;bundle jumping&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;name&quot;</span>    <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;Mary&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;country&quot;</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;USA&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;gender&quot;</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;female&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
          <span class='string val'>&quot;id&quot;</span>      <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='string val'>&quot;0327614a-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='dot3 op'>...</span> <span class='rbrack token'>]</span>
    <span class='symbol val'>:box_usage</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0.0000506197&quot;</span><span class='rbrace token'>}</span>

  <span class='sdb identifier id'>sdb</span><span class='dot token'>.</span><span class='select identifier id'>select</span><span class='lparen token'>(</span><span class='string val'>'select country, name from my_domain'</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt;</span>
   <span class='lbrace token'>{</span><span class='symbol val'>:request_id=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;b1600198-c317-413f-a8dc-4e7f864a940a&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:items=</span><span class='gt op'>&gt;</span>
     <span class='lbrack token'>[</span> <span class='lbrace token'>{</span> <span class='string val'>&quot;035f1ba8-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;name&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Mary&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>     <span class='string val'>&quot;country&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Russia&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
       <span class='lbrace token'>{</span> <span class='string val'>&quot;376d2e00-75b0-11dd-9557-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;name&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Putin&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>    <span class='string val'>&quot;country&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Russia&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
       <span class='lbrace token'>{</span> <span class='string val'>&quot;0327614a-dbd8-11dd-80bd-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;name&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Mary&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>     <span class='string val'>&quot;country&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;USA&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span>    <span class='rbrace token'>}</span><span class='comma token'>,</span>
       <span class='lbrace token'>{</span> <span class='string val'>&quot;372ebbd4-75b0-11dd-9557-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;name&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Bush&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>     <span class='string val'>&quot;country&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;USA&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span>    <span class='rbrace token'>}</span><span class='comma token'>,</span>
       <span class='lbrace token'>{</span> <span class='string val'>&quot;37a4e552-75b0-11dd-9557-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;name&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Medvedev&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='string val'>&quot;country&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Russia&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
       <span class='lbrace token'>{</span> <span class='string val'>&quot;38278dfe-75b0-11dd-9557-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;name&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Mary&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>     <span class='string val'>&quot;country&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Russia&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span> <span class='rbrace token'>}</span><span class='comma token'>,</span>
       <span class='lbrace token'>{</span> <span class='string val'>&quot;37df6c36-75b0-11dd-9557-001bfc466dd7&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='string val'>&quot;name&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;Mary&quot;</span><span class='rbrack token'>]</span><span class='comma token'>,</span>     <span class='string val'>&quot;country&quot;</span><span class='assign token'>=</span><span class='gt op'>&gt;</span><span class='lbrack token'>[</span><span class='string val'>&quot;USA&quot;</span><span class='rbrack token'>]</span><span class='rbrace token'>}</span>    <span class='rbrace token'>}</span> <span class='rbrack token'>]</span><span class='comma token'>,</span>
    <span class='symbol val'>:box_usage=</span><span class='gt op'>&gt;</span><span class='string val'>&quot;0.0000777663&quot;</span><span class='rbrace token'>}</span>
</pre>
<p>
see:
http://docs.amazonwebservices.com/AmazonSimpleDB/2007-11-07/DeveloperGuide/index.html?SDB_API_Select.html
</p>
<pre class="code">
     <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/docs.amazonwebservices.com/</span><span class='AmazonSimpleDB constant id'>AmazonSimpleDB</span><span class='div op'>/</span><span class='integer val'>2007</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>07</span><span class='div op'>/</span><span class='DeveloperGuide constant id'>DeveloperGuide</span><span class='div op'>/</span><span class='index identifier id'>index</span><span class='dot token'>.</span><span class='html? fid id'>html?</span><span class='UsingSelect constant id'>UsingSelect</span><span class='dot token'>.</span><span class='html identifier id'>html</span>
     <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/docs.amazonwebservices.com/</span><span class='AmazonSimpleDB constant id'>AmazonSimpleDB</span><span class='div op'>/</span><span class='integer val'>2007</span><span class='minus op'>-</span><span class='integer val'>11</span><span class='minus op'>-</span><span class='integer val'>07</span><span class='div op'>/</span><span class='DeveloperGuide constant id'>DeveloperGuide</span><span class='div op'>/</span><span class='index identifier id'>index</span><span class='dot token'>.</span><span class='html? fid id'>html?</span><span class='SDBLimits constant id'>SDBLimits</span><span class='dot token'>.</span><span class='html identifier id'>html</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 568</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L568">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='select identifier id'>select</span><span class='lparen token'>(</span><span class='select_expression identifier id'>select_expression</span><span class='comma token'>,</span> <span class='next_token identifier id'>next_token</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='select_expression identifier id'>select_expression</span>      <span class='assign token'>=</span> <span class='query_expression_from_array identifier id'>query_expression_from_array</span><span class='lparen token'>(</span><span class='select_expression identifier id'>select_expression</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='select_expression identifier id'>select_expression</span><span class='dot token'>.</span><span class='is_a? fid id'>is_a?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
  <span class='@last_query_expression ivar id'>@last_query_expression</span> <span class='assign token'>=</span> <span class='select_expression identifier id'>select_expression</span>
  <span class='comment val'>#</span>
  <span class='request_params identifier id'>request_params</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'SelectExpression'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='select_expression identifier id'>select_expression</span><span class='comma token'>,</span>
                     <span class='string val'>'NextToken'</span>        <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='next_token identifier id'>next_token</span> <span class='rbrace token'>}</span>
  <span class='link identifier id'>link</span>   <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;Select&quot;</span><span class='comma token'>,</span> <span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
  <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='select_response_to_ruby identifier id'>select_response_to_ruby</span><span class='lparen token'>(</span><span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span> <span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbSelectParser constant id'>QSdbSelectParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='result identifier id'>result</span> <span class='unless unless_mod kw'>unless</span> <span class='block_given? fid id'>block_given?</span>
  <span class='comment val'># loop if block if given</span>
  <span class='begin begin kw'>begin</span>
    <span class='comment val'># the block must return true if it wanna continue</span>
    <span class='break break kw'>break</span> <span class='unless unless_mod kw'>unless</span> <span class='yield yield kw'>yield</span><span class='lparen token'>(</span><span class='result identifier id'>result</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:next_token</span><span class='rbrack token'>]</span>
    <span class='comment val'># make new request</span>
    <span class='request_params identifier id'>request_params</span><span class='lbrack token'>[</span><span class='string val'>'NextToken'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='symbol val'>:next_token</span><span class='rbrack token'>]</span>
    <span class='link identifier id'>link</span>   <span class='assign token'>=</span> <span class='generate_request identifier id'>generate_request</span><span class='lparen token'>(</span><span class='string val'>&quot;Select&quot;</span><span class='comma token'>,</span> <span class='request_params identifier id'>request_params</span><span class='rparen token'>)</span>
    <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='select_response_to_ruby identifier id'>select_response_to_ruby</span><span class='lparen token'>(</span><span class='request_info identifier id'>request_info</span><span class='lparen token'>(</span> <span class='link identifier id'>link</span><span class='comma token'>,</span> <span class='QSdbSelectParser constant id'>QSdbSelectParser</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span> <span class='while while_mod kw'>while</span> <span class='true true kw'>true</span>
<span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span>
  <span class='on_exception identifier id'>on_exception</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>select_response_to_ruby</h3>
</div><div id="select_response_to_ruby-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>select_response_to_ruby</span><span class='args'>(response)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert select and query_with_attributes responses to a Ruby language
values by replacing the user&#8217;s chosen string representation of nil
with Ruby nil. (This method affects on a passed response value)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/helene/rightscale/sdb/right_sdb_interface.rb', line 164</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ahoward/helene/blob/ae407b60b0d282acdacd024861f002a58ab5d446/lib/helene/rightscale/sdb/right_sdb_interface.rb#L164">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">164
165
166
167
168
169
170
171
172
173</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='select_response_to_ruby identifier id'>select_response_to_ruby</span><span class='lparen token'>(</span><span class='response identifier id'>response</span><span class='rparen token'>)</span> <span class='comment val'>#:nodoc:</span>
  <span class='response identifier id'>response</span><span class='lbrack token'>[</span><span class='symbol val'>:items</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each_with_index identifier id'>each_with_index</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='item identifier id'>item</span><span class='comma token'>,</span> <span class='idx identifier id'>idx</span><span class='bitor op'>|</span>
    <span class='item identifier id'>item</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='bitor op'>|</span>
      <span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='bitor op'>|</span>
        <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='collect! fid id'>collect!</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span> <span class='sdb_to_ruby identifier id'>sdb_to_ruby</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='response identifier id'>response</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>