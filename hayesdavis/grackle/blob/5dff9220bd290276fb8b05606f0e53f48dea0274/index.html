<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>hayesdavis's grackle - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/hayesdavis/commits/grackle/master" rel="alternate" title="Recent Commits to grackle:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("hayesdavis", "grackle", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='hayesdavis/grackle/blob/5dff9220bd290276fb8b05606f0e53f48dea0274' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='hayesdavis/grackle/blob/5dff9220bd290276fb8b05606f0e53f48dea0274' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("hayesdavis", "grackle", "5dff9220bd290276fb8b05606f0e53f48dea0274", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/hayesdavis/grackle/tree/">Source</a></li>
            <li class=""><a href="http://github.com/hayesdavis/grackle/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/hayesdavis/grackle/network">Network</a></li>            
            <li class=""><a href="http://github.com/hayesdavis/grackle/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/hayesdavis/grackle">Wiki</a></li>
            <li class=""><a href="http://github.com/hayesdavis/grackle/graphs">Graphs</a></li>                    
            <li class="active"><a href="/hayesdavis/grackle">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/hayesdavis">hayesdavis</a> / <b><a href="http://github.com/hayesdavis/grackle/tree">grackle</a></b>        
                <a id="namespaces_button" rel="hayesdavis/grackle/blob/5dff9220bd290276fb8b05606f0e53f48dea0274" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="hayesdavis/grackle/blob/5dff9220bd290276fb8b05606f0e53f48dea0274" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>grackle</h1>
<p>
by Hayes Davis
</p>
<ul>
<li>http://twitter.com/hayesdavis

</li>
<li>hayes [at] appozite.com

</li>
<li>http://cheaptweet.com

</li>
<li>http://www.appozite.com

</li>
<li>http://hayesdavis.net

</li>
</ul>
<h2>DESCRIPTION</h2>
<p>
Grackle is a lightweight Ruby wrapper around the Twitter REST and Search
APIs. It&#8217;s based on my experience using the Twitter API to build
http://cheaptweet.com. The main goal of Grackle is to never require a
release when the Twitter API changes (which it often does) or in the face
of a particular Twitter API bug. As such it&#8217;s somewhat different from
other Twitter API libraries. It doesn&#8217;t try to hide the Twitter
&quot;methods&quot; under an access layer nor does it introduce concrete
classes for the various objects returned by Twitter. Instead, calls to the
Grackle client map directly to Twitter API URLs. The objects returned by
API calls are generated as OpenStructs on the fly and make no assumptions
about the presence or absence of any particular attributes. Taking this
approach means that changes to URLs used by Twitter, parameters required by
those URLs or return values will not require a new release. It will
potentially require, however, some modifications to your code that uses
Grackle.
</p>
<p>
Grackle supports both OAuth and HTTP basic authentication.
</p>
<h2>USING GRACKLE</h2>
<p>
Before you do anything else, you&#8217;ll need to
</p>
<pre class="code">
  <span class='require identifier id'>require</span> <span class='string val'>'grackle'</span>
</pre>
<h3>Creating a Grackle::Client</h3>
<h4>Using Basic Auth</h4>
<pre class="code">
  <span class='client identifier id'>client</span> <span class='assign token'>=</span> <span class='Grackle constant id'>Grackle</span><span class='colon2 op'>::</span><span class='Client constant id'>Client</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:auth=</span><span class='gt op'>&gt;</span><span class='lbrace token'>{</span><span class='symbol val'>:type=</span><span class='gt op'>&gt;</span><span class='symbol val'>:basic</span><span class='comma token'>,</span><span class='symbol val'>:username=</span><span class='gt op'>&gt;</span><span class='string val'>'your_user'</span><span class='comma token'>,</span><span class='symbol val'>:password=</span><span class='gt op'>&gt;</span><span class='string val'>'yourpass'</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>
<h4>Using OAuth</h4>
<pre class="code">
  <span class='client identifier id'>client</span> <span class='assign token'>=</span> <span class='Grackle constant id'>Grackle</span><span class='colon2 op'>::</span><span class='Client constant id'>Client</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='symbol val'>:auth=</span><span class='gt op'>&gt;</span><span class='lbrace token'>{</span>
    <span class='symbol val'>:type=</span><span class='gt op'>&gt;</span><span class='symbol val'>:oauth</span><span class='comma token'>,</span>
    <span class='symbol val'>:consumer_key=</span><span class='gt op'>&gt;</span><span class='string val'>'SOMECONSUMERKEYFROMTWITTER'</span><span class='comma token'>,</span> <span class='symbol val'>:consumer_secret=</span><span class='gt op'>&gt;</span><span class='string val'>'SOMECONSUMERTOKENFROMTWITTER'</span><span class='comma token'>,</span>
    <span class='symbol val'>:token=</span><span class='gt op'>&gt;</span><span class='string val'>'ACCESSTOKENACQUIREDONUSERSBEHALF'</span><span class='comma token'>,</span> <span class='symbol val'>:token_secret=</span><span class='gt op'>&gt;</span><span class='string val'>'SUPERSECRETACCESSTOKENSECRET'</span>
  <span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>
<h4>Using No Auth</h4>
<pre class="code">
  <span class='client identifier id'>client</span> <span class='assign token'>=</span> <span class='Grackle constant id'>Grackle</span><span class='colon2 op'>::</span><span class='Client constant id'>Client</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
</pre>
<p>
See Grackle::Client for more information about valid arguments to the
constructor. It&#8217;s quite configurable. Among other things, you can
turn on ssl and specify custom headers. The calls below are pretty much as
simple as it gets.
</p>
<h3>Grackle Method Syntax</h3>
<p>
Grackle uses a method syntax that corresponds to the Twitter API URLs with
a few twists. Where you would have a slash in a Twitter URL, that becomes a
&quot;.&quot; in a chained set of Grackle method calls. Each call in the
method chain is used to build Twitter URL path until a particular call is
encountered which causes the request to be sent. Methods which will cause a
request to be execute include:
</p>
<ul>
<li>A method call ending in &quot;?&quot; will cause an HTTP GET to be executed

</li>
<li>A method call ending in &quot;!&quot; will cause an HTTP POST to be
executed

</li>
<li>If a valid format such as .json, .xml, .rss or .atom is encounted, a get
will be executed with that format

</li>
<li>A format method can also include a ? or ! to determine GET or POST in that
format respectively

</li>
</ul>
<h3>GETting Data</h3>
<p>
The preferred and simplest way of executing a GET is to use the
&quot;?&quot; method notation. This will use the default client format
(usually JSON, but see Formats section below):
</p>
<pre class="code">
  <span class='client identifier id'>client</span><span class='dot token'>.</span><span class='users identifier id'>users</span><span class='dot token'>.</span><span class='show? fid id'>show?</span> <span class='symbol val'>:screen_name=</span><span class='gt op'>&gt;</span><span class='string val'>'some_user'</span> <span class='comment val'>#http://twitter.com/users/show.json?screen_name=some_user</span>
</pre>
<p>
You can force XML format by doing:
</p>
<pre class="code">
  <span class='client identifier id'>client</span><span class='dot token'>.</span><span class='users identifier id'>users</span><span class='dot token'>.</span><span class='show identifier id'>show</span><span class='dot token'>.</span><span class='xml? fid id'>xml?</span> <span class='symbol val'>:screen_name=</span><span class='gt op'>&gt;</span><span class='string val'>'some_user'</span> <span class='comment val'>#http://twitter.com/users/show.xml?scren_name=some_user</span>
</pre>
<p>
You can force JSON:
</p>
<pre class="code">
  <span class='client identifier id'>client</span><span class='dot token'>.</span><span class='users identifier id'>users</span><span class='dot token'>.</span><span class='show identifier id'>show</span><span class='dot token'>.</span><span class='json? fid id'>json?</span> <span class='symbol val'>:screen_name=</span><span class='gt op'>&gt;</span><span class='string val'>'some_user'</span> <span class='comment val'>#http://twitter.com/users/show.json?screen_name=some_user</span>
</pre>
<p>
Or, since Twitter also allows certain ids/screen_names to be part of their
URLs, this works:
</p>
<pre class="code">
  <span class='client identifier id'>client</span><span class='dot token'>.</span><span class='users identifier id'>users</span><span class='dot token'>.</span><span class='show identifier id'>show</span><span class='dot token'>.</span><span class='some_user? fid id'>some_user?</span> <span class='comment val'>#http://twitter.com/users/show/some_user.json</span>
</pre>
<p>
If you use an explicit format, you can leave off the &quot;?&quot; like so:
</p>
<pre class="code">
  <span class='client identifier id'>client</span><span class='dot token'>.</span><span class='users identifier id'>users</span><span class='dot token'>.</span><span class='show identifier id'>show</span><span class='dot token'>.</span><span class='xml identifier id'>xml</span> <span class='symbol val'>:screen_name=</span><span class='gt op'>&gt;</span><span class='string val'>'some_user'</span> <span class='comment val'>#http://twitter.com/users/show.xml?scren_name=some_user</span>
</pre>
<h3>POSTing data</h3>
<p>
To use Twitter API methods that require an HTTP POST, you need to end your
method chain with a bang (!)
</p>
<p>
The preferred way is to use the Client&#8217;s default format (usually
JSON, but see Formats section below):
</p>
<pre class="code">
  <span class='client identifier id'>client</span><span class='dot token'>.</span><span class='statuses identifier id'>statuses</span><span class='dot token'>.</span><span class='update! fid id'>update!</span> <span class='symbol val'>:status=</span><span class='gt op'>&gt;</span><span class='string val'>'this status is from grackle'</span> <span class='comment val'>#POST to http://twitter.com/statuses/update.json</span>
</pre>
<p>
You can force a format. To update the authenticated user&#8217;s status
using the XML format:
</p>
<pre class="code">
  <span class='client identifier id'>client</span><span class='dot token'>.</span><span class='statuses identifier id'>statuses</span><span class='dot token'>.</span><span class='update identifier id'>update</span><span class='dot token'>.</span><span class='xml! fid id'>xml!</span> <span class='symbol val'>:status=</span><span class='gt op'>&gt;</span><span class='string val'>'this status is from grackle'</span> <span class='comment val'>#POST to http://twitter.com/statuses/update.xml</span>
</pre>
<p>
Or, with JSON
</p>
<pre class="code">
  <span class='client identifier id'>client</span><span class='dot token'>.</span><span class='statuses identifier id'>statuses</span><span class='dot token'>.</span><span class='update identifier id'>update</span><span class='dot token'>.</span><span class='json! fid id'>json!</span> <span class='symbol val'>:status=</span><span class='gt op'>&gt;</span><span class='string val'>'this status is from grackle'</span> <span class='comment val'>#POST to http://twitter.com/statuses/update.json</span>
</pre>
<h3>Toggling APIs</h3>
<p>
By default, the Grackle::Client sends all requests to the Twitter REST API.
If you want to send requests to the Twitter Search API, just set
Grackle::Client.api to :search. To toggle back, set it to be :rest. All
requests made after setting this attribute will go to that API.
</p>
<p>
If you want to make a specific request to one API and not change the
Client&#8217;s overall api setting beyond that request, you can use the
bracket syntax like so:
</p>
<pre class="code">
  <span class='client identifier id'>client</span><span class='lbrack token'>[</span><span class='symbol val'>:search</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='trends identifier id'>trends</span><span class='dot token'>.</span><span class='daily? fid id'>daily?</span> <span class='symbol val'>:exclude=</span><span class='gt op'>&gt;</span><span class='string val'>'hashtags'</span>
  <span class='client identifier id'>client</span><span class='lbrack token'>[</span><span class='symbol val'>:rest</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='users identifier id'>users</span><span class='dot token'>.</span><span class='show? fid id'>show?</span> <span class='symbol val'>:id=</span><span class='gt op'>&gt;</span><span class='string val'>'hayesdavis'</span>
</pre>
<p>
Search and REST requests are all built using the same method chaining and
termination conventions.
</p>
<h3>Parameter handling</h3>
<ul>
<li>All parameters are URL encoded as necessary.

</li>
<li>If you use a File object as a parameter it will be POSTed to Twitter in a
multipart request.

</li>
<li>If you use a Time object as a parameter, .httpdate will be called on it and
that value will be used

</li>
</ul>
<h3>Return Values</h3>
<p>
Regardless of the format used, Grackle returns an OpenStruct (actually a
Grackle::TwitterStruct) of data. The attributes available on these structs
correspond to the data returned by Twitter.
</p>
<h3>Dealing with Errors</h3>
<p>
If the request to Twitter does not return a status code of 200, then a
TwitterError is thrown. This contains the HTTP method used, the full
request URI, the response status, the response body in text and a response
object build by parsing the formatted error returned by Twitter. It&#8217;s
a good idea to wrap your API calls with rescue clauses for
Grackle::TwitterError.
</p>
<p>
If there is an unexpected connection error or Twitter returns data in the
wrong format (which it can do), you&#8217;ll still get a TwitterError.
</p>
<h3>Formats</h3>
<p>
Twitter allows you to request data in particular formats. Grackle
automatically parses JSON and XML formatted responses and returns an
OpenStruct. If you specify a format that Grackle doesn&#8217;t parse for
you, you&#8217;ll receive a string containing the raw response body. The
Grackle::Client has a default_format you can specify. By default, the
default_format is :json. If you don&#8217;t include a named format in your
method chain as described above, but use a &quot;?&quot; or &quot;!&quot;
then the Grackle::Client.default_format is used.
</p>
<h2>REQUIREMENTS:</h2>
<p>
You&#8217;ll need the following gems to use all features of Grackle:
</p>
<ul>
<li>json

</li>
<li>oauth

</li>
<li>mime-types

</li>
</ul>
<h2>INSTALL:</h2>
<pre class="code">
  <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='sources identifier id'>sources</span> <span class='minus op'>-</span><span class='a identifier id'>a</span> <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/gems.github.com
  sudo gem install hayesdavis-grackle
</span></pre>
<h2>LICENSE:</h2>
<p>
(The MIT License)
</p>
<p>
Copyright &#169; 2009
</p>
<p>
Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
&#8216;Software&#8217;), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to the
following conditions:
</p>
<p>
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
</p>
<p>
THE SOFTWARE IS PROVIDED &#8216;AS IS&#8217;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
USE OR OTHER DEALINGS IN THE SOFTWARE.
</p>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>