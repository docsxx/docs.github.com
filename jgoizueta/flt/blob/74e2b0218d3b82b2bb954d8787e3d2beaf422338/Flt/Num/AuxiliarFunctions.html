<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>jgoizueta's flt - Module: Flt::Num::AuxiliarFunctions - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/jgoizueta/commits/flt/master" rel="alternate" title="Recent Commits to flt:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("jgoizueta", "flt", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("jgoizueta", "flt", "74e2b0218d3b82b2bb954d8787e3d2beaf422338", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/jgoizueta/flt/tree/">Source</a></li>
            <li class=""><a href="http://github.com/jgoizueta/flt/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/jgoizueta/flt/network">Network</a></li>            
            <li class=""><a href="http://github.com/jgoizueta/flt/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/jgoizueta/flt">Wiki</a></li>
            <li class=""><a href="http://github.com/jgoizueta/flt/graphs">Graphs</a></li>                    
            <li class="active"><a href="/jgoizueta/flt">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/jgoizueta">jgoizueta</a> / <b><a href="http://github.com/jgoizueta/flt/tree">flt</a></b>        
                <a id="namespaces_button" rel="jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Flt_Num_AuxiliarFunctions">
  <h1>Module: Flt::Num::AuxiliarFunctions</h1>
  <div class="section attributes">
  
    <div class="">
      <h2>Class Attributes</h2>
      <table>
      
        <tr>
          <th class="name">log_radix_digits</td>
          <td class="readwrite">
            [<span id='log_radix_digits-class_method'>R</span>W] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Returns the value of attribute <tt>log_radix_digits</tt>.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="EXP_INC-constant">EXP_INC</dt>
      <dd>4</dd>
    
      <dt id="LOG10_LB_CORRECTION-constant">LOG10_LB_CORRECTION</dt>
      <dd>{ # (1..9).map_hash{|i| LOG10_MULT - (LOG10_MULT*Math.log10(i)).floor}
  '1'=&gt; 100, '2'=&gt; 70, '3'=&gt; 53, '4'=&gt; 40, '5'=&gt; 31,
  '6'=&gt; 23, '7'=&gt; 16, '8'=&gt; 10, '9'=&gt; 5
}</dd>
    
      <dt id="LOG10_MULT-constant">LOG10_MULT</dt>
      <dd>100</dd>
    
      <dt id="LOG2_LB_CORRECTION-constant">LOG2_LB_CORRECTION</dt>
      <dd>[ # (1..15).map{|i| (LOG2_MULT*Math.log(16.0/i)/Math.log(2)).ceil}
  400, 300, 242, 200, 168, 142, 120, 100, 84, 68, 55, 42, 30, 20, 10
  # for LOG2_MULT=64: 256, 192, 155, 128, 108, 91, 77, 64, 54, 44, 35, 27, 20, 13, 6
]</dd>
    
      <dt id="LOG2_MULT-constant">LOG2_MULT</dt>
      <dd>100 </dd>
    
      <dt id="LOG_PREC_INC-constant">LOG_PREC_INC</dt>
      <dd>4</dd>
    
      <dt id="LOG_RADIX_EXTRA-constant">LOG_RADIX_EXTRA</dt>
      <dd>3</dd>
    
      <dt id="LOG_RADIX_INC-constant">LOG_RADIX_INC</dt>
      <dd>2</dd>
    
  </dl>
</div>

</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_convert-instance_method">#_convert</span><span class='args'>(x, error = true)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Convert a numeric value to decimal (internal use).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_div_nearest-instance_method">#_div_nearest</span><span class='args'>(a, b)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Closest integer to a/b, a and b positive integers; rounds to even in the
case of a tie.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_exp-instance_method">#_exp</span><span class='args'>(c, e, p)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Compute an approximation to exp(c*radix**e), with p decimal places of
precision.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_iexp-instance_method">#_iexp</span><span class='args'>(x, m, l = 8)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Given integers x and M, M &gt; 0, such that x/M is small in absolute value,
compute an integer approximation to M*exp(x/M).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_ilog-instance_method">#_ilog</span><span class='args'>(x, m, l = 8)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Integer approximation to M*log(x/M), with absolute error boundable in terms
only of x/M.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_log-instance_method">#_log</span><span class='args'>(c, e, p)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Given integers c, e and p with c &gt; 0, compute an integer approximation
to radix**p * log(c*radix**e), with an absolute error of at most 1.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_log_radix_digits-instance_method">#_log_radix_digits</span><span class='args'>(p)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Given an integer p &gt;= 0, return floor(radix**p)*log(radix).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_log_radix_lb-instance_method">#_log_radix_lb</span><span class='args'>(c)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_log_radix_mult-instance_method">#_log_radix_mult</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_normalize-instance_method">#_normalize</span><span class='args'>(op1, op2, prec = 0)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Normalizes op1, op2 to have the same exp and length of coefficient.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_number_of_digits-instance_method">#_number_of_digits</span><span class='args'>(v)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_parser-instance_method">#_parser</span><span class='args'>(txt)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Parse numeric text literals (internal use).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_power-instance_method">#_power</span><span class='args'>(xc, xe, yc, ye, p)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Given integers xc, xe, yc and ye representing Num x = xc*radix**xe and y =
yc*radix**ye, compute x**y.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_rshift_nearest-instance_method">#_rshift_nearest</span><span class='args'>(x, shift)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Given an integer x and a nonnegative integer shift, return closest integer
to x / 2**shift; use round-to-even in case of a tie.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#_sqrt_nearest-instance_method">#_sqrt_nearest</span><span class='args'>(n, a)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Closest integer to the square root of the positive integer n.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#log10_lb-instance_method">#log10_lb</span><span class='args'>(c)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Compute a lower bound for LOG10_MULT*log10&#169; for a positive integer c.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#log2_lb-instance_method">#log2_lb</span><span class='args'>(c)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Compute a lower bound for LOG2_MULT*log10&#169; for a positive integer c.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>_convert</h3>
</div><div id="_convert-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_convert</span><span class='args'>(x, error = true)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Convert a numeric value to decimal (internal use)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3669</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3669">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3669
3670
3671
3672
3673
3674
3675
3676
3677
3678
3679</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_convert identifier id'>_convert</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='error identifier id'>error</span><span class='assign token'>=</span><span class='true true kw'>true</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='x identifier id'>x</span>
  <span class='when when kw'>when</span> <span class='num_class identifier id'>num_class</span>
    <span class='x identifier id'>x</span>
  <span class='when when kw'>when</span> <span class='mult op'>*</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='context identifier id'>context</span><span class='dot token'>.</span><span class='coercible_types identifier id'>coercible_types</span>
    <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='TypeError constant id'>TypeError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;Unable to convert #{x.class} to #{num_class}&quot;</span> <span class='if if_mod kw'>if</span> <span class='error identifier id'>error</span>
    <span class='nil nil kw'>nil</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_div_nearest</h3>
</div><div id="_div_nearest-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_div_nearest</span><span class='args'>(a, b)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Closest integer to a/b, a and b positive integers; rounds to even in the
case of a tie.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3963</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3963">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3963
3964
3965
3966</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='comma token'>,</span> <span class='b identifier id'>b</span><span class='rparen token'>)</span>
  <span class='q identifier id'>q</span><span class='comma token'>,</span> <span class='r identifier id'>r</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='b identifier id'>b</span><span class='rparen token'>)</span>
  <span class='q identifier id'>q</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='integer val'>2</span><span class='mult op'>*</span><span class='r identifier id'>r</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='q identifier id'>q</span><span class='bitand op'>&amp;</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='gt op'>&gt;</span> <span class='b identifier id'>b</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_exp</h3>
</div><div id="_exp-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_exp</span><span class='args'>(c, e, p)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Compute an approximation to exp(c*radix**e), with p decimal places of
precision. Returns integers d, f such that:
</p>
<pre class="code">
  <span class='radix identifier id'>radix</span><span class='pow op'>**</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='leq op'>&lt;=</span> <span class='d identifier id'>d</span> <span class='leq op'>&lt;=</span> <span class='radix identifier id'>radix</span><span class='pow op'>**</span><span class='p identifier id'>p</span><span class='comma token'>,</span> <span class='and and kw'>and</span>
  <span class='lparen token'>(</span><span class='d identifier id'>d</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='mult op'>*</span><span class='radix identifier id'>radix</span><span class='pow op'>**</span><span class='f identifier id'>f</span> <span class='lt op'>&lt;</span> <span class='exp identifier id'>exp</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='mult op'>*</span><span class='radix identifier id'>radix</span><span class='pow op'>**</span><span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='lt op'>&lt;</span> <span class='lparen token'>(</span><span class='d identifier id'>d</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='mult op'>*</span><span class='radix identifier id'>radix</span><span class='pow op'>**</span><span class='f identifier id'>f</span>
</pre>
<p>
In other words, d*radix**f is an approximation to exp(c*radix**e) with p
digits of precision, and with an error in d of at most 1. This is almost,
but not quite, the same as the error being &lt; 1ulp: when d
</p>
<h1>radix**(p-1) the error could be up to radix ulp.</h1>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3766</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3766">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3766
3767
3768
3769
3770
3771
3772
3773
3774
3775
3776
3777
3778
3779
3780
3781
3782
3783
3784
3785
3786
3787
3788
3789
3790
3791</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_exp identifier id'>_exp</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='p identifier id'>p</span><span class='rparen token'>)</span>
    <span class='comment val'># we'll call iexp with M = radix**(p+2), giving p+3 digits of precision</span>
    <span class='p identifier id'>p</span> <span class='opasgn op'>+=</span> <span class='EXP_INC constant id'>EXP_INC</span>

    <span class='comment val'># compute log(radix) with extra precision = adjusted exponent of c*radix**e</span>
    <span class='comment val'># TODO: without the .abs tests fail because c is negative: c should not be negative!!</span>
    <span class='extra identifier id'>extra</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='e identifier id'>e</span> <span class='plus op'>+</span> <span class='_number_of_digits identifier id'>_number_of_digits</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='dot token'>.</span><span class='abs identifier id'>abs</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='max identifier id'>max</span>
    <span class='q identifier id'>q</span> <span class='assign token'>=</span> <span class='p identifier id'>p</span> <span class='plus op'>+</span> <span class='extra identifier id'>extra</span>

    <span class='comment val'># compute quotient c*radix**e/(log(radix)) = c*radix**(e+q)/(log(radix)*radix**q),</span>
    <span class='comment val'># rounding down</span>
    <span class='shift identifier id'>shift</span> <span class='assign token'>=</span> <span class='e identifier id'>e</span><span class='plus op'>+</span><span class='q identifier id'>q</span>
    <span class='if if kw'>if</span> <span class='shift identifier id'>shift</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span>
        <span class='cshift identifier id'>cshift</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span><span class='mult op'>*</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='shift identifier id'>shift</span><span class='rparen token'>)</span>
    <span class='else else kw'>else</span>
        <span class='cshift identifier id'>cshift</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span><span class='div op'>/</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='minus op'>-</span><span class='shift identifier id'>shift</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='quot identifier id'>quot</span><span class='comma token'>,</span> <span class='rem identifier id'>rem</span> <span class='assign token'>=</span> <span class='cshift identifier id'>cshift</span><span class='dot token'>.</span><span class='divmod identifier id'>divmod</span><span class='lparen token'>(</span><span class='_log_radix_digits identifier id'>_log_radix_digits</span><span class='lparen token'>(</span><span class='q identifier id'>q</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

    <span class='comment val'># reduce remainder back to original precision</span>
    <span class='rem identifier id'>rem</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='rem identifier id'>rem</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='extra identifier id'>extra</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

    <span class='comment val'># for radix=10: error in result of _iexp &lt; 120;  error after division &lt; 0.62</span>
    <span class='r identifier id'>r</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='_iexp identifier id'>_iexp</span><span class='lparen token'>(</span><span class='rem identifier id'>rem</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='EXP_INC constant id'>EXP_INC</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='quot identifier id'>quot</span> <span class='minus op'>-</span> <span class='p identifier id'>p</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='EXP_INC constant id'>EXP_INC</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='r identifier id'>r</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_iexp</h3>
</div><div id="_iexp-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_iexp</span><span class='args'>(x, m, l = 8)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Given integers x and M, M &gt; 0, such that x/M is small in absolute value,
compute an integer approximation to M*exp(x/M). For redix=10, and 0 &lt;=
x/M &lt;= 2.4, the absolute error in the result is bounded by 60 (and is
usually much smaller).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3847</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3847">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3847
3848
3849
3850
3851
3852
3853
3854
3855
3856
3857
3858
3859
3860
3861
3862
3863
3864
3865
3866
3867
3868
3869
3870
3871
3872
3873
3874
3875
3876
3877
3878
3879
3880
3881</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_iexp identifier id'>_iexp</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='l identifier id'>l</span><span class='assign token'>=</span><span class='integer val'>8</span><span class='rparen token'>)</span>

    <span class='comment val'># Algorithm: to compute exp(z) for a real number z, first divide z</span>
    <span class='comment val'># by a suitable power R of 2 so that |z/2**R| &lt; 2**-L.  Then</span>
    <span class='comment val'># compute expm1(z/2**R) = exp(z/2**R) - 1 using the usual Taylor</span>
    <span class='comment val'># series</span>
    <span class='comment val'>#</span>
    <span class='comment val'>#     expm1(x) = x + x**2/2! + x**3/3! + ...</span>
    <span class='comment val'>#</span>
    <span class='comment val'># Now use the identity</span>
    <span class='comment val'>#</span>
    <span class='comment val'>#     expm1(2x) = expm1(x)*(expm1(x)+2)</span>
    <span class='comment val'>#</span>
    <span class='comment val'># R times to compute the sequence expm1(z/2**R),</span>
    <span class='comment val'># expm1(z/2**(R-1)), ... , exp(z/2), exp(z).</span>

    <span class='comment val'># Find R such that x/2**R/M &lt;= 2**-L</span>
    <span class='r identifier id'>r</span> <span class='assign token'>=</span> <span class='_nbits identifier id'>_nbits</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='lshft op'>&lt;&lt;</span><span class='l identifier id'>l</span><span class='rparen token'>)</span><span class='div op'>/</span><span class='m identifier id'>m</span><span class='rparen token'>)</span>

    <span class='comment val'># Taylor series.  (2**L)**T &gt; M</span>
    <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='minus op'>-</span><span class='lparen token'>(</span><span class='minus op'>-</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='mult op'>*</span><span class='_number_of_digits identifier id'>_number_of_digits</span><span class='lparen token'>(</span><span class='m identifier id'>m</span><span class='rparen token'>)</span><span class='div op'>/</span><span class='lparen token'>(</span><span class='integer val'>3</span><span class='mult op'>*</span><span class='l identifier id'>l</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='t identifier id'>t</span><span class='rparen token'>)</span>
    <span class='mshift identifier id'>mshift</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='lshft op'>&lt;&lt;</span><span class='r identifier id'>r</span>
    <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot3 op'>...</span><span class='t identifier id'>t</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='dot token'>.</span><span class='reverse identifier id'>reverse</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
        <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='mshift identifier id'>mshift</span> <span class='plus op'>+</span> <span class='y identifier id'>y</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='mshift identifier id'>mshift</span> <span class='mult op'>*</span> <span class='i identifier id'>i</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># Expansion</span>
    <span class='lparen token'>(</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='r identifier id'>r</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='dot token'>.</span><span class='reverse identifier id'>reverse</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='bitor op'>|</span>
        <span class='mshift identifier id'>mshift</span> <span class='assign token'>=</span> <span class='m identifier id'>m</span><span class='lshft op'>&lt;&lt;</span><span class='lparen token'>(</span><span class='k identifier id'>k</span><span class='plus op'>+</span><span class='integer val'>2</span><span class='rparen token'>)</span>
        <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='plus op'>+</span><span class='mshift identifier id'>mshift</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='mshift identifier id'>mshift</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>

    <span class='return return kw'>return</span> <span class='m identifier id'>m</span><span class='plus op'>+</span><span class='y identifier id'>y</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_ilog</h3>
</div><div id="_ilog-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_ilog</span><span class='args'>(x, m, l = 8)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Integer approximation to M*log(x/M), with absolute error boundable in terms
only of x/M.
</p>
<p>
Given positive integers x and M, return an integer approximation to M *
log(x/M). For radix=10, L = 8 and 0.1 &lt;= x/M &lt;= 10 the difference
between the approximation and the exact result is at most 22. For L = 8 and
1.0 &lt;= x/M &lt;= 10.0 the difference is at most 15. In both cases these
are upper bounds on the error; it will usually be much smaller.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3892</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3892">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3892
3893
3894
3895
3896
3897
3898
3899
3900
3901
3902
3903
3904
3905
3906
3907
3908
3909
3910
3911
3912
3913
3914
3915
3916
3917
3918
3919
3920
3921
3922
3923
3924
3925
3926
3927
3928
3929
3930
3931
3932
3933
3934</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_ilog identifier id'>_ilog</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='l identifier id'>l</span> <span class='assign token'>=</span> <span class='integer val'>8</span><span class='rparen token'>)</span>
  <span class='comment val'># The basic algorithm is the following: let log1p be the function</span>
  <span class='comment val'># log1p(x) = log(1+x).  Then log(x/M) = log1p((x-M)/M).  We use</span>
  <span class='comment val'># the reduction</span>
  <span class='comment val'>#</span>
  <span class='comment val'>#    log1p(y) = 2*log1p(y/(1+sqrt(1+y)))</span>
  <span class='comment val'>#</span>
  <span class='comment val'># repeatedly until the argument to log1p is small (&lt; 2**-L in</span>
  <span class='comment val'># absolute value).  For small y we can use the Taylor series</span>
  <span class='comment val'># expansion</span>
  <span class='comment val'>#</span>
  <span class='comment val'>#    log1p(y) ~ y - y**2/2 + y**3/3 - ... - (-y)**T/T</span>
  <span class='comment val'>#</span>
  <span class='comment val'># truncating at T such that y**T is small enough.  The whole</span>
  <span class='comment val'># computation is carried out in a form of fixed-point arithmetic,</span>
  <span class='comment val'># with a real number z being represented by an integer</span>
  <span class='comment val'># approximation to z*M.  To avoid loss of precision, the y below</span>
  <span class='comment val'># is actually an integer approximation to 2**R*y*M, where R is the</span>
  <span class='comment val'># number of reductions performed so far.</span>

  <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='x identifier id'>x</span><span class='minus op'>-</span><span class='m identifier id'>m</span>
  <span class='comment val'># argument reduction; R = number of reductions performed</span>
  <span class='r identifier id'>r</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  <span class='comment val'># while (r &lt;= l &amp;&amp; y.abs &lt;&lt; l-r &gt;= m ||</span>
  <span class='comment val'>#        r &gt; l and y.abs&gt;&gt; r-l &gt;= m)</span>
  <span class='while while kw'>while</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='r identifier id'>r</span> <span class='leq op'>&lt;=</span> <span class='l identifier id'>l</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='dot token'>.</span><span class='abs identifier id'>abs</span> <span class='lshft op'>&lt;&lt;</span> <span class='lparen token'>(</span><span class='l identifier id'>l</span><span class='minus op'>-</span><span class='r identifier id'>r</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='geq op'>&gt;=</span> <span class='m identifier id'>m</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='orop op'>||</span>
         <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='r identifier id'>r</span> <span class='gt op'>&gt;</span> <span class='l identifier id'>l</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='dot token'>.</span><span class='abs identifier id'>abs</span><span class='rshft op'>&gt;&gt;</span><span class='lparen token'>(</span><span class='r identifier id'>r</span><span class='minus op'>-</span><span class='l identifier id'>l</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='geq op'>&gt;=</span> <span class='m identifier id'>m</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='y identifier id'>y</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='m identifier id'>m</span><span class='mult op'>*</span><span class='y identifier id'>y</span><span class='rparen token'>)</span> <span class='lshft op'>&lt;&lt;</span> <span class='integer val'>1</span><span class='comma token'>,</span>
                       <span class='m identifier id'>m</span> <span class='plus op'>+</span> <span class='_sqrt_nearest identifier id'>_sqrt_nearest</span><span class='lparen token'>(</span><span class='m identifier id'>m</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='m identifier id'>m</span><span class='plus op'>+</span><span class='_rshift_nearest identifier id'>_rshift_nearest</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='r identifier id'>r</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='r identifier id'>r</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Taylor series with T terms</span>
  <span class='t identifier id'>t</span> <span class='assign token'>=</span> <span class='minus op'>-</span><span class='lparen token'>(</span><span class='integer val'>-10</span><span class='mult op'>*</span><span class='_number_of_digits identifier id'>_number_of_digits</span><span class='lparen token'>(</span><span class='m identifier id'>m</span><span class='rparen token'>)</span><span class='div op'>/</span><span class='lparen token'>(</span><span class='integer val'>3</span><span class='mult op'>*</span><span class='l identifier id'>l</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  <span class='yshift identifier id'>yshift</span> <span class='assign token'>=</span> <span class='_rshift_nearest identifier id'>_rshift_nearest</span><span class='lparen token'>(</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='r identifier id'>r</span><span class='rparen token'>)</span>
  <span class='w identifier id'>w</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='t identifier id'>t</span><span class='rparen token'>)</span>
  <span class='comment val'># (1...t).reverse_each do |k| # Ruby 1.9</span>
  <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot3 op'>...</span><span class='t identifier id'>t</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_a identifier id'>to_a</span><span class='dot token'>.</span><span class='reverse identifier id'>reverse</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='k identifier id'>k</span><span class='bitor op'>|</span>
     <span class='w identifier id'>w</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='k identifier id'>k</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='yshift identifier id'>yshift</span><span class='mult op'>*</span><span class='w identifier id'>w</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='return return kw'>return</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='w identifier id'>w</span><span class='mult op'>*</span><span class='y identifier id'>y</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_log</h3>
</div><div id="_log-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_log</span><span class='args'>(c, e, p)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Given integers c, e and p with c &gt; 0, compute an integer approximation
to radix**p * log(c*radix**e), with an absolute error of at most 1. Assumes
that c*radix**e is not exactly 1.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3797</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3797">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3797
3798
3799
3800
3801
3802
3803
3804
3805
3806
3807
3808
3809
3810
3811
3812
3813
3814
3815
3816
3817
3818
3819
3820
3821
3822
3823
3824
3825
3826
3827
3828
3829
3830
3831
3832
3833
3834
3835
3836
3837
3838
3839
3840
3841</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_log identifier id'>_log</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='comma token'>,</span> <span class='e identifier id'>e</span><span class='comma token'>,</span> <span class='p identifier id'>p</span><span class='rparen token'>)</span>
    <span class='comment val'># Increase precision by 2. The precision increase is compensated</span>
    <span class='comment val'># for at the end with a division</span>
    <span class='p identifier id'>p</span> <span class='opasgn op'>+=</span> <span class='LOG_PREC_INC constant id'>LOG_PREC_INC</span>

    <span class='comment val'># rewrite c*radix**e as d*radix**f with either f &gt;= 0 and 1 &lt;= d &lt;= radix,</span>
    <span class='comment val'># or f &lt;= 0 and 1/radix &lt;= d &lt;= 1.  Then we can compute radix**p * log(c*radix**e)</span>
    <span class='comment val'># as radix**p * log(d) + radix**p*f * log(radix).</span>
    <span class='l identifier id'>l</span> <span class='assign token'>=</span> <span class='_number_of_digits identifier id'>_number_of_digits</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='rparen token'>)</span>
    <span class='f identifier id'>f</span> <span class='assign token'>=</span> <span class='e identifier id'>e</span><span class='plus op'>+</span><span class='l identifier id'>l</span> <span class='minus op'>-</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='plus op'>+</span><span class='l identifier id'>l</span> <span class='geq op'>&gt;=</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>

    <span class='comment val'># compute approximation to radix**p*log(d), with error &lt; 27 for radix=10</span>
    <span class='if if kw'>if</span> <span class='p identifier id'>p</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
        <span class='k identifier id'>k</span> <span class='assign token'>=</span> <span class='e identifier id'>e</span><span class='plus op'>+</span><span class='p identifier id'>p</span><span class='minus op'>-</span><span class='f identifier id'>f</span>
        <span class='if if kw'>if</span> <span class='k identifier id'>k</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span>
            <span class='c identifier id'>c</span> <span class='opasgn op'>*=</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='k identifier id'>k</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
            <span class='c identifier id'>c</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='minus op'>-</span><span class='k identifier id'>k</span><span class='rparen token'>)</span><span class='rparen token'>)</span>  <span class='comment val'># error of &lt;= 0.5 in c for radix=10</span>
        <span class='end end kw'>end</span>

        <span class='comment val'># _ilog magnifies existing error in c by a factor of at most radix</span>
        <span class='log_d identifier id'>log_d</span> <span class='assign token'>=</span> <span class='_ilog identifier id'>_ilog</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='comment val'># error &lt; 5 + 22 = 27 for radix=10</span>
    <span class='else else kw'>else</span>
        <span class='comment val'># p &lt;= 0: just approximate the whole thing by 0; error &lt; 2.31 for radix=10</span>
        <span class='log_d identifier id'>log_d</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># compute approximation to f*radix**p*log(radix), with error &lt; 11 for radix=10.</span>
    <span class='if if kw'>if</span> <span class='f identifier id'>f</span>
        <span class='extra identifier id'>extra</span> <span class='assign token'>=</span> <span class='_number_of_digits identifier id'>_number_of_digits</span><span class='lparen token'>(</span><span class='f identifier id'>f</span><span class='dot token'>.</span><span class='abs identifier id'>abs</span><span class='rparen token'>)</span> <span class='minus op'>-</span> <span class='integer val'>1</span>
        <span class='if if kw'>if</span> <span class='p identifier id'>p</span> <span class='plus op'>+</span> <span class='extra identifier id'>extra</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span>
            <span class='comment val'># for radix=10:</span>
            <span class='comment val'># error in f * _log10_digits(p+extra) &lt; |f| * 1 = |f|</span>
            <span class='comment val'># after division, error &lt; |f|/10**extra + 0.5 &lt; 10 + 0.5 &lt; 11</span>
            <span class='f_log_r identifier id'>f_log_r</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='f identifier id'>f</span><span class='mult op'>*</span><span class='_log_radix_digits identifier id'>_log_radix_digits</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='plus op'>+</span><span class='extra identifier id'>extra</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='extra identifier id'>extra</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
        <span class='else else kw'>else</span>
            <span class='f_log_r identifier id'>f_log_r</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
        <span class='end end kw'>end</span>
    <span class='else else kw'>else</span>
        <span class='f_log_r identifier id'>f_log_r</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='end end kw'>end</span>

    <span class='comment val'># error in sum &lt; 11+27 = 38; error after division &lt; 0.38 + 0.5 &lt; 1 for radix=10</span>
    <span class='return return kw'>return</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='f_log_r identifier id'>f_log_r</span> <span class='plus op'>+</span> <span class='log_d identifier id'>log_d</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='LOG_PREC_INC constant id'>LOG_PREC_INC</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='comment val'># extra radix factor for base 2 ???</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_log_radix_digits</h3>
</div><div id="_log_radix_digits-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_log_radix_digits</span><span class='args'>(p)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Given an integer p &gt;= 0, return floor(radix**p)*log(radix).
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>ArgumentError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3980</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3980">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3980
3981
3982
3983
3984
3985
3986
3987
3988
3989
3990
3991
3992
3993
3994
3995
3996
3997
3998
3999
4000
4001
4002
4003
4004
4005
4006
4007</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_log_radix_digits identifier id'>_log_radix_digits</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='rparen token'>)</span>
  <span class='comment val'># digits are stored as a string, for quick conversion to</span>
  <span class='comment val'># integer in the case that we've already computed enough</span>
  <span class='comment val'># digits; the stored digits should always bge correct</span>
  <span class='comment val'># (truncated, not rounded to nearest).</span>
  <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>&quot;p should be nonnegative&quot;</span> <span class='if if_mod kw'>if</span> <span class='p identifier id'>p</span><span class='lt op'>&lt;</span><span class='integer val'>0</span>
  <span class='stored_digits identifier id'>stored_digits</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='AuxiliarFunctions constant id'>AuxiliarFunctions</span><span class='dot token'>.</span><span class='log_radix_digits identifier id'>log_radix_digits</span><span class='lbrack token'>[</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='rbrack token'>]</span> <span class='orop op'>||</span> <span class='string val'>&quot;&quot;</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='p identifier id'>p</span> <span class='geq op'>&gt;=</span> <span class='stored_digits identifier id'>stored_digits</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
      <span class='digits identifier id'>digits</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
      <span class='comment val'># compute p+3, p+6, p+9, ... digits; continue until at</span>
      <span class='comment val'># least one of the extra digits is nonzero</span>
      <span class='extra identifier id'>extra</span> <span class='assign token'>=</span> <span class='LOG_RADIX_EXTRA constant id'>LOG_RADIX_EXTRA</span>
      <span class='loop identifier id'>loop</span> <span class='do do kw'>do</span>
        <span class='comment val'># compute p+extra digits, correct to within 1ulp</span>
        <span class='m identifier id'>m</span> <span class='assign token'>=</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='plus op'>+</span><span class='extra identifier id'>extra</span><span class='plus op'>+</span><span class='LOG_RADIX_INC constant id'>LOG_RADIX_INC</span><span class='rparen token'>)</span>
        <span class='digits identifier id'>digits</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='_ilog identifier id'>_ilog</span><span class='lparen token'>(</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='mult op'>*</span><span class='m identifier id'>m</span><span class='comma token'>,</span> <span class='m identifier id'>m</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='LOG_RADIX_INC constant id'>LOG_RADIX_INC</span><span class='rparen token'>)</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='rparen token'>)</span>
        <span class='break break kw'>break</span> <span class='if if_mod kw'>if</span> <span class='digits identifier id'>digits</span><span class='lbrack token'>[</span><span class='minus op'>-</span><span class='extra identifier id'>extra</span><span class='dot2 op'>..</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='neq op'>!=</span> <span class='string val'>'0'</span><span class='mult op'>*</span><span class='extra identifier id'>extra</span>
        <span class='extra identifier id'>extra</span> <span class='opasgn op'>+=</span> <span class='LOG_RADIX_EXTRA constant id'>LOG_RADIX_EXTRA</span>
      <span class='end end kw'>end</span>
      <span class='comment val'># if the radix &lt; e (i.e. only for radix==2), we must prefix with a 0 because log(radix)&lt;1</span>
      <span class='comment val'># BUT THIS REDUCES PRECISION BY ONE? : may be avoid prefix and adjust scaling in the caller</span>
      <span class='prefix identifier id'>prefix</span> <span class='assign token'>=</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='eq op'>==</span><span class='integer val'>2</span> <span class='question op'>?</span> <span class='string val'>'0'</span> <span class='colon op'>:</span> <span class='string val'>''</span>
      <span class='comment val'># keep all reliable digits so far; remove trailing zeros</span>
      <span class='comment val'># and next nonzero digit</span>
      <span class='AuxiliarFunctions constant id'>AuxiliarFunctions</span><span class='dot token'>.</span><span class='log_radix_digits identifier id'>log_radix_digits</span><span class='lbrack token'>[</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='prefix identifier id'>prefix</span> <span class='plus op'>+</span> <span class='digits identifier id'>digits</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/0*$/</span><span class='comma token'>,</span><span class='string val'>''</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot3 op'>...</span><span class='integer val'>-1</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  <span class='return return kw'>return</span> <span class='lparen token'>(</span><span class='AuxiliarFunctions constant id'>AuxiliarFunctions</span><span class='dot token'>.</span><span class='log_radix_digits identifier id'>log_radix_digits</span><span class='lbrack token'>[</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='dot2 op'>..</span><span class='p identifier id'>p</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='lparen token'>(</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_log_radix_lb</h3>
</div><div id="_log_radix_lb-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_log_radix_lb</span><span class='args'>(c)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 4044</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L4044">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">4044
4045
4046
4047
4048
4049
4050
4051
4052
4053</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_log_radix_lb identifier id'>_log_radix_lb</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='rparen token'>)</span>
  <span class='case case kw'>case</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span>
  <span class='when when kw'>when</span> <span class='integer val'>10</span>
    <span class='log10_lb identifier id'>log10_lb</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='rparen token'>)</span>
  <span class='when when kw'>when</span> <span class='integer val'>2</span>
    <span class='log2_lb identifier id'>log2_lb</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;_log_radix_lb not implemented for base #{num_class.radix}&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_log_radix_mult</h3>
</div><div id="_log_radix_mult-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_log_radix_mult</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 4033</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L4033">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">4033
4034
4035
4036
4037
4038
4039
4040
4041
4042</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_log_radix_mult identifier id'>_log_radix_mult</span>
  <span class='case case kw'>case</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span>
  <span class='when when kw'>when</span> <span class='integer val'>10</span>
    <span class='LOG10_MULT constant id'>LOG10_MULT</span>
  <span class='when when kw'>when</span> <span class='integer val'>2</span>
    <span class='LOG2_MULT constant id'>LOG2_MULT</span>
  <span class='else else kw'>else</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='dstring node'>&quot;_log_radix_mult not implemented for base #{num_class.radix}&quot;</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_normalize</h3>
</div><div id="_normalize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_normalize</span><span class='args'>(op1, op2, prec = 0)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Normalizes op1, op2 to have the same exp and length of coefficient. Used
for addition.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3691</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3691">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3691
3692
3693
3694
3695
3696
3697
3698
3699
3700
3701
3702
3703
3704
3705
3706
3707
3708
3709</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_normalize identifier id'>_normalize</span><span class='lparen token'>(</span><span class='op1 identifier id'>op1</span><span class='comma token'>,</span> <span class='op2 identifier id'>op2</span><span class='comma token'>,</span> <span class='prec identifier id'>prec</span><span class='assign token'>=</span><span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='op1 identifier id'>op1</span><span class='dot token'>.</span><span class='exponent identifier id'>exponent</span> <span class='lt op'>&lt;</span> <span class='op2 identifier id'>op2</span><span class='dot token'>.</span><span class='exponent identifier id'>exponent</span>
    <span class='swap identifier id'>swap</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
    <span class='tmp identifier id'>tmp</span><span class='comma token'>,</span><span class='other identifier id'>other</span> <span class='assign token'>=</span> <span class='op2 identifier id'>op2</span><span class='comma token'>,</span><span class='op1 identifier id'>op1</span>
  <span class='else else kw'>else</span>
    <span class='swap identifier id'>swap</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>
    <span class='tmp identifier id'>tmp</span><span class='comma token'>,</span><span class='other identifier id'>other</span> <span class='assign token'>=</span> <span class='op1 identifier id'>op1</span><span class='comma token'>,</span><span class='op2 identifier id'>op2</span>
  <span class='end end kw'>end</span>
  <span class='tmp_len identifier id'>tmp_len</span> <span class='assign token'>=</span> <span class='tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='number_of_digits identifier id'>number_of_digits</span>
  <span class='other_len identifier id'>other_len</span> <span class='assign token'>=</span> <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='number_of_digits identifier id'>number_of_digits</span>
  <span class='exp identifier id'>exp</span> <span class='assign token'>=</span> <span class='tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='exponent identifier id'>exponent</span> <span class='plus op'>+</span> <span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='comma token'>,</span> <span class='tmp_len identifier id'>tmp_len</span> <span class='minus op'>-</span> <span class='prec identifier id'>prec</span> <span class='minus op'>-</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='min identifier id'>min</span>
  <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='other_len identifier id'>other_len</span><span class='plus op'>+</span><span class='other identifier id'>other</span><span class='dot token'>.</span><span class='exponent identifier id'>exponent</span><span class='minus op'>-</span><span class='integer val'>1</span> <span class='lt op'>&lt;</span> <span class='exp identifier id'>exp</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='prec identifier id'>prec</span><span class='gt op'>&gt;</span><span class='integer val'>0</span>
    <span class='other identifier id'>other</span> <span class='assign token'>=</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='other identifier id'>other</span><span class='dot token'>.</span><span class='sign identifier id'>sign</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='exp identifier id'>exp</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='tmp identifier id'>tmp</span> <span class='assign token'>=</span> <span class='Num constant id'>Num</span><span class='lparen token'>(</span><span class='tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='sign identifier id'>sign</span><span class='comma token'>,</span>
                    <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_mult_radix_power identifier id'>int_mult_radix_power</span><span class='lparen token'>(</span><span class='tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='coefficient identifier id'>coefficient</span><span class='comma token'>,</span> <span class='tmp identifier id'>tmp</span><span class='dot token'>.</span><span class='exponent identifier id'>exponent</span><span class='minus op'>-</span><span class='other identifier id'>other</span><span class='dot token'>.</span><span class='exponent identifier id'>exponent</span><span class='rparen token'>)</span><span class='comma token'>,</span>
                    <span class='other identifier id'>other</span><span class='dot token'>.</span><span class='exponent identifier id'>exponent</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='swap identifier id'>swap</span> <span class='question op'>?</span> <span class='lbrack token'>[</span><span class='other identifier id'>other</span><span class='comma token'>,</span> <span class='tmp identifier id'>tmp</span><span class='rbrack token'>]</span> <span class='colon op'>:</span> <span class='lbrack token'>[</span><span class='tmp identifier id'>tmp</span><span class='comma token'>,</span> <span class='other identifier id'>other</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_number_of_digits</h3>
</div><div id="_number_of_digits-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_number_of_digits</span><span class='args'>(v)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 4055</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L4055">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">4055
4056
4057</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_number_of_digits identifier id'>_number_of_digits</span><span class='lparen token'>(</span><span class='v identifier id'>v</span><span class='rparen token'>)</span>
  <span class='_ndigits identifier id'>_ndigits</span><span class='lparen token'>(</span><span class='v identifier id'>v</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_parser</h3>
</div><div id="_parser-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_parser</span><span class='args'>(txt)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Parse numeric text literals (internal use)
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3682</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3682">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3682
3683
3684
3685
3686
3687
3688</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_parser identifier id'>_parser</span><span class='lparen token'>(</span><span class='txt identifier id'>txt</span><span class='rparen token'>)</span>
  <span class='md identifier id'>md</span> <span class='assign token'>=</span> <span class='regexp val'>/^\s*([-+])?(?:(?:(\d+)(?:\.(\d*))?|\.(\d+))(?:E([-+]?\d+))?|Inf(?:inity)?|(s)?NaN(\d*))\s*$/i</span><span class='dot token'>.</span><span class='match identifier id'>match</span><span class='lparen token'>(</span><span class='txt identifier id'>txt</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='md identifier id'>md</span>
    <span class='OpenStruct constant id'>OpenStruct</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:sign=</span><span class='gt op'>&gt;</span><span class='md identifier id'>md</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:int=</span><span class='gt op'>&gt;</span><span class='md identifier id'>md</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:frac=</span><span class='gt op'>&gt;</span><span class='md identifier id'>md</span><span class='lbrack token'>[</span><span class='integer val'>3</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:onlyfrac=</span><span class='gt op'>&gt;</span><span class='md identifier id'>md</span><span class='lbrack token'>[</span><span class='integer val'>4</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:exp=</span><span class='gt op'>&gt;</span><span class='md identifier id'>md</span><span class='lbrack token'>[</span><span class='integer val'>5</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                   <span class='symbol val'>:signal=</span><span class='gt op'>&gt;</span><span class='md identifier id'>md</span><span class='lbrack token'>[</span><span class='integer val'>6</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:diag=</span><span class='gt op'>&gt;</span><span class='md identifier id'>md</span><span class='lbrack token'>[</span><span class='integer val'>7</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_power</h3>
</div><div id="_power-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_power</span><span class='args'>(xc, xe, yc, ye, p)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Given integers xc, xe, yc and ye representing Num x = xc*radix**xe and y =
yc*radix**ye, compute x**y. Returns a pair of integers (c, e) such that:
</p>
<pre class="code">
  <span class='radix identifier id'>radix</span><span class='pow op'>**</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rparen token'>)</span> <span class='leq op'>&lt;=</span> <span class='c identifier id'>c</span> <span class='leq op'>&lt;=</span> <span class='radix identifier id'>radix</span><span class='pow op'>**</span><span class='p identifier id'>p</span><span class='comma token'>,</span> <span class='and and kw'>and</span>
  <span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='mult op'>*</span><span class='radix identifier id'>radix</span><span class='pow op'>**</span><span class='e identifier id'>e</span> <span class='lt op'>&lt;</span> <span class='x identifier id'>x</span><span class='pow op'>**</span><span class='y identifier id'>y</span> <span class='lt op'>&lt;</span> <span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='mult op'>*</span><span class='radix identifier id'>radix</span><span class='pow op'>**</span><span class='e identifier id'>e</span>
</pre>
<p>
in other words, c*radix**e is an approximation to x**y with p digits of
precision, and with an error in c of at most 1. (This is almost, but not
quite, the same as the error being &lt; 1ulp: when c
</p>
<h2>radix**(p-1) we can only guarantee error &lt; radix ulp.)</h2>
<p>
We assume that: x is positive and not equal to 1, and y is nonzero.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3723</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3723">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3723
3724
3725
3726
3727
3728
3729
3730
3731
3732
3733
3734
3735
3736
3737
3738
3739
3740
3741
3742
3743
3744
3745
3746
3747
3748
3749
3750
3751
3752
3753</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_power identifier id'>_power</span><span class='lparen token'>(</span><span class='xc identifier id'>xc</span><span class='comma token'>,</span> <span class='xe identifier id'>xe</span><span class='comma token'>,</span> <span class='yc identifier id'>yc</span><span class='comma token'>,</span> <span class='ye identifier id'>ye</span><span class='comma token'>,</span> <span class='p identifier id'>p</span><span class='rparen token'>)</span>
  <span class='comment val'># Find b such that radix**(b-1) &lt;= |y| &lt;= radix**b</span>
  <span class='b identifier id'>b</span> <span class='assign token'>=</span> <span class='_number_of_digits identifier id'>_number_of_digits</span><span class='lparen token'>(</span><span class='yc identifier id'>yc</span><span class='dot token'>.</span><span class='abs identifier id'>abs</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='ye identifier id'>ye</span>

  <span class='comment val'># log(x) = lxc*radix**(-p-b-1), to p+b+1 places after the decimal point</span>
  <span class='lxc identifier id'>lxc</span> <span class='assign token'>=</span> <span class='_log identifier id'>_log</span><span class='lparen token'>(</span><span class='xc identifier id'>xc</span><span class='comma token'>,</span> <span class='xe identifier id'>xe</span><span class='comma token'>,</span> <span class='p identifier id'>p</span><span class='plus op'>+</span><span class='b identifier id'>b</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rparen token'>)</span>

  <span class='comment val'># compute product y*log(x) = yc*lxc*radix**(-p-b-1+ye) = pc*radix**(-p-1)</span>
  <span class='shift identifier id'>shift</span> <span class='assign token'>=</span> <span class='ye identifier id'>ye</span><span class='minus op'>-</span><span class='b identifier id'>b</span>
  <span class='if if kw'>if</span> <span class='shift identifier id'>shift</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span>
      <span class='pc identifier id'>pc</span> <span class='assign token'>=</span> <span class='lxc identifier id'>lxc</span><span class='mult op'>*</span><span class='yc identifier id'>yc</span><span class='mult op'>*</span><span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='shift identifier id'>shift</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
      <span class='pc identifier id'>pc</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='lxc identifier id'>lxc</span><span class='mult op'>*</span><span class='yc identifier id'>yc</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='minus op'>-</span><span class='shift identifier id'>shift</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='pc identifier id'>pc</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
      <span class='comment val'># we prefer a result that isn't exactly 1; this makes it</span>
      <span class='comment val'># easier to compute a correctly rounded result in __pow__</span>
      <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='_number_of_digits identifier id'>_number_of_digits</span><span class='lparen token'>(</span><span class='xc identifier id'>xc</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='xe identifier id'>xe</span> <span class='geq op'>&gt;=</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='eq op'>==</span> <span class='lparen token'>(</span><span class='yc identifier id'>yc</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='rparen token'>)</span> <span class='comment val'># if x**y &gt; 1:</span>
          <span class='coeff identifier id'>coeff</span><span class='comma token'>,</span> <span class='exp identifier id'>exp</span> <span class='assign token'>=</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='minus op'>-</span><span class='p identifier id'>p</span>
      <span class='else else kw'>else</span>
          <span class='coeff identifier id'>coeff</span><span class='comma token'>,</span> <span class='exp identifier id'>exp</span> <span class='assign token'>=</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='int_radix_power identifier id'>int_radix_power</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='rparen token'>)</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='minus op'>-</span><span class='p identifier id'>p</span>
      <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
      <span class='coeff identifier id'>coeff</span><span class='comma token'>,</span> <span class='exp identifier id'>exp</span> <span class='assign token'>=</span> <span class='_exp identifier id'>_exp</span><span class='lparen token'>(</span><span class='pc identifier id'>pc</span><span class='comma token'>,</span> <span class='minus op'>-</span><span class='lparen token'>(</span><span class='p identifier id'>p</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='p identifier id'>p</span><span class='plus op'>+</span><span class='integer val'>1</span><span class='rparen token'>)</span>
      <span class='coeff identifier id'>coeff</span> <span class='assign token'>=</span> <span class='_div_nearest identifier id'>_div_nearest</span><span class='lparen token'>(</span><span class='coeff identifier id'>coeff</span><span class='comma token'>,</span> <span class='num_class identifier id'>num_class</span><span class='dot token'>.</span><span class='radix identifier id'>radix</span><span class='rparen token'>)</span>
      <span class='exp identifier id'>exp</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
  <span class='end end kw'>end</span>

  <span class='return return kw'>return</span> <span class='coeff identifier id'>coeff</span><span class='comma token'>,</span> <span class='exp identifier id'>exp</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_rshift_nearest</h3>
</div><div id="_rshift_nearest-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_rshift_nearest</span><span class='args'>(x, shift)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Given an integer x and a nonnegative integer shift, return closest integer
to x / 2**shift; use round-to-even in case of a tie.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3955</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3955">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3955
3956
3957
3958
3959</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_rshift_nearest identifier id'>_rshift_nearest</span><span class='lparen token'>(</span><span class='x identifier id'>x</span><span class='comma token'>,</span> <span class='shift identifier id'>shift</span><span class='rparen token'>)</span>
    <span class='b identifier id'>b</span><span class='comma token'>,</span> <span class='q identifier id'>q</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='integer val'>1</span> <span class='lshft op'>&lt;&lt;</span> <span class='shift identifier id'>shift</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='x identifier id'>x</span> <span class='rshft op'>&gt;&gt;</span> <span class='shift identifier id'>shift</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='q identifier id'>q</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='lparen token'>(</span><span class='lparen token'>(</span><span class='integer val'>2</span><span class='mult op'>*</span><span class='lparen token'>(</span><span class='x identifier id'>x</span> <span class='bitand op'>&amp;</span> <span class='lparen token'>(</span><span class='b identifier id'>b</span><span class='minus op'>-</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='q identifier id'>q</span><span class='bitand op'>&amp;</span><span class='integer val'>1</span><span class='rparen token'>)</span><span class='rparen token'>)</span> <span class='gt op'>&gt;</span> <span class='b identifier id'>b</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
    <span class='comment val'>#return q + (2*(x &amp; (b-1)) + (((q&amp;1) &gt; b) ? 1 : 0))</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>_sqrt_nearest</h3>
</div><div id="_sqrt_nearest-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>_sqrt_nearest</span><span class='args'>(n, a)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Closest integer to the square root of the positive integer n. a is an
initial approximation to the square root. Any positive integer will do for
a, but the closer a is to the square root of n the faster convergence will
be.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 3940</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L3940">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">3940
3941
3942
3943
3944
3945
3946
3947
3948
3949
3950
3951</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='_sqrt_nearest identifier id'>_sqrt_nearest</span><span class='lparen token'>(</span><span class='n identifier id'>n</span><span class='comma token'>,</span> <span class='a identifier id'>a</span><span class='rparen token'>)</span>

    <span class='if if kw'>if</span> <span class='n identifier id'>n</span> <span class='leq op'>&lt;=</span> <span class='integer val'>0</span> <span class='or or kw'>or</span> <span class='a identifier id'>a</span> <span class='leq op'>&lt;=</span> <span class='integer val'>0</span>
        <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>&quot;Both arguments to _sqrt_nearest should be positive.&quot;</span>
    <span class='end end kw'>end</span>

    <span class='b identifier id'>b</span><span class='assign token'>=</span><span class='integer val'>0</span>
    <span class='while while kw'>while</span> <span class='a identifier id'>a</span> <span class='neq op'>!=</span> <span class='b identifier id'>b</span>
        <span class='b identifier id'>b</span><span class='comma token'>,</span> <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='a identifier id'>a</span><span class='comma token'>,</span> <span class='a identifier id'>a</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='n identifier id'>n</span><span class='div op'>/</span><span class='a identifier id'>a</span><span class='rshft op'>&gt;&gt;</span><span class='integer val'>1</span> <span class='comment val'># ??</span>
    <span class='end end kw'>end</span>
    <span class='return return kw'>return</span> <span class='a identifier id'>a</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>log10_lb</h3>
</div><div id="log10_lb-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>log10_lb</span><span class='args'>(c)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Compute a lower bound for LOG10_MULT*log10&#169; for a positive integer c.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>ArgumentError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 4027</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L4027">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">4027
4028
4029
4030
4031</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='log10_lb identifier id'>log10_lb</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>&quot;The argument to _log10_lb should be nonnegative.&quot;</span> <span class='if if_mod kw'>if</span> <span class='c identifier id'>c</span> <span class='leq op'>&lt;=</span> <span class='integer val'>0</span>
    <span class='str_c identifier id'>str_c</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
    <span class='return return kw'>return</span> <span class='LOG10_MULT constant id'>LOG10_MULT</span><span class='mult op'>*</span><span class='str_c identifier id'>str_c</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='minus op'>-</span> <span class='LOG10_LB_CORRECTION constant id'>LOG10_LB_CORRECTION</span><span class='lbrack token'>[</span><span class='str_c identifier id'>str_c</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>log2_lb</h3>
</div><div id="log2_lb-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>log2_lb</span><span class='args'>(c)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Compute a lower bound for LOG2_MULT*log10&#169; for a positive integer c.
</p>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>ArgumentError</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/flt/num.rb', line 4015</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/jgoizueta/flt/blob/74e2b0218d3b82b2bb954d8787e3d2beaf422338/lib/flt/num.rb#L4015">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">4015
4016
4017
4018
4019</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='log2_lb identifier id'>log2_lb</span><span class='lparen token'>(</span><span class='c identifier id'>c</span><span class='rparen token'>)</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='comma token'>,</span> <span class='string val'>&quot;The argument to _log2_lb should be nonnegative.&quot;</span> <span class='if if_mod kw'>if</span> <span class='c identifier id'>c</span> <span class='leq op'>&lt;=</span> <span class='integer val'>0</span>
    <span class='str_c identifier id'>str_c</span> <span class='assign token'>=</span> <span class='c identifier id'>c</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='integer val'>16</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='LOG2_MULT constant id'>LOG2_MULT</span><span class='mult op'>*</span><span class='integer val'>4</span><span class='mult op'>*</span><span class='str_c identifier id'>str_c</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='minus op'>-</span> <span class='LOG2_LB_CORRECTION constant id'>LOG2_LB_CORRECTION</span><span class='lbrack token'>[</span><span class='str_c identifier id'>str_c</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='lparen token'>(</span><span class='integer val'>16</span><span class='rparen token'>)</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>