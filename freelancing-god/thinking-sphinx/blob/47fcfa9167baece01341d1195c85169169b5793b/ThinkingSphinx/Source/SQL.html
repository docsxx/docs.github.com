<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>freelancing-god's thinking-sphinx - Module: ThinkingSphinx::Source::SQL - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/freelancing-god/commits/thinking-sphinx/master" rel="alternate" title="Recent Commits to thinking-sphinx:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("freelancing-god", "thinking-sphinx", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("freelancing-god", "thinking-sphinx", "47fcfa9167baece01341d1195c85169169b5793b", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/freelancing-god/thinking-sphinx/tree/">Source</a></li>
            <li class=""><a href="http://github.com/freelancing-god/thinking-sphinx/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/freelancing-god/thinking-sphinx/network">Network</a></li>            
            <li class=""><a href="http://github.com/freelancing-god/thinking-sphinx/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/freelancing-god/thinking-sphinx">Wiki</a></li>
            <li class=""><a href="http://github.com/freelancing-god/thinking-sphinx/graphs">Graphs</a></li>                    
            <li class="active"><a href="/freelancing-god/thinking-sphinx">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/freelancing-god">freelancing-god</a> / <b><a href="http://github.com/freelancing-god/thinking-sphinx/tree">thinking-sphinx</a></b>        
                <a id="namespaces_button" rel="freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module ThinkingSphinx_Source_SQL">
  <h1>Module: ThinkingSphinx::Source::SQL</h1>
  <div class="section constants">
  
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#crc_column-instance_method">#crc_column</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#quote_column-instance_method">#quote_column</span><span class='args'>(column)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#sql_group_clause-instance_method">#sql_group_clause</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#sql_query_pre_for_core-instance_method">#sql_query_pre_for_core</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#sql_query_pre_for_delta-instance_method">#sql_query_pre_for_delta</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#sql_select_clause-instance_method">#sql_select_clause</span><span class='args'>(offset)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#sql_where_clause-instance_method">#sql_where_clause</span><span class='args'>(options)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_sql-instance_method">#to_sql</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Generates the big SQL statement to get the data back for all the fields and
attributes, using all the relevant association joins.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_sql_query_info-instance_method">#to_sql_query_info</span><span class='args'>(offset)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Simple helper method for the query info SQL - which is a statement that
returns the single row for a corresponding id.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#to_sql_query_range-instance_method">#to_sql_query_range</span><span class='args'>(options = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Simple helper method for the query range SQL - which is a statement that
returns minimum and maximum id values.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>crc_column</h3>
</div><div id="crc_column-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>crc_column</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 115</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L115">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">115
116
117
118
119
120
121
122
123
124
125
126</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='crc_column identifier id'>crc_column</span>
  <span class='if if kw'>if</span> <span class='@model ivar id'>@model</span><span class='dot token'>.</span><span class='table_exists? fid id'>table_exists?</span> <span class='andop op'>&amp;&amp;</span>
    <span class='@model ivar id'>@model</span><span class='dot token'>.</span><span class='column_names identifier id'>column_names</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='@model ivar id'>@model</span><span class='dot token'>.</span><span class='inheritance_column identifier id'>inheritance_column</span><span class='rparen token'>)</span>
    
    <span class='adapter identifier id'>adapter</span><span class='dot token'>.</span><span class='cast_to_unsigned identifier id'>cast_to_unsigned</span><span class='lparen token'>(</span><span class='adapter identifier id'>adapter</span><span class='dot token'>.</span><span class='convert_nulls identifier id'>convert_nulls</span><span class='lparen token'>(</span>
      <span class='adapter identifier id'>adapter</span><span class='dot token'>.</span><span class='crc identifier id'>crc</span><span class='lparen token'>(</span><span class='adapter identifier id'>adapter</span><span class='dot token'>.</span><span class='quote_with_table identifier id'>quote_with_table</span><span class='lparen token'>(</span><span class='@model ivar id'>@model</span><span class='dot token'>.</span><span class='inheritance_column identifier id'>inheritance_column</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='true true kw'>true</span><span class='rparen token'>)</span><span class='comma token'>,</span>
      <span class='@model ivar id'>@model</span><span class='dot token'>.</span><span class='to_crc32 identifier id'>to_crc32</span>
    <span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='@model ivar id'>@model</span><span class='dot token'>.</span><span class='to_crc32 identifier id'>to_crc32</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>quote_column</h3>
</div><div id="quote_column-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>quote_column</span><span class='args'>(column)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 111</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L111">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">111
112
113</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='quote_column identifier id'>quote_column</span><span class='lparen token'>(</span><span class='column identifier id'>column</span><span class='rparen token'>)</span>
  <span class='@model ivar id'>@model</span><span class='dot token'>.</span><span class='connection identifier id'>connection</span><span class='dot token'>.</span><span class='quote_column_name identifier id'>quote_column_name</span><span class='lparen token'>(</span><span class='column identifier id'>column</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>sql_group_clause</h3>
</div><div id="sql_group_clause-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>sql_group_clause</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 85</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L85">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">85
86
87
88
89
90
91
92
93
94
95
96
97</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='sql_group_clause identifier id'>sql_group_clause</span>
  <span class='internal_groupings identifier id'>internal_groupings</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='if if kw'>if</span> <span class='@model ivar id'>@model</span><span class='dot token'>.</span><span class='column_names identifier id'>column_names</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='@model ivar id'>@model</span><span class='dot token'>.</span><span class='inheritance_column identifier id'>inheritance_column</span><span class='rparen token'>)</span>
     <span class='internal_groupings identifier id'>internal_groupings</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;#{@model.quoted_table_name}.#{quote_column(@model.inheritance_column)}&quot;</span>
  <span class='end end kw'>end</span>

  <span class='lparen token'>(</span>
    <span class='lbrack token'>[</span><span class='dstring node'>&quot;#{@model.quoted_table_name}.#{quote_column(@model.primary_key)}&quot;</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> 
    <span class='@fields ivar id'>@fields</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='field identifier id'>field</span><span class='bitor op'>|</span>     <span class='field identifier id'>field</span><span class='dot token'>.</span><span class='to_group_sql identifier id'>to_group_sql</span>     <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span> <span class='plus op'>+</span>
    <span class='@attributes ivar id'>@attributes</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='attribute identifier id'>attribute</span><span class='bitor op'>|</span> <span class='attribute identifier id'>attribute</span><span class='dot token'>.</span><span class='to_group_sql identifier id'>to_group_sql</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span> <span class='plus op'>+</span>
    <span class='@groupings ivar id'>@groupings</span> <span class='plus op'>+</span> <span class='internal_groupings identifier id'>internal_groupings</span>
  <span class='rparen token'>)</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;, &quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>sql_query_pre_for_core</h3>
</div><div id="sql_query_pre_for_core-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>sql_query_pre_for_core</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 99</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L99">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">99
100
101
102
103
104
105</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='sql_query_pre_for_core identifier id'>sql_query_pre_for_core</span>
  <span class='if if kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='delta? fid id'>delta?</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='@index ivar id'>@index</span><span class='dot token'>.</span><span class='delta_object identifier id'>delta_object</span><span class='dot token'>.</span><span class='reset_query identifier id'>reset_query</span><span class='lparen token'>(</span><span class='@model ivar id'>@model</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
    <span class='lbrack token'>[</span><span class='@index ivar id'>@index</span><span class='dot token'>.</span><span class='delta_object identifier id'>delta_object</span><span class='dot token'>.</span><span class='reset_query identifier id'>reset_query</span><span class='lparen token'>(</span><span class='@model ivar id'>@model</span><span class='rparen token'>)</span><span class='rbrack token'>]</span>
  <span class='else else kw'>else</span>
    <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>sql_query_pre_for_delta</h3>
</div><div id="sql_query_pre_for_delta-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>sql_query_pre_for_delta</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 107</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L107">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">107
108
109</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='sql_query_pre_for_delta identifier id'>sql_query_pre_for_delta</span>
  <span class='lbrack token'>[</span><span class='string val'>&quot;&quot;</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>sql_select_clause</h3>
</div><div id="sql_select_clause-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>sql_select_clause</span><span class='args'>(offset)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 60</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L60">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">60
61
62
63
64
65
66
67
68</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='sql_select_clause identifier id'>sql_select_clause</span><span class='lparen token'>(</span><span class='offset identifier id'>offset</span><span class='rparen token'>)</span>
  <span class='unique_id_expr identifier id'>unique_id_expr</span> <span class='assign token'>=</span> <span class='ThinkingSphinx constant id'>ThinkingSphinx</span><span class='dot token'>.</span><span class='unique_id_expression identifier id'>unique_id_expression</span><span class='lparen token'>(</span><span class='offset identifier id'>offset</span><span class='rparen token'>)</span>

  <span class='lparen token'>(</span>
    <span class='lbrack token'>[</span><span class='dstring node'>&quot;#{@model.quoted_table_name}.#{quote_column(@model.primary_key)} #{unique_id_expr} AS #{quote_column(@model.primary_key)} &quot;</span><span class='rbrack token'>]</span> <span class='plus op'>+</span> 
    <span class='@fields ivar id'>@fields</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span>     <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='field identifier id'>field</span><span class='bitor op'>|</span>     <span class='field identifier id'>field</span><span class='dot token'>.</span><span class='to_select_sql identifier id'>to_select_sql</span>     <span class='rbrace token'>}</span> <span class='plus op'>+</span>
    <span class='@attributes ivar id'>@attributes</span><span class='dot token'>.</span><span class='collect identifier id'>collect</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='attribute identifier id'>attribute</span><span class='bitor op'>|</span> <span class='attribute identifier id'>attribute</span><span class='dot token'>.</span><span class='to_select_sql identifier id'>to_select_sql</span> <span class='rbrace token'>}</span>
  <span class='rparen token'>)</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>&quot;, &quot;</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>sql_where_clause</h3>
</div><div id="sql_where_clause-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>sql_where_clause</span><span class='args'>(options)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 70</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L70">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">70
71
72
73
74
75
76
77
78
79
80
81
82
83</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='sql_where_clause identifier id'>sql_where_clause</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='rparen token'>)</span>
  <span class='logic identifier id'>logic</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='logic identifier id'>logic</span> <span class='opasgn op'>+=</span> <span class='lbrack token'>[</span>
    <span class='dstring node'>&quot;#{@model.quoted_table_name}.#{quote_column(@model.primary_key)} &gt;= $start&quot;</span><span class='comma token'>,</span>
    <span class='dstring node'>&quot;#{@model.quoted_table_name}.#{quote_column(@model.primary_key)} &lt;= $end&quot;</span>
  <span class='rbrack token'>]</span> <span class='unless unless_mod kw'>unless</span> <span class='@index ivar id'>@index</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:disable_range</span><span class='rbrack token'>]</span>

  <span class='if if kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='delta? fid id'>delta?</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='@index ivar id'>@index</span><span class='dot token'>.</span><span class='delta_object identifier id'>delta_object</span><span class='dot token'>.</span><span class='clause identifier id'>clause</span><span class='lparen token'>(</span><span class='@model ivar id'>@model</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:delta</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
    <span class='logic identifier id'>logic</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;#{@index.delta_object.clause(@model, options[:delta])}&quot;</span>
  <span class='end end kw'>end</span>

  <span class='logic identifier id'>logic</span> <span class='opasgn op'>+=</span> <span class='lparen token'>(</span><span class='@conditions ivar id'>@conditions</span> <span class='orop op'>||</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='logic identifier id'>logic</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='integer val'>? </span><span class='string val'>&quot;&quot;</span> <span class='colon op'>:</span> <span class='dstring node'>&quot;WHERE #{logic.join(' AND ')}&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_sql</h3>
</div><div id="to_sql-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_sql</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Generates the big SQL statement to get the data back for all the fields and
attributes, using all the relevant association joins. If you want the
version filtered for delta values, send through :delta =&gt; true in the
options. Won&#8217;t do much though if the index isn&#8217;t set up to
support a delta sibling.
</p>
<p>
Examples:
</p>
<pre class="code">
  <span class='source identifier id'>source</span><span class='dot token'>.</span><span class='to_sql identifier id'>to_sql</span>
  <span class='source identifier id'>source</span><span class='dot token'>.</span><span class='to_sql identifier id'>to_sql</span><span class='lparen token'>(</span><span class='symbol val'>:delta</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 15</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L15">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">15
16
17
18
19
20</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_sql identifier id'>to_sql</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='sql identifier id'>sql</span> <span class='assign token'>=</span> <span class='string val'>&quot;SELECT \#{ sql_select_clause options[:offset] }\nFROM \#{ @model.quoted_table_name }\n\#{ all_associations.collect { |assoc| assoc.to_sql }.join(' ') }\n\#{ sql_where_clause(options) }\nGROUP BY \#{ sql_group_clause }\n&quot;</span>

  <span class='sql identifier id'>sql</span> <span class='opasgn op'>+=</span> <span class='string val'>&quot; ORDER BY NULL&quot;</span> <span class='if if_mod kw'>if</span> <span class='adapter identifier id'>adapter</span><span class='dot token'>.</span><span class='sphinx_identifier identifier id'>sphinx_identifier</span> <span class='eq op'>==</span> <span class='string val'>&quot;mysql&quot;</span>
  <span class='sql identifier id'>sql</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_sql_query_info</h3>
</div><div id="to_sql_query_info-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_sql_query_info</span><span class='args'>(offset)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Simple helper method for the query info SQL - which is a statement that
returns the single row for a corresponding id.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 55</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L55">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">55
56
57
58</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_sql_query_info identifier id'>to_sql_query_info</span><span class='lparen token'>(</span><span class='offset identifier id'>offset</span><span class='rparen token'>)</span>
  <span class='dstring node'>&quot;SELECT * FROM #{@model.quoted_table_name} WHERE &quot;</span> <span class='plus op'>+</span>
  <span class='dstring node'>&quot;#{quote_column(@model.primary_key)} = (($id - #{offset}) / #{ThinkingSphinx.indexed_models.size})&quot;</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_sql_query_range</h3>
</div><div id="to_sql_query_range-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>to_sql_query_range</span><span class='args'>(options = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Simple helper method for the query range SQL - which is a statement that
returns minimum and maximum id values. These can be filtered by delta - so
pass in :delta =&gt; true to get the delta version of the SQL.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/thinking_sphinx/source/sql.rb', line 33</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/freelancing-god/thinking-sphinx/blob/47fcfa9167baece01341d1195c85169169b5793b/lib/thinking_sphinx/source/sql.rb#L33">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='to_sql_query_range identifier id'>to_sql_query_range</span><span class='lparen token'>(</span><span class='options identifier id'>options</span><span class='assign token'>=</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='nil nil kw'>nil</span> <span class='if if_mod kw'>if</span> <span class='@index ivar id'>@index</span><span class='dot token'>.</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:disable_range</span><span class='rbrack token'>]</span>
  
  <span class='min_statement identifier id'>min_statement</span> <span class='assign token'>=</span> <span class='adapter identifier id'>adapter</span><span class='dot token'>.</span><span class='convert_nulls identifier id'>convert_nulls</span><span class='lparen token'>(</span>
    <span class='dstring node'>&quot;MIN(#{quote_column(@model.primary_key)})&quot;</span><span class='comma token'>,</span> <span class='integer val'>1</span>
  <span class='rparen token'>)</span>
  <span class='max_statement identifier id'>max_statement</span> <span class='assign token'>=</span> <span class='adapter identifier id'>adapter</span><span class='dot token'>.</span><span class='convert_nulls identifier id'>convert_nulls</span><span class='lparen token'>(</span>
    <span class='dstring node'>&quot;MAX(#{quote_column(@model.primary_key)})&quot;</span><span class='comma token'>,</span> <span class='integer val'>1</span>
  <span class='rparen token'>)</span>

  <span class='sql identifier id'>sql</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;SELECT #{min_statement}, #{max_statement} &quot;</span> <span class='plus op'>+</span>
        <span class='dstring node'>&quot;FROM #{@model.quoted_table_name} &quot;</span>
  <span class='if if kw'>if</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='delta? fid id'>delta?</span> <span class='andop op'>&amp;&amp;</span> <span class='notop op'>!</span><span class='@index ivar id'>@index</span><span class='dot token'>.</span><span class='delta_object identifier id'>delta_object</span><span class='dot token'>.</span><span class='clause identifier id'>clause</span><span class='lparen token'>(</span><span class='@model ivar id'>@model</span><span class='comma token'>,</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:delta</span><span class='rbrack token'>]</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='blank? fid id'>blank?</span>
    <span class='sql identifier id'>sql</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;WHERE #{@index.delta_object.clause(@model, options[:delta])}&quot;</span>
  <span class='end end kw'>end</span>

  <span class='sql identifier id'>sql</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>