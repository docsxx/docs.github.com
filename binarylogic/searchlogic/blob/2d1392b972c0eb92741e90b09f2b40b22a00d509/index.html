<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>binarylogic's searchlogic - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/binarylogic/commits/searchlogic/master" rel="alternate" title="Recent Commits to searchlogic:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("binarylogic", "searchlogic", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='binarylogic/searchlogic/blob/2d1392b972c0eb92741e90b09f2b40b22a00d509' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='binarylogic/searchlogic/blob/2d1392b972c0eb92741e90b09f2b40b22a00d509' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("binarylogic", "searchlogic", "2d1392b972c0eb92741e90b09f2b40b22a00d509", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/binarylogic/searchlogic/tree/">Source</a></li>
            <li class=""><a href="http://github.com/binarylogic/searchlogic/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/binarylogic/searchlogic/network">Network</a></li>            
            <li class=""><a href="http://github.com/binarylogic/searchlogic/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/binarylogic/searchlogic">Wiki</a></li>
            <li class=""><a href="http://github.com/binarylogic/searchlogic/graphs">Graphs</a></li>                    
            <li class="active"><a href="/binarylogic/searchlogic">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/binarylogic">binarylogic</a> / <b><a href="http://github.com/binarylogic/searchlogic/tree">searchlogic</a></b>        
                <a id="namespaces_button" rel="binarylogic/searchlogic/blob/2d1392b972c0eb92741e90b09f2b40b22a00d509" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="binarylogic/searchlogic/blob/2d1392b972c0eb92741e90b09f2b40b22a00d509" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>Searchlogic</h1>
<p>
Searchlogic&#8217;s goal is to keep your application free of searching
clutter. It&#8217;s is an ActiveRecord extension that allows you to perform
simple and complex searches with a hash. Why is this great? Because GET and
POST parameters are a hash. This means if you can execute a search with a
hash, you can execute a search using GET or POST parameters. This makes
searching in your application dead simple and clutter free:
</p>
<pre class="code">
  <span class='@search ivar id'>@search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:search</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='@users ivar id'>@users</span> <span class='assign token'>=</span> <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='all identifier id'>all</span>
</pre>
<p>
Now think about it this way. How are resources / web services used? Through
GET and POST. All of a sudden you have a resource that comes preloaded with
a <b>very</b> flexible searching functionality, all with 2 lines of code.
</p>
<p>
What about your interface? What is an HTML form&#8217;s sole purpose?
It&#8217;s to send GET or POST parameters to a URI. Now you can build a
form that represents a search. Meaning adding a condition to your search is
as easy as adding a field to your form. That&#8217;s what the @search
object above is all about. You can pass that right into your form builder
and build a form just like you would for an ActiveRecord object. Now you
can use that handy form builder that you like you use and get rid of even
more searching clutter in your views.
</p>
<p>
Searching in your application has never been cleaner, more flexible, or
easier.
</p>
<p>
These are just the basics of Searchlogic, it can do a lot more, including
pagination, ordering data, etc. All of these things are just as simple, if
not simpler. Keep reading to find out everything it can do.
</p>
<h2>Helpful links</h2>
<ul>
<li><b>Documentation:</b> http://searchlogic.rubyforge.org

</li>
<li><b>Easy pagination, ordering, and searching tutorial:</b>
http://www.binarylogic.com/2008/9/7/tutorial-pagination-ordering-and-searching-with-searchlogic

</li>
<li><b>Live example of the tutorial above (with source):</b>
http://searchlogic_example.binarylogic.com

</li>
<li><b>Complex searching:</b>
http://www.binarylogic.com/2008/11/30/searchlogic-1-5-7-complex-searching-no-longer-a-problem

</li>
<li><b>Bugs / feature suggestions:</b>
http://binarylogic.lighthouseapp.com/projects/16601-searchlogic

</li>
</ul>
<h2>Install and use</h2>
<pre class="code">
  <span class='sudo identifier id'>sudo</span> <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='searchlogic identifier id'>searchlogic</span>
</pre>
<p>
For rails, as a gem (recommended)
</p>
<pre class="code">
  <span class='comment val'># config/environment.rb</span>
  <span class='config identifier id'>config</span><span class='dot token'>.</span><span class='gem identifier id'>gem</span> <span class='string val'>&quot;searchlogic&quot;</span>
</pre>
<p>
Or as a plugin (for older versions of rails)
</p>
<pre class="code">
  <span class='script identifier id'>script</span><span class='div op'>/</span><span class='plugin identifier id'>plugin</span> <span class='install identifier id'>install</span> <span class='git identifier id'>git</span><span class='symbol val'>:/</span><span class='regexp val'>/github.com/</span><span class='binarylogic identifier id'>binarylogic</span><span class='div op'>/</span><span class='searchlogic identifier id'>searchlogic</span><span class='dot token'>.</span><span class='git identifier id'>git</span>
</pre>
<p>
Now try out some of the examples below:
</p>
<p>
<b>For all examples, let&#8217;s assume the following relationships: User
=&gt; Orders =&gt; Line Items</b>
</p>
<h2>Simple Searching Example</h2>
<pre class="code">
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='all identifier id'>all</span><span class='lparen token'>(</span>
    <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span>
      <span class='symbol val'>:first_name_contains</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Ben&quot;</span><span class='comma token'>,</span>          <span class='comment val'># first_name like '%Ben%'</span>
      <span class='symbol val'>:email_ends_with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;binarylogic.com&quot;</span><span class='comma token'>,</span>  <span class='comment val'># email like '%binarylogic.com'</span>
      <span class='symbol val'>:created_after</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='comma token'>,</span>             <span class='comment val'># created_at &gt; Time.now</span>
      <span class='symbol val'>:hour_of_created_at</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>5</span>                <span class='comment val'># HOUR(created_at) &gt; 5 (depends on DB type)</span>
    <span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>20</span><span class='comma token'>,</span>                        <span class='comment val'># limit 20</span>
    <span class='symbol val'>:page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>3</span><span class='comma token'>,</span>                             <span class='comment val'># offset 40, which starts us on page 3</span>
    <span class='symbol val'>:order_as</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;ASC&quot;</span><span class='comma token'>,</span>
    <span class='symbol val'>:order_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:user_group</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:name</span><span class='rbrace token'>}</span>     <span class='comment val'># order user_groups.name ASC</span>
  <span class='rparen token'>)</span>
</pre>
<p>
same as above, but object based
</p>
<pre class="code">
  <span class='search identifier id'>search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='first_name_contains identifier id'>first_name_contains</span> <span class='assign token'>=</span> <span class='string val'>&quot;Ben&quot;</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='email_ends_with identifier id'>email_ends_with</span> <span class='assign token'>=</span> <span class='string val'>&quot;binarylogic.com&quot;</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='created_after identifier id'>created_after</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditiona identifier id'>conditiona</span><span class='dot token'>.</span><span class='hour_of_created_at identifier id'>hour_of_created_at</span> <span class='assign token'>=</span> <span class='integer val'>5</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='per_page identifier id'>per_page</span> <span class='assign token'>=</span> <span class='integer val'>20</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='page identifier id'>page</span> <span class='assign token'>=</span> <span class='integer val'>3</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='order_as identifier id'>order_as</span> <span class='assign token'>=</span> <span class='string val'>&quot;ASC&quot;</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='order_by identifier id'>order_by</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:user_group</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:name</span><span class='rbrace token'>}</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='all identifier id'>all</span>
</pre>
<p>
In both examples, instead of using the &quot;all&quot; method you could use
any search method: first, find(:all), find(:first), count, sum, average,
etc, just like ActiveRecord.
</p>
<h2>The beauty of Searchlogic, integration into rails</h2>
<p>
Using Searchlogic in rails is the best part, because rails has all kinds of
nifty methods to make dealing with ActiveRecord objects quick and easy,
especially with forms. So let&#8217;s take advantage of them! That&#8217;s
the idea behind this plugin. Searchlogic is searching, ordering, and
pagination all rolled into one simple plugin. Take all of that pagination
and searching cruft out of your models and controllers, and let Searchlogic
handle it. Check it out:
</p>
<pre class="code">
  <span class='comment val'># app/controllers/users_controller.rb</span>
  <span class='def def kw'>def</span> <span class='index identifier id'>index</span>
    <span class='@search ivar id'>@search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:search</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
    <span class='@users ivar id'>@users</span><span class='comma token'>,</span> <span class='@users_count ivar id'>@users_count</span> <span class='assign token'>=</span> <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='all identifier id'>all</span><span class='comma token'>,</span> <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='count identifier id'>count</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Now your view:
</p>
<pre class="code">
  <span class='comment val'># app/views/users/index.html.haml</span>
  <span class='minus op'>-</span> <span class='form_for identifier id'>form_for</span> <span class='@search ivar id'>@search</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span>
    <span class='minus op'>-</span> <span class='f identifier id'>f</span><span class='dot token'>.</span><span class='fields_for identifier id'>fields_for</span> <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='users identifier id'>users</span><span class='bitor op'>|</span>
      <span class='assign token'>=</span> <span class='users identifier id'>users</span><span class='dot token'>.</span><span class='text_field identifier id'>text_field</span> <span class='symbol val'>:first_name_contains</span>
      <span class='assign token'>=</span> <span class='users identifier id'>users</span><span class='dot token'>.</span><span class='date_select identifier id'>date_select</span> <span class='symbol val'>:created_after</span>
      <span class='minus op'>-</span> <span class='users identifier id'>users</span><span class='dot token'>.</span><span class='fields_for identifier id'>fields_for</span> <span class='users identifier id'>users</span><span class='dot token'>.</span><span class='object identifier id'>object</span><span class='dot token'>.</span><span class='orders identifier id'>orders</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='orders identifier id'>orders</span><span class='bitor op'>|</span>
        <span class='assign token'>=</span> <span class='orders identifier id'>orders</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='symbol val'>:total_gt</span><span class='comma token'>,</span> <span class='lparen token'>(</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>100</span><span class='rparen token'>)</span>
    <span class='assign token'>=</span> <span class='f identifier id'>f</span><span class='dot token'>.</span><span class='submit identifier id'>submit</span> <span class='string val'>&quot;Search&quot;</span>

  <span class='minus op'>-</span> <span class='unless unless kw'>unless</span> <span class='@users_count ivar id'>@users_count</span><span class='dot token'>.</span><span class='zero? fid id'>zero?</span>
    <span class='table identifier id'>table</span>
      <span class='tr identifier id'>tr</span>
        <span class='th identifier id'>th</span><span class='assign token'>=</span> <span class='order_by_link identifier id'>order_by_link</span> <span class='symbol val'>:account</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:name</span>
        <span class='th identifier id'>th</span><span class='assign token'>=</span> <span class='order_by_link identifier id'>order_by_link</span> <span class='symbol val'>:first_name</span>
        <span class='th identifier id'>th</span><span class='assign token'>=</span> <span class='order_by_link identifier id'>order_by_link</span> <span class='symbol val'>:last_name</span>
        <span class='th identifier id'>th</span><span class='assign token'>=</span> <span class='order_by_link identifier id'>order_by_link</span> <span class='symbol val'>:email</span>
      <span class='minus op'>-</span> <span class='@users ivar id'>@users</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='user identifier id'>user</span><span class='bitor op'>|</span>
        <span class='tr identifier id'>tr</span>
          <span class='td identifier id'>td</span><span class='assign token'>=</span> <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='account? fid id'>account?</span> <span class='integer val'>? </span><span class='user identifier id'>user</span><span class='dot token'>.</span><span class='account identifier id'>account</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='colon op'>:</span> <span class='string val'>&quot;-&quot;</span>
          <span class='td identifier id'>td</span><span class='assign token'>=</span> <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='first_name identifier id'>first_name</span>
          <span class='td identifier id'>td</span><span class='assign token'>=</span> <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='last_name identifier id'>last_name</span>
          <span class='td identifier id'>td</span><span class='assign token'>=</span> <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='email identifier id'>email</span>

    <span class='eq op'>==</span> <span class='Per constant id'>Per</span> <span class='page identifier id'>page</span><span class='colon op'>:</span> <span class='comment val'>#{per_page_select}</span>
    <span class='eq op'>==</span> <span class='Page constant id'>Page</span><span class='colon op'>:</span> <span class='comment val'>#{page_select}</span>
  <span class='minus op'>-</span> <span class='else else kw'>else</span>
    <span class='No constant id'>No</span> <span class='users identifier id'>users</span> <span class='were identifier id'>were</span> <span class='found identifier id'>found</span><span class='dot token'>.</span>
</pre>
<p>
Things to note in this view:
</p>
<ol>
<li>Passing a search object right into form_for and fields_for

</li>
<li>The built in conditions for each column and how you can traverse the
relationships and set conditions on them

</li>
<li>The order_by_link helper

</li>
<li>The page_select and per_page_select helpers

</li>
<li>All of your search logic is in 1 spot: your view. Nice and DRY.

</li>
</ol>
<p>
<b>See my tutorial on this example:
http://www.binarylogic.com/2008/9/7/tutorial-pagination-ordering-and-searching-with-searchlogic</b>
</p>
<h2>Exhaustive Example w/ Object Based Searching (great for form_for or fields_for)</h2>
<pre class="code">
  <span class='comment val'># Start a new search</span>
  <span class='@search ivar id'>@search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span>
    <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span>
      <span class='symbol val'>:first_name_contains</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Ben&quot;</span><span class='comma token'>,</span>
      <span class='symbol val'>:age_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>18</span><span class='comma token'>,</span>
      <span class='symbol val'>:orders</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:total_lt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>100</span><span class='rbrace token'>}</span>
    <span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>20</span><span class='comma token'>,</span>
    <span class='symbol val'>:page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>2</span><span class='comma token'>,</span>
    <span class='symbol val'>:order_by</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:orders</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:total</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='symbol val'>:order_as</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;DESC&quot;</span>
  <span class='rparen token'>)</span>

  <span class='comment val'># Set local conditions</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='email_ends_with identifier id'>email_ends_with</span> <span class='assign token'>=</span> <span class='string val'>&quot;binarylogic.com&quot;</span>

  <span class='comment val'># Set conditions on relationships</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='oders identifier id'>oders</span><span class='dot token'>.</span><span class='line_items identifier id'>line_items</span><span class='dot token'>.</span><span class='created_after identifier id'>created_after</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span>  <span class='comment val'># can traverse through all relationships</span>

  <span class='comment val'># Set options</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='per_page identifier id'>per_page</span> <span class='assign token'>=</span> <span class='integer val'>50</span>                     <span class='comment val'># overrides the 20 set above</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='order_by identifier id'>order_by</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='symbol val'>:first_name</span><span class='comma token'>,</span> <span class='lbrace token'>{</span><span class='symbol val'>:user_group</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:name</span><span class='rbrace token'>}</span><span class='rbrack token'>]</span>  <span class='comment val'># order by first name and then by the user group's name it belongs to</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='order_as identifier id'>order_as</span> <span class='assign token'>=</span> <span class='string val'>&quot;ASC&quot;</span>

  <span class='comment val'># Set ANY of the ActiveRecord options</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='group identifier id'>group</span> <span class='assign token'>=</span> <span class='string val'>&quot;last_name&quot;</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='readonly identifier id'>readonly</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='comment val'># ... see ActiveRecord documentation</span>

  <span class='comment val'># Return results just like ActiveRecord</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='all identifier id'>all</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
</pre>
<p>
Take the @search object and pass it right into form_for or fields_for (see
above).
</p>
<h2>Calculations</h2>
<p>
Using the object from above:
</p>
<pre class="code">
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='average identifier id'>average</span><span class='lparen token'>(</span><span class='string val'>'id'</span><span class='rparen token'>)</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='count identifier id'>count</span> <span class='comment val'># ignores limit and offset</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='maximum identifier id'>maximum</span><span class='lparen token'>(</span><span class='string val'>'id'</span><span class='rparen token'>)</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='minimum identifier id'>minimum</span><span class='lparen token'>(</span><span class='string val'>'id'</span><span class='rparen token'>)</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='sum identifier id'>sum</span><span class='lparen token'>(</span><span class='string val'>'id'</span><span class='rparen token'>)</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='calculate identifier id'>calculate</span><span class='lparen token'>(</span><span class='symbol val'>:sum</span><span class='comma token'>,</span> <span class='string val'>'id'</span><span class='rparen token'>)</span>
  <span class='comment val'># ...any of the above calculations, see ActiveRecord documentation on calculations</span>
</pre>
<p>
Or do it from your model:
</p>
<pre class="code">
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='count identifier id'>count</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:first_name_contains</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Ben&quot;</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='sum identifier id'>sum</span><span class='lparen token'>(</span><span class='string val'>'id'</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:first_name_contains</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Ben&quot;</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='comment val'># ... all other calcualtions, etc.</span>
</pre>
<h2>Different ways to search, take your pick</h2>
<p>
Any of the options used in the above example can be used in these, but for
the sake of brevity I am only using a few:
</p>
<pre class="code">
  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='all identifier id'>all</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:age_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>18</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>20</span><span class='rparen token'>)</span>

  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:age_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>18</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>20</span><span class='rparen token'>)</span>

  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:age_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>18</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>20</span><span class='rparen token'>)</span>

  <span class='User constant id'>User</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:first</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:age_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>18</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>20</span><span class='rparen token'>)</span>

  <span class='search identifier id'>search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:age_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>18</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>  <span class='comment val'># build_search is an alias</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='first_name_contains identifier id'>first_name_contains</span> <span class='assign token'>=</span> <span class='string val'>&quot;Ben&quot;</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='per_page identifier id'>per_page</span> <span class='assign token'>=</span> <span class='integer val'>20</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='all identifier id'>all</span>

  <span class='search identifier id'>search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:age_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>18</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='s identifier id'>s</span><span class='bitor op'>|</span>
    <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='first_name_contains identifier id'>first_name_contains</span> <span class='assign token'>=</span> <span class='string val'>&quot;Ben&quot;</span>
    <span class='s identifier id'>s</span><span class='dot token'>.</span><span class='per_page identifier id'>per_page</span> <span class='assign token'>=</span> <span class='integer val'>20</span>
  <span class='end end kw'>end</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='all identifier id'>all</span>
</pre>
<h2>Match ANY or ALL of the conditions</h2>
<p>
As you saw above, the nice thing about Searchlogic is it&#8217;s
integration with forms. I designed the &quot;any&quot; option so that forms
can set this as well, just like a condition.
</p>
<pre class="code">
  <span class='@search ivar id'>@search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:age_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>18</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='first_name_contains identifier id'>first_name_contains</span> <span class='assign token'>=</span> <span class='string val'>&quot;Ben&quot;</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='any identifier id'>any</span> <span class='assign token'>=</span> <span class='true true kw'>true</span> <span class='comment val'># can set this to &quot;true&quot; or &quot;1&quot; or &quot;yes&quot;</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='all identifier id'>all</span> <span class='comment val'># will join all conditions with &quot;or&quot; instead of &quot;and&quot;</span>
  <span class='comment val'># ... all operations above are available</span>
</pre>
<p>
What if you want to mix and match?
</p>
<pre class="code">
  <span class='@search ivar id'>@search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:age_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>18</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='or_first_name_contains identifier id'>or_first_name_contains</span> <span class='assign token'>=</span> <span class='string val'>&quot;Ben&quot;</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='or_last_name_contains identifier id'>or_last_name_contains</span> <span class='assign token'>=</span> <span class='string val'>&quot;Johnson&quot;</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='and_id_gt identifier id'>and_id_gt</span> <span class='assign token'>=</span> <span class='integer val'>5</span> <span class='comment val'># the and_ is optional, calling just id_gt is the same thing</span>
  <span class='@search ivar id'>@search</span><span class='dot token'>.</span><span class='all identifier id'>all</span> <span class='comment val'># will join conditions in the orders they were set with their specified join condition</span>
  <span class='comment val'># =&gt; age &gt; 18 OR first_name like '%Ben%' OR lsat_name like '%Johnson%' AND id &gt; 5</span>
</pre>
<p>
The order the conditions is set is relevant, as the SQL will be built in
the same order.
</p>
<h2>Grouping conditions</h2>
<p>
In more complex searching situations you might want to group conditions.
Just like you use parenthesis in raw SQL. Searchlogic&#8217;s
&quot;group&quot; function is basically a way to implement parenthesis in
your conditions. It&#8217;s simple:
</p>
<p>
Group off an object:
</p>
<pre class="code">
  <span class='search identifier id'>search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='id_gt identifier id'>id_gt</span> <span class='assign token'>=</span> <span class='integer val'>2</span>
  <span class='group1 identifier id'>group1</span> <span class='assign token'>=</span> <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='group identifier id'>group</span>
  <span class='group1 identifier id'>group1</span><span class='dot token'>.</span><span class='first_name_like identifier id'>first_name_like</span> <span class='assign token'>=</span> <span class='string val'>&quot;Ben&quot;</span>
  <span class='group2 identifier id'>group2</span> <span class='assign token'>=</span> <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='group identifier id'>group</span>
  <span class='group2 identifier id'>group2</span><span class='dot token'>.</span><span class='last_name_like identifier id'>last_name_like</span> <span class='assign token'>=</span> <span class='string val'>&quot;Johnson&quot;</span>
  <span class='group21 identifier id'>group21</span> <span class='assign token'>=</span> <span class='group2 identifier id'>group2</span><span class='dot token'>.</span><span class='group identifier id'>group</span>
  <span class='group21 identifier id'>group21</span><span class='dot token'>.</span><span class='email_ends_with identifier id'>email_ends_with</span> <span class='assign token'>=</span> <span class='string val'>&quot;binarylogic.com&quot;</span>
  <span class='comment val'># =&gt; id &gt; 2 AND (first_name like '%Ben%') AND (last_name like '%Johnson%' AND (email like '%binarylogic.com'))</span>
</pre>
<p>
Group with a block:
</p>
<pre class="code">
  <span class='search identifier id'>search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='id_gt identifier id'>id_gt</span> <span class='assign token'>=</span> <span class='integer val'>2</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='group identifier id'>group</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='group identifier id'>group</span><span class='bitor op'>|</span>
    <span class='group identifier id'>group</span><span class='dot token'>.</span><span class='first_name_like identifier id'>first_name_like</span> <span class='assign token'>=</span> <span class='string val'>&quot;Ben&quot;</span>
  <span class='end end kw'>end</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='or_group identifier id'>or_group</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='group identifier id'>group</span><span class='bitor op'>|</span>
    <span class='group identifier id'>group</span><span class='dot token'>.</span><span class='last_name_like identifier id'>last_name_like</span> <span class='assign token'>=</span> <span class='string val'>&quot;Johnson&quot;</span>
    <span class='group identifier id'>group</span><span class='dot token'>.</span><span class='group identifier id'>group</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='sub_group identifier id'>sub_group</span><span class='bitor op'>|</span>
      <span class='sub_group identifier id'>sub_group</span><span class='dot token'>.</span><span class='email_ends_with identifier id'>email_ends_with</span> <span class='assign token'>=</span> <span class='string val'>&quot;binarylogic.com&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='comment val'># =&gt; id &gt; 2 AND (first_name like '%Ben%') OR (last_name like '%Johnson%' AND (email like '%binarylogic.com'))</span>
</pre>
<p>
Group with a hash:
</p>
<pre class="code">
  <span class='search identifier id'>search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span>
    <span class='lbrace token'>{</span><span class='symbol val'>:id_gt</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>2</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='lbrace token'>{</span><span class='symbol val'>:group</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:first_name_like</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Ben&quot;</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
    <span class='lbrace token'>{</span><span class='symbol val'>:group</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span>
      <span class='lbrace token'>{</span><span class='symbol val'>:last_name_like</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Johnson&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span>
      <span class='lbrace token'>{</span><span class='symbol val'>:group</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:email_ends_with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;binarylogic.com&quot;</span><span class='rbrace token'>}</span><span class='rbrace token'>}</span>
    <span class='rbrack token'>]</span><span class='rbrace token'>}</span>
  <span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='comment val'># =&gt; id &gt; 2 AND (first_name like '%Ben%') AND (last_name like '%Johnson%' AND (email like '%binarylogic.com'))</span>
</pre>
<p>
I want to end this by saying Searchlogic was never meant to replace SQL,
name_scopes, etc. If you need to perform complex searching there is nothing
wrong with resorting to a named scope or using the traditional search
methods. In fact, search logic plays nice with named_scopes anyways, so you
can combine the 2 if needed:
</p>
<pre class="code">
  <span class='@search ivar id'>@search</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='my_awesome_scope identifier id'>my_awesome_scope</span><span class='dot token'>.</span><span class='another_cool_scope identifier id'>another_cool_scope</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span>
</pre>
<p>
You decide when a named scope makes the most sense. If you are creating a
named scope that is specific to the search form you are building, you
should consider adding the conditions right into the form. But if you are
creating a named scope that you are using throughout your application, then
it probably makes sense for it to be a named scope.
</p>
<h2>Scoped searching</h2>
<pre class="code">
  <span class='@current_user ivar id'>@current_user</span><span class='dot token'>.</span><span class='orders identifier id'>orders</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='symbol val'>:all</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:total_lte</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>500</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@current_user ivar id'>@current_user</span><span class='dot token'>.</span><span class='orders identifier id'>orders</span><span class='dot token'>.</span><span class='count identifier id'>count</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:total_lte</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>500</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@current_user ivar id'>@current_user</span><span class='dot token'>.</span><span class='orders identifier id'>orders</span><span class='dot token'>.</span><span class='sum identifier id'>sum</span><span class='lparen token'>(</span><span class='string val'>'total'</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:total_lte</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>500</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='@current_user ivar id'>@current_user</span><span class='dot token'>.</span><span class='orders identifier id'>orders</span><span class='dot token'>.</span><span class='build_search identifier id'>build_search</span><span class='lparen token'>(</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:total_lte</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>500</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>
<h2>Scope support</h2>
<p>
Not only can you use searchlogic when searching, but you can use it when
using scopes.
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='User constant id'>User</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='named_scope identifier id'>named_scope</span> <span class='symbol val'>:sexy</span><span class='comma token'>,</span> <span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:first_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Ben&quot;</span><span class='comma token'>,</span> <span class='email_ends_with identifier id'>email_ends_with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;binarylogic.com&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>20</span>
  <span class='end end kw'>end</span>
</pre>
<p>
or
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='User constant id'>User</span> <span class='lt op'>&lt;</span> <span class='ActiveRecord constant id'>ActiveRecord</span><span class='colon2 op'>::</span><span class='Base constant id'>Base</span>
    <span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='find_sexy identifier id'>find_sexy</span>
      <span class='with_scope identifier id'>with_scope</span><span class='lparen token'>(</span><span class='symbol val'>:find</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:conditions</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrace token'>{</span><span class='symbol val'>:first_name</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;Ben&quot;</span><span class='comma token'>,</span> <span class='email_ends_with identifier id'>email_ends_with</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>&quot;binarylogic.com&quot;</span><span class='rbrace token'>}</span><span class='comma token'>,</span> <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>20</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
        <span class='all identifier id'>all</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<h2>Protection against SQL injections</h2>
<p>
SQL injections are not fun, so let&#8217;s make sure they don&#8217;t
happen. That&#8217;s why searchlogic protects you by default. The
new_search methods protect mass assignments by default (instantiation and
search.options = {}). This means that various checks are done to ensure it
is not possible to perform any type of SQL injection during mass
assignments. But this also limits how you can search, meaning you
can&#8217;t write raw SQL. If you want to be daring and search without
protection, all that you have to do is add ! to the end of the method:
new_search!.
</p>
<h3>Protected from SQL injections</h3>
<pre class="code">
  <span class='search identifier id'>search</span> <span class='assign token'>=</span> <span class='Account constant id'>Account</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:search</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
</pre>
<h3><b>NOT</b> protected from SQL injections</h3>
<pre class="code">
  <span class='accounts identifier id'>accounts</span> <span class='assign token'>=</span> <span class='Account constant id'>Account</span><span class='dot token'>.</span><span class='find identifier id'>find</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:search</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='accounts identifier id'>accounts</span> <span class='assign token'>=</span> <span class='Account constant id'>Account</span><span class='dot token'>.</span><span class='all identifier id'>all</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:search</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='account identifier id'>account</span> <span class='assign token'>=</span> <span class='Account constant id'>Account</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:search</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='search identifier id'>search</span> <span class='assign token'>=</span> <span class='Account constant id'>Account</span><span class='dot token'>.</span><span class='new_search! fid id'>new_search!</span><span class='lparen token'>(</span><span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:search</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
</pre>
<p>
I&#8217;m sure you already knew this, but it&#8217;s tempting to do this
when you can pass the params hash right into these methods.
</p>
<p>
Lesson learned: use new_search when passing in params as <b>ANY</b> of the
options.
</p>
<h2>Available Conditions</h2>
<p>
The conditions are pretty self explanitory, but if you need more
information checkout the docs or the source. The code is very simple and
self explanatory.
</p>
<h3>Column conditions</h3>
<p>
Each column can be used with any of the following conditions
</p>
<pre class="code">
  <span class='Name constant id'>Name</span>                          <span class='Aliases constant id'>Aliases</span>                             <span class='Description constant id'>Description</span>
  <span class='symbol val'>:begins_with</span>                  <span class='symbol val'>:starts_with</span><span class='comma token'>,</span> <span class='symbol val'>:sw</span><span class='comma token'>,</span> <span class='symbol val'>:bw</span><span class='comma token'>,</span> <span class='symbol val'>:start</span>      <span class='col identifier id'>col</span> <span class='LIKE constant id'>LIKE</span> <span class='string val'>'value%'</span>
  <span class='symbol val'>:ends_with</span>                    <span class='symbol val'>:ew</span><span class='comma token'>,</span> <span class='symbol val'>:ends</span><span class='comma token'>,</span> <span class='symbol val'>:end</span>                    <span class='col identifier id'>col</span> <span class='LIKE constant id'>LIKE</span> <span class='string val'>'%value'</span>
  <span class='symbol val'>:equals</span>                       <span class='symbol val'>:is</span><span class='comma token'>,</span> <span class='string val'>&quot;&quot;</span>                             <span class='Lets constant id'>Lets</span> <span class='ActiveRecord constant id'>ActiveRecord</span> <span class='handle identifier id'>handle</span> <span class='this identifier id'>this</span>
  <span class='symbol val'>:greater_than</span>                 <span class='symbol val'>:gt</span><span class='comma token'>,</span> <span class='symbol val'>:after</span>                         <span class='col identifier id'>col</span> <span class='gt op'>&gt;</span> <span class='value identifier id'>value</span>
  <span class='symbol val'>:greater_than_or_equal_to</span>     <span class='symbol val'>:at_least</span><span class='comma token'>,</span> <span class='symbol val'>:least</span><span class='comma token'>,</span> <span class='symbol val'>:gte</span>             <span class='col identifier id'>col</span> <span class='geq op'>&gt;=</span> <span class='value identifier id'>value</span>
  <span class='symbol val'>:ilike</span>                        <span class='symbol val'>:icontains</span><span class='comma token'>,</span> <span class='symbol val'>:ihas</span>                   <span class='PostgreSQL constant id'>PostgreSQL</span> <span class='specific identifier id'>specific</span><span class='comma token'>,</span> <span class='makes identifier id'>makes</span> <span class='LIKE constant id'>LIKE</span> <span class='case case kw'>case</span> <span class='insensitive identifier id'>insensitive</span>
  <span class='symbol val'>:less_than</span>                    <span class='symbol val'>:lt</span><span class='comma token'>,</span> <span class='symbol val'>:before</span>                        <span class='col identifier id'>col</span> <span class='lt op'>&lt;</span> <span class='value identifier id'>value</span>
  <span class='symbol val'>:less_than_or_equal_to</span>        <span class='symbol val'>:at_most</span><span class='comma token'>,</span> <span class='symbol val'>:most</span><span class='comma token'>,</span> <span class='symbol val'>:lte</span>               <span class='col identifier id'>col</span> <span class='leq op'>&lt;=</span> <span class='value identifier id'>value</span>
  <span class='symbol val'>:keywords</span>                     <span class='symbol val'>:kwords</span><span class='comma token'>,</span> <span class='symbol val'>:kw</span>                        <span class='Splits constant id'>Splits</span> <span class='into identifier id'>into</span> <span class='each identifier id'>each</span> <span class='word identifier id'>word</span> <span class='and and kw'>and</span> <span class='omits identifier id'>omits</span> <span class='meaningless identifier id'>meaningless</span> <span class='words identifier id'>words</span><span class='comma token'>,</span> <span class='a identifier id'>a</span> <span class='true true kw'>true</span> <span class='keyword identifier id'>keyword</span> <span class='search identifier id'>search</span>
  <span class='symbol val'>:like</span>                         <span class='symbol val'>:contains</span><span class='comma token'>,</span> <span class='symbol val'>:has</span>                     <span class='col identifier id'>col</span> <span class='LIKE constant id'>LIKE</span> <span class='string val'>'%value%'</span>

  <span class='symbol val'>:not_begin_with</span>               <span class='symbol val'>:not_bw</span><span class='comma token'>,</span> <span class='symbol val'>:not_sw</span><span class='comma token'>,</span> <span class='symbol val'>:not_start_with</span><span class='comma token'>,</span> <span class='symbol val'>:not_start</span><span class='comma token'>,</span> <span class='symbol val'>:beginning_is_not</span><span class='comma token'>,</span> <span class='symbol val'>:beginning_not</span>
  <span class='symbol val'>:not_end_with</span>                 <span class='symbol val'>:not_ew</span><span class='comma token'>,</span> <span class='symbol val'>:not_end</span><span class='comma token'>,</span> <span class='symbol val'>:end_is_not</span><span class='comma token'>,</span> <span class='symbol val'>:end_not</span>
  <span class='symbol val'>:not_equal</span>                    <span class='symbol val'>:does_not_equal</span><span class='comma token'>,</span> <span class='symbol val'>:is_not</span><span class='comma token'>,</span> <span class='symbol val'>:not</span>
  <span class='symbol val'>:not_have_keywords</span>            <span class='symbol val'>:not_have_keywords</span><span class='comma token'>,</span> <span class='symbol val'>:not_keywords</span><span class='comma token'>,</span> <span class='symbol val'>:not_have_kw</span><span class='comma token'>,</span> <span class='symbol val'>:not_kw</span><span class='comma token'>,</span> <span class='symbol val'>:not_have_kwwords</span><span class='comma token'>,</span> <span class='symbol val'>:not_kwwords</span>
  <span class='symbol val'>:not_ilike</span>                    <span class='symbol val'>:not_icontain</span><span class='comma token'>,</span> <span class='symbol val'>:not_ihave</span>
  <span class='symbol val'>:not_like</span>                     <span class='symbol val'>:not_contain</span><span class='comma token'>,</span> <span class='symbol val'>:not_have</span>
</pre>
<h3>Class level conditions</h3>
<p>
Each model comes preloaded with class level conditions as well. The
difference is that these are not applied to each column, but instead to the
model as a whole. Example: search.conditions.child_of = 2
</p>
<pre class="code">
  <span class='Name constant id'>Name</span>                          <span class='Description constant id'>Description</span>
  <span class='symbol val'>:child_of</span>                     <span class='Returns constant id'>Returns</span> <span class='all identifier id'>all</span> <span class='children identifier id'>children</span> <span class='of identifier id'>of</span> <span class='value identifier id'>value</span>
  <span class='symbol val'>:descendant_of</span>                <span class='Returns constant id'>Returns</span> <span class='all identifier id'>all</span> <span class='descendants identifier id'>descendants</span> <span class='lparen token'>(</span><span class='children identifier id'>children</span><span class='comma token'>,</span> <span class='grandchildren identifier id'>grandchildren</span><span class='comma token'>,</span> <span class='grandgrandchildren identifier id'>grandgrandchildren</span><span class='comma token'>,</span> <span class='etc identifier id'>etc</span><span class='rparen token'>)</span>
  <span class='symbol val'>:inclusive_descendant_of</span>      <span class='Same constant id'>Same</span> <span class='as identifier id'>as</span> <span class='above identifier id'>above</span> <span class='but identifier id'>but</span> <span class='also identifier id'>also</span> <span class='includes identifier id'>includes</span> <span class='the identifier id'>the</span> <span class='root identifier id'>root</span>
  <span class='symbol val'>:sibling_of</span>                   <span class='Returns constant id'>Returns</span> <span class='all identifier id'>all</span> <span class='records identifier id'>records</span> <span class='that identifier id'>that</span> <span class='have identifier id'>have</span> <span class='the identifier id'>the</span> <span class='same identifier id'>same</span> <span class='parent identifier id'>parent</span>
</pre>
<p>
The above conditions are for a nested set data structure, <b>not</b> a
tree. Since we need to traverse through the tree a nested set is required
for performance reasons. Traversing through a large tree is very bad for
performance, a nested set solves this problem.
</p>
<h2>Modifiers</h2>
<h3>What are modifiers?</h3>
<p>
ActiveRecord does a great job when it comes to keeping your code database
agnostic. But I feel like it neglected searching when it came to that goal.
What if you want to find all records that were created after 7am? Depending
on your database you would have to do something like the following:
</p>
<pre class="code">
  <span class='MySQL constant id'>MySQL</span><span class='colon op'>:</span>        <span class='HOUR constant id'>HOUR</span><span class='lparen token'>(</span><span class='created_at identifier id'>created_at</span><span class='rparen token'>)</span>
  <span class='PostgreSQL constant id'>PostgreSQL</span><span class='colon op'>:</span>   <span class='date_part identifier id'>date_part</span><span class='lparen token'>(</span><span class='string val'>'hour'</span><span class='comma token'>,</span> <span class='created_at identifier id'>created_at</span><span class='rparen token'>)</span>
  <span class='SQLite constant id'>SQLite</span><span class='colon op'>:</span>       <span class='strftime identifier id'>strftime</span><span class='lparen token'>(</span><span class='string val'>'%H'</span><span class='comma token'>,</span> <span class='created_at identifier id'>created_at</span><span class='rparen token'>)</span>
</pre>
<p>
All of a sudden your app is not database agnostic. Searchlogic to the
rescue! Searchlogic creates what I like to call &quot;modifiers&quot; to
handle this nonsense for you. A modifier modifies a column. For example,
the hour modifier modifies a datetime column to return the hour.
</p>
<p>
The last thing to keep in mind is that <b>not all modifiers are available
for every database</b>. MySQL and PostgreSQL support all of these, but
SQLite does not. SQLite is nice, in the sense that its really is
&quot;lite&quot;. The only modifiers it supports are the datetime
modifiers. If you want support for the other modifiers you have to write
the SQLite function yourself and register the modifier in searchlogic.
</p>
<p>
Here are all of the available modifiers:
</p>
<h3>Available modifiers</h3>
<pre class="code">
  <span class='Name constant id'>Name</span>              <span class='Aliases constant id'>Aliases</span>                                     <span class='Description constant id'>Description</span>
  <span class='symbol val'>:microsecond</span>      <span class='symbol val'>:microseconds</span><span class='comma token'>,</span> <span class='symbol val'>:microsecs</span><span class='comma token'>,</span> <span class='symbol val'>:microsec</span>        <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='microseconds identifier id'>microseconds</span>
  <span class='symbol val'>:millisecond</span>      <span class='symbol val'>:milliseconds</span><span class='comma token'>,</span> <span class='symbol val'>:millisecs</span><span class='comma token'>,</span> <span class='symbol val'>:millisec</span>        <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='milliseconds identifier id'>milliseconds</span>
  <span class='symbol val'>:second</span>           <span class='symbol val'>:sec</span>                                        <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='seconds identifier id'>seconds</span>
  <span class='symbol val'>:minute</span>           <span class='symbol val'>:min</span>                                        <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='minute identifier id'>minute</span>
  <span class='symbol val'>:hour</span>                                                         <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='hour identifier id'>hour</span>
  <span class='symbol val'>:day_of_week</span>      <span class='symbol val'>:dow</span>                                        <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='day identifier id'>day</span> <span class='of identifier id'>of</span> <span class='week identifier id'>week</span> <span class='lparen token'>(</span><span class='integer val'>1</span><span class='minus op'>-</span><span class='integer val'>7</span><span class='rparen token'>)</span>
  <span class='symbol val'>:day_of_month</span>     <span class='symbol val'>:dom</span>                                        <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='day identifier id'>day</span> <span class='of identifier id'>of</span> <span class='month identifier id'>month</span> <span class='lparen token'>(</span><span class='integer val'>1</span><span class='minus op'>-</span><span class='integer val'>31</span><span class='rparen token'>)</span>
  <span class='symbol val'>:day_of_year</span>      <span class='symbol val'>:doy</span>                                        <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='day identifier id'>day</span> <span class='of identifier id'>of</span> <span class='year identifier id'>year</span> <span class='lparen token'>(</span><span class='integer val'>1</span><span class='minus op'>-</span><span class='integer val'>366</span><span class='rparen token'>)</span>
  <span class='symbol val'>:week</span>                                                         <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='week identifier id'>week</span> <span class='lparen token'>(</span><span class='integer val'>1</span><span class='minus op'>-</span><span class='integer val'>53</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>53</span><span class='rd identifier id'>rd</span> <span class='week identifier id'>week</span> <span class='can identifier id'>can</span> <span class='be identifier id'>be</span> <span class='a identifier id'>a</span> <span class='string val'>&quot;run-over&quot;</span> <span class='week identifier id'>week</span> <span class='to identifier id'>to</span> <span class='the identifier id'>the</span> <span class='next next kw'>next</span> <span class='year identifier id'>year</span>
  <span class='symbol val'>:month</span>            <span class='symbol val'>:mon</span>                                        <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='month identifier id'>month</span> <span class='lparen token'>(</span><span class='integer val'>1</span><span class='minus op'>-</span><span class='integer val'>12</span><span class='rparen token'>)</span>
  <span class='symbol val'>:year</span>                                                         <span class='Extracts constant id'>Extracts</span> <span class='the identifier id'>the</span> <span class='year identifier id'>year</span>

  <span class='symbol val'>:md5</span>                                                          <span class='Converts constant id'>Converts</span> <span class='to identifier id'>to</span> <span class='a identifier id'>a</span> <span class='MD5 constant id'>MD5</span>
  <span class='symbol val'>:char_length</span>      <span class='symbol val'>:length</span>                                     <span class='The constant id'>The</span> <span class='length identifier id'>length</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='string identifier id'>string</span> <span class='lparen token'>(</span><span class='integer identifier id'>integer</span><span class='rparen token'>)</span>
  <span class='symbol val'>:lower</span>            <span class='symbol val'>:downcase</span><span class='comma token'>,</span> <span class='symbol val'>:lcase</span>                           <span class='Converts constant id'>Converts</span> <span class='the identifier id'>the</span> <span class='string identifier id'>string</span> <span class='to identifier id'>to</span> <span class='all identifier id'>all</span> <span class='lower identifier id'>lower</span> <span class='case case kw'>case</span> <span class='characters identifier id'>characters</span>
  <span class='symbol val'>:ltrin</span>            <span class='symbol val'>:lstrip</span>                                     <span class='Strips constant id'>Strips</span> <span class='off identifier id'>off</span> <span class='spaces identifier id'>spaces</span> <span class='from identifier id'>from</span> <span class='the identifier id'>the</span> <span class='beginning identifier id'>beginning</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='string identifier id'>string</span>
  <span class='symbol val'>:trim</span>             <span class='symbol val'>:strip</span>                                      <span class='Strips constant id'>Strips</span> <span class='off identifier id'>off</span> <span class='spaces identifier id'>spaces</span> <span class='from identifier id'>from</span> <span class='the identifier id'>the</span> <span class='beginning identifier id'>beginning</span> <span class='and and kw'>and</span> <span class='end end kw'>end</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='string identifier id'>string</span>
  <span class='symbol val'>:rtrim</span>            <span class='symbol val'>:rstrip</span>                                     <span class='Strips constant id'>Strips</span> <span class='off identifier id'>off</span> <span class='spaces identifier id'>spaces</span> <span class='from identifier id'>from</span> <span class='the identifier id'>the</span> <span class='end end kw'>end</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='string identifier id'>string</span>
  <span class='symbol val'>:upper</span>            <span class='symbol val'>:upcase</span><span class='comma token'>,</span> <span class='symbol val'>:ucase</span>                             <span class='Converts constant id'>Converts</span> <span class='the identifier id'>the</span> <span class='string identifier id'>string</span> <span class='to identifier id'>to</span> <span class='all identifier id'>all</span> <span class='upper identifier id'>upper</span> <span class='case case kw'>case</span> <span class='character identifier id'>character</span>

  <span class='symbol val'>:absolute</span>         <span class='symbol val'>:abs</span>                                        <span class='The constant id'>The</span> <span class='absolute identifier id'>absolute</span> <span class='value identifier id'>value</span> <span class='lparen token'>(</span><span class='integer val'>-1</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rparen token'>)</span>
  <span class='symbol val'>:acos</span>                                                         <span class='The constant id'>The</span> <span class='arc identifier id'>arc</span> <span class='cosine identifier id'>cosine</span>
  <span class='symbol val'>:asin</span>                                                         <span class='The constant id'>The</span> <span class='arc identifier id'>arc</span> <span class='sine identifier id'>sine</span>
  <span class='symbol val'>:atan</span>                                                         <span class='The constant id'>The</span> <span class='arc identifier id'>arc</span> <span class='tangent identifier id'>tangent</span>
  <span class='symbol val'>:avg</span>              <span class='symbol val'>:average</span>                                    <span class='The constant id'>The</span> <span class='average identifier id'>average</span>
  <span class='symbol val'>:ceil</span>             <span class='symbol val'>:round_up</span>                                   <span class='Rounds constant id'>Rounds</span> <span class='up identifier id'>up</span> <span class='to identifier id'>to</span> <span class='the identifier id'>the</span> <span class='nearest identifier id'>nearest</span> <span class='int identifier id'>int</span>
  <span class='symbol val'>:cos</span>              <span class='symbol val'>:cosine</span>                                     <span class='The constant id'>The</span> <span class='cosine identifier id'>cosine</span>
  <span class='symbol val'>:cot</span>              <span class='symbol val'>:cotangent</span>                                  <span class='The constant id'>The</span> <span class='cotangent identifier id'>cotangent</span>
  <span class='symbol val'>:count</span>                                                        <span class='The constant id'>The</span> <span class='count identifier id'>count</span>
  <span class='symbol val'>:degrees</span>                                                      <span class='Converts constant id'>Converts</span> <span class='radians identifier id'>radians</span> <span class='to identifier id'>to</span> <span class='degrees identifier id'>degrees</span>
  <span class='symbol val'>:exp</span>              <span class='symbol val'>:exponential</span>                                <span class='Returns constant id'>Returns</span> <span class='the identifier id'>the</span> <span class='value identifier id'>value</span> <span class='of identifier id'>of</span> <span class='e identifier id'>e</span> <span class='lparen token'>(</span><span class='the identifier id'>the</span> <span class='base identifier id'>base</span> <span class='of identifier id'>of</span> <span class='natural identifier id'>natural</span> <span class='logarithms identifier id'>logarithms</span><span class='rparen token'>)</span> <span class='raised identifier id'>raised</span> <span class='to identifier id'>to</span> <span class='the identifier id'>the</span> <span class='power identifier id'>power</span> <span class='of identifier id'>of</span> <span class='X constant id'>X</span>
  <span class='symbol val'>:floor</span>            <span class='symbol val'>:round_down</span>                                 <span class='Rounds constant id'>Rounds</span> <span class='down identifier id'>down</span> <span class='to identifier id'>to</span> <span class='the identifier id'>the</span> <span class='nearest identifier id'>nearest</span> <span class='int identifier id'>int</span>
  <span class='symbol val'>:hex</span>                                                          <span class='Converts constant id'>Converts</span> <span class='the identifier id'>the</span> <span class='number identifier id'>number</span> <span class='to identifier id'>to</span> <span class='a identifier id'>a</span> <span class='hex identifier id'>hex</span>
  <span class='symbol val'>:log</span>              <span class='symbol val'>:ln</span>                                         <span class='The constant id'>The</span> <span class='natural identifier id'>natural</span> <span class='logarithm identifier id'>logarithm</span>
  <span class='symbol val'>:log10</span>                                                        <span class='Returns constant id'>Returns</span> <span class='the identifier id'>the</span> <span class='base identifier id'>base</span><span class='minus op'>-</span><span class='integer val'>10</span> <span class='logarithm identifier id'>logarithm</span>
  <span class='symbol val'>:log2</span>                                                         <span class='Returns constant id'>Returns</span> <span class='the identifier id'>the</span> <span class='base identifier id'>base</span><span class='minus op'>-</span><span class='integer val'>2</span> <span class='logarithm identifier id'>logarithm</span>
  <span class='symbol val'>:octal</span>            <span class='symbol val'>:oct</span>                                        <span class='Return constant id'>Return</span> <span class='an identifier id'>an</span> <span class='octal identifier id'>octal</span> <span class='representation identifier id'>representation</span> <span class='of identifier id'>of</span> <span class='a identifier id'>a</span> <span class='decimal identifier id'>decimal</span> <span class='number identifier id'>number</span>
  <span class='symbol val'>:radians</span>                                                      <span class='Converts constant id'>Converts</span> <span class='to identifier id'>to</span> <span class='radians identifier id'>radians</span>
  <span class='symbol val'>:round</span>                                                        <span class='Rounds constant id'>Rounds</span> <span class='the identifier id'>the</span> <span class='number identifier id'>number</span>
  <span class='symbol val'>:sign</span>                                                         <span class='The constant id'>The</span> <span class='sign identifier id'>sign</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='number identifier id'>number</span>
  <span class='symbol val'>:sin</span>                                                          <span class='The constant id'>The</span> <span class='sine identifier id'>sine</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='number identifier id'>number</span>
  <span class='symbol val'>:square_root</span>      <span class='symbol val'>:sqrt</span><span class='comma token'>,</span> <span class='symbol val'>:sq_rt</span>                               <span class='The constant id'>The</span> <span class='square identifier id'>square</span> <span class='root identifier id'>root</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='number identifier id'>number</span>
  <span class='symbol val'>:sum</span>                                                          <span class='The constant id'>The</span> <span class='sum identifier id'>sum</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='number identifier id'>number</span>
  <span class='symbol val'>:tan</span>              <span class='symbol val'>:tangent</span>                                    <span class='The constant id'>The</span> <span class='tangent identifier id'>tangent</span> <span class='of identifier id'>of</span> <span class='the identifier id'>the</span> <span class='number identifier id'>number</span>
</pre>
<h3>How to use modifiers</h3>
<p>
Here&#8217;s what the above table means. Let&#8217;s take the created_at
column. The created_at column is a datetime column, laet&#8217;s apply
modifiers that make sense for a datetime column.
</p>
<pre class="code">
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='second_of_created_at identifier id'>second_of_created_at</span> <span class='assign token'>=</span> <span class='integer val'>2</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='sec_of_created_at_greater_than identifier id'>sec_of_created_at_greater_than</span> <span class='assign token'>=</span> <span class='integer val'>3</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='year_of_created_at_most identifier id'>year_of_created_at_most</span> <span class='assign token'>=</span> <span class='integer val'>5</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='year_of_created_at_lt identifier id'>year_of_created_at_lt</span> <span class='assign token'>=</span> <span class='integer val'>2000</span>
  <span class='comment val'># ... any of the modifiers that apply to datetime columns</span>
</pre>
<p>
Here&#8217;s the cool part. Chaining modifiers:
</p>
<pre class="code">
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='conditions identifier id'>conditions</span><span class='dot token'>.</span><span class='ceil_of_cos_of_sec_of_created_at_greater_than identifier id'>ceil_of_cos_of_sec_of_created_at_greater_than</span> <span class='assign token'>=</span> <span class='integer val'>3</span>
</pre>
<p>
As long as the modifier chain makes sense the possibilities are endless.
</p>
<h3>Modifiers are not indexed</h3>
<p>
Depending on your database you can create complex indexes. But chances are
you probably didn&#8217;t or don&#8217;t plan to. So keep in mind that once
you use a modifier it will not be using an index, meaning the query will be
slower. One of the ways to get the best of both worlds is to cache virtual
attributes in the database. Checkout my tutorial:
</p>
<p>
http://www.binarylogic.com/2008/10/5/tutorial-caching-virtual-attributes-in-the-database
</p>
<h2>Roll your own conditions &amp; modifiers</h2>
<p>
For more information on this please see Searchlogic::Conditions::Base
</p>
<h2>Under the hood</h2>
<p>
I&#8217;m a big fan of understanding what I&#8217;m using, so here&#8217;s
a quick explanation: The design behind this plugin is pretty simple and I
had 1 main rule when developing this:
</p>
<p>
ActiveRecord should never know about Searchlogic
</p>
<p>
What that rule means is that any options you pass when searching get
&quot;sanitized&quot; down into options ActiveRecord can understand.
Searchlogic serves as a transparent filter between you and ActiveRecord. It
doesn&#8217;t dig into the ActiveRecord internals, it only uses what is
publicly available. It jumps in and helps out <em>only</em> when needed,
otherwise it sits back and stays completely out of the way.
</p>
<p>
Lastly, Searchlogic is lazy. It only creates objects, methods, and classes
when needed. Once it creates them it caches them. For example, all of the
nifty conditions are created via meta programming. The first time you
execute something like User.new_search all of that method creation gets
cached into Searchlogic::Cache::UserSearch. The next time you execute
User.new_search it will be over 50 times faster because it uses the cached
class.
</p>
<p>
Between that and the extensive tests, this is a solid and fast plugin.
</p>
<h2>Credits</h2>
<p>
Author: <tt>Johnson</tt>[http://github.com/binarylogic] of <tt>Logic</tt>[http://www.binarylogic.com]
</p>
<p>
Credit to <tt>Ham</tt>[http://github.com/zackham] for helping with feature
suggestions.
</p>
<p>
Copyright &#169; 2008 <tt>Johnson</tt>[http://github.com/binarylogic] of
<tt>Logic</tt>[http://www.binarylogic.com], released under the MIT license
</p>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>