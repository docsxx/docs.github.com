<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: Sphinx::Client</title>
  </head>
  <body>
    <div id="content">
      <div class="section class Sphinx_Client">
  <h1 class="title">Class: Sphinx::Client</h1>
  <div class="section docstring">
  <p>
:startdoc:
</p>

</div><div class="section constants">
  <div class="thisclass">
  <h1>Constants</h1>
  <dl>
    
      <dt id="SEARCHD_COMMAND_EXCERPT-constant">SEARCHD_COMMAND_EXCERPT</dt>
      <dd>1</dd>
    
      <dt id="SEARCHD_COMMAND_KEYWORDS-constant">SEARCHD_COMMAND_KEYWORDS</dt>
      <dd>3 </dd>
    
      <dt id="SEARCHD_COMMAND_SEARCH-constant">SEARCHD_COMMAND_SEARCH</dt>
      <dd>0</dd>
    
      <dt id="SEARCHD_COMMAND_UPDATE-constant">SEARCHD_COMMAND_UPDATE</dt>
      <dd>2 </dd>
    
      <dt id="SEARCHD_ERROR-constant">SEARCHD_ERROR</dt>
      <dd>1</dd>
    
      <dt id="SEARCHD_OK-constant">SEARCHD_OK</dt>
      <dd>0</dd>
    
      <dt id="SEARCHD_RETRY-constant">SEARCHD_RETRY</dt>
      <dd>2</dd>
    
      <dt id="SEARCHD_WARNING-constant">SEARCHD_WARNING</dt>
      <dd>3    </dd>
    
      <dt id="SPH_ATTR_BIGINT-constant">SPH_ATTR_BIGINT</dt>
      <dd>6</dd>
    
      <dt id="SPH_ATTR_BOOL-constant">SPH_ATTR_BOOL</dt>
      <dd>4</dd>
    
      <dt id="SPH_ATTR_FLOAT-constant">SPH_ATTR_FLOAT</dt>
      <dd>5</dd>
    
      <dt id="SPH_ATTR_INTEGER-constant">SPH_ATTR_INTEGER</dt>
      <dd>1</dd>
    
      <dt id="SPH_ATTR_MULTI-constant">SPH_ATTR_MULTI</dt>
      <dd>0x40000000</dd>
    
      <dt id="SPH_ATTR_ORDINAL-constant">SPH_ATTR_ORDINAL</dt>
      <dd>3</dd>
    
      <dt id="SPH_ATTR_TIMESTAMP-constant">SPH_ATTR_TIMESTAMP</dt>
      <dd>2</dd>
    
      <dt id="SPH_FILTER_FLOATRANGE-constant">SPH_FILTER_FLOATRANGE</dt>
      <dd>2</dd>
    
      <dt id="SPH_FILTER_RANGE-constant">SPH_FILTER_RANGE</dt>
      <dd>1</dd>
    
      <dt id="SPH_FILTER_VALUES-constant">SPH_FILTER_VALUES</dt>
      <dd>0</dd>
    
      <dt id="SPH_GROUPBY_ATTR-constant">SPH_GROUPBY_ATTR</dt>
      <dd>4</dd>
    
      <dt id="SPH_GROUPBY_ATTRPAIR-constant">SPH_GROUPBY_ATTRPAIR</dt>
      <dd>5</dd>
    
      <dt id="SPH_GROUPBY_DAY-constant">SPH_GROUPBY_DAY</dt>
      <dd>0</dd>
    
      <dt id="SPH_GROUPBY_MONTH-constant">SPH_GROUPBY_MONTH</dt>
      <dd>2 </dd>
    
      <dt id="SPH_GROUPBY_WEEK-constant">SPH_GROUPBY_WEEK</dt>
      <dd>1 </dd>
    
      <dt id="SPH_GROUPBY_YEAR-constant">SPH_GROUPBY_YEAR</dt>
      <dd>3</dd>
    
      <dt id="SPH_MATCH_ALL-constant">SPH_MATCH_ALL</dt>
      <dd>0 </dd>
    
      <dt id="SPH_MATCH_ANY-constant">SPH_MATCH_ANY</dt>
      <dd>1 </dd>
    
      <dt id="SPH_MATCH_BOOLEAN-constant">SPH_MATCH_BOOLEAN</dt>
      <dd>3 </dd>
    
      <dt id="SPH_MATCH_EXTENDED-constant">SPH_MATCH_EXTENDED</dt>
      <dd>4 </dd>
    
      <dt id="SPH_MATCH_EXTENDED2-constant">SPH_MATCH_EXTENDED2</dt>
      <dd>6</dd>
    
      <dt id="SPH_MATCH_FULLSCAN-constant">SPH_MATCH_FULLSCAN</dt>
      <dd>5</dd>
    
      <dt id="SPH_MATCH_PHRASE-constant">SPH_MATCH_PHRASE</dt>
      <dd>2 </dd>
    
      <dt id="SPH_RANK_BM25-constant">SPH_RANK_BM25</dt>
      <dd>1</dd>
    
      <dt id="SPH_RANK_NONE-constant">SPH_RANK_NONE</dt>
      <dd>2</dd>
    
      <dt id="SPH_RANK_PROXIMITY-constant">SPH_RANK_PROXIMITY</dt>
      <dd>4</dd>
    
      <dt id="SPH_RANK_PROXIMITY_BM25-constant">SPH_RANK_PROXIMITY_BM25</dt>
      <dd>0</dd>
    
      <dt id="SPH_RANK_WORDCOUNT-constant">SPH_RANK_WORDCOUNT</dt>
      <dd>3</dd>
    
      <dt id="SPH_SORT_ATTR_ASC-constant">SPH_SORT_ATTR_ASC</dt>
      <dd>2</dd>
    
      <dt id="SPH_SORT_ATTR_DESC-constant">SPH_SORT_ATTR_DESC</dt>
      <dd>1</dd>
    
      <dt id="SPH_SORT_EXPR-constant">SPH_SORT_EXPR</dt>
      <dd>5</dd>
    
      <dt id="SPH_SORT_EXTENDED-constant">SPH_SORT_EXTENDED</dt>
      <dd>4</dd>
    
      <dt id="SPH_SORT_RELEVANCE-constant">SPH_SORT_RELEVANCE</dt>
      <dd>0</dd>
    
      <dt id="SPH_SORT_TIME_SEGMENTS-constant">SPH_SORT_TIME_SEGMENTS</dt>
      <dd>3</dd>
    
      <dt id="VER_COMMAND_EXCERPT-constant">VER_COMMAND_EXCERPT</dt>
      <dd>0x100</dd>
    
      <dt id="VER_COMMAND_KEYWORDS-constant">VER_COMMAND_KEYWORDS</dt>
      <dd>0x100</dd>
    
      <dt id="VER_COMMAND_SEARCH-constant">VER_COMMAND_SEARCH</dt>
      <dd>0x116</dd>
    
      <dt id="VER_COMMAND_UPDATE-constant">VER_COMMAND_UPDATE</dt>
      <dd>0x102</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h1>Constructor Summary</h1>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Constructs the <tt>Sphinx::Client</tt> object and sets options to their
default values.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 169</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span>
  <span class='comment val'># per-client-object settings</span>
  <span class='@host ivar id'>@host</span>          <span class='assign token'>=</span> <span class='string val'>'localhost'</span>             <span class='comment val'># searchd host (default is &quot;localhost&quot;)</span>
  <span class='@port ivar id'>@port</span>          <span class='assign token'>=</span> <span class='integer val'>3312</span>                    <span class='comment val'># searchd port (default is 3312)</span>
  
  <span class='comment val'># per-query settings</span>
  <span class='@offset ivar id'>@offset</span>        <span class='assign token'>=</span> <span class='integer val'>0</span>                       <span class='comment val'># how many records to seek from result-set start (default is 0)</span>
  <span class='@limit ivar id'>@limit</span>         <span class='assign token'>=</span> <span class='integer val'>20</span>                      <span class='comment val'># how many records to return from result-set starting at offset (default is 20)</span>
  <span class='@mode ivar id'>@mode</span>          <span class='assign token'>=</span> <span class='SPH_MATCH_ALL constant id'>SPH_MATCH_ALL</span>           <span class='comment val'># query matching mode (default is SPH_MATCH_ALL)</span>
  <span class='@weights ivar id'>@weights</span>       <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>                      <span class='comment val'># per-field weights (default is 1 for all fields)</span>
  <span class='@sort ivar id'>@sort</span>          <span class='assign token'>=</span> <span class='SPH_SORT_RELEVANCE constant id'>SPH_SORT_RELEVANCE</span>      <span class='comment val'># match sorting mode (default is SPH_SORT_RELEVANCE)</span>
  <span class='@sortby ivar id'>@sortby</span>        <span class='assign token'>=</span> <span class='string val'>''</span>                      <span class='comment val'># attribute to sort by (defualt is &quot;&quot;)</span>
  <span class='@min_id ivar id'>@min_id</span>        <span class='assign token'>=</span> <span class='integer val'>0</span>                       <span class='comment val'># min ID to match (default is 0, which means no limit)</span>
  <span class='@max_id ivar id'>@max_id</span>        <span class='assign token'>=</span> <span class='integer val'>0</span>                       <span class='comment val'># max ID to match (default is 0, which means no limit)</span>
  <span class='@filters ivar id'>@filters</span>       <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>                      <span class='comment val'># search filters</span>
  <span class='@groupby ivar id'>@groupby</span>       <span class='assign token'>=</span> <span class='string val'>''</span>                      <span class='comment val'># group-by attribute name</span>
  <span class='@groupfunc ivar id'>@groupfunc</span>     <span class='assign token'>=</span> <span class='SPH_GROUPBY_DAY constant id'>SPH_GROUPBY_DAY</span>         <span class='comment val'># function to pre-process group-by attribute value with</span>
  <span class='@groupsort ivar id'>@groupsort</span>     <span class='assign token'>=</span> <span class='string val'>'@group desc'</span>           <span class='comment val'># group-by sorting clause (to sort groups in result set with)</span>
  <span class='@groupdistinct ivar id'>@groupdistinct</span> <span class='assign token'>=</span> <span class='string val'>''</span>                      <span class='comment val'># group-by count-distinct attribute</span>
  <span class='@maxmatches ivar id'>@maxmatches</span>    <span class='assign token'>=</span> <span class='integer val'>1000</span>                    <span class='comment val'># max matches to retrieve</span>
  <span class='@cutoff ivar id'>@cutoff</span>        <span class='assign token'>=</span> <span class='integer val'>0</span>                       <span class='comment val'># cutoff to stop searching at (default is 0)</span>
  <span class='@retrycount ivar id'>@retrycount</span>    <span class='assign token'>=</span> <span class='integer val'>0</span>                       <span class='comment val'># distributed retries count</span>
  <span class='@retrydelay ivar id'>@retrydelay</span>    <span class='assign token'>=</span> <span class='integer val'>0</span>                       <span class='comment val'># distributed retries delay</span>
  <span class='@anchor ivar id'>@anchor</span>        <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>                      <span class='comment val'># geographical anchor point</span>
  <span class='@indexweights ivar id'>@indexweights</span>  <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>                      <span class='comment val'># per-index weights</span>
  <span class='@ranker ivar id'>@ranker</span>        <span class='assign token'>=</span> <span class='SPH_RANK_PROXIMITY_BM25 constant id'>SPH_RANK_PROXIMITY_BM25</span> <span class='comment val'># ranking mode (default is SPH_RANK_PROXIMITY_BM25)</span>
  <span class='@maxquerytime ivar id'>@maxquerytime</span>  <span class='assign token'>=</span> <span class='integer val'>0</span>                       <span class='comment val'># max query time, milliseconds (default is 0, do not limit) </span>
  <span class='@fieldweights ivar id'>@fieldweights</span>  <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>                      <span class='comment val'># per-field-name weights</span>
  <span class='@overrides ivar id'>@overrides</span>     <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>                      <span class='comment val'># per-query attribute values overrides</span>
  <span class='@select ivar id'>@select</span>        <span class='assign token'>=</span> <span class='string val'>'*'</span>                     <span class='comment val'># select-list (attributes or expressions, with optional aliases)</span>

  <span class='comment val'># per-reply fields (for single-query case)</span>
  <span class='@error ivar id'>@error</span>         <span class='assign token'>=</span> <span class='string val'>''</span>                      <span class='comment val'># last error message</span>
  <span class='@warning ivar id'>@warning</span>       <span class='assign token'>=</span> <span class='string val'>''</span>                      <span class='comment val'># last warning message</span>
  
  <span class='@reqs ivar id'>@reqs</span>          <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>                      <span class='comment val'># requests storage (for multi-query case)</span>
  <span class='@mbenc ivar id'>@mbenc</span>         <span class='assign token'>=</span> <span class='string val'>''</span>                      <span class='comment val'># stored mbstring encoding</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#AddQuery-instance_method' title='#AddQuery'>#AddQuery</a></span><span class='args'>(query, index = '*', comment = '')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Add query to batch.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#assert-instance_method' title='#assert'>#assert</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
:stopdoc:.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#BuildExcerpts-instance_method' title='#BuildExcerpts'>#BuildExcerpts</a></span><span class='args'>(docs, index, words, opts = {})</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Connect to searchd server and generate exceprts from given documents.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#BuildKeywords-instance_method' title='#BuildKeywords'>#BuildKeywords</a></span><span class='args'>(query, index, hits)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Connect to searchd server, and generate keyword list for a given query.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#Connect-instance_method' title='#Connect'>#Connect</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Connect to searchd server.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#GetLastError-instance_method' title='#GetLastError'>#GetLastError</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get last error message.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#GetLastWarning-instance_method' title='#GetLastWarning'>#GetLastWarning</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get last warning message.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#GetResponse-instance_method' title='#GetResponse'>#GetResponse</a></span><span class='args'>(sock, client_version)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Get and check response packet from searchd server.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#PerformRequest-instance_method' title='#PerformRequest'>#PerformRequest</a></span><span class='args'>(command, request, additional = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Connect, send query, get response.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#Query-instance_method' title='#Query'>#Query</a></span><span class='args'>(query, index = '*', comment = '')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Connect to searchd server and run given search query.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#ResetFilters-instance_method' title='#ResetFilters'>#ResetFilters</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Clear all filters (for multi-queries).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#ResetGroupBy-instance_method' title='#ResetGroupBy'>#ResetGroupBy</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Clear groupby settings (for multi-queries).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#ResetOverrides-instance_method' title='#ResetOverrides'>#ResetOverrides</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Clear all attribute value overrides (for multi-queries).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#RunQueries-instance_method' title='#RunQueries'>#RunQueries</a></span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Run queries batch.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetFieldWeights-instance_method' title='#SetFieldWeights'>#SetFieldWeights</a></span><span class='args'>(weights)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Bind per-field weights by name.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetFilter-instance_method' title='#SetFilter'>#SetFilter</a></span><span class='args'>(attribute, values, exclude = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set values filter.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetFilterFloatRange-instance_method' title='#SetFilterFloatRange'>#SetFilterFloatRange</a></span><span class='args'>(attribute, min, max, exclude = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set float range filter.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetFilterRange-instance_method' title='#SetFilterRange'>#SetFilterRange</a></span><span class='args'>(attribute, min, max, exclude = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set range filter.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetGeoAnchor-instance_method' title='#SetGeoAnchor'>#SetGeoAnchor</a></span><span class='args'>(attrlat, attrlong, lat, long)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Setup anchor point for geosphere distance calculations.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetGroupBy-instance_method' title='#SetGroupBy'>#SetGroupBy</a></span><span class='args'>(attribute, func, groupsort = '@group desc')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set grouping attribute and function.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetGroupDistinct-instance_method' title='#SetGroupDistinct'>#SetGroupDistinct</a></span><span class='args'>(attribute)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set count-distinct attribute for group-by queries.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetIDRange-instance_method' title='#SetIDRange'>#SetIDRange</a></span><span class='args'>(min, max)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set IDs range to match.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetIndexWeights-instance_method' title='#SetIndexWeights'>#SetIndexWeights</a></span><span class='args'>(weights)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Bind per-index weights by name.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetLimits-instance_method' title='#SetLimits'>#SetLimits</a></span><span class='args'>(offset, limit, max = 0, cutoff = 0)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set offset and count into result set, and optionally set max-matches and
cutoff limits.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetMatchMode-instance_method' title='#SetMatchMode'>#SetMatchMode</a></span><span class='args'>(mode)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set matching mode.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetMaxQueryTime-instance_method' title='#SetMaxQueryTime'>#SetMaxQueryTime</a></span><span class='args'>(max)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set maximum query time, in milliseconds, per-index, integer, 0 means
&quot;do not limit&quot;.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetOverride-instance_method' title='#SetOverride'>#SetOverride</a></span><span class='args'>(attrname, attrtype, values)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set attribute values override.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetRankingMode-instance_method' title='#SetRankingMode'>#SetRankingMode</a></span><span class='args'>(ranker)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set ranking mode.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetRetries-instance_method' title='#SetRetries'>#SetRetries</a></span><span class='args'>(count, delay = 0)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set distributed retries count and delay.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetSelect-instance_method' title='#SetSelect'>#SetSelect</a></span><span class='args'>(select)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set select-list (attributes or expressions), SQL-like syntax.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetServer-instance_method' title='#SetServer'>#SetServer</a></span><span class='args'>(host, port)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set searchd host name (string) and port (integer).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetSortMode-instance_method' title='#SetSortMode'>#SetSortMode</a></span><span class='args'>(mode, sortby = '')</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Set matches sorting mode.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#SetWeights-instance_method' title='#SetWeights'>#SetWeights</a></span><span class='args'>(weights)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Bind per-field weights by order.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href='#UpdateAttributes-instance_method' title='#UpdateAttributes'>#UpdateAttributes</a></span><span class='args'>(index, attrs, values, mva = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Batch update given attributes in given rows in given indexes.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>AddQuery</h3>
</div><div id="AddQuery-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>AddQuery</span><span class='args'>(query, index = '*', comment = '')</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Add query to batch.
</p>
<p>
Batch queries enable searchd to perform internal optimizations, if
possible; and reduce network connection overheads in all cases.
</p>
<p>
For instance, running exactly the same query with different groupby
settings will enable searched to perform expensive full-text search and
ranking operation only once, but compute multiple groupby results from its
output.
</p>
<p>
Parameters are exactly the same as in <tt>Query</tt> call. Returns index to
results array returned by <tt>RunQueries</tt> call.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 562</span>

<span class='def def kw'>def</span> <span class='AddQuery constant id'>AddQuery</span><span class='lparen token'>(</span><span class='query identifier id'>query</span><span class='comma token'>,</span> <span class='index identifier id'>index</span> <span class='assign token'>=</span> <span class='string val'>'*'</span><span class='comma token'>,</span> <span class='comment identifier id'>comment</span> <span class='assign token'>=</span> <span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='comment val'># build request</span>
  
  <span class='comment val'># mode and limits</span>
  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='Request constant id'>Request</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='@offset ivar id'>@offset</span><span class='comma token'>,</span> <span class='@limit ivar id'>@limit</span><span class='comma token'>,</span> <span class='@mode ivar id'>@mode</span><span class='comma token'>,</span> <span class='@ranker ivar id'>@ranker</span><span class='comma token'>,</span> <span class='@sort ivar id'>@sort</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='@sortby ivar id'>@sortby</span>
  <span class='comment val'># query itself</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='query identifier id'>query</span>
  <span class='comment val'># weights</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int_array identifier id'>put_int_array</span> <span class='@weights ivar id'>@weights</span>
  <span class='comment val'># indexes</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='index identifier id'>index</span>
  <span class='comment val'># id64 range marker</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='integer val'>1</span>
  <span class='comment val'># id64 range</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int64 identifier id'>put_int64</span> <span class='@min_id ivar id'>@min_id</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='@max_id ivar id'>@max_id</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> 
  
  <span class='comment val'># filters</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='@filters ivar id'>@filters</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='@filters ivar id'>@filters</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='filter identifier id'>filter</span><span class='bitor op'>|</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='filter identifier id'>filter</span><span class='lbrack token'>[</span><span class='string val'>'attr'</span><span class='rbrack token'>]</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='filter identifier id'>filter</span><span class='lbrack token'>[</span><span class='string val'>'type'</span><span class='rbrack token'>]</span>

    <span class='case case kw'>case</span> <span class='filter identifier id'>filter</span><span class='lbrack token'>[</span><span class='string val'>'type'</span><span class='rbrack token'>]</span>
      <span class='when when kw'>when</span> <span class='SPH_FILTER_VALUES constant id'>SPH_FILTER_VALUES</span>
        <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int64_array identifier id'>put_int64_array</span> <span class='filter identifier id'>filter</span><span class='lbrack token'>[</span><span class='string val'>'values'</span><span class='rbrack token'>]</span>
      <span class='when when kw'>when</span> <span class='SPH_FILTER_RANGE constant id'>SPH_FILTER_RANGE</span>
        <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int64 identifier id'>put_int64</span> <span class='filter identifier id'>filter</span><span class='lbrack token'>[</span><span class='string val'>'min'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='filter identifier id'>filter</span><span class='lbrack token'>[</span><span class='string val'>'max'</span><span class='rbrack token'>]</span>
      <span class='when when kw'>when</span> <span class='SPH_FILTER_FLOATRANGE constant id'>SPH_FILTER_FLOATRANGE</span>
        <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_float identifier id'>put_float</span> <span class='filter identifier id'>filter</span><span class='lbrack token'>[</span><span class='string val'>'min'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='filter identifier id'>filter</span><span class='lbrack token'>[</span><span class='string val'>'max'</span><span class='rbrack token'>]</span>
      <span class='else else kw'>else</span>
        <span class='raise identifier id'>raise</span> <span class='SphinxInternalError constant id'>SphinxInternalError</span><span class='comma token'>,</span> <span class='string val'>'Internal error: unhandled filter type'</span>
    <span class='end end kw'>end</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='filter identifier id'>filter</span><span class='lbrack token'>[</span><span class='string val'>'exclude'</span><span class='rbrack token'>]</span> <span class='question op'>?</span> <span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># group-by clause, max-matches count, group-sort clause, cutoff count</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='@groupfunc ivar id'>@groupfunc</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='@groupby ivar id'>@groupby</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='@maxmatches ivar id'>@maxmatches</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='@groupsort ivar id'>@groupsort</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='@cutoff ivar id'>@cutoff</span><span class='comma token'>,</span> <span class='@retrycount ivar id'>@retrycount</span><span class='comma token'>,</span> <span class='@retrydelay ivar id'>@retrydelay</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='@groupdistinct ivar id'>@groupdistinct</span>
  
  <span class='comment val'># anchor point</span>
  <span class='if if kw'>if</span> <span class='@anchor ivar id'>@anchor</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='integer val'>0</span>
  <span class='else else kw'>else</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='integer val'>1</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='@anchor ivar id'>@anchor</span><span class='lbrack token'>[</span><span class='string val'>'attrlat'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='@anchor ivar id'>@anchor</span><span class='lbrack token'>[</span><span class='string val'>'attrlong'</span><span class='rbrack token'>]</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_float identifier id'>put_float</span> <span class='@anchor ivar id'>@anchor</span><span class='lbrack token'>[</span><span class='string val'>'lat'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='@anchor ivar id'>@anchor</span><span class='lbrack token'>[</span><span class='string val'>'long'</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># per-index weights</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='@indexweights ivar id'>@indexweights</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='@indexweights ivar id'>@indexweights</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='idx identifier id'>idx</span><span class='comma token'>,</span> <span class='weight identifier id'>weight</span><span class='bitor op'>|</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='idx identifier id'>idx</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='weight identifier id'>weight</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># max query time</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='@maxquerytime ivar id'>@maxquerytime</span>
  
  <span class='comment val'># per-field weights</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='@fieldweights ivar id'>@fieldweights</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='@fieldweights ivar id'>@fieldweights</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='field identifier id'>field</span><span class='comma token'>,</span> <span class='weight identifier id'>weight</span><span class='bitor op'>|</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='field identifier id'>field</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='weight identifier id'>weight</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># comment</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='comment identifier id'>comment</span>
  
  <span class='comment val'># attribute overrides</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='@overrides ivar id'>@overrides</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='for for kw'>for</span> <span class='entry identifier id'>entry</span> <span class='in in kw'>in</span> <span class='@overrides ivar id'>@overrides</span> <span class='do do kw'>do</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'attr'</span><span class='rbrack token'>]</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'type'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'values'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
    <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'values'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='bitor op'>|</span>
      <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Fixnum constant id'>Fixnum</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Bignum constant id'>Bignum</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
      <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='val identifier id'>val</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Fixnum constant id'>Fixnum</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='val identifier id'>val</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Bignum constant id'>Bignum</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='val identifier id'>val</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Float constant id'>Float</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
      
      <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int64 identifier id'>put_int64</span> <span class='id identifier id'>id</span>
      <span class='case case kw'>case</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'type'</span><span class='rbrack token'>]</span>
        <span class='when when kw'>when</span> <span class='SPH_ATTR_FLOAT constant id'>SPH_ATTR_FLOAT</span>
          <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_float identifier id'>put_float</span> <span class='val identifier id'>val</span>
        <span class='when when kw'>when</span> <span class='SPH_ATTR_BIGINT constant id'>SPH_ATTR_BIGINT</span>
          <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int64 identifier id'>put_int64</span> <span class='val identifier id'>val</span>
        <span class='else else kw'>else</span>
          <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='val identifier id'>val</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># select-list</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='@select ivar id'>@select</span>
  
  <span class='comment val'># store request to requests array</span>
  <span class='@reqs ivar id'>@reqs</span> <span class='lshft op'>&lt;&lt;</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='semicolon token'>;</span>
  <span class='return return kw'>return</span> <span class='@reqs ivar id'>@reqs</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='minus op'>-</span> <span class='integer val'>1</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>assert</h3>
</div><div id="assert-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>assert</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
:stopdoc:
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


1088
1089
1090</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 1088</span>

<span class='def def kw'>def</span> <span class='assert identifier id'>assert</span>
  <span class='raise identifier id'>raise</span> <span class='string val'>'Assertion failed!'</span> <span class='unless unless_mod kw'>unless</span> <span class='yield yield kw'>yield</span> <span class='if if_mod kw'>if</span> <span class='$DEBUG gvar id'>$DEBUG</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>BuildExcerpts</h3>
</div><div id="BuildExcerpts-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>BuildExcerpts</span><span class='args'>(docs, index, words, opts = {})</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Connect to searchd server and generate exceprts from given documents.
</p>
<ul>
<li><tt>docs</tt> &#8212; an array of strings which represent the
documents&#8217; contents

</li>
<li><tt>index</tt> &#8212; a string specifiying the index which settings will
be used

</li>
</ul>
<p>
for stemming, lexing and case folding
</p>
<ul>
<li><tt>words</tt> &#8212; a string which contains the words to highlight

</li>
<li><tt>opts</tt> is a hash which contains additional optional highlighting
parameters.

</li>
</ul>
<p>
You can use following parameters:
</p>
<ul>
<li><tt>&#8216;before_match&#8217;</tt> &#8212; a string to insert before a set
of matching words, default is &quot;&lt;b&gt;&quot;

</li>
<li><tt>&#8216;after_match&#8217;</tt> &#8212; a string to insert after a set
of matching words, default is &quot;&lt;b&gt;&quot;

</li>
<li><tt>&#8216;chunk_separator&#8217;</tt> &#8212; a string to insert between
excerpts chunks, default is &quot; &#8230; &quot;

</li>
<li><tt>&#8216;limit&#8217;</tt> &#8212; max excerpt size in symbols
(codepoints), default is 256

</li>
<li><tt>&#8216;around&#8217;</tt> &#8212; how much words to highlight around
each match, default is 5

</li>
<li><tt>&#8216;exact_phrase&#8217;</tt> &#8212; whether to highlight exact
phrase matches only, default is <tt>false</tt>

</li>
<li><tt>&#8216;single_passage&#8217;</tt> &#8212; whether to extract single
best passage only, default is false

</li>
<li><tt>&#8216;use_boundaries&#8217;</tt> &#8212; whether to extract passages
by phrase boundaries setup in tokenizer

</li>
<li><tt>&#8216;weight_order&#8217;</tt> &#8212; whether to order best passages
in document (default) or weight order

</li>
</ul>
<p>
Returns false on failure. Returns an array of string excerpts on success.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 818</span>

<span class='def def kw'>def</span> <span class='BuildExcerpts constant id'>BuildExcerpts</span><span class='lparen token'>(</span><span class='docs identifier id'>docs</span><span class='comma token'>,</span> <span class='index identifier id'>index</span><span class='comma token'>,</span> <span class='words identifier id'>words</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='docs identifier id'>docs</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Array constant id'>Array</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='index identifier id'>index</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='words identifier id'>words</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='opts identifier id'>opts</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Hash constant id'>Hash</span> <span class='rbrace token'>}</span>

  <span class='comment val'># fixup options</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'before_match'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>'&lt;b&gt;'</span><span class='semicolon token'>;</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'after_match'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>'&lt;/b&gt;'</span><span class='semicolon token'>;</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'chunk_separator'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='string val'>' ... '</span><span class='semicolon token'>;</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'limit'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>256</span><span class='semicolon token'>;</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'around'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='integer val'>5</span><span class='semicolon token'>;</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'exact_phrase'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='false false kw'>false</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'single_passage'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='false false kw'>false</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'use_boundaries'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='false false kw'>false</span>
  <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'weight_order'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='false false kw'>false</span>
  
  <span class='comment val'># build request</span>
  
  <span class='comment val'># v.1.0 req</span>
  <span class='flags identifier id'>flags</span> <span class='assign token'>=</span> <span class='integer val'>1</span>
  <span class='flags identifier id'>flags</span> <span class='opasgn op'>|=</span> <span class='integer val'>2</span>  <span class='if if_mod kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'exact_phrase'</span><span class='rbrack token'>]</span>
  <span class='flags identifier id'>flags</span> <span class='opasgn op'>|=</span> <span class='integer val'>4</span>  <span class='if if_mod kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'single_passage'</span><span class='rbrack token'>]</span>
  <span class='flags identifier id'>flags</span> <span class='opasgn op'>|=</span> <span class='integer val'>8</span>  <span class='if if_mod kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'use_boundaries'</span><span class='rbrack token'>]</span>
  <span class='flags identifier id'>flags</span> <span class='opasgn op'>|=</span> <span class='integer val'>16</span> <span class='if if_mod kw'>if</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'weight_order'</span><span class='rbrack token'>]</span>
  
  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='Request constant id'>Request</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='flags identifier id'>flags</span> <span class='comment val'># mode=0, flags=1 (remove spaces)</span>
  <span class='comment val'># req index</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='index identifier id'>index</span>
  <span class='comment val'># req words</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='words identifier id'>words</span>
  
  <span class='comment val'># options</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'before_match'</span><span class='rbrack token'>]</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'after_match'</span><span class='rbrack token'>]</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'chunk_separator'</span><span class='rbrack token'>]</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'limit'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span><span class='comma token'>,</span> <span class='opts identifier id'>opts</span><span class='lbrack token'>[</span><span class='string val'>'around'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
  
  <span class='comment val'># documents</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='docs identifier id'>docs</span><span class='dot token'>.</span><span class='size identifier id'>size</span>
  <span class='docs identifier id'>docs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='doc identifier id'>doc</span><span class='bitor op'>|</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='doc identifier id'>doc</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>

    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='doc identifier id'>doc</span>
  <span class='end end kw'>end</span>
  
  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='PerformRequest constant id'>PerformRequest</span><span class='lparen token'>(</span><span class='symbol val'>:excerpt</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='rparen token'>)</span>
  
  <span class='comment val'># parse response</span>
  <span class='begin begin kw'>begin</span>
    <span class='res identifier id'>res</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='docs identifier id'>docs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='doc identifier id'>doc</span><span class='bitor op'>|</span>
      <span class='res identifier id'>res</span> <span class='lshft op'>&lt;&lt;</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_string identifier id'>get_string</span>
    <span class='end end kw'>end</span>
  <span class='rescue rescue kw'>rescue</span> <span class='EOFError constant id'>EOFError</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='string val'>'incomplete reply'</span>
    <span class='raise identifier id'>raise</span> <span class='SphinxResponseError constant id'>SphinxResponseError</span><span class='comma token'>,</span> <span class='@error ivar id'>@error</span>
  <span class='end end kw'>end</span>
  <span class='return return kw'>return</span> <span class='res identifier id'>res</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>BuildKeywords</h3>
</div><div id="BuildKeywords-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>BuildKeywords</span><span class='args'>(query, index, hits)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Connect to searchd server, and generate keyword list for a given query.
</p>
<p>
Returns an array of words on success.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 883</span>

<span class='def def kw'>def</span> <span class='BuildKeywords constant id'>BuildKeywords</span><span class='lparen token'>(</span><span class='query identifier id'>query</span><span class='comma token'>,</span> <span class='index identifier id'>index</span><span class='comma token'>,</span> <span class='hits identifier id'>hits</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='query identifier id'>query</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='index identifier id'>index</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='hits identifier id'>hits</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='TrueClass constant id'>TrueClass</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='hits identifier id'>hits</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='FalseClass constant id'>FalseClass</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  
  <span class='comment val'># build request</span>
  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='Request constant id'>Request</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='comment val'># v.1.0 req</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='query identifier id'>query</span> <span class='comment val'># req query</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='index identifier id'>index</span> <span class='comment val'># req index</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='hits identifier id'>hits</span> <span class='question op'>?</span> <span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span>

  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='PerformRequest constant id'>PerformRequest</span><span class='lparen token'>(</span><span class='symbol val'>:keywords</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='rparen token'>)</span>
  
  <span class='comment val'># parse response</span>
  <span class='begin begin kw'>begin</span>
    <span class='res identifier id'>res</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='nwords identifier id'>nwords</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
    <span class='integer val'>0</span><span class='dot token'>.</span><span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='nwords identifier id'>nwords</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='i identifier id'>i</span><span class='bitor op'>|</span>
      <span class='tokenized identifier id'>tokenized</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_string identifier id'>get_string</span>
      <span class='normalized identifier id'>normalized</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_string identifier id'>get_string</span>
      
      <span class='entry identifier id'>entry</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'tokenized'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='tokenized identifier id'>tokenized</span><span class='comma token'>,</span> <span class='string val'>'normalized'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='normalized identifier id'>normalized</span> <span class='rbrace token'>}</span>
      <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'docs'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='entry identifier id'>entry</span><span class='lbrack token'>[</span><span class='string val'>'hits'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_ints identifier id'>get_ints</span><span class='lparen token'>(</span><span class='integer val'>2</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='hits identifier id'>hits</span>
      
      <span class='res identifier id'>res</span> <span class='lshft op'>&lt;&lt;</span> <span class='entry identifier id'>entry</span>
    <span class='end end kw'>end</span>
  <span class='rescue rescue kw'>rescue</span> <span class='EOFError constant id'>EOFError</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='string val'>'incomplete reply'</span>
    <span class='raise identifier id'>raise</span> <span class='SphinxResponseError constant id'>SphinxResponseError</span><span class='comma token'>,</span> <span class='@error ivar id'>@error</span>
  <span class='end end kw'>end</span>
  
  <span class='return return kw'>return</span> <span class='res identifier id'>res</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>Connect</h3>
</div><div id="Connect-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>Connect</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Connect to searchd server.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


990
991
992
993
994
995
996
997
998
999
1000
1001
1002
1003
1004
1005
1006
1007</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 990</span>

<span class='def def kw'>def</span> <span class='Connect constant id'>Connect</span>
  <span class='begin begin kw'>begin</span>
    <span class='sock identifier id'>sock</span> <span class='assign token'>=</span> <span class='TCPSocket constant id'>TCPSocket</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='@host ivar id'>@host</span><span class='comma token'>,</span> <span class='@port ivar id'>@port</span><span class='rparen token'>)</span>
  <span class='rescue rescue kw'>rescue</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;connection to #{@host}:#{@port} failed&quot;</span>
    <span class='raise identifier id'>raise</span> <span class='SphinxConnectError constant id'>SphinxConnectError</span><span class='comma token'>,</span> <span class='@error ivar id'>@error</span>
  <span class='end end kw'>end</span>
  
  <span class='v identifier id'>v</span> <span class='assign token'>=</span> <span class='sock identifier id'>sock</span><span class='dot token'>.</span><span class='recv identifier id'>recv</span><span class='lparen token'>(</span><span class='integer val'>4</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='unpack identifier id'>unpack</span><span class='lparen token'>(</span><span class='string val'>'N*'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
  <span class='if if kw'>if</span> <span class='v identifier id'>v</span> <span class='lt op'>&lt;</span> <span class='integer val'>1</span>
    <span class='sock identifier id'>sock</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;expected searchd protocol version 1+, got version '#{v}'&quot;</span>
    <span class='raise identifier id'>raise</span> <span class='SphinxConnectError constant id'>SphinxConnectError</span><span class='comma token'>,</span> <span class='@error ivar id'>@error</span>
  <span class='end end kw'>end</span>
  
  <span class='sock identifier id'>sock</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='pack identifier id'>pack</span><span class='lparen token'>(</span><span class='string val'>'N'</span><span class='rparen token'>)</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='sock identifier id'>sock</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>GetLastError</h3>
</div><div id="GetLastError-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>GetLastError</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get last error message.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


209
210
211</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 209</span>

<span class='def def kw'>def</span> <span class='GetLastError constant id'>GetLastError</span>
  <span class='@error ivar id'>@error</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>GetLastWarning</h3>
</div><div id="GetLastWarning-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>GetLastWarning</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get last warning message.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


214
215
216</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 214</span>

<span class='def def kw'>def</span> <span class='GetLastWarning constant id'>GetLastWarning</span>
  <span class='@warning ivar id'>@warning</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>GetResponse</h3>
</div><div id="GetResponse-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>GetResponse</span><span class='args'>(sock, client_version)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Get and check response packet from searchd server.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


1010
1011
1012
1013
1014
1015
1016
1017
1018
1019
1020
1021
1022
1023
1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038
1039
1040
1041
1042
1043
1044
1045
1046
1047
1048
1049
1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062
1063
1064
1065
1066
1067
1068
1069
1070</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 1010</span>

<span class='def def kw'>def</span> <span class='GetResponse constant id'>GetResponse</span><span class='lparen token'>(</span><span class='sock identifier id'>sock</span><span class='comma token'>,</span> <span class='client_version identifier id'>client_version</span><span class='rparen token'>)</span>
  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='string val'>''</span>
  <span class='len identifier id'>len</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
  
  <span class='header identifier id'>header</span> <span class='assign token'>=</span> <span class='sock identifier id'>sock</span><span class='dot token'>.</span><span class='recv identifier id'>recv</span><span class='lparen token'>(</span><span class='integer val'>8</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='header identifier id'>header</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='eq op'>==</span> <span class='integer val'>8</span>
    <span class='status identifier id'>status</span><span class='comma token'>,</span> <span class='ver identifier id'>ver</span><span class='comma token'>,</span> <span class='len identifier id'>len</span> <span class='assign token'>=</span> <span class='header identifier id'>header</span><span class='dot token'>.</span><span class='unpack identifier id'>unpack</span><span class='lparen token'>(</span><span class='string val'>'n2N'</span><span class='rparen token'>)</span>
    <span class='left identifier id'>left</span> <span class='assign token'>=</span> <span class='len identifier id'>len</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='while while kw'>while</span> <span class='left identifier id'>left</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span> <span class='do do kw'>do</span>
      <span class='begin begin kw'>begin</span>
        <span class='chunk identifier id'>chunk</span> <span class='assign token'>=</span> <span class='sock identifier id'>sock</span><span class='dot token'>.</span><span class='recv identifier id'>recv</span><span class='lparen token'>(</span><span class='left identifier id'>left</span><span class='rparen token'>)</span>
        <span class='if if kw'>if</span> <span class='chunk identifier id'>chunk</span>
          <span class='response identifier id'>response</span> <span class='lshft op'>&lt;&lt;</span> <span class='chunk identifier id'>chunk</span>
          <span class='left identifier id'>left</span> <span class='opasgn op'>-=</span> <span class='chunk identifier id'>chunk</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
        <span class='end end kw'>end</span>
      <span class='rescue rescue kw'>rescue</span> <span class='EOFError constant id'>EOFError</span>
        <span class='break break kw'>break</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  <span class='sock identifier id'>sock</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
    
  <span class='comment val'># check response</span>
  <span class='read identifier id'>read</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='if if kw'>if</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='or or kw'>or</span> <span class='read identifier id'>read</span> <span class='neq op'>!=</span> <span class='len identifier id'>len</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='len identifier id'>len</span> \
      <span class='integer val'>? </span><span class='dstring node'>&quot;failed to read searchd response (status=#{status}, ver=#{ver}, len=#{len}, read=#{read})&quot;</span> \
      <span class='colon op'>:</span> <span class='string val'>'received zero-sized searchd response'</span>
    <span class='raise identifier id'>raise</span> <span class='SphinxResponseError constant id'>SphinxResponseError</span><span class='comma token'>,</span> <span class='@error ivar id'>@error</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># check status</span>
  <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='status identifier id'>status</span> <span class='eq op'>==</span> <span class='SEARCHD_WARNING constant id'>SEARCHD_WARNING</span><span class='rparen token'>)</span>
    <span class='wlen identifier id'>wlen</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='comma token'>,</span> <span class='integer val'>4</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='unpack identifier id'>unpack</span><span class='lparen token'>(</span><span class='string val'>'N*'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='first identifier id'>first</span>
    <span class='@warning ivar id'>@warning</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='lbrack token'>[</span><span class='integer val'>4</span><span class='comma token'>,</span> <span class='wlen identifier id'>wlen</span><span class='rbrack token'>]</span>
    <span class='return return kw'>return</span> <span class='response identifier id'>response</span><span class='lbrack token'>[</span><span class='integer val'>4</span> <span class='plus op'>+</span> <span class='wlen identifier id'>wlen</span><span class='comma token'>,</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='minus op'>-</span> <span class='integer val'>4</span> <span class='minus op'>-</span> <span class='wlen identifier id'>wlen</span><span class='rbrack token'>]</span>
  <span class='end end kw'>end</span>

  <span class='if if kw'>if</span> <span class='status identifier id'>status</span> <span class='eq op'>==</span> <span class='SEARCHD_ERROR constant id'>SEARCHD_ERROR</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='string val'>'searchd error: '</span> <span class='plus op'>+</span> <span class='response identifier id'>response</span><span class='lbrack token'>[</span><span class='integer val'>4</span><span class='comma token'>,</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='minus op'>-</span> <span class='integer val'>4</span><span class='rbrack token'>]</span>
    <span class='raise identifier id'>raise</span> <span class='SphinxInternalError constant id'>SphinxInternalError</span><span class='comma token'>,</span> <span class='@error ivar id'>@error</span>
  <span class='end end kw'>end</span>
    
  <span class='if if kw'>if</span> <span class='status identifier id'>status</span> <span class='eq op'>==</span> <span class='SEARCHD_RETRY constant id'>SEARCHD_RETRY</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='string val'>'temporary searchd error: '</span> <span class='plus op'>+</span> <span class='response identifier id'>response</span><span class='lbrack token'>[</span><span class='integer val'>4</span><span class='comma token'>,</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='minus op'>-</span> <span class='integer val'>4</span><span class='rbrack token'>]</span>
    <span class='raise identifier id'>raise</span> <span class='SphinxTemporaryError constant id'>SphinxTemporaryError</span><span class='comma token'>,</span> <span class='@error ivar id'>@error</span>
  <span class='end end kw'>end</span>
    
  <span class='unless unless kw'>unless</span> <span class='status identifier id'>status</span> <span class='eq op'>==</span> <span class='SEARCHD_OK constant id'>SEARCHD_OK</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;unknown status code: '#{status}'&quot;</span>
    <span class='raise identifier id'>raise</span> <span class='SphinxUnknownError constant id'>SphinxUnknownError</span><span class='comma token'>,</span> <span class='@error ivar id'>@error</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># check version</span>
  <span class='if if kw'>if</span> <span class='ver identifier id'>ver</span> <span class='lt op'>&lt;</span> <span class='client_version identifier id'>client_version</span>
    <span class='@warning ivar id'>@warning</span> <span class='assign token'>=</span> <span class='dstring node'>&quot;searchd command v.#{ver &gt;&gt; 8}.#{ver &amp; 0xff} older than client's &quot;</span> <span class='plus op'>+</span>
      <span class='dstring node'>&quot;v.#{client_version &gt;&gt; 8}.#{client_version &amp; 0xff}, some options might not work&quot;</span>
  <span class='end end kw'>end</span>
  
  <span class='return return kw'>return</span> <span class='response identifier id'>response</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>PerformRequest</h3>
</div><div id="PerformRequest-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>PerformRequest</span><span class='args'>(command, request, additional = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Connect, send query, get response.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


1073
1074
1075
1076
1077
1078
1079
1080
1081
1082
1083
1084
1085</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 1073</span>

<span class='def def kw'>def</span> <span class='PerformRequest constant id'>PerformRequest</span><span class='lparen token'>(</span><span class='command identifier id'>command</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='comma token'>,</span> <span class='additional identifier id'>additional</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='cmd identifier id'>cmd</span> <span class='assign token'>=</span> <span class='command identifier id'>command</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='upcase identifier id'>upcase</span>
  <span class='command_id identifier id'>command_id</span> <span class='assign token'>=</span> <span class='Sphinx constant id'>Sphinx</span><span class='colon2 op'>::</span><span class='Client constant id'>Client</span><span class='dot token'>.</span><span class='const_get identifier id'>const_get</span><span class='lparen token'>(</span><span class='string val'>'SEARCHD_COMMAND_'</span> <span class='plus op'>+</span> <span class='cmd identifier id'>cmd</span><span class='rparen token'>)</span>
  <span class='command_ver identifier id'>command_ver</span> <span class='assign token'>=</span> <span class='Sphinx constant id'>Sphinx</span><span class='colon2 op'>::</span><span class='Client constant id'>Client</span><span class='dot token'>.</span><span class='const_get identifier id'>const_get</span><span class='lparen token'>(</span><span class='string val'>'VER_COMMAND_'</span> <span class='plus op'>+</span> <span class='cmd identifier id'>cmd</span><span class='rparen token'>)</span>
  
  <span class='sock identifier id'>sock</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='Connect constant id'>Connect</span>
  <span class='len identifier id'>len</span> <span class='assign token'>=</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='additional identifier id'>additional</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span> <span class='question op'>?</span> <span class='integer val'>4</span> <span class='colon op'>:</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='header identifier id'>header</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='command_id identifier id'>command_id</span><span class='comma token'>,</span> <span class='command_ver identifier id'>command_ver</span><span class='comma token'>,</span> <span class='len identifier id'>len</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='pack identifier id'>pack</span><span class='lparen token'>(</span><span class='string val'>'nnN'</span><span class='rparen token'>)</span>
  <span class='header identifier id'>header</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrack token'>[</span><span class='additional identifier id'>additional</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='pack identifier id'>pack</span><span class='lparen token'>(</span><span class='string val'>'N'</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='additional identifier id'>additional</span> <span class='neq op'>!=</span> <span class='nil nil kw'>nil</span>
  <span class='sock identifier id'>sock</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='header identifier id'>header</span> <span class='plus op'>+</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='comma token'>,</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='GetResponse constant id'>GetResponse</span><span class='lparen token'>(</span><span class='sock identifier id'>sock</span><span class='comma token'>,</span> <span class='command_ver identifier id'>command_ver</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='Response constant id'>Response</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='response identifier id'>response</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>Query</h3>
</div><div id="Query-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>Query</span><span class='args'>(query, index = '*', comment = '')</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Connect to searchd server and run given search query.
</p>
<p>
<tt>query</tt> is query string <tt>index</tt> is index name (or names) to
query. default value is &quot;*&quot; which means to query all indexes.
Accepted characters for index names are letters, numbers, dash, and
underscore; everything else is considered a separator. Therefore, all the
following calls are valid and will search two indexes:
</p>
<pre class="code">
  <span class='sphinx identifier id'>sphinx</span><span class='dot token'>.</span><span class='Query constant id'>Query</span><span class='lparen token'>(</span><span class='string val'>'test query'</span><span class='comma token'>,</span> <span class='string val'>'main delta'</span><span class='rparen token'>)</span>
  <span class='sphinx identifier id'>sphinx</span><span class='dot token'>.</span><span class='Query constant id'>Query</span><span class='lparen token'>(</span><span class='string val'>'test query'</span><span class='comma token'>,</span> <span class='string val'>'main;delta'</span><span class='rparen token'>)</span>
  <span class='sphinx identifier id'>sphinx</span><span class='dot token'>.</span><span class='Query constant id'>Query</span><span class='lparen token'>(</span><span class='string val'>'test query'</span><span class='comma token'>,</span> <span class='string val'>'main, delta'</span><span class='rparen token'>)</span>
</pre>
<p>
Index order matters. If identical IDs are found in two or more indexes,
weight and attribute values from the very last matching index will be used
for sorting and returning to client. Therefore, in the example above,
matches from &quot;delta&quot; index will always &quot;win&quot; over
matches from &quot;main&quot;.
</p>
<p>
Returns false on failure. Returns hash which has the following keys on
success:
</p>
<ul>
<li><tt>&#8216;matches&#8217;</tt> &#8212; array of hashes <tt>&amp;#8216;group&amp;#8217;, &amp;#8216;id&amp;#8217;</tt>, where
&#8216;id&#8217; is document_id.

</li>
<li><tt>&#8216;total&#8217;</tt> &#8212; total amount of matches retrieved
(upto SPH_MAX_MATCHES, see sphinx.h)

</li>
<li><tt>&#8216;total_found&#8217;</tt> &#8212; total amount of matching
documents in index

</li>
<li><tt>&#8216;time&#8217;</tt> &#8212; search time

</li>
<li><tt>&#8216;words&#8217;</tt> &#8212; hash which maps query terms (stemmed!)
to (&#8216;docs&#8217;, &#8216;hits&#8217;) hash

</li>
</ul>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 533</span>

<span class='def def kw'>def</span> <span class='Query constant id'>Query</span><span class='lparen token'>(</span><span class='query identifier id'>query</span><span class='comma token'>,</span> <span class='index identifier id'>index</span> <span class='assign token'>=</span> <span class='string val'>'*'</span><span class='comma token'>,</span> <span class='comment identifier id'>comment</span> <span class='assign token'>=</span> <span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='@reqs ivar id'>@reqs</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='rbrace token'>}</span>
  <span class='@reqs ivar id'>@reqs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='AddQuery constant id'>AddQuery</span><span class='lparen token'>(</span><span class='query identifier id'>query</span><span class='comma token'>,</span> <span class='index identifier id'>index</span><span class='comma token'>,</span> <span class='comment identifier id'>comment</span><span class='rparen token'>)</span>
  <span class='results identifier id'>results</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='RunQueries constant id'>RunQueries</span>
  
  <span class='comment val'># probably network error; error message should be already filled</span>
  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='unless unless_mod kw'>unless</span> <span class='results identifier id'>results</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span>
  
  <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='results identifier id'>results</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'error'</span><span class='rbrack token'>]</span>
  <span class='@warning ivar id'>@warning</span> <span class='assign token'>=</span> <span class='results identifier id'>results</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'warning'</span><span class='rbrack token'>]</span>
  
  <span class='return return kw'>return</span> <span class='false false kw'>false</span> <span class='if if_mod kw'>if</span> <span class='results identifier id'>results</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='string val'>'status'</span><span class='rbrack token'>]</span> <span class='eq op'>==</span> <span class='SEARCHD_ERROR constant id'>SEARCHD_ERROR</span>
  <span class='return return kw'>return</span> <span class='results identifier id'>results</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ResetFilters</h3>
</div><div id="ResetFilters-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ResetFilters</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Clear all filters (for multi-queries).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


489
490
491
492</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 489</span>

<span class='def def kw'>def</span> <span class='ResetFilters constant id'>ResetFilters</span>
  <span class='@filters ivar id'>@filters</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='@anchor ivar id'>@anchor</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ResetGroupBy</h3>
</div><div id="ResetGroupBy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ResetGroupBy</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Clear groupby settings (for multi-queries).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


495
496
497
498
499
500</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 495</span>

<span class='def def kw'>def</span> <span class='ResetGroupBy constant id'>ResetGroupBy</span>
  <span class='@groupby ivar id'>@groupby</span>       <span class='assign token'>=</span> <span class='string val'>''</span>
  <span class='@groupfunc ivar id'>@groupfunc</span>     <span class='assign token'>=</span> <span class='SPH_GROUPBY_DAY constant id'>SPH_GROUPBY_DAY</span>
  <span class='@groupsort ivar id'>@groupsort</span>     <span class='assign token'>=</span> <span class='string val'>'@group desc'</span>
  <span class='@groupdistinct ivar id'>@groupdistinct</span> <span class='assign token'>=</span> <span class='string val'>''</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>ResetOverrides</h3>
</div><div id="ResetOverrides-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>ResetOverrides</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Clear all attribute value overrides (for multi-queries).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


503
504
505</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 503</span>

<span class='def def kw'>def</span> <span class='ResetOverrides constant id'>ResetOverrides</span>
  <span class='@overrides ivar id'>@overrides</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>RunQueries</h3>
</div><div id="RunQueries-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>RunQueries</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Run queries batch.
</p>
<p>
Returns an array of result sets on success. Returns false on network IO
failure.
</p>
<p>
Each result set in returned array is a hash which containts the same keys
as the hash returned by <tt>Query</tt>, plus:
</p>
<ul>
<li><tt>&#8216;error&#8217;</tt> &#8212; search error for this query

</li>
<li><tt>&#8216;words&#8217;</tt> &#8212; hash which maps query terms (stemmed!)
to ( &quot;docs&quot;, &quot;hits&quot; ) hash

</li>
</ul>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756
757
758
759
760
761
762
763
764
765
766
767
768
769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 675</span>

<span class='def def kw'>def</span> <span class='RunQueries constant id'>RunQueries</span>
  <span class='if if kw'>if</span> <span class='@reqs ivar id'>@reqs</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='string val'>'No queries defined, issue AddQuery() first'</span>
    <span class='return return kw'>return</span> <span class='false false kw'>false</span>
  <span class='end end kw'>end</span>

  <span class='req identifier id'>req</span> <span class='assign token'>=</span> <span class='@reqs ivar id'>@reqs</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='nreqs identifier id'>nreqs</span> <span class='assign token'>=</span> <span class='@reqs ivar id'>@reqs</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='@reqs ivar id'>@reqs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='PerformRequest constant id'>PerformRequest</span><span class='lparen token'>(</span><span class='symbol val'>:search</span><span class='comma token'>,</span> <span class='req identifier id'>req</span><span class='comma token'>,</span> <span class='nreqs identifier id'>nreqs</span><span class='rparen token'>)</span>
 
  <span class='comment val'># parse response</span>
  <span class='begin begin kw'>begin</span>
    <span class='results identifier id'>results</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
    <span class='ires identifier id'>ires</span> <span class='assign token'>=</span> <span class='integer val'>0</span>
    <span class='while while kw'>while</span> <span class='ires identifier id'>ires</span> <span class='lt op'>&lt;</span> <span class='nreqs identifier id'>nreqs</span>
      <span class='ires identifier id'>ires</span> <span class='opasgn op'>+=</span> <span class='integer val'>1</span>
      <span class='result identifier id'>result</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
      
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'error'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>''</span>
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'warning'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>''</span>
      
      <span class='comment val'># extract status</span>
      <span class='status identifier id'>status</span> <span class='assign token'>=</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'status'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
      <span class='if if kw'>if</span> <span class='status identifier id'>status</span> <span class='neq op'>!=</span> <span class='SEARCHD_OK constant id'>SEARCHD_OK</span>
        <span class='message identifier id'>message</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_string identifier id'>get_string</span>
        <span class='if if kw'>if</span> <span class='status identifier id'>status</span> <span class='eq op'>==</span> <span class='SEARCHD_WARNING constant id'>SEARCHD_WARNING</span>
          <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'warning'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='message identifier id'>message</span>
        <span class='else else kw'>else</span>
          <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'error'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='message identifier id'>message</span>
          <span class='results identifier id'>results</span> <span class='lshft op'>&lt;&lt;</span> <span class='result identifier id'>result</span>
          <span class='next next kw'>next</span>
        <span class='end end kw'>end</span>
      <span class='end end kw'>end</span>
  
      <span class='comment val'># read schema</span>
      <span class='fields identifier id'>fields</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
      <span class='attrs identifier id'>attrs</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
      <span class='attrs_names_in_order identifier id'>attrs_names_in_order</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
      
      <span class='nfields identifier id'>nfields</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
      <span class='while while kw'>while</span> <span class='nfields identifier id'>nfields</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
        <span class='nfields identifier id'>nfields</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span>
        <span class='fields identifier id'>fields</span> <span class='lshft op'>&lt;&lt;</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_string identifier id'>get_string</span>
      <span class='end end kw'>end</span>
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'fields'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='fields identifier id'>fields</span>
  
      <span class='nattrs identifier id'>nattrs</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
      <span class='while while kw'>while</span> <span class='nattrs identifier id'>nattrs</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
        <span class='nattrs identifier id'>nattrs</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span>
        <span class='attr identifier id'>attr</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_string identifier id'>get_string</span>
        <span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
        <span class='attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='attr identifier id'>attr</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='type identifier id'>type</span>
        <span class='attrs_names_in_order identifier id'>attrs_names_in_order</span> <span class='lshft op'>&lt;&lt;</span> <span class='attr identifier id'>attr</span>
      <span class='end end kw'>end</span>
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'attrs'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='attrs identifier id'>attrs</span>
      
      <span class='comment val'># read match count</span>
      <span class='count identifier id'>count</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
      <span class='id64 identifier id'>id64</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
      
      <span class='comment val'># read matches</span>
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'matches'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
      <span class='while while kw'>while</span> <span class='count identifier id'>count</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
        <span class='count identifier id'>count</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span>
        
        <span class='if if kw'>if</span> <span class='id64 identifier id'>id64</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
          <span class='doc identifier id'>doc</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int64 identifier id'>get_int64</span>
          <span class='weight identifier id'>weight</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
        <span class='else else kw'>else</span>
          <span class='doc identifier id'>doc</span><span class='comma token'>,</span> <span class='weight identifier id'>weight</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_ints identifier id'>get_ints</span><span class='lparen token'>(</span><span class='integer val'>2</span><span class='rparen token'>)</span>
        <span class='end end kw'>end</span>
  
        <span class='r identifier id'>r</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span> <span class='comment val'># This is a single result put in the result['matches'] array</span>
        <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>'id'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='doc identifier id'>doc</span>
        <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>'weight'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='weight identifier id'>weight</span>
        <span class='attrs_names_in_order identifier id'>attrs_names_in_order</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='bitor op'>|</span>
          <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>'attrs'</span><span class='rbrack token'>]</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  
          <span class='case case kw'>case</span> <span class='attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='a identifier id'>a</span><span class='rbrack token'>]</span>
            <span class='when when kw'>when</span> <span class='SPH_ATTR_BIGINT constant id'>SPH_ATTR_BIGINT</span>
              <span class='comment val'># handle 64-bit ints</span>
              <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>'attrs'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='a identifier id'>a</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int64 identifier id'>get_int64</span>
            <span class='when when kw'>when</span> <span class='SPH_ATTR_FLOAT constant id'>SPH_ATTR_FLOAT</span>
              <span class='comment val'># handle floats</span>
              <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>'attrs'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='a identifier id'>a</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_float identifier id'>get_float</span>
            <span class='else else kw'>else</span>
              <span class='comment val'># handle everything else as unsigned ints</span>
              <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
              <span class='if if kw'>if</span> <span class='lparen token'>(</span><span class='attrs identifier id'>attrs</span><span class='lbrack token'>[</span><span class='a identifier id'>a</span><span class='rbrack token'>]</span> <span class='bitand op'>&amp;</span> <span class='SPH_ATTR_MULTI constant id'>SPH_ATTR_MULTI</span><span class='rparen token'>)</span> <span class='neq op'>!=</span> <span class='integer val'>0</span>
                <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>'attrs'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='a identifier id'>a</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
                <span class='float val'>1</span><span class='dot token'>.</span><span class='upto identifier id'>upto</span><span class='lparen token'>(</span><span class='val identifier id'>val</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
                  <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>'attrs'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='a identifier id'>a</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
                <span class='end end kw'>end</span>
              <span class='else else kw'>else</span>
                <span class='r identifier id'>r</span><span class='lbrack token'>[</span><span class='string val'>'attrs'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='a identifier id'>a</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
              <span class='end end kw'>end</span>
          <span class='end end kw'>end</span>
        <span class='end end kw'>end</span>
        <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'matches'</span><span class='rbrack token'>]</span> <span class='lshft op'>&lt;&lt;</span> <span class='r identifier id'>r</span>
      <span class='end end kw'>end</span>
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'total'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'total_found'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='msecs identifier id'>msecs</span><span class='comma token'>,</span> <span class='words identifier id'>words</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_ints identifier id'>get_ints</span><span class='lparen token'>(</span><span class='integer val'>4</span><span class='rparen token'>)</span>
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'time'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='string val'>'%.3f'</span> <span class='mod op'>%</span> <span class='lparen token'>(</span><span class='msecs identifier id'>msecs</span> <span class='div op'>/</span> <span class='float val'>1000.0</span><span class='rparen token'>)</span>
  
      <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'words'</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
      <span class='while while kw'>while</span> <span class='words identifier id'>words</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
        <span class='words identifier id'>words</span> <span class='opasgn op'>-=</span> <span class='integer val'>1</span>
        <span class='word identifier id'>word</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_string identifier id'>get_string</span>
        <span class='docs identifier id'>docs</span><span class='comma token'>,</span> <span class='hits identifier id'>hits</span> <span class='assign token'>=</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_ints identifier id'>get_ints</span><span class='lparen token'>(</span><span class='integer val'>2</span><span class='rparen token'>)</span>
        <span class='result identifier id'>result</span><span class='lbrack token'>[</span><span class='string val'>'words'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='word identifier id'>word</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'docs'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='docs identifier id'>docs</span><span class='comma token'>,</span> <span class='string val'>'hits'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='hits identifier id'>hits</span> <span class='rbrace token'>}</span>
      <span class='end end kw'>end</span>
      
      <span class='results identifier id'>results</span> <span class='lshft op'>&lt;&lt;</span> <span class='result identifier id'>result</span>
    <span class='end end kw'>end</span>
  <span class='comment val'>#rescue EOFError</span>
  <span class='comment val'>#  @error = 'incomplete reply'</span>
  <span class='comment val'>#  raise SphinxResponseError, @error</span>
  <span class='end end kw'>end</span>
  
  <span class='return return kw'>return</span> <span class='results identifier id'>results</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetFieldWeights</h3>
</div><div id="SetFieldWeights-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetFieldWeights</span><span class='args'>(weights)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Bind per-field weights by name.
</p>
<p>
Takes string (field name) to integer name (field weight) hash as an
argument.
</p>
<ul>
<li>Takes precedence over SetWeights().

</li>
<li>Unknown names will be silently ignored.

</li>
<li>Unbound fields will be silently given a weight of 1.

</li>
</ul>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


308
309
310
311
312
313
314
315
316</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 308</span>

<span class='def def kw'>def</span> <span class='SetFieldWeights constant id'>SetFieldWeights</span><span class='lparen token'>(</span><span class='weights identifier id'>weights</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='weights identifier id'>weights</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Hash constant id'>Hash</span> <span class='rbrace token'>}</span>
  <span class='weights identifier id'>weights</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='weight identifier id'>weight</span><span class='bitor op'>|</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='name identifier id'>name</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='weight identifier id'>weight</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>

  <span class='@fieldweights ivar id'>@fieldweights</span> <span class='assign token'>=</span> <span class='weights identifier id'>weights</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetFilter</h3>
</div><div id="SetFilter-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetFilter</span><span class='args'>(attribute, values, exclude = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set values filter.
</p>
<p>
Only match those records where <tt>attribute</tt> column values are in
specified set.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


345
346
347
348
349
350
351
352
353
354
355
356
357</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 345</span>

<span class='def def kw'>def</span> <span class='SetFilter constant id'>SetFilter</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='comma token'>,</span> <span class='exclude identifier id'>exclude</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attribute identifier id'>attribute</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Array constant id'>Array</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='notop op'>!</span><span class='values identifier id'>values</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='rbrace token'>}</span>

  <span class='if if kw'>if</span> <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Array constant id'>Array</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
    <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
      <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
    <span class='end end kw'>end</span>
  
    <span class='@filters ivar id'>@filters</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrace token'>{</span> <span class='string val'>'type'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='SPH_FILTER_VALUES constant id'>SPH_FILTER_VALUES</span><span class='comma token'>,</span> <span class='string val'>'attr'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='string val'>'exclude'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='exclude identifier id'>exclude</span><span class='comma token'>,</span> <span class='string val'>'values'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='values identifier id'>values</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetFilterFloatRange</h3>
</div><div id="SetFilterFloatRange-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetFilterFloatRange</span><span class='args'>(attribute, min, max, exclude = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set float range filter.
</p>
<p>
Only match those records where <tt>attribute</tt> column value is beetwen
<tt>min</tt> and <tt>max</tt> (including <tt>min</tt> and <tt>max</tt>).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


376
377
378
379
380
381
382
383</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 376</span>

<span class='def def kw'>def</span> <span class='SetFilterFloatRange constant id'>SetFilterFloatRange</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='exclude identifier id'>exclude</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attribute identifier id'>attribute</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='min identifier id'>min</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Float constant id'>Float</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='max identifier id'>max</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Float constant id'>Float</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='min identifier id'>min</span> <span class='leq op'>&lt;=</span> <span class='max identifier id'>max</span> <span class='rbrace token'>}</span>

  <span class='@filters ivar id'>@filters</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrace token'>{</span> <span class='string val'>'type'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='SPH_FILTER_FLOATRANGE constant id'>SPH_FILTER_FLOATRANGE</span><span class='comma token'>,</span> <span class='string val'>'attr'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='string val'>'exclude'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='exclude identifier id'>exclude</span><span class='comma token'>,</span> <span class='string val'>'min'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='string val'>'max'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='max identifier id'>max</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetFilterRange</h3>
</div><div id="SetFilterRange-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetFilterRange</span><span class='args'>(attribute, min, max, exclude = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set range filter.
</p>
<p>
Only match those records where <tt>attribute</tt> column value is beetwen
<tt>min</tt> and <tt>max</tt> (including <tt>min</tt> and <tt>max</tt>).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


363
364
365
366
367
368
369
370</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 363</span>

<span class='def def kw'>def</span> <span class='SetFilterRange constant id'>SetFilterRange</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='max identifier id'>max</span><span class='comma token'>,</span> <span class='exclude identifier id'>exclude</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attribute identifier id'>attribute</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='min identifier id'>min</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='or or kw'>or</span> <span class='min identifier id'>min</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Bignum constant id'>Bignum</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='max identifier id'>max</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='or or kw'>or</span> <span class='max identifier id'>max</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Bignum constant id'>Bignum</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='min identifier id'>min</span> <span class='leq op'>&lt;=</span> <span class='max identifier id'>max</span> <span class='rbrace token'>}</span>

  <span class='@filters ivar id'>@filters</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrace token'>{</span> <span class='string val'>'type'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='SPH_FILTER_RANGE constant id'>SPH_FILTER_RANGE</span><span class='comma token'>,</span> <span class='string val'>'attr'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='string val'>'exclude'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='exclude identifier id'>exclude</span><span class='comma token'>,</span> <span class='string val'>'min'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='string val'>'max'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='max identifier id'>max</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetGeoAnchor</h3>
</div><div id="SetGeoAnchor-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetGeoAnchor</span><span class='args'>(attrlat, attrlong, lat, long)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Setup anchor point for geosphere distance calculations.
</p>
<p>
Required to use <tt>@geodist</tt> in filters and sorting distance will be
computed to this point. Latitude and longitude must be in radians.
</p>
<ul>
<li><tt>attrlat</tt> &#8212; is the name of latitude attribute

</li>
<li><tt>attrlong</tt> &#8212; is the name of longitude attribute

</li>
<li><tt>lat</tt> &#8212; is anchor point latitude, in radians

</li>
<li><tt>long</tt> &#8212; is anchor point longitude, in radians

</li>
</ul>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


395
396
397
398
399
400
401
402</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 395</span>

<span class='def def kw'>def</span> <span class='SetGeoAnchor constant id'>SetGeoAnchor</span><span class='lparen token'>(</span><span class='attrlat identifier id'>attrlat</span><span class='comma token'>,</span> <span class='attrlong identifier id'>attrlong</span><span class='comma token'>,</span> <span class='lat identifier id'>lat</span><span class='comma token'>,</span> <span class='long identifier id'>long</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attrlat identifier id'>attrlat</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attrlong identifier id'>attrlong</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='lat identifier id'>lat</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Float constant id'>Float</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='long identifier id'>long</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Float constant id'>Float</span> <span class='rbrace token'>}</span>

  <span class='@anchor ivar id'>@anchor</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'attrlat'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attrlat identifier id'>attrlat</span><span class='comma token'>,</span> <span class='string val'>'attrlong'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attrlong identifier id'>attrlong</span><span class='comma token'>,</span> <span class='string val'>'lat'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lat identifier id'>lat</span><span class='comma token'>,</span> <span class='string val'>'long'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='long identifier id'>long</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetGroupBy</h3>
</div><div id="SetGroupBy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetGroupBy</span><span class='args'>(attribute, func, groupsort = '@group desc')</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set grouping attribute and function.
</p>
<p>
In grouping mode, all matches are assigned to different groups based on
grouping function value.
</p>
<p>
Each group keeps track of the total match count, and the best match (in
this group) according to current sorting function.
</p>
<p>
The final result set contains one best match per group, with grouping
function value and matches count attached.
</p>
<p>
Groups in result set could be sorted by any sorting clause, including both
document attributes and the following special internal Sphinx attributes:
</p>
<ul>
<li>@id - match document ID;

</li>
<li>@weight, @rank, @relevance - match weight;

</li>
<li>@group - groupby function value;

</li>
<li>@count - amount of matches in group.

</li>
</ul>
<p>
the default mode is to sort by groupby value in descending order, ie. by
&#8217;@group desc&#8217;.
</p>
<p>
&#8216;total_found&#8217; would contain total amount of matching groups
over the whole index.
</p>
<p>
WARNING: grouping is done in fixed memory and thus its results are only
approximate; so there might be more groups reported in total_found than
actually present. @count might also be underestimated.
</p>
<p>
For example, if sorting by relevance and grouping by &quot;published&quot;
attribute with SPH_GROUPBY_DAY function, then the result set will contain
one most relevant match per each day when there were any matches published,
with day number and per-day match count attached, and sorted by day number
in descending order (ie. recent days first).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


440
441
442
443
444
445
446
447
448
449
450
451
452
453</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 440</span>

<span class='def def kw'>def</span> <span class='SetGroupBy constant id'>SetGroupBy</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='comma token'>,</span> <span class='func identifier id'>func</span><span class='comma token'>,</span> <span class='groupsort identifier id'>groupsort</span> <span class='assign token'>=</span> <span class='string val'>'@group desc'</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attribute identifier id'>attribute</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='groupsort identifier id'>groupsort</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='func identifier id'>func</span> <span class='eq op'>==</span> <span class='SPH_GROUPBY_DAY constant id'>SPH_GROUPBY_DAY</span> \
        <span class='orop op'>||</span> <span class='func identifier id'>func</span> <span class='eq op'>==</span> <span class='SPH_GROUPBY_WEEK constant id'>SPH_GROUPBY_WEEK</span> \
        <span class='orop op'>||</span> <span class='func identifier id'>func</span> <span class='eq op'>==</span> <span class='SPH_GROUPBY_MONTH constant id'>SPH_GROUPBY_MONTH</span> \
        <span class='orop op'>||</span> <span class='func identifier id'>func</span> <span class='eq op'>==</span> <span class='SPH_GROUPBY_YEAR constant id'>SPH_GROUPBY_YEAR</span> \
        <span class='orop op'>||</span> <span class='func identifier id'>func</span> <span class='eq op'>==</span> <span class='SPH_GROUPBY_ATTR constant id'>SPH_GROUPBY_ATTR</span> \
        <span class='orop op'>||</span> <span class='func identifier id'>func</span> <span class='eq op'>==</span> <span class='SPH_GROUPBY_ATTRPAIR constant id'>SPH_GROUPBY_ATTRPAIR</span> <span class='rbrace token'>}</span>

  <span class='@groupby ivar id'>@groupby</span> <span class='assign token'>=</span> <span class='attribute identifier id'>attribute</span>
  <span class='@groupfunc ivar id'>@groupfunc</span> <span class='assign token'>=</span> <span class='func identifier id'>func</span>
  <span class='@groupsort ivar id'>@groupsort</span> <span class='assign token'>=</span> <span class='groupsort identifier id'>groupsort</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetGroupDistinct</h3>
</div><div id="SetGroupDistinct-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetGroupDistinct</span><span class='args'>(attribute)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set count-distinct attribute for group-by queries.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


456
457
458
459</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 456</span>

<span class='def def kw'>def</span> <span class='SetGroupDistinct constant id'>SetGroupDistinct</span><span class='lparen token'>(</span><span class='attribute identifier id'>attribute</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attribute identifier id'>attribute</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='@groupdistinct ivar id'>@groupdistinct</span> <span class='assign token'>=</span> <span class='attribute identifier id'>attribute</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetIDRange</h3>
</div><div id="SetIDRange-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetIDRange</span><span class='args'>(min, max)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set IDs range to match.
</p>
<p>
Only match records if document ID is beetwen <tt>min_id</tt> and
<tt>max_id</tt> (inclusive).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


332
333
334
335
336
337
338
339</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 332</span>

<span class='def def kw'>def</span> <span class='SetIDRange constant id'>SetIDRange</span><span class='lparen token'>(</span><span class='min identifier id'>min</span><span class='comma token'>,</span> <span class='max identifier id'>max</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='min identifier id'>min</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Fixnum constant id'>Fixnum</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='min identifier id'>min</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Bignum constant id'>Bignum</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='max identifier id'>max</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Fixnum constant id'>Fixnum</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='max identifier id'>max</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='Bignum constant id'>Bignum</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='min identifier id'>min</span> <span class='leq op'>&lt;=</span> <span class='max identifier id'>max</span> <span class='rbrace token'>}</span>

  <span class='@min_id ivar id'>@min_id</span> <span class='assign token'>=</span> <span class='min identifier id'>min</span>
  <span class='@max_id ivar id'>@max_id</span> <span class='assign token'>=</span> <span class='max identifier id'>max</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetIndexWeights</h3>
</div><div id="SetIndexWeights-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetIndexWeights</span><span class='args'>(weights)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Bind per-index weights by name.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


319
320
321
322
323
324
325
326
327</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 319</span>

<span class='def def kw'>def</span> <span class='SetIndexWeights constant id'>SetIndexWeights</span><span class='lparen token'>(</span><span class='weights identifier id'>weights</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='weights identifier id'>weights</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Hash constant id'>Hash</span> <span class='rbrace token'>}</span>
  <span class='weights identifier id'>weights</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='index identifier id'>index</span><span class='comma token'>,</span> <span class='weight identifier id'>weight</span><span class='bitor op'>|</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='index identifier id'>index</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='weight identifier id'>weight</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  
  <span class='@indexweights ivar id'>@indexweights</span> <span class='assign token'>=</span> <span class='weights identifier id'>weights</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetLimits</h3>
</div><div id="SetLimits-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetLimits</span><span class='args'>(offset, limit, max = 0, cutoff = 0)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set offset and count into result set, and optionally set max-matches and
cutoff limits.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


229
230
231
232
233
234
235
236
237
238
239
240
241</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 229</span>

<span class='def def kw'>def</span> <span class='SetLimits constant id'>SetLimits</span><span class='lparen token'>(</span><span class='offset identifier id'>offset</span><span class='comma token'>,</span> <span class='limit identifier id'>limit</span><span class='comma token'>,</span> <span class='max identifier id'>max</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='comma token'>,</span> <span class='cutoff identifier id'>cutoff</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='offset identifier id'>offset</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='limit identifier id'>limit</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='max identifier id'>max</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='offset identifier id'>offset</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='limit identifier id'>limit</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='max identifier id'>max</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span> <span class='rbrace token'>}</span>

  <span class='@offset ivar id'>@offset</span> <span class='assign token'>=</span> <span class='offset identifier id'>offset</span>
  <span class='@limit ivar id'>@limit</span> <span class='assign token'>=</span> <span class='limit identifier id'>limit</span>
  <span class='@maxmatches ivar id'>@maxmatches</span> <span class='assign token'>=</span> <span class='max identifier id'>max</span> <span class='if if_mod kw'>if</span> <span class='max identifier id'>max</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
  <span class='@cutoff ivar id'>@cutoff</span> <span class='assign token'>=</span> <span class='cutoff identifier id'>cutoff</span> <span class='if if_mod kw'>if</span> <span class='cutoff identifier id'>cutoff</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetMatchMode</h3>
</div><div id="SetMatchMode-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetMatchMode</span><span class='args'>(mode)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set matching mode.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


252
253
254
255
256
257
258
259
260
261
262</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 252</span>

<span class='def def kw'>def</span> <span class='SetMatchMode constant id'>SetMatchMode</span><span class='lparen token'>(</span><span class='mode identifier id'>mode</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_MATCH_ALL constant id'>SPH_MATCH_ALL</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_MATCH_ANY constant id'>SPH_MATCH_ANY</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_MATCH_PHRASE constant id'>SPH_MATCH_PHRASE</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_MATCH_BOOLEAN constant id'>SPH_MATCH_BOOLEAN</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_MATCH_EXTENDED constant id'>SPH_MATCH_EXTENDED</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_MATCH_FULLSCAN constant id'>SPH_MATCH_FULLSCAN</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_MATCH_EXTENDED2 constant id'>SPH_MATCH_EXTENDED2</span> <span class='rbrace token'>}</span>

  <span class='@mode ivar id'>@mode</span> <span class='assign token'>=</span> <span class='mode identifier id'>mode</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetMaxQueryTime</h3>
</div><div id="SetMaxQueryTime-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetMaxQueryTime</span><span class='args'>(max)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set maximum query time, in milliseconds, per-index, integer, 0 means
&quot;do not limit&quot;
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


245
246
247
248
249</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 245</span>

<span class='def def kw'>def</span> <span class='SetMaxQueryTime constant id'>SetMaxQueryTime</span><span class='lparen token'>(</span><span class='max identifier id'>max</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='max identifier id'>max</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='max identifier id'>max</span> <span class='geq op'>&gt;=</span> <span class='integer val'>0</span> <span class='rbrace token'>}</span>
  <span class='@maxquerytime ivar id'>@maxquerytime</span> <span class='assign token'>=</span> <span class='max identifier id'>max</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetOverride</h3>
</div><div id="SetOverride-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetOverride</span><span class='args'>(attrname, attrtype, values)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set attribute values override
</p>
<p>
There can be only one override per attribute. <tt>values</tt> must be a
hash that maps document IDs to attribute values.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


474
475
476
477
478
479
480</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 474</span>

<span class='def def kw'>def</span> <span class='SetOverride constant id'>SetOverride</span><span class='lparen token'>(</span><span class='attrname identifier id'>attrname</span><span class='comma token'>,</span> <span class='attrtype identifier id'>attrtype</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attrname identifier id'>attrname</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='lbrack token'>[</span><span class='SPH_ATTR_INTEGER constant id'>SPH_ATTR_INTEGER</span><span class='comma token'>,</span> <span class='SPH_ATTR_TIMESTAMP constant id'>SPH_ATTR_TIMESTAMP</span><span class='comma token'>,</span> <span class='SPH_ATTR_BOOL constant id'>SPH_ATTR_BOOL</span><span class='comma token'>,</span> <span class='SPH_ATTR_FLOAT constant id'>SPH_ATTR_FLOAT</span><span class='comma token'>,</span> <span class='SPH_ATTR_BIGINT constant id'>SPH_ATTR_BIGINT</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='attrtype identifier id'>attrtype</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Hash constant id'>Hash</span> <span class='rbrace token'>}</span>

  <span class='@overrides ivar id'>@overrides</span> <span class='lshft op'>&lt;&lt;</span> <span class='lbrace token'>{</span> <span class='string val'>'attr'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attrname identifier id'>attrname</span><span class='comma token'>,</span> <span class='string val'>'type'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='attrtype identifier id'>attrtype</span><span class='comma token'>,</span> <span class='string val'>'values'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='values identifier id'>values</span> <span class='rbrace token'>}</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetRankingMode</h3>
</div><div id="SetRankingMode-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetRankingMode</span><span class='args'>(ranker)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set ranking mode.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


265
266
267
268
269
270
271
272
273</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 265</span>

<span class='def def kw'>def</span> <span class='SetRankingMode constant id'>SetRankingMode</span><span class='lparen token'>(</span><span class='ranker identifier id'>ranker</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='ranker identifier id'>ranker</span> <span class='eq op'>==</span> <span class='SPH_RANK_PROXIMITY_BM25 constant id'>SPH_RANK_PROXIMITY_BM25</span> \
        <span class='orop op'>||</span> <span class='ranker identifier id'>ranker</span> <span class='eq op'>==</span> <span class='SPH_RANK_BM25 constant id'>SPH_RANK_BM25</span> \
        <span class='orop op'>||</span> <span class='ranker identifier id'>ranker</span> <span class='eq op'>==</span> <span class='SPH_RANK_NONE constant id'>SPH_RANK_NONE</span> \
        <span class='orop op'>||</span> <span class='ranker identifier id'>ranker</span> <span class='eq op'>==</span> <span class='SPH_RANK_WORDCOUNT constant id'>SPH_RANK_WORDCOUNT</span> \
        <span class='orop op'>||</span> <span class='ranker identifier id'>ranker</span> <span class='eq op'>==</span> <span class='SPH_RANK_PROXIMITY constant id'>SPH_RANK_PROXIMITY</span> <span class='rbrace token'>}</span>

  <span class='@ranker ivar id'>@ranker</span> <span class='assign token'>=</span> <span class='ranker identifier id'>ranker</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetRetries</h3>
</div><div id="SetRetries-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetRetries</span><span class='args'>(count, delay = 0)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set distributed retries count and delay.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


462
463
464
465
466
467
468</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 462</span>

<span class='def def kw'>def</span> <span class='SetRetries constant id'>SetRetries</span><span class='lparen token'>(</span><span class='count identifier id'>count</span><span class='comma token'>,</span> <span class='delay identifier id'>delay</span> <span class='assign token'>=</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='count identifier id'>count</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='delay identifier id'>delay</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
  
  <span class='@retrycount ivar id'>@retrycount</span> <span class='assign token'>=</span> <span class='count identifier id'>count</span>
  <span class='@retrydelay ivar id'>@retrydelay</span> <span class='assign token'>=</span> <span class='delay identifier id'>delay</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetSelect</h3>
</div><div id="SetSelect-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetSelect</span><span class='args'>(select)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set select-list (attributes or expressions), SQL-like syntax.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


483
484
485
486</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 483</span>

<span class='def def kw'>def</span> <span class='SetSelect constant id'>SetSelect</span><span class='lparen token'>(</span><span class='select identifier id'>select</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='select identifier id'>select</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='@select ivar id'>@select</span> <span class='assign token'>=</span> <span class='select identifier id'>select</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetServer</h3>
</div><div id="SetServer-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetServer</span><span class='args'>(host, port)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set searchd host name (string) and port (integer).
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


219
220
221
222
223
224
225</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 219</span>

<span class='def def kw'>def</span> <span class='SetServer constant id'>SetServer</span><span class='lparen token'>(</span><span class='host identifier id'>host</span><span class='comma token'>,</span> <span class='port identifier id'>port</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='host identifier id'>host</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='port identifier id'>port</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>

  <span class='@host ivar id'>@host</span> <span class='assign token'>=</span> <span class='host identifier id'>host</span>
  <span class='@port ivar id'>@port</span> <span class='assign token'>=</span> <span class='port identifier id'>port</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetSortMode</h3>
</div><div id="SetSortMode-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetSortMode</span><span class='args'>(mode, sortby = '')</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Set matches sorting mode.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


276
277
278
279
280
281
282
283
284
285
286
287
288</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 276</span>

<span class='def def kw'>def</span> <span class='SetSortMode constant id'>SetSortMode</span><span class='lparen token'>(</span><span class='mode identifier id'>mode</span><span class='comma token'>,</span> <span class='sortby identifier id'>sortby</span> <span class='assign token'>=</span> <span class='string val'>''</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_SORT_RELEVANCE constant id'>SPH_SORT_RELEVANCE</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_SORT_ATTR_DESC constant id'>SPH_SORT_ATTR_DESC</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_SORT_ATTR_ASC constant id'>SPH_SORT_ATTR_ASC</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_SORT_TIME_SEGMENTS constant id'>SPH_SORT_TIME_SEGMENTS</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_SORT_EXTENDED constant id'>SPH_SORT_EXTENDED</span> \
        <span class='orop op'>||</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_SORT_EXPR constant id'>SPH_SORT_EXPR</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='sortby identifier id'>sortby</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='mode identifier id'>mode</span> <span class='eq op'>==</span> <span class='SPH_SORT_RELEVANCE constant id'>SPH_SORT_RELEVANCE</span> <span class='orop op'>||</span> <span class='notop op'>!</span><span class='sortby identifier id'>sortby</span><span class='dot token'>.</span><span class='empty? fid id'>empty?</span> <span class='rbrace token'>}</span>

  <span class='@sort ivar id'>@sort</span> <span class='assign token'>=</span> <span class='mode identifier id'>mode</span>
  <span class='@sortby ivar id'>@sortby</span> <span class='assign token'>=</span> <span class='sortby identifier id'>sortby</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>SetWeights</h3>
</div><div id="SetWeights-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>SetWeights</span><span class='args'>(weights)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Bind per-field weights by order.
</p>
<p>
DEPRECATED; use SetFieldWeights() instead.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


293
294
295
296
297
298
299
300</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 293</span>

<span class='def def kw'>def</span> <span class='SetWeights constant id'>SetWeights</span><span class='lparen token'>(</span><span class='weights identifier id'>weights</span><span class='rparen token'>)</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='weights identifier id'>weights</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Array constant id'>Array</span> <span class='rbrace token'>}</span>
  <span class='weights identifier id'>weights</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='weight identifier id'>weight</span><span class='bitor op'>|</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='weight identifier id'>weight</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>

  <span class='@weights ivar id'>@weights</span> <span class='assign token'>=</span> <span class='weights identifier id'>weights</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>UpdateAttributes</h3>
</div><div id="UpdateAttributes-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>UpdateAttributes</span><span class='args'>(index, attrs, values, mva = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Batch update given attributes in given rows in given indexes.
</p>
<ul>
<li><tt>index</tt> is a name of the index to be updated

</li>
<li><tt>attrs</tt> is an array of attribute name strings.

</li>
<li><tt>values</tt> is a hash where key is document id, and value is an array
of

</li>
<li><tt>mva</tt> identifies whether update MVA

</li>
</ul>
<p>
new attribute values
</p>
<p>
Returns number of actually updated documents (0 or more) on success.
Returns -1 on failure.
</p>
<p>
Usage example:
</p>
<pre class="code">
   <span class='sphinx identifier id'>sphinx</span><span class='dot token'>.</span><span class='UpdateAttributes constant id'>UpdateAttributes</span><span class='lparen token'>(</span><span class='string val'>'test1'</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='string val'>'group_id'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='lbrace token'>{</span> <span class='integer val'>1</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='integer val'>456</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span><span class='rparen token'>)</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/sphinx/client.rb', line 931</span>

<span class='def def kw'>def</span> <span class='UpdateAttributes constant id'>UpdateAttributes</span><span class='lparen token'>(</span><span class='index identifier id'>index</span><span class='comma token'>,</span> <span class='attrs identifier id'>attrs</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='comma token'>,</span> <span class='mva identifier id'>mva</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='comment val'># verify everything</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='index identifier id'>index</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='mva identifier id'>mva</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='TrueClass constant id'>TrueClass</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='mva identifier id'>mva</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span><span class='lparen token'>(</span><span class='FalseClass constant id'>FalseClass</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Array constant id'>Array</span> <span class='rbrace token'>}</span>
  <span class='attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='attr identifier id'>attr</span><span class='bitor op'>|</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='attr identifier id'>attr</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='String constant id'>String</span> <span class='rbrace token'>}</span>
  <span class='end end kw'>end</span>
  
  <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Hash constant id'>Hash</span> <span class='rbrace token'>}</span>
  <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='id identifier id'>id</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Array constant id'>Array</span> <span class='rbrace token'>}</span>
    <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='eq op'>==</span> <span class='attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='rbrace token'>}</span>
    <span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span>
      <span class='if if kw'>if</span> <span class='mva identifier id'>mva</span>
        <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Array constant id'>Array</span> <span class='rbrace token'>}</span>
        <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='vv identifier id'>vv</span><span class='bitor op'>|</span> <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='vv identifier id'>vv</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span> <span class='rbrace token'>}</span>
      <span class='else else kw'>else</span>
        <span class='assert identifier id'>assert</span> <span class='lbrace token'>{</span> <span class='v identifier id'>v</span><span class='dot token'>.</span><span class='instance_of? fid id'>instance_of?</span> <span class='Fixnum constant id'>Fixnum</span> <span class='rbrace token'>}</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='comment val'># build request</span>
  <span class='request identifier id'>request</span> <span class='assign token'>=</span> <span class='Request constant id'>Request</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='index identifier id'>index</span>
  
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='for for kw'>for</span> <span class='attr identifier id'>attr</span> <span class='in in kw'>in</span> <span class='attrs identifier id'>attrs</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_string identifier id'>put_string</span> <span class='attr identifier id'>attr</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='mva identifier id'>mva</span> <span class='question op'>?</span> <span class='integer val'>1</span> <span class='colon op'>:</span> <span class='integer val'>0</span>
  <span class='end end kw'>end</span>
  
  <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span> <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='length identifier id'>length</span>
  <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='id identifier id'>id</span><span class='comma token'>,</span> <span class='entry identifier id'>entry</span><span class='bitor op'>|</span>
    <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int64 identifier id'>put_int64</span> <span class='id identifier id'>id</span>
    <span class='if if kw'>if</span> <span class='mva identifier id'>mva</span>
      <span class='entry identifier id'>entry</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='v identifier id'>v</span><span class='bitor op'>|</span> <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int_array identifier id'>put_int_array</span> <span class='v identifier id'>v</span> <span class='rbrace token'>}</span>
    <span class='else else kw'>else</span>
      <span class='request identifier id'>request</span><span class='dot token'>.</span><span class='put_int identifier id'>put_int</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='entry identifier id'>entry</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
  <span class='response identifier id'>response</span> <span class='assign token'>=</span> <span class='PerformRequest constant id'>PerformRequest</span><span class='lparen token'>(</span><span class='symbol val'>:update</span><span class='comma token'>,</span> <span class='request identifier id'>request</span><span class='rparen token'>)</span>
  
  <span class='comment val'># parse response</span>
  <span class='begin begin kw'>begin</span>
    <span class='return return kw'>return</span> <span class='response identifier id'>response</span><span class='dot token'>.</span><span class='get_int identifier id'>get_int</span>
  <span class='rescue rescue kw'>rescue</span> <span class='EOFError constant id'>EOFError</span>
    <span class='@error ivar id'>@error</span> <span class='assign token'>=</span> <span class='string val'>'incomplete reply'</span>
    <span class='raise identifier id'>raise</span> <span class='SphinxResponseError constant id'>SphinxResponseError</span><span class='comma token'>,</span> <span class='@error ivar id'>@error</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>