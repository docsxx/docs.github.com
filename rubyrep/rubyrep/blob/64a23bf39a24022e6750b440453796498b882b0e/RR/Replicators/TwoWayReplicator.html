<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>rubyrep's rubyrep - Class: RR::Replicators::TwoWayReplicator - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/rubyrep/commits/rubyrep/master" rel="alternate" title="Recent Commits to rubyrep:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("rubyrep", "rubyrep", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("rubyrep", "rubyrep", "64a23bf39a24022e6750b440453796498b882b0e", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/rubyrep/rubyrep/tree/">Source</a></li>
            <li class=""><a href="http://github.com/rubyrep/rubyrep/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/rubyrep/rubyrep/network">Network</a></li>            
            <li class=""><a href="http://github.com/rubyrep/rubyrep/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/rubyrep/rubyrep">Wiki</a></li>
            <li class=""><a href="http://github.com/rubyrep/rubyrep/graphs">Graphs</a></li>                    
            <li class="active"><a href="/rubyrep/rubyrep">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/rubyrep">rubyrep</a> / <b><a href="http://github.com/rubyrep/rubyrep/tree">rubyrep</a></b>        
                <a id="namespaces_button" rel="rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class RR_Replicators_TwoWayReplicator">
  <h1>Class: RR::Replicators::TwoWayReplicator</h1>
  <div class="section docstring">
  <p>
This replicator implements a two way replication. Options:
</p>
<ul>
<li>:<tt>left_change_handling</tt>, :<tt>right_change_handling</tt>: Handling
of records that were changed only in the named database. Can be any of the
following:

<ul>
<li>:<tt>ignore</tt>: No action.

</li>
<li>:<tt>replicate</tt>: Updates other database accordingly. <b>Default</b>
<b>Setting</b>

</li>
<li><tt>Proc</tt> object: If a Proc object is given, it is responsible for
dealing with the record. Called with the following parameters:

<ul>
<li>replication_helper: The current ReplicationHelper instance.

</li>
<li>difference: A ReplicationDifference instance describing the change

</li>
</ul>
</li>
</ul>
</li>
<li>:<tt>replication_conflict_handling</tt>: Handling of conflicting record
changes. Can be any of the following:

<ul>
<li>:<tt>ignore</tt>: No action. <b>Default</b> <b>Setting</b>

</li>
<li>:<tt>left_wins</tt>: The right database is updated accordingly.

</li>
<li>:<tt>right_wins</tt>: The left database is updated accordingly.

</li>
<li>:<tt>later_wins</tt>: The more recent change is replicated. (If both
changes have same age: left change is replicated)

</li>
<li>:<tt>earlier_wins</tt>: The less recent change is replicated. (If both
records have same age: left change is replicated)

</li>
<li><tt>Proc</tt> object: If a Proc object is given, it is responsible for
dealing with the record. Called with the following parameters:

<ul>
<li>replication_helper: The current ReplicationHelper instance.

</li>
<li>difference: A ReplicationDifference instance describing the changes

</li>
</ul>
</li>
</ul>
</li>
<li>:<tt>logged_replication_events</tt>: Specifies which types of replications
are logged. Is either a single value or an array of multiple ones. Default:
[:ignored_conflicts] Possible values:

<ul>
<li>:<tt>ignored_changes</tt>: log ignored (but not replicated) non-conflict
changes

</li>
<li>:<tt>all_changes</tt>: log all non-conflict changes

</li>
<li>:<tt>ignored_conflicts</tt>: log ignored (but not replicated) conflicts

</li>
<li>:<tt>all_conflicts</tt>: log all conflicts

</li>
</ul>
</li>
</ul>
<p>
Example of using a Proc object for custom behaviour:
</p>
<pre class="code">
  <span class='lambda identifier id'>lambda</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='rep_helper identifier id'>rep_helper</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='bitor op'>|</span>
    <span class='comment val'># if specified as replication_conflict_handling option, logs all</span>
    <span class='comment val'># conflicts to a text file</span>
    <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>'/var/log/rubyrep_conflict_log'</span><span class='comma token'>,</span> <span class='string val'>'a'</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span>
      <span class='f identifier id'>f</span><span class='dot token'>.</span><span class='puts identifier id'>puts</span> <span class='string val'>&quot;\#{Time.now}: conflict\n* in table \#{diff.changes[:left].table}\n* for record '\#{diff.changes[:left].key}'\n* change type in left db: '\#{diff.changes[:left].type}'\n* change type in right db: '\#{diff.changes[:right].type}'\n&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">rep_helper</td>
          <td class="readwrite">
            [<span id='rep_helper-instance_method'>R</span><span id='rep_helper=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
The current ReplicationHelper object.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="CONFLICT_STATE_MATRIX-constant">CONFLICT_STATE_MATRIX</dt>
      <dd>{
  :insert =&gt; {:insert =&gt; :update, :update =&gt; :update, :delete =&gt; :insert},
  :update =&gt; {:insert =&gt; :update, :update =&gt; :update, :delete =&gt; :insert},
  :delete =&gt; {:insert =&gt; :delete, :update =&gt; :delete, :delete =&gt; :delete}
}</dd>
    
      <dt id="DEFAULT_OPTIONS-constant">DEFAULT_OPTIONS</dt>
      <dd>{
  :left_change_handling =&gt; :replicate,
  :right_change_handling =&gt; :replicate,
  :replication_conflict_handling =&gt; :ignore,
  :logged_replication_events =&gt; [:ignored_conflicts],
}</dd>
    
      <dt id="MAX_REPLICATION_ATTEMPTS-constant">MAX_REPLICATION_ATTEMPTS</dt>
      <dd>2</dd>
    
      <dt id="OTHER_SIDE-constant">OTHER_SIDE</dt>
      <dd>{
  :left =&gt; :right,
  :right =&gt; :left
}</dd>
    
  </dl>
</div>

</div><div class="section constructor">
<h2>Constructor</h2>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>initialize</span><span class='args'>(rep_helper)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Initializes the TwoWayReplicator Raises an ArgumentError if any of the
replication options is invalid.
</p>
<p>
Parameters:
</p>
<ul>
<li>rep_helper: The ReplicationHelper object providing information and utility
functions.

</li>
</ul>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 129</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L129">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">129
130
131
132
133
134
135</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='rep_helper identifier id'>rep_helper</span><span class='rparen token'>)</span>
  <span class='self self kw'>self</span><span class='dot token'>.</span><span class='rep_helper identifier id'>rep_helper</span> <span class='assign token'>=</span> <span class='rep_helper identifier id'>rep_helper</span>

  <span class='validate_change_handling_options identifier id'>validate_change_handling_options</span>
  <span class='validate_conflict_handling_options identifier id'>validate_conflict_handling_options</span>
  <span class='validate_logging_options identifier id'>validate_logging_options</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attempt_delete-instance_method">#attempt_delete</span><span class='args'>(source_db, diff, target_key)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Attempts to delete the source record from the target database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attempt_insert-instance_method">#attempt_insert</span><span class='args'>(source_db, diff, remaining_attempts, source_key)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Attempts to read the specified record from the source database and insert
it into the target database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#attempt_update-instance_method">#attempt_update</span><span class='args'>(source_db, diff, remaining_attempts, source_key, target_key)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Attempts to read the specified record from the source database and update
the specified record in the target database.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#clear_conflict-instance_method">#clear_conflict</span><span class='args'>(source_db, diff, remaining_attempts)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Helper function that clears a conflict by taking the change from the
specified winning database and updating the other database accordingly.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#log_replication_outcome-instance_method">#log_replication_outcome</span><span class='args'>(winner, diff)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Logs replication of the specified difference as per configured
:<tt>replication_conflict_logging</tt> / :<tt>left_change_logging</tt> /
:<tt>right_change_logging</tt> options.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#options_for_table-instance_method">#options_for_table</span><span class='args'>(table)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the options for the specified table name.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#replicate_difference-instance_method">#replicate_difference</span><span class='args'>(diff, remaining_attempts = MAX_REPLICATION_ATTEMPTS, previous_failure_description = nil)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Called to replicate the specified difference.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#validate_change_handling_options-instance_method">#validate_change_handling_options</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Verifies if the :<tt>left_change_handling</tt> /
:<tt>right_change_handling</tt> options are valid.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#validate_conflict_handling_options-instance_method">#validate_conflict_handling_options</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Verifies if the given :<tt>replication_conflict_handling</tt> options are
valid.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#validate_logging_options-instance_method">#validate_logging_options</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Verifies if the given :<tt>replication_logging</tt> option /options is /
are valid.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#verify_option-instance_method">#verify_option</span><span class='args'>(table_spec, valid_option_values, option_key, option_value)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Checks if an option is configured correctly.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>attempt_delete</h3>
</div><div id="attempt_delete-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attempt_delete</span><span class='args'>(source_db, diff, target_key)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Attempts to delete the source record from the target database.
</p>
<ol>
<li type="A">g. if +source_db is :<tt>left</tt>, then the record is deleted in database

</li>
</ol>
<p>
:<tt>right</tt>.
</p>
<ul>
<li><tt>source_db</tt>: either :<tt>left</tt> or :<tt>right</tt> - source
database of replication

</li>
<li><tt>diff</tt>: the current ReplicationDifference instance

</li>
<li><tt>target_key</tt>: a column_name =&gt; value hash identifying the source
record

</li>
</ul>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 277</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L277">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">277
278
279
280
281
282
283</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attempt_delete identifier id'>attempt_delete</span><span class='lparen token'>(</span><span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='target_key identifier id'>target_key</span><span class='rparen token'>)</span>
  <span class='change identifier id'>change</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='source_db identifier id'>source_db</span><span class='rbrack token'>]</span>
  <span class='target_db identifier id'>target_db</span> <span class='assign token'>=</span> <span class='OTHER_SIDE constant id'>OTHER_SIDE</span><span class='lbrack token'>[</span><span class='source_db identifier id'>source_db</span><span class='rbrack token'>]</span>
  <span class='target_table identifier id'>target_table</span> <span class='assign token'>=</span> <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='corresponding_table identifier id'>corresponding_table</span><span class='lparen token'>(</span><span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='change identifier id'>change</span><span class='dot token'>.</span><span class='table identifier id'>table</span><span class='rparen token'>)</span>
  <span class='log_replication_outcome identifier id'>log_replication_outcome</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span>
  <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='delete_record identifier id'>delete_record</span> <span class='target_db identifier id'>target_db</span><span class='comma token'>,</span> <span class='target_table identifier id'>target_table</span><span class='comma token'>,</span> <span class='target_key identifier id'>target_key</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attempt_insert</h3>
</div><div id="attempt_insert-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attempt_insert</span><span class='args'>(source_db, diff, remaining_attempts, source_key)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Attempts to read the specified record from the source database and insert
it into the target database. Retries if insert fails due to missing source
or suddenly existing target record.
</p>
<ul>
<li><tt>source_db</tt>: either :<tt>left</tt> or :<tt>right</tt> - source
database of replication

</li>
<li><tt>diff</tt>: the current ReplicationDifference instance

</li>
<li><tt>remaining_attempts</tt>: the number of remaining replication attempts
for this difference

</li>
<li><tt>source_key</tt>: a column_name =&gt; value hash identifying the source
record

</li>
</ul>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 219</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L219">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attempt_insert identifier id'>attempt_insert</span><span class='lparen token'>(</span><span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span><span class='comma token'>,</span> <span class='source_key identifier id'>source_key</span><span class='rparen token'>)</span>
  <span class='source_change identifier id'>source_change</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='source_db identifier id'>source_db</span><span class='rbrack token'>]</span>
  <span class='source_table identifier id'>source_table</span> <span class='assign token'>=</span> <span class='source_change identifier id'>source_change</span><span class='dot token'>.</span><span class='table identifier id'>table</span>
  <span class='target_db identifier id'>target_db</span> <span class='assign token'>=</span> <span class='OTHER_SIDE constant id'>OTHER_SIDE</span><span class='lbrack token'>[</span><span class='source_db identifier id'>source_db</span><span class='rbrack token'>]</span>
  <span class='target_table identifier id'>target_table</span> <span class='assign token'>=</span> <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='corresponding_table identifier id'>corresponding_table</span><span class='lparen token'>(</span><span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='source_table identifier id'>source_table</span><span class='rparen token'>)</span>

  <span class='values identifier id'>values</span> <span class='assign token'>=</span> <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='load_record identifier id'>load_record</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='source_table identifier id'>source_table</span><span class='comma token'>,</span> <span class='source_key identifier id'>source_key</span>
  <span class='if if kw'>if</span> <span class='values identifier id'>values</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>
    <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='amend identifier id'>amend</span>
    <span class='replicate_difference identifier id'>replicate_difference</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='string val'>&quot;source record for insert vanished&quot;</span>
  <span class='else else kw'>else</span>
    <span class='begin begin kw'>begin</span>
      <span class='comment val'># note: savepoints have to be used for postgresql (as a failed SQL</span>
      <span class='comment val'>#       statement will otherwise invalidate the complete transaction.)</span>
      <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='session identifier id'>session</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='target_db identifier id'>target_db</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='execute identifier id'>execute</span> <span class='string val'>&quot;savepoint rr_insert&quot;</span>
      <span class='log_replication_outcome identifier id'>log_replication_outcome</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span>
      <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='insert_record identifier id'>insert_record</span> <span class='target_db identifier id'>target_db</span><span class='comma token'>,</span> <span class='target_table identifier id'>target_table</span><span class='comma token'>,</span> <span class='values identifier id'>values</span>
    <span class='rescue rescue kw'>rescue</span> <span class='Exception constant id'>Exception</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
      <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='session identifier id'>session</span><span class='dot token'>.</span><span class='send identifier id'>send</span><span class='lparen token'>(</span><span class='target_db identifier id'>target_db</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='execute identifier id'>execute</span> <span class='string val'>&quot;rollback to savepoint rr_insert&quot;</span>
      <span class='row identifier id'>row</span> <span class='assign token'>=</span> <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='load_record identifier id'>load_record</span> <span class='target_db identifier id'>target_db</span><span class='comma token'>,</span> <span class='target_table identifier id'>target_table</span><span class='comma token'>,</span> <span class='source_key identifier id'>source_key</span>
      <span class='raise identifier id'>raise</span> <span class='unless unless_mod kw'>unless</span> <span class='row identifier id'>row</span> <span class='comment val'># problem is not the existence of the record in the target db</span>
      <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='amend identifier id'>amend</span>
      <span class='replicate_difference identifier id'>replicate_difference</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span>
        <span class='dstring node'>&quot;insert failed with #{e.message}&quot;</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>attempt_update</h3>
</div><div id="attempt_update-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>attempt_update</span><span class='args'>(source_db, diff, remaining_attempts, source_key, target_key)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Attempts to read the specified record from the source database and update
the specified record in the target database. Retries if update fails due to
missing source
</p>
<ul>
<li><tt>source_db</tt>: either :<tt>left</tt> or :<tt>right</tt> - source
database of replication

</li>
<li><tt>diff</tt>: the current ReplicationDifference instance

</li>
<li><tt>remaining_attempts</tt>: the number of remaining replication attempts
for this difference

</li>
<li><tt>source_key</tt>: a column_name =&gt; value hash identifying the source
record

</li>
<li><tt>target_key</tt>: a column_name =&gt; value hash identifying the source
record

</li>
</ul>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 255</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L255">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">255
256
257
258
259
260
261
262
263
264
265
266
267
268
269</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='attempt_update identifier id'>attempt_update</span><span class='lparen token'>(</span><span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span><span class='comma token'>,</span> <span class='source_key identifier id'>source_key</span><span class='comma token'>,</span> <span class='target_key identifier id'>target_key</span><span class='rparen token'>)</span>
  <span class='source_change identifier id'>source_change</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='source_db identifier id'>source_db</span><span class='rbrack token'>]</span>
  <span class='source_table identifier id'>source_table</span> <span class='assign token'>=</span> <span class='source_change identifier id'>source_change</span><span class='dot token'>.</span><span class='table identifier id'>table</span>
  <span class='target_db identifier id'>target_db</span> <span class='assign token'>=</span> <span class='OTHER_SIDE constant id'>OTHER_SIDE</span><span class='lbrack token'>[</span><span class='source_db identifier id'>source_db</span><span class='rbrack token'>]</span>
  <span class='target_table identifier id'>target_table</span> <span class='assign token'>=</span> <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='corresponding_table identifier id'>corresponding_table</span><span class='lparen token'>(</span><span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='source_table identifier id'>source_table</span><span class='rparen token'>)</span>

  <span class='values identifier id'>values</span> <span class='assign token'>=</span> <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='load_record identifier id'>load_record</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='source_table identifier id'>source_table</span><span class='comma token'>,</span> <span class='source_key identifier id'>source_key</span>
  <span class='if if kw'>if</span> <span class='values identifier id'>values</span> <span class='eq op'>==</span> <span class='nil nil kw'>nil</span>
    <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='amend identifier id'>amend</span>
    <span class='replicate_difference identifier id'>replicate_difference</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span> <span class='minus op'>-</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='string val'>&quot;source record for update vanished&quot;</span>
  <span class='else else kw'>else</span>
    <span class='log_replication_outcome identifier id'>log_replication_outcome</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span>
    <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='update_record identifier id'>update_record</span> <span class='target_db identifier id'>target_db</span><span class='comma token'>,</span> <span class='target_table identifier id'>target_table</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='comma token'>,</span> <span class='target_key identifier id'>target_key</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>clear_conflict</h3>
</div><div id="clear_conflict-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>clear_conflict</span><span class='args'>(source_db, diff, remaining_attempts)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Helper function that clears a conflict by taking the change from the
specified winning database and updating the other database accordingly.
</p>
<ul>
<li><tt>source_db</tt>: the winning database (either :<tt>left</tt> or
:<tt>right</tt>)

</li>
<li><tt>diff</tt>: the ReplicationDifference instance

</li>
<li><tt>remaining_attempts</tt>: the number of remaining replication attempts
for this difference

</li>
</ul>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 158</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L158">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='clear_conflict identifier id'>clear_conflict</span><span class='lparen token'>(</span><span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span><span class='rparen token'>)</span>
  <span class='source_change identifier id'>source_change</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='source_db identifier id'>source_db</span><span class='rbrack token'>]</span>
  <span class='target_db identifier id'>target_db</span> <span class='assign token'>=</span> <span class='OTHER_SIDE constant id'>OTHER_SIDE</span><span class='lbrack token'>[</span><span class='source_db identifier id'>source_db</span><span class='rbrack token'>]</span>
  <span class='target_change identifier id'>target_change</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='target_db identifier id'>target_db</span><span class='rbrack token'>]</span>

  <span class='target_action identifier id'>target_action</span> <span class='assign token'>=</span> <span class='CONFLICT_STATE_MATRIX constant id'>CONFLICT_STATE_MATRIX</span><span class='lbrack token'>[</span><span class='source_change identifier id'>source_change</span><span class='dot token'>.</span><span class='type identifier id'>type</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='target_change identifier id'>target_change</span><span class='dot token'>.</span><span class='type identifier id'>type</span><span class='rbrack token'>]</span>
  <span class='source_key identifier id'>source_key</span> <span class='assign token'>=</span> <span class='source_change identifier id'>source_change</span><span class='dot token'>.</span><span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:update</span> <span class='question op'>?</span> <span class='source_change identifier id'>source_change</span><span class='dot token'>.</span><span class='new_key identifier id'>new_key</span> <span class='colon op'>:</span> <span class='source_change identifier id'>source_change</span><span class='dot token'>.</span><span class='key identifier id'>key</span>
  <span class='target_key identifier id'>target_key</span> <span class='assign token'>=</span> <span class='target_change identifier id'>target_change</span><span class='dot token'>.</span><span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:update</span> <span class='question op'>?</span> <span class='target_change identifier id'>target_change</span><span class='dot token'>.</span><span class='new_key identifier id'>new_key</span> <span class='colon op'>:</span> <span class='target_change identifier id'>target_change</span><span class='dot token'>.</span><span class='key identifier id'>key</span>
  <span class='case case kw'>case</span> <span class='target_action identifier id'>target_action</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:insert</span>
    <span class='attempt_insert identifier id'>attempt_insert</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span><span class='comma token'>,</span> <span class='source_key identifier id'>source_key</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:update</span>
    <span class='attempt_update identifier id'>attempt_update</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span><span class='comma token'>,</span> <span class='source_key identifier id'>source_key</span><span class='comma token'>,</span> <span class='target_key identifier id'>target_key</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:delete</span>
    <span class='attempt_delete identifier id'>attempt_delete</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='target_key identifier id'>target_key</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>log_replication_outcome</h3>
</div><div id="log_replication_outcome-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>log_replication_outcome</span><span class='args'>(winner, diff)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Logs replication of the specified difference as per configured
:<tt>replication_conflict_logging</tt> / :<tt>left_change_logging</tt> /
:<tt>right_change_logging</tt> options.
</p>
<ul>
<li><tt>winner</tt>: Either the winner database (:<tt>left</tt> or
:<tt>right</tt>) or :<tt>ignore</tt>

</li>
<li><tt>diff</tt>: the ReplicationDifference instance

</li>
</ul>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 191</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L191">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">191
192
193
194
195
196
197
198
199
200
201
202
203
204</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='log_replication_outcome identifier id'>log_replication_outcome</span><span class='lparen token'>(</span><span class='winner identifier id'>winner</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='rparen token'>)</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='options_for_table identifier id'>options_for_table</span><span class='lparen token'>(</span><span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='symbol val'>:left</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='table identifier id'>table</span><span class='rparen token'>)</span>
  <span class='option_values identifier id'>option_values</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:logged_replication_events</span><span class='rbrack token'>]</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='flatten identifier id'>flatten</span> <span class='comment val'># make sure I have an array</span>
  <span class='if if kw'>if</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:conflict</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='option_values identifier id'>option_values</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='symbol val'>:all_conflicts</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='option_values identifier id'>option_values</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='symbol val'>:ignored_conflicts</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='winner identifier id'>winner</span> <span class='neq op'>!=</span> <span class='symbol val'>:ignore</span> <span class='and and kw'>and</span> <span class='not not kw'>not</span> <span class='option_values identifier id'>option_values</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='symbol val'>:all_conflicts</span><span class='rparen token'>)</span>
    <span class='outcome identifier id'>outcome</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='symbol val'>:left</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'left_won'</span><span class='comma token'>,</span> <span class='symbol val'>:right</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'right_won'</span><span class='comma token'>,</span> <span class='symbol val'>:ignore</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'ignored'</span><span class='rbrace token'>}</span><span class='lbrack token'>[</span><span class='winner identifier id'>winner</span><span class='rbrack token'>]</span>
  <span class='else else kw'>else</span>
    <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='option_values identifier id'>option_values</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='symbol val'>:all_changes</span><span class='rparen token'>)</span> <span class='or or kw'>or</span> <span class='option_values identifier id'>option_values</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='symbol val'>:ignored_changes</span><span class='rparen token'>)</span>
    <span class='return return kw'>return</span> <span class='if if_mod kw'>if</span> <span class='winner identifier id'>winner</span> <span class='neq op'>!=</span> <span class='symbol val'>:ignore</span> <span class='and and kw'>and</span> <span class='not not kw'>not</span> <span class='option_values identifier id'>option_values</span><span class='dot token'>.</span><span class='include? fid id'>include?</span><span class='lparen token'>(</span><span class='symbol val'>:all_changes</span><span class='rparen token'>)</span>
    <span class='outcome identifier id'>outcome</span> <span class='assign token'>=</span> <span class='winner identifier id'>winner</span> <span class='eq op'>==</span> <span class='symbol val'>:ignore</span> <span class='question op'>?</span> <span class='string val'>'ignored'</span> <span class='colon op'>:</span> <span class='string val'>'replicated'</span>
  <span class='end end kw'>end</span>
  <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='log_replication_outcome identifier id'>log_replication_outcome</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='outcome identifier id'>outcome</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>options_for_table</h3>
</div><div id="options_for_table-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>options_for_table</span><span class='args'>(table)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the options for the specified table name.
</p>
<ul>
<li><tt>table</tt>: name of the table (left database version)

</li>
</ul>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 178</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L178">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">178
179
180
181
182
183
184
185</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='options_for_table identifier id'>options_for_table</span><span class='lparen token'>(</span><span class='table identifier id'>table</span><span class='rparen token'>)</span>
  <span class='@options_for_table ivar id'>@options_for_table</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='unless unless kw'>unless</span> <span class='@options_for_table ivar id'>@options_for_table</span><span class='dot token'>.</span><span class='include? fid id'>include?</span> <span class='table identifier id'>table</span>
    <span class='@options_for_table ivar id'>@options_for_table</span><span class='lbrack token'>[</span><span class='table identifier id'>table</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='DEFAULT_OPTIONS constant id'>DEFAULT_OPTIONS</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span>
      <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='session identifier id'>session</span><span class='dot token'>.</span><span class='configuration identifier id'>configuration</span><span class='dot token'>.</span><span class='options_for_table identifier id'>options_for_table</span><span class='lparen token'>(</span><span class='table identifier id'>table</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
  <span class='@options_for_table ivar id'>@options_for_table</span><span class='lbrack token'>[</span><span class='table identifier id'>table</span><span class='rbrack token'>]</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>replicate_difference</h3>
</div><div id="replicate_difference-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>replicate_difference</span><span class='args'>(diff, remaining_attempts = MAX_REPLICATION_ATTEMPTS, previous_failure_description = nil)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Called to replicate the specified difference.
</p>
<ul>
<li>:<tt>diff</tt>: ReplicationDifference instance

</li>
<li>:<tt>remaining_attempts</tt>: how many more times a replication will be
attempted

</li>
<li>:<tt>previous_failure_description</tt>: why the previous replication
attempt failed

</li>
</ul>

</div><div class="section tags">
  <h2>Meta Tags</h2>
  <div class="raise">
  <h3>Raises:</h3>
  <dl>
  
    <dt>
      
        <span class='type'>[<tt>Exception</tt>]</span>
      
      
      
    </dt>
    <dd>
      <span class='desc'></span>
    </dd>
  
  </dl>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 289</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L289">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='replicate_difference identifier id'>replicate_difference</span><span class='lparen token'>(</span><span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span> <span class='assign token'>=</span> <span class='MAX_REPLICATION_ATTEMPTS constant id'>MAX_REPLICATION_ATTEMPTS</span><span class='comma token'>,</span> <span class='previous_failure_description identifier id'>previous_failure_description</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='raise identifier id'>raise</span> <span class='Exception constant id'>Exception</span><span class='comma token'>,</span> <span class='previous_failure_description identifier id'>previous_failure_description</span> <span class='orop op'>||</span> <span class='string val'>&quot;max replication attempts exceeded&quot;</span> <span class='if if_mod kw'>if</span> <span class='remaining_attempts identifier id'>remaining_attempts</span> <span class='eq op'>==</span> <span class='integer val'>0</span>
  <span class='options identifier id'>options</span> <span class='assign token'>=</span> <span class='options_for_table identifier id'>options_for_table</span><span class='lparen token'>(</span><span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='symbol val'>:left</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='table identifier id'>table</span><span class='rparen token'>)</span>
  <span class='if if kw'>if</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:left</span> <span class='or or kw'>or</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:right</span>
    <span class='key identifier id'>key</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:left</span> <span class='question op'>?</span> <span class='symbol val'>:left_change_handling</span> <span class='colon op'>:</span> <span class='symbol val'>:right_change_handling</span>
    <span class='option identifier id'>option</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span>

    <span class='if if kw'>if</span> <span class='option identifier id'>option</span> <span class='eq op'>==</span> <span class='symbol val'>:ignore</span>
      <span class='log_replication_outcome identifier id'>log_replication_outcome</span> <span class='symbol val'>:ignore</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span>
    <span class='elsif elsif kw'>elsif</span> <span class='option identifier id'>option</span> <span class='eq op'>==</span> <span class='symbol val'>:replicate</span>
      <span class='source_db identifier id'>source_db</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='type identifier id'>type</span>

      <span class='change identifier id'>change</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='source_db identifier id'>source_db</span><span class='rbrack token'>]</span>

      <span class='case case kw'>case</span> <span class='change identifier id'>change</span><span class='dot token'>.</span><span class='type identifier id'>type</span>
      <span class='when when kw'>when</span> <span class='symbol val'>:insert</span>
        <span class='attempt_insert identifier id'>attempt_insert</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span><span class='comma token'>,</span> <span class='change identifier id'>change</span><span class='dot token'>.</span><span class='key identifier id'>key</span>
      <span class='when when kw'>when</span> <span class='symbol val'>:update</span>
        <span class='attempt_update identifier id'>attempt_update</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span><span class='comma token'>,</span> <span class='change identifier id'>change</span><span class='dot token'>.</span><span class='new_key identifier id'>new_key</span><span class='comma token'>,</span> <span class='change identifier id'>change</span><span class='dot token'>.</span><span class='key identifier id'>key</span>
      <span class='when when kw'>when</span> <span class='symbol val'>:delete</span>
        <span class='attempt_delete identifier id'>attempt_delete</span> <span class='source_db identifier id'>source_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='change identifier id'>change</span><span class='dot token'>.</span><span class='key identifier id'>key</span>
      <span class='end end kw'>end</span>
    <span class='else else kw'>else</span> <span class='comment val'># option must be a Proc</span>
      <span class='option identifier id'>option</span><span class='dot token'>.</span><span class='call identifier id'>call</span> <span class='rep_helper identifier id'>rep_helper</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span>
    <span class='end end kw'>end</span>
  <span class='elsif elsif kw'>elsif</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='type identifier id'>type</span> <span class='eq op'>==</span> <span class='symbol val'>:conflict</span>
    <span class='option identifier id'>option</span> <span class='assign token'>=</span> <span class='options identifier id'>options</span><span class='lbrack token'>[</span><span class='symbol val'>:replication_conflict_handling</span><span class='rbrack token'>]</span>
    <span class='if if kw'>if</span> <span class='option identifier id'>option</span> <span class='eq op'>==</span> <span class='symbol val'>:ignore</span>
      <span class='log_replication_outcome identifier id'>log_replication_outcome</span> <span class='symbol val'>:ignore</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span>
    <span class='elsif elsif kw'>elsif</span> <span class='option identifier id'>option</span> <span class='eq op'>==</span> <span class='symbol val'>:left_wins</span>
      <span class='clear_conflict identifier id'>clear_conflict</span> <span class='symbol val'>:left</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span>
    <span class='elsif elsif kw'>elsif</span> <span class='option identifier id'>option</span> <span class='eq op'>==</span> <span class='symbol val'>:right_wins</span>
      <span class='clear_conflict identifier id'>clear_conflict</span> <span class='symbol val'>:right</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span>
    <span class='elsif elsif kw'>elsif</span> <span class='option identifier id'>option</span> <span class='eq op'>==</span> <span class='symbol val'>:later_wins</span>
      <span class='winner_db identifier id'>winner_db</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='symbol val'>:left</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='last_changed_at identifier id'>last_changed_at</span> <span class='geq op'>&gt;=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='symbol val'>:right</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='last_changed_at identifier id'>last_changed_at</span> <span class='integer val'>? </span><span class='symbol val'>:left</span> <span class='colon op'>:</span> <span class='symbol val'>:right</span>
      <span class='clear_conflict identifier id'>clear_conflict</span> <span class='winner_db identifier id'>winner_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span>
    <span class='elsif elsif kw'>elsif</span> <span class='option identifier id'>option</span> <span class='eq op'>==</span> <span class='symbol val'>:earlier_wins</span>
      <span class='winner_db identifier id'>winner_db</span> <span class='assign token'>=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='symbol val'>:left</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='last_changed_at identifier id'>last_changed_at</span> <span class='leq op'>&lt;=</span> <span class='diff identifier id'>diff</span><span class='dot token'>.</span><span class='changes identifier id'>changes</span><span class='lbrack token'>[</span><span class='symbol val'>:right</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='last_changed_at identifier id'>last_changed_at</span> <span class='integer val'>? </span><span class='symbol val'>:left</span> <span class='colon op'>:</span> <span class='symbol val'>:right</span>
      <span class='clear_conflict identifier id'>clear_conflict</span> <span class='winner_db identifier id'>winner_db</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span><span class='comma token'>,</span> <span class='remaining_attempts identifier id'>remaining_attempts</span>
    <span class='else else kw'>else</span> <span class='comment val'># option must be a Proc</span>
      <span class='option identifier id'>option</span><span class='dot token'>.</span><span class='call identifier id'>call</span> <span class='rep_helper identifier id'>rep_helper</span><span class='comma token'>,</span> <span class='diff identifier id'>diff</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>validate_change_handling_options</h3>
</div><div id="validate_change_handling_options-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>validate_change_handling_options</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Verifies if the :<tt>left_change_handling</tt> /
:<tt>right_change_handling</tt> options are valid. Raises an ArgumentError
if an option is invalid
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 88</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L88">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">88
89
90
91
92
93
94
95
96</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='validate_change_handling_options identifier id'>validate_change_handling_options</span>
  <span class='lbrack token'>[</span><span class='symbol val'>:left_change_handling</span><span class='comma token'>,</span> <span class='symbol val'>:right_change_handling</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='bitor op'>|</span>
    <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='session identifier id'>session</span><span class='dot token'>.</span><span class='configuration identifier id'>configuration</span><span class='dot token'>.</span><span class='each_matching_option identifier id'>each_matching_option</span><span class='lparen token'>(</span><span class='key identifier id'>key</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='table_spec identifier id'>table_spec</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
      <span class='unless unless kw'>unless</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span> <span class='colon op'>:</span><span class='call identifier id'>call</span>
        <span class='verify_option identifier id'>verify_option</span> <span class='table_spec identifier id'>table_spec</span><span class='comma token'>,</span> <span class='lbrack token'>[</span><span class='symbol val'>:ignore</span><span class='comma token'>,</span> <span class='symbol val'>:replicate</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='key identifier id'>key</span><span class='comma token'>,</span> <span class='value identifier id'>value</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>validate_conflict_handling_options</h3>
</div><div id="validate_conflict_handling_options-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>validate_conflict_handling_options</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Verifies if the given :<tt>replication_conflict_handling</tt> options are
valid. Raises an ArgumentError if an option is invalid.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 100</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L100">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">100
101
102
103
104
105
106
107
108</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='validate_conflict_handling_options identifier id'>validate_conflict_handling_options</span>
  <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='session identifier id'>session</span><span class='dot token'>.</span><span class='configuration identifier id'>configuration</span><span class='dot token'>.</span><span class='each_matching_option identifier id'>each_matching_option</span><span class='lparen token'>(</span><span class='symbol val'>:replication_conflict_handling</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='table_spec identifier id'>table_spec</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='bitor op'>|</span>
    <span class='unless unless kw'>unless</span> <span class='value identifier id'>value</span><span class='dot token'>.</span><span class='respond_to? fid id'>respond_to?</span> <span class='colon op'>:</span><span class='call identifier id'>call</span>
      <span class='verify_option identifier id'>verify_option</span> <span class='table_spec identifier id'>table_spec</span><span class='comma token'>,</span>
        <span class='lbrack token'>[</span><span class='symbol val'>:ignore</span><span class='comma token'>,</span> <span class='symbol val'>:left_wins</span><span class='comma token'>,</span> <span class='symbol val'>:right_wins</span><span class='comma token'>,</span> <span class='symbol val'>:later_wins</span><span class='comma token'>,</span> <span class='symbol val'>:earlier_wins</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
        <span class='symbol val'>:replication_conflict_handling</span><span class='comma token'>,</span> <span class='value identifier id'>value</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>validate_logging_options</h3>
</div><div id="validate_logging_options-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>validate_logging_options</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Verifies if the given :<tt>replication_logging</tt> option /options is /
are valid. Raises an ArgumentError if invalid
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 112</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L112">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">112
113
114
115
116
117
118
119
120
121</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='validate_logging_options identifier id'>validate_logging_options</span>
  <span class='rep_helper identifier id'>rep_helper</span><span class='dot token'>.</span><span class='session identifier id'>session</span><span class='dot token'>.</span><span class='configuration identifier id'>configuration</span><span class='dot token'>.</span><span class='each_matching_option identifier id'>each_matching_option</span><span class='lparen token'>(</span><span class='symbol val'>:logged_replication_events</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='table_spec identifier id'>table_spec</span><span class='comma token'>,</span> <span class='values identifier id'>values</span><span class='bitor op'>|</span>
    <span class='values identifier id'>values</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='values identifier id'>values</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='flatten identifier id'>flatten</span> <span class='comment val'># ensure that I have an array</span>
    <span class='values identifier id'>values</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='value identifier id'>value</span><span class='bitor op'>|</span>
      <span class='verify_option identifier id'>verify_option</span> <span class='table_spec identifier id'>table_spec</span><span class='comma token'>,</span>
        <span class='lbrack token'>[</span><span class='symbol val'>:ignored_changes</span><span class='comma token'>,</span> <span class='symbol val'>:all_changes</span><span class='comma token'>,</span> <span class='symbol val'>:ignored_conflicts</span><span class='comma token'>,</span> <span class='symbol val'>:all_conflicts</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
        <span class='symbol val'>:logged_replication_events</span><span class='comma token'>,</span> <span class='value identifier id'>value</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>verify_option</h3>
</div><div id="verify_option-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>verify_option</span><span class='args'>(table_spec, valid_option_values, option_key, option_value)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Checks if an option is configured correctly. Raises an ArgumentError if
not.
</p>
<ul>
<li><tt>table_spec</tt>: the table specification to which the option belongs.
May be <tt>nil</tt>.

</li>
<li><tt>valid_option_values</tt>: array of valid option values

</li>
<li><tt>option_key</tt>: the key of the option that is to be checked

</li>
<li><tt>option_value</tt>: the value of the option that is to be checked

</li>
</ul>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/rubyrep/replicators/two_way_replicator.rb', line 76</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/rubyrep/rubyrep/blob/64a23bf39a24022e6750b440453796498b882b0e/lib/rubyrep/replicators/two_way_replicator.rb#L76">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">76
77
78
79
80
81
82
83</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='verify_option identifier id'>verify_option</span><span class='lparen token'>(</span><span class='table_spec identifier id'>table_spec</span><span class='comma token'>,</span> <span class='valid_option_values identifier id'>valid_option_values</span><span class='comma token'>,</span> <span class='option_key identifier id'>option_key</span><span class='comma token'>,</span> <span class='option_value identifier id'>option_value</span><span class='rparen token'>)</span>
  <span class='unless unless kw'>unless</span> <span class='valid_option_values identifier id'>valid_option_values</span><span class='dot token'>.</span><span class='include? fid id'>include?</span> <span class='option_value identifier id'>option_value</span>
    <span class='message identifier id'>message</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    <span class='message identifier id'>message</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;#{table_spec.inspect}: &quot;</span> <span class='if if_mod kw'>if</span> <span class='table_spec identifier id'>table_spec</span>
    <span class='message identifier id'>message</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;#{option_value.inspect} not a valid #{option_key.inspect} option&quot;</span>
    <span class='raise identifier id'>raise</span> <span class='ArgumentError constant id'>ArgumentError</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='message identifier id'>message</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> 2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>