<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>mbleigh's twitter-auth - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/mbleigh/commits/twitter-auth/master" rel="alternate" title="Recent Commits to twitter-auth:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("mbleigh", "twitter-auth", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='mbleigh/twitter-auth/blob/6f94b62fcfa9b0002d53786c57846e5ee8ed6527' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='mbleigh/twitter-auth/blob/6f94b62fcfa9b0002d53786c57846e5ee8ed6527' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("mbleigh", "twitter-auth", "6f94b62fcfa9b0002d53786c57846e5ee8ed6527", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/mbleigh/twitter-auth/tree/">Source</a></li>
            <li class=""><a href="http://github.com/mbleigh/twitter-auth/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/mbleigh/twitter-auth/network">Network</a></li>            
            <li class=""><a href="http://github.com/mbleigh/twitter-auth/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/mbleigh/twitter-auth">Wiki</a></li>
            <li class=""><a href="http://github.com/mbleigh/twitter-auth/graphs">Graphs</a></li>                    
            <li class="active"><a href="/mbleigh/twitter-auth">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/mbleigh">mbleigh</a> / <b><a href="http://github.com/mbleigh/twitter-auth/tree">twitter-auth</a></b>        
                <a id="namespaces_button" rel="mbleigh/twitter-auth/blob/6f94b62fcfa9b0002d53786c57846e5ee8ed6527" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="mbleigh/twitter-auth/blob/6f94b62fcfa9b0002d53786c57846e5ee8ed6527" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>TwitterAuth</h1>

<p>TwitterAuth aims to provide a complete authentication and API access solution for creating Twitter applications in Rails. It provides a generator and all of the necessary components to use Twitter as the sole authentication provider for an application using either Twitter's OAuth or HTTP Basic authentication strategies.</p>

<h1>Installation</h1>

<p>You can include TwitterAuth as a gem in your project like so:</p>

<pre class="code"><span class='config identifier id'>config</span><span class='dot token'>.</span><span class='gem identifier id'>gem</span> <span class='string val'>'twitter-auth'</span><span class='comma token'>,</span> <span class='symbol val'>:lib</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'twitter_auth'</span>
</pre>

<p>Or you can install it as a traditional Rails plugin:</p>

<pre class="code"><span class='script identifier id'>script</span><span class='div op'>/</span><span class='plugin identifier id'>plugin</span> <span class='install identifier id'>install</span> <span class='git identifier id'>git</span><span class='symbol val'>:/</span><span class='regexp val'>/github.com/</span><span class='mbleigh identifier id'>mbleigh</span><span class='div op'>/</span><span class='twitter identifier id'>twitter</span><span class='minus op'>-</span><span class='auth identifier id'>auth</span><span class='dot token'>.</span><span class='git identifier id'>git</span>
</pre>

<p>Note that because TwitterAuth utilizes Rails Engines functionality introduced in Rails 2.3, it will not work with earlier versions of Rails.</p>

<p><strong>NOTE:</strong> TwitterAuth requires Rails version 2.3 or later because it makes extensive use of the new support for Rails Engines. Previous versions of Rails are not supported.</p>

<h1>Usage</h1>

<p>To utilize TwitterAuth in your application you will need to run the generator:</p>

<pre class="code"><span class='script identifier id'>script</span><span class='div op'>/</span><span class='generate identifier id'>generate</span> <span class='twitter_auth identifier id'>twitter_auth</span> <span class='lbrack token'>[</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='oauth identifier id'>oauth</span> <span class='lparen token'>(</span><span class='default identifier id'>default</span><span class='rparen token'>)</span> <span class='bitor op'>|</span> <span class='minus op'>-</span><span class='minus op'>-</span><span class='basic identifier id'>basic</span><span class='rbrack token'>]</span>
</pre>

<p>This will generate a migration as well as set up the stubs needed to use the Rails Engines controllers and models set up by TwitterAuth. It will also create a User class that inherits from TwitterUser, abstracting away all of the Twitter authentication functionality and leaving you a blank slate to work with for your application.</p>

<p>Finally, it will create a configuration file in <code>config/twitter_auth.yml</code> in which you should input your OAuth consumer key and secret (if using the OAuth strategy) as well as a custom callback for development (the <code>oauth_callback</code> option is where Twitter will send the browser after authentication is complete. If you leave it blank Twitter will send it to the URL set up when you registered your application).</p>

<h2>Sign in with Twitter</h2>

<p>Twitter recently implemented a convenience layer on top of OAuth called <a href="http://apiwiki.twitter.com/Sign-in-with-Twitter">Sign in with Twitter</a>. TwitterAuth makes use of this by default in newly generated applications by setting the <code>authorize_path</code> in <code>twitter_auth.yml</code>.</p>

<p>If you already have an application utilizing TwitterAuth that you would like to utilize the new system, simply add this line to your <code>twitter_auth.yml</code> in each environment:</p>

<pre class="code"><span class='authorize_path identifier id'>authorize_path</span><span class='colon op'>:</span> <span class='string val'>&quot;/oauth/authenticate&quot;</span>
</pre>

<h2>Usage Basics</h2>

<p>If you need more information about how to use OAuth with Twitter, please visit Twitter's <a href="http://apiwiki.twitter.com/OAuth-FAQ">OAuth FAQ</a>.</p>

<p>TwitterAuth borrows heavily from <a href="http://github.com/technoweenie/restful-authentication">Restful Authentication</a> for its API because it's simple and well-known. Here are some of the familiar methods that are available:</p>

<ul>
<li><code>login_required</code>: a before filter that can be added to a controller to require that a user logs in before he/she can view the page.</li>
<li><code>current_user</code>: returns the logged in user if one exists, otherwise returns <code>nil</code>.</li>
<li><code>logged_in?</code>: true if logged in, false otherwise.</li>
<li><code>redirect_back_or_default(url)</code>: redirects to the location where <code>store_location</code> was last called or the specified default URL.</li>
<li><code>store_location</code>: store the current URL for returning to when a <code>redirect_back_or_default</code> is called.</li>
<li><code>authorized?</code>: override this to add fine-grained access control for when <code>login_required</code> is already called.</li>
</ul>


<h2>Accessing the Twitter API</h2>

<p>Obviously if you're using Twitter as an authentication strategy you probably have interest in accessing Twitter API information as well. Because I wasn't really satisfied with either of the popular Twitter API Ruby libraries (<a href="http://twitter4r.rubyforge.org">Twitter4R</a> and <a href="http://twitter.rubyforge.org">Twitter</a>) and also because neither support OAuth (yet), I decided to go with a simple, dependency-free API implementation.</p>

<p>The <code>User</code> class will have a <code>twitter</code> method that provides a generic dispatcher with HTTP verb commands available (<code>get</code>, <code>put</code>, <code>post</code>, and <code>delete</code>). These are automatically initialized to the <code>base_url</code> you specified in the <code>twitter_auth.yml</code> file, so you need only specify a path. Additionally, it will automatically append a .json extension and parse the JSON if you don't provide (it returns strings for XML because, well, I don't like XML and don't feel like parsing it).</p>

<pre class="code"><span class='comment val'># This code will work with the OAuth and Basic strategies alike.</span>
<span class='user identifier id'>user</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='find_by_login identifier id'>find_by_login</span><span class='lparen token'>(</span><span class='string val'>'mbleigh'</span><span class='rparen token'>)</span>

<span class='user identifier id'>user</span><span class='dot token'>.</span><span class='twitter identifier id'>twitter</span><span class='dot token'>.</span><span class='get identifier id'>get</span><span class='lparen token'>(</span><span class='string val'>'/account/verify_credentials'</span><span class='rparen token'>)</span>
<span class='comment val'># =&gt; {'screen_name' =&gt; 'mbleigh', 'name' =&gt; 'Michael Bleigh' ... }</span>

<span class='user identifier id'>user</span><span class='dot token'>.</span><span class='twitter identifier id'>twitter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='string val'>'/statuses/update.json'</span><span class='comma token'>,</span> <span class='string val'>'status'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='string val'>'This is my status.'</span><span class='rparen token'>)</span>
<span class='comment val'># =&gt; {&quot;user&quot;=&gt;{&quot;login&quot; =&gt; &quot;mbleigh&quot; ... }, &quot;text&quot;=&gt;&quot;This is my status.&quot;, &quot;id&quot;=&gt;1234567890 ... }</span>
</pre>

<p>If Twitter returns something other than a 200 response code, TwitterAuth will catch it and try to raise a salient error message. The exception class is <code>TwitterAuth::Dispatcher::Error</code> if you're in the mood to catch it.</p>

<p>This area of the code is still a little raw, but hopefully will evolve to be a little more user-friendly as TwitterAuth matures. In the meantime, it's a perfectly workable foundation library, and the fact that it works the same with OAuth and HTTP Basic makes it all the better!</p>

<h2>Customizing TwitterAuth</h2>

<p>There are a number of hooks to extend the functionality of TwitterAuth. Here is a brief description of each of them.</p>

<h3>Controller Methods</h3>

<p>TwitterAuth provides some default controller methods that may be overridden in your <code>ApplicationController</code> to behave differently.</p>

<ul>
<li><code>authentication_failed(message)</code>: called when Twitter authorization has failed during the process. By default, simply redirects to the site root and sets the <code>flash[:error]</code>.</li>
<li><code>authentication_succeeded(message=default)</code>: called when Twitter authorization has completed successfully. By default, simply redirects to the site root and sets the <code>flash[:notice]</code>.</li>
<li><code>access_denied</code>: what happens when the <code>login_required</code> before filter fails. By default it stores the current location to return to and redirects to the login process.</li>
</ul>


<h2>Tips and Tricks</h2>

<ul>
<li>If you are getting an <code>OpenSSL::SSL:SSLError (certificate verify failed)</code> you may want to <a href="https://mbleigh.lighthouseapp.com/projects/27783-twitterauth/tickets/6-error-on-login#ticket-6-2">see this ticket and comments</a>.</li>
</ul>


<h2>Resources</h2>

<ul>
<li><strong>Bug Reports:</strong> See the <a href="http://github.com/mbleigh/twitter-auth/issues">Issues Page</a> to report any problems you have using TwitterAuth.</li>
<li><strong>Blog Post:</strong> The <a href="http://intridea.com/2009/3/23/twitter-auth-for-near-instant-twitter-apps">original blog post about TwitterAuth</a> has a tutorial as well to get you started.</li>
<li><strong>GitHub Pages:</strong> TwitterAuth has a <a href="http://mbleigh.com/twitter-auth">simple GitHub page</a></li>
</ul>


<h2>Copyright</h2>

<p><strong>TwitterAuth</strong> is Copyright (c) 2009 <a href="http://www.mbleigh.com">Michael Bleigh</a> and <a href="http://www.intridea.com/">Intridea, Inc.</a>, released under the MIT License.</p>

<p>TwitterAuth is not affiliated with Twitter, Inc.</p>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>