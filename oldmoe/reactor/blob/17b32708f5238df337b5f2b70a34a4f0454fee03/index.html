<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>oldmoe's reactor - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/oldmoe/commits/reactor/master" rel="alternate" title="Recent Commits to reactor:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("oldmoe", "reactor", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='oldmoe/reactor/blob/17b32708f5238df337b5f2b70a34a4f0454fee03' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='oldmoe/reactor/blob/17b32708f5238df337b5f2b70a34a4f0454fee03' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("oldmoe", "reactor", "17b32708f5238df337b5f2b70a34a4f0454fee03", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/oldmoe/reactor/tree/">Source</a></li>
            <li class=""><a href="http://github.com/oldmoe/reactor/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/oldmoe/reactor/network">Network</a></li>            
            <li class=""><a href="http://github.com/oldmoe/reactor/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/oldmoe/reactor">Wiki</a></li>
            <li class=""><a href="http://github.com/oldmoe/reactor/graphs">Graphs</a></li>                    
            <li class="active"><a href="/oldmoe/reactor">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/oldmoe">oldmoe</a> / <b><a href="http://github.com/oldmoe/reactor/tree">reactor</a></b>        
                <a id="namespaces_button" rel="oldmoe/reactor/blob/17b32708f5238df337b5f2b70a34a4f0454fee03" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="oldmoe/reactor/blob/17b32708f5238df337b5f2b70a34a4f0454fee03" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <p>
Reactor
</p>
<p>
A reactor library with the very original name of &quot;Reactor&quot;.
</p>
<p>
What is a reactor any way?
</p>
<p>
A reactor library is one that provides an asynchronus event handling
mechanism. Ruby already has a couple of those. The most prominent are
EventMachine and Rev. Many high performing Ruby applications like Thin and
Evented Mongrel are utilizing EventMachine for event handling. Both Rev and
EventMachine build atop native reactor implementations written in C or C+<tt>.
While this ensures high performance it makes some integration aspects with
Ruby a bit quirky. Sometimes even at a noticable performance cost.
</p>
<p>
This is why I thought of building Reactor. A much simpler reactor library
in pure Ruby that attempts to use as much of the Ruby built in classes and
standard libraries as possible. It only provides a minimal API that does
not attempt to be so smart. It differs from EventMachine and Rev in the
following aspects.
</p>
<p>
1 - Pure Ruby, no C or C</tt>+ code involved 2 - Very small (~100 lines of
code) 3 - Uses the vanilla Ruby socket and server implementations 4 -
Decent (high) performance on Ruby 1.9.1 5 - Ruby threading friendly
(naturally) 6 - You can have multiple reactors running (like Rev and unlike
EventMachine)
</p>
<p>
Usage is simple, here&#8217;s a simple Echo server that uses Reactor
</p>
<p>
require &#8216;reactor&#8217; require &#8216;socket&#8217;
</p>
<p>
reactor = Reactor::Base.new server =
TCPServer.new(&quot;0.0.0.0&quot;,8080)
</p>
<p>
reactor.attach(:read, server) do |server|
</p>
<pre class="code">
  <span class='conn identifier id'>conn</span> <span class='assign token'>=</span> <span class='server identifier id'>server</span><span class='dot token'>.</span><span class='accept identifier id'>accept</span>
  <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='gets identifier id'>gets</span><span class='rparen token'>)</span>
  <span class='conn identifier id'>conn</span><span class='dot token'>.</span><span class='close identifier id'>close</span>
</pre>
<p>
end
</p>
<p>
reactor.run # blocking call, will run for ever (no signal handling
currently)
</p>
<p>
The server is a normal Ruby TCPServer. It attaches itself to the reactor
and asks to be notified if there is data to be read on the wire. A block is
provided that will handle those notifications. Alternatively, the server
can implement a notify_readable method that will be fired instead.
</p>
<p>
Any IO object can be attached to the reactor but it doesn&#8217;t make much
sense to attach actual files since they will block upon reading or writing
anyway. Sockets and pipes will work in a non-blocking manner though.
</p>
<p>
Reactor is using Ruby&#8217;s IO.select behind the scenes. This limits its
ability to scale in comparison to something like EventMachine or Rev which
are able to utilize Epoll and Kqueue which scale much better. This is not a
major concern though. Most servers listen to a few fds most of the time,
which is a bit faster when using select. Besides one can hope that Ruby
will be able to use Epoll and Kqueue some day which will translate to
direct benefit to Reactor.
</p>
<p>
Todo
</p>
<p>
The timers code needs to be reimplemented as a red black tree or a skip
list to avoid the current O(n) cost. It works just fine at its current form
for a few timers though (tens or even hundreds)
</p>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>