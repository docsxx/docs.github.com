<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>safis's logging - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/safis/commits/logging/master" rel="alternate" title="Recent Commits to logging:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("safis", "logging", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='safis/logging/blob/b84f62d1df6907a1c8a2efae1be25dcb9ef2747d' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='safis/logging/blob/b84f62d1df6907a1c8a2efae1be25dcb9ef2747d' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("safis", "logging", "b84f62d1df6907a1c8a2efae1be25dcb9ef2747d", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/safis/logging/tree/">Source</a></li>
            <li class=""><a href="http://github.com/safis/logging/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/safis/logging/network">Network</a></li>            
            <li class=""><a href="http://github.com/safis/logging/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/safis/logging">Wiki</a></li>
            <li class=""><a href="http://github.com/safis/logging/graphs">Graphs</a></li>                    
            <li class="active"><a href="/safis/logging">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/safis">safis</a> / <b><a href="http://github.com/safis/logging/tree">logging</a></b>        
                <a id="namespaces_button" rel="safis/logging/blob/b84f62d1df6907a1c8a2efae1be25dcb9ef2747d" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="safis/logging/blob/b84f62d1df6907a1c8a2efae1be25dcb9ef2747d" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>Safis Logging</h1>

<p>When building distributed applications, the ability to audit their behavior is a necessity.  Often, the easiest way to get at this information is by logging it!</p>

<p>The goal of the Safis logging subsystem is to provide the ability to log your application's behavior with minimal developer friction.</p>

<h2>Getting Started</h2>

<p>So, let's suppose you're developing an application for your evil overlord.  The aim, of course, is to take over the world; but you'd best start small.</p>

<pre class="code"><span class='require identifier id'>require</span> <span class='string val'>'safis/logging'</span>

<span class='log identifier id'>log</span><span class='dot token'>.</span><span class='warn identifier id'>warn</span> <span class='string val'>'The world shall be ours! ...in due time.'</span>
</pre>

<p>Which outputs your nefarious intentions to STDOUT:</p>

<blockquote><p><code>WARN: [Object 19:57:24] The world shall be ours! ...in due time. [2009-07-01T19:57:24.818687-07:00]</code><br/>
</p></blockquote>

<p>The time is duplicated you say?  Why haven't I been dropped into a shark tank for <em>daring to denormalize</em> your log output!?</p>

<p>Well, we often forget that it will be a bleary-eyed developer who will be pouring over these logs.  As such, they should give them the information they care about first, and more granular information second.</p>

<p>After all, you can't afford to execute all of your minions for easily avoidable failure; and you certainly don't want the overlord to do the same to you!</p>

<h2>The Hierarchy</h2>

<p>Much of the power of the Safis logger comes from gleaning the structure of your application.  You use, Modules and Classes, <em>right?</em></p>

<pre class="code"><span class='require identifier id'>require</span> <span class='string val'>'safis/logging'</span>

<span class='module module kw'>module</span> <span class='Villany constant id'>Villany</span>
  <span class='log identifier id'>log</span><span class='dot token'>.</span><span class='warn identifier id'>warn</span> <span class='string val'>'Loading Villany...'</span>

  <span class='class class kw'>class</span> <span class='SharkTankTrapDoor constant id'>SharkTankTrapDoor</span>
    <span class='def def kw'>def</span> <span class='open! fid id'>open!</span>
      <span class='log identifier id'>log</span><span class='dot token'>.</span><span class='info identifier id'>info</span> <span class='string val'>'Dropping the hero into a tank of certain death! With laser beams.'</span>

      <span class='begin begin kw'>begin</span>
        <span class='dot3 op'>...</span>
      <span class='rescue rescue kw'>rescue</span> <span class='TrapDoorFailure constant id'>TrapDoorFailure</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='err identifier id'>err</span>
        <span class='log identifier id'>log</span><span class='dot token'>.</span><span class='fatal identifier id'>fatal</span> <span class='string val'>'The trap door failed to open. Execute the nearest henchman immediately!'</span><span class='comma token'>,</span> <span class='err identifier id'>err</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>

<p>Of course, the trap door will fail, embarrassing the overlord <em>for the last time</em>:</p>

<blockquote><p><code>WARN: [Villany 20:24:32] Loading Villany... [2009-07-01T20:24:32.329174-07:00]</code><br/>
<code>INFO: [Villany::SharkTankTrapDoor 20:24:36] Dropping the hero into a tank of certain death! With laser beams. [2009-07-01T20:24:36.197427-07:00]</code><br/>
<code>FATAL: [Villany::SharkTankTrapDoor 20:24:38] The trap door failed to open. Execute the nearest henchman immediately! [2009-07-01T20:24:38.747175-07:00]</code><br/>
<code> TrapDoorFailure: The magma vents are blocked.</code><br/>
<code>   /villany/power_source/geothermal.rb:27:in `reroute_magma_flow'</code><br/>
<code>   /villany/power_source/geothermal.rb:53:in `check_power_levels'</code><br/>
<code>   ...</code><br/>
</p></blockquote>

<p>Of course, there's also a variety of menial tasks that your overlord just can't be bothered to peruse.  You can filter out log events that you don't need.  Building on the above example, if we had set the following filter level (in the global context):</p>

<pre class="code"><span class='log identifier id'>log</span><span class='dot token'>.</span><span class='filter_level identifier id'>filter_level</span> <span class='assign token'>=</span> <span class='symbol val'>:warn</span>
</pre>

<p>The <code>:info</code> log event would be filtered out of the log output.  It would look like:</p>

<blockquote><p><code>WARN: [Villany 20:24:32] Loading Villany... [2009-07-01T20:24:32.329174-07:00]</code><br/>
<code>FATAL: [Villany::SharkTankTrapDoor 20:24:38] The trap door failed to open. Execute the nearest henchman immediately! [2009-07-01T20:24:38.747175-07:00]</code><br/>
<code> TrapDoorFailure: The magma vents are blocked.</code><br/>
<code>   /villany/power_source/geothermal.rb:27:in `reroute_magma_flow'</code><br/>
<code>   /villany/power_source/geothermal.rb:53:in `check_power_levels'</code><br/>
<code>   ...</code></p></blockquote>

<p>Furthermore, filter levels inherit from their parent <code>Log</code>s.  For example:</p>

<pre class="code"><span class='log identifier id'>log</span><span class='dot token'>.</span><span class='filter_level identifier id'>filter_level</span> <span class='assign token'>=</span> <span class='symbol val'>:fatal</span>

<span class='module module kw'>module</span> <span class='Villany constant id'>Villany</span>
  <span class='class class kw'>class</span> <span class='SharkTankTrapDoor constant id'>SharkTankTrapDoor</span>
    <span class='log identifier id'>log</span><span class='dot token'>.</span><span class='filter_level identifier id'>filter_level</span> <span class='assign token'>=</span> <span class='symbol val'>:info</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>

<p>In this case, <code>Villany</code> inherits from the global scope's log (<code>Object</code>'s log), so the initial :warn log event would be filtered.  However, <code>Villany::SharkTankTrapDoor</code> overrides that with a filter level of <code>:info</code>, allowing the other two log events to be outputted unscathed:</p>

<blockquote><p><code>INFO: [Villany::SharkTankTrapDoor 20:24:36] Dropping the hero into a tank of certain death! With laser beams. [2009-07-01T20:24:36.197427-07:00]</code><br/>
<code>FATAL: [Villany::SharkTankTrapDoor 20:24:38] The trap door failed to open. Execute the nearest henchman immediately! [2009-07-01T20:24:38.747175-07:00]</code><br/>
<code> TrapDoorFailure: The magma vents are blocked.</code><br/>
<code>   /villany/power_source/geothermal.rb:27:in `reroute_magma_flow'</code><br/>
<code>   /villany/power_source/geothermal.rb:53:in `check_power_levels'</code><br/>
<code>   ...</code></p></blockquote>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>