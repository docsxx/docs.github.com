<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="syntax_highlight.css" type="text/css" charset="utf-8" />

    <title>README</title>
  </head>
  <body>
    <div id="content">
      <div class="section docstring readme">
        <h1>JCon &#8212; JavaScript Type Conformance Checking</h1>
<p>
JCON (the &quot;JavaScript Conformance&quot; gem), is a companion to JSON.
It tests JSON values against ECMAScript 4.0-style type definitions
(PDF[http://www.ecmascript.org/es4/spec/overview.pdf]), such as
<tt>string?</tt>, <tt>(int, boolean)</tt>, or <tt>[string, (int, boolean), <tt>y:double</tt>?]</tt>.
</p>
<p>
JCON also defines an RSpec matcher, <tt>conforms_to_js</tt>.
</p>
<p>
Use JCON together with the {JavaScript Fu Rails
plugin}[http://osteele.com/archives/2008/04/javascript-fu-rails-plugin] to
test the argument values in generated JavaScript function calls.
</p>
<h2>Install</h2>
<pre class="code">
  <span class='gem identifier id'>gem</span> <span class='install identifier id'>install</span> <span class='rcon identifier id'>rcon</span>
</pre>
<h2>Usage</h2>
<pre class="code">
  <span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='JCON constant id'>JCON</span><span class='colon2 op'>::</span><span class='parse identifier id'>parse</span> <span class='string val'>&quot;[string, int]&quot;</span>
  <span class='type identifier id'>type</span><span class='dot token'>.</span><span class='contains? fid id'>contains?</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='string val'>'a'</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='comment val'># =&gt; true</span>
  <span class='type identifier id'>type</span><span class='dot token'>.</span><span class='contains? fid id'>contains?</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='string val'>'a'</span><span class='comma token'>,</span> <span class='string val'>'b'</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='comment val'># =&gt; false</span>
  <span class='type identifier id'>type</span><span class='dot token'>.</span><span class='contains? fid id'>contains?</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='string val'>'a'</span><span class='comma token'>,</span> <span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='comment val'># =&gt; true</span>

  <span class='type identifier id'>type</span> <span class='assign token'>=</span> <span class='JCON constant id'>JCON</span><span class='colon2 op'>::</span><span class='parse identifier id'>parse</span> <span class='string val'>&quot;type S = (string, int); {a: [S], b: int}&quot;</span>
  <span class='type identifier id'>type</span><span class='dot token'>.</span><span class='contains? fid id'>contains?</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='symbol val'>:a</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lbrack token'>[</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='string val'>'b'</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='symbol val'>:b</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>2</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='comment val'># =&gt; true</span>
</pre>
<h2>RSpec Matcher</h2>
<pre class="code">
  <span class='lbrack token'>[</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='string val'>'xyzzy'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='should identifier id'>should</span> <span class='conform_to_js identifier id'>conform_to_js</span><span class='lparen token'>(</span><span class='string val'>'[int, string]'</span><span class='rparen token'>)</span>
  <span class='lbrack token'>[</span><span class='integer val'>1</span><span class='comma token'>,</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='string val'>'xyzzy'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='should_not identifier id'>should_not</span> <span class='conform_to_js identifier id'>conform_to_js</span><span class='lparen token'>(</span><span class='string val'>'[int, string]'</span><span class='rparen token'>)</span>
  <span class='lbrace token'>{</span><span class='symbol val'>:x</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>1</span><span class='rbrace token'>}</span><span class='dot token'>.</span><span class='should identifier id'>should</span> <span class='conform_to_js identifier id'>conform_to_js</span><span class='lparen token'>(</span><span class='string val'>'{x: int}'</span><span class='rparen token'>)</span>
</pre>
<p>
Use this with the {JavaScript Fu Rails
plugin}[http://osteele.com/archives/2008/04/javascript-fu-rails-plugin] to
test JSON arguments:
</p>
<pre class="code">
  <span class='string val'>'&lt;script&gt;fn(&quot;id&quot;, {x:1, y:2}, true)&lt;/script&gt;'</span><span class='dot token'>.</span><span class='should identifier id'>should</span> <span class='call_js identifier id'>call_js</span><span class='lparen token'>(</span><span class='string val'>'fn'</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='args identifier id'>args</span><span class='bitor op'>|</span>
    <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='should identifier id'>should</span> <span class='conform_to_js identifier id'>conform_to_js</span><span class='lparen token'>(</span><span class='string val'>'string'</span><span class='rparen token'>)</span>
    <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='integer val'>1</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='should identifier id'>should</span> <span class='conform_to_js identifier id'>conform_to_js</span><span class='lparen token'>(</span><span class='string val'>'{x:int, y:int}'</span><span class='rparen token'>)</span>
    <span class='args identifier id'>args</span><span class='lbrack token'>[</span><span class='integer val'>2</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='should identifier id'>should</span> <span class='conform_to_js identifier id'>conform_to_js</span><span class='lparen token'>(</span><span class='string val'>'boolean'</span><span class='rparen token'>)</span>
    <span class='comment val'># or:</span>
    <span class='args identifier id'>args</span><span class='dot token'>.</span><span class='should identifier id'>should</span> <span class='conform_to_js identifier id'>conform_to_js</span><span class='lparen token'>(</span><span class='string val'>'[string, {x:int, y:int}, boolean]'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
</pre>
<h2>License</h2>
<p>
Copyright 2008 by {Oliver
Steele}[http://workingwithrails.com/person/12359-oliver-steele]. All rights
reserved. Released under the MIT License.
</p>

      </div>
    </div>
  </body>
</html>