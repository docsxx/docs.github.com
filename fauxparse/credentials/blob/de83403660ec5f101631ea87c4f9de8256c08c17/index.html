<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>fauxparse's credentials - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/fauxparse/commits/credentials/master" rel="alternate" title="Recent Commits to credentials:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("fauxparse", "credentials", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='fauxparse/credentials/blob/de83403660ec5f101631ea87c4f9de8256c08c17' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='fauxparse/credentials/blob/de83403660ec5f101631ea87c4f9de8256c08c17' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("fauxparse", "credentials", "de83403660ec5f101631ea87c4f9de8256c08c17", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/fauxparse/credentials/tree/">Source</a></li>
            <li class=""><a href="http://github.com/fauxparse/credentials/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/fauxparse/credentials/network">Network</a></li>            
            <li class=""><a href="http://github.com/fauxparse/credentials/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/fauxparse/credentials">Wiki</a></li>
            <li class=""><a href="http://github.com/fauxparse/credentials/graphs">Graphs</a></li>                    
            <li class="active"><a href="/fauxparse/credentials">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/fauxparse">fauxparse</a> / <b><a href="http://github.com/fauxparse/credentials/tree">credentials</a></b>        
                <a id="namespaces_button" rel="fauxparse/credentials/blob/de83403660ec5f101631ea87c4f9de8256c08c17" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="fauxparse/credentials/blob/de83403660ec5f101631ea87c4f9de8256c08c17" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>Credentials</h1>
<ul>
<li>http://github.com/fauxparse/credentials

</li>
</ul>
<h2>Description</h2>
<p>
A generic actor/resource permission framework.
</p>
<h2>Installation</h2>
<ul>
<li><tt>sudo gem install fauxparse-credentials
--source=http://gems.github.com</tt>

</li>
</ul>
<h2>Examples</h2>
<pre class="code">
  <span class='class class kw'>class</span> <span class='User constant id'>User</span>
    <span class='credentials identifier id'>credentials</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='user identifier id'>user</span><span class='bitor op'>|</span>
      <span class='comment val'># Users should only be able to edit their own details...</span>
      <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='can identifier id'>can</span> <span class='symbol val'>:edit</span><span class='comma token'>,</span> <span class='User constant id'>User</span><span class='comma token'>,</span> <span class='symbol val'>:if</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='lambda identifier id'>lambda</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='comma token'>,</span> <span class='b identifier id'>b</span><span class='bitor op'>|</span> <span class='if if kw'>if</span> <span class='a identifier id'>a</span> <span class='eq op'>==</span> <span class='b identifier id'>b</span> <span class='rbrace token'>}</span>

      <span class='comment val'># ...unless they are administrators!</span>
      <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='can identifier id'>can</span> <span class='symbol val'>:edit</span><span class='comma token'>,</span> <span class='User constant id'>User</span><span class='comma token'>,</span> <span class='symbol val'>:if</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:admin?</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>

  <span class='a identifier id'>a</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='b identifier id'>b</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='symbol val'>:admin</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='true true kw'>true</span>
  <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='can_edit? fid id'>can_edit?</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; true</span>
  <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='can_edit? fid id'>can_edit?</span><span class='lparen token'>(</span><span class='b identifier id'>b</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; false</span>
  <span class='b identifier id'>b</span><span class='dot token'>.</span><span class='can_edit? fid id'>can_edit?</span><span class='lparen token'>(</span><span class='b identifier id'>b</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; true</span>
  <span class='b identifier id'>b</span><span class='dot token'>.</span><span class='can_edit? fid id'>can_edit?</span><span class='lparen token'>(</span><span class='a identifier id'>a</span><span class='rparen token'>)</span> <span class='comment val'>#=&gt; true</span>
</pre>
<p>
Check out the example application (in <tt>spec/test_app</tt>) for more (completely
frivolous) examples.
</p>
<h2>Philosophy</h2>
<p>
Credentials is NOT a role-based permission system. Permissions are based on
code, not on database objects. That said, there&#8217;s nothing to stop you
from doing something like this:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='User constant id'>User</span>
    <span class='has_and_belongs_to_many identifier id'>has_and_belongs_to_many</span> <span class='symbol val'>:roles</span>

    <span class='credentials identifier id'>credentials</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='user identifier id'>user</span><span class='bitor op'>|</span>
      <span class='user identifier id'>user</span><span class='dot token'>.</span><span class='can identifier id'>can</span> <span class='symbol val'>:access</span><span class='comma token'>,</span> <span class='symbol val'>:admin_pages</span><span class='comma token'>,</span> <span class='symbol val'>:if</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:admin?</span>
    <span class='end end kw'>end</span>

    <span class='def def kw'>def</span> <span class='admin? fid id'>admin?</span>
      <span class='notop op'>!</span><span class='roles identifier id'>roles</span><span class='dot token'>.</span><span class='find_by_name identifier id'>find_by_name</span><span class='lparen token'>(</span><span class='string val'>&quot;admin&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
I just figured there were dozens of systems out there for implementing
role-based permissions, and everyone likes to do it differently, so I
wouldn&#8217;t reinvent the wheel. Instead, I wanted to focus on capturing
the logic behind permissions, and avoid having to grant individual
permissions for things that should be implemented algorithmically.
</p>
<p>
For example, say you want to allow users to edit user profiles under the
following rules:
</p>
<ul>
<li>Users can edit their own profile

</li>
<li>Admin users can edit any profile

</li>
<li>Selected users can edit selected other individual profiles

</li>
</ul>
<p>
Ordinarily, that&#8217;s three separate checks: sure, I can bundle these up
into a method on my User object, but the controller still needs to call
that method and take appropriate action if it&#8217;s not satisfied.
</p>
<p>
With Credentials, I can write one method in my ApplicationController, and
then do this:
</p>
<pre class="code">
  <span class='class class kw'>class</span> <span class='UsersController constant id'>UsersController</span>
    <span class='def def kw'>def</span> <span class='update identifier id'>update</span>
      <span class='@user ivar id'>@user</span> <span class='assign token'>=</span> <span class='User constant id'>User</span><span class='dot token'>.</span><span class='find identifier id'>find</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:id</span><span class='rbrack token'>]</span>
      <span class='requires_permission_to identifier id'>requires_permission_to</span> <span class='symbol val'>:edit</span><span class='comma token'>,</span> <span class='@user ivar id'>@user</span>
      <span class='@user ivar id'>@user</span><span class='dot token'>.</span><span class='update_attributes identifier id'>update_attributes</span> <span class='params identifier id'>params</span><span class='lbrack token'>[</span><span class='symbol val'>:user</span><span class='rbrack token'>]</span>
      <span class='comment val'># ...</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
The <tt>requires_permission_to</tt> method would call
<tt>current_user.can?(:edit, @user)</tt>, and, if appropriate, raise an
exception which would get handled by Rails and turned into a nice pretty
error page.
</p>
<h2>To do</h2>
<ul>
<li>The test application is largely overkill. It does a half-decent job of
testing the functionality of the library, but I&#8217;d like to rewrite it
into a proper test suite.

</li>
<li>Proper documentation of the API. It&#8217;s been a while since I touched
this.

</li>
<li>Better support for groups would make integration with RBA systems easier.

</li>
<li>Deny permissions (<tt>cannot</tt>).

</li>
</ul>
<h2>License</h2>
<p>
Copyright &#169; 2009 Matt Powell (fauxparse@gmail.com)
</p>
<p>
Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
&#8216;Software&#8217;), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to the
following conditions:
</p>
<p>
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
</p>
<p>
THE SOFTWARE IS PROVIDED &#8216;AS IS&#8217;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
USE OR OTHER DEALINGS IN THE SOFTWARE.
</p>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>