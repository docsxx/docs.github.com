<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>ddfreyne's nanoc - Class: Nanoc::DataSources::Filesystem - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/ddfreyne/commits/nanoc/master" rel="alternate" title="Recent Commits to nanoc:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="../../app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("ddfreyne", "nanoc", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("ddfreyne", "nanoc", "1751d2739431a6113a296f90fa4cd4863d610d12", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="../../style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/ddfreyne/nanoc/tree/">Source</a></li>
            <li class=""><a href="http://github.com/ddfreyne/nanoc/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/ddfreyne/nanoc/network">Network</a></li>            
            <li class=""><a href="http://github.com/ddfreyne/nanoc/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/ddfreyne/nanoc">Wiki</a></li>
            <li class=""><a href="http://github.com/ddfreyne/nanoc/graphs">Graphs</a></li>                    
            <li class="active"><a href="/ddfreyne/nanoc">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/ddfreyne">ddfreyne</a> / <b><a href="http://github.com/ddfreyne/nanoc/tree">nanoc</a></b>        
                <a id="namespaces_button" rel="ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section class Nanoc_DataSources_Filesystem">
  <h1>Class: Nanoc::DataSources::Filesystem</h1>
  <div class="section inheritance">
  <ul>
  <li><a href="../Plugin.html" title="Nanoc::Plugin">Nanoc::Plugin</a></li><ul><li><a href="../DataSource.html" title="Nanoc::DataSource">Nanoc::DataSource</a></li><ul><li>Nanoc::DataSources::Filesystem</li>
  </ul></ul></ul>
</div><div class="section docstring">
  <p>
The filesystem data source is the default data source for a new nanoc site.
It stores all data as files on the hard disk.
</p>
<p>
None of the methods are documented in this file. See Nanoc::DataSource for
documentation on the overridden methods instead.
</p>
<h1>Pages</h1>
<p>
The filesystem data source stores its pages in nested directories. Each
directory represents a single page. The root directory is the
&#8216;content&#8217; directory.
</p>
<p>
Every directory has a content file and a meta file. The content file
contains the actual page content, while the meta file contains the
page&#8217;s metadata, formatted as YAML.
</p>
<p>
Both content files and meta files are named after its parent directory
(i.e. page). For example, a page named &#8216;foo&#8217; will have a
directorynamed &#8216;foo&#8217;, with e.g. a &#8216;foo.markdown&#8217;
content file and a &#8216;foo.yaml&#8217; meta file.
</p>
<p>
Content file extensions are not used for determining the filter that should
be run; the meta file defines the list of filters. The meta file extension
must always be &#8216;yaml&#8217;, though.
</p>
<p>
Content files can also have the &#8216;index&#8217; basename. Similarly,
meta files can have the &#8216;meta&#8217; basename. For example, a parent
directory named &#8216;foo&#8217; can have an &#8216;index.txt&#8217;
content file and a &#8216;meta.yaml&#8217; meta file. This is to preserve
backward compatibility.
</p>
<h1>Page defaults</h1>
<p>
The page defaults are loaded from a YAML-formatted file named
&#8216;page_defaults.yaml&#8217; at the top level of the nanoc site
directory. For backward compatibility, the file can also be named
&#8216;meta.yaml&#8217;.
</p>
<h1>Assets</h1>
<p>
Assets are stored in the &#8216;assets&#8217; directory (surprise!). The
structure is very similar to the structure of the &#8216;content&#8217;
directory, so see the Pages section for details on how this directory is
structured.
</p>
<h1>Asset defaults</h1>
<p>
The asset defaults are stored similar to the way page defaults are stored,
except that the asset defaults file is named
&#8216;asset_defaults.yaml&#8217; instead.
</p>
<h1>Layouts</h1>
<p>
Layouts are stored as directories in the &#8216;layouts&#8217; directory.
Each layout contains a content file and a meta file. The content file
contain the actual layout, and the meta file describes how the page should
be handled (contains the filter that should be used).
</p>
<p>
For backward compatibility, a layout can also be a single file in the
&#8216;layouts&#8217; directory. Such a layout cannot have any metadata;
the filter used for this layout is determined from the file extension.
</p>
<h1>Templates</h1>
<p>
Templates are located in the &#8216;templates&#8217; directroy. Every
template is a directory consisting of a content file and a meta file, both
named after the template. This is very similar to the way pages are stored,
except that templates cannot be nested.
</p>
<h1>Code</h1>
<p>
Code is stored in &#8217;.rb&#8217; files in the &#8216;lib&#8217;
directory. Code can reside in sub-directories.
</p>

</div><div class="section attributes">
  
    <div class="">
      <h2>Instance Attributes</h2>
      <table>
      
        <tr>
          <th class="name">vcs</td>
          <td class="readwrite">
            [R<span id='vcs%3D-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
VCSes ##########.
</p>

            
          </td>
        </tr>
      
      </table>
    </div>
  
</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="ASSET_DEFAULTS_FILENAME-constant">ASSET_DEFAULTS_FILENAME</dt>
      <dd>'asset_defaults.yaml'</dd>
    
      <dt id="PAGE_DEFAULTS_FILENAME-constant">PAGE_DEFAULTS_FILENAME</dt>
      <dd>'page_defaults.yaml'</dd>
    
      <dt id="PAGE_DEFAULTS_FILENAME_OLD-constant">PAGE_DEFAULTS_FILENAME_OLD</dt>
      <dd>'meta.yaml'</dd>
    
  </dl>
</div>
<div class="inherited">
  
  <div>
    <h2>Constants Inherited from <a href="../Plugin.html" title="Nanoc::Plugin">Nanoc::Plugin</a></h2>
    <p><span class='name'><a href="../Plugin.html#MAP-constant" title="MAP">MAP</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
</div><div class="section constructor">
<h2>Constructor</h2>
  <p class="inherited_msg">
    This class inherits a constructor from <a href="../DataSource.html#initialize-instance_method" title="Nanoc::DataSource">Nanoc::DataSource</a>.
  </p>
</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <div class="inherited">
  
  <div>
    <h2>Public Class Methods Inherited from <a href="../Plugin.html" title="Nanoc::Plugin">Nanoc::Plugin</a></h2>
    <p><span class='name'><a href="../Plugin.html#identifier-class_method" title="identifier">identifier</a></span>, <span class='name'><a href="../Plugin.html#identifiers-class_method" title="identifiers">identifiers</a></span>, <span class='name'><a href="../Plugin.html#named-class_method" title="named">named</a></span>, <span class='name'><a href="../Plugin.html#register-class_method" title="register">register</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
  <div class="section methodsummary">
    <h2>Public Instance Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#asset_defaults-instance_method">#asset_defaults</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Asset Defaults ##########.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#assets-instance_method">#assets</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Assets ##########.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#code-instance_method">#code</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Code ##########.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_asset-instance_method">#delete_asset</span><span class='args'>(asset)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_layout-instance_method">#delete_layout</span><span class='args'>(layout)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_page-instance_method">#delete_page</span><span class='args'>(page)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#delete_template-instance_method">#delete_template</span><span class='args'>(template)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#destroy-instance_method">#destroy</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#down-instance_method">#down</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#layouts-instance_method">#layouts</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Layouts ##########.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#move_asset-instance_method">#move_asset</span><span class='args'>(asset, new_path)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#move_layout-instance_method">#move_layout</span><span class='args'>(layout, new_path)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#move_page-instance_method">#move_page</span><span class='args'>(page, new_path)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#move_template-instance_method">#move_template</span><span class='args'>(template, new_name)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#page_defaults-instance_method">#page_defaults</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Page Defaults ##########.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#pages-instance_method">#pages</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Pages ##########.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#save_asset-instance_method">#save_asset</span><span class='args'>(asset)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#save_asset_defaults-instance_method">#save_asset_defaults</span><span class='args'>(asset_defaults)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#save_code-instance_method">#save_code</span><span class='args'>(code)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#save_layout-instance_method">#save_layout</span><span class='args'>(layout)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#save_page-instance_method">#save_page</span><span class='args'>(page)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#save_page_defaults-instance_method">#save_page_defaults</span><span class='args'>(page_defaults)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#save_template-instance_method">#save_template</span><span class='args'>(template)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#setup-instance_method">#setup</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#templates-instance_method">#templates</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Templates ##########.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#up-instance_method">#up</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Preparation ##########.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#update-instance_method">#update</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#vcs-instance_method">#vcs</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
VCSes ##########..
</p>

        
      </td>
    </tr>
  
</table><div class="inherited">
  
  <div>
    <h2>Public Instance Methods Inherited from <a href="../DataSource.html" title="Nanoc::DataSource">Nanoc::DataSource</a></h2>
    <p><span class='name'><a href="../DataSource.html#loading-instance_method" title="loading">loading</a></span></p>
  </div>
  
</div>
<div class="clear"></div>
  </div>
<div class="section methoddetails">
  <h2>Public Instance Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>asset_defaults</h3>
</div><div id="asset_defaults-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>asset_defaults</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Asset Defaults ##########
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 327</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L327">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">327
328
329
330
331
332
333
334
335
336
337
338
339
340</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='asset_defaults identifier id'>asset_defaults</span> 
  <span class='if if kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='rparen token'>)</span>
    <span class='comment val'># Get attributes</span>
    <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='YAML constant id'>YAML</span><span class='dot token'>.</span><span class='load_file identifier id'>load_file</span><span class='lparen token'>(</span><span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

    <span class='comment val'># Get mtime</span>
    <span class='mtime identifier id'>mtime</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>

    <span class='comment val'># Build asset defaults</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='AssetDefaults constant id'>AssetDefaults</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='mtime identifier id'>mtime</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='AssetDefaults constant id'>AssetDefaults</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>assets</h3>
</div><div id="assets-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>assets</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Assets ##########
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 212</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L212">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='assets identifier id'>assets</span> 
  <span class='meta_filenames identifier id'>meta_filenames</span><span class='lparen token'>(</span><span class='string val'>'assets'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='meta_filename identifier id'>meta_filename</span><span class='bitor op'>|</span>
    <span class='comment val'># Read metadata</span>
    <span class='meta identifier id'>meta</span> <span class='assign token'>=</span> <span class='YAML constant id'>YAML</span><span class='dot token'>.</span><span class='load_file identifier id'>load_file</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

    <span class='comment val'># Get content file</span>
    <span class='content_filename identifier id'>content_filename</span> <span class='assign token'>=</span> <span class='content_filename_for_dir identifier id'>content_filename_for_dir</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='content_file identifier id'>content_file</span> <span class='assign token'>=</span> <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='Extra constant id'>Extra</span><span class='colon2 op'>::</span><span class='FileProxy constant id'>FileProxy</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>

    <span class='comment val'># Get attributes</span>
    <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='string val'>'extension'</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='extname identifier id'>extname</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='float val'>1</span><span class='dot2 op'>..</span><span class='integer val'>-1</span><span class='rbrack token'>]</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='meta identifier id'>meta</span><span class='rparen token'>)</span>

    <span class='comment val'># Get path</span>
    <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='meta_filename identifier id'>meta_filename</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^assets/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/[^\/]+\.yaml$/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>

    <span class='comment val'># Get modification times</span>
    <span class='meta_mtime identifier id'>meta_mtime</span>    <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>
    <span class='content_mtime identifier id'>content_mtime</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>
    <span class='mtime identifier id'>mtime</span>         <span class='assign token'>=</span> <span class='meta_mtime identifier id'>meta_mtime</span> <span class='gt op'>&gt;</span> <span class='content_mtime identifier id'>content_mtime</span> <span class='integer val'>? </span><span class='meta_mtime identifier id'>meta_mtime</span> <span class='colon op'>:</span> <span class='content_mtime identifier id'>content_mtime</span>

    <span class='comment val'># Create asset object</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='Asset constant id'>Asset</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='content_file identifier id'>content_file</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='mtime identifier id'>mtime</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>code</h3>
</div><div id="code-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>code</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Code ##########
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 536</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L536">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">536
537
538
539
540
541
542
543
544
545
546
547
548
549</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='code identifier id'>code</span> 
  <span class='comment val'># Get files</span>
  <span class='filenames identifier id'>filenames</span> <span class='assign token'>=</span> <span class='Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='string val'>'lib/**/*.rb'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span>

  <span class='comment val'># Get data</span>
  <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='filenames identifier id'>filenames</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='filename identifier id'>filename</span><span class='bitor op'>|</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>&quot;\n&quot;</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>''</span><span class='rparen token'>)</span>

  <span class='comment val'># Get modification time</span>
  <span class='mtimes identifier id'>mtimes</span> <span class='assign token'>=</span> <span class='filenames identifier id'>filenames</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='filename identifier id'>filename</span><span class='bitor op'>|</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span> <span class='rbrace token'>}</span>
  <span class='mtime identifier id'>mtime</span> <span class='assign token'>=</span> <span class='mtimes identifier id'>mtimes</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='memo identifier id'>memo</span><span class='comma token'>,</span> <span class='mtime identifier id'>mtime</span><span class='bitor op'>|</span> <span class='memo identifier id'>memo</span> <span class='gt op'>&gt;</span> <span class='mtime identifier id'>mtime</span> <span class='integer val'>? </span><span class='mtime identifier id'>mtime</span> <span class='colon op'>:</span> <span class='memo identifier id'>memo</span> <span class='rbrace token'>}</span>

  <span class='comment val'># Build code</span>
  <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='Code constant id'>Code</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='data identifier id'>data</span><span class='comma token'>,</span> <span class='mtime identifier id'>mtime</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_asset</h3>
</div><div id="delete_asset-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_asset</span><span class='args'>(asset)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 282</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L282">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">282
283
284</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_asset identifier id'>delete_asset</span><span class='lparen token'>(</span><span class='asset identifier id'>asset</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># TODO implement</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_layout</h3>
</div><div id="delete_layout-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_layout</span><span class='args'>(layout)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 460</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L460">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">460
461
462</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_layout identifier id'>delete_layout</span><span class='lparen token'>(</span><span class='layout identifier id'>layout</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># TODO implement</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_page</h3>
</div><div id="delete_page-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_page</span><span class='args'>(page)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 206</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L206">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">206
207
208</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_page identifier id'>delete_page</span><span class='lparen token'>(</span><span class='page identifier id'>page</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># TODO implement</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>delete_template</h3>
</div><div id="delete_template-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>delete_template</span><span class='args'>(template)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 530</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L530">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">530
531
532</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='delete_template identifier id'>delete_template</span><span class='lparen token'>(</span><span class='template identifier id'>template</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># TODO implement</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>destroy</h3>
</div><div id="destroy-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>destroy</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 106</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L106">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">106
107
108
109
110
111
112
113
114
115
116
117
118</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='destroy identifier id'>destroy</span> 
  <span class='comment val'># Remove files</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='rparen token'>)</span>    <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='rparen token'>)</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='PAGE_DEFAULTS_FILENAME constant id'>PAGE_DEFAULTS_FILENAME</span><span class='rparen token'>)</span>     <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='PAGE_DEFAULTS_FILENAME constant id'>PAGE_DEFAULTS_FILENAME</span><span class='rparen token'>)</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='PAGE_DEFAULTS_FILENAME_OLD constant id'>PAGE_DEFAULTS_FILENAME_OLD</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='PAGE_DEFAULTS_FILENAME_OLD constant id'>PAGE_DEFAULTS_FILENAME_OLD</span><span class='rparen token'>)</span>

  <span class='comment val'># Remove directories</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='string val'>'assets'</span><span class='rparen token'>)</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='string val'>'content'</span><span class='rparen token'>)</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='string val'>'templates'</span><span class='rparen token'>)</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='string val'>'layouts'</span><span class='rparen token'>)</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='string val'>'lib'</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>down</h3>
</div><div id="down-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>down</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 95</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L95">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">95
96</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='down identifier id'>down</span> 
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>layouts</h3>
</div><div id="layouts-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>layouts</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Layouts ##########
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 363</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L363">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='layouts identifier id'>layouts</span> 
  <span class='comment val'># Determine what layout directory structure is being used</span>
  <span class='is_old_school identifier id'>is_old_school</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='string val'>'layouts/*'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='f identifier id'>f</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='is_old_school identifier id'>is_old_school</span>
    <span class='comment val'># Warn about deprecation</span>
    <span class='warn identifier id'>warn</span><span class='lparen token'>(</span>
      <span class='string val'>'DEPRECATION WARNING: nanoc 2.1 changes the way layouts are '</span> <span class='plus op'>+</span>
      <span class='string val'>'stored. Future versions will not support these outdated sites. '</span> <span class='plus op'>+</span>
      <span class='string val'>'To update your site, issue \'nanoc update\'.'</span>
    <span class='rparen token'>)</span>

    <span class='Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>'layouts'</span><span class='comma token'>,</span> <span class='string val'>'*'</span><span class='rparen token'>)</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='reject identifier id'>reject</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span> <span class='f identifier id'>f</span> <span class='match op'>=~</span> <span class='regexp val'>/~$/</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='filename identifier id'>filename</span><span class='bitor op'>|</span>
      <span class='comment val'># Get content</span>
      <span class='content identifier id'>content</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span>

      <span class='comment val'># Get attributes</span>
      <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span> <span class='symbol val'>:extension</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='extname identifier id'>extname</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span><span class='rbrace token'>}</span>

      <span class='comment val'># Get path</span>
      <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='basename identifier id'>basename</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='lbrack token'>[</span><span class='symbol val'>:extension</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>

      <span class='comment val'># Get modification time</span>
      <span class='mtime identifier id'>mtime</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>

      <span class='comment val'># Create layout object</span>
      <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='Layout constant id'>Layout</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='content identifier id'>content</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='mtime identifier id'>mtime</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='meta_filenames identifier id'>meta_filenames</span><span class='lparen token'>(</span><span class='string val'>'layouts'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='meta_filename identifier id'>meta_filename</span><span class='bitor op'>|</span>
      <span class='comment val'># Get content</span>
      <span class='content_filename identifier id'>content_filename</span>  <span class='assign token'>=</span> <span class='content_filename_for_dir identifier id'>content_filename_for_dir</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='content identifier id'>content</span>           <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>

      <span class='comment val'># Get attributes</span>
      <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='YAML constant id'>YAML</span><span class='dot token'>.</span><span class='load_file identifier id'>load_file</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

      <span class='comment val'># Get path</span>
      <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='meta_filename identifier id'>meta_filename</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^layouts\//</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/\/[^\/]+\.yaml$/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>

      <span class='comment val'># Get modification times</span>
      <span class='meta_mtime identifier id'>meta_mtime</span>    <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>
      <span class='content_mtime identifier id'>content_mtime</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>
      <span class='mtime identifier id'>mtime</span>         <span class='assign token'>=</span> <span class='meta_mtime identifier id'>meta_mtime</span> <span class='gt op'>&gt;</span> <span class='content_mtime identifier id'>content_mtime</span> <span class='integer val'>? </span><span class='meta_mtime identifier id'>meta_mtime</span> <span class='colon op'>:</span> <span class='content_mtime identifier id'>content_mtime</span>

      <span class='comment val'># Create layout object</span>
      <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='Layout constant id'>Layout</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='content identifier id'>content</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='mtime identifier id'>mtime</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>move_asset</h3>
</div><div id="move_asset-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>move_asset</span><span class='args'>(asset, new_path)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 278</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L278">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">278
279
280</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='move_asset identifier id'>move_asset</span><span class='lparen token'>(</span><span class='asset identifier id'>asset</span><span class='comma token'>,</span> <span class='new_path identifier id'>new_path</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># TODO implement</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>move_layout</h3>
</div><div id="move_layout-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>move_layout</span><span class='args'>(layout, new_path)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 456</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L456">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">456
457
458</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='move_layout identifier id'>move_layout</span><span class='lparen token'>(</span><span class='layout identifier id'>layout</span><span class='comma token'>,</span> <span class='new_path identifier id'>new_path</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># TODO implement</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>move_page</h3>
</div><div id="move_page-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>move_page</span><span class='args'>(page, new_path)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 202</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L202">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">202
203
204</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='move_page identifier id'>move_page</span><span class='lparen token'>(</span><span class='page identifier id'>page</span><span class='comma token'>,</span> <span class='new_path identifier id'>new_path</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># TODO implement</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>move_template</h3>
</div><div id="move_template-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>move_template</span><span class='args'>(template, new_name)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 526</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L526">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">526
527
528</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='move_template identifier id'>move_template</span><span class='lparen token'>(</span><span class='template identifier id'>template</span><span class='comma token'>,</span> <span class='new_name identifier id'>new_name</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># TODO implement</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>page_defaults</h3>
</div><div id="page_defaults-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>page_defaults</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Page Defaults ##########
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 288</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L288">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">288
289
290
291
292
293
294
295
296
297
298</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='page_defaults identifier id'>page_defaults</span> 
  <span class='comment val'># Get attributes</span>
  <span class='filename identifier id'>filename</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='PAGE_DEFAULTS_FILENAME constant id'>PAGE_DEFAULTS_FILENAME</span><span class='rparen token'>)</span> <span class='question op'>?</span> <span class='PAGE_DEFAULTS_FILENAME constant id'>PAGE_DEFAULTS_FILENAME</span> <span class='colon op'>:</span> <span class='PAGE_DEFAULTS_FILENAME_OLD constant id'>PAGE_DEFAULTS_FILENAME_OLD</span>
  <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='YAML constant id'>YAML</span><span class='dot token'>.</span><span class='load_file identifier id'>load_file</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

  <span class='comment val'># Get mtime</span>
  <span class='mtime identifier id'>mtime</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>

  <span class='comment val'># Build page defaults</span>
  <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='PageDefaults constant id'>PageDefaults</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='mtime identifier id'>mtime</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>pages</h3>
</div><div id="pages-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>pages</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Pages ##########
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 128</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L128">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='pages identifier id'>pages</span> 
  <span class='meta_filenames identifier id'>meta_filenames</span><span class='lparen token'>(</span><span class='string val'>'content'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='meta_filename identifier id'>meta_filename</span><span class='bitor op'>|</span>
    <span class='comment val'># Read metadata</span>
    <span class='meta identifier id'>meta</span> <span class='assign token'>=</span> <span class='YAML constant id'>YAML</span><span class='dot token'>.</span><span class='load_file identifier id'>load_file</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

    <span class='if if kw'>if</span> <span class='meta identifier id'>meta</span><span class='lbrack token'>[</span><span class='string val'>'is_draft'</span><span class='rbrack token'>]</span>
      <span class='comment val'># Skip drafts</span>
      <span class='nil nil kw'>nil</span>
    <span class='else else kw'>else</span>
      <span class='comment val'># Get content</span>
      <span class='content_filename identifier id'>content_filename</span> <span class='assign token'>=</span> <span class='content_filename_for_dir identifier id'>content_filename_for_dir</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
      <span class='content identifier id'>content</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>

      <span class='comment val'># Get attributes</span>
      <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='meta identifier id'>meta</span><span class='dot token'>.</span><span class='merge identifier id'>merge</span><span class='lparen token'>(</span><span class='symbol val'>:file</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='Extra constant id'>Extra</span><span class='colon2 op'>::</span><span class='FileProxy constant id'>FileProxy</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

      <span class='comment val'># Get path</span>
      <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='meta_filename identifier id'>meta_filename</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^content/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/[^\/]+\.yaml$/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>

      <span class='comment val'># Get modification times</span>
      <span class='meta_mtime identifier id'>meta_mtime</span>    <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>
      <span class='content_mtime identifier id'>content_mtime</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='stat identifier id'>stat</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span>
      <span class='mtime identifier id'>mtime</span>         <span class='assign token'>=</span> <span class='meta_mtime identifier id'>meta_mtime</span> <span class='gt op'>&gt;</span> <span class='content_mtime identifier id'>content_mtime</span> <span class='integer val'>? </span><span class='meta_mtime identifier id'>meta_mtime</span> <span class='colon op'>:</span> <span class='content_mtime identifier id'>content_mtime</span>

      <span class='comment val'># Create page object</span>
      <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='Page constant id'>Page</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='content identifier id'>content</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='mtime identifier id'>mtime</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span><span class='dot token'>.</span><span class='compact identifier id'>compact</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save_asset</h3>
</div><div id="save_asset-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save_asset</span><span class='args'>(asset)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 237</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L237">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='save_asset identifier id'>save_asset</span><span class='lparen token'>(</span><span class='asset identifier id'>asset</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># Determine meta file path</span>
  <span class='last_component identifier id'>last_component</span> <span class='assign token'>=</span> <span class='asset identifier id'>asset</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'/'</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span>
  <span class='meta_filename identifier id'>meta_filename</span>  <span class='assign token'>=</span> <span class='string val'>'assets'</span> <span class='plus op'>+</span> <span class='asset identifier id'>asset</span><span class='dot token'>.</span><span class='path identifier id'>path</span> <span class='plus op'>+</span> <span class='last_component identifier id'>last_component</span> <span class='plus op'>+</span> <span class='string val'>'.yaml'</span>

  <span class='comment val'># Get existing path</span>
  <span class='existing_path identifier id'>existing_path</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='existing_path identifier id'>existing_path</span> <span class='assign token'>=</span> <span class='meta_filename_best identifier id'>meta_filename_best</span>  <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='meta_filename_best identifier id'>meta_filename_best</span><span class='rparen token'>)</span>
  <span class='existing_path identifier id'>existing_path</span> <span class='assign token'>=</span> <span class='meta_filename_worst identifier id'>meta_filename_worst</span> <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='meta_filename_worst identifier id'>meta_filename_worst</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='meta_filename identifier id'>meta_filename</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='comment val'># Get filenames</span>
    <span class='dir_path identifier id'>dir_path</span>         <span class='assign token'>=</span> <span class='string val'>'assets'</span> <span class='plus op'>+</span> <span class='asset identifier id'>asset</span><span class='dot token'>.</span><span class='path identifier id'>path</span>
    <span class='content_filename identifier id'>content_filename</span> <span class='assign token'>=</span> <span class='string val'>'assets'</span> <span class='plus op'>+</span> <span class='asset identifier id'>asset</span><span class='dot token'>.</span><span class='path identifier id'>path</span> <span class='plus op'>+</span> <span class='last_component identifier id'>last_component</span> <span class='plus op'>+</span> <span class='string val'>'.dat'</span>

    <span class='comment val'># Notify</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>

    <span class='comment val'># Create directories if necessary</span>
    <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mkdir_p identifier id'>mkdir_p</span><span class='lparen token'>(</span><span class='dir_path identifier id'>dir_path</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='comment val'># Get filenames</span>
    <span class='content_filename identifier id'>content_filename</span> <span class='assign token'>=</span> <span class='content_filename_for_dir identifier id'>content_filename_for_dir</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

    <span class='comment val'># Notify</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Write files</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='comma token'>,</span>    <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span> <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='asset identifier id'>asset</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='to_split_yaml identifier id'>to_split_yaml</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='rbrace token'>}</span>

  <span class='comment val'># Add to working copy if possible</span>
  <span class='if if kw'>if</span> <span class='meta_filename identifier id'>meta_filename</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save_asset_defaults</h3>
</div><div id="save_asset_defaults-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save_asset_defaults</span><span class='args'>(asset_defaults)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 342</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L342">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='save_asset_defaults identifier id'>save_asset_defaults</span><span class='lparen token'>(</span><span class='asset_defaults identifier id'>asset_defaults</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># Notify</span>
  <span class='if if kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='rparen token'>)</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='rparen token'>)</span>
    <span class='created identifier id'>created</span>  <span class='assign token'>=</span> <span class='false false kw'>false</span>
  <span class='else else kw'>else</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='rparen token'>)</span>
    <span class='created identifier id'>created</span>  <span class='assign token'>=</span> <span class='true true kw'>true</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Write</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span>
    <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='asset_defaults identifier id'>asset_defaults</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='to_split_yaml identifier id'>to_split_yaml</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Add to working copy if possible</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='ASSET_DEFAULTS_FILENAME constant id'>ASSET_DEFAULTS_FILENAME</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='created identifier id'>created</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save_code</h3>
</div><div id="save_code-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save_code</span><span class='args'>(code)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 551</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L551">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='save_code identifier id'>save_code</span><span class='lparen token'>(</span><span class='code identifier id'>code</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># Check whether code existed</span>
  <span class='existed identifier id'>existed</span> <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='string val'>'lib/default.rb'</span><span class='rparen token'>)</span>

  <span class='comment val'># Remove all existing code files</span>
  <span class='Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='string val'>'lib/**/*.rb'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='file identifier id'>file</span><span class='bitor op'>|</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='file identifier id'>file</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='file identifier id'>file</span> <span class='eq op'>==</span> <span class='string val'>'lib/default.rb'</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Notify</span>
  <span class='if if kw'>if</span> <span class='existed identifier id'>existed</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='string val'>'lib/default.rb'</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='string val'>'lib/default.rb'</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Write new code</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='string val'>'lib/default.rb'</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span>
    <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='code identifier id'>code</span><span class='dot token'>.</span><span class='data identifier id'>data</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Add to working copy if possible</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='string val'>'lib/default.rb'</span><span class='rparen token'>)</span> <span class='unless unless_mod kw'>unless</span> <span class='existed identifier id'>existed</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save_layout</h3>
</div><div id="save_layout-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save_layout</span><span class='args'>(layout)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 414</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L414">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='save_layout identifier id'>save_layout</span><span class='lparen token'>(</span><span class='layout identifier id'>layout</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># Determine what layout directory structure is being used</span>
  <span class='is_old_school identifier id'>is_old_school</span> <span class='assign token'>=</span> <span class='lparen token'>(</span><span class='Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='string val'>'layouts/*'</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='select identifier id'>select</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='f identifier id'>f</span><span class='bitor op'>|</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='f identifier id'>f</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span><span class='dot token'>.</span><span class='size identifier id'>size</span> <span class='gt op'>&gt;</span> <span class='integer val'>0</span><span class='rparen token'>)</span>
  <span class='error_outdated identifier id'>error_outdated</span> <span class='if if_mod kw'>if</span> <span class='is_old_school identifier id'>is_old_school</span>

  <span class='comment val'># Get paths</span>
  <span class='last_component identifier id'>last_component</span>    <span class='assign token'>=</span> <span class='layout identifier id'>layout</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'/'</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span>
  <span class='dir_path identifier id'>dir_path</span>          <span class='assign token'>=</span> <span class='string val'>'layouts'</span> <span class='plus op'>+</span> <span class='layout identifier id'>layout</span><span class='dot token'>.</span><span class='path identifier id'>path</span>
  <span class='meta_filename identifier id'>meta_filename</span>     <span class='assign token'>=</span> <span class='dir_path identifier id'>dir_path</span> <span class='plus op'>+</span> <span class='last_component identifier id'>last_component</span> <span class='plus op'>+</span> <span class='string val'>'.yaml'</span>
  <span class='content_filename identifier id'>content_filename</span>  <span class='assign token'>=</span> <span class='Dir constant id'>Dir</span><span class='lbrack token'>[</span><span class='dir_path identifier id'>dir_path</span> <span class='plus op'>+</span> <span class='last_component identifier id'>last_component</span> <span class='plus op'>+</span> <span class='string val'>'.*'</span><span class='rbrack token'>]</span><span class='lbrack token'>[</span><span class='integer val'>0</span><span class='rbrack token'>]</span>

  <span class='if if kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='created identifier id'>created</span> <span class='assign token'>=</span> <span class='false false kw'>false</span>

    <span class='comment val'># Notify</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='created identifier id'>created</span> <span class='assign token'>=</span> <span class='true true kw'>true</span>

    <span class='comment val'># Create dir</span>
    <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mkdir_p identifier id'>mkdir_p</span><span class='lparen token'>(</span><span class='dir_path identifier id'>dir_path</span><span class='rparen token'>)</span>

    <span class='comment val'># Get content filename</span>
    <span class='content_filename identifier id'>content_filename</span> <span class='assign token'>=</span> <span class='dir_path identifier id'>dir_path</span> <span class='plus op'>+</span> <span class='last_component identifier id'>last_component</span> <span class='plus op'>+</span> <span class='string val'>'.html'</span>

    <span class='comment val'># Notify</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Write files</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='comma token'>,</span>    <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span> <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='layout identifier id'>layout</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='to_split_yaml identifier id'>to_split_yaml</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span> <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='layout identifier id'>layout</span><span class='dot token'>.</span><span class='content identifier id'>content</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>

  <span class='comment val'># Add to working copy if possible</span>
  <span class='if if kw'>if</span> <span class='created identifier id'>created</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save_page</h3>
</div><div id="save_page-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save_page</span><span class='args'>(page)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 158</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L158">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='save_page identifier id'>save_page</span><span class='lparen token'>(</span><span class='page identifier id'>page</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># Determine possible meta file paths</span>
  <span class='last_component identifier id'>last_component</span> <span class='assign token'>=</span> <span class='page identifier id'>page</span><span class='dot token'>.</span><span class='path identifier id'>path</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'/'</span><span class='rparen token'>)</span><span class='lbrack token'>[</span><span class='integer val'>-1</span><span class='rbrack token'>]</span>
  <span class='meta_filename_worst identifier id'>meta_filename_worst</span> <span class='assign token'>=</span> <span class='string val'>'content'</span> <span class='plus op'>+</span> <span class='page identifier id'>page</span><span class='dot token'>.</span><span class='path identifier id'>path</span> <span class='plus op'>+</span> <span class='string val'>'index.yaml'</span>
  <span class='meta_filename_best identifier id'>meta_filename_best</span>  <span class='assign token'>=</span> <span class='string val'>'content'</span> <span class='plus op'>+</span> <span class='page identifier id'>page</span><span class='dot token'>.</span><span class='path identifier id'>path</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='last_component identifier id'>last_component</span> <span class='orop op'>||</span> <span class='string val'>'content'</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>'.yaml'</span>

  <span class='comment val'># Get existing path</span>
  <span class='existing_path identifier id'>existing_path</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='existing_path identifier id'>existing_path</span> <span class='assign token'>=</span> <span class='meta_filename_best identifier id'>meta_filename_best</span>  <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='meta_filename_best identifier id'>meta_filename_best</span><span class='rparen token'>)</span>
  <span class='existing_path identifier id'>existing_path</span> <span class='assign token'>=</span> <span class='meta_filename_worst identifier id'>meta_filename_worst</span> <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='meta_filename_worst identifier id'>meta_filename_worst</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='existing_path identifier id'>existing_path</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='comment val'># Get filenames</span>
    <span class='dir_path identifier id'>dir_path</span>         <span class='assign token'>=</span> <span class='string val'>'content'</span> <span class='plus op'>+</span> <span class='page identifier id'>page</span><span class='dot token'>.</span><span class='path identifier id'>path</span>
    <span class='meta_filename identifier id'>meta_filename</span>    <span class='assign token'>=</span> <span class='meta_filename_best identifier id'>meta_filename_best</span>
    <span class='content_filename identifier id'>content_filename</span> <span class='assign token'>=</span> <span class='string val'>'content'</span> <span class='plus op'>+</span> <span class='page identifier id'>page</span><span class='dot token'>.</span><span class='path identifier id'>path</span> <span class='plus op'>+</span> <span class='lparen token'>(</span><span class='last_component identifier id'>last_component</span> <span class='orop op'>||</span> <span class='string val'>'content'</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>'.html'</span>

    <span class='comment val'># Notify</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>

    <span class='comment val'># Create directories if necessary</span>
    <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mkdir_p identifier id'>mkdir_p</span><span class='lparen token'>(</span><span class='dir_path identifier id'>dir_path</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='comment val'># Get filenames</span>
    <span class='meta_filename identifier id'>meta_filename</span>    <span class='assign token'>=</span> <span class='existing_path identifier id'>existing_path</span>
    <span class='content_filename identifier id'>content_filename</span> <span class='assign token'>=</span> <span class='content_filename_for_dir identifier id'>content_filename_for_dir</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='existing_path identifier id'>existing_path</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

    <span class='comment val'># Notify</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Write files</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='comma token'>,</span>    <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span> <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='page identifier id'>page</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='to_split_yaml identifier id'>to_split_yaml</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span> <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='page identifier id'>page</span><span class='dot token'>.</span><span class='content identifier id'>content</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>

  <span class='comment val'># Add to working copy if possible</span>
  <span class='if if kw'>if</span> <span class='existing_path identifier id'>existing_path</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save_page_defaults</h3>
</div><div id="save_page_defaults-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save_page_defaults</span><span class='args'>(page_defaults)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 300</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L300">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='save_page_defaults identifier id'>save_page_defaults</span><span class='lparen token'>(</span><span class='page_defaults identifier id'>page_defaults</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># Notify</span>
  <span class='if if kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='PAGE_DEFAULTS_FILENAME constant id'>PAGE_DEFAULTS_FILENAME</span><span class='rparen token'>)</span>
    <span class='filename identifier id'>filename</span> <span class='assign token'>=</span> <span class='PAGE_DEFAULTS_FILENAME constant id'>PAGE_DEFAULTS_FILENAME</span>
    <span class='created identifier id'>created</span>  <span class='assign token'>=</span> <span class='false false kw'>false</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
  <span class='elsif elsif kw'>elsif</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='PAGE_DEFAULTS_FILENAME_OLD constant id'>PAGE_DEFAULTS_FILENAME_OLD</span><span class='rparen token'>)</span>
    <span class='filename identifier id'>filename</span> <span class='assign token'>=</span> <span class='PAGE_DEFAULTS_FILENAME_OLD constant id'>PAGE_DEFAULTS_FILENAME_OLD</span>
    <span class='created identifier id'>created</span>  <span class='assign token'>=</span> <span class='false false kw'>false</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='filename identifier id'>filename</span> <span class='assign token'>=</span> <span class='PAGE_DEFAULTS_FILENAME constant id'>PAGE_DEFAULTS_FILENAME</span>
    <span class='created identifier id'>created</span>  <span class='assign token'>=</span> <span class='true true kw'>true</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='filename identifier id'>filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Write</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span>
    <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='page_defaults identifier id'>page_defaults</span><span class='dot token'>.</span><span class='attributes identifier id'>attributes</span><span class='dot token'>.</span><span class='to_split_yaml identifier id'>to_split_yaml</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Add to working copy if possible</span>
  <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='filename identifier id'>filename</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='created identifier id'>created</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>save_template</h3>
</div><div id="save_template-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>save_template</span><span class='args'>(template)</span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 483</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L483">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='save_template identifier id'>save_template</span><span class='lparen token'>(</span><span class='template identifier id'>template</span><span class='rparen token'>)</span> <span class='comment val'># :nodoc:</span>
  <span class='comment val'># Determine possible meta file paths</span>
  <span class='meta_filename_worst identifier id'>meta_filename_worst</span> <span class='assign token'>=</span> <span class='string val'>'templates/'</span> <span class='plus op'>+</span> <span class='template identifier id'>template</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='plus op'>+</span> <span class='string val'>'/index.yaml'</span>
  <span class='meta_filename_best identifier id'>meta_filename_best</span>  <span class='assign token'>=</span> <span class='string val'>'templates/'</span> <span class='plus op'>+</span> <span class='template identifier id'>template</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='plus op'>+</span> <span class='string val'>'/'</span> <span class='plus op'>+</span> <span class='template identifier id'>template</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='plus op'>+</span> <span class='string val'>'.yaml'</span>

  <span class='comment val'># Get existing path</span>
  <span class='existing_path identifier id'>existing_path</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='existing_path identifier id'>existing_path</span> <span class='assign token'>=</span> <span class='meta_filename_best identifier id'>meta_filename_best</span>  <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='meta_filename_best identifier id'>meta_filename_best</span><span class='rparen token'>)</span>
  <span class='existing_path identifier id'>existing_path</span> <span class='assign token'>=</span> <span class='meta_filename_worst identifier id'>meta_filename_worst</span> <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='file? fid id'>file?</span><span class='lparen token'>(</span><span class='meta_filename_worst identifier id'>meta_filename_worst</span><span class='rparen token'>)</span>

  <span class='if if kw'>if</span> <span class='existing_path identifier id'>existing_path</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='comment val'># Get filenames</span>
    <span class='dir_path identifier id'>dir_path</span>         <span class='assign token'>=</span> <span class='string val'>'templates/'</span> <span class='plus op'>+</span> <span class='template identifier id'>template</span><span class='dot token'>.</span><span class='name identifier id'>name</span>
    <span class='meta_filename identifier id'>meta_filename</span>    <span class='assign token'>=</span> <span class='meta_filename_best identifier id'>meta_filename_best</span>
    <span class='content_filename identifier id'>content_filename</span> <span class='assign token'>=</span> <span class='string val'>'templates/'</span> <span class='plus op'>+</span> <span class='template identifier id'>template</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='plus op'>+</span> <span class='string val'>'/'</span> <span class='plus op'>+</span> <span class='template identifier id'>template</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='plus op'>+</span> <span class='string val'>'.html'</span>

    <span class='comment val'># Notify</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_created</span><span class='comma token'>,</span> <span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>

    <span class='comment val'># Create directories if necessary</span>
    <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mkdir_p identifier id'>mkdir_p</span><span class='lparen token'>(</span><span class='dir_path identifier id'>dir_path</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='comment val'># Get filenames</span>
    <span class='meta_filename identifier id'>meta_filename</span>    <span class='assign token'>=</span> <span class='existing_path identifier id'>existing_path</span>
    <span class='content_filename identifier id'>content_filename</span> <span class='assign token'>=</span> <span class='content_filename_for_dir identifier id'>content_filename_for_dir</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='existing_path identifier id'>existing_path</span><span class='rparen token'>)</span><span class='rparen token'>)</span>

    <span class='comment val'># Notify</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='NotificationCenter constant id'>NotificationCenter</span><span class='dot token'>.</span><span class='post identifier id'>post</span><span class='lparen token'>(</span><span class='symbol val'>:file_updated</span><span class='comma token'>,</span> <span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>

  <span class='comment val'># Write files</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='comma token'>,</span>    <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span> <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='template identifier id'>template</span><span class='dot token'>.</span><span class='page_attributes identifier id'>page_attributes</span><span class='dot token'>.</span><span class='to_split_yaml identifier id'>to_split_yaml</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  <span class='File constant id'>File</span><span class='dot token'>.</span><span class='open identifier id'>open</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='comma token'>,</span> <span class='string val'>'w'</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='io identifier id'>io</span><span class='bitor op'>|</span> <span class='io identifier id'>io</span><span class='dot token'>.</span><span class='write identifier id'>write</span><span class='lparen token'>(</span><span class='template identifier id'>template</span><span class='dot token'>.</span><span class='page_content identifier id'>page_content</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>

  <span class='comment val'># Add to working copy if possible</span>
  <span class='if if kw'>if</span> <span class='existing_path identifier id'>existing_path</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>setup</h3>
</div><div id="setup-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>setup</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 98</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L98">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">98
99
100
101
102
103
104</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='setup identifier id'>setup</span> 
  <span class='comment val'># Create directories</span>
  <span class='dstring node'>%w( assets content templates layouts lib )</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='dir identifier id'>dir</span><span class='bitor op'>|</span>
    <span class='FileUtils constant id'>FileUtils</span><span class='dot token'>.</span><span class='mkdir_p identifier id'>mkdir_p</span><span class='lparen token'>(</span><span class='dir identifier id'>dir</span><span class='rparen token'>)</span>
    <span class='vcs identifier id'>vcs</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='dir identifier id'>dir</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>templates</h3>
</div><div id="templates-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>templates</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Templates ##########
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 466</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L466">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='templates identifier id'>templates</span> 
  <span class='meta_filenames identifier id'>meta_filenames</span><span class='lparen token'>(</span><span class='string val'>'templates'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='map identifier id'>map</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='meta_filename identifier id'>meta_filename</span><span class='bitor op'>|</span>
    <span class='comment val'># Get name</span>
    <span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='meta_filename identifier id'>meta_filename</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^templates\/(.*)\/[^\/]+\.yaml$/</span><span class='comma token'>,</span> <span class='string val'>'\1'</span><span class='rparen token'>)</span>

    <span class='comment val'># Get content</span>
    <span class='content_filename identifier id'>content_filename</span>  <span class='assign token'>=</span> <span class='content_filename_for_dir identifier id'>content_filename_for_dir</span><span class='lparen token'>(</span><span class='File constant id'>File</span><span class='dot token'>.</span><span class='dirname identifier id'>dirname</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span><span class='rparen token'>)</span>
    <span class='content identifier id'>content</span>           <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='read identifier id'>read</span><span class='lparen token'>(</span><span class='content_filename identifier id'>content_filename</span><span class='rparen token'>)</span>

    <span class='comment val'># Get attributes</span>
    <span class='attributes identifier id'>attributes</span> <span class='assign token'>=</span> <span class='YAML constant id'>YAML</span><span class='dot token'>.</span><span class='load_file identifier id'>load_file</span><span class='lparen token'>(</span><span class='meta_filename identifier id'>meta_filename</span><span class='rparen token'>)</span> <span class='orop op'>||</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>

    <span class='comment val'># Build template</span>
    <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='Template constant id'>Template</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='content identifier id'>content</span><span class='comma token'>,</span> <span class='attributes identifier id'>attributes</span><span class='comma token'>,</span> <span class='name identifier id'>name</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>up</h3>
</div><div id="up-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>up</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Preparation ##########
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 92</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L92">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">92
93</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='up identifier id'>up</span> 
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>update</h3>
</div><div id="update-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>update</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 120</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L120">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">120
121
122
123
124</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='update identifier id'>update</span> 
  <span class='update_page_defaults identifier id'>update_page_defaults</span>
  <span class='update_pages identifier id'>update_pages</span>
  <span class='update_templates identifier id'>update_templates</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>vcs</h3>
</div><div id="vcs-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>vcs</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
VCSes ##########
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/nanoc/data_sources/filesystem.rb', line 84</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/ddfreyne/nanoc/blob/1751d2739431a6113a296f90fa4cd4863d610d12/lib/nanoc/data_sources/filesystem.rb#L84">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">84
85
86</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='vcs identifier id'>vcs</span>
  <span class='@vcs ivar id'>@vcs</span> <span class='opasgn op'>||=</span> <span class='Nanoc constant id'>Nanoc</span><span class='colon2 op'>::</span><span class='Extra constant id'>Extra</span><span class='colon2 op'>::</span><span class='VCSes constant id'>VCSes</span><span class='colon2 op'>::</span><span class='Dummy constant id'>Dummy</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>