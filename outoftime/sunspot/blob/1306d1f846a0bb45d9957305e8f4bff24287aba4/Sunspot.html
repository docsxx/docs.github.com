<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>outoftime's sunspot - Module: Sunspot - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/outoftime/commits/sunspot/master" rel="alternate" title="Recent Commits to sunspot:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("outoftime", "sunspot", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("outoftime", "sunspot", "1306d1f846a0bb45d9957305e8f4bff24287aba4", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/outoftime/sunspot/tree/">Source</a></li>
            <li class=""><a href="http://github.com/outoftime/sunspot/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/outoftime/sunspot/network">Network</a></li>            
            <li class=""><a href="http://github.com/outoftime/sunspot/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/outoftime/sunspot">Wiki</a></li>
            <li class=""><a href="http://github.com/outoftime/sunspot/graphs">Graphs</a></li>                    
            <li class="active"><a href="/outoftime/sunspot">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/outoftime">outoftime</a> / <b><a href="http://github.com/outoftime/sunspot/tree">sunspot</a></b>        
                <a id="namespaces_button" rel="outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="wikistyle">
  <div class="section module Sunspot">
  <h1>Module: Sunspot</h1>
  <div class="section docstring">
  <p>
The Sunspot module provides class-method entry points to most of the
functionality provided by the Sunspot library. Internally, the Sunspot
singleton class contains a (non-thread-safe!) instance of Sunspot::Session,
to which it delegates most of the class methods it exposes. In the method
documentation below, this instance is referred to as the &quot;singleton
session&quot;.
</p>
<p>
Though the singleton session provides a convenient entry point to Sunspot,
it is by no means required to use the Sunspot class methods. Multiple
sessions may be instantiated and used (if you need to connect to multiple
Solr instances, for example.)
</p>
<p>
Note that the configuration of classes for index/search (the <tt>setup</tt>
method) is <em>not</em> session-specific, but rather global.
</p>

</div><div class="section constants">
  <div class="thisclass">
  <h2>Constants</h2>
  <dl>
    
      <dt id="NoAdapterError-constant">NoAdapterError</dt>
      <dd>Class.new(Exception)</dd>
    
      <dt id="NoSetupError-constant">NoSetupError</dt>
      <dd>Class.new(Exception)</dd>
    
      <dt id="UnrecognizedFieldError-constant">UnrecognizedFieldError</dt>
      <dd>Class.new(Exception)</dd>
    
      <dt id="UnrecognizedRestrictionError-constant">UnrecognizedRestrictionError</dt>
      <dd>Class.new(Exception)</dd>
    
  </dl>
</div>

</div>  <div class="section visibilitygroup">
      <div class="section methodsummary">
    <h2>Public Class Method Summary</h2>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#batch-class_method">batch</span><span class='args'>(&amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Process all adds in a batch.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#commit-class_method">commit</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Commits the singleton session.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#commit_if_dirty-class_method">commit_if_dirty</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Sends a commit if the session is dirty (see #dirty?).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#config-class_method">config</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Returns the configuration associated with the singleton session.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#dirty-3F-class_method">dirty?</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
True if documents have been added, updated, or removed since the last
commit.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#index-class_method">index</span><span class='args'>(*objects)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Indexes objects on the singleton session.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#index-21-class_method">index!</span><span class='args'>(*objects)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Indexes objects on the singleton session and commits immediately.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#new_search-class_method">new_search</span><span class='args'>(*types)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Create a new Search instance, but do not execute it immediately.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove-class_method">remove</span><span class='args'>(*objects)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Remove objects from the index.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove-21-class_method">remove!</span><span class='args'></span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Remove objects from the index and immediately commit.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_all-class_method">remove_all</span><span class='args'>(*classes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Remove all objects of the given classes from the index.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_all-21-class_method">remove_all!</span><span class='args'>(*classes)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Remove all objects of the given classes from the index and immediately
commit.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_by_id-class_method">remove_by_id</span><span class='args'>(clazz, id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Remove an object from the index using its class name and primary key.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#remove_by_id-21-class_method">remove_by_id!</span><span class='args'>(clazz, id)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Remove an object by class name and primary key, and immediately commit.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#reset-21-class_method">reset!</span><span class='args'>(keep_config = false)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Resets the singleton session.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#search-class_method">search</span><span class='args'>(*types, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Search for objects in the index.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#setup-class_method">setup</span><span class='args'>(clazz, &amp;block)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Configures indexing and search for a given class.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails">
  <h2>Public Class Method Details</h2>
  
    <div class="method">
      <div class="method_header">
  <h3>batch</h3>
</div><div id="batch-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>batch</span><span class='args'>(&amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Process all adds in a batch. Any Sunspot adds initiated inside the block
will be sent in bulk when the block finishes. Useful if your application
initiates index adds from various places in code as part of a single
operation; doing a batch add will give better performance.
</p>
<h4>Example</h4>
<pre class="code">
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='batch identifier id'>batch</span> <span class='do do kw'>do</span>
    <span class='post identifier id'>post</span> <span class='assign token'>=</span> <span class='Post constant id'>Post</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='post identifier id'>post</span><span class='rparen token'>)</span>
    <span class='comment identifier id'>comment</span> <span class='assign token'>=</span> <span class='Comment constant id'>Comment</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
    <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='add identifier id'>add</span><span class='lparen token'>(</span><span class='comment identifier id'>comment</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
</pre>
<p>
Sunspot will send both the post and the comment in a single request.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 403</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L403">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">403
404
405</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='batch identifier id'>batch</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='batch identifier id'>batch</span><span class='lparen token'>(</span><span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>commit</h3>
</div><div id="commit-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>commit</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Commits the singleton session
</p>
<p>
When documents are added to or removed from Solr, the changes are initially
stored in memory, and are not reflected in Solr&#8217;s existing searcher
instance. When a commit message is sent, the changes are written to disk,
and a new searcher is spawned. Commits are thus fairly expensive, so if
your application needs to index several documents as part of a single
operation, it is advisable to index them all and then call commit at the
end of the operation.
</p>
<p>
Note that Solr can also be configured to automatically perform a commit
after either a specified interval after the last change, or after a
specified number of documents are added. See
http://wiki.apache.org/solr/SolrConfigXml
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 190</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L190">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">190
191
192</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='commit identifier id'>commit</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='commit identifier id'>commit</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>commit_if_dirty</h3>
</div><div id="commit_if_dirty-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>commit_if_dirty</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Sends a commit if the session is dirty (see #dirty?).
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 422</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L422">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">422
423
424</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='commit_if_dirty identifier id'>commit_if_dirty</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='commit_if_dirty identifier id'>commit_if_dirty</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>config</h3>
</div><div id="config-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>config</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Returns the configuration associated with the singleton session. See
Sunspot::Configuration for details.
</p>
<h4>Returns</h4>
<table>
<tr><td valign="top">LightConfig::Configuration:</td><td>configuration for singleton session

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 433</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L433">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">433
434
435</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='config identifier id'>config</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='config identifier id'>config</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>dirty?</h3>
</div><div id="dirty-3F-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>dirty?</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
True if documents have been added, updated, or removed since the last
commit.
</p>
<h4>Returns</h4>
<table>
<tr><td valign="top">Boolean:</td><td>Whether there have been any updates since the last commit

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 415</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L415">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">415
416
417</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='dirty? fid id'>dirty?</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='dirty? fid id'>dirty?</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>index</h3>
</div><div id="index-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>index</span><span class='args'>(*objects)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Indexes objects on the singleton session.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">objects&#8230;&lt;Object&gt;:</td><td>objects to index (may pass an array or varargs)

</td></tr>
</table>
<h4>Example</h4>
<pre class="code">
  <span class='post1 identifier id'>post1</span><span class='comma token'>,</span> <span class='post2 identifier id'>post2</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='lparen token'>(</span><span class='integer val'>2</span><span class='rparen token'>)</span> <span class='lbrace token'>{</span> <span class='Post constant id'>Post</span><span class='dot token'>.</span><span class='create identifier id'>create</span> <span class='rbrace token'>}</span>
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='index identifier id'>index</span><span class='lparen token'>(</span><span class='post1 identifier id'>post1</span><span class='comma token'>,</span> <span class='post2 identifier id'>post2</span><span class='rparen token'>)</span>
</pre>
<p>
Note that indexed objects won&#8217;t be reflected in search until a commit
is sent - see Sunspot.index! and Sunspot.commit
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 159</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L159">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">159
160
161</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='index identifier id'>index</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='objects identifier id'>objects</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='index identifier id'>index</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='objects identifier id'>objects</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>index!</h3>
</div><div id="index-21-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>index!</span><span class='args'>(*objects)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Indexes objects on the singleton session and commits immediately.
</p>
<p>
See: Sunspot.index and Sunspot.commit
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">objects&#8230;&lt;Object&gt;:</td><td>objects to index (may pass an array or varargs)

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 171</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L171">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">171
172
173</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='index! fid id'>index!</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='objects identifier id'>objects</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='index! fid id'>index!</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='objects identifier id'>objects</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>new_search</h3>
</div><div id="new_search-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>new_search</span><span class='args'>(*types)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Create a new Search instance, but do not execute it immediately. Generally
you will want to use the #search method to execute searches using the DSL;
however, if you are building searches dynamically (using the Builder
pattern, for instance), it may be easier to access the Query API directly.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">types&lt;Class&gt;&#8230;:</td><td>Zero, one, or more types to search for. If no types are passed, all
configured types will be searched for.

</td></tr>
</table>
<h4>Returns</h4>
<table>
<tr><td valign="top">Sunspot::Search:</td><td>Search object, not yet executed. Query parameters can be added manually;
then #execute! should be called.

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 212</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L212">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">212
213
214</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='types identifier id'>types</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='new_search identifier id'>new_search</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='types identifier id'>types</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove</h3>
</div><div id="remove-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove</span><span class='args'>(*objects)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Remove objects from the index. Any time an object is destroyed, it must be
removed from the index; otherwise, the index will contain broken references
to objects that do not exist, which will cause errors when those objects
are matched in search results.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">objects&#8230;&lt;Object&gt;:</td><td>Objects to remove from the index (may pass an array or varargs)

</td></tr>
</table>
<h4>Example</h4>
<pre class="code">
  <span class='post identifier id'>post</span><span class='dot token'>.</span><span class='destroy identifier id'>destroy</span>
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='post identifier id'>post</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 316</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L316">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">316
317
318</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='objects identifier id'>objects</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='remove identifier id'>remove</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='objects identifier id'>objects</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove!</h3>
</div><div id="remove-21-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove!</span><span class='args'></span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Remove objects from the index and immediately commit. See Sunspot.remove
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">objects&#8230;&lt;Object&gt;:</td><td>Objects to remove from the index

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 327</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L327">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">327
328
329</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove! fid id'>remove!</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='remove! fid id'>remove!</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='objects identifier id'>objects</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_all</h3>
</div><div id="remove_all-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_all</span><span class='args'>(*classes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Remove all objects of the given classes from the index. There isn&#8217;t
much use for this in general operations but it can be useful for
maintenance, testing, etc. If no arguments are passed, remove everything
from the index.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">classes&#8230;&lt;Class&gt;:</td><td>classes for which to remove all instances from the index (may pass an array
or varargs)

</td></tr>
</table>
<h4>Example</h4>
<pre class="code">
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='remove_all identifier id'>remove_all</span><span class='lparen token'>(</span><span class='Post constant id'>Post</span><span class='comma token'>,</span> <span class='Blog constant id'>Blog</span><span class='rparen token'>)</span>
</pre>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 370</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L370">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">370
371
372</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_all identifier id'>remove_all</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='classes identifier id'>classes</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='remove_all identifier id'>remove_all</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='classes identifier id'>classes</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_all!</h3>
</div><div id="remove_all-21-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_all!</span><span class='args'>(*classes)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Remove all objects of the given classes from the index and immediately
commit. See Sunspot.remove_all
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">classes&#8230;&lt;Class&gt;:</td><td>classes for which to remove all instances from the index

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 382</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L382">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">382
383
384</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_all! fid id'>remove_all!</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='classes identifier id'>classes</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='remove_all! fid id'>remove_all!</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='classes identifier id'>classes</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_by_id</h3>
</div><div id="remove_by_id-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_by_id</span><span class='args'>(clazz, id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Remove an object from the index using its class name and primary key.
Useful if you know this information and want to remove an object without
instantiating it from persistent storage
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">clazz&lt;Class&gt;:</td><td>Class of the object, or class name as a string or symbol

</td></tr>
<tr><td valign="top">id:</td><td>Primary key of the object. This should be the same id that would be
returned by the class&#8217;s instance adapter.

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 343</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L343">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">343
344
345</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_by_id identifier id'>remove_by_id</span><span class='lparen token'>(</span><span class='clazz identifier id'>clazz</span><span class='comma token'>,</span> <span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='remove_by_id identifier id'>remove_by_id</span><span class='lparen token'>(</span><span class='clazz identifier id'>clazz</span><span class='comma token'>,</span> <span class='id identifier id'>id</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>remove_by_id!</h3>
</div><div id="remove_by_id-21-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>remove_by_id!</span><span class='args'>(clazz, id)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Remove an object by class name and primary key, and immediately commit. See
#remove_by_id and #commit
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 351</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L351">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">351
352
353</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='remove_by_id! fid id'>remove_by_id!</span><span class='lparen token'>(</span><span class='clazz identifier id'>clazz</span><span class='comma token'>,</span> <span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='remove_by_id! fid id'>remove_by_id!</span><span class='lparen token'>(</span><span class='clazz identifier id'>clazz</span><span class='comma token'>,</span> <span class='id identifier id'>id</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>reset!</h3>
</div><div id="reset-21-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>reset!</span><span class='args'>(keep_config = false)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Resets the singleton session. This is useful for clearing out all static
data between tests, but probably nowhere else.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">keep_config&lt;Boolean&gt;:</td><td>Whether to retain the configuration used by the current singleton session.
Default false.

</td></tr>
</table>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 447</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L447">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">447
448
449
450
451
452
453
454
455</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='reset! fid id'>reset!</span><span class='lparen token'>(</span><span class='keep_config identifier id'>keep_config</span> <span class='assign token'>=</span> <span class='false false kw'>false</span><span class='rparen token'>)</span>
  <span class='config identifier id'>config</span> <span class='assign token'>=</span>
    <span class='if if kw'>if</span> <span class='keep_config identifier id'>keep_config</span>
      <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='config identifier id'>config</span>
    <span class='else else kw'>else</span>
      <span class='Configuration constant id'>Configuration</span><span class='dot token'>.</span><span class='build identifier id'>build</span>
    <span class='end end kw'>end</span>
  <span class='@session ivar id'>@session</span> <span class='assign token'>=</span> <span class='Session constant id'>Session</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='config identifier id'>config</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>search</h3>
</div><div id="search-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>search</span><span class='args'>(*types, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Search for objects in the index.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">types&lt;Class&gt;&#8230;:</td><td>Zero, one, or more types to search for. If no types are passed, all
configured types will be searched.

</td></tr>
</table>
<h4>Options (last argument, optional)</h4>
<table>
<tr><td valign="top">:keywords&lt;String&gt;:</td><td>Fulltext search string

</td></tr>
<tr><td valign="top">:conditions&lt;Hash&gt;:</td><td>Hash of key-value pairs to be used as restrictions. Keys are field names.
Scalar values are used as equality restrictions; arrays are used as
&quot;any of&quot; restrictions; and Ranges are used as range restrictions.

</td></tr>
<tr><td valign="top">:order&lt;String&gt;:</td><td>order field and direction (e.g., &#8216;updated_at desc&#8217;)

</td></tr>
<tr><td valign="top">:page&lt;Integer&gt;:</td><td>Page to start on for pagination

</td></tr>
<tr><td valign="top">:per_page&lt;Integer&gt;:</td><td>Number of results to use per page. Ignored if :page is not specified.

</td></tr>
</table>
<h4>Returns</h4>
<table>
<tr><td valign="top">Sunspot::Search:</td><td>Object containing results, facets, count, etc.

</td></tr>
</table>
<p>
The fields available for restriction, ordering, etc. are those that meet
the following criteria:
</p>
<ul>
<li>They are not of type <tt>text</tt>.

</li>
<li>They are defined for all of the classes being searched

</li>
<li>They have the same data type for all of the classes being searched

</li>
<li>They have the same multiple flag for all of the classes being searched.

</li>
</ul>
<p>
The restrictions available are the constants defined in the
Sunspot::Restriction class. The standard restrictions are:
</p>
<pre class="code">
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='equal_to identifier id'>equal_to</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='comma token'>,</span> <span class='value identifier id'>value</span><span class='rparen token'>)</span> <span class='comment val'># shorthand for above</span>
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='less_than identifier id'>less_than</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='greater_than identifier id'>greater_than</span><span class='lparen token'>(</span><span class='value identifier id'>value</span><span class='rparen token'>)</span>
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='between identifier id'>between</span><span class='lparen token'>(</span><span class='value1 identifier id'>value1</span><span class='dot2 op'>..</span><span class='value2 identifier id'>value2</span><span class='rparen token'>)</span>
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='any_of identifier id'>any_of</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='value1 identifier id'>value1</span><span class='comma token'>,</span> <span class='value2 identifier id'>value2</span><span class='comma token'>,</span> <span class='value3 identifier id'>value3</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='all_of identifier id'>all_of</span><span class='lparen token'>(</span><span class='lbrack token'>[</span><span class='value1 identifier id'>value1</span><span class='comma token'>,</span> <span class='value2 identifier id'>value2</span><span class='comma token'>,</span> <span class='value3 identifier id'>value3</span><span class='rbrack token'>]</span><span class='rparen token'>)</span>
  <span class='without identifier id'>without</span><span class='lparen token'>(</span><span class='some_instance identifier id'>some_instance</span><span class='rparen token'>)</span> <span class='comment val'># exclude that particular instance</span>
</pre>
<p>
<tt>without</tt> can be substituted for <tt>with</tt>, causing the
restriction to be negated. In the last example above, only <tt>without</tt>
works, as it does not make sense to search only for an instance you already
have.
</p>
<p>
Equality restrictions can take <tt>nil</tt> as a value, which restricts the
results to documents that have no value for the given field. Passing
<tt>nil</tt> as a value to other restriction types is illegal. Thus:
</p>
<pre class="code">
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'># ok</span>
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='equal_to identifier id'>equal_to</span><span class='lparen token'>(</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'># ok</span>
  <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:field_name</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='less_than identifier id'>less_than</span><span class='lparen token'>(</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span> <span class='comment val'># bad</span>
</pre>
<h4>Example</h4>
<pre class="code">
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span><span class='Post constant id'>Post</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='keywords identifier id'>keywords</span> <span class='string val'>'great pizza'</span>
    <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:published_at</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='less_than identifier id'>less_than</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span>
    <span class='with identifier id'>with</span> <span class='symbol val'>:blog_id</span><span class='comma token'>,</span> <span class='integer val'>1</span>
    <span class='without identifier id'>without</span> <span class='current_post identifier id'>current_post</span>
    <span class='facet identifier id'>facet</span> <span class='symbol val'>:category_ids</span>
    <span class='order_by identifier id'>order_by</span> <span class='symbol val'>:published_at</span><span class='comma token'>,</span> <span class='symbol val'>:desc</span>
    <span class='paginate identifier id'>paginate</span> <span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>15</span>
  <span class='end end kw'>end</span>
</pre>
<p>
If the block passed to #search takes an argument, that argument will
present the DSL, and the block will be evaluated in the calling context.
This will come in handy for building searches using instance data or
methods, e.g.:
</p>
<pre class="code">
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span><span class='Post constant id'>Post</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='query identifier id'>query</span><span class='bitor op'>|</span>
    <span class='query identifier id'>query</span><span class='dot token'>.</span><span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:blog_id</span><span class='comma token'>,</span> <span class='@current_blog ivar id'>@current_blog</span><span class='dot token'>.</span><span class='id identifier id'>id</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
</pre>
<p>
See Sunspot::DSL::Search, Sunspot::DSL::Scope, Sunspot::DSL::FieldQuery and
Sunspot::DSL::Query for the full API presented inside the block.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 297</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L297">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">297
298
299</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='search identifier id'>search</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='types identifier id'>types</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='session identifier id'>session</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='types identifier id'>types</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>setup</h3>
</div><div id="setup-class_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>setup</span><span class='args'>(clazz, &amp;block)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Configures indexing and search for a given class.
</p>
<h4>Parameters</h4>
<table>
<tr><td valign="top">clazz&lt;Class&gt;:</td><td>class to configure

</td></tr>
</table>
<h4>Example</h4>
<pre class="code">
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='setup identifier id'>setup</span><span class='lparen token'>(</span><span class='Post constant id'>Post</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='text identifier id'>text</span> <span class='symbol val'>:title</span><span class='comma token'>,</span> <span class='symbol val'>:body</span>
    <span class='string identifier id'>string</span> <span class='symbol val'>:author_name</span>
    <span class='integer identifier id'>integer</span> <span class='symbol val'>:blog_id</span>
    <span class='integer identifier id'>integer</span> <span class='symbol val'>:category_ids</span>
    <span class='float identifier id'>float</span> <span class='symbol val'>:average_rating</span><span class='comma token'>,</span> <span class='symbol val'>:using</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:ratings_average</span>
    <span class='time identifier id'>time</span> <span class='symbol val'>:published_at</span>
    <span class='string identifier id'>string</span> <span class='symbol val'>:sort_title</span> <span class='do do kw'>do</span>
      <span class='title identifier id'>title</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^(an?|the)\W&lt;tt&gt;/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='div op'>/</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='title identifier id'>title</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='title identifier id'>title</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<h6>Attribute Fields vs. Virtual Fields</h6>
<p>
Attribute fields call a method on the indexed object and index the return
value. All of the fields defined above except for the last one are
attribute fields. By default, the field name will also be the attribute
used; this can be overriden with the </tt>:using+ option, as in
<tt>:average_rating</tt> above. In that case, the attribute <tt>:ratings_average</tt>
will be indexed with the field name <tt>:average_rating</tt>.
</p>
<p>
<tt>:sort_title</tt> is a virtual field, which evaluates the block inside the
context of the instance being indexed, and indexes the value returned by
the block. If the block you pass takes an argument, it will be passed the
instance rather than being evaluated inside of it; so, the following
example is equivalent to the one above (assuming #title is public):
</p>
<pre class="code">
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='setup identifier id'>setup</span><span class='lparen token'>(</span><span class='Post constant id'>Post</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='string identifier id'>string</span> <span class='symbol val'>:sort_title</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='post identifier id'>post</span><span class='bitor op'>|</span>
      <span class='post identifier id'>post</span><span class='dot token'>.</span><span class='title identifier id'>title</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^(an?|the)\W+/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='div op'>/</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='title identifier id'>title</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='title identifier id'>title</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<h5>Field Types</h5>
<p>
The available types are:
</p>
<ul>
<li><tt>text</tt>

</li>
<li><tt>string</tt>

</li>
<li><tt>integer</tt>

</li>
<li><tt>float</tt>

</li>
<li><tt>time</tt>

</li>
<li><tt>boolean</tt>

</li>
</ul>
<p>
Note that the <tt>text</tt> type behaves quite differently from the others
- this is the type that is indexed as fulltext, and is searched using the
<tt>keywords</tt> method inside the search DSL. Text fields cannot have
restrictions set on them, nor can they be used in order statements or for
facets. All other types are indexed literally, and thus can be used for all
of those operations. They will not, however, be searched in fulltext. In
this way, Sunspot provides a complete barrier between fulltext fields and
value fields.
</p>
<p>
It is fine to specify a field both as a text field and a string field;
internally, the fields will have different names so there is no danger of
conflict.
</p>
<h5>Dynamic Fields</h5>
<p>
For use cases which have highly dynamic data models (for instance, an open
set of key-value pairs attached to a model), it may be useful to defer
definition of fields until indexing time. Sunspot exposes dynamic fields,
which define a data accessor (either attribute or virtual, see above),
which accepts a hash of field names to values. Note that the field names in
the hash are internally scoped to the base name of the dynamic field, so
any time they are referred to, they are referred to using both the base
name and the dynamic (runtime-specified) name.
</p>
<p>
Dynamic fields are speficied in the setup block using the type name
prefixed by <tt>dynamic_</tt>. For example:
</p>
<pre class="code">
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='setup identifier id'>setup</span><span class='lparen token'>(</span><span class='Post constant id'>Post</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='dynamic_string identifier id'>dynamic_string</span> <span class='symbol val'>:custom_values</span> <span class='do do kw'>do</span>
      <span class='key_value_pairs identifier id'>key_value_pairs</span><span class='dot token'>.</span><span class='inject identifier id'>inject</span><span class='lparen token'>(</span><span class='lbrace token'>{</span><span class='rbrace token'>}</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='hash identifier id'>hash</span><span class='comma token'>,</span> <span class='key_value_pair identifier id'>key_value_pair</span><span class='bitor op'>|</span>
        <span class='hash identifier id'>hash</span><span class='lbrack token'>[</span><span class='key_value_pair identifier id'>key_value_pair</span><span class='dot token'>.</span><span class='key identifier id'>key</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='key_value_pair identifier id'>key_value_pair</span><span class='dot token'>.</span><span class='value identifier id'>value</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
If you later wanted to facet all of the values for the key
&quot;cuisine&quot;, you could issue:
</p>
<pre class="code">
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='search identifier id'>search</span><span class='lparen token'>(</span><span class='Post constant id'>Post</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='dynamic identifier id'>dynamic</span> <span class='symbol val'>:custom_values</span> <span class='do do kw'>do</span>
      <span class='facet identifier id'>facet</span> <span class='symbol val'>:cuisine</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
In the documentation, <tt>:custom_values</tt> is referred to as the &quot;base
name&quot; - that is, the one specified statically - and <tt>:cuisine</tt> is
referred to as the dynamic name, which is the part that is specified at
indexing time.
</p>

</div></div>
<div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="files" style="display:none">
    <div class="file">
      <div class="meta">
        <div class="info">
          <span>File 'lib/sunspot.rb', line 141</span>
        </div>
        <div class="actions">      
          <a id="raw-url" href="http://github.com/outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4/lib/sunspot.rb#L141">raw</a>      
        </div>
      </div>
            
      <div class="data syntax">    
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td>            
                <pre class="line_numbers">141
142
143</pre>
              </td>
              <td width="100%">                    
                <div class="highlight"><pre class="code"><span class='def def kw'>def</span> <span class='setup identifier id'>setup</span><span class='lparen token'>(</span><span class='clazz identifier id'>clazz</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
  <span class='Setup constant id'>Setup</span><span class='dot token'>.</span><span class='setup identifier id'>setup</span><span class='lparen token'>(</span><span class='clazz identifier id'>clazz</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='block identifier id'>block</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre></div>          
              </td>
            </tr>
          </tbody>
        </table>    
      </div>
    </div>  
  </div>
</div>
<div>
</div>
    </div>
  
</div>
  </div>

</div>
</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>