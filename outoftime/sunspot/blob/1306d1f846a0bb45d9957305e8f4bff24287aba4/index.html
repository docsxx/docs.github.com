<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <title>outoftime's sunspot - GitHub Documentation</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="">

<link rel="search" type="application/opensearchdescription+xml" href="http://github.com/opensearch.xml" title="GitHub">
<link rel="fluid-icon" href="http://github.com/fluidicon.png" title="GitHub">
<link href="http://assets0.github.com/stylesheets/bundle.css" media="screen" rel="stylesheet" type="text/css">
<link href="http://github.com/feeds/outoftime/commits/sunspot/master" rel="alternate" title="Recent Commits to sunspot:master" type="application/atom+xml">

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://assets3.github.com/javascripts/bundle.js"></script>              
<script src="app.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript" src="http://docs.github.com/javascripts/md5.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/repos.js"></script>
<script type="text/javascript" src="http://docs.github.com/javascripts/commits.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    if (typeof skipHeaders != 'undefined') return;
    
    GitHubRepo.init("outoftime", "sunspot", function(){ 
      GitHubRepo.links = " <a id='namespaces_button' rel='outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4' href='#'><img class='button' src='http://docs.github.com/namespaces_button.png' alt='Modules and Classes'/></a> ";
      GitHubRepo.links += " <a id='methods_button' rel='outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4' href='#'><img class='button' src='http://docs.github.com/methods_button.png' alt='Methods'/></a> ";
      $("#repo").html(GitHubRepo.content());
      $('#namespaces_button').click(function(){
        var url="/"+$(this).attr('rel')+"/namespaces/";
        $.gitbox(url);
        return false;
      });    
      $('#methods_button').click(function(){
        var url="/"+$(this).attr('rel')+"/methods/";
        $.gitbox(url);
        return false;
      });        
    });
    GitHubCommit.init("outoftime", "sunspot", "1306d1f846a0bb45d9957305e8f4bff24287aba4", function(){ 
      $("#commit").html(GitHubCommit.content());
    });
  });
</script>

    <link rel="stylesheet" href="style.css" type="text/css" charset="utf-8" />
  </head>
  <body>    
    
    
        <div id="main" style="padding-bottom:8em;">
      <div id="header">
        <div class="site">
          <div class="logo">
            <a href="http://github.com/"><img src="http://github.com/images/modules/header/logov3.png" alt="github"></a>
          </div>          
          <div class="topsearch">
            <form action="http://github.com/search" id="top_search_form" method="get">
              <input class="search" name="q" type="search"> <input value="Search" type="submit">
            </form>
            <div class="links">
              <a href="http://github.com/repositories">Browse</a> | <a href="http://github.com/guides">Guides</a> | <a href="http://github.com/search">Advanced</a>
            </div>
          </div>
          <div class="actions">
            <a href="http://github.com">Home</a>
            <a href="http://github.com/plans"><b><u>Pricing and Signup</u></b></a>
            <a href="http://docs.github.com/">Documentation</a>
            <a href="https://github.com/login">Login</a>
          </div>                  
        </div>
      </div>    
                                                  
      <div id="repo_menu">
        <div class="site">
          <ul>          
            <li class=""><a href="http://github.com/outoftime/sunspot/tree/">Source</a></li>
            <li class=""><a href="http://github.com/outoftime/sunspot/commits/">Commits</a></li>            
            <li class=""><a href="http://github.com/outoftime/sunspot/network">Network</a></li>            
            <li class=""><a href="http://github.com/outoftime/sunspot/issues">Issues</a></li>
            <li class=""><a href="http://wiki.github.com/outoftime/sunspot">Wiki</a></li>
            <li class=""><a href="http://github.com/outoftime/sunspot/graphs">Graphs</a></li>                    
            <li class="active"><a href="/outoftime/sunspot">Documentation</a></li>
          </ul>
        </div>
      </div>

      <div id="repo_sub_menu">
        <div class="site">
          <div class="joiner"></div>      
        </div>
      </div>

      <div class="site">  
        <div id="repos">
          <div id="repo" class="repo public">
            <div class="title">
              <div class="path">
                <a href="http://github.com/outoftime">outoftime</a> / <b><a href="http://github.com/outoftime/sunspot/tree">sunspot</a></b>        
                <a id="namespaces_button" rel="outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4" href="#"><img class="button" src="http://docs.github.com/namespaces_button.png" alt="Modules and Classes"/></a>
                <a id="methods_button" rel="outoftime/sunspot/blob/1306d1f846a0bb45d9957305e8f4bff24287aba4" href="#"><img class="button" src="http://docs.github.com/methods_button.png" alt="Methods"/></a>
              </div>
            </div>            
          </div>
          <div id="commit">
          </div> 
          <br/>                                       
          <div id="content">
            <div class="section docstring readme wikistyle">
  <h1>Sunspot</h1>
<p>
http://outoftime.github.com/sunspot
</p>
<p>
Sunspot is a Ruby library for expressive, powerful interaction with the
Solr search engine. Sunspot is built on top of the RSolr gem, which
provides a low-level interface for Solr interaction; Sunspot provides a
simple, intuitive, expressive DSL backed by powerful features for indexing
objects and searching for them.
</p>
<p>
Sunspot is designed to be easily plugged in to any ORM, or even
non-database-backed objects such as the filesystem.
</p>
<h3>Features:</h3>
<ul>
<li>Define indexing strategy for each searchable class using intuitive
block-based API

</li>
<li>Clean separation between keyword-searchable fields and fields for
scoping/ordering

</li>
<li>Define fields based on existing attributes or &quot;virtual fields&quot;
for custom indexing

</li>
<li>Indexes each object&#8217;s entire superclass hierarchy, for easy searching
for all objects inheriting from a parent class

</li>
<li>Intuitive DSL for scoping searches, with all the usual boolean operators
available

</li>
<li>Intuitive interface for requesting facets on indexed fields

</li>
<li>Extensible adapter architecture for easy integration of other ORMs or
non-model classes

</li>
<li>Refine search using field facets, date range facets, or ultra-powerful
query facets

</li>
<li>Full compatibility with will_paginate

</li>
<li>Ordering

</li>
</ul>
<h2>Installation</h2>
<pre class="code">
  <span class='gem identifier id'>gem</span> <span class='sources identifier id'>sources</span> <span class='minus op'>-</span><span class='a identifier id'>a</span> <span class='http identifier id'>http</span><span class='symbol val'>:/</span><span class='regexp val'>/gems.github.com
  gem install outoftime-sunspot
</span></pre>
<p>
In order to start the packaged Solr installation, run:
</p>
<pre class="code">
  <span class='sunspot identifier id'>sunspot</span><span class='minus op'>-</span><span class='solr identifier id'>solr</span> <span class='start identifier id'>start</span> <span class='minus op'>-</span><span class='minus op'>-</span> <span class='lbrack token'>[</span><span class='minus op'>-</span><span class='d identifier id'>d</span> <span class='regexp val'>/path/</span><span class='to identifier id'>to</span><span class='div op'>/</span><span class='data identifier id'>data</span><span class='div op'>/</span><span class='directory identifier id'>directory</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='minus op'>-</span><span class='p identifier id'>p</span> <span class='port identifier id'>port</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='minus op'>-</span><span class='s identifier id'>s</span> <span class='path identifier id'>path</span><span class='div op'>/</span><span class='to identifier id'>to</span><span class='div op'>/</span><span class='solr identifier id'>solr</span><span class='div op'>/</span><span class='home identifier id'>home</span><span class='rbrack token'>]</span> <span class='lbrack token'>[</span><span class='minus op'>-</span><span class='minus op'>-</span><span class='pid identifier id'>pid</span><span class='minus op'>-</span><span class='dir identifier id'>dir</span><span class='assign token'>=</span><span class='path identifier id'>path</span><span class='div op'>/</span><span class='to identifier id'>to</span><span class='div op'>/</span><span class='pid identifier id'>pid</span><span class='div op'>/</span><span class='dir identifier id'>dir</span><span class='rbrack token'>]</span>
</pre>
<p>
If you don&#8217;t specify a data directory, your Solr index will be stored
in your operating system&#8217;s temporary directory.
</p>
<p>
If you specify a solr home, the directory must contain a <tt>conf</tt>
directory, which should contain at least <tt>schema.xml</tt> and
<tt>solrconfig.xml</tt>. Be sure to copy the <tt>schema.xml</tt> out of the
Sunspot gem&#8217;s <tt>solr/solr/conf</tt> directory. Sunspot relies on
the field name patterns defined in the packaged <tt>schema.xml</tt>, so
those cannot be modified.
</p>
<p>
You can also run your own instance of Solr wherever you&#8217;d like; just
copy the solr/config/schema.xml file out of the gem&#8217;s solr into your
installation. You can change the URL at which Sunspot accesses Solr with:
</p>
<pre class="code">
  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='config identifier id'>config</span><span class='dot token'>.</span><span class='solr identifier id'>solr</span><span class='dot token'>.</span><span class='url identifier id'>url</span> <span class='assign token'>=</span> <span class='string val'>'http://solr.my.host:9818/solr'</span>
</pre>
<h2>Rails Integration</h2>
<p>
The <tt>Sunspot::Rails</tt>[http://github.com/outoftime/sunspot_rails] plugin
makes integrating Sunspot into Rails drop-in easy.
</p>
<h2>Using Sunspot</h2>
<h3>Define an index:</h3>
<pre class="code">
  <span class='class class kw'>class</span> <span class='Post constant id'>Post</span>
    <span class='comment val'>#...</span>
  <span class='end end kw'>end</span>

  <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='setup identifier id'>setup</span><span class='lparen token'>(</span><span class='Post constant id'>Post</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='text identifier id'>text</span> <span class='symbol val'>:title</span><span class='comma token'>,</span> <span class='symbol val'>:body</span>
    <span class='string identifier id'>string</span> <span class='symbol val'>:author_name</span>
    <span class='integer identifier id'>integer</span> <span class='symbol val'>:blog_id</span>
    <span class='integer identifier id'>integer</span> <span class='symbol val'>:category_ids</span>
    <span class='float identifier id'>float</span> <span class='symbol val'>:average_rating</span><span class='comma token'>,</span> <span class='symbol val'>:using</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='symbol val'>:ratings_average</span>
    <span class='time identifier id'>time</span> <span class='symbol val'>:published_at</span>
    <span class='string identifier id'>string</span> <span class='symbol val'>:sort_title</span> <span class='do do kw'>do</span>
      <span class='title identifier id'>title</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='dot token'>.</span><span class='sub identifier id'>sub</span><span class='lparen token'>(</span><span class='regexp val'>/^(an?|the)\W+/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='div op'>/</span><span class='rparen token'>)</span> <span class='if if_mod kw'>if</span> <span class='title identifier id'>title</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='title identifier id'>title</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
</pre>
<p>
See Sunspot.setup for more information.
</p>
<p>
Note that in order for a class to be searchable, it must have an adapter
registered for itself or one of its subclasses. Adapters allow Sunspot to
load objects out of persistent storage, and to determine their primary key
for indexing. <tt>Sunspot::Rails</tt>[http://github.com/outoftime/sunspot_rails]
comes with an adapter for ActiveRecord objects, but for other types of
models you will need to define your own. See Sunspot::Adapters for more
information.
</p>
<h3>Search for objects:</h3>
<pre class="code">
  <span class='search identifier id'>search</span> <span class='assign token'>=</span> <span class='Sunspot constant id'>Sunspot</span><span class='dot token'>.</span><span class='search identifier id'>search</span> <span class='Post constant id'>Post</span> <span class='do do kw'>do</span>
    <span class='keywords identifier id'>keywords</span> <span class='string val'>'great pizza'</span>
    <span class='with identifier id'>with</span> <span class='symbol val'>:author_name</span><span class='comma token'>,</span> <span class='string val'>'Mark Twain'</span>
    <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:blog_id</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='any_of identifier id'>any_of</span> <span class='lbrack token'>[</span><span class='integer val'>2</span><span class='comma token'>,</span> <span class='integer val'>14</span><span class='rbrack token'>]</span>
    <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:category_ids</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='all_of identifier id'>all_of</span> <span class='lbrack token'>[</span><span class='integer val'>4</span><span class='comma token'>,</span> <span class='integer val'>10</span><span class='rbrack token'>]</span>
    <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:published_at</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='less_than identifier id'>less_than</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span>
    <span class='any_of identifier id'>any_of</span> <span class='do do kw'>do</span>
      <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:expired_at</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='greater_than identifier id'>greater_than</span><span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='rparen token'>)</span>
      <span class='with identifier id'>with</span><span class='lparen token'>(</span><span class='symbol val'>:expired_at</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='without identifier id'>without</span> <span class='symbol val'>:title</span><span class='comma token'>,</span> <span class='string val'>'Bad Title'</span>
    <span class='without identifier id'>without</span> <span class='bad_instance identifier id'>bad_instance</span> <span class='comment val'># specifically exclude this instance from results</span>

    <span class='paginate identifier id'>paginate</span> <span class='symbol val'>:page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>3</span><span class='comma token'>,</span> <span class='symbol val'>:per_page</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='integer val'>15</span>
    <span class='order_by identifier id'>order_by</span> <span class='symbol val'>:average_rating</span><span class='comma token'>,</span> <span class='symbol val'>:desc</span>

    <span class='facet identifier id'>facet</span> <span class='symbol val'>:blog_id</span>
  <span class='end end kw'>end</span>
</pre>
<p>
See Sunspot.search for more information.
</p>
<h3>Get data from search:</h3>
<pre class="code">
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='results identifier id'>results</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='total identifier id'>total</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='page identifier id'>page</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='per_page identifier id'>per_page</span>
  <span class='search identifier id'>search</span><span class='dot token'>.</span><span class='facet identifier id'>facet</span><span class='lparen token'>(</span><span class='symbol val'>:blog_id</span><span class='rparen token'>)</span>
</pre>
<h2>About the API documentation</h2>
<p>
All of the methods documented in the RDoc are considered part of
Sunspot&#8217;s public API. Methods that are not part of the public API are
documented in the code, but excluded from the RDoc. If you find yourself
needing to access methods that are not part of the public API in order to
do what you need, please contact me so I can rectify the situation!
</p>
<h2>Dependencies</h2>
<ol>
<li>RSolr

</li>
<li>Daemons

</li>
<li>OptiFlag

</li>
<li>Haml

</li>
<li>Java

</li>
</ol>
<p>
Sunspot has been tested with MRI 1.8.6 and 1.8.7, REE 1.8.6, YARV 1.9.1,
and JRuby 1.2.0
</p>
<h2>Bugs</h2>
<p>
Please submit bug reports to
http://outoftime.lighthouseapp.com/projects/20339-sunspot
</p>
<h2>Further Reading</h2>
<ul>
<li>Sunspot Discussion: http://groups.google.com/group/ruby-sunspot

</li>
<li>IRC: #sunspot-ruby @ Freenode

</li>
<li>Posts about Sunspot from my tumblog: http://outofti.me/tagged/sunspot

</li>
<li>Read about it on Linux Magazine: http://www.linux-mag.com/id/7341

</li>
</ul>
<h2>Contributors</h2>
<ul>
<li>Mat Brown (mat@patch.com)

</li>
<li>Peer Allan (peer.allan@gmail.com)

</li>
<li>Dmitriy Dzema (dima@dzema.name)

</li>
<li>Benjamin Krause (bk@benjaminkrause.com)

</li>
</ul>
<h2>License</h2>
<p>
Sunspot is distributed under the MIT License, copyright &#169; 2008-2009
Mat Brown
</p>

</div>
          </div>
        </div>
      </div>                    
    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://develop.github.com/">API</a> |
            <a href="http://twitter.com/github">Status</a>
          </div>
          <div class="company">
            <span id="_rrt" title="0.64509s from xc88-s00039">GitHub</span>
            is <a href="http://logicalawesome.com/">Logical Awesome</a> ©2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <a href="http://engineyard.com/"><img src="http://github.com/images/modules/footer/engine_yard_logo.png" alt="Engine Yard"></a>
          <div>
            Hosting provided by our<br> partners at Engine Yard
          </div>
        </div>
      </div>
    </div>
    
    <div id="coming_soon" style="display: none;">
      This feature is coming soon.  Sit tight!
    </div>

    <div id="facebox" style="display: none;">       
      <div class="popup">         
        <table>           
          <tbody>             
            <tr>               
              <td class="tl"></td>
              <td class="b"></td>
              <td class="tr"></td>             
            </tr>             
          <tr>               
            <td class="b"></td>               
            <td class="body">                 
              <div class="content"></div>                 
              <div class="footer">                   
                <a href="#" class="close"><img src="http://github.com/facebox/closelabel.gif" title="close" class="close_image"></a>                 
              </div>               
            </td>               
            <td class="b"></td>             
          </tr>             
          <tr>               
            <td class="bl"></td>
            <td class="b"></td>
            <td class="br"></td>             
          </tr>           
        </tbody>         
      </table>       
    </div>     


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
    var pageTracker = _gat._getTracker("UA-8689483-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

  </body>
</html>